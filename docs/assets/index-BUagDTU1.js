(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const f of c.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function t(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(s){if(s.ep)return;s.ep=!0;const c=t(s);fetch(s.href,c)}})();function v2(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var op={exports:{}},Fc={};var Ax;function y2(){if(Ax)return Fc;Ax=1;var e=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function t(i,s,c){var f=null;if(c!==void 0&&(f=""+c),s.key!==void 0&&(f=""+s.key),"key"in s){c={};for(var p in s)p!=="key"&&(c[p]=s[p])}else c=s;return s=c.ref,{$$typeof:e,type:i,key:f,ref:s!==void 0?s:null,props:c}}return Fc.Fragment=a,Fc.jsx=t,Fc.jsxs=t,Fc}var _x;function b2(){return _x||(_x=1,op.exports=y2()),op.exports}var o=b2(),cp={exports:{}},_t={};var Cx;function S2(){if(Cx)return _t;Cx=1;var e=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),f=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),_=Symbol.iterator;function w(ee){return ee===null||typeof ee!="object"?null:(ee=_&&ee[_]||ee["@@iterator"],typeof ee=="function"?ee:null)}var N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,F={};function z(ee,O,L){this.props=ee,this.context=O,this.refs=F,this.updater=L||N}z.prototype.isReactComponent={},z.prototype.setState=function(ee,O){if(typeof ee!="object"&&typeof ee!="function"&&ee!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ee,O,"setState")},z.prototype.forceUpdate=function(ee){this.updater.enqueueForceUpdate(this,ee,"forceUpdate")};function q(){}q.prototype=z.prototype;function B(ee,O,L){this.props=ee,this.context=O,this.refs=F,this.updater=L||N}var ie=B.prototype=new q;ie.constructor=B,k(ie,z.prototype),ie.isPureReactComponent=!0;var se=Array.isArray;function ne(){}var H={H:null,A:null,T:null,S:null},le=Object.prototype.hasOwnProperty;function oe(ee,O,L){var K=L.ref;return{$$typeof:e,type:ee,key:O,ref:K!==void 0?K:null,props:L}}function m(ee,O){return oe(ee.type,O,ee.props)}function Se(ee){return typeof ee=="object"&&ee!==null&&ee.$$typeof===e}function ue(ee){var O={"=":"=0",":":"=2"};return"$"+ee.replace(/[=:]/g,function(L){return O[L]})}var Pe=/\/+/g;function tt(ee,O){return typeof ee=="object"&&ee!==null&&ee.key!=null?ue(""+ee.key):O.toString(36)}function ke(ee){switch(ee.status){case"fulfilled":return ee.value;case"rejected":throw ee.reason;default:switch(typeof ee.status=="string"?ee.then(ne,ne):(ee.status="pending",ee.then(function(O){ee.status==="pending"&&(ee.status="fulfilled",ee.value=O)},function(O){ee.status==="pending"&&(ee.status="rejected",ee.reason=O)})),ee.status){case"fulfilled":return ee.value;case"rejected":throw ee.reason}}throw ee}function de(ee,O,L,K,te){var he=typeof ee;(he==="undefined"||he==="boolean")&&(ee=null);var Oe=!1;if(ee===null)Oe=!0;else switch(he){case"bigint":case"string":case"number":Oe=!0;break;case"object":switch(ee.$$typeof){case e:case a:Oe=!0;break;case E:return Oe=ee._init,de(Oe(ee._payload),O,L,K,te)}}if(Oe)return te=te(ee),Oe=K===""?"."+tt(ee,0):K,se(te)?(L="",Oe!=null&&(L=Oe.replace(Pe,"$&/")+"/"),de(te,O,L,"",function(He){return He})):te!=null&&(Se(te)&&(te=m(te,L+(te.key==null||ee&&ee.key===te.key?"":(""+te.key).replace(Pe,"$&/")+"/")+Oe)),O.push(te)),1;Oe=0;var Ue=K===""?".":K+":";if(se(ee))for(var Ie=0;Ie<ee.length;Ie++)K=ee[Ie],he=Ue+tt(K,Ie),Oe+=de(K,O,L,he,te);else if(Ie=w(ee),typeof Ie=="function")for(ee=Ie.call(ee),Ie=0;!(K=ee.next()).done;)K=K.value,he=Ue+tt(K,Ie++),Oe+=de(K,O,L,he,te);else if(he==="object"){if(typeof ee.then=="function")return de(ke(ee),O,L,K,te);throw O=String(ee),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(ee).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.")}return Oe}function _e(ee,O,L){if(ee==null)return ee;var K=[],te=0;return de(ee,K,"","",function(he){return O.call(L,he,te++)}),K}function Ze(ee){if(ee._status===-1){var O=ee._result;O=O(),O.then(function(L){(ee._status===0||ee._status===-1)&&(ee._status=1,ee._result=L)},function(L){(ee._status===0||ee._status===-1)&&(ee._status=2,ee._result=L)}),ee._status===-1&&(ee._status=0,ee._result=O)}if(ee._status===1)return ee._result.default;throw ee._result}var fe=typeof reportError=="function"?reportError:function(ee){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var O=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ee=="object"&&ee!==null&&typeof ee.message=="string"?String(ee.message):String(ee),error:ee});if(!window.dispatchEvent(O))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ee);return}console.error(ee)},Je={map:_e,forEach:function(ee,O,L){_e(ee,function(){O.apply(this,arguments)},L)},count:function(ee){var O=0;return _e(ee,function(){O++}),O},toArray:function(ee){return _e(ee,function(O){return O})||[]},only:function(ee){if(!Se(ee))throw Error("React.Children.only expected to receive a single React element child.");return ee}};return _t.Activity=A,_t.Children=Je,_t.Component=z,_t.Fragment=t,_t.Profiler=s,_t.PureComponent=B,_t.StrictMode=i,_t.Suspense=g,_t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=H,_t.__COMPILER_RUNTIME={__proto__:null,c:function(ee){return H.H.useMemoCache(ee)}},_t.cache=function(ee){return function(){return ee.apply(null,arguments)}},_t.cacheSignal=function(){return null},_t.cloneElement=function(ee,O,L){if(ee==null)throw Error("The argument must be a React element, but you passed "+ee+".");var K=k({},ee.props),te=ee.key;if(O!=null)for(he in O.key!==void 0&&(te=""+O.key),O)!le.call(O,he)||he==="key"||he==="__self"||he==="__source"||he==="ref"&&O.ref===void 0||(K[he]=O[he]);var he=arguments.length-2;if(he===1)K.children=L;else if(1<he){for(var Oe=Array(he),Ue=0;Ue<he;Ue++)Oe[Ue]=arguments[Ue+2];K.children=Oe}return oe(ee.type,te,K)},_t.createContext=function(ee){return ee={$$typeof:f,_currentValue:ee,_currentValue2:ee,_threadCount:0,Provider:null,Consumer:null},ee.Provider=ee,ee.Consumer={$$typeof:c,_context:ee},ee},_t.createElement=function(ee,O,L){var K,te={},he=null;if(O!=null)for(K in O.key!==void 0&&(he=""+O.key),O)le.call(O,K)&&K!=="key"&&K!=="__self"&&K!=="__source"&&(te[K]=O[K]);var Oe=arguments.length-2;if(Oe===1)te.children=L;else if(1<Oe){for(var Ue=Array(Oe),Ie=0;Ie<Oe;Ie++)Ue[Ie]=arguments[Ie+2];te.children=Ue}if(ee&&ee.defaultProps)for(K in Oe=ee.defaultProps,Oe)te[K]===void 0&&(te[K]=Oe[K]);return oe(ee,he,te)},_t.createRef=function(){return{current:null}},_t.forwardRef=function(ee){return{$$typeof:p,render:ee}},_t.isValidElement=Se,_t.lazy=function(ee){return{$$typeof:E,_payload:{_status:-1,_result:ee},_init:Ze}},_t.memo=function(ee,O){return{$$typeof:h,type:ee,compare:O===void 0?null:O}},_t.startTransition=function(ee){var O=H.T,L={};H.T=L;try{var K=ee(),te=H.S;te!==null&&te(L,K),typeof K=="object"&&K!==null&&typeof K.then=="function"&&K.then(ne,fe)}catch(he){fe(he)}finally{O!==null&&L.types!==null&&(O.types=L.types),H.T=O}},_t.unstable_useCacheRefresh=function(){return H.H.useCacheRefresh()},_t.use=function(ee){return H.H.use(ee)},_t.useActionState=function(ee,O,L){return H.H.useActionState(ee,O,L)},_t.useCallback=function(ee,O){return H.H.useCallback(ee,O)},_t.useContext=function(ee){return H.H.useContext(ee)},_t.useDebugValue=function(){},_t.useDeferredValue=function(ee,O){return H.H.useDeferredValue(ee,O)},_t.useEffect=function(ee,O){return H.H.useEffect(ee,O)},_t.useEffectEvent=function(ee){return H.H.useEffectEvent(ee)},_t.useId=function(){return H.H.useId()},_t.useImperativeHandle=function(ee,O,L){return H.H.useImperativeHandle(ee,O,L)},_t.useInsertionEffect=function(ee,O){return H.H.useInsertionEffect(ee,O)},_t.useLayoutEffect=function(ee,O){return H.H.useLayoutEffect(ee,O)},_t.useMemo=function(ee,O){return H.H.useMemo(ee,O)},_t.useOptimistic=function(ee,O){return H.H.useOptimistic(ee,O)},_t.useReducer=function(ee,O,L){return H.H.useReducer(ee,O,L)},_t.useRef=function(ee){return H.H.useRef(ee)},_t.useState=function(ee){return H.H.useState(ee)},_t.useSyncExternalStore=function(ee,O,L){return H.H.useSyncExternalStore(ee,O,L)},_t.useTransition=function(){return H.H.useTransition()},_t.version="19.2.3",_t}var kx;function zp(){return kx||(kx=1,cp.exports=S2()),cp.exports}var dt=zp();const E2=v2(dt);var dp={exports:{}},jc={},fp={exports:{}},up={};var wx;function T2(){return wx||(wx=1,(function(e){function a(de,_e){var Ze=de.length;de.push(_e);e:for(;0<Ze;){var fe=Ze-1>>>1,Je=de[fe];if(0<s(Je,_e))de[fe]=_e,de[Ze]=Je,Ze=fe;else break e}}function t(de){return de.length===0?null:de[0]}function i(de){if(de.length===0)return null;var _e=de[0],Ze=de.pop();if(Ze!==_e){de[0]=Ze;e:for(var fe=0,Je=de.length,ee=Je>>>1;fe<ee;){var O=2*(fe+1)-1,L=de[O],K=O+1,te=de[K];if(0>s(L,Ze))K<Je&&0>s(te,L)?(de[fe]=te,de[K]=Ze,fe=K):(de[fe]=L,de[O]=Ze,fe=O);else if(K<Je&&0>s(te,Ze))de[fe]=te,de[K]=Ze,fe=K;else break e}}return _e}function s(de,_e){var Ze=de.sortIndex-_e.sortIndex;return Ze!==0?Ze:de.id-_e.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var f=Date,p=f.now();e.unstable_now=function(){return f.now()-p}}var g=[],h=[],E=1,A=null,_=3,w=!1,N=!1,k=!1,F=!1,z=typeof setTimeout=="function"?setTimeout:null,q=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;function ie(de){for(var _e=t(h);_e!==null;){if(_e.callback===null)i(h);else if(_e.startTime<=de)i(h),_e.sortIndex=_e.expirationTime,a(g,_e);else break;_e=t(h)}}function se(de){if(k=!1,ie(de),!N)if(t(g)!==null)N=!0,ne||(ne=!0,ue());else{var _e=t(h);_e!==null&&ke(se,_e.startTime-de)}}var ne=!1,H=-1,le=5,oe=-1;function m(){return F?!0:!(e.unstable_now()-oe<le)}function Se(){if(F=!1,ne){var de=e.unstable_now();oe=de;var _e=!0;try{e:{N=!1,k&&(k=!1,q(H),H=-1),w=!0;var Ze=_;try{t:{for(ie(de),A=t(g);A!==null&&!(A.expirationTime>de&&m());){var fe=A.callback;if(typeof fe=="function"){A.callback=null,_=A.priorityLevel;var Je=fe(A.expirationTime<=de);if(de=e.unstable_now(),typeof Je=="function"){A.callback=Je,ie(de),_e=!0;break t}A===t(g)&&i(g),ie(de)}else i(g);A=t(g)}if(A!==null)_e=!0;else{var ee=t(h);ee!==null&&ke(se,ee.startTime-de),_e=!1}}break e}finally{A=null,_=Ze,w=!1}_e=void 0}}finally{_e?ue():ne=!1}}}var ue;if(typeof B=="function")ue=function(){B(Se)};else if(typeof MessageChannel<"u"){var Pe=new MessageChannel,tt=Pe.port2;Pe.port1.onmessage=Se,ue=function(){tt.postMessage(null)}}else ue=function(){z(Se,0)};function ke(de,_e){H=z(function(){de(e.unstable_now())},_e)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(de){de.callback=null},e.unstable_forceFrameRate=function(de){0>de||125<de?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):le=0<de?Math.floor(1e3/de):5},e.unstable_getCurrentPriorityLevel=function(){return _},e.unstable_next=function(de){switch(_){case 1:case 2:case 3:var _e=3;break;default:_e=_}var Ze=_;_=_e;try{return de()}finally{_=Ze}},e.unstable_requestPaint=function(){F=!0},e.unstable_runWithPriority=function(de,_e){switch(de){case 1:case 2:case 3:case 4:case 5:break;default:de=3}var Ze=_;_=de;try{return _e()}finally{_=Ze}},e.unstable_scheduleCallback=function(de,_e,Ze){var fe=e.unstable_now();switch(typeof Ze=="object"&&Ze!==null?(Ze=Ze.delay,Ze=typeof Ze=="number"&&0<Ze?fe+Ze:fe):Ze=fe,de){case 1:var Je=-1;break;case 2:Je=250;break;case 5:Je=1073741823;break;case 4:Je=1e4;break;default:Je=5e3}return Je=Ze+Je,de={id:E++,callback:_e,priorityLevel:de,startTime:Ze,expirationTime:Je,sortIndex:-1},Ze>fe?(de.sortIndex=Ze,a(h,de),t(g)===null&&de===t(h)&&(k?(q(H),H=-1):k=!0,ke(se,Ze-fe))):(de.sortIndex=Je,a(g,de),N||w||(N=!0,ne||(ne=!0,ue()))),de},e.unstable_shouldYield=m,e.unstable_wrapCallback=function(de){var _e=_;return function(){var Ze=_;_=_e;try{return de.apply(this,arguments)}finally{_=Ze}}}})(up)),up}var Rx;function A2(){return Rx||(Rx=1,fp.exports=T2()),fp.exports}var pp={exports:{}},Br={};var Nx;function _2(){if(Nx)return Br;Nx=1;var e=zp();function a(g){var h="https://react.dev/errors/"+g;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var E=2;E<arguments.length;E++)h+="&args[]="+encodeURIComponent(arguments[E])}return"Minified React error #"+g+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(a(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function c(g,h,E){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:A==null?null:""+A,children:g,containerInfo:h,implementation:E}}var f=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,h){if(g==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Br.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Br.createPortal=function(g,h){var E=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(a(299));return c(g,h,null,E)},Br.flushSync=function(g){var h=f.T,E=i.p;try{if(f.T=null,i.p=2,g)return g()}finally{f.T=h,i.p=E,i.d.f()}},Br.preconnect=function(g,h){typeof g=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,i.d.C(g,h))},Br.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},Br.preinit=function(g,h){if(typeof g=="string"&&h&&typeof h.as=="string"){var E=h.as,A=p(E,h.crossOrigin),_=typeof h.integrity=="string"?h.integrity:void 0,w=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;E==="style"?i.d.S(g,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:A,integrity:_,fetchPriority:w}):E==="script"&&i.d.X(g,{crossOrigin:A,integrity:_,fetchPriority:w,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Br.preinitModule=function(g,h){if(typeof g=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var E=p(h.as,h.crossOrigin);i.d.M(g,{crossOrigin:E,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&i.d.M(g)},Br.preload=function(g,h){if(typeof g=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var E=h.as,A=p(E,h.crossOrigin);i.d.L(g,E,{crossOrigin:A,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Br.preloadModule=function(g,h){if(typeof g=="string")if(h){var E=p(h.as,h.crossOrigin);i.d.m(g,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:E,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else i.d.m(g)},Br.requestFormReset=function(g){i.d.r(g)},Br.unstable_batchedUpdates=function(g,h){return g(h)},Br.useFormState=function(g,h,E){return f.H.useFormState(g,h,E)},Br.useFormStatus=function(){return f.H.useHostTransitionStatus()},Br.version="19.2.3",Br}var Fx;function C2(){if(Fx)return pp.exports;Fx=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(a){console.error(a)}}return e(),pp.exports=_2(),pp.exports}var jx;function k2(){if(jx)return jc;jx=1;var e=A2(),a=zp(),t=C2();function i(r){var n="https://react.dev/errors/"+r;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)n+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+r+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function c(r){var n=r,l=r;if(r.alternate)for(;n.return;)n=n.return;else{r=n;do n=r,(n.flags&4098)!==0&&(l=n.return),r=n.return;while(r)}return n.tag===3?l:null}function f(r){if(r.tag===13){var n=r.memoizedState;if(n===null&&(r=r.alternate,r!==null&&(n=r.memoizedState)),n!==null)return n.dehydrated}return null}function p(r){if(r.tag===31){var n=r.memoizedState;if(n===null&&(r=r.alternate,r!==null&&(n=r.memoizedState)),n!==null)return n.dehydrated}return null}function g(r){if(c(r)!==r)throw Error(i(188))}function h(r){var n=r.alternate;if(!n){if(n=c(r),n===null)throw Error(i(188));return n!==r?null:r}for(var l=r,d=n;;){var x=l.return;if(x===null)break;var y=x.alternate;if(y===null){if(d=x.return,d!==null){l=d;continue}break}if(x.child===y.child){for(y=x.child;y;){if(y===l)return g(x),r;if(y===d)return g(x),n;y=y.sibling}throw Error(i(188))}if(l.return!==d.return)l=x,d=y;else{for(var R=!1,I=x.child;I;){if(I===l){R=!0,l=x,d=y;break}if(I===d){R=!0,d=x,l=y;break}I=I.sibling}if(!R){for(I=y.child;I;){if(I===l){R=!0,l=y,d=x;break}if(I===d){R=!0,d=y,l=x;break}I=I.sibling}if(!R)throw Error(i(189))}}if(l.alternate!==d)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?r:n}function E(r){var n=r.tag;if(n===5||n===26||n===27||n===6)return r;for(r=r.child;r!==null;){if(n=E(r),n!==null)return n;r=r.sibling}return null}var A=Object.assign,_=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),N=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),q=Symbol.for("react.consumer"),B=Symbol.for("react.context"),ie=Symbol.for("react.forward_ref"),se=Symbol.for("react.suspense"),ne=Symbol.for("react.suspense_list"),H=Symbol.for("react.memo"),le=Symbol.for("react.lazy"),oe=Symbol.for("react.activity"),m=Symbol.for("react.memo_cache_sentinel"),Se=Symbol.iterator;function ue(r){return r===null||typeof r!="object"?null:(r=Se&&r[Se]||r["@@iterator"],typeof r=="function"?r:null)}var Pe=Symbol.for("react.client.reference");function tt(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===Pe?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case k:return"Fragment";case z:return"Profiler";case F:return"StrictMode";case se:return"Suspense";case ne:return"SuspenseList";case oe:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case N:return"Portal";case B:return r.displayName||"Context";case q:return(r._context.displayName||"Context")+".Consumer";case ie:var n=r.render;return r=r.displayName,r||(r=n.displayName||n.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case H:return n=r.displayName||null,n!==null?n:tt(r.type)||"Memo";case le:n=r._payload,r=r._init;try{return tt(r(n))}catch{}}return null}var ke=Array.isArray,de=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_e=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ze={pending:!1,data:null,method:null,action:null},fe=[],Je=-1;function ee(r){return{current:r}}function O(r){0>Je||(r.current=fe[Je],fe[Je]=null,Je--)}function L(r,n){Je++,fe[Je]=r.current,r.current=n}var K=ee(null),te=ee(null),he=ee(null),Oe=ee(null);function Ue(r,n){switch(L(he,n),L(te,r),L(K,null),n.nodeType){case 9:case 11:r=(r=n.documentElement)&&(r=r.namespaceURI)?V1(r):0;break;default:if(r=n.tagName,n=n.namespaceURI)n=V1(n),r=X1(n,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}O(K),L(K,r)}function Ie(){O(K),O(te),O(he)}function He(r){r.memoizedState!==null&&L(Oe,r);var n=K.current,l=X1(n,r.type);n!==l&&(L(te,r),L(K,l))}function gt(r){te.current===r&&(O(K),O(te)),Oe.current===r&&(O(Oe),kc._currentValue=Ze)}var Z,aa;function St(r){if(Z===void 0)try{throw Error()}catch(l){var n=l.stack.trim().match(/\n( *(at )?)/);Z=n&&n[1]||"",aa=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Z+r+aa}var Mt=!1;function yt(r,n){if(!r||Mt)return"";Mt=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(n){var Me=function(){throw Error()};if(Object.defineProperty(Me.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Me,[])}catch(we){var Ae=we}Reflect.construct(r,[],Me)}else{try{Me.call()}catch(we){Ae=we}r.call(Me.prototype)}}else{try{throw Error()}catch(we){Ae=we}(Me=r())&&typeof Me.catch=="function"&&Me.catch(function(){})}}catch(we){if(we&&Ae&&typeof we.stack=="string")return[we.stack,Ae.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=d.DetermineComponentFrameRoot(),R=y[0],I=y[1];if(R&&I){var re=R.split(`
`),be=I.split(`
`);for(x=d=0;d<re.length&&!re[d].includes("DetermineComponentFrameRoot");)d++;for(;x<be.length&&!be[x].includes("DetermineComponentFrameRoot");)x++;if(d===re.length||x===be.length)for(d=re.length-1,x=be.length-1;1<=d&&0<=x&&re[d]!==be[x];)x--;for(;1<=d&&0<=x;d--,x--)if(re[d]!==be[x]){if(d!==1||x!==1)do if(d--,x--,0>x||re[d]!==be[x]){var je=`
`+re[d].replace(" at new "," at ");return r.displayName&&je.includes("<anonymous>")&&(je=je.replace("<anonymous>",r.displayName)),je}while(1<=d&&0<=x);break}}}finally{Mt=!1,Error.prepareStackTrace=l}return(l=r?r.displayName||r.name:"")?St(l):""}function et(r,n){switch(r.tag){case 26:case 27:case 5:return St(r.type);case 16:return St("Lazy");case 13:return r.child!==n&&n!==null?St("Suspense Fallback"):St("Suspense");case 19:return St("SuspenseList");case 0:case 15:return yt(r.type,!1);case 11:return yt(r.type.render,!1);case 1:return yt(r.type,!0);case 31:return St("Activity");default:return""}}function ra(r){try{var n="",l=null;do n+=et(r,l),l=r,r=r.return;while(r);return n}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var Ba=Object.prototype.hasOwnProperty,Qa=e.unstable_scheduleCallback,Rt=e.unstable_cancelCallback,Yr=e.unstable_shouldYield,Zr=e.unstable_requestPaint,ia=e.unstable_now,Dr=e.unstable_getCurrentPriorityLevel,sa=e.unstable_ImmediatePriority,ki=e.unstable_UserBlockingPriority,Lt=e.unstable_NormalPriority,Et=e.unstable_LowPriority,ht=e.unstable_IdlePriority,Ea=e.log,hr=e.unstable_setDisableYieldValue,na=null,Ta=null;function pn(r){if(typeof Ea=="function"&&hr(r),Ta&&typeof Ta.setStrictMode=="function")try{Ta.setStrictMode(na,r)}catch{}}var Ut=Math.clz32?Math.clz32:is,ns=Math.log,kn=Math.LN2;function is(r){return r>>>=0,r===0?32:31-(ns(r)/kn|0)|0}var Yt=256,wi=262144,Ha=4194304;function Wr(r){var n=r&42;if(n!==0)return n;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function wn(r,n,l){var d=r.pendingLanes;if(d===0)return 0;var x=0,y=r.suspendedLanes,R=r.pingedLanes;r=r.warmLanes;var I=d&134217727;return I!==0?(d=I&~y,d!==0?x=Wr(d):(R&=I,R!==0?x=Wr(R):l||(l=I&~r,l!==0&&(x=Wr(l))))):(I=d&~y,I!==0?x=Wr(I):R!==0?x=Wr(R):l||(l=d&~r,l!==0&&(x=Wr(l)))),x===0?0:n!==0&&n!==x&&(n&y)===0&&(y=x&-x,l=n&-n,y>=l||y===32&&(l&4194048)!==0)?n:x}function Er(r,n){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&n)===0}function ci(r,n){switch(r){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ys(){var r=Ha;return Ha<<=1,(Ha&62914560)===0&&(Ha=4194304),r}function Rn(r){for(var n=[],l=0;31>l;l++)n.push(r);return n}function Xn(r,n){r.pendingLanes|=n,n!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function p0(r,n,l,d,x,y){var R=r.pendingLanes;r.pendingLanes=l,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=l,r.entangledLanes&=l,r.errorRecoveryDisabledLanes&=l,r.shellSuspendCounter=0;var I=r.entanglements,re=r.expirationTimes,be=r.hiddenUpdates;for(l=R&~l;0<l;){var je=31-Ut(l),Me=1<<je;I[je]=0,re[je]=-1;var Ae=be[je];if(Ae!==null)for(be[je]=null,je=0;je<Ae.length;je++){var we=Ae[je];we!==null&&(we.lane&=-536870913)}l&=~Me}d!==0&&Dl(r,d,0),y!==0&&x===0&&r.tag!==0&&(r.suspendedLanes|=y&~(R&~n))}function Dl(r,n,l){r.pendingLanes|=n,r.suspendedLanes&=~n;var d=31-Ut(n);r.entangledLanes|=n,r.entanglements[d]=r.entanglements[d]|1073741824|l&261930}function gr(r,n){var l=r.entangledLanes|=n;for(r=r.entanglements;l;){var d=31-Ut(l),x=1<<d;x&n|r[d]&n&&(r[d]|=n),l&=~x}}function Ri(r,n){var l=n&-n;return l=(l&42)!==0?1:Ol(l),(l&(r.suspendedLanes|n))!==0?0:l}function Ol(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function Il(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function D(){var r=_e.p;return r!==0?r:(r=window.event,r===void 0?32:mx(r.type))}function W(r,n){var l=_e.p;try{return _e.p=r,n()}finally{_e.p=l}}var P=Math.random().toString(36).slice(2),U="__reactFiber$"+P,G="__reactProps$"+P,V="__reactContainer$"+P,xe="__reactEvents$"+P,Re="__reactListeners$"+P,Ee="__reactHandles$"+P,Te="__reactResources$"+P,ge="__reactMarker$"+P;function De(r){delete r[U],delete r[G],delete r[xe],delete r[Re],delete r[Ee]}function Ve(r){var n=r[U];if(n)return n;for(var l=r.parentNode;l;){if(n=l[V]||l[U]){if(l=n.alternate,n.child!==null||l!==null&&l.child!==null)for(r=tx(r);r!==null;){if(l=r[U])return l;r=tx(r)}return n}r=l,l=r.parentNode}return null}function Xe(r){if(r=r[U]||r[V]){var n=r.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return r}return null}function Ge(r){var n=r.tag;if(n===5||n===26||n===27||n===6)return r.stateNode;throw Error(i(33))}function We(r){var n=r[Te];return n||(n=r[Te]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function it(r){r[ge]=!0}var Nt=new Set,Wt={};function Vt(r,n){sr(r,n),sr(r+"Capture",n)}function sr(r,n){for(Wt[r]=n,r=0;r<n.length;r++)Nt.add(n[r])}var Or=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Vr={},$a={};function Nn(r){return Ba.call($a,r)?!0:Ba.call(Vr,r)?!1:Or.test(r)?$a[r]=!0:(Vr[r]=!0,!1)}function ya(r,n,l){if(Nn(n))if(l===null)r.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":r.removeAttribute(n);return;case"boolean":var d=n.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){r.removeAttribute(n);return}}r.setAttribute(n,""+l)}}function di(r,n,l){if(l===null)r.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(n);return}r.setAttribute(n,""+l)}}function Ga(r,n,l,d){if(d===null)r.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(l);return}r.setAttributeNS(n,l,""+d)}}function xr(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function h0(r){var n=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function Bl(r,n,l){var d=Object.getOwnPropertyDescriptor(r.constructor.prototype,n);if(!r.hasOwnProperty(n)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var x=d.get,y=d.set;return Object.defineProperty(r,n,{configurable:!0,get:function(){return x.call(this)},set:function(R){l=""+R,y.call(this,R)}}),Object.defineProperty(r,n,{enumerable:d.enumerable}),{getValue:function(){return l},setValue:function(R){l=""+R},stopTracking:function(){r._valueTracker=null,delete r[n]}}}}function Oo(r){if(!r._valueTracker){var n=h0(r)?"checked":"value";r._valueTracker=Bl(r,n,""+r[n])}}function Ws(r){if(!r)return!1;var n=r._valueTracker;if(!n)return!0;var l=n.getValue(),d="";return r&&(d=h0(r)?r.checked?"true":"false":r.value),r=d,r!==l?(n.setValue(r),!0):!1}function fi(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var en=/[\n"\\]/g;function Tr(r){return r.replace(en,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function Io(r,n,l,d,x,y,R,I){r.name="",R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?r.type=R:r.removeAttribute("type"),n!=null?R==="number"?(n===0&&r.value===""||r.value!=n)&&(r.value=""+xr(n)):r.value!==""+xr(n)&&(r.value=""+xr(n)):R!=="submit"&&R!=="reset"||r.removeAttribute("value"),n!=null?Bo(r,R,xr(n)):l!=null?Bo(r,R,xr(l)):d!=null&&r.removeAttribute("value"),x==null&&y!=null&&(r.defaultChecked=!!y),x!=null&&(r.checked=x&&typeof x!="function"&&typeof x!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?r.name=""+xr(I):r.removeAttribute("name")}function Vs(r,n,l,d,x,y,R,I){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),n!=null||l!=null){if(!(y!=="submit"&&y!=="reset"||n!=null)){Oo(r);return}l=l!=null?""+xr(l):"",n=n!=null?""+xr(n):l,I||n===r.value||(r.value=n),r.defaultValue=n}d=d??x,d=typeof d!="function"&&typeof d!="symbol"&&!!d,r.checked=I?r.checked:!!d,r.defaultChecked=!!d,R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(r.name=R),Oo(r)}function Bo(r,n,l){n==="number"&&fi(r.ownerDocument)===r||r.defaultValue===""+l||(r.defaultValue=""+l)}function Fn(r,n,l,d){if(r=r.options,n){n={};for(var x=0;x<l.length;x++)n["$"+l[x]]=!0;for(l=0;l<r.length;l++)x=n.hasOwnProperty("$"+r[l].value),r[l].selected!==x&&(r[l].selected=x),x&&d&&(r[l].defaultSelected=!0)}else{for(l=""+xr(l),n=null,x=0;x<r.length;x++){if(r[x].value===l){r[x].selected=!0,d&&(r[x].defaultSelected=!0);return}n!==null||r[x].disabled||(n=r[x])}n!==null&&(n.selected=!0)}}function ss(r,n,l){if(n!=null&&(n=""+xr(n),n!==r.value&&(r.value=n),l==null)){r.defaultValue!==n&&(r.defaultValue=n);return}r.defaultValue=l!=null?""+xr(l):""}function Ml(r,n,l,d){if(n==null){if(d!=null){if(l!=null)throw Error(i(92));if(ke(d)){if(1<d.length)throw Error(i(93));d=d[0]}l=d}l==null&&(l=""),n=l}l=xr(n),r.defaultValue=l,d=r.textContent,d===l&&d!==""&&d!==null&&(r.value=d),Oo(r)}function ui(r,n){if(n){var l=r.firstChild;if(l&&l===r.lastChild&&l.nodeType===3){l.nodeValue=n;return}}r.textContent=n}var Ll=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function g0(r,n,l){var d=n.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?d?r.setProperty(n,""):n==="float"?r.cssFloat="":r[n]="":d?r.setProperty(n,l):typeof l!="number"||l===0||Ll.has(n)?n==="float"?r.cssFloat=l:r[n]=(""+l).trim():r[n]=l+"px"}function Xs(r,n,l){if(n!=null&&typeof n!="object")throw Error(i(62));if(r=r.style,l!=null){for(var d in l)!l.hasOwnProperty(d)||n!=null&&n.hasOwnProperty(d)||(d.indexOf("--")===0?r.setProperty(d,""):d==="float"?r.cssFloat="":r[d]="");for(var x in n)d=n[x],n.hasOwnProperty(x)&&l[x]!==d&&g0(r,x,d)}else for(var y in n)n.hasOwnProperty(y)&&g0(r,y,n[y])}function Mo(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Pl=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function zl(r){return Pl.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function qn(){}var ls=null;function Lo(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var os=null,pi=null;function x0(r){var n=Xe(r);if(n&&(r=n.stateNode)){var l=r[G]||null;e:switch(r=n.stateNode,n.type){case"input":if(Io(r,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),n=l.name,l.type==="radio"&&n!=null){for(l=r;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Tr(""+n)+'"][type="radio"]'),n=0;n<l.length;n++){var d=l[n];if(d!==r&&d.form===r.form){var x=d[G]||null;if(!x)throw Error(i(90));Io(d,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(n=0;n<l.length;n++)d=l[n],d.form===r.form&&Ws(d)}break e;case"textarea":ss(r,l.value,l.defaultValue);break e;case"select":n=l.value,n!=null&&Fn(r,!!l.multiple,n,!1)}}}var Po=!1;function Ul(r,n,l){if(Po)return r(n,l);Po=!0;try{var d=r(n);return d}finally{if(Po=!1,(os!==null||pi!==null)&&(sd(),os&&(n=os,r=pi,pi=os=null,x0(n),r)))for(n=0;n<r.length;n++)x0(r[n])}}function qs(r,n){var l=r.stateNode;if(l===null)return null;var d=l[G]||null;if(d===null)return null;l=d[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(r=r.type,d=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!d;break e;default:r=!1}if(r)return null;if(l&&typeof l!="function")throw Error(i(231,n,typeof l));return l}var Kn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ks=!1;if(Kn)try{var Js={};Object.defineProperty(Js,"passive",{get:function(){Ks=!0}}),window.addEventListener("test",Js,Js),window.removeEventListener("test",Js,Js)}catch{Ks=!1}var hi=null,Ni=null,Hl=null;function m0(){if(Hl)return Hl;var r,n=Ni,l=n.length,d,x="value"in hi?hi.value:hi.textContent,y=x.length;for(r=0;r<l&&n[r]===x[r];r++);var R=l-r;for(d=1;d<=R&&n[l-d]===x[y-d];d++);return Hl=x.slice(r,1<d?1-d:void 0)}function gi(r){var n=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&n===13&&(r=13)):r=n,r===10&&(r=13),32<=r||r===13?r:0}function $l(){return!0}function rt(){return!1}function Ya(r){function n(l,d,x,y,R){this._reactName=l,this._targetInst=x,this.type=d,this.nativeEvent=y,this.target=R,this.currentTarget=null;for(var I in r)r.hasOwnProperty(I)&&(l=r[I],this[I]=l?l(y):y[I]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?$l:rt,this.isPropagationStopped=rt,this}return A(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=$l)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=$l)},persist:function(){},isPersistent:$l}),n}var hn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jn=Ya(hn),Qn=A({},hn,{view:0,detail:0}),Ir=Ya(Qn),tn,zo,Qs,Gl=A({},Qn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uo,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Qs&&(Qs&&r.type==="mousemove"?(tn=r.screenX-Qs.screenX,zo=r.screenY-Qs.screenY):zo=tn=0,Qs=r),tn)},movementY:function(r){return"movementY"in r?r.movementY:zo}}),at=Ya(Gl),cs=A({},Gl,{dataTransfer:0}),Tt=Ya(cs),df=A({},Qn,{relatedTarget:0}),Yl=Ya(df),ff=A({},hn,{animationName:0,elapsedTime:0,pseudoElement:0}),uf=Ya(ff),pf=A({},hn,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),hf=Ya(pf),gf=A({},hn,{data:0}),v0=Ya(gf),Zs={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vf(r){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(r):(r=mf[r])?!!n[r]:!1}function Uo(){return vf}var yf=A({},Qn,{key:function(r){if(r.key){var n=Zs[r.key]||r.key;if(n!=="Unidentified")return n}return r.type==="keypress"?(r=gi(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?xf[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uo,charCode:function(r){return r.type==="keypress"?gi(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?gi(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),bf=Ya(yf),Sf=A({},Gl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),y0=Ya(Sf),Ef=A({},Qn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uo}),b0=Ya(Ef),Tf=A({},hn,{propertyName:0,elapsedTime:0,pseudoElement:0}),xi=Ya(Tf),Af=A({},Gl,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),_f=Ya(Af),S0=A({},hn,{newState:0,oldState:0}),an=Ya(S0),E0=[9,13,27,32],el=Kn&&"CompositionEvent"in window,mi=null;Kn&&"documentMode"in document&&(mi=document.documentMode);var ea=Kn&&"TextEvent"in window&&!mi,T0=Kn&&(!el||mi&&8<mi&&11>=mi),tl=" ",Ft=!1;function Ra(r,n){switch(r){case"keyup":return E0.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ds(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Fi=!1;function A0(r,n){switch(r){case"compositionend":return ds(n);case"keypress":return n.which!==32?null:(Ft=!0,tl);case"textInput":return r=n.data,r===tl&&Ft?null:r;default:return null}}function Cf(r,n){if(Fi)return r==="compositionend"||!el&&Ra(r,n)?(r=m0(),Hl=Ni=hi=null,Fi=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return T0&&n.locale!=="ko"?null:n.data;default:return null}}var kf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function al(r){var n=r&&r.nodeName&&r.nodeName.toLowerCase();return n==="input"?!!kf[r.type]:n==="textarea"}function wf(r,n,l,d){os?pi?pi.push(d):pi=[d]:os=d,n=pd(n,"onChange"),0<n.length&&(l=new Jn("onChange","change",null,l,d),r.push({event:l,listeners:n}))}var Wl=null,rl=null;function fs(r){U1(r,0)}function ji(r){var n=Ge(r);if(Ws(n))return r}function Ho(r,n){if(r==="change")return n}var $o=!1;if(Kn){var Vl;if(Kn){var Go="oninput"in document;if(!Go){var _0=document.createElement("div");_0.setAttribute("oninput","return;"),Go=typeof _0.oninput=="function"}Vl=Go}else Vl=!1;$o=Vl&&(!document.documentMode||9<document.documentMode)}function C0(){Wl&&(Wl.detachEvent("onpropertychange",jn),rl=Wl=null)}function jn(r){if(r.propertyName==="value"&&ji(rl)){var n=[];wf(n,rl,r,Lo(r)),Ul(fs,n)}}function Yo(r,n,l){r==="focusin"?(C0(),Wl=n,rl=l,Wl.attachEvent("onpropertychange",jn)):r==="focusout"&&C0()}function Wo(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return ji(rl)}function Vo(r,n){if(r==="click")return ji(n)}function Xo(r,n){if(r==="input"||r==="change")return ji(n)}function qo(r,n){return r===n&&(r!==0||1/r===1/n)||r!==r&&n!==n}var Ar=typeof Object.is=="function"?Object.is:qo;function Di(r,n){if(Ar(r,n))return!0;if(typeof r!="object"||r===null||typeof n!="object"||n===null)return!1;var l=Object.keys(r),d=Object.keys(n);if(l.length!==d.length)return!1;for(d=0;d<l.length;d++){var x=l[d];if(!Ba.call(n,x)||!Ar(r[x],n[x]))return!1}return!0}function k0(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function w0(r,n){var l=k0(r);r=0;for(var d;l;){if(l.nodeType===3){if(d=r+l.textContent.length,r<=n&&d>=n)return{node:l,offset:n-r};r=d}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=k0(l)}}function Ko(r,n){return r&&n?r===n?!0:r&&r.nodeType===3?!1:n&&n.nodeType===3?Ko(r,n.parentNode):"contains"in r?r.contains(n):r.compareDocumentPosition?!!(r.compareDocumentPosition(n)&16):!1:!1}function R0(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var n=fi(r.document);n instanceof r.HTMLIFrameElement;){try{var l=typeof n.contentWindow.location.href=="string"}catch{l=!1}if(l)r=n.contentWindow;else break;n=fi(r.document)}return n}function Jo(r){var n=r&&r.nodeName&&r.nodeName.toLowerCase();return n&&(n==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||n==="textarea"||r.contentEditable==="true")}var N0=Kn&&"documentMode"in document&&11>=document.documentMode,us=null,Qo=null,Xl=null,Oi=!1;function ft(r,n,l){var d=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Oi||us==null||us!==fi(d)||(d=us,"selectionStart"in d&&Jo(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Xl&&Di(Xl,d)||(Xl=d,d=pd(Qo,"onSelect"),0<d.length&&(n=new Jn("onSelect","select",null,n,l),r.push({event:n,listeners:d}),n.target=us)))}function Ot(r,n){var l={};return l[r.toLowerCase()]=n.toLowerCase(),l["Webkit"+r]="webkit"+n,l["Moz"+r]="moz"+n,l}var Na={animationend:Ot("Animation","AnimationEnd"),animationiteration:Ot("Animation","AnimationIteration"),animationstart:Ot("Animation","AnimationStart"),transitionrun:Ot("Transition","TransitionRun"),transitionstart:Ot("Transition","TransitionStart"),transitioncancel:Ot("Transition","TransitionCancel"),transitionend:Ot("Transition","TransitionEnd")},xa={},lr={};Kn&&(lr=document.createElement("div").style,"AnimationEvent"in window||(delete Na.animationend.animation,delete Na.animationiteration.animation,delete Na.animationstart.animation),"TransitionEvent"in window||delete Na.transitionend.transition);function ja(r){if(xa[r])return xa[r];if(!Na[r])return r;var n=Na[r],l;for(l in n)if(n.hasOwnProperty(l)&&l in lr)return xa[r]=n[l];return r}var ps=ja("animationend"),or=ja("animationiteration"),_r=ja("animationstart"),u=ja("transitionrun"),v=ja("transitionstart"),b=ja("transitioncancel"),S=ja("transitionend"),T=new Map,Q="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Q.push("scrollEnd");function j(r,n){T.set(r,n),Vt(n,[r])}var C=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},M=[],X=0,ye=0;function Fe(){for(var r=X,n=ye=X=0;n<r;){var l=M[n];M[n++]=null;var d=M[n];M[n++]=null;var x=M[n];M[n++]=null;var y=M[n];if(M[n++]=null,d!==null&&x!==null){var R=d.pending;R===null?x.next=x:(x.next=R.next,R.next=x),d.pending=x}y!==0&&ze(l,x,y)}}function Ce(r,n,l,d){M[X++]=r,M[X++]=n,M[X++]=l,M[X++]=d,ye|=d,r.lanes|=d,r=r.alternate,r!==null&&(r.lanes|=d)}function J(r,n,l,d){return Ce(r,n,l,d),Le(r)}function Y(r,n){return Ce(r,null,null,n),Le(r)}function ze(r,n,l){r.lanes|=l;var d=r.alternate;d!==null&&(d.lanes|=l);for(var x=!1,y=r.return;y!==null;)y.childLanes|=l,d=y.alternate,d!==null&&(d.childLanes|=l),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(x=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,x&&n!==null&&(x=31-Ut(l),r=y.hiddenUpdates,d=r[x],d===null?r[x]=[n]:d.push(n),n.lane=l|536870912),y):null}function Le(r){if(50<bc)throw bc=0,ju=null,Error(i(185));for(var n=r.return;n!==null;)r=n,n=r.return;return r.tag===3?r.stateNode:null}var me={};function qe(r,n,l,d){this.tag=r,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ye(r,n,l,d){return new qe(r,n,l,d)}function ot(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Xt(r,n){var l=r.alternate;return l===null?(l=Ye(r.tag,n,r.key,r.mode),l.elementType=r.elementType,l.type=r.type,l.stateNode=r.stateNode,l.alternate=r,r.alternate=l):(l.pendingProps=n,l.type=r.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=r.flags&65011712,l.childLanes=r.childLanes,l.lanes=r.lanes,l.child=r.child,l.memoizedProps=r.memoizedProps,l.memoizedState=r.memoizedState,l.updateQueue=r.updateQueue,n=r.dependencies,l.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},l.sibling=r.sibling,l.index=r.index,l.ref=r.ref,l.refCleanup=r.refCleanup,l}function ct(r,n){r.flags&=65011714;var l=r.alternate;return l===null?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=l.childLanes,r.lanes=l.lanes,r.child=l.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,r.type=l.type,n=l.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),r}function ba(r,n,l,d,x,y){var R=0;if(d=r,typeof r=="function")ot(r)&&(R=1);else if(typeof r=="string")R=s2(r,l,K.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case oe:return r=Ye(31,l,n,x),r.elementType=oe,r.lanes=y,r;case k:return nt(l.children,x,y,n);case F:R=8,x|=24;break;case z:return r=Ye(12,l,n,x|2),r.elementType=z,r.lanes=y,r;case se:return r=Ye(13,l,n,x),r.elementType=se,r.lanes=y,r;case ne:return r=Ye(19,l,n,x),r.elementType=ne,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case B:R=10;break e;case q:R=9;break e;case ie:R=11;break e;case H:R=14;break e;case le:R=16,d=null;break e}R=29,l=Error(i(130,r===null?"null":typeof r,"")),d=null}return n=Ye(R,l,n,x),n.elementType=r,n.type=d,n.lanes=y,n}function nt(r,n,l,d){return r=Ye(7,r,d,n),r.lanes=l,r}function Aa(r,n,l){return r=Ye(6,r,null,n),r.lanes=l,r}function Wa(r){var n=Ye(18,null,null,0);return n.stateNode=r,n}function gn(r,n,l){return n=Ye(4,r.children!==null?r.children:[],r.key,n),n.lanes=l,n.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},n}var Zn=new WeakMap;function Sa(r,n){if(typeof r=="object"&&r!==null){var l=Zn.get(r);return l!==void 0?l:(n={value:r,source:n,stack:ra(n)},Zn.set(r,n),n)}return{value:r,source:n,stack:ra(n)}}var vi=[],Da=0,Dn=null,Ii=0,mr=[],Xr=0,xn=null,On=1,Cr="";function ei(r,n){vi[Da++]=Ii,vi[Da++]=Dn,Dn=r,Ii=n}function hs(r,n,l){mr[Xr++]=On,mr[Xr++]=Cr,mr[Xr++]=xn,xn=r;var d=On;r=Cr;var x=32-Ut(d)-1;d&=~(1<<x),l+=1;var y=32-Ut(n)+x;if(30<y){var R=x-x%5;y=(d&(1<<R)-1).toString(32),d>>=R,x-=R,On=1<<32-Ut(n)+x|l<<x|d,Cr=y+r}else On=1<<y|l<<x|d,Cr=r}function Bi(r){r.return!==null&&(ei(r,1),hs(r,1,0))}function Zo(r){for(;r===Dn;)Dn=vi[--Da],vi[Da]=null,Ii=vi[--Da],vi[Da]=null;for(;r===xn;)xn=mr[--Xr],mr[Xr]=null,Cr=mr[--Xr],mr[Xr]=null,On=mr[--Xr],mr[Xr]=null}function F0(r,n){mr[Xr++]=On,mr[Xr++]=Cr,mr[Xr++]=xn,On=n.id,Cr=n.overflow,xn=r}var cr=null,At=null,Ct=!1,dr=null,In=!1,Rf=Error(i(519));function gs(r){var n=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ec(Sa(n,r)),Rf}function wh(r){var n=r.stateNode,l=r.type,d=r.memoizedProps;switch(n[U]=r,n[G]=d,l){case"dialog":zt("cancel",n),zt("close",n);break;case"iframe":case"object":case"embed":zt("load",n);break;case"video":case"audio":for(l=0;l<Ec.length;l++)zt(Ec[l],n);break;case"source":zt("error",n);break;case"img":case"image":case"link":zt("error",n),zt("load",n);break;case"details":zt("toggle",n);break;case"input":zt("invalid",n),Vs(n,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":zt("invalid",n);break;case"textarea":zt("invalid",n),Ml(n,d.value,d.defaultValue,d.children)}l=d.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||n.textContent===""+l||d.suppressHydrationWarning===!0||Y1(n.textContent,l)?(d.popover!=null&&(zt("beforetoggle",n),zt("toggle",n)),d.onScroll!=null&&zt("scroll",n),d.onScrollEnd!=null&&zt("scrollend",n),d.onClick!=null&&(n.onclick=qn),n=!0):n=!1,n||gs(r,!0)}function Rh(r){for(cr=r.return;cr;)switch(cr.tag){case 5:case 31:case 13:In=!1;return;case 27:case 3:In=!0;return;default:cr=cr.return}}function ql(r){if(r!==cr)return!1;if(!Ct)return Rh(r),Ct=!0,!1;var n=r.tag,l;if((l=n!==3&&n!==27)&&((l=n===5)&&(l=r.type,l=!(l!=="form"&&l!=="button")||Vu(r.type,r.memoizedProps)),l=!l),l&&At&&gs(r),Rh(r),n===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));At=ex(r)}else if(n===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));At=ex(r)}else n===27?(n=At,Rs(r.type)?(r=Qu,Qu=null,At=r):At=n):At=cr?Mn(r.stateNode.nextSibling):null;return!0}function nl(){At=cr=null,Ct=!1}function Nf(){var r=dr;return r!==null&&(ln===null?ln=r:ln.push.apply(ln,r),dr=null),r}function ec(r){dr===null?dr=[r]:dr.push(r)}var Ff=ee(null),il=null,Mi=null;function xs(r,n,l){L(Ff,n._currentValue),n._currentValue=l}function Li(r){r._currentValue=Ff.current,O(Ff)}function jf(r,n,l){for(;r!==null;){var d=r.alternate;if((r.childLanes&n)!==n?(r.childLanes|=n,d!==null&&(d.childLanes|=n)):d!==null&&(d.childLanes&n)!==n&&(d.childLanes|=n),r===l)break;r=r.return}}function Df(r,n,l,d){var x=r.child;for(x!==null&&(x.return=r);x!==null;){var y=x.dependencies;if(y!==null){var R=x.child;y=y.firstContext;e:for(;y!==null;){var I=y;y=x;for(var re=0;re<n.length;re++)if(I.context===n[re]){y.lanes|=l,I=y.alternate,I!==null&&(I.lanes|=l),jf(y.return,l,r),d||(R=null);break e}y=I.next}}else if(x.tag===18){if(R=x.return,R===null)throw Error(i(341));R.lanes|=l,y=R.alternate,y!==null&&(y.lanes|=l),jf(R,l,r),R=null}else R=x.child;if(R!==null)R.return=x;else for(R=x;R!==null;){if(R===r){R=null;break}if(x=R.sibling,x!==null){x.return=R.return,R=x;break}R=R.return}x=R}}function Kl(r,n,l,d){r=null;for(var x=n,y=!1;x!==null;){if(!y){if((x.flags&524288)!==0)y=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var R=x.alternate;if(R===null)throw Error(i(387));if(R=R.memoizedProps,R!==null){var I=x.type;Ar(x.pendingProps.value,R.value)||(r!==null?r.push(I):r=[I])}}else if(x===Oe.current){if(R=x.alternate,R===null)throw Error(i(387));R.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(r!==null?r.push(kc):r=[kc])}x=x.return}r!==null&&Df(n,r,l,d),n.flags|=262144}function j0(r){for(r=r.firstContext;r!==null;){if(!Ar(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function sl(r){il=r,Mi=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function kr(r){return Nh(il,r)}function D0(r,n){return il===null&&sl(r),Nh(r,n)}function Nh(r,n){var l=n._currentValue;if(n={context:n,memoizedValue:l,next:null},Mi===null){if(r===null)throw Error(i(308));Mi=n,r.dependencies={lanes:0,firstContext:n},r.flags|=524288}else Mi=Mi.next=n;return l}var ab=typeof AbortController<"u"?AbortController:function(){var r=[],n=this.signal={aborted:!1,addEventListener:function(l,d){r.push(d)}};this.abort=function(){n.aborted=!0,r.forEach(function(l){return l()})}},rb=e.unstable_scheduleCallback,nb=e.unstable_NormalPriority,Za={$$typeof:B,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Of(){return{controller:new ab,data:new Map,refCount:0}}function tc(r){r.refCount--,r.refCount===0&&rb(nb,function(){r.controller.abort()})}var ac=null,If=0,Jl=0,Ql=null;function ib(r,n){if(ac===null){var l=ac=[];If=0,Jl=Lu(),Ql={status:"pending",value:void 0,then:function(d){l.push(d)}}}return If++,n.then(Fh,Fh),n}function Fh(){if(--If===0&&ac!==null){Ql!==null&&(Ql.status="fulfilled");var r=ac;ac=null,Jl=0,Ql=null;for(var n=0;n<r.length;n++)(0,r[n])()}}function sb(r,n){var l=[],d={status:"pending",value:null,reason:null,then:function(x){l.push(x)}};return r.then(function(){d.status="fulfilled",d.value=n;for(var x=0;x<l.length;x++)(0,l[x])(n)},function(x){for(d.status="rejected",d.reason=x,x=0;x<l.length;x++)(0,l[x])(void 0)}),d}var jh=de.S;de.S=function(r,n){g1=ia(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&ib(r,n),jh!==null&&jh(r,n)};var ll=ee(null);function Bf(){var r=ll.current;return r!==null?r:ma.pooledCache}function O0(r,n){n===null?L(ll,ll.current):L(ll,n.pool)}function Dh(){var r=Bf();return r===null?null:{parent:Za._currentValue,pool:r}}var Zl=Error(i(460)),Mf=Error(i(474)),I0=Error(i(542)),B0={then:function(){}};function Oh(r){return r=r.status,r==="fulfilled"||r==="rejected"}function Ih(r,n,l){switch(l=r[l],l===void 0?r.push(n):l!==n&&(n.then(qn,qn),n=l),n.status){case"fulfilled":return n.value;case"rejected":throw r=n.reason,Mh(r),r;default:if(typeof n.status=="string")n.then(qn,qn);else{if(r=ma,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=n,r.status="pending",r.then(function(d){if(n.status==="pending"){var x=n;x.status="fulfilled",x.value=d}},function(d){if(n.status==="pending"){var x=n;x.status="rejected",x.reason=d}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw r=n.reason,Mh(r),r}throw cl=n,Zl}}function ol(r){try{var n=r._init;return n(r._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(cl=l,Zl):l}}var cl=null;function Bh(){if(cl===null)throw Error(i(459));var r=cl;return cl=null,r}function Mh(r){if(r===Zl||r===I0)throw Error(i(483))}var eo=null,rc=0;function M0(r){var n=rc;return rc+=1,eo===null&&(eo=[]),Ih(eo,r,n)}function nc(r,n){n=n.props.ref,r.ref=n!==void 0?n:null}function L0(r,n){throw n.$$typeof===_?Error(i(525)):(r=Object.prototype.toString.call(n),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":r)))}function Lh(r){function n(pe,ce){if(r){var ve=pe.deletions;ve===null?(pe.deletions=[ce],pe.flags|=16):ve.push(ce)}}function l(pe,ce){if(!r)return null;for(;ce!==null;)n(pe,ce),ce=ce.sibling;return null}function d(pe){for(var ce=new Map;pe!==null;)pe.key!==null?ce.set(pe.key,pe):ce.set(pe.index,pe),pe=pe.sibling;return ce}function x(pe,ce){return pe=Xt(pe,ce),pe.index=0,pe.sibling=null,pe}function y(pe,ce,ve){return pe.index=ve,r?(ve=pe.alternate,ve!==null?(ve=ve.index,ve<ce?(pe.flags|=67108866,ce):ve):(pe.flags|=67108866,ce)):(pe.flags|=1048576,ce)}function R(pe){return r&&pe.alternate===null&&(pe.flags|=67108866),pe}function I(pe,ce,ve,Be){return ce===null||ce.tag!==6?(ce=Aa(ve,pe.mode,Be),ce.return=pe,ce):(ce=x(ce,ve),ce.return=pe,ce)}function re(pe,ce,ve,Be){var ut=ve.type;return ut===k?je(pe,ce,ve.props.children,Be,ve.key):ce!==null&&(ce.elementType===ut||typeof ut=="object"&&ut!==null&&ut.$$typeof===le&&ol(ut)===ce.type)?(ce=x(ce,ve.props),nc(ce,ve),ce.return=pe,ce):(ce=ba(ve.type,ve.key,ve.props,null,pe.mode,Be),nc(ce,ve),ce.return=pe,ce)}function be(pe,ce,ve,Be){return ce===null||ce.tag!==4||ce.stateNode.containerInfo!==ve.containerInfo||ce.stateNode.implementation!==ve.implementation?(ce=gn(ve,pe.mode,Be),ce.return=pe,ce):(ce=x(ce,ve.children||[]),ce.return=pe,ce)}function je(pe,ce,ve,Be,ut){return ce===null||ce.tag!==7?(ce=nt(ve,pe.mode,Be,ut),ce.return=pe,ce):(ce=x(ce,ve),ce.return=pe,ce)}function Me(pe,ce,ve){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return ce=Aa(""+ce,pe.mode,ve),ce.return=pe,ce;if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case w:return ve=ba(ce.type,ce.key,ce.props,null,pe.mode,ve),nc(ve,ce),ve.return=pe,ve;case N:return ce=gn(ce,pe.mode,ve),ce.return=pe,ce;case le:return ce=ol(ce),Me(pe,ce,ve)}if(ke(ce)||ue(ce))return ce=nt(ce,pe.mode,ve,null),ce.return=pe,ce;if(typeof ce.then=="function")return Me(pe,M0(ce),ve);if(ce.$$typeof===B)return Me(pe,D0(pe,ce),ve);L0(pe,ce)}return null}function Ae(pe,ce,ve,Be){var ut=ce!==null?ce.key:null;if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return ut!==null?null:I(pe,ce,""+ve,Be);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case w:return ve.key===ut?re(pe,ce,ve,Be):null;case N:return ve.key===ut?be(pe,ce,ve,Be):null;case le:return ve=ol(ve),Ae(pe,ce,ve,Be)}if(ke(ve)||ue(ve))return ut!==null?null:je(pe,ce,ve,Be,null);if(typeof ve.then=="function")return Ae(pe,ce,M0(ve),Be);if(ve.$$typeof===B)return Ae(pe,ce,D0(pe,ve),Be);L0(pe,ve)}return null}function we(pe,ce,ve,Be,ut){if(typeof Be=="string"&&Be!==""||typeof Be=="number"||typeof Be=="bigint")return pe=pe.get(ve)||null,I(ce,pe,""+Be,ut);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case w:return pe=pe.get(Be.key===null?ve:Be.key)||null,re(ce,pe,Be,ut);case N:return pe=pe.get(Be.key===null?ve:Be.key)||null,be(ce,pe,Be,ut);case le:return Be=ol(Be),we(pe,ce,ve,Be,ut)}if(ke(Be)||ue(Be))return pe=pe.get(ve)||null,je(ce,pe,Be,ut,null);if(typeof Be.then=="function")return we(pe,ce,ve,M0(Be),ut);if(Be.$$typeof===B)return we(pe,ce,ve,D0(ce,Be),ut);L0(ce,Be)}return null}function st(pe,ce,ve,Be){for(var ut=null,Jt=null,lt=ce,jt=ce=0,$t=null;lt!==null&&jt<ve.length;jt++){lt.index>jt?($t=lt,lt=null):$t=lt.sibling;var Qt=Ae(pe,lt,ve[jt],Be);if(Qt===null){lt===null&&(lt=$t);break}r&&lt&&Qt.alternate===null&&n(pe,lt),ce=y(Qt,ce,jt),Jt===null?ut=Qt:Jt.sibling=Qt,Jt=Qt,lt=$t}if(jt===ve.length)return l(pe,lt),Ct&&ei(pe,jt),ut;if(lt===null){for(;jt<ve.length;jt++)lt=Me(pe,ve[jt],Be),lt!==null&&(ce=y(lt,ce,jt),Jt===null?ut=lt:Jt.sibling=lt,Jt=lt);return Ct&&ei(pe,jt),ut}for(lt=d(lt);jt<ve.length;jt++)$t=we(lt,pe,jt,ve[jt],Be),$t!==null&&(r&&$t.alternate!==null&&lt.delete($t.key===null?jt:$t.key),ce=y($t,ce,jt),Jt===null?ut=$t:Jt.sibling=$t,Jt=$t);return r&&lt.forEach(function(Os){return n(pe,Os)}),Ct&&ei(pe,jt),ut}function xt(pe,ce,ve,Be){if(ve==null)throw Error(i(151));for(var ut=null,Jt=null,lt=ce,jt=ce=0,$t=null,Qt=ve.next();lt!==null&&!Qt.done;jt++,Qt=ve.next()){lt.index>jt?($t=lt,lt=null):$t=lt.sibling;var Os=Ae(pe,lt,Qt.value,Be);if(Os===null){lt===null&&(lt=$t);break}r&&lt&&Os.alternate===null&&n(pe,lt),ce=y(Os,ce,jt),Jt===null?ut=Os:Jt.sibling=Os,Jt=Os,lt=$t}if(Qt.done)return l(pe,lt),Ct&&ei(pe,jt),ut;if(lt===null){for(;!Qt.done;jt++,Qt=ve.next())Qt=Me(pe,Qt.value,Be),Qt!==null&&(ce=y(Qt,ce,jt),Jt===null?ut=Qt:Jt.sibling=Qt,Jt=Qt);return Ct&&ei(pe,jt),ut}for(lt=d(lt);!Qt.done;jt++,Qt=ve.next())Qt=we(lt,pe,jt,Qt.value,Be),Qt!==null&&(r&&Qt.alternate!==null&&lt.delete(Qt.key===null?jt:Qt.key),ce=y(Qt,ce,jt),Jt===null?ut=Qt:Jt.sibling=Qt,Jt=Qt);return r&&lt.forEach(function(m2){return n(pe,m2)}),Ct&&ei(pe,jt),ut}function ha(pe,ce,ve,Be){if(typeof ve=="object"&&ve!==null&&ve.type===k&&ve.key===null&&(ve=ve.props.children),typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case w:e:{for(var ut=ve.key;ce!==null;){if(ce.key===ut){if(ut=ve.type,ut===k){if(ce.tag===7){l(pe,ce.sibling),Be=x(ce,ve.props.children),Be.return=pe,pe=Be;break e}}else if(ce.elementType===ut||typeof ut=="object"&&ut!==null&&ut.$$typeof===le&&ol(ut)===ce.type){l(pe,ce.sibling),Be=x(ce,ve.props),nc(Be,ve),Be.return=pe,pe=Be;break e}l(pe,ce);break}else n(pe,ce);ce=ce.sibling}ve.type===k?(Be=nt(ve.props.children,pe.mode,Be,ve.key),Be.return=pe,pe=Be):(Be=ba(ve.type,ve.key,ve.props,null,pe.mode,Be),nc(Be,ve),Be.return=pe,pe=Be)}return R(pe);case N:e:{for(ut=ve.key;ce!==null;){if(ce.key===ut)if(ce.tag===4&&ce.stateNode.containerInfo===ve.containerInfo&&ce.stateNode.implementation===ve.implementation){l(pe,ce.sibling),Be=x(ce,ve.children||[]),Be.return=pe,pe=Be;break e}else{l(pe,ce);break}else n(pe,ce);ce=ce.sibling}Be=gn(ve,pe.mode,Be),Be.return=pe,pe=Be}return R(pe);case le:return ve=ol(ve),ha(pe,ce,ve,Be)}if(ke(ve))return st(pe,ce,ve,Be);if(ue(ve)){if(ut=ue(ve),typeof ut!="function")throw Error(i(150));return ve=ut.call(ve),xt(pe,ce,ve,Be)}if(typeof ve.then=="function")return ha(pe,ce,M0(ve),Be);if(ve.$$typeof===B)return ha(pe,ce,D0(pe,ve),Be);L0(pe,ve)}return typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint"?(ve=""+ve,ce!==null&&ce.tag===6?(l(pe,ce.sibling),Be=x(ce,ve),Be.return=pe,pe=Be):(l(pe,ce),Be=Aa(ve,pe.mode,Be),Be.return=pe,pe=Be),R(pe)):l(pe,ce)}return function(pe,ce,ve,Be){try{rc=0;var ut=ha(pe,ce,ve,Be);return eo=null,ut}catch(lt){if(lt===Zl||lt===I0)throw lt;var Jt=Ye(29,lt,null,pe.mode);return Jt.lanes=Be,Jt.return=pe,Jt}}}var dl=Lh(!0),Ph=Lh(!1),ms=!1;function Lf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Pf(r,n){r=r.updateQueue,n.updateQueue===r&&(n.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function vs(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ys(r,n,l){var d=r.updateQueue;if(d===null)return null;if(d=d.shared,(ta&2)!==0){var x=d.pending;return x===null?n.next=n:(n.next=x.next,x.next=n),d.pending=n,n=Le(r),ze(r,null,l),n}return Ce(r,d,n,l),Le(r)}function ic(r,n,l){if(n=n.updateQueue,n!==null&&(n=n.shared,(l&4194048)!==0)){var d=n.lanes;d&=r.pendingLanes,l|=d,n.lanes=l,gr(r,l)}}function zf(r,n){var l=r.updateQueue,d=r.alternate;if(d!==null&&(d=d.updateQueue,l===d)){var x=null,y=null;if(l=l.firstBaseUpdate,l!==null){do{var R={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};y===null?x=y=R:y=y.next=R,l=l.next}while(l!==null);y===null?x=y=n:y=y.next=n}else x=y=n;l={baseState:d.baseState,firstBaseUpdate:x,lastBaseUpdate:y,shared:d.shared,callbacks:d.callbacks},r.updateQueue=l;return}r=l.lastBaseUpdate,r===null?l.firstBaseUpdate=n:r.next=n,l.lastBaseUpdate=n}var Uf=!1;function sc(){if(Uf){var r=Ql;if(r!==null)throw r}}function lc(r,n,l,d){Uf=!1;var x=r.updateQueue;ms=!1;var y=x.firstBaseUpdate,R=x.lastBaseUpdate,I=x.shared.pending;if(I!==null){x.shared.pending=null;var re=I,be=re.next;re.next=null,R===null?y=be:R.next=be,R=re;var je=r.alternate;je!==null&&(je=je.updateQueue,I=je.lastBaseUpdate,I!==R&&(I===null?je.firstBaseUpdate=be:I.next=be,je.lastBaseUpdate=re))}if(y!==null){var Me=x.baseState;R=0,je=be=re=null,I=y;do{var Ae=I.lane&-536870913,we=Ae!==I.lane;if(we?(Ht&Ae)===Ae:(d&Ae)===Ae){Ae!==0&&Ae===Jl&&(Uf=!0),je!==null&&(je=je.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var st=r,xt=I;Ae=n;var ha=l;switch(xt.tag){case 1:if(st=xt.payload,typeof st=="function"){Me=st.call(ha,Me,Ae);break e}Me=st;break e;case 3:st.flags=st.flags&-65537|128;case 0:if(st=xt.payload,Ae=typeof st=="function"?st.call(ha,Me,Ae):st,Ae==null)break e;Me=A({},Me,Ae);break e;case 2:ms=!0}}Ae=I.callback,Ae!==null&&(r.flags|=64,we&&(r.flags|=8192),we=x.callbacks,we===null?x.callbacks=[Ae]:we.push(Ae))}else we={lane:Ae,tag:I.tag,payload:I.payload,callback:I.callback,next:null},je===null?(be=je=we,re=Me):je=je.next=we,R|=Ae;if(I=I.next,I===null){if(I=x.shared.pending,I===null)break;we=I,I=we.next,we.next=null,x.lastBaseUpdate=we,x.shared.pending=null}}while(!0);je===null&&(re=Me),x.baseState=re,x.firstBaseUpdate=be,x.lastBaseUpdate=je,y===null&&(x.shared.lanes=0),As|=R,r.lanes=R,r.memoizedState=Me}}function zh(r,n){if(typeof r!="function")throw Error(i(191,r));r.call(n)}function Uh(r,n){var l=r.callbacks;if(l!==null)for(r.callbacks=null,r=0;r<l.length;r++)zh(l[r],n)}var to=ee(null),P0=ee(0);function Hh(r,n){r=Vi,L(P0,r),L(to,n),Vi=r|n.baseLanes}function Hf(){L(P0,Vi),L(to,to.current)}function $f(){Vi=P0.current,O(to),O(P0)}var mn=ee(null),Bn=null;function bs(r){var n=r.alternate;L(Va,Va.current&1),L(mn,r),Bn===null&&(n===null||to.current!==null||n.memoizedState!==null)&&(Bn=r)}function Gf(r){L(Va,Va.current),L(mn,r),Bn===null&&(Bn=r)}function $h(r){r.tag===22?(L(Va,Va.current),L(mn,r),Bn===null&&(Bn=r)):Ss()}function Ss(){L(Va,Va.current),L(mn,mn.current)}function vn(r){O(mn),Bn===r&&(Bn=null),O(Va)}var Va=ee(0);function z0(r){for(var n=r;n!==null;){if(n.tag===13){var l=n.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Ku(l)||Ju(l)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break;for(;n.sibling===null;){if(n.return===null||n.return===r)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Pi=0,kt=null,ua=null,er=null,U0=!1,ao=!1,fl=!1,H0=0,oc=0,ro=null,lb=0;function Ma(){throw Error(i(321))}function Yf(r,n){if(n===null)return!1;for(var l=0;l<n.length&&l<r.length;l++)if(!Ar(r[l],n[l]))return!1;return!0}function Wf(r,n,l,d,x,y){return Pi=y,kt=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,de.H=r===null||r.memoizedState===null?Cg:lu,fl=!1,y=l(d,x),fl=!1,ao&&(y=Yh(n,l,d,x)),Gh(r),y}function Gh(r){de.H=fc;var n=ua!==null&&ua.next!==null;if(Pi=0,er=ua=kt=null,U0=!1,oc=0,ro=null,n)throw Error(i(300));r===null||tr||(r=r.dependencies,r!==null&&j0(r)&&(tr=!0))}function Yh(r,n,l,d){kt=r;var x=0;do{if(ao&&(ro=null),oc=0,ao=!1,25<=x)throw Error(i(301));if(x+=1,er=ua=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}de.H=kg,y=n(l,d)}while(ao);return y}function ob(){var r=de.H,n=r.useState()[0];return n=typeof n.then=="function"?cc(n):n,r=r.useState()[0],(ua!==null?ua.memoizedState:null)!==r&&(kt.flags|=1024),n}function Vf(){var r=H0!==0;return H0=0,r}function Xf(r,n,l){n.updateQueue=r.updateQueue,n.flags&=-2053,r.lanes&=~l}function qf(r){if(U0){for(r=r.memoizedState;r!==null;){var n=r.queue;n!==null&&(n.pending=null),r=r.next}U0=!1}Pi=0,er=ua=kt=null,ao=!1,oc=H0=0,ro=null}function qr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return er===null?kt.memoizedState=er=r:er=er.next=r,er}function Xa(){if(ua===null){var r=kt.alternate;r=r!==null?r.memoizedState:null}else r=ua.next;var n=er===null?kt.memoizedState:er.next;if(n!==null)er=n,ua=r;else{if(r===null)throw kt.alternate===null?Error(i(467)):Error(i(310));ua=r,r={memoizedState:ua.memoizedState,baseState:ua.baseState,baseQueue:ua.baseQueue,queue:ua.queue,next:null},er===null?kt.memoizedState=er=r:er=er.next=r}return er}function $0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function cc(r){var n=oc;return oc+=1,ro===null&&(ro=[]),r=Ih(ro,r,n),n=kt,(er===null?n.memoizedState:er.next)===null&&(n=n.alternate,de.H=n===null||n.memoizedState===null?Cg:lu),r}function G0(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return cc(r);if(r.$$typeof===B)return kr(r)}throw Error(i(438,String(r)))}function Kf(r){var n=null,l=kt.updateQueue;if(l!==null&&(n=l.memoCache),n==null){var d=kt.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(n={data:d.data.map(function(x){return x.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),l===null&&(l=$0(),kt.updateQueue=l),l.memoCache=n,l=n.data[n.index],l===void 0)for(l=n.data[n.index]=Array(r),d=0;d<r;d++)l[d]=m;return n.index++,l}function zi(r,n){return typeof n=="function"?n(r):n}function Y0(r){var n=Xa();return Jf(n,ua,r)}function Jf(r,n,l){var d=r.queue;if(d===null)throw Error(i(311));d.lastRenderedReducer=l;var x=r.baseQueue,y=d.pending;if(y!==null){if(x!==null){var R=x.next;x.next=y.next,y.next=R}n.baseQueue=x=y,d.pending=null}if(y=r.baseState,x===null)r.memoizedState=y;else{n=x.next;var I=R=null,re=null,be=n,je=!1;do{var Me=be.lane&-536870913;if(Me!==be.lane?(Ht&Me)===Me:(Pi&Me)===Me){var Ae=be.revertLane;if(Ae===0)re!==null&&(re=re.next={lane:0,revertLane:0,gesture:null,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null}),Me===Jl&&(je=!0);else if((Pi&Ae)===Ae){be=be.next,Ae===Jl&&(je=!0);continue}else Me={lane:0,revertLane:be.revertLane,gesture:null,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null},re===null?(I=re=Me,R=y):re=re.next=Me,kt.lanes|=Ae,As|=Ae;Me=be.action,fl&&l(y,Me),y=be.hasEagerState?be.eagerState:l(y,Me)}else Ae={lane:Me,revertLane:be.revertLane,gesture:be.gesture,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null},re===null?(I=re=Ae,R=y):re=re.next=Ae,kt.lanes|=Me,As|=Me;be=be.next}while(be!==null&&be!==n);if(re===null?R=y:re.next=I,!Ar(y,r.memoizedState)&&(tr=!0,je&&(l=Ql,l!==null)))throw l;r.memoizedState=y,r.baseState=R,r.baseQueue=re,d.lastRenderedState=y}return x===null&&(d.lanes=0),[r.memoizedState,d.dispatch]}function Qf(r){var n=Xa(),l=n.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=r;var d=l.dispatch,x=l.pending,y=n.memoizedState;if(x!==null){l.pending=null;var R=x=x.next;do y=r(y,R.action),R=R.next;while(R!==x);Ar(y,n.memoizedState)||(tr=!0),n.memoizedState=y,n.baseQueue===null&&(n.baseState=y),l.lastRenderedState=y}return[y,d]}function Wh(r,n,l){var d=kt,x=Xa(),y=Ct;if(y){if(l===void 0)throw Error(i(407));l=l()}else l=n();var R=!Ar((ua||x).memoizedState,l);if(R&&(x.memoizedState=l,tr=!0),x=x.queue,tu(qh.bind(null,d,x,r),[r]),x.getSnapshot!==n||R||er!==null&&er.memoizedState.tag&1){if(d.flags|=2048,no(9,{destroy:void 0},Xh.bind(null,d,x,l,n),null),ma===null)throw Error(i(349));y||(Pi&127)!==0||Vh(d,n,l)}return l}function Vh(r,n,l){r.flags|=16384,r={getSnapshot:n,value:l},n=kt.updateQueue,n===null?(n=$0(),kt.updateQueue=n,n.stores=[r]):(l=n.stores,l===null?n.stores=[r]:l.push(r))}function Xh(r,n,l,d){n.value=l,n.getSnapshot=d,Kh(n)&&Jh(r)}function qh(r,n,l){return l(function(){Kh(n)&&Jh(r)})}function Kh(r){var n=r.getSnapshot;r=r.value;try{var l=n();return!Ar(r,l)}catch{return!0}}function Jh(r){var n=Y(r,2);n!==null&&on(n,r,2)}function Zf(r){var n=qr();if(typeof r=="function"){var l=r;if(r=l(),fl){pn(!0);try{l()}finally{pn(!1)}}}return n.memoizedState=n.baseState=r,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:zi,lastRenderedState:r},n}function Qh(r,n,l,d){return r.baseState=l,Jf(r,ua,typeof d=="function"?d:zi)}function cb(r,n,l,d,x){if(X0(r))throw Error(i(485));if(r=n.action,r!==null){var y={payload:x,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(R){y.listeners.push(R)}};de.T!==null?l(!0):y.isTransition=!1,d(y),l=n.pending,l===null?(y.next=n.pending=y,Zh(n,y)):(y.next=l.next,n.pending=l.next=y)}}function Zh(r,n){var l=n.action,d=n.payload,x=r.state;if(n.isTransition){var y=de.T,R={};de.T=R;try{var I=l(x,d),re=de.S;re!==null&&re(R,I),eg(r,n,I)}catch(be){eu(r,n,be)}finally{y!==null&&R.types!==null&&(y.types=R.types),de.T=y}}else try{y=l(x,d),eg(r,n,y)}catch(be){eu(r,n,be)}}function eg(r,n,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(d){tg(r,n,d)},function(d){return eu(r,n,d)}):tg(r,n,l)}function tg(r,n,l){n.status="fulfilled",n.value=l,ag(n),r.state=l,n=r.pending,n!==null&&(l=n.next,l===n?r.pending=null:(l=l.next,n.next=l,Zh(r,l)))}function eu(r,n,l){var d=r.pending;if(r.pending=null,d!==null){d=d.next;do n.status="rejected",n.reason=l,ag(n),n=n.next;while(n!==d)}r.action=null}function ag(r){r=r.listeners;for(var n=0;n<r.length;n++)(0,r[n])()}function rg(r,n){return n}function ng(r,n){if(Ct){var l=ma.formState;if(l!==null){e:{var d=kt;if(Ct){if(At){t:{for(var x=At,y=In;x.nodeType!==8;){if(!y){x=null;break t}if(x=Mn(x.nextSibling),x===null){x=null;break t}}y=x.data,x=y==="F!"||y==="F"?x:null}if(x){At=Mn(x.nextSibling),d=x.data==="F!";break e}}gs(d)}d=!1}d&&(n=l[0])}}return l=qr(),l.memoizedState=l.baseState=n,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:rg,lastRenderedState:n},l.queue=d,l=Tg.bind(null,kt,d),d.dispatch=l,d=Zf(!1),y=su.bind(null,kt,!1,d.queue),d=qr(),x={state:n,dispatch:null,action:r,pending:null},d.queue=x,l=cb.bind(null,kt,x,y,l),x.dispatch=l,d.memoizedState=r,[n,l,!1]}function ig(r){var n=Xa();return sg(n,ua,r)}function sg(r,n,l){if(n=Jf(r,n,rg)[0],r=Y0(zi)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var d=cc(n)}catch(R){throw R===Zl?I0:R}else d=n;n=Xa();var x=n.queue,y=x.dispatch;return l!==n.memoizedState&&(kt.flags|=2048,no(9,{destroy:void 0},db.bind(null,x,l),null)),[d,y,r]}function db(r,n){r.action=n}function lg(r){var n=Xa(),l=ua;if(l!==null)return sg(n,l,r);Xa(),n=n.memoizedState,l=Xa();var d=l.queue.dispatch;return l.memoizedState=r,[n,d,!1]}function no(r,n,l,d){return r={tag:r,create:l,deps:d,inst:n,next:null},n=kt.updateQueue,n===null&&(n=$0(),kt.updateQueue=n),l=n.lastEffect,l===null?n.lastEffect=r.next=r:(d=l.next,l.next=r,r.next=d,n.lastEffect=r),r}function og(){return Xa().memoizedState}function W0(r,n,l,d){var x=qr();kt.flags|=r,x.memoizedState=no(1|n,{destroy:void 0},l,d===void 0?null:d)}function V0(r,n,l,d){var x=Xa();d=d===void 0?null:d;var y=x.memoizedState.inst;ua!==null&&d!==null&&Yf(d,ua.memoizedState.deps)?x.memoizedState=no(n,y,l,d):(kt.flags|=r,x.memoizedState=no(1|n,y,l,d))}function cg(r,n){W0(8390656,8,r,n)}function tu(r,n){V0(2048,8,r,n)}function fb(r){kt.flags|=4;var n=kt.updateQueue;if(n===null)n=$0(),kt.updateQueue=n,n.events=[r];else{var l=n.events;l===null?n.events=[r]:l.push(r)}}function dg(r){var n=Xa().memoizedState;return fb({ref:n,nextImpl:r}),function(){if((ta&2)!==0)throw Error(i(440));return n.impl.apply(void 0,arguments)}}function fg(r,n){return V0(4,2,r,n)}function ug(r,n){return V0(4,4,r,n)}function pg(r,n){if(typeof n=="function"){r=r();var l=n(r);return function(){typeof l=="function"?l():n(null)}}if(n!=null)return r=r(),n.current=r,function(){n.current=null}}function hg(r,n,l){l=l!=null?l.concat([r]):null,V0(4,4,pg.bind(null,n,r),l)}function au(){}function gg(r,n){var l=Xa();n=n===void 0?null:n;var d=l.memoizedState;return n!==null&&Yf(n,d[1])?d[0]:(l.memoizedState=[r,n],r)}function xg(r,n){var l=Xa();n=n===void 0?null:n;var d=l.memoizedState;if(n!==null&&Yf(n,d[1]))return d[0];if(d=r(),fl){pn(!0);try{r()}finally{pn(!1)}}return l.memoizedState=[d,n],d}function ru(r,n,l){return l===void 0||(Pi&1073741824)!==0&&(Ht&261930)===0?r.memoizedState=n:(r.memoizedState=l,r=m1(),kt.lanes|=r,As|=r,l)}function mg(r,n,l,d){return Ar(l,n)?l:to.current!==null?(r=ru(r,l,d),Ar(r,n)||(tr=!0),r):(Pi&42)===0||(Pi&1073741824)!==0&&(Ht&261930)===0?(tr=!0,r.memoizedState=l):(r=m1(),kt.lanes|=r,As|=r,n)}function vg(r,n,l,d,x){var y=_e.p;_e.p=y!==0&&8>y?y:8;var R=de.T,I={};de.T=I,su(r,!1,n,l);try{var re=x(),be=de.S;if(be!==null&&be(I,re),re!==null&&typeof re=="object"&&typeof re.then=="function"){var je=sb(re,d);dc(r,n,je,Sn(r))}else dc(r,n,d,Sn(r))}catch(Me){dc(r,n,{then:function(){},status:"rejected",reason:Me},Sn())}finally{_e.p=y,R!==null&&I.types!==null&&(R.types=I.types),de.T=R}}function ub(){}function nu(r,n,l,d){if(r.tag!==5)throw Error(i(476));var x=yg(r).queue;vg(r,x,n,Ze,l===null?ub:function(){return bg(r),l(d)})}function yg(r){var n=r.memoizedState;if(n!==null)return n;n={memoizedState:Ze,baseState:Ze,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zi,lastRenderedState:Ze},next:null};var l={};return n.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zi,lastRenderedState:l},next:null},r.memoizedState=n,r=r.alternate,r!==null&&(r.memoizedState=n),n}function bg(r){var n=yg(r);n.next===null&&(n=r.alternate.memoizedState),dc(r,n.next.queue,{},Sn())}function iu(){return kr(kc)}function Sg(){return Xa().memoizedState}function Eg(){return Xa().memoizedState}function pb(r){for(var n=r.return;n!==null;){switch(n.tag){case 24:case 3:var l=Sn();r=vs(l);var d=ys(n,r,l);d!==null&&(on(d,n,l),ic(d,n,l)),n={cache:Of()},r.payload=n;return}n=n.return}}function hb(r,n,l){var d=Sn();l={lane:d,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},X0(r)?Ag(n,l):(l=J(r,n,l,d),l!==null&&(on(l,r,d),_g(l,n,d)))}function Tg(r,n,l){var d=Sn();dc(r,n,l,d)}function dc(r,n,l,d){var x={lane:d,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(X0(r))Ag(n,x);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=n.lastRenderedReducer,y!==null))try{var R=n.lastRenderedState,I=y(R,l);if(x.hasEagerState=!0,x.eagerState=I,Ar(I,R))return Ce(r,n,x,0),ma===null&&Fe(),!1}catch{}if(l=J(r,n,x,d),l!==null)return on(l,r,d),_g(l,n,d),!0}return!1}function su(r,n,l,d){if(d={lane:2,revertLane:Lu(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},X0(r)){if(n)throw Error(i(479))}else n=J(r,l,d,2),n!==null&&on(n,r,2)}function X0(r){var n=r.alternate;return r===kt||n!==null&&n===kt}function Ag(r,n){ao=U0=!0;var l=r.pending;l===null?n.next=n:(n.next=l.next,l.next=n),r.pending=n}function _g(r,n,l){if((l&4194048)!==0){var d=n.lanes;d&=r.pendingLanes,l|=d,n.lanes=l,gr(r,l)}}var fc={readContext:kr,use:G0,useCallback:Ma,useContext:Ma,useEffect:Ma,useImperativeHandle:Ma,useLayoutEffect:Ma,useInsertionEffect:Ma,useMemo:Ma,useReducer:Ma,useRef:Ma,useState:Ma,useDebugValue:Ma,useDeferredValue:Ma,useTransition:Ma,useSyncExternalStore:Ma,useId:Ma,useHostTransitionStatus:Ma,useFormState:Ma,useActionState:Ma,useOptimistic:Ma,useMemoCache:Ma,useCacheRefresh:Ma};fc.useEffectEvent=Ma;var Cg={readContext:kr,use:G0,useCallback:function(r,n){return qr().memoizedState=[r,n===void 0?null:n],r},useContext:kr,useEffect:cg,useImperativeHandle:function(r,n,l){l=l!=null?l.concat([r]):null,W0(4194308,4,pg.bind(null,n,r),l)},useLayoutEffect:function(r,n){return W0(4194308,4,r,n)},useInsertionEffect:function(r,n){W0(4,2,r,n)},useMemo:function(r,n){var l=qr();n=n===void 0?null:n;var d=r();if(fl){pn(!0);try{r()}finally{pn(!1)}}return l.memoizedState=[d,n],d},useReducer:function(r,n,l){var d=qr();if(l!==void 0){var x=l(n);if(fl){pn(!0);try{l(n)}finally{pn(!1)}}}else x=n;return d.memoizedState=d.baseState=x,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:x},d.queue=r,r=r.dispatch=hb.bind(null,kt,r),[d.memoizedState,r]},useRef:function(r){var n=qr();return r={current:r},n.memoizedState=r},useState:function(r){r=Zf(r);var n=r.queue,l=Tg.bind(null,kt,n);return n.dispatch=l,[r.memoizedState,l]},useDebugValue:au,useDeferredValue:function(r,n){var l=qr();return ru(l,r,n)},useTransition:function(){var r=Zf(!1);return r=vg.bind(null,kt,r.queue,!0,!1),qr().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,n,l){var d=kt,x=qr();if(Ct){if(l===void 0)throw Error(i(407));l=l()}else{if(l=n(),ma===null)throw Error(i(349));(Ht&127)!==0||Vh(d,n,l)}x.memoizedState=l;var y={value:l,getSnapshot:n};return x.queue=y,cg(qh.bind(null,d,y,r),[r]),d.flags|=2048,no(9,{destroy:void 0},Xh.bind(null,d,y,l,n),null),l},useId:function(){var r=qr(),n=ma.identifierPrefix;if(Ct){var l=Cr,d=On;l=(d&~(1<<32-Ut(d)-1)).toString(32)+l,n="_"+n+"R_"+l,l=H0++,0<l&&(n+="H"+l.toString(32)),n+="_"}else l=lb++,n="_"+n+"r_"+l.toString(32)+"_";return r.memoizedState=n},useHostTransitionStatus:iu,useFormState:ng,useActionState:ng,useOptimistic:function(r){var n=qr();n.memoizedState=n.baseState=r;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=l,n=su.bind(null,kt,!0,l),l.dispatch=n,[r,n]},useMemoCache:Kf,useCacheRefresh:function(){return qr().memoizedState=pb.bind(null,kt)},useEffectEvent:function(r){var n=qr(),l={impl:r};return n.memoizedState=l,function(){if((ta&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},lu={readContext:kr,use:G0,useCallback:gg,useContext:kr,useEffect:tu,useImperativeHandle:hg,useInsertionEffect:fg,useLayoutEffect:ug,useMemo:xg,useReducer:Y0,useRef:og,useState:function(){return Y0(zi)},useDebugValue:au,useDeferredValue:function(r,n){var l=Xa();return mg(l,ua.memoizedState,r,n)},useTransition:function(){var r=Y0(zi)[0],n=Xa().memoizedState;return[typeof r=="boolean"?r:cc(r),n]},useSyncExternalStore:Wh,useId:Sg,useHostTransitionStatus:iu,useFormState:ig,useActionState:ig,useOptimistic:function(r,n){var l=Xa();return Qh(l,ua,r,n)},useMemoCache:Kf,useCacheRefresh:Eg};lu.useEffectEvent=dg;var kg={readContext:kr,use:G0,useCallback:gg,useContext:kr,useEffect:tu,useImperativeHandle:hg,useInsertionEffect:fg,useLayoutEffect:ug,useMemo:xg,useReducer:Qf,useRef:og,useState:function(){return Qf(zi)},useDebugValue:au,useDeferredValue:function(r,n){var l=Xa();return ua===null?ru(l,r,n):mg(l,ua.memoizedState,r,n)},useTransition:function(){var r=Qf(zi)[0],n=Xa().memoizedState;return[typeof r=="boolean"?r:cc(r),n]},useSyncExternalStore:Wh,useId:Sg,useHostTransitionStatus:iu,useFormState:lg,useActionState:lg,useOptimistic:function(r,n){var l=Xa();return ua!==null?Qh(l,ua,r,n):(l.baseState=r,[r,l.queue.dispatch])},useMemoCache:Kf,useCacheRefresh:Eg};kg.useEffectEvent=dg;function ou(r,n,l,d){n=r.memoizedState,l=l(d,n),l=l==null?n:A({},n,l),r.memoizedState=l,r.lanes===0&&(r.updateQueue.baseState=l)}var cu={enqueueSetState:function(r,n,l){r=r._reactInternals;var d=Sn(),x=vs(d);x.payload=n,l!=null&&(x.callback=l),n=ys(r,x,d),n!==null&&(on(n,r,d),ic(n,r,d))},enqueueReplaceState:function(r,n,l){r=r._reactInternals;var d=Sn(),x=vs(d);x.tag=1,x.payload=n,l!=null&&(x.callback=l),n=ys(r,x,d),n!==null&&(on(n,r,d),ic(n,r,d))},enqueueForceUpdate:function(r,n){r=r._reactInternals;var l=Sn(),d=vs(l);d.tag=2,n!=null&&(d.callback=n),n=ys(r,d,l),n!==null&&(on(n,r,l),ic(n,r,l))}};function wg(r,n,l,d,x,y,R){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(d,y,R):n.prototype&&n.prototype.isPureReactComponent?!Di(l,d)||!Di(x,y):!0}function Rg(r,n,l,d){r=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(l,d),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(l,d),n.state!==r&&cu.enqueueReplaceState(n,n.state,null)}function ul(r,n){var l=n;if("ref"in n){l={};for(var d in n)d!=="ref"&&(l[d]=n[d])}if(r=r.defaultProps){l===n&&(l=A({},l));for(var x in r)l[x]===void 0&&(l[x]=r[x])}return l}function Ng(r){C(r)}function Fg(r){console.error(r)}function jg(r){C(r)}function q0(r,n){try{var l=r.onUncaughtError;l(n.value,{componentStack:n.stack})}catch(d){setTimeout(function(){throw d})}}function Dg(r,n,l){try{var d=r.onCaughtError;d(l.value,{componentStack:l.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function du(r,n,l){return l=vs(l),l.tag=3,l.payload={element:null},l.callback=function(){q0(r,n)},l}function Og(r){return r=vs(r),r.tag=3,r}function Ig(r,n,l,d){var x=l.type.getDerivedStateFromError;if(typeof x=="function"){var y=d.value;r.payload=function(){return x(y)},r.callback=function(){Dg(n,l,d)}}var R=l.stateNode;R!==null&&typeof R.componentDidCatch=="function"&&(r.callback=function(){Dg(n,l,d),typeof x!="function"&&(_s===null?_s=new Set([this]):_s.add(this));var I=d.stack;this.componentDidCatch(d.value,{componentStack:I!==null?I:""})})}function gb(r,n,l,d,x){if(l.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(n=l.alternate,n!==null&&Kl(n,l,x,!0),l=mn.current,l!==null){switch(l.tag){case 31:case 13:return Bn===null?ld():l.alternate===null&&La===0&&(La=3),l.flags&=-257,l.flags|=65536,l.lanes=x,d===B0?l.flags|=16384:(n=l.updateQueue,n===null?l.updateQueue=new Set([d]):n.add(d),Iu(r,d,x)),!1;case 22:return l.flags|=65536,d===B0?l.flags|=16384:(n=l.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([d])},l.updateQueue=n):(l=n.retryQueue,l===null?n.retryQueue=new Set([d]):l.add(d)),Iu(r,d,x)),!1}throw Error(i(435,l.tag))}return Iu(r,d,x),ld(),!1}if(Ct)return n=mn.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=x,d!==Rf&&(r=Error(i(422),{cause:d}),ec(Sa(r,l)))):(d!==Rf&&(n=Error(i(423),{cause:d}),ec(Sa(n,l))),r=r.current.alternate,r.flags|=65536,x&=-x,r.lanes|=x,d=Sa(d,l),x=du(r.stateNode,d,x),zf(r,x),La!==4&&(La=2)),!1;var y=Error(i(520),{cause:d});if(y=Sa(y,l),yc===null?yc=[y]:yc.push(y),La!==4&&(La=2),n===null)return!0;d=Sa(d,l),l=n;do{switch(l.tag){case 3:return l.flags|=65536,r=x&-x,l.lanes|=r,r=du(l.stateNode,d,r),zf(l,r),!1;case 1:if(n=l.type,y=l.stateNode,(l.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(_s===null||!_s.has(y))))return l.flags|=65536,x&=-x,l.lanes|=x,x=Og(x),Ig(x,r,l,d),zf(l,x),!1}l=l.return}while(l!==null);return!1}var fu=Error(i(461)),tr=!1;function wr(r,n,l,d){n.child=r===null?Ph(n,null,l,d):dl(n,r.child,l,d)}function Bg(r,n,l,d,x){l=l.render;var y=n.ref;if("ref"in d){var R={};for(var I in d)I!=="ref"&&(R[I]=d[I])}else R=d;return sl(n),d=Wf(r,n,l,R,y,x),I=Vf(),r!==null&&!tr?(Xf(r,n,x),Ui(r,n,x)):(Ct&&I&&Bi(n),n.flags|=1,wr(r,n,d,x),n.child)}function Mg(r,n,l,d,x){if(r===null){var y=l.type;return typeof y=="function"&&!ot(y)&&y.defaultProps===void 0&&l.compare===null?(n.tag=15,n.type=y,Lg(r,n,y,d,x)):(r=ba(l.type,null,d,n,n.mode,x),r.ref=n.ref,r.return=n,n.child=r)}if(y=r.child,!yu(r,x)){var R=y.memoizedProps;if(l=l.compare,l=l!==null?l:Di,l(R,d)&&r.ref===n.ref)return Ui(r,n,x)}return n.flags|=1,r=Xt(y,d),r.ref=n.ref,r.return=n,n.child=r}function Lg(r,n,l,d,x){if(r!==null){var y=r.memoizedProps;if(Di(y,d)&&r.ref===n.ref)if(tr=!1,n.pendingProps=d=y,yu(r,x))(r.flags&131072)!==0&&(tr=!0);else return n.lanes=r.lanes,Ui(r,n,x)}return uu(r,n,l,d,x)}function Pg(r,n,l,d){var x=d.children,y=r!==null?r.memoizedState:null;if(r===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((n.flags&128)!==0){if(y=y!==null?y.baseLanes|l:l,r!==null){for(d=n.child=r.child,x=0;d!==null;)x=x|d.lanes|d.childLanes,d=d.sibling;d=x&~y}else d=0,n.child=null;return zg(r,n,y,l,d)}if((l&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},r!==null&&O0(n,y!==null?y.cachePool:null),y!==null?Hh(n,y):Hf(),$h(n);else return d=n.lanes=536870912,zg(r,n,y!==null?y.baseLanes|l:l,l,d)}else y!==null?(O0(n,y.cachePool),Hh(n,y),Ss(),n.memoizedState=null):(r!==null&&O0(n,null),Hf(),Ss());return wr(r,n,x,l),n.child}function uc(r,n){return r!==null&&r.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function zg(r,n,l,d,x){var y=Bf();return y=y===null?null:{parent:Za._currentValue,pool:y},n.memoizedState={baseLanes:l,cachePool:y},r!==null&&O0(n,null),Hf(),$h(n),r!==null&&Kl(r,n,d,!0),n.childLanes=x,null}function K0(r,n){return n=Q0({mode:n.mode,children:n.children},r.mode),n.ref=r.ref,r.child=n,n.return=r,n}function Ug(r,n,l){return dl(n,r.child,null,l),r=K0(n,n.pendingProps),r.flags|=2,vn(n),n.memoizedState=null,r}function xb(r,n,l){var d=n.pendingProps,x=(n.flags&128)!==0;if(n.flags&=-129,r===null){if(Ct){if(d.mode==="hidden")return r=K0(n,d),n.lanes=536870912,uc(null,r);if(Gf(n),(r=At)?(r=Z1(r,In),r=r!==null&&r.data==="&"?r:null,r!==null&&(n.memoizedState={dehydrated:r,treeContext:xn!==null?{id:On,overflow:Cr}:null,retryLane:536870912,hydrationErrors:null},l=Wa(r),l.return=n,n.child=l,cr=n,At=null)):r=null,r===null)throw gs(n);return n.lanes=536870912,null}return K0(n,d)}var y=r.memoizedState;if(y!==null){var R=y.dehydrated;if(Gf(n),x)if(n.flags&256)n.flags&=-257,n=Ug(r,n,l);else if(n.memoizedState!==null)n.child=r.child,n.flags|=128,n=null;else throw Error(i(558));else if(tr||Kl(r,n,l,!1),x=(l&r.childLanes)!==0,tr||x){if(d=ma,d!==null&&(R=Ri(d,l),R!==0&&R!==y.retryLane))throw y.retryLane=R,Y(r,R),on(d,r,R),fu;ld(),n=Ug(r,n,l)}else r=y.treeContext,At=Mn(R.nextSibling),cr=n,Ct=!0,dr=null,In=!1,r!==null&&F0(n,r),n=K0(n,d),n.flags|=4096;return n}return r=Xt(r.child,{mode:d.mode,children:d.children}),r.ref=n.ref,n.child=r,r.return=n,r}function J0(r,n){var l=n.ref;if(l===null)r!==null&&r.ref!==null&&(n.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(r===null||r.ref!==l)&&(n.flags|=4194816)}}function uu(r,n,l,d,x){return sl(n),l=Wf(r,n,l,d,void 0,x),d=Vf(),r!==null&&!tr?(Xf(r,n,x),Ui(r,n,x)):(Ct&&d&&Bi(n),n.flags|=1,wr(r,n,l,x),n.child)}function Hg(r,n,l,d,x,y){return sl(n),n.updateQueue=null,l=Yh(n,d,l,x),Gh(r),d=Vf(),r!==null&&!tr?(Xf(r,n,y),Ui(r,n,y)):(Ct&&d&&Bi(n),n.flags|=1,wr(r,n,l,y),n.child)}function $g(r,n,l,d,x){if(sl(n),n.stateNode===null){var y=me,R=l.contextType;typeof R=="object"&&R!==null&&(y=kr(R)),y=new l(d,y),n.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=cu,n.stateNode=y,y._reactInternals=n,y=n.stateNode,y.props=d,y.state=n.memoizedState,y.refs={},Lf(n),R=l.contextType,y.context=typeof R=="object"&&R!==null?kr(R):me,y.state=n.memoizedState,R=l.getDerivedStateFromProps,typeof R=="function"&&(ou(n,l,R,d),y.state=n.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(R=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),R!==y.state&&cu.enqueueReplaceState(y,y.state,null),lc(n,d,y,x),sc(),y.state=n.memoizedState),typeof y.componentDidMount=="function"&&(n.flags|=4194308),d=!0}else if(r===null){y=n.stateNode;var I=n.memoizedProps,re=ul(l,I);y.props=re;var be=y.context,je=l.contextType;R=me,typeof je=="object"&&je!==null&&(R=kr(je));var Me=l.getDerivedStateFromProps;je=typeof Me=="function"||typeof y.getSnapshotBeforeUpdate=="function",I=n.pendingProps!==I,je||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(I||be!==R)&&Rg(n,y,d,R),ms=!1;var Ae=n.memoizedState;y.state=Ae,lc(n,d,y,x),sc(),be=n.memoizedState,I||Ae!==be||ms?(typeof Me=="function"&&(ou(n,l,Me,d),be=n.memoizedState),(re=ms||wg(n,l,re,d,Ae,be,R))?(je||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(n.flags|=4194308)):(typeof y.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=d,n.memoizedState=be),y.props=d,y.state=be,y.context=R,d=re):(typeof y.componentDidMount=="function"&&(n.flags|=4194308),d=!1)}else{y=n.stateNode,Pf(r,n),R=n.memoizedProps,je=ul(l,R),y.props=je,Me=n.pendingProps,Ae=y.context,be=l.contextType,re=me,typeof be=="object"&&be!==null&&(re=kr(be)),I=l.getDerivedStateFromProps,(be=typeof I=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(R!==Me||Ae!==re)&&Rg(n,y,d,re),ms=!1,Ae=n.memoizedState,y.state=Ae,lc(n,d,y,x),sc();var we=n.memoizedState;R!==Me||Ae!==we||ms||r!==null&&r.dependencies!==null&&j0(r.dependencies)?(typeof I=="function"&&(ou(n,l,I,d),we=n.memoizedState),(je=ms||wg(n,l,je,d,Ae,we,re)||r!==null&&r.dependencies!==null&&j0(r.dependencies))?(be||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(d,we,re),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(d,we,re)),typeof y.componentDidUpdate=="function"&&(n.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof y.componentDidUpdate!="function"||R===r.memoizedProps&&Ae===r.memoizedState||(n.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||R===r.memoizedProps&&Ae===r.memoizedState||(n.flags|=1024),n.memoizedProps=d,n.memoizedState=we),y.props=d,y.state=we,y.context=re,d=je):(typeof y.componentDidUpdate!="function"||R===r.memoizedProps&&Ae===r.memoizedState||(n.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||R===r.memoizedProps&&Ae===r.memoizedState||(n.flags|=1024),d=!1)}return y=d,J0(r,n),d=(n.flags&128)!==0,y||d?(y=n.stateNode,l=d&&typeof l.getDerivedStateFromError!="function"?null:y.render(),n.flags|=1,r!==null&&d?(n.child=dl(n,r.child,null,x),n.child=dl(n,null,l,x)):wr(r,n,l,x),n.memoizedState=y.state,r=n.child):r=Ui(r,n,x),r}function Gg(r,n,l,d){return nl(),n.flags|=256,wr(r,n,l,d),n.child}var pu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function hu(r){return{baseLanes:r,cachePool:Dh()}}function gu(r,n,l){return r=r!==null?r.childLanes&~l:0,n&&(r|=bn),r}function Yg(r,n,l){var d=n.pendingProps,x=!1,y=(n.flags&128)!==0,R;if((R=y)||(R=r!==null&&r.memoizedState===null?!1:(Va.current&2)!==0),R&&(x=!0,n.flags&=-129),R=(n.flags&32)!==0,n.flags&=-33,r===null){if(Ct){if(x?bs(n):Ss(),(r=At)?(r=Z1(r,In),r=r!==null&&r.data!=="&"?r:null,r!==null&&(n.memoizedState={dehydrated:r,treeContext:xn!==null?{id:On,overflow:Cr}:null,retryLane:536870912,hydrationErrors:null},l=Wa(r),l.return=n,n.child=l,cr=n,At=null)):r=null,r===null)throw gs(n);return Ju(r)?n.lanes=32:n.lanes=536870912,null}var I=d.children;return d=d.fallback,x?(Ss(),x=n.mode,I=Q0({mode:"hidden",children:I},x),d=nt(d,x,l,null),I.return=n,d.return=n,I.sibling=d,n.child=I,d=n.child,d.memoizedState=hu(l),d.childLanes=gu(r,R,l),n.memoizedState=pu,uc(null,d)):(bs(n),xu(n,I))}var re=r.memoizedState;if(re!==null&&(I=re.dehydrated,I!==null)){if(y)n.flags&256?(bs(n),n.flags&=-257,n=mu(r,n,l)):n.memoizedState!==null?(Ss(),n.child=r.child,n.flags|=128,n=null):(Ss(),I=d.fallback,x=n.mode,d=Q0({mode:"visible",children:d.children},x),I=nt(I,x,l,null),I.flags|=2,d.return=n,I.return=n,d.sibling=I,n.child=d,dl(n,r.child,null,l),d=n.child,d.memoizedState=hu(l),d.childLanes=gu(r,R,l),n.memoizedState=pu,n=uc(null,d));else if(bs(n),Ju(I)){if(R=I.nextSibling&&I.nextSibling.dataset,R)var be=R.dgst;R=be,d=Error(i(419)),d.stack="",d.digest=R,ec({value:d,source:null,stack:null}),n=mu(r,n,l)}else if(tr||Kl(r,n,l,!1),R=(l&r.childLanes)!==0,tr||R){if(R=ma,R!==null&&(d=Ri(R,l),d!==0&&d!==re.retryLane))throw re.retryLane=d,Y(r,d),on(R,r,d),fu;Ku(I)||ld(),n=mu(r,n,l)}else Ku(I)?(n.flags|=192,n.child=r.child,n=null):(r=re.treeContext,At=Mn(I.nextSibling),cr=n,Ct=!0,dr=null,In=!1,r!==null&&F0(n,r),n=xu(n,d.children),n.flags|=4096);return n}return x?(Ss(),I=d.fallback,x=n.mode,re=r.child,be=re.sibling,d=Xt(re,{mode:"hidden",children:d.children}),d.subtreeFlags=re.subtreeFlags&65011712,be!==null?I=Xt(be,I):(I=nt(I,x,l,null),I.flags|=2),I.return=n,d.return=n,d.sibling=I,n.child=d,uc(null,d),d=n.child,I=r.child.memoizedState,I===null?I=hu(l):(x=I.cachePool,x!==null?(re=Za._currentValue,x=x.parent!==re?{parent:re,pool:re}:x):x=Dh(),I={baseLanes:I.baseLanes|l,cachePool:x}),d.memoizedState=I,d.childLanes=gu(r,R,l),n.memoizedState=pu,uc(r.child,d)):(bs(n),l=r.child,r=l.sibling,l=Xt(l,{mode:"visible",children:d.children}),l.return=n,l.sibling=null,r!==null&&(R=n.deletions,R===null?(n.deletions=[r],n.flags|=16):R.push(r)),n.child=l,n.memoizedState=null,l)}function xu(r,n){return n=Q0({mode:"visible",children:n},r.mode),n.return=r,r.child=n}function Q0(r,n){return r=Ye(22,r,null,n),r.lanes=0,r}function mu(r,n,l){return dl(n,r.child,null,l),r=xu(n,n.pendingProps.children),r.flags|=2,n.memoizedState=null,r}function Wg(r,n,l){r.lanes|=n;var d=r.alternate;d!==null&&(d.lanes|=n),jf(r.return,n,l)}function vu(r,n,l,d,x,y){var R=r.memoizedState;R===null?r.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:d,tail:l,tailMode:x,treeForkCount:y}:(R.isBackwards=n,R.rendering=null,R.renderingStartTime=0,R.last=d,R.tail=l,R.tailMode=x,R.treeForkCount=y)}function Vg(r,n,l){var d=n.pendingProps,x=d.revealOrder,y=d.tail;d=d.children;var R=Va.current,I=(R&2)!==0;if(I?(R=R&1|2,n.flags|=128):R&=1,L(Va,R),wr(r,n,d,l),d=Ct?Ii:0,!I&&r!==null&&(r.flags&128)!==0)e:for(r=n.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Wg(r,l,n);else if(r.tag===19)Wg(r,l,n);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(x){case"forwards":for(l=n.child,x=null;l!==null;)r=l.alternate,r!==null&&z0(r)===null&&(x=l),l=l.sibling;l=x,l===null?(x=n.child,n.child=null):(x=l.sibling,l.sibling=null),vu(n,!1,x,l,y,d);break;case"backwards":case"unstable_legacy-backwards":for(l=null,x=n.child,n.child=null;x!==null;){if(r=x.alternate,r!==null&&z0(r)===null){n.child=x;break}r=x.sibling,x.sibling=l,l=x,x=r}vu(n,!0,l,null,y,d);break;case"together":vu(n,!1,null,null,void 0,d);break;default:n.memoizedState=null}return n.child}function Ui(r,n,l){if(r!==null&&(n.dependencies=r.dependencies),As|=n.lanes,(l&n.childLanes)===0)if(r!==null){if(Kl(r,n,l,!1),(l&n.childLanes)===0)return null}else return null;if(r!==null&&n.child!==r.child)throw Error(i(153));if(n.child!==null){for(r=n.child,l=Xt(r,r.pendingProps),n.child=l,l.return=n;r.sibling!==null;)r=r.sibling,l=l.sibling=Xt(r,r.pendingProps),l.return=n;l.sibling=null}return n.child}function yu(r,n){return(r.lanes&n)!==0?!0:(r=r.dependencies,!!(r!==null&&j0(r)))}function mb(r,n,l){switch(n.tag){case 3:Ue(n,n.stateNode.containerInfo),xs(n,Za,r.memoizedState.cache),nl();break;case 27:case 5:He(n);break;case 4:Ue(n,n.stateNode.containerInfo);break;case 10:xs(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,Gf(n),null;break;case 13:var d=n.memoizedState;if(d!==null)return d.dehydrated!==null?(bs(n),n.flags|=128,null):(l&n.child.childLanes)!==0?Yg(r,n,l):(bs(n),r=Ui(r,n,l),r!==null?r.sibling:null);bs(n);break;case 19:var x=(r.flags&128)!==0;if(d=(l&n.childLanes)!==0,d||(Kl(r,n,l,!1),d=(l&n.childLanes)!==0),x){if(d)return Vg(r,n,l);n.flags|=128}if(x=n.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),L(Va,Va.current),d)break;return null;case 22:return n.lanes=0,Pg(r,n,l,n.pendingProps);case 24:xs(n,Za,r.memoizedState.cache)}return Ui(r,n,l)}function Xg(r,n,l){if(r!==null)if(r.memoizedProps!==n.pendingProps)tr=!0;else{if(!yu(r,l)&&(n.flags&128)===0)return tr=!1,mb(r,n,l);tr=(r.flags&131072)!==0}else tr=!1,Ct&&(n.flags&1048576)!==0&&hs(n,Ii,n.index);switch(n.lanes=0,n.tag){case 16:e:{var d=n.pendingProps;if(r=ol(n.elementType),n.type=r,typeof r=="function")ot(r)?(d=ul(r,d),n.tag=1,n=$g(null,n,r,d,l)):(n.tag=0,n=uu(null,n,r,d,l));else{if(r!=null){var x=r.$$typeof;if(x===ie){n.tag=11,n=Bg(null,n,r,d,l);break e}else if(x===H){n.tag=14,n=Mg(null,n,r,d,l);break e}}throw n=tt(r)||r,Error(i(306,n,""))}}return n;case 0:return uu(r,n,n.type,n.pendingProps,l);case 1:return d=n.type,x=ul(d,n.pendingProps),$g(r,n,d,x,l);case 3:e:{if(Ue(n,n.stateNode.containerInfo),r===null)throw Error(i(387));d=n.pendingProps;var y=n.memoizedState;x=y.element,Pf(r,n),lc(n,d,null,l);var R=n.memoizedState;if(d=R.cache,xs(n,Za,d),d!==y.cache&&Df(n,[Za],l,!0),sc(),d=R.element,y.isDehydrated)if(y={element:d,isDehydrated:!1,cache:R.cache},n.updateQueue.baseState=y,n.memoizedState=y,n.flags&256){n=Gg(r,n,d,l);break e}else if(d!==x){x=Sa(Error(i(424)),n),ec(x),n=Gg(r,n,d,l);break e}else for(r=n.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,At=Mn(r.firstChild),cr=n,Ct=!0,dr=null,In=!0,l=Ph(n,null,d,l),n.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(nl(),d===x){n=Ui(r,n,l);break e}wr(r,n,d,l)}n=n.child}return n;case 26:return J0(r,n),r===null?(l=ix(n.type,null,n.pendingProps,null))?n.memoizedState=l:Ct||(l=n.type,r=n.pendingProps,d=hd(he.current).createElement(l),d[U]=n,d[G]=r,Rr(d,l,r),it(d),n.stateNode=d):n.memoizedState=ix(n.type,r.memoizedProps,n.pendingProps,r.memoizedState),null;case 27:return He(n),r===null&&Ct&&(d=n.stateNode=ax(n.type,n.pendingProps,he.current),cr=n,In=!0,x=At,Rs(n.type)?(Qu=x,At=Mn(d.firstChild)):At=x),wr(r,n,n.pendingProps.children,l),J0(r,n),r===null&&(n.flags|=4194304),n.child;case 5:return r===null&&Ct&&((x=d=At)&&(d=Vb(d,n.type,n.pendingProps,In),d!==null?(n.stateNode=d,cr=n,At=Mn(d.firstChild),In=!1,x=!0):x=!1),x||gs(n)),He(n),x=n.type,y=n.pendingProps,R=r!==null?r.memoizedProps:null,d=y.children,Vu(x,y)?d=null:R!==null&&Vu(x,R)&&(n.flags|=32),n.memoizedState!==null&&(x=Wf(r,n,ob,null,null,l),kc._currentValue=x),J0(r,n),wr(r,n,d,l),n.child;case 6:return r===null&&Ct&&((r=l=At)&&(l=Xb(l,n.pendingProps,In),l!==null?(n.stateNode=l,cr=n,At=null,r=!0):r=!1),r||gs(n)),null;case 13:return Yg(r,n,l);case 4:return Ue(n,n.stateNode.containerInfo),d=n.pendingProps,r===null?n.child=dl(n,null,d,l):wr(r,n,d,l),n.child;case 11:return Bg(r,n,n.type,n.pendingProps,l);case 7:return wr(r,n,n.pendingProps,l),n.child;case 8:return wr(r,n,n.pendingProps.children,l),n.child;case 12:return wr(r,n,n.pendingProps.children,l),n.child;case 10:return d=n.pendingProps,xs(n,n.type,d.value),wr(r,n,d.children,l),n.child;case 9:return x=n.type._context,d=n.pendingProps.children,sl(n),x=kr(x),d=d(x),n.flags|=1,wr(r,n,d,l),n.child;case 14:return Mg(r,n,n.type,n.pendingProps,l);case 15:return Lg(r,n,n.type,n.pendingProps,l);case 19:return Vg(r,n,l);case 31:return xb(r,n,l);case 22:return Pg(r,n,l,n.pendingProps);case 24:return sl(n),d=kr(Za),r===null?(x=Bf(),x===null&&(x=ma,y=Of(),x.pooledCache=y,y.refCount++,y!==null&&(x.pooledCacheLanes|=l),x=y),n.memoizedState={parent:d,cache:x},Lf(n),xs(n,Za,x)):((r.lanes&l)!==0&&(Pf(r,n),lc(n,null,null,l),sc()),x=r.memoizedState,y=n.memoizedState,x.parent!==d?(x={parent:d,cache:d},n.memoizedState=x,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=x),xs(n,Za,d)):(d=y.cache,xs(n,Za,d),d!==x.cache&&Df(n,[Za],l,!0))),wr(r,n,n.pendingProps.children,l),n.child;case 29:throw n.pendingProps}throw Error(i(156,n.tag))}function Hi(r){r.flags|=4}function bu(r,n,l,d,x){if((n=(r.mode&32)!==0)&&(n=!1),n){if(r.flags|=16777216,(x&335544128)===x)if(r.stateNode.complete)r.flags|=8192;else if(S1())r.flags|=8192;else throw cl=B0,Mf}else r.flags&=-16777217}function qg(r,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!dx(n))if(S1())r.flags|=8192;else throw cl=B0,Mf}function Z0(r,n){n!==null&&(r.flags|=4),r.flags&16384&&(n=r.tag!==22?Ys():536870912,r.lanes|=n,oo|=n)}function pc(r,n){if(!Ct)switch(r.tailMode){case"hidden":n=r.tail;for(var l=null;n!==null;)n.alternate!==null&&(l=n),n=n.sibling;l===null?r.tail=null:l.sibling=null;break;case"collapsed":l=r.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?n||r.tail===null?r.tail=null:r.tail.sibling=null:d.sibling=null}}function _a(r){var n=r.alternate!==null&&r.alternate.child===r.child,l=0,d=0;if(n)for(var x=r.child;x!==null;)l|=x.lanes|x.childLanes,d|=x.subtreeFlags&65011712,d|=x.flags&65011712,x.return=r,x=x.sibling;else for(x=r.child;x!==null;)l|=x.lanes|x.childLanes,d|=x.subtreeFlags,d|=x.flags,x.return=r,x=x.sibling;return r.subtreeFlags|=d,r.childLanes=l,n}function vb(r,n,l){var d=n.pendingProps;switch(Zo(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _a(n),null;case 1:return _a(n),null;case 3:return l=n.stateNode,d=null,r!==null&&(d=r.memoizedState.cache),n.memoizedState.cache!==d&&(n.flags|=2048),Li(Za),Ie(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(r===null||r.child===null)&&(ql(n)?Hi(n):r===null||r.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Nf())),_a(n),null;case 26:var x=n.type,y=n.memoizedState;return r===null?(Hi(n),y!==null?(_a(n),qg(n,y)):(_a(n),bu(n,x,null,d,l))):y?y!==r.memoizedState?(Hi(n),_a(n),qg(n,y)):(_a(n),n.flags&=-16777217):(r=r.memoizedProps,r!==d&&Hi(n),_a(n),bu(n,x,r,d,l)),null;case 27:if(gt(n),l=he.current,x=n.type,r!==null&&n.stateNode!=null)r.memoizedProps!==d&&Hi(n);else{if(!d){if(n.stateNode===null)throw Error(i(166));return _a(n),null}r=K.current,ql(n)?wh(n):(r=ax(x,d,l),n.stateNode=r,Hi(n))}return _a(n),null;case 5:if(gt(n),x=n.type,r!==null&&n.stateNode!=null)r.memoizedProps!==d&&Hi(n);else{if(!d){if(n.stateNode===null)throw Error(i(166));return _a(n),null}if(y=K.current,ql(n))wh(n);else{var R=hd(he.current);switch(y){case 1:y=R.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:y=R.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":y=R.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":y=R.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":y=R.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof d.is=="string"?R.createElement("select",{is:d.is}):R.createElement("select"),d.multiple?y.multiple=!0:d.size&&(y.size=d.size);break;default:y=typeof d.is=="string"?R.createElement(x,{is:d.is}):R.createElement(x)}}y[U]=n,y[G]=d;e:for(R=n.child;R!==null;){if(R.tag===5||R.tag===6)y.appendChild(R.stateNode);else if(R.tag!==4&&R.tag!==27&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===n)break e;for(;R.sibling===null;){if(R.return===null||R.return===n)break e;R=R.return}R.sibling.return=R.return,R=R.sibling}n.stateNode=y;e:switch(Rr(y,x,d),x){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&Hi(n)}}return _a(n),bu(n,n.type,r===null?null:r.memoizedProps,n.pendingProps,l),null;case 6:if(r&&n.stateNode!=null)r.memoizedProps!==d&&Hi(n);else{if(typeof d!="string"&&n.stateNode===null)throw Error(i(166));if(r=he.current,ql(n)){if(r=n.stateNode,l=n.memoizedProps,d=null,x=cr,x!==null)switch(x.tag){case 27:case 5:d=x.memoizedProps}r[U]=n,r=!!(r.nodeValue===l||d!==null&&d.suppressHydrationWarning===!0||Y1(r.nodeValue,l)),r||gs(n,!0)}else r=hd(r).createTextNode(d),r[U]=n,n.stateNode=r}return _a(n),null;case 31:if(l=n.memoizedState,r===null||r.memoizedState!==null){if(d=ql(n),l!==null){if(r===null){if(!d)throw Error(i(318));if(r=n.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[U]=n}else nl(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;_a(n),r=!1}else l=Nf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=l),r=!0;if(!r)return n.flags&256?(vn(n),n):(vn(n),null);if((n.flags&128)!==0)throw Error(i(558))}return _a(n),null;case 13:if(d=n.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(x=ql(n),d!==null&&d.dehydrated!==null){if(r===null){if(!x)throw Error(i(318));if(x=n.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(i(317));x[U]=n}else nl(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;_a(n),x=!1}else x=Nf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=x),x=!0;if(!x)return n.flags&256?(vn(n),n):(vn(n),null)}return vn(n),(n.flags&128)!==0?(n.lanes=l,n):(l=d!==null,r=r!==null&&r.memoizedState!==null,l&&(d=n.child,x=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(x=d.alternate.memoizedState.cachePool.pool),y=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(y=d.memoizedState.cachePool.pool),y!==x&&(d.flags|=2048)),l!==r&&l&&(n.child.flags|=8192),Z0(n,n.updateQueue),_a(n),null);case 4:return Ie(),r===null&&Hu(n.stateNode.containerInfo),_a(n),null;case 10:return Li(n.type),_a(n),null;case 19:if(O(Va),d=n.memoizedState,d===null)return _a(n),null;if(x=(n.flags&128)!==0,y=d.rendering,y===null)if(x)pc(d,!1);else{if(La!==0||r!==null&&(r.flags&128)!==0)for(r=n.child;r!==null;){if(y=z0(r),y!==null){for(n.flags|=128,pc(d,!1),r=y.updateQueue,n.updateQueue=r,Z0(n,r),n.subtreeFlags=0,r=l,l=n.child;l!==null;)ct(l,r),l=l.sibling;return L(Va,Va.current&1|2),Ct&&ei(n,d.treeForkCount),n.child}r=r.sibling}d.tail!==null&&ia()>nd&&(n.flags|=128,x=!0,pc(d,!1),n.lanes=4194304)}else{if(!x)if(r=z0(y),r!==null){if(n.flags|=128,x=!0,r=r.updateQueue,n.updateQueue=r,Z0(n,r),pc(d,!0),d.tail===null&&d.tailMode==="hidden"&&!y.alternate&&!Ct)return _a(n),null}else 2*ia()-d.renderingStartTime>nd&&l!==536870912&&(n.flags|=128,x=!0,pc(d,!1),n.lanes=4194304);d.isBackwards?(y.sibling=n.child,n.child=y):(r=d.last,r!==null?r.sibling=y:n.child=y,d.last=y)}return d.tail!==null?(r=d.tail,d.rendering=r,d.tail=r.sibling,d.renderingStartTime=ia(),r.sibling=null,l=Va.current,L(Va,x?l&1|2:l&1),Ct&&ei(n,d.treeForkCount),r):(_a(n),null);case 22:case 23:return vn(n),$f(),d=n.memoizedState!==null,r!==null?r.memoizedState!==null!==d&&(n.flags|=8192):d&&(n.flags|=8192),d?(l&536870912)!==0&&(n.flags&128)===0&&(_a(n),n.subtreeFlags&6&&(n.flags|=8192)):_a(n),l=n.updateQueue,l!==null&&Z0(n,l.retryQueue),l=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),d=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(d=n.memoizedState.cachePool.pool),d!==l&&(n.flags|=2048),r!==null&&O(ll),null;case 24:return l=null,r!==null&&(l=r.memoizedState.cache),n.memoizedState.cache!==l&&(n.flags|=2048),Li(Za),_a(n),null;case 25:return null;case 30:return null}throw Error(i(156,n.tag))}function yb(r,n){switch(Zo(n),n.tag){case 1:return r=n.flags,r&65536?(n.flags=r&-65537|128,n):null;case 3:return Li(Za),Ie(),r=n.flags,(r&65536)!==0&&(r&128)===0?(n.flags=r&-65537|128,n):null;case 26:case 27:case 5:return gt(n),null;case 31:if(n.memoizedState!==null){if(vn(n),n.alternate===null)throw Error(i(340));nl()}return r=n.flags,r&65536?(n.flags=r&-65537|128,n):null;case 13:if(vn(n),r=n.memoizedState,r!==null&&r.dehydrated!==null){if(n.alternate===null)throw Error(i(340));nl()}return r=n.flags,r&65536?(n.flags=r&-65537|128,n):null;case 19:return O(Va),null;case 4:return Ie(),null;case 10:return Li(n.type),null;case 22:case 23:return vn(n),$f(),r!==null&&O(ll),r=n.flags,r&65536?(n.flags=r&-65537|128,n):null;case 24:return Li(Za),null;case 25:return null;default:return null}}function Kg(r,n){switch(Zo(n),n.tag){case 3:Li(Za),Ie();break;case 26:case 27:case 5:gt(n);break;case 4:Ie();break;case 31:n.memoizedState!==null&&vn(n);break;case 13:vn(n);break;case 19:O(Va);break;case 10:Li(n.type);break;case 22:case 23:vn(n),$f(),r!==null&&O(ll);break;case 24:Li(Za)}}function hc(r,n){try{var l=n.updateQueue,d=l!==null?l.lastEffect:null;if(d!==null){var x=d.next;l=x;do{if((l.tag&r)===r){d=void 0;var y=l.create,R=l.inst;d=y(),R.destroy=d}l=l.next}while(l!==x)}}catch(I){oa(n,n.return,I)}}function Es(r,n,l){try{var d=n.updateQueue,x=d!==null?d.lastEffect:null;if(x!==null){var y=x.next;d=y;do{if((d.tag&r)===r){var R=d.inst,I=R.destroy;if(I!==void 0){R.destroy=void 0,x=n;var re=l,be=I;try{be()}catch(je){oa(x,re,je)}}}d=d.next}while(d!==y)}}catch(je){oa(n,n.return,je)}}function Jg(r){var n=r.updateQueue;if(n!==null){var l=r.stateNode;try{Uh(n,l)}catch(d){oa(r,r.return,d)}}}function Qg(r,n,l){l.props=ul(r.type,r.memoizedProps),l.state=r.memoizedState;try{l.componentWillUnmount()}catch(d){oa(r,n,d)}}function gc(r,n){try{var l=r.ref;if(l!==null){switch(r.tag){case 26:case 27:case 5:var d=r.stateNode;break;case 30:d=r.stateNode;break;default:d=r.stateNode}typeof l=="function"?r.refCleanup=l(d):l.current=d}}catch(x){oa(r,n,x)}}function yi(r,n){var l=r.ref,d=r.refCleanup;if(l!==null)if(typeof d=="function")try{d()}catch(x){oa(r,n,x)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(x){oa(r,n,x)}else l.current=null}function Zg(r){var n=r.type,l=r.memoizedProps,d=r.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":l.autoFocus&&d.focus();break e;case"img":l.src?d.src=l.src:l.srcSet&&(d.srcset=l.srcSet)}}catch(x){oa(r,r.return,x)}}function Su(r,n,l){try{var d=r.stateNode;Ub(d,r.type,l,n),d[G]=n}catch(x){oa(r,r.return,x)}}function e1(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Rs(r.type)||r.tag===4}function Eu(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||e1(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Rs(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Tu(r,n,l){var d=r.tag;if(d===5||d===6)r=r.stateNode,n?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(r,n):(n=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,n.appendChild(r),l=l._reactRootContainer,l!=null||n.onclick!==null||(n.onclick=qn));else if(d!==4&&(d===27&&Rs(r.type)&&(l=r.stateNode,n=null),r=r.child,r!==null))for(Tu(r,n,l),r=r.sibling;r!==null;)Tu(r,n,l),r=r.sibling}function ed(r,n,l){var d=r.tag;if(d===5||d===6)r=r.stateNode,n?l.insertBefore(r,n):l.appendChild(r);else if(d!==4&&(d===27&&Rs(r.type)&&(l=r.stateNode),r=r.child,r!==null))for(ed(r,n,l),r=r.sibling;r!==null;)ed(r,n,l),r=r.sibling}function t1(r){var n=r.stateNode,l=r.memoizedProps;try{for(var d=r.type,x=n.attributes;x.length;)n.removeAttributeNode(x[0]);Rr(n,d,l),n[U]=r,n[G]=l}catch(y){oa(r,r.return,y)}}var $i=!1,ar=!1,Au=!1,a1=typeof WeakSet=="function"?WeakSet:Set,vr=null;function bb(r,n){if(r=r.containerInfo,Yu=Sd,r=R0(r),Jo(r)){if("selectionStart"in r)var l={start:r.selectionStart,end:r.selectionEnd};else e:{l=(l=r.ownerDocument)&&l.defaultView||window;var d=l.getSelection&&l.getSelection();if(d&&d.rangeCount!==0){l=d.anchorNode;var x=d.anchorOffset,y=d.focusNode;d=d.focusOffset;try{l.nodeType,y.nodeType}catch{l=null;break e}var R=0,I=-1,re=-1,be=0,je=0,Me=r,Ae=null;t:for(;;){for(var we;Me!==l||x!==0&&Me.nodeType!==3||(I=R+x),Me!==y||d!==0&&Me.nodeType!==3||(re=R+d),Me.nodeType===3&&(R+=Me.nodeValue.length),(we=Me.firstChild)!==null;)Ae=Me,Me=we;for(;;){if(Me===r)break t;if(Ae===l&&++be===x&&(I=R),Ae===y&&++je===d&&(re=R),(we=Me.nextSibling)!==null)break;Me=Ae,Ae=Me.parentNode}Me=we}l=I===-1||re===-1?null:{start:I,end:re}}else l=null}l=l||{start:0,end:0}}else l=null;for(Wu={focusedElem:r,selectionRange:l},Sd=!1,vr=n;vr!==null;)if(n=vr,r=n.child,(n.subtreeFlags&1028)!==0&&r!==null)r.return=n,vr=r;else for(;vr!==null;){switch(n=vr,y=n.alternate,r=n.flags,n.tag){case 0:if((r&4)!==0&&(r=n.updateQueue,r=r!==null?r.events:null,r!==null))for(l=0;l<r.length;l++)x=r[l],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,l=n,x=y.memoizedProps,y=y.memoizedState,d=l.stateNode;try{var st=ul(l.type,x);r=d.getSnapshotBeforeUpdate(st,y),d.__reactInternalSnapshotBeforeUpdate=r}catch(xt){oa(l,l.return,xt)}}break;case 3:if((r&1024)!==0){if(r=n.stateNode.containerInfo,l=r.nodeType,l===9)qu(r);else if(l===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":qu(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=n.sibling,r!==null){r.return=n.return,vr=r;break}vr=n.return}}function r1(r,n,l){var d=l.flags;switch(l.tag){case 0:case 11:case 15:Yi(r,l),d&4&&hc(5,l);break;case 1:if(Yi(r,l),d&4)if(r=l.stateNode,n===null)try{r.componentDidMount()}catch(R){oa(l,l.return,R)}else{var x=ul(l.type,n.memoizedProps);n=n.memoizedState;try{r.componentDidUpdate(x,n,r.__reactInternalSnapshotBeforeUpdate)}catch(R){oa(l,l.return,R)}}d&64&&Jg(l),d&512&&gc(l,l.return);break;case 3:if(Yi(r,l),d&64&&(r=l.updateQueue,r!==null)){if(n=null,l.child!==null)switch(l.child.tag){case 27:case 5:n=l.child.stateNode;break;case 1:n=l.child.stateNode}try{Uh(r,n)}catch(R){oa(l,l.return,R)}}break;case 27:n===null&&d&4&&t1(l);case 26:case 5:Yi(r,l),n===null&&d&4&&Zg(l),d&512&&gc(l,l.return);break;case 12:Yi(r,l);break;case 31:Yi(r,l),d&4&&s1(r,l);break;case 13:Yi(r,l),d&4&&l1(r,l),d&64&&(r=l.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(l=Rb.bind(null,l),qb(r,l))));break;case 22:if(d=l.memoizedState!==null||$i,!d){n=n!==null&&n.memoizedState!==null||ar,x=$i;var y=ar;$i=d,(ar=n)&&!y?Wi(r,l,(l.subtreeFlags&8772)!==0):Yi(r,l),$i=x,ar=y}break;case 30:break;default:Yi(r,l)}}function n1(r){var n=r.alternate;n!==null&&(r.alternate=null,n1(n)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(n=r.stateNode,n!==null&&De(n)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Fa=null,rn=!1;function Gi(r,n,l){for(l=l.child;l!==null;)i1(r,n,l),l=l.sibling}function i1(r,n,l){if(Ta&&typeof Ta.onCommitFiberUnmount=="function")try{Ta.onCommitFiberUnmount(na,l)}catch{}switch(l.tag){case 26:ar||yi(l,n),Gi(r,n,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:ar||yi(l,n);var d=Fa,x=rn;Rs(l.type)&&(Fa=l.stateNode,rn=!1),Gi(r,n,l),Ac(l.stateNode),Fa=d,rn=x;break;case 5:ar||yi(l,n);case 6:if(d=Fa,x=rn,Fa=null,Gi(r,n,l),Fa=d,rn=x,Fa!==null)if(rn)try{(Fa.nodeType===9?Fa.body:Fa.nodeName==="HTML"?Fa.ownerDocument.body:Fa).removeChild(l.stateNode)}catch(y){oa(l,n,y)}else try{Fa.removeChild(l.stateNode)}catch(y){oa(l,n,y)}break;case 18:Fa!==null&&(rn?(r=Fa,J1(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,l.stateNode),mo(r)):J1(Fa,l.stateNode));break;case 4:d=Fa,x=rn,Fa=l.stateNode.containerInfo,rn=!0,Gi(r,n,l),Fa=d,rn=x;break;case 0:case 11:case 14:case 15:Es(2,l,n),ar||Es(4,l,n),Gi(r,n,l);break;case 1:ar||(yi(l,n),d=l.stateNode,typeof d.componentWillUnmount=="function"&&Qg(l,n,d)),Gi(r,n,l);break;case 21:Gi(r,n,l);break;case 22:ar=(d=ar)||l.memoizedState!==null,Gi(r,n,l),ar=d;break;default:Gi(r,n,l)}}function s1(r,n){if(n.memoizedState===null&&(r=n.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{mo(r)}catch(l){oa(n,n.return,l)}}}function l1(r,n){if(n.memoizedState===null&&(r=n.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{mo(r)}catch(l){oa(n,n.return,l)}}function Sb(r){switch(r.tag){case 31:case 13:case 19:var n=r.stateNode;return n===null&&(n=r.stateNode=new a1),n;case 22:return r=r.stateNode,n=r._retryCache,n===null&&(n=r._retryCache=new a1),n;default:throw Error(i(435,r.tag))}}function td(r,n){var l=Sb(r);n.forEach(function(d){if(!l.has(d)){l.add(d);var x=Nb.bind(null,r,d);d.then(x,x)}})}function nn(r,n){var l=n.deletions;if(l!==null)for(var d=0;d<l.length;d++){var x=l[d],y=r,R=n,I=R;e:for(;I!==null;){switch(I.tag){case 27:if(Rs(I.type)){Fa=I.stateNode,rn=!1;break e}break;case 5:Fa=I.stateNode,rn=!1;break e;case 3:case 4:Fa=I.stateNode.containerInfo,rn=!0;break e}I=I.return}if(Fa===null)throw Error(i(160));i1(y,R,x),Fa=null,rn=!1,y=x.alternate,y!==null&&(y.return=null),x.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)o1(n,r),n=n.sibling}var ti=null;function o1(r,n){var l=r.alternate,d=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:nn(n,r),sn(r),d&4&&(Es(3,r,r.return),hc(3,r),Es(5,r,r.return));break;case 1:nn(n,r),sn(r),d&512&&(ar||l===null||yi(l,l.return)),d&64&&$i&&(r=r.updateQueue,r!==null&&(d=r.callbacks,d!==null&&(l=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=l===null?d:l.concat(d))));break;case 26:var x=ti;if(nn(n,r),sn(r),d&512&&(ar||l===null||yi(l,l.return)),d&4){var y=l!==null?l.memoizedState:null;if(d=r.memoizedState,l===null)if(d===null)if(r.stateNode===null){e:{d=r.type,l=r.memoizedProps,x=x.ownerDocument||x;t:switch(d){case"title":y=x.getElementsByTagName("title")[0],(!y||y[ge]||y[U]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=x.createElement(d),x.head.insertBefore(y,x.querySelector("head > title"))),Rr(y,d,l),y[U]=r,it(y),d=y;break e;case"link":var R=ox("link","href",x).get(d+(l.href||""));if(R){for(var I=0;I<R.length;I++)if(y=R[I],y.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&y.getAttribute("rel")===(l.rel==null?null:l.rel)&&y.getAttribute("title")===(l.title==null?null:l.title)&&y.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){R.splice(I,1);break t}}y=x.createElement(d),Rr(y,d,l),x.head.appendChild(y);break;case"meta":if(R=ox("meta","content",x).get(d+(l.content||""))){for(I=0;I<R.length;I++)if(y=R[I],y.getAttribute("content")===(l.content==null?null:""+l.content)&&y.getAttribute("name")===(l.name==null?null:l.name)&&y.getAttribute("property")===(l.property==null?null:l.property)&&y.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&y.getAttribute("charset")===(l.charSet==null?null:l.charSet)){R.splice(I,1);break t}}y=x.createElement(d),Rr(y,d,l),x.head.appendChild(y);break;default:throw Error(i(468,d))}y[U]=r,it(y),d=y}r.stateNode=d}else cx(x,r.type,r.stateNode);else r.stateNode=lx(x,d,r.memoizedProps);else y!==d?(y===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):y.count--,d===null?cx(x,r.type,r.stateNode):lx(x,d,r.memoizedProps)):d===null&&r.stateNode!==null&&Su(r,r.memoizedProps,l.memoizedProps)}break;case 27:nn(n,r),sn(r),d&512&&(ar||l===null||yi(l,l.return)),l!==null&&d&4&&Su(r,r.memoizedProps,l.memoizedProps);break;case 5:if(nn(n,r),sn(r),d&512&&(ar||l===null||yi(l,l.return)),r.flags&32){x=r.stateNode;try{ui(x,"")}catch(st){oa(r,r.return,st)}}d&4&&r.stateNode!=null&&(x=r.memoizedProps,Su(r,x,l!==null?l.memoizedProps:x)),d&1024&&(Au=!0);break;case 6:if(nn(n,r),sn(r),d&4){if(r.stateNode===null)throw Error(i(162));d=r.memoizedProps,l=r.stateNode;try{l.nodeValue=d}catch(st){oa(r,r.return,st)}}break;case 3:if(md=null,x=ti,ti=gd(n.containerInfo),nn(n,r),ti=x,sn(r),d&4&&l!==null&&l.memoizedState.isDehydrated)try{mo(n.containerInfo)}catch(st){oa(r,r.return,st)}Au&&(Au=!1,c1(r));break;case 4:d=ti,ti=gd(r.stateNode.containerInfo),nn(n,r),sn(r),ti=d;break;case 12:nn(n,r),sn(r);break;case 31:nn(n,r),sn(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,td(r,d)));break;case 13:nn(n,r),sn(r),r.child.flags&8192&&r.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(rd=ia()),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,td(r,d)));break;case 22:x=r.memoizedState!==null;var re=l!==null&&l.memoizedState!==null,be=$i,je=ar;if($i=be||x,ar=je||re,nn(n,r),ar=je,$i=be,sn(r),d&8192)e:for(n=r.stateNode,n._visibility=x?n._visibility&-2:n._visibility|1,x&&(l===null||re||$i||ar||pl(r)),l=null,n=r;;){if(n.tag===5||n.tag===26){if(l===null){re=l=n;try{if(y=re.stateNode,x)R=y.style,typeof R.setProperty=="function"?R.setProperty("display","none","important"):R.display="none";else{I=re.stateNode;var Me=re.memoizedProps.style,Ae=Me!=null&&Me.hasOwnProperty("display")?Me.display:null;I.style.display=Ae==null||typeof Ae=="boolean"?"":(""+Ae).trim()}}catch(st){oa(re,re.return,st)}}}else if(n.tag===6){if(l===null){re=n;try{re.stateNode.nodeValue=x?"":re.memoizedProps}catch(st){oa(re,re.return,st)}}}else if(n.tag===18){if(l===null){re=n;try{var we=re.stateNode;x?Q1(we,!0):Q1(re.stateNode,!1)}catch(st){oa(re,re.return,st)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===r)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;l===n&&(l=null),n=n.return}l===n&&(l=null),n.sibling.return=n.return,n=n.sibling}d&4&&(d=r.updateQueue,d!==null&&(l=d.retryQueue,l!==null&&(d.retryQueue=null,td(r,l))));break;case 19:nn(n,r),sn(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,td(r,d)));break;case 30:break;case 21:break;default:nn(n,r),sn(r)}}function sn(r){var n=r.flags;if(n&2){try{for(var l,d=r.return;d!==null;){if(e1(d)){l=d;break}d=d.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var x=l.stateNode,y=Eu(r);ed(r,y,x);break;case 5:var R=l.stateNode;l.flags&32&&(ui(R,""),l.flags&=-33);var I=Eu(r);ed(r,I,R);break;case 3:case 4:var re=l.stateNode.containerInfo,be=Eu(r);Tu(r,be,re);break;default:throw Error(i(161))}}catch(je){oa(r,r.return,je)}r.flags&=-3}n&4096&&(r.flags&=-4097)}function c1(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var n=r;c1(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),r=r.sibling}}function Yi(r,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)r1(r,n.alternate,n),n=n.sibling}function pl(r){for(r=r.child;r!==null;){var n=r;switch(n.tag){case 0:case 11:case 14:case 15:Es(4,n,n.return),pl(n);break;case 1:yi(n,n.return);var l=n.stateNode;typeof l.componentWillUnmount=="function"&&Qg(n,n.return,l),pl(n);break;case 27:Ac(n.stateNode);case 26:case 5:yi(n,n.return),pl(n);break;case 22:n.memoizedState===null&&pl(n);break;case 30:pl(n);break;default:pl(n)}r=r.sibling}}function Wi(r,n,l){for(l=l&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var d=n.alternate,x=r,y=n,R=y.flags;switch(y.tag){case 0:case 11:case 15:Wi(x,y,l),hc(4,y);break;case 1:if(Wi(x,y,l),d=y,x=d.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(be){oa(d,d.return,be)}if(d=y,x=d.updateQueue,x!==null){var I=d.stateNode;try{var re=x.shared.hiddenCallbacks;if(re!==null)for(x.shared.hiddenCallbacks=null,x=0;x<re.length;x++)zh(re[x],I)}catch(be){oa(d,d.return,be)}}l&&R&64&&Jg(y),gc(y,y.return);break;case 27:t1(y);case 26:case 5:Wi(x,y,l),l&&d===null&&R&4&&Zg(y),gc(y,y.return);break;case 12:Wi(x,y,l);break;case 31:Wi(x,y,l),l&&R&4&&s1(x,y);break;case 13:Wi(x,y,l),l&&R&4&&l1(x,y);break;case 22:y.memoizedState===null&&Wi(x,y,l),gc(y,y.return);break;case 30:break;default:Wi(x,y,l)}n=n.sibling}}function _u(r,n){var l=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),r=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(r=n.memoizedState.cachePool.pool),r!==l&&(r!=null&&r.refCount++,l!=null&&tc(l))}function Cu(r,n){r=null,n.alternate!==null&&(r=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==r&&(n.refCount++,r!=null&&tc(r))}function ai(r,n,l,d){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)d1(r,n,l,d),n=n.sibling}function d1(r,n,l,d){var x=n.flags;switch(n.tag){case 0:case 11:case 15:ai(r,n,l,d),x&2048&&hc(9,n);break;case 1:ai(r,n,l,d);break;case 3:ai(r,n,l,d),x&2048&&(r=null,n.alternate!==null&&(r=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==r&&(n.refCount++,r!=null&&tc(r)));break;case 12:if(x&2048){ai(r,n,l,d),r=n.stateNode;try{var y=n.memoizedProps,R=y.id,I=y.onPostCommit;typeof I=="function"&&I(R,n.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(re){oa(n,n.return,re)}}else ai(r,n,l,d);break;case 31:ai(r,n,l,d);break;case 13:ai(r,n,l,d);break;case 23:break;case 22:y=n.stateNode,R=n.alternate,n.memoizedState!==null?y._visibility&2?ai(r,n,l,d):xc(r,n):y._visibility&2?ai(r,n,l,d):(y._visibility|=2,io(r,n,l,d,(n.subtreeFlags&10256)!==0||!1)),x&2048&&_u(R,n);break;case 24:ai(r,n,l,d),x&2048&&Cu(n.alternate,n);break;default:ai(r,n,l,d)}}function io(r,n,l,d,x){for(x=x&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var y=r,R=n,I=l,re=d,be=R.flags;switch(R.tag){case 0:case 11:case 15:io(y,R,I,re,x),hc(8,R);break;case 23:break;case 22:var je=R.stateNode;R.memoizedState!==null?je._visibility&2?io(y,R,I,re,x):xc(y,R):(je._visibility|=2,io(y,R,I,re,x)),x&&be&2048&&_u(R.alternate,R);break;case 24:io(y,R,I,re,x),x&&be&2048&&Cu(R.alternate,R);break;default:io(y,R,I,re,x)}n=n.sibling}}function xc(r,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var l=r,d=n,x=d.flags;switch(d.tag){case 22:xc(l,d),x&2048&&_u(d.alternate,d);break;case 24:xc(l,d),x&2048&&Cu(d.alternate,d);break;default:xc(l,d)}n=n.sibling}}var mc=8192;function so(r,n,l){if(r.subtreeFlags&mc)for(r=r.child;r!==null;)f1(r,n,l),r=r.sibling}function f1(r,n,l){switch(r.tag){case 26:so(r,n,l),r.flags&mc&&r.memoizedState!==null&&l2(l,ti,r.memoizedState,r.memoizedProps);break;case 5:so(r,n,l);break;case 3:case 4:var d=ti;ti=gd(r.stateNode.containerInfo),so(r,n,l),ti=d;break;case 22:r.memoizedState===null&&(d=r.alternate,d!==null&&d.memoizedState!==null?(d=mc,mc=16777216,so(r,n,l),mc=d):so(r,n,l));break;default:so(r,n,l)}}function u1(r){var n=r.alternate;if(n!==null&&(r=n.child,r!==null)){n.child=null;do n=r.sibling,r.sibling=null,r=n;while(r!==null)}}function vc(r){var n=r.deletions;if((r.flags&16)!==0){if(n!==null)for(var l=0;l<n.length;l++){var d=n[l];vr=d,h1(d,r)}u1(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)p1(r),r=r.sibling}function p1(r){switch(r.tag){case 0:case 11:case 15:vc(r),r.flags&2048&&Es(9,r,r.return);break;case 3:vc(r);break;case 12:vc(r);break;case 22:var n=r.stateNode;r.memoizedState!==null&&n._visibility&2&&(r.return===null||r.return.tag!==13)?(n._visibility&=-3,ad(r)):vc(r);break;default:vc(r)}}function ad(r){var n=r.deletions;if((r.flags&16)!==0){if(n!==null)for(var l=0;l<n.length;l++){var d=n[l];vr=d,h1(d,r)}u1(r)}for(r=r.child;r!==null;){switch(n=r,n.tag){case 0:case 11:case 15:Es(8,n,n.return),ad(n);break;case 22:l=n.stateNode,l._visibility&2&&(l._visibility&=-3,ad(n));break;default:ad(n)}r=r.sibling}}function h1(r,n){for(;vr!==null;){var l=vr;switch(l.tag){case 0:case 11:case 15:Es(8,l,n);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var d=l.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:tc(l.memoizedState.cache)}if(d=l.child,d!==null)d.return=l,vr=d;else e:for(l=r;vr!==null;){d=vr;var x=d.sibling,y=d.return;if(n1(d),d===l){vr=null;break e}if(x!==null){x.return=y,vr=x;break e}vr=y}}}var Eb={getCacheForType:function(r){var n=kr(Za),l=n.data.get(r);return l===void 0&&(l=r(),n.data.set(r,l)),l},cacheSignal:function(){return kr(Za).controller.signal}},Tb=typeof WeakMap=="function"?WeakMap:Map,ta=0,ma=null,Pt=null,Ht=0,la=0,yn=null,Ts=!1,lo=!1,ku=!1,Vi=0,La=0,As=0,hl=0,wu=0,bn=0,oo=0,yc=null,ln=null,Ru=!1,rd=0,g1=0,nd=1/0,id=null,_s=null,fr=0,Cs=null,co=null,Xi=0,Nu=0,Fu=null,x1=null,bc=0,ju=null;function Sn(){return(ta&2)!==0&&Ht!==0?Ht&-Ht:de.T!==null?Lu():D()}function m1(){if(bn===0)if((Ht&536870912)===0||Ct){var r=wi;wi<<=1,(wi&3932160)===0&&(wi=262144),bn=r}else bn=536870912;return r=mn.current,r!==null&&(r.flags|=32),bn}function on(r,n,l){(r===ma&&(la===2||la===9)||r.cancelPendingCommit!==null)&&(fo(r,0),ks(r,Ht,bn,!1)),Xn(r,l),((ta&2)===0||r!==ma)&&(r===ma&&((ta&2)===0&&(hl|=l),La===4&&ks(r,Ht,bn,!1)),bi(r))}function v1(r,n,l){if((ta&6)!==0)throw Error(i(327));var d=!l&&(n&127)===0&&(n&r.expiredLanes)===0||Er(r,n),x=d?Cb(r,n):Ou(r,n,!0),y=d;do{if(x===0){lo&&!d&&ks(r,n,0,!1);break}else{if(l=r.current.alternate,y&&!Ab(l)){x=Ou(r,n,!1),y=!1;continue}if(x===2){if(y=n,r.errorRecoveryDisabledLanes&y)var R=0;else R=r.pendingLanes&-536870913,R=R!==0?R:R&536870912?536870912:0;if(R!==0){n=R;e:{var I=r;x=yc;var re=I.current.memoizedState.isDehydrated;if(re&&(fo(I,R).flags|=256),R=Ou(I,R,!1),R!==2){if(ku&&!re){I.errorRecoveryDisabledLanes|=y,hl|=y,x=4;break e}y=ln,ln=x,y!==null&&(ln===null?ln=y:ln.push.apply(ln,y))}x=R}if(y=!1,x!==2)continue}}if(x===1){fo(r,0),ks(r,n,0,!0);break}e:{switch(d=r,y=x,y){case 0:case 1:throw Error(i(345));case 4:if((n&4194048)!==n)break;case 6:ks(d,n,bn,!Ts);break e;case 2:ln=null;break;case 3:case 5:break;default:throw Error(i(329))}if((n&62914560)===n&&(x=rd+300-ia(),10<x)){if(ks(d,n,bn,!Ts),wn(d,0,!0)!==0)break e;Xi=n,d.timeoutHandle=q1(y1.bind(null,d,l,ln,id,Ru,n,bn,hl,oo,Ts,y,"Throttled",-0,0),x);break e}y1(d,l,ln,id,Ru,n,bn,hl,oo,Ts,y,null,-0,0)}}break}while(!0);bi(r)}function y1(r,n,l,d,x,y,R,I,re,be,je,Me,Ae,we){if(r.timeoutHandle=-1,Me=n.subtreeFlags,Me&8192||(Me&16785408)===16785408){Me={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:qn},f1(n,y,Me);var st=(y&62914560)===y?rd-ia():(y&4194048)===y?g1-ia():0;if(st=o2(Me,st),st!==null){Xi=y,r.cancelPendingCommit=st(k1.bind(null,r,n,y,l,d,x,R,I,re,je,Me,null,Ae,we)),ks(r,y,R,!be);return}}k1(r,n,y,l,d,x,R,I,re)}function Ab(r){for(var n=r;;){var l=n.tag;if((l===0||l===11||l===15)&&n.flags&16384&&(l=n.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var d=0;d<l.length;d++){var x=l[d],y=x.getSnapshot;x=x.value;try{if(!Ar(y(),x))return!1}catch{return!1}}if(l=n.child,n.subtreeFlags&16384&&l!==null)l.return=n,n=l;else{if(n===r)break;for(;n.sibling===null;){if(n.return===null||n.return===r)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function ks(r,n,l,d){n&=~wu,n&=~hl,r.suspendedLanes|=n,r.pingedLanes&=~n,d&&(r.warmLanes|=n),d=r.expirationTimes;for(var x=n;0<x;){var y=31-Ut(x),R=1<<y;d[y]=-1,x&=~R}l!==0&&Dl(r,l,n)}function sd(){return(ta&6)===0?(Sc(0),!1):!0}function Du(){if(Pt!==null){if(la===0)var r=Pt.return;else r=Pt,Mi=il=null,qf(r),eo=null,rc=0,r=Pt;for(;r!==null;)Kg(r.alternate,r),r=r.return;Pt=null}}function fo(r,n){var l=r.timeoutHandle;l!==-1&&(r.timeoutHandle=-1,Gb(l)),l=r.cancelPendingCommit,l!==null&&(r.cancelPendingCommit=null,l()),Xi=0,Du(),ma=r,Pt=l=Xt(r.current,null),Ht=n,la=0,yn=null,Ts=!1,lo=Er(r,n),ku=!1,oo=bn=wu=hl=As=La=0,ln=yc=null,Ru=!1,(n&8)!==0&&(n|=n&32);var d=r.entangledLanes;if(d!==0)for(r=r.entanglements,d&=n;0<d;){var x=31-Ut(d),y=1<<x;n|=r[x],d&=~y}return Vi=n,Fe(),l}function b1(r,n){kt=null,de.H=fc,n===Zl||n===I0?(n=Bh(),la=3):n===Mf?(n=Bh(),la=4):la=n===fu?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,yn=n,Pt===null&&(La=1,q0(r,Sa(n,r.current)))}function S1(){var r=mn.current;return r===null?!0:(Ht&4194048)===Ht?Bn===null:(Ht&62914560)===Ht||(Ht&536870912)!==0?r===Bn:!1}function E1(){var r=de.H;return de.H=fc,r===null?fc:r}function T1(){var r=de.A;return de.A=Eb,r}function ld(){La=4,Ts||(Ht&4194048)!==Ht&&mn.current!==null||(lo=!0),(As&134217727)===0&&(hl&134217727)===0||ma===null||ks(ma,Ht,bn,!1)}function Ou(r,n,l){var d=ta;ta|=2;var x=E1(),y=T1();(ma!==r||Ht!==n)&&(id=null,fo(r,n)),n=!1;var R=La;e:do try{if(la!==0&&Pt!==null){var I=Pt,re=yn;switch(la){case 8:Du(),R=6;break e;case 3:case 2:case 9:case 6:mn.current===null&&(n=!0);var be=la;if(la=0,yn=null,uo(r,I,re,be),l&&lo){R=0;break e}break;default:be=la,la=0,yn=null,uo(r,I,re,be)}}_b(),R=La;break}catch(je){b1(r,je)}while(!0);return n&&r.shellSuspendCounter++,Mi=il=null,ta=d,de.H=x,de.A=y,Pt===null&&(ma=null,Ht=0,Fe()),R}function _b(){for(;Pt!==null;)A1(Pt)}function Cb(r,n){var l=ta;ta|=2;var d=E1(),x=T1();ma!==r||Ht!==n?(id=null,nd=ia()+500,fo(r,n)):lo=Er(r,n);e:do try{if(la!==0&&Pt!==null){n=Pt;var y=yn;t:switch(la){case 1:la=0,yn=null,uo(r,n,y,1);break;case 2:case 9:if(Oh(y)){la=0,yn=null,_1(n);break}n=function(){la!==2&&la!==9||ma!==r||(la=7),bi(r)},y.then(n,n);break e;case 3:la=7;break e;case 4:la=5;break e;case 7:Oh(y)?(la=0,yn=null,_1(n)):(la=0,yn=null,uo(r,n,y,7));break;case 5:var R=null;switch(Pt.tag){case 26:R=Pt.memoizedState;case 5:case 27:var I=Pt;if(R?dx(R):I.stateNode.complete){la=0,yn=null;var re=I.sibling;if(re!==null)Pt=re;else{var be=I.return;be!==null?(Pt=be,od(be)):Pt=null}break t}}la=0,yn=null,uo(r,n,y,5);break;case 6:la=0,yn=null,uo(r,n,y,6);break;case 8:Du(),La=6;break e;default:throw Error(i(462))}}kb();break}catch(je){b1(r,je)}while(!0);return Mi=il=null,de.H=d,de.A=x,ta=l,Pt!==null?0:(ma=null,Ht=0,Fe(),La)}function kb(){for(;Pt!==null&&!Yr();)A1(Pt)}function A1(r){var n=Xg(r.alternate,r,Vi);r.memoizedProps=r.pendingProps,n===null?od(r):Pt=n}function _1(r){var n=r,l=n.alternate;switch(n.tag){case 15:case 0:n=Hg(l,n,n.pendingProps,n.type,void 0,Ht);break;case 11:n=Hg(l,n,n.pendingProps,n.type.render,n.ref,Ht);break;case 5:qf(n);default:Kg(l,n),n=Pt=ct(n,Vi),n=Xg(l,n,Vi)}r.memoizedProps=r.pendingProps,n===null?od(r):Pt=n}function uo(r,n,l,d){Mi=il=null,qf(n),eo=null,rc=0;var x=n.return;try{if(gb(r,x,n,l,Ht)){La=1,q0(r,Sa(l,r.current)),Pt=null;return}}catch(y){if(x!==null)throw Pt=x,y;La=1,q0(r,Sa(l,r.current)),Pt=null;return}n.flags&32768?(Ct||d===1?r=!0:lo||(Ht&536870912)!==0?r=!1:(Ts=r=!0,(d===2||d===9||d===3||d===6)&&(d=mn.current,d!==null&&d.tag===13&&(d.flags|=16384))),C1(n,r)):od(n)}function od(r){var n=r;do{if((n.flags&32768)!==0){C1(n,Ts);return}r=n.return;var l=vb(n.alternate,n,Vi);if(l!==null){Pt=l;return}if(n=n.sibling,n!==null){Pt=n;return}Pt=n=r}while(n!==null);La===0&&(La=5)}function C1(r,n){do{var l=yb(r.alternate,r);if(l!==null){l.flags&=32767,Pt=l;return}if(l=r.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!n&&(r=r.sibling,r!==null)){Pt=r;return}Pt=r=l}while(r!==null);La=6,Pt=null}function k1(r,n,l,d,x,y,R,I,re){r.cancelPendingCommit=null;do cd();while(fr!==0);if((ta&6)!==0)throw Error(i(327));if(n!==null){if(n===r.current)throw Error(i(177));if(y=n.lanes|n.childLanes,y|=ye,p0(r,l,y,R,I,re),r===ma&&(Pt=ma=null,Ht=0),co=n,Cs=r,Xi=l,Nu=y,Fu=x,x1=d,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,Fb(Lt,function(){return j1(),null})):(r.callbackNode=null,r.callbackPriority=0),d=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||d){d=de.T,de.T=null,x=_e.p,_e.p=2,R=ta,ta|=4;try{bb(r,n,l)}finally{ta=R,_e.p=x,de.T=d}}fr=1,w1(),R1(),N1()}}function w1(){if(fr===1){fr=0;var r=Cs,n=co,l=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||l){l=de.T,de.T=null;var d=_e.p;_e.p=2;var x=ta;ta|=4;try{o1(n,r);var y=Wu,R=R0(r.containerInfo),I=y.focusedElem,re=y.selectionRange;if(R!==I&&I&&I.ownerDocument&&Ko(I.ownerDocument.documentElement,I)){if(re!==null&&Jo(I)){var be=re.start,je=re.end;if(je===void 0&&(je=be),"selectionStart"in I)I.selectionStart=be,I.selectionEnd=Math.min(je,I.value.length);else{var Me=I.ownerDocument||document,Ae=Me&&Me.defaultView||window;if(Ae.getSelection){var we=Ae.getSelection(),st=I.textContent.length,xt=Math.min(re.start,st),ha=re.end===void 0?xt:Math.min(re.end,st);!we.extend&&xt>ha&&(R=ha,ha=xt,xt=R);var pe=w0(I,xt),ce=w0(I,ha);if(pe&&ce&&(we.rangeCount!==1||we.anchorNode!==pe.node||we.anchorOffset!==pe.offset||we.focusNode!==ce.node||we.focusOffset!==ce.offset)){var ve=Me.createRange();ve.setStart(pe.node,pe.offset),we.removeAllRanges(),xt>ha?(we.addRange(ve),we.extend(ce.node,ce.offset)):(ve.setEnd(ce.node,ce.offset),we.addRange(ve))}}}}for(Me=[],we=I;we=we.parentNode;)we.nodeType===1&&Me.push({element:we,left:we.scrollLeft,top:we.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<Me.length;I++){var Be=Me[I];Be.element.scrollLeft=Be.left,Be.element.scrollTop=Be.top}}Sd=!!Yu,Wu=Yu=null}finally{ta=x,_e.p=d,de.T=l}}r.current=n,fr=2}}function R1(){if(fr===2){fr=0;var r=Cs,n=co,l=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||l){l=de.T,de.T=null;var d=_e.p;_e.p=2;var x=ta;ta|=4;try{r1(r,n.alternate,n)}finally{ta=x,_e.p=d,de.T=l}}fr=3}}function N1(){if(fr===4||fr===3){fr=0,Zr();var r=Cs,n=co,l=Xi,d=x1;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?fr=5:(fr=0,co=Cs=null,F1(r,r.pendingLanes));var x=r.pendingLanes;if(x===0&&(_s=null),Il(l),n=n.stateNode,Ta&&typeof Ta.onCommitFiberRoot=="function")try{Ta.onCommitFiberRoot(na,n,void 0,(n.current.flags&128)===128)}catch{}if(d!==null){n=de.T,x=_e.p,_e.p=2,de.T=null;try{for(var y=r.onRecoverableError,R=0;R<d.length;R++){var I=d[R];y(I.value,{componentStack:I.stack})}}finally{de.T=n,_e.p=x}}(Xi&3)!==0&&cd(),bi(r),x=r.pendingLanes,(l&261930)!==0&&(x&42)!==0?r===ju?bc++:(bc=0,ju=r):bc=0,Sc(0)}}function F1(r,n){(r.pooledCacheLanes&=n)===0&&(n=r.pooledCache,n!=null&&(r.pooledCache=null,tc(n)))}function cd(){return w1(),R1(),N1(),j1()}function j1(){if(fr!==5)return!1;var r=Cs,n=Nu;Nu=0;var l=Il(Xi),d=de.T,x=_e.p;try{_e.p=32>l?32:l,de.T=null,l=Fu,Fu=null;var y=Cs,R=Xi;if(fr=0,co=Cs=null,Xi=0,(ta&6)!==0)throw Error(i(331));var I=ta;if(ta|=4,p1(y.current),d1(y,y.current,R,l),ta=I,Sc(0,!1),Ta&&typeof Ta.onPostCommitFiberRoot=="function")try{Ta.onPostCommitFiberRoot(na,y)}catch{}return!0}finally{_e.p=x,de.T=d,F1(r,n)}}function D1(r,n,l){n=Sa(l,n),n=du(r.stateNode,n,2),r=ys(r,n,2),r!==null&&(Xn(r,2),bi(r))}function oa(r,n,l){if(r.tag===3)D1(r,r,l);else for(;n!==null;){if(n.tag===3){D1(n,r,l);break}else if(n.tag===1){var d=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(_s===null||!_s.has(d))){r=Sa(l,r),l=Og(2),d=ys(n,l,2),d!==null&&(Ig(l,d,n,r),Xn(d,2),bi(d));break}}n=n.return}}function Iu(r,n,l){var d=r.pingCache;if(d===null){d=r.pingCache=new Tb;var x=new Set;d.set(n,x)}else x=d.get(n),x===void 0&&(x=new Set,d.set(n,x));x.has(l)||(ku=!0,x.add(l),r=wb.bind(null,r,n,l),n.then(r,r))}function wb(r,n,l){var d=r.pingCache;d!==null&&d.delete(n),r.pingedLanes|=r.suspendedLanes&l,r.warmLanes&=~l,ma===r&&(Ht&l)===l&&(La===4||La===3&&(Ht&62914560)===Ht&&300>ia()-rd?(ta&2)===0&&fo(r,0):wu|=l,oo===Ht&&(oo=0)),bi(r)}function O1(r,n){n===0&&(n=Ys()),r=Y(r,n),r!==null&&(Xn(r,n),bi(r))}function Rb(r){var n=r.memoizedState,l=0;n!==null&&(l=n.retryLane),O1(r,l)}function Nb(r,n){var l=0;switch(r.tag){case 31:case 13:var d=r.stateNode,x=r.memoizedState;x!==null&&(l=x.retryLane);break;case 19:d=r.stateNode;break;case 22:d=r.stateNode._retryCache;break;default:throw Error(i(314))}d!==null&&d.delete(n),O1(r,l)}function Fb(r,n){return Qa(r,n)}var dd=null,po=null,Bu=!1,fd=!1,Mu=!1,ws=0;function bi(r){r!==po&&r.next===null&&(po===null?dd=po=r:po=po.next=r),fd=!0,Bu||(Bu=!0,Db())}function Sc(r,n){if(!Mu&&fd){Mu=!0;do for(var l=!1,d=dd;d!==null;){if(r!==0){var x=d.pendingLanes;if(x===0)var y=0;else{var R=d.suspendedLanes,I=d.pingedLanes;y=(1<<31-Ut(42|r)+1)-1,y&=x&~(R&~I),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(l=!0,L1(d,y))}else y=Ht,y=wn(d,d===ma?y:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(y&3)===0||Er(d,y)||(l=!0,L1(d,y));d=d.next}while(l);Mu=!1}}function jb(){I1()}function I1(){fd=Bu=!1;var r=0;ws!==0&&$b()&&(r=ws);for(var n=ia(),l=null,d=dd;d!==null;){var x=d.next,y=B1(d,n);y===0?(d.next=null,l===null?dd=x:l.next=x,x===null&&(po=l)):(l=d,(r!==0||(y&3)!==0)&&(fd=!0)),d=x}fr!==0&&fr!==5||Sc(r),ws!==0&&(ws=0)}function B1(r,n){for(var l=r.suspendedLanes,d=r.pingedLanes,x=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var R=31-Ut(y),I=1<<R,re=x[R];re===-1?((I&l)===0||(I&d)!==0)&&(x[R]=ci(I,n)):re<=n&&(r.expiredLanes|=I),y&=~I}if(n=ma,l=Ht,l=wn(r,r===n?l:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d=r.callbackNode,l===0||r===n&&(la===2||la===9)||r.cancelPendingCommit!==null)return d!==null&&d!==null&&Rt(d),r.callbackNode=null,r.callbackPriority=0;if((l&3)===0||Er(r,l)){if(n=l&-l,n===r.callbackPriority)return n;switch(d!==null&&Rt(d),Il(l)){case 2:case 8:l=ki;break;case 32:l=Lt;break;case 268435456:l=ht;break;default:l=Lt}return d=M1.bind(null,r),l=Qa(l,d),r.callbackPriority=n,r.callbackNode=l,n}return d!==null&&d!==null&&Rt(d),r.callbackPriority=2,r.callbackNode=null,2}function M1(r,n){if(fr!==0&&fr!==5)return r.callbackNode=null,r.callbackPriority=0,null;var l=r.callbackNode;if(cd()&&r.callbackNode!==l)return null;var d=Ht;return d=wn(r,r===ma?d:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d===0?null:(v1(r,d,n),B1(r,ia()),r.callbackNode!=null&&r.callbackNode===l?M1.bind(null,r):null)}function L1(r,n){if(cd())return null;v1(r,n,!0)}function Db(){Yb(function(){(ta&6)!==0?Qa(sa,jb):I1()})}function Lu(){if(ws===0){var r=Jl;r===0&&(r=Yt,Yt<<=1,(Yt&261888)===0&&(Yt=256)),ws=r}return ws}function P1(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:zl(""+r)}function z1(r,n){var l=n.ownerDocument.createElement("input");return l.name=n.name,l.value=n.value,r.id&&l.setAttribute("form",r.id),n.parentNode.insertBefore(l,n),r=new FormData(r),l.parentNode.removeChild(l),r}function Ob(r,n,l,d,x){if(n==="submit"&&l&&l.stateNode===x){var y=P1((x[G]||null).action),R=d.submitter;R&&(n=(n=R[G]||null)?P1(n.formAction):R.getAttribute("formAction"),n!==null&&(y=n,R=null));var I=new Jn("action","action",null,d,x);r.push({event:I,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(ws!==0){var re=R?z1(x,R):new FormData(x);nu(l,{pending:!0,data:re,method:x.method,action:y},null,re)}}else typeof y=="function"&&(I.preventDefault(),re=R?z1(x,R):new FormData(x),nu(l,{pending:!0,data:re,method:x.method,action:y},y,re))},currentTarget:x}]})}}for(var Pu=0;Pu<Q.length;Pu++){var zu=Q[Pu],Ib=zu.toLowerCase(),Bb=zu[0].toUpperCase()+zu.slice(1);j(Ib,"on"+Bb)}j(ps,"onAnimationEnd"),j(or,"onAnimationIteration"),j(_r,"onAnimationStart"),j("dblclick","onDoubleClick"),j("focusin","onFocus"),j("focusout","onBlur"),j(u,"onTransitionRun"),j(v,"onTransitionStart"),j(b,"onTransitionCancel"),j(S,"onTransitionEnd"),sr("onMouseEnter",["mouseout","mouseover"]),sr("onMouseLeave",["mouseout","mouseover"]),sr("onPointerEnter",["pointerout","pointerover"]),sr("onPointerLeave",["pointerout","pointerover"]),Vt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Vt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Vt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Vt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Vt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Vt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ec="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mb=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ec));function U1(r,n){n=(n&4)!==0;for(var l=0;l<r.length;l++){var d=r[l],x=d.event;d=d.listeners;e:{var y=void 0;if(n)for(var R=d.length-1;0<=R;R--){var I=d[R],re=I.instance,be=I.currentTarget;if(I=I.listener,re!==y&&x.isPropagationStopped())break e;y=I,x.currentTarget=be;try{y(x)}catch(je){C(je)}x.currentTarget=null,y=re}else for(R=0;R<d.length;R++){if(I=d[R],re=I.instance,be=I.currentTarget,I=I.listener,re!==y&&x.isPropagationStopped())break e;y=I,x.currentTarget=be;try{y(x)}catch(je){C(je)}x.currentTarget=null,y=re}}}}function zt(r,n){var l=n[xe];l===void 0&&(l=n[xe]=new Set);var d=r+"__bubble";l.has(d)||(H1(n,r,2,!1),l.add(d))}function Uu(r,n,l){var d=0;n&&(d|=4),H1(l,r,d,n)}var ud="_reactListening"+Math.random().toString(36).slice(2);function Hu(r){if(!r[ud]){r[ud]=!0,Nt.forEach(function(l){l!=="selectionchange"&&(Mb.has(l)||Uu(l,!1,r),Uu(l,!0,r))});var n=r.nodeType===9?r:r.ownerDocument;n===null||n[ud]||(n[ud]=!0,Uu("selectionchange",!1,n))}}function H1(r,n,l,d){switch(mx(n)){case 2:var x=f2;break;case 8:x=u2;break;default:x=rp}l=x.bind(null,n,l,r),x=void 0,!Ks||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(x=!0),d?x!==void 0?r.addEventListener(n,l,{capture:!0,passive:x}):r.addEventListener(n,l,!0):x!==void 0?r.addEventListener(n,l,{passive:x}):r.addEventListener(n,l,!1)}function $u(r,n,l,d,x){var y=d;if((n&1)===0&&(n&2)===0&&d!==null)e:for(;;){if(d===null)return;var R=d.tag;if(R===3||R===4){var I=d.stateNode.containerInfo;if(I===x)break;if(R===4)for(R=d.return;R!==null;){var re=R.tag;if((re===3||re===4)&&R.stateNode.containerInfo===x)return;R=R.return}for(;I!==null;){if(R=Ve(I),R===null)return;if(re=R.tag,re===5||re===6||re===26||re===27){d=y=R;continue e}I=I.parentNode}}d=d.return}Ul(function(){var be=y,je=Lo(l),Me=[];e:{var Ae=T.get(r);if(Ae!==void 0){var we=Jn,st=r;switch(r){case"keypress":if(gi(l)===0)break e;case"keydown":case"keyup":we=bf;break;case"focusin":st="focus",we=Yl;break;case"focusout":st="blur",we=Yl;break;case"beforeblur":case"afterblur":we=Yl;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":we=at;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":we=Tt;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":we=b0;break;case ps:case or:case _r:we=uf;break;case S:we=xi;break;case"scroll":case"scrollend":we=Ir;break;case"wheel":we=_f;break;case"copy":case"cut":case"paste":we=hf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":we=y0;break;case"toggle":case"beforetoggle":we=an}var xt=(n&4)!==0,ha=!xt&&(r==="scroll"||r==="scrollend"),pe=xt?Ae!==null?Ae+"Capture":null:Ae;xt=[];for(var ce=be,ve;ce!==null;){var Be=ce;if(ve=Be.stateNode,Be=Be.tag,Be!==5&&Be!==26&&Be!==27||ve===null||pe===null||(Be=qs(ce,pe),Be!=null&&xt.push(Tc(ce,Be,ve))),ha)break;ce=ce.return}0<xt.length&&(Ae=new we(Ae,st,null,l,je),Me.push({event:Ae,listeners:xt}))}}if((n&7)===0){e:{if(Ae=r==="mouseover"||r==="pointerover",we=r==="mouseout"||r==="pointerout",Ae&&l!==ls&&(st=l.relatedTarget||l.fromElement)&&(Ve(st)||st[V]))break e;if((we||Ae)&&(Ae=je.window===je?je:(Ae=je.ownerDocument)?Ae.defaultView||Ae.parentWindow:window,we?(st=l.relatedTarget||l.toElement,we=be,st=st?Ve(st):null,st!==null&&(ha=c(st),xt=st.tag,st!==ha||xt!==5&&xt!==27&&xt!==6)&&(st=null)):(we=null,st=be),we!==st)){if(xt=at,Be="onMouseLeave",pe="onMouseEnter",ce="mouse",(r==="pointerout"||r==="pointerover")&&(xt=y0,Be="onPointerLeave",pe="onPointerEnter",ce="pointer"),ha=we==null?Ae:Ge(we),ve=st==null?Ae:Ge(st),Ae=new xt(Be,ce+"leave",we,l,je),Ae.target=ha,Ae.relatedTarget=ve,Be=null,Ve(je)===be&&(xt=new xt(pe,ce+"enter",st,l,je),xt.target=ve,xt.relatedTarget=ha,Be=xt),ha=Be,we&&st)t:{for(xt=Lb,pe=we,ce=st,ve=0,Be=pe;Be;Be=xt(Be))ve++;Be=0;for(var ut=ce;ut;ut=xt(ut))Be++;for(;0<ve-Be;)pe=xt(pe),ve--;for(;0<Be-ve;)ce=xt(ce),Be--;for(;ve--;){if(pe===ce||ce!==null&&pe===ce.alternate){xt=pe;break t}pe=xt(pe),ce=xt(ce)}xt=null}else xt=null;we!==null&&$1(Me,Ae,we,xt,!1),st!==null&&ha!==null&&$1(Me,ha,st,xt,!0)}}e:{if(Ae=be?Ge(be):window,we=Ae.nodeName&&Ae.nodeName.toLowerCase(),we==="select"||we==="input"&&Ae.type==="file")var Jt=Ho;else if(al(Ae))if($o)Jt=Xo;else{Jt=Wo;var lt=Yo}else we=Ae.nodeName,!we||we.toLowerCase()!=="input"||Ae.type!=="checkbox"&&Ae.type!=="radio"?be&&Mo(be.elementType)&&(Jt=Ho):Jt=Vo;if(Jt&&(Jt=Jt(r,be))){wf(Me,Jt,l,je);break e}lt&&lt(r,Ae,be),r==="focusout"&&be&&Ae.type==="number"&&be.memoizedProps.value!=null&&Bo(Ae,"number",Ae.value)}switch(lt=be?Ge(be):window,r){case"focusin":(al(lt)||lt.contentEditable==="true")&&(us=lt,Qo=be,Xl=null);break;case"focusout":Xl=Qo=us=null;break;case"mousedown":Oi=!0;break;case"contextmenu":case"mouseup":case"dragend":Oi=!1,ft(Me,l,je);break;case"selectionchange":if(N0)break;case"keydown":case"keyup":ft(Me,l,je)}var jt;if(el)e:{switch(r){case"compositionstart":var $t="onCompositionStart";break e;case"compositionend":$t="onCompositionEnd";break e;case"compositionupdate":$t="onCompositionUpdate";break e}$t=void 0}else Fi?Ra(r,l)&&($t="onCompositionEnd"):r==="keydown"&&l.keyCode===229&&($t="onCompositionStart");$t&&(T0&&l.locale!=="ko"&&(Fi||$t!=="onCompositionStart"?$t==="onCompositionEnd"&&Fi&&(jt=m0()):(hi=je,Ni="value"in hi?hi.value:hi.textContent,Fi=!0)),lt=pd(be,$t),0<lt.length&&($t=new v0($t,r,null,l,je),Me.push({event:$t,listeners:lt}),jt?$t.data=jt:(jt=ds(l),jt!==null&&($t.data=jt)))),(jt=ea?A0(r,l):Cf(r,l))&&($t=pd(be,"onBeforeInput"),0<$t.length&&(lt=new v0("onBeforeInput","beforeinput",null,l,je),Me.push({event:lt,listeners:$t}),lt.data=jt)),Ob(Me,r,be,l,je)}U1(Me,n)})}function Tc(r,n,l){return{instance:r,listener:n,currentTarget:l}}function pd(r,n){for(var l=n+"Capture",d=[];r!==null;){var x=r,y=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||y===null||(x=qs(r,l),x!=null&&d.unshift(Tc(r,x,y)),x=qs(r,n),x!=null&&d.push(Tc(r,x,y))),r.tag===3)return d;r=r.return}return[]}function Lb(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function $1(r,n,l,d,x){for(var y=n._reactName,R=[];l!==null&&l!==d;){var I=l,re=I.alternate,be=I.stateNode;if(I=I.tag,re!==null&&re===d)break;I!==5&&I!==26&&I!==27||be===null||(re=be,x?(be=qs(l,y),be!=null&&R.unshift(Tc(l,be,re))):x||(be=qs(l,y),be!=null&&R.push(Tc(l,be,re)))),l=l.return}R.length!==0&&r.push({event:n,listeners:R})}var Pb=/\r\n?/g,zb=/\u0000|\uFFFD/g;function G1(r){return(typeof r=="string"?r:""+r).replace(Pb,`
`).replace(zb,"")}function Y1(r,n){return n=G1(n),G1(r)===n}function pa(r,n,l,d,x,y){switch(l){case"children":typeof d=="string"?n==="body"||n==="textarea"&&d===""||ui(r,d):(typeof d=="number"||typeof d=="bigint")&&n!=="body"&&ui(r,""+d);break;case"className":di(r,"class",d);break;case"tabIndex":di(r,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":di(r,l,d);break;case"style":Xs(r,d,y);break;case"data":if(n!=="object"){di(r,"data",d);break}case"src":case"href":if(d===""&&(n!=="a"||l!=="href")){r.removeAttribute(l);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(l);break}d=zl(""+d),r.setAttribute(l,d);break;case"action":case"formAction":if(typeof d=="function"){r.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(l==="formAction"?(n!=="input"&&pa(r,n,"name",x.name,x,null),pa(r,n,"formEncType",x.formEncType,x,null),pa(r,n,"formMethod",x.formMethod,x,null),pa(r,n,"formTarget",x.formTarget,x,null)):(pa(r,n,"encType",x.encType,x,null),pa(r,n,"method",x.method,x,null),pa(r,n,"target",x.target,x,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(l);break}d=zl(""+d),r.setAttribute(l,d);break;case"onClick":d!=null&&(r.onclick=qn);break;case"onScroll":d!=null&&zt("scroll",r);break;case"onScrollEnd":d!=null&&zt("scrollend",r);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(l=d.__html,l!=null){if(x.children!=null)throw Error(i(60));r.innerHTML=l}}break;case"multiple":r.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":r.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){r.removeAttribute("xlink:href");break}l=zl(""+d),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(l,""+d):r.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(l,""):r.removeAttribute(l);break;case"capture":case"download":d===!0?r.setAttribute(l,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(l,d):r.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?r.setAttribute(l,d):r.removeAttribute(l);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?r.removeAttribute(l):r.setAttribute(l,d);break;case"popover":zt("beforetoggle",r),zt("toggle",r),ya(r,"popover",d);break;case"xlinkActuate":Ga(r,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":Ga(r,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":Ga(r,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":Ga(r,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":Ga(r,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":Ga(r,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":Ga(r,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":Ga(r,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":Ga(r,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":ya(r,"is",d);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=cf.get(l)||l,ya(r,l,d))}}function Gu(r,n,l,d,x,y){switch(l){case"style":Xs(r,d,y);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(l=d.__html,l!=null){if(x.children!=null)throw Error(i(60));r.innerHTML=l}}break;case"children":typeof d=="string"?ui(r,d):(typeof d=="number"||typeof d=="bigint")&&ui(r,""+d);break;case"onScroll":d!=null&&zt("scroll",r);break;case"onScrollEnd":d!=null&&zt("scrollend",r);break;case"onClick":d!=null&&(r.onclick=qn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Wt.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(x=l.endsWith("Capture"),n=l.slice(2,x?l.length-7:void 0),y=r[G]||null,y=y!=null?y[l]:null,typeof y=="function"&&r.removeEventListener(n,y,x),typeof d=="function")){typeof y!="function"&&y!==null&&(l in r?r[l]=null:r.hasAttribute(l)&&r.removeAttribute(l)),r.addEventListener(n,d,x);break e}l in r?r[l]=d:d===!0?r.setAttribute(l,""):ya(r,l,d)}}}function Rr(r,n,l){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":zt("error",r),zt("load",r);var d=!1,x=!1,y;for(y in l)if(l.hasOwnProperty(y)){var R=l[y];if(R!=null)switch(y){case"src":d=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,n));default:pa(r,n,y,R,l,null)}}x&&pa(r,n,"srcSet",l.srcSet,l,null),d&&pa(r,n,"src",l.src,l,null);return;case"input":zt("invalid",r);var I=y=R=x=null,re=null,be=null;for(d in l)if(l.hasOwnProperty(d)){var je=l[d];if(je!=null)switch(d){case"name":x=je;break;case"type":R=je;break;case"checked":re=je;break;case"defaultChecked":be=je;break;case"value":y=je;break;case"defaultValue":I=je;break;case"children":case"dangerouslySetInnerHTML":if(je!=null)throw Error(i(137,n));break;default:pa(r,n,d,je,l,null)}}Vs(r,y,I,re,be,R,x,!1);return;case"select":zt("invalid",r),d=R=y=null;for(x in l)if(l.hasOwnProperty(x)&&(I=l[x],I!=null))switch(x){case"value":y=I;break;case"defaultValue":R=I;break;case"multiple":d=I;default:pa(r,n,x,I,l,null)}n=y,l=R,r.multiple=!!d,n!=null?Fn(r,!!d,n,!1):l!=null&&Fn(r,!!d,l,!0);return;case"textarea":zt("invalid",r),y=x=d=null;for(R in l)if(l.hasOwnProperty(R)&&(I=l[R],I!=null))switch(R){case"value":d=I;break;case"defaultValue":x=I;break;case"children":y=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(i(91));break;default:pa(r,n,R,I,l,null)}Ml(r,d,x,y);return;case"option":for(re in l)l.hasOwnProperty(re)&&(d=l[re],d!=null)&&(re==="selected"?r.selected=d&&typeof d!="function"&&typeof d!="symbol":pa(r,n,re,d,l,null));return;case"dialog":zt("beforetoggle",r),zt("toggle",r),zt("cancel",r),zt("close",r);break;case"iframe":case"object":zt("load",r);break;case"video":case"audio":for(d=0;d<Ec.length;d++)zt(Ec[d],r);break;case"image":zt("error",r),zt("load",r);break;case"details":zt("toggle",r);break;case"embed":case"source":case"link":zt("error",r),zt("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(be in l)if(l.hasOwnProperty(be)&&(d=l[be],d!=null))switch(be){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,n));default:pa(r,n,be,d,l,null)}return;default:if(Mo(n)){for(je in l)l.hasOwnProperty(je)&&(d=l[je],d!==void 0&&Gu(r,n,je,d,l,void 0));return}}for(I in l)l.hasOwnProperty(I)&&(d=l[I],d!=null&&pa(r,n,I,d,l,null))}function Ub(r,n,l,d){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,y=null,R=null,I=null,re=null,be=null,je=null;for(we in l){var Me=l[we];if(l.hasOwnProperty(we)&&Me!=null)switch(we){case"checked":break;case"value":break;case"defaultValue":re=Me;default:d.hasOwnProperty(we)||pa(r,n,we,null,d,Me)}}for(var Ae in d){var we=d[Ae];if(Me=l[Ae],d.hasOwnProperty(Ae)&&(we!=null||Me!=null))switch(Ae){case"type":y=we;break;case"name":x=we;break;case"checked":be=we;break;case"defaultChecked":je=we;break;case"value":R=we;break;case"defaultValue":I=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(i(137,n));break;default:we!==Me&&pa(r,n,Ae,we,d,Me)}}Io(r,R,I,re,be,je,y,x);return;case"select":we=R=I=Ae=null;for(y in l)if(re=l[y],l.hasOwnProperty(y)&&re!=null)switch(y){case"value":break;case"multiple":we=re;default:d.hasOwnProperty(y)||pa(r,n,y,null,d,re)}for(x in d)if(y=d[x],re=l[x],d.hasOwnProperty(x)&&(y!=null||re!=null))switch(x){case"value":Ae=y;break;case"defaultValue":I=y;break;case"multiple":R=y;default:y!==re&&pa(r,n,x,y,d,re)}n=I,l=R,d=we,Ae!=null?Fn(r,!!l,Ae,!1):!!d!=!!l&&(n!=null?Fn(r,!!l,n,!0):Fn(r,!!l,l?[]:"",!1));return;case"textarea":we=Ae=null;for(I in l)if(x=l[I],l.hasOwnProperty(I)&&x!=null&&!d.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:pa(r,n,I,null,d,x)}for(R in d)if(x=d[R],y=l[R],d.hasOwnProperty(R)&&(x!=null||y!=null))switch(R){case"value":Ae=x;break;case"defaultValue":we=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(i(91));break;default:x!==y&&pa(r,n,R,x,d,y)}ss(r,Ae,we);return;case"option":for(var st in l)Ae=l[st],l.hasOwnProperty(st)&&Ae!=null&&!d.hasOwnProperty(st)&&(st==="selected"?r.selected=!1:pa(r,n,st,null,d,Ae));for(re in d)Ae=d[re],we=l[re],d.hasOwnProperty(re)&&Ae!==we&&(Ae!=null||we!=null)&&(re==="selected"?r.selected=Ae&&typeof Ae!="function"&&typeof Ae!="symbol":pa(r,n,re,Ae,d,we));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var xt in l)Ae=l[xt],l.hasOwnProperty(xt)&&Ae!=null&&!d.hasOwnProperty(xt)&&pa(r,n,xt,null,d,Ae);for(be in d)if(Ae=d[be],we=l[be],d.hasOwnProperty(be)&&Ae!==we&&(Ae!=null||we!=null))switch(be){case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(i(137,n));break;default:pa(r,n,be,Ae,d,we)}return;default:if(Mo(n)){for(var ha in l)Ae=l[ha],l.hasOwnProperty(ha)&&Ae!==void 0&&!d.hasOwnProperty(ha)&&Gu(r,n,ha,void 0,d,Ae);for(je in d)Ae=d[je],we=l[je],!d.hasOwnProperty(je)||Ae===we||Ae===void 0&&we===void 0||Gu(r,n,je,Ae,d,we);return}}for(var pe in l)Ae=l[pe],l.hasOwnProperty(pe)&&Ae!=null&&!d.hasOwnProperty(pe)&&pa(r,n,pe,null,d,Ae);for(Me in d)Ae=d[Me],we=l[Me],!d.hasOwnProperty(Me)||Ae===we||Ae==null&&we==null||pa(r,n,Me,Ae,d,we)}function W1(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Hb(){if(typeof performance.getEntriesByType=="function"){for(var r=0,n=0,l=performance.getEntriesByType("resource"),d=0;d<l.length;d++){var x=l[d],y=x.transferSize,R=x.initiatorType,I=x.duration;if(y&&I&&W1(R)){for(R=0,I=x.responseEnd,d+=1;d<l.length;d++){var re=l[d],be=re.startTime;if(be>I)break;var je=re.transferSize,Me=re.initiatorType;je&&W1(Me)&&(re=re.responseEnd,R+=je*(re<I?1:(I-be)/(re-be)))}if(--d,n+=8*(y+R)/(x.duration/1e3),r++,10<r)break}}if(0<r)return n/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Yu=null,Wu=null;function hd(r){return r.nodeType===9?r:r.ownerDocument}function V1(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function X1(r,n){if(r===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&n==="foreignObject"?0:r}function Vu(r,n){return r==="textarea"||r==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Xu=null;function $b(){var r=window.event;return r&&r.type==="popstate"?r===Xu?!1:(Xu=r,!0):(Xu=null,!1)}var q1=typeof setTimeout=="function"?setTimeout:void 0,Gb=typeof clearTimeout=="function"?clearTimeout:void 0,K1=typeof Promise=="function"?Promise:void 0,Yb=typeof queueMicrotask=="function"?queueMicrotask:typeof K1<"u"?function(r){return K1.resolve(null).then(r).catch(Wb)}:q1;function Wb(r){setTimeout(function(){throw r})}function Rs(r){return r==="head"}function J1(r,n){var l=n,d=0;do{var x=l.nextSibling;if(r.removeChild(l),x&&x.nodeType===8)if(l=x.data,l==="/$"||l==="/&"){if(d===0){r.removeChild(x),mo(n);return}d--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")d++;else if(l==="html")Ac(r.ownerDocument.documentElement);else if(l==="head"){l=r.ownerDocument.head,Ac(l);for(var y=l.firstChild;y;){var R=y.nextSibling,I=y.nodeName;y[ge]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&y.rel.toLowerCase()==="stylesheet"||l.removeChild(y),y=R}}else l==="body"&&Ac(r.ownerDocument.body);l=x}while(l);mo(n)}function Q1(r,n){var l=r;r=0;do{var d=l.nextSibling;if(l.nodeType===1?n?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(n?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),d&&d.nodeType===8)if(l=d.data,l==="/$"){if(r===0)break;r--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||r++;l=d}while(l)}function qu(r){var n=r.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var l=n;switch(n=n.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":qu(l),De(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}r.removeChild(l)}}function Vb(r,n,l,d){for(;r.nodeType===1;){var x=l;if(r.nodeName.toLowerCase()!==n.toLowerCase()){if(!d&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(d){if(!r[ge])switch(n){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==x.rel||r.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||r.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||r.getAttribute("title")!==(x.title==null?null:x.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(x.src==null?null:x.src)||r.getAttribute("type")!==(x.type==null?null:x.type)||r.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(n==="input"&&r.type==="hidden"){var y=x.name==null?null:""+x.name;if(x.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=Mn(r.nextSibling),r===null)break}return null}function Xb(r,n,l){if(n==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!l||(r=Mn(r.nextSibling),r===null))return null;return r}function Z1(r,n){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!n||(r=Mn(r.nextSibling),r===null))return null;return r}function Ku(r){return r.data==="$?"||r.data==="$~"}function Ju(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function qb(r,n){var l=r.ownerDocument;if(r.data==="$~")r._reactRetry=n;else if(r.data!=="$?"||l.readyState!=="loading")n();else{var d=function(){n(),l.removeEventListener("DOMContentLoaded",d)};l.addEventListener("DOMContentLoaded",d),r._reactRetry=d}}function Mn(r){for(;r!=null;r=r.nextSibling){var n=r.nodeType;if(n===1||n===3)break;if(n===8){if(n=r.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return r}var Qu=null;function ex(r){r=r.nextSibling;for(var n=0;r;){if(r.nodeType===8){var l=r.data;if(l==="/$"||l==="/&"){if(n===0)return Mn(r.nextSibling);n--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||n++}r=r.nextSibling}return null}function tx(r){r=r.previousSibling;for(var n=0;r;){if(r.nodeType===8){var l=r.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(n===0)return r;n--}else l!=="/$"&&l!=="/&"||n++}r=r.previousSibling}return null}function ax(r,n,l){switch(n=hd(l),r){case"html":if(r=n.documentElement,!r)throw Error(i(452));return r;case"head":if(r=n.head,!r)throw Error(i(453));return r;case"body":if(r=n.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function Ac(r){for(var n=r.attributes;n.length;)r.removeAttributeNode(n[0]);De(r)}var Ln=new Map,rx=new Set;function gd(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var qi=_e.d;_e.d={f:Kb,r:Jb,D:Qb,C:Zb,L:e2,m:t2,X:r2,S:a2,M:n2};function Kb(){var r=qi.f(),n=sd();return r||n}function Jb(r){var n=Xe(r);n!==null&&n.tag===5&&n.type==="form"?bg(n):qi.r(r)}var ho=typeof document>"u"?null:document;function nx(r,n,l){var d=ho;if(d&&typeof n=="string"&&n){var x=Tr(n);x='link[rel="'+r+'"][href="'+x+'"]',typeof l=="string"&&(x+='[crossorigin="'+l+'"]'),rx.has(x)||(rx.add(x),r={rel:r,crossOrigin:l,href:n},d.querySelector(x)===null&&(n=d.createElement("link"),Rr(n,"link",r),it(n),d.head.appendChild(n)))}}function Qb(r){qi.D(r),nx("dns-prefetch",r,null)}function Zb(r,n){qi.C(r,n),nx("preconnect",r,n)}function e2(r,n,l){qi.L(r,n,l);var d=ho;if(d&&r&&n){var x='link[rel="preload"][as="'+Tr(n)+'"]';n==="image"&&l&&l.imageSrcSet?(x+='[imagesrcset="'+Tr(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(x+='[imagesizes="'+Tr(l.imageSizes)+'"]')):x+='[href="'+Tr(r)+'"]';var y=x;switch(n){case"style":y=go(r);break;case"script":y=xo(r)}Ln.has(y)||(r=A({rel:"preload",href:n==="image"&&l&&l.imageSrcSet?void 0:r,as:n},l),Ln.set(y,r),d.querySelector(x)!==null||n==="style"&&d.querySelector(_c(y))||n==="script"&&d.querySelector(Cc(y))||(n=d.createElement("link"),Rr(n,"link",r),it(n),d.head.appendChild(n)))}}function t2(r,n){qi.m(r,n);var l=ho;if(l&&r){var d=n&&typeof n.as=="string"?n.as:"script",x='link[rel="modulepreload"][as="'+Tr(d)+'"][href="'+Tr(r)+'"]',y=x;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=xo(r)}if(!Ln.has(y)&&(r=A({rel:"modulepreload",href:r},n),Ln.set(y,r),l.querySelector(x)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Cc(y)))return}d=l.createElement("link"),Rr(d,"link",r),it(d),l.head.appendChild(d)}}}function a2(r,n,l){qi.S(r,n,l);var d=ho;if(d&&r){var x=We(d).hoistableStyles,y=go(r);n=n||"default";var R=x.get(y);if(!R){var I={loading:0,preload:null};if(R=d.querySelector(_c(y)))I.loading=5;else{r=A({rel:"stylesheet",href:r,"data-precedence":n},l),(l=Ln.get(y))&&Zu(r,l);var re=R=d.createElement("link");it(re),Rr(re,"link",r),re._p=new Promise(function(be,je){re.onload=be,re.onerror=je}),re.addEventListener("load",function(){I.loading|=1}),re.addEventListener("error",function(){I.loading|=2}),I.loading|=4,xd(R,n,d)}R={type:"stylesheet",instance:R,count:1,state:I},x.set(y,R)}}}function r2(r,n){qi.X(r,n);var l=ho;if(l&&r){var d=We(l).hoistableScripts,x=xo(r),y=d.get(x);y||(y=l.querySelector(Cc(x)),y||(r=A({src:r,async:!0},n),(n=Ln.get(x))&&ep(r,n),y=l.createElement("script"),it(y),Rr(y,"link",r),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(x,y))}}function n2(r,n){qi.M(r,n);var l=ho;if(l&&r){var d=We(l).hoistableScripts,x=xo(r),y=d.get(x);y||(y=l.querySelector(Cc(x)),y||(r=A({src:r,async:!0,type:"module"},n),(n=Ln.get(x))&&ep(r,n),y=l.createElement("script"),it(y),Rr(y,"link",r),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(x,y))}}function ix(r,n,l,d){var x=(x=he.current)?gd(x):null;if(!x)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(n=go(l.href),l=We(x).hoistableStyles,d=l.get(n),d||(d={type:"style",instance:null,count:0,state:null},l.set(n,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){r=go(l.href);var y=We(x).hoistableStyles,R=y.get(r);if(R||(x=x.ownerDocument||x,R={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,R),(y=x.querySelector(_c(r)))&&!y._p&&(R.instance=y,R.state.loading=5),Ln.has(r)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Ln.set(r,l),y||i2(x,r,l,R.state))),n&&d===null)throw Error(i(528,""));return R}if(n&&d!==null)throw Error(i(529,""));return null;case"script":return n=l.async,l=l.src,typeof l=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=xo(l),l=We(x).hoistableScripts,d=l.get(n),d||(d={type:"script",instance:null,count:0,state:null},l.set(n,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function go(r){return'href="'+Tr(r)+'"'}function _c(r){return'link[rel="stylesheet"]['+r+"]"}function sx(r){return A({},r,{"data-precedence":r.precedence,precedence:null})}function i2(r,n,l,d){r.querySelector('link[rel="preload"][as="style"]['+n+"]")?d.loading=1:(n=r.createElement("link"),d.preload=n,n.addEventListener("load",function(){return d.loading|=1}),n.addEventListener("error",function(){return d.loading|=2}),Rr(n,"link",l),it(n),r.head.appendChild(n))}function xo(r){return'[src="'+Tr(r)+'"]'}function Cc(r){return"script[async]"+r}function lx(r,n,l){if(n.count++,n.instance===null)switch(n.type){case"style":var d=r.querySelector('style[data-href~="'+Tr(l.href)+'"]');if(d)return n.instance=d,it(d),d;var x=A({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return d=(r.ownerDocument||r).createElement("style"),it(d),Rr(d,"style",x),xd(d,l.precedence,r),n.instance=d;case"stylesheet":x=go(l.href);var y=r.querySelector(_c(x));if(y)return n.state.loading|=4,n.instance=y,it(y),y;d=sx(l),(x=Ln.get(x))&&Zu(d,x),y=(r.ownerDocument||r).createElement("link"),it(y);var R=y;return R._p=new Promise(function(I,re){R.onload=I,R.onerror=re}),Rr(y,"link",d),n.state.loading|=4,xd(y,l.precedence,r),n.instance=y;case"script":return y=xo(l.src),(x=r.querySelector(Cc(y)))?(n.instance=x,it(x),x):(d=l,(x=Ln.get(y))&&(d=A({},l),ep(d,x)),r=r.ownerDocument||r,x=r.createElement("script"),it(x),Rr(x,"link",d),r.head.appendChild(x),n.instance=x);case"void":return null;default:throw Error(i(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(d=n.instance,n.state.loading|=4,xd(d,l.precedence,r));return n.instance}function xd(r,n,l){for(var d=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=d.length?d[d.length-1]:null,y=x,R=0;R<d.length;R++){var I=d[R];if(I.dataset.precedence===n)y=I;else if(y!==x)break}y?y.parentNode.insertBefore(r,y.nextSibling):(n=l.nodeType===9?l.head:l,n.insertBefore(r,n.firstChild))}function Zu(r,n){r.crossOrigin==null&&(r.crossOrigin=n.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=n.referrerPolicy),r.title==null&&(r.title=n.title)}function ep(r,n){r.crossOrigin==null&&(r.crossOrigin=n.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=n.referrerPolicy),r.integrity==null&&(r.integrity=n.integrity)}var md=null;function ox(r,n,l){if(md===null){var d=new Map,x=md=new Map;x.set(l,d)}else x=md,d=x.get(l),d||(d=new Map,x.set(l,d));if(d.has(r))return d;for(d.set(r,null),l=l.getElementsByTagName(r),x=0;x<l.length;x++){var y=l[x];if(!(y[ge]||y[U]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var R=y.getAttribute(n)||"";R=r+R;var I=d.get(R);I?I.push(y):d.set(R,[y])}}return d}function cx(r,n,l){r=r.ownerDocument||r,r.head.insertBefore(l,n==="title"?r.querySelector("head > title"):null)}function s2(r,n,l){if(l===1||n.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;return n.rel==="stylesheet"?(r=n.disabled,typeof n.precedence=="string"&&r==null):!0;case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function dx(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function l2(r,n,l,d){if(l.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var x=go(d.href),y=n.querySelector(_c(x));if(y){n=y._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(r.count++,r=vd.bind(r),n.then(r,r)),l.state.loading|=4,l.instance=y,it(y);return}y=n.ownerDocument||n,d=sx(d),(x=Ln.get(x))&&Zu(d,x),y=y.createElement("link"),it(y);var R=y;R._p=new Promise(function(I,re){R.onload=I,R.onerror=re}),Rr(y,"link",d),l.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(l,n),(n=l.state.preload)&&(l.state.loading&3)===0&&(r.count++,l=vd.bind(r),n.addEventListener("load",l),n.addEventListener("error",l))}}var tp=0;function o2(r,n){return r.stylesheets&&r.count===0&&bd(r,r.stylesheets),0<r.count||0<r.imgCount?function(l){var d=setTimeout(function(){if(r.stylesheets&&bd(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+n);0<r.imgBytes&&tp===0&&(tp=62500*Hb());var x=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&bd(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>tp?50:800)+n);return r.unsuspend=l,function(){r.unsuspend=null,clearTimeout(d),clearTimeout(x)}}:null}function vd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)bd(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var yd=null;function bd(r,n){r.stylesheets=null,r.unsuspend!==null&&(r.count++,yd=new Map,n.forEach(c2,r),yd=null,vd.call(r))}function c2(r,n){if(!(n.state.loading&4)){var l=yd.get(r);if(l)var d=l.get(null);else{l=new Map,yd.set(r,l);for(var x=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<x.length;y++){var R=x[y];(R.nodeName==="LINK"||R.getAttribute("media")!=="not all")&&(l.set(R.dataset.precedence,R),d=R)}d&&l.set(null,d)}x=n.instance,R=x.getAttribute("data-precedence"),y=l.get(R)||d,y===d&&l.set(null,x),l.set(R,x),this.count++,d=vd.bind(this),x.addEventListener("load",d),x.addEventListener("error",d),y?y.parentNode.insertBefore(x,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(x,r.firstChild)),n.state.loading|=4}}var kc={$$typeof:B,Provider:null,Consumer:null,_currentValue:Ze,_currentValue2:Ze,_threadCount:0};function d2(r,n,l,d,x,y,R,I,re){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Rn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rn(0),this.hiddenUpdates=Rn(null),this.identifierPrefix=d,this.onUncaughtError=x,this.onCaughtError=y,this.onRecoverableError=R,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=re,this.incompleteTransitions=new Map}function fx(r,n,l,d,x,y,R,I,re,be,je,Me){return r=new d2(r,n,l,R,re,be,je,Me,I),n=1,y===!0&&(n|=24),y=Ye(3,null,null,n),r.current=y,y.stateNode=r,n=Of(),n.refCount++,r.pooledCache=n,n.refCount++,y.memoizedState={element:d,isDehydrated:l,cache:n},Lf(y),r}function ux(r){return r?(r=me,r):me}function px(r,n,l,d,x,y){x=ux(x),d.context===null?d.context=x:d.pendingContext=x,d=vs(n),d.payload={element:l},y=y===void 0?null:y,y!==null&&(d.callback=y),l=ys(r,d,n),l!==null&&(on(l,r,n),ic(l,r,n))}function hx(r,n){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var l=r.retryLane;r.retryLane=l!==0&&l<n?l:n}}function ap(r,n){hx(r,n),(r=r.alternate)&&hx(r,n)}function gx(r){if(r.tag===13||r.tag===31){var n=Y(r,67108864);n!==null&&on(n,r,67108864),ap(r,67108864)}}function xx(r){if(r.tag===13||r.tag===31){var n=Sn();n=Ol(n);var l=Y(r,n);l!==null&&on(l,r,n),ap(r,n)}}var Sd=!0;function f2(r,n,l,d){var x=de.T;de.T=null;var y=_e.p;try{_e.p=2,rp(r,n,l,d)}finally{_e.p=y,de.T=x}}function u2(r,n,l,d){var x=de.T;de.T=null;var y=_e.p;try{_e.p=8,rp(r,n,l,d)}finally{_e.p=y,de.T=x}}function rp(r,n,l,d){if(Sd){var x=np(d);if(x===null)$u(r,n,d,Ed,l),vx(r,d);else if(h2(x,r,n,l,d))d.stopPropagation();else if(vx(r,d),n&4&&-1<p2.indexOf(r)){for(;x!==null;){var y=Xe(x);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var R=Wr(y.pendingLanes);if(R!==0){var I=y;for(I.pendingLanes|=2,I.entangledLanes|=2;R;){var re=1<<31-Ut(R);I.entanglements[1]|=re,R&=~re}bi(y),(ta&6)===0&&(nd=ia()+500,Sc(0))}}break;case 31:case 13:I=Y(y,2),I!==null&&on(I,y,2),sd(),ap(y,2)}if(y=np(d),y===null&&$u(r,n,d,Ed,l),y===x)break;x=y}x!==null&&d.stopPropagation()}else $u(r,n,d,null,l)}}function np(r){return r=Lo(r),ip(r)}var Ed=null;function ip(r){if(Ed=null,r=Ve(r),r!==null){var n=c(r);if(n===null)r=null;else{var l=n.tag;if(l===13){if(r=f(n),r!==null)return r;r=null}else if(l===31){if(r=p(n),r!==null)return r;r=null}else if(l===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;r=null}else n!==r&&(r=null)}}return Ed=r,null}function mx(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Dr()){case sa:return 2;case ki:return 8;case Lt:case Et:return 32;case ht:return 268435456;default:return 32}default:return 32}}var sp=!1,Ns=null,Fs=null,js=null,wc=new Map,Rc=new Map,Ds=[],p2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vx(r,n){switch(r){case"focusin":case"focusout":Ns=null;break;case"dragenter":case"dragleave":Fs=null;break;case"mouseover":case"mouseout":js=null;break;case"pointerover":case"pointerout":wc.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rc.delete(n.pointerId)}}function Nc(r,n,l,d,x,y){return r===null||r.nativeEvent!==y?(r={blockedOn:n,domEventName:l,eventSystemFlags:d,nativeEvent:y,targetContainers:[x]},n!==null&&(n=Xe(n),n!==null&&gx(n)),r):(r.eventSystemFlags|=d,n=r.targetContainers,x!==null&&n.indexOf(x)===-1&&n.push(x),r)}function h2(r,n,l,d,x){switch(n){case"focusin":return Ns=Nc(Ns,r,n,l,d,x),!0;case"dragenter":return Fs=Nc(Fs,r,n,l,d,x),!0;case"mouseover":return js=Nc(js,r,n,l,d,x),!0;case"pointerover":var y=x.pointerId;return wc.set(y,Nc(wc.get(y)||null,r,n,l,d,x)),!0;case"gotpointercapture":return y=x.pointerId,Rc.set(y,Nc(Rc.get(y)||null,r,n,l,d,x)),!0}return!1}function yx(r){var n=Ve(r.target);if(n!==null){var l=c(n);if(l!==null){if(n=l.tag,n===13){if(n=f(l),n!==null){r.blockedOn=n,W(r.priority,function(){xx(l)});return}}else if(n===31){if(n=p(l),n!==null){r.blockedOn=n,W(r.priority,function(){xx(l)});return}}else if(n===3&&l.stateNode.current.memoizedState.isDehydrated){r.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Td(r){if(r.blockedOn!==null)return!1;for(var n=r.targetContainers;0<n.length;){var l=np(r.nativeEvent);if(l===null){l=r.nativeEvent;var d=new l.constructor(l.type,l);ls=d,l.target.dispatchEvent(d),ls=null}else return n=Xe(l),n!==null&&gx(n),r.blockedOn=l,!1;n.shift()}return!0}function bx(r,n,l){Td(r)&&l.delete(n)}function g2(){sp=!1,Ns!==null&&Td(Ns)&&(Ns=null),Fs!==null&&Td(Fs)&&(Fs=null),js!==null&&Td(js)&&(js=null),wc.forEach(bx),Rc.forEach(bx)}function Ad(r,n){r.blockedOn===n&&(r.blockedOn=null,sp||(sp=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,g2)))}var _d=null;function Sx(r){_d!==r&&(_d=r,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){_d===r&&(_d=null);for(var n=0;n<r.length;n+=3){var l=r[n],d=r[n+1],x=r[n+2];if(typeof d!="function"){if(ip(d||l)===null)continue;break}var y=Xe(l);y!==null&&(r.splice(n,3),n-=3,nu(y,{pending:!0,data:x,method:l.method,action:d},d,x))}}))}function mo(r){function n(re){return Ad(re,r)}Ns!==null&&Ad(Ns,r),Fs!==null&&Ad(Fs,r),js!==null&&Ad(js,r),wc.forEach(n),Rc.forEach(n);for(var l=0;l<Ds.length;l++){var d=Ds[l];d.blockedOn===r&&(d.blockedOn=null)}for(;0<Ds.length&&(l=Ds[0],l.blockedOn===null);)yx(l),l.blockedOn===null&&Ds.shift();if(l=(r.ownerDocument||r).$$reactFormReplay,l!=null)for(d=0;d<l.length;d+=3){var x=l[d],y=l[d+1],R=x[G]||null;if(typeof y=="function")R||Sx(l);else if(R){var I=null;if(y&&y.hasAttribute("formAction")){if(x=y,R=y[G]||null)I=R.formAction;else if(ip(x)!==null)continue}else I=R.action;typeof I=="function"?l[d+1]=I:(l.splice(d,3),d-=3),Sx(l)}}}function Ex(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(R){return x=R})},focusReset:"manual",scroll:"manual"})}function n(){x!==null&&(x(),x=null),d||setTimeout(l,20)}function l(){if(!d&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,x=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(l,100),function(){d=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),x!==null&&(x(),x=null)}}}function lp(r){this._internalRoot=r}Cd.prototype.render=lp.prototype.render=function(r){var n=this._internalRoot;if(n===null)throw Error(i(409));var l=n.current,d=Sn();px(l,d,r,n,null,null)},Cd.prototype.unmount=lp.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var n=r.containerInfo;px(r.current,2,null,r,null,null),sd(),n[V]=null}};function Cd(r){this._internalRoot=r}Cd.prototype.unstable_scheduleHydration=function(r){if(r){var n=D();r={blockedOn:null,target:r,priority:n};for(var l=0;l<Ds.length&&n!==0&&n<Ds[l].priority;l++);Ds.splice(l,0,r),l===0&&yx(r)}};var Tx=a.version;if(Tx!=="19.2.3")throw Error(i(527,Tx,"19.2.3"));_e.findDOMNode=function(r){var n=r._reactInternals;if(n===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=h(n),r=r!==null?E(r):null,r=r===null?null:r.stateNode,r};var x2={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:de,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kd.isDisabled&&kd.supportsFiber)try{na=kd.inject(x2),Ta=kd}catch{}}return jc.createRoot=function(r,n){if(!s(r))throw Error(i(299));var l=!1,d="",x=Ng,y=Fg,R=jg;return n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(d=n.identifierPrefix),n.onUncaughtError!==void 0&&(x=n.onUncaughtError),n.onCaughtError!==void 0&&(y=n.onCaughtError),n.onRecoverableError!==void 0&&(R=n.onRecoverableError)),n=fx(r,1,!1,null,null,l,d,null,x,y,R,Ex),r[V]=n.current,Hu(r),new lp(n)},jc.hydrateRoot=function(r,n,l){if(!s(r))throw Error(i(299));var d=!1,x="",y=Ng,R=Fg,I=jg,re=null;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(x=l.identifierPrefix),l.onUncaughtError!==void 0&&(y=l.onUncaughtError),l.onCaughtError!==void 0&&(R=l.onCaughtError),l.onRecoverableError!==void 0&&(I=l.onRecoverableError),l.formState!==void 0&&(re=l.formState)),n=fx(r,1,!0,n,l??null,d,x,re,y,R,I,Ex),n.context=ux(null),l=n.current,d=Sn(),d=Ol(d),x=vs(d),x.callback=null,ys(l,x,d),l=d,n.current.lanes=l,Xn(n,l),bi(n),r[V]=n.current,Hu(r),new Cd(n)},jc.version="19.2.3",jc}var Dx;function w2(){if(Dx)return dp.exports;Dx=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(a){console.error(a)}}return e(),dp.exports=k2(),dp.exports}var R2=w2();var Pd={};Pd.version="0.18.5";var Wm=1252,N2=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Up={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Hp=function(e){N2.indexOf(e)!=-1&&(Wm=Up[0]=e)};function F2(){Hp(1252)}var ii=function(e){Hp(e)};function $p(){ii(1200),F2()}function Ox(e){for(var a=[],t=0,i=e.length;t<i;++t)a[t]=e.charCodeAt(t);return a}function j2(e){for(var a=[],t=0;t<e.length>>1;++t)a[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return a.join("")}function Vm(e){for(var a=[],t=0;t<e.length>>1;++t)a[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return a.join("")}var Oc=function(e){var a=e.charCodeAt(0),t=e.charCodeAt(1);return a==255&&t==254?j2(e.slice(2)):a==254&&t==255?Vm(e.slice(2)):a==65279?e.slice(1):e},wd=function(a){return String.fromCharCode(a)},Ix=function(a){return String.fromCharCode(a)},Yc,Bs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Wc(e){for(var a="",t=0,i=0,s=0,c=0,f=0,p=0,g=0,h=0;h<e.length;)t=e.charCodeAt(h++),c=t>>2,i=e.charCodeAt(h++),f=(t&3)<<4|i>>4,s=e.charCodeAt(h++),p=(i&15)<<2|s>>6,g=s&63,isNaN(i)?p=g=64:isNaN(s)&&(g=64),a+=Bs.charAt(c)+Bs.charAt(f)+Bs.charAt(p)+Bs.charAt(g);return a}function Cn(e){var a="",t=0,i=0,s=0,c=0,f=0,p=0,g=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)c=Bs.indexOf(e.charAt(h++)),f=Bs.indexOf(e.charAt(h++)),t=c<<2|f>>4,a+=String.fromCharCode(t),p=Bs.indexOf(e.charAt(h++)),i=(f&15)<<4|p>>2,p!==64&&(a+=String.fromCharCode(i)),g=Bs.indexOf(e.charAt(h++)),s=(p&3)<<6|g,g!==64&&(a+=String.fromCharCode(s));return a}var It=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ts=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(a,t){return t?new Buffer(a,t):new Buffer(a)}:Buffer.from.bind(Buffer)}return function(){}})();function Ls(e){return It?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Bx(e){return It?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var An=function(a){return It?ts(a,"binary"):a.split("").map(function(t){return t.charCodeAt(0)&255})};function Zd(e){if(typeof ArrayBuffer>"u")return An(e);for(var a=new ArrayBuffer(e.length),t=new Uint8Array(a),i=0;i!=e.length;++i)t[i]=e.charCodeAt(i)&255;return a}function Hs(e){if(Array.isArray(e))return e.map(function(i){return String.fromCharCode(i)}).join("");for(var a=[],t=0;t<e.length;++t)a[t]=String.fromCharCode(e[t]);return a.join("")}function D2(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Gp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Gp(new Uint8Array(e));for(var a=new Array(e.length),t=0;t<e.length;++t)a[t]=e[t];return a}var br=It?function(e){return Buffer.concat(e.map(function(a){return Buffer.isBuffer(a)?a:ts(a)}))}:function(e){if(typeof Uint8Array<"u"){var a=0,t=0;for(a=0;a<e.length;++a)t+=e[a].length;var i=new Uint8Array(t),s=0;for(a=0,t=0;a<e.length;t+=s,++a)if(s=e[a].length,e[a]instanceof Uint8Array)i.set(e[a],t);else{if(typeof e[a]=="string")throw"wtf";i.set(new Uint8Array(e[a]),t)}return i}return[].concat.apply([],e.map(function(c){return Array.isArray(c)?c:[].slice.call(c)}))};function O2(e){for(var a=[],t=0,i=e.length+250,s=Ls(e.length+255),c=0;c<e.length;++c){var f=e.charCodeAt(c);if(f<128)s[t++]=f;else if(f<2048)s[t++]=192|f>>6&31,s[t++]=128|f&63;else if(f>=55296&&f<57344){f=(f&1023)+64;var p=e.charCodeAt(++c)&1023;s[t++]=240|f>>8&7,s[t++]=128|f>>2&63,s[t++]=128|p>>6&15|(f&3)<<4,s[t++]=128|p&63}else s[t++]=224|f>>12&15,s[t++]=128|f>>6&63,s[t++]=128|f&63;t>i&&(a.push(s.slice(0,t)),t=0,s=Ls(65535),i=65530)}return a.push(s.slice(0,t)),br(a)}var Qr=/\u0000/g,Ic=/[\u0001-\u0006]/g;function To(e){for(var a="",t=e.length-1;t>=0;)a+=e.charAt(t--);return a}function si(e,a){var t=""+e;return t.length>=a?t:Pa("0",a-t.length)+t}function Yp(e,a){var t=""+e;return t.length>=a?t:Pa(" ",a-t.length)+t}function zd(e,a){var t=""+e;return t.length>=a?t:t+Pa(" ",a-t.length)}function I2(e,a){var t=""+Math.round(e);return t.length>=a?t:Pa("0",a-t.length)+t}function B2(e,a){var t=""+e;return t.length>=a?t:Pa("0",a-t.length)+t}var Mx=Math.pow(2,32);function vo(e,a){if(e>Mx||e<-Mx)return I2(e,a);var t=Math.round(e);return B2(t,a)}function Ud(e,a){return a=a||0,e.length>=7+a&&(e.charCodeAt(a)|32)===103&&(e.charCodeAt(a+1)|32)===101&&(e.charCodeAt(a+2)|32)===110&&(e.charCodeAt(a+3)|32)===101&&(e.charCodeAt(a+4)|32)===114&&(e.charCodeAt(a+5)|32)===97&&(e.charCodeAt(a+6)|32)===108}var Lx=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],hp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function M2(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var mt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Px={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},L2={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Hd(e,a,t){for(var i=e<0?-1:1,s=e*i,c=0,f=1,p=0,g=1,h=0,E=0,A=Math.floor(s);h<a&&(A=Math.floor(s),p=A*f+c,E=A*h+g,!(s-A<5e-8));)s=1/(s-A),c=f,f=p,g=h,h=E;if(E>a&&(h>a?(E=g,p=c):(E=h,p=f)),!t)return[0,i*p,E];var _=Math.floor(i*p/E);return[_,i*p-_*E,E]}function xl(e,a,t){if(e>2958465||e<0)return null;var i=e|0,s=Math.floor(86400*(e-i)),c=0,f=[],p={D:i,T:s,u:86400*(e-i)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(p.u)<1e-6&&(p.u=0),a&&a.date1904&&(i+=1462),p.u>.9999&&(p.u=0,++s==86400&&(p.T=s=0,++i,++p.D)),i===60)f=t?[1317,10,29]:[1900,2,29],c=3;else if(i===0)f=t?[1317,8,29]:[1900,1,0],c=6;else{i>60&&--i;var g=new Date(1900,0,1);g.setDate(g.getDate()+i-1),f=[g.getFullYear(),g.getMonth()+1,g.getDate()],c=g.getDay(),i<60&&(c=(c+6)%7),t&&(c=G2(g,f))}return p.y=f[0],p.m=f[1],p.d=f[2],p.S=s%60,s=Math.floor(s/60),p.M=s%60,s=Math.floor(s/60),p.H=s,p.q=c,p}var Xm=new Date(1899,11,31,0,0,0),P2=Xm.getTime(),z2=new Date(1900,2,1,0,0,0);function qm(e,a){var t=e.getTime();return a?t-=1461*24*60*60*1e3:e>=z2&&(t+=1440*60*1e3),(t-(P2+(e.getTimezoneOffset()-Xm.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Wp(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function U2(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function H2(e){var a=e<0?12:11,t=Wp(e.toFixed(12));return t.length<=a||(t=e.toPrecision(10),t.length<=a)?t:e.toExponential(5)}function $2(e){var a=Wp(e.toFixed(11));return a.length>(e<0?12:11)||a==="0"||a==="-0"?e.toPrecision(6):a}function Vc(e){var a=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return a>=-4&&a<=-1?t=e.toPrecision(10+a):Math.abs(a)<=9?t=H2(e):a===10?t=e.toFixed(10).substr(0,12):t=$2(e),Wp(U2(t.toUpperCase()))}function Sl(e,a){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Vc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Wn(14,qm(e,a&&a.date1904),a)}throw new Error("unsupported value in General format: "+e)}function G2(e,a){a[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function Y2(e,a,t,i){var s="",c=0,f=0,p=t.y,g,h=0;switch(e){case 98:p=t.y+543;case 121:switch(a.length){case 1:case 2:g=p%100,h=2;break;default:g=p%1e4,h=4;break}break;case 109:switch(a.length){case 1:case 2:g=t.m,h=a.length;break;case 3:return hp[t.m-1][1];case 5:return hp[t.m-1][0];default:return hp[t.m-1][2]}break;case 100:switch(a.length){case 1:case 2:g=t.d,h=a.length;break;case 3:return Lx[t.q][0];default:return Lx[t.q][1]}break;case 104:switch(a.length){case 1:case 2:g=1+(t.H+11)%12,h=a.length;break;default:throw"bad hour format: "+a}break;case 72:switch(a.length){case 1:case 2:g=t.H,h=a.length;break;default:throw"bad hour format: "+a}break;case 77:switch(a.length){case 1:case 2:g=t.M,h=a.length;break;default:throw"bad minute format: "+a}break;case 115:if(a!="s"&&a!="ss"&&a!=".0"&&a!=".00"&&a!=".000")throw"bad second format: "+a;return t.u===0&&(a=="s"||a=="ss")?si(t.S,a.length):(i>=2?f=i===3?1e3:100:f=i===1?10:1,c=Math.round(f*(t.S+t.u)),c>=60*f&&(c=0),a==="s"?c===0?"0":""+c/f:(s=si(c,2+i),a==="ss"?s.substr(0,2):"."+s.substr(2,a.length-1)));case 90:switch(a){case"[h]":case"[hh]":g=t.D*24+t.H;break;case"[m]":case"[mm]":g=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":g=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+a}h=a.length===3?1:2;break;case 101:g=p,h=1;break}var E=h>0?si(g,h):"";return E}function Ms(e){var a=3;if(e.length<=a)return e;for(var t=e.length%a,i=e.substr(0,t);t!=e.length;t+=a)i+=(i.length>0?",":"")+e.substr(t,a);return i}var Km=/%/g;function W2(e,a,t){var i=a.replace(Km,""),s=a.length-i.length;return Ji(e,i,t*Math.pow(10,2*s))+Pa("%",s)}function V2(e,a,t){for(var i=a.length-1;a.charCodeAt(i-1)===44;)--i;return Ji(e,a.substr(0,i),t/Math.pow(10,3*(a.length-i)))}function Jm(e,a){var t,i=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(a==0)return"0.0E+0";if(a<0)return"-"+Jm(e,-a);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var c=Math.floor(Math.log(a)*Math.LOG10E)%s;if(c<0&&(c+=s),t=(a/Math.pow(10,c)).toPrecision(i+1+(s+c)%s),t.indexOf("e")===-1){var f=Math.floor(Math.log(a)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(f-t.length+c):t+="E+"+(f-c);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,s)+"."+t.substr(2+s),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(p,g,h,E){return g+h+E.substr(0,(s+c)%s)+"."+E.substr(c)+"E"})}else t=a.toExponential(i);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Qm=/# (\?+)( ?)\/( ?)(\d+)/;function X2(e,a,t){var i=parseInt(e[4],10),s=Math.round(a*i),c=Math.floor(s/i),f=s-c*i,p=i;return t+(c===0?"":""+c)+" "+(f===0?Pa(" ",e[1].length+1+e[4].length):Yp(f,e[1].length)+e[2]+"/"+e[3]+si(p,e[4].length))}function q2(e,a,t){return t+(a===0?"":""+a)+Pa(" ",e[1].length+2+e[4].length)}var Zm=/^#*0*\.([0#]+)/,ev=/\).*[0#]/,tv=/\(###\) ###\\?-####/;function Kr(e){for(var a="",t,i=0;i!=e.length;++i)switch(t=e.charCodeAt(i)){case 35:break;case 63:a+=" ";break;case 48:a+="0";break;default:a+=String.fromCharCode(t)}return a}function zx(e,a){var t=Math.pow(10,a);return""+Math.round(e*t)/t}function Ux(e,a){var t=e-Math.floor(e),i=Math.pow(10,a);return a<(""+Math.round(t*i)).length?0:Math.round(t*i)}function K2(e,a){return a<(""+Math.round((e-Math.floor(e))*Math.pow(10,a))).length?1:0}function J2(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function zn(e,a,t){if(e.charCodeAt(0)===40&&!a.match(ev)){var i=a.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?zn("n",i,t):"("+zn("n",i,-t)+")"}if(a.charCodeAt(a.length-1)===44)return V2(e,a,t);if(a.indexOf("%")!==-1)return W2(e,a,t);if(a.indexOf("E")!==-1)return Jm(a,t);if(a.charCodeAt(0)===36)return"$"+zn(e,a.substr(a.charAt(1)==" "?2:1),t);var s,c,f,p,g=Math.abs(t),h=t<0?"-":"";if(a.match(/^00+$/))return h+vo(g,a.length);if(a.match(/^[#?]+$/))return s=vo(t,0),s==="0"&&(s=""),s.length>a.length?s:Kr(a.substr(0,a.length-s.length))+s;if(c=a.match(Qm))return X2(c,g,h);if(a.match(/^#+0+$/))return h+vo(g,a.length-a.indexOf("0"));if(c=a.match(Zm))return s=zx(t,c[1].length).replace(/^([^\.]+)$/,"$1."+Kr(c[1])).replace(/\.$/,"."+Kr(c[1])).replace(/\.(\d*)$/,function(N,k){return"."+k+Pa("0",Kr(c[1]).length-k.length)}),a.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(a=a.replace(/^#+([0.])/,"$1"),c=a.match(/^(0*)\.(#*)$/))return h+zx(g,c[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=a.match(/^#{1,3},##0(\.?)$/))return h+Ms(vo(g,0));if(c=a.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+zn(e,a,-t):Ms(""+(Math.floor(t)+K2(t,c[1].length)))+"."+si(Ux(t,c[1].length),c[1].length);if(c=a.match(/^#,#*,#0/))return zn(e,a.replace(/^#,#*,/,""),t);if(c=a.match(/^([0#]+)(\\?-([0#]+))+$/))return s=To(zn(e,a.replace(/[\\-]/g,""),t)),f=0,To(To(a.replace(/\\/g,"")).replace(/[0#]/g,function(N){return f<s.length?s.charAt(f++):N==="0"?"0":""}));if(a.match(tv))return s=zn(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var E="";if(c=a.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(c[4].length,7),p=Hd(g,Math.pow(10,f)-1,!1),s=""+h,E=Ji("n",c[1],p[1]),E.charAt(E.length-1)==" "&&(E=E.substr(0,E.length-1)+"0"),s+=E+c[2]+"/"+c[3],E=zd(p[2],f),E.length<c[4].length&&(E=Kr(c[4].substr(c[4].length-E.length))+E),s+=E,s;if(c=a.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(Math.max(c[1].length,c[4].length),7),p=Hd(g,Math.pow(10,f)-1,!0),h+(p[0]||(p[1]?"":"0"))+" "+(p[1]?Yp(p[1],f)+c[2]+"/"+c[3]+zd(p[2],f):Pa(" ",2*f+1+c[2].length+c[3].length));if(c=a.match(/^[#0?]+$/))return s=vo(t,0),a.length<=s.length?s:Kr(a.substr(0,a.length-s.length))+s;if(c=a.match(/^([#0?]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),f=s.indexOf(".");var A=a.indexOf(".")-f,_=a.length-s.length-A;return Kr(a.substr(0,A)+s+a.substr(a.length-_))}if(c=a.match(/^00,000\.([#0]*0)$/))return f=Ux(t,c[1].length),t<0?"-"+zn(e,a,-t):Ms(J2(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(N){return"00,"+(N.length<3?si(0,3-N.length):"")+N})+"."+si(f,c[1].length);switch(a){case"###,##0.00":return zn(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var w=Ms(vo(g,0));return w!=="0"?h+w:"";case"###,###.00":return zn(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return zn(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+a+"|")}function Q2(e,a,t){for(var i=a.length-1;a.charCodeAt(i-1)===44;)--i;return Ji(e,a.substr(0,i),t/Math.pow(10,3*(a.length-i)))}function Z2(e,a,t){var i=a.replace(Km,""),s=a.length-i.length;return Ji(e,i,t*Math.pow(10,2*s))+Pa("%",s)}function av(e,a){var t,i=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(a==0)return"0.0E+0";if(a<0)return"-"+av(e,-a);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var c=Math.floor(Math.log(a)*Math.LOG10E)%s;if(c<0&&(c+=s),t=(a/Math.pow(10,c)).toPrecision(i+1+(s+c)%s),!t.match(/[Ee]/)){var f=Math.floor(Math.log(a)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(f-t.length+c):t+="E+"+(f-c),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(p,g,h,E){return g+h+E.substr(0,(s+c)%s)+"."+E.substr(c)+"E"})}else t=a.toExponential(i);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Ei(e,a,t){if(e.charCodeAt(0)===40&&!a.match(ev)){var i=a.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ei("n",i,t):"("+Ei("n",i,-t)+")"}if(a.charCodeAt(a.length-1)===44)return Q2(e,a,t);if(a.indexOf("%")!==-1)return Z2(e,a,t);if(a.indexOf("E")!==-1)return av(a,t);if(a.charCodeAt(0)===36)return"$"+Ei(e,a.substr(a.charAt(1)==" "?2:1),t);var s,c,f,p,g=Math.abs(t),h=t<0?"-":"";if(a.match(/^00+$/))return h+si(g,a.length);if(a.match(/^[#?]+$/))return s=""+t,t===0&&(s=""),s.length>a.length?s:Kr(a.substr(0,a.length-s.length))+s;if(c=a.match(Qm))return q2(c,g,h);if(a.match(/^#+0+$/))return h+si(g,a.length-a.indexOf("0"));if(c=a.match(Zm))return s=(""+t).replace(/^([^\.]+)$/,"$1."+Kr(c[1])).replace(/\.$/,"."+Kr(c[1])),s=s.replace(/\.(\d*)$/,function(N,k){return"."+k+Pa("0",Kr(c[1]).length-k.length)}),a.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(a=a.replace(/^#+([0.])/,"$1"),c=a.match(/^(0*)\.(#*)$/))return h+(""+g).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=a.match(/^#{1,3},##0(\.?)$/))return h+Ms(""+g);if(c=a.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ei(e,a,-t):Ms(""+t)+"."+Pa("0",c[1].length);if(c=a.match(/^#,#*,#0/))return Ei(e,a.replace(/^#,#*,/,""),t);if(c=a.match(/^([0#]+)(\\?-([0#]+))+$/))return s=To(Ei(e,a.replace(/[\\-]/g,""),t)),f=0,To(To(a.replace(/\\/g,"")).replace(/[0#]/g,function(N){return f<s.length?s.charAt(f++):N==="0"?"0":""}));if(a.match(tv))return s=Ei(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var E="";if(c=a.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(c[4].length,7),p=Hd(g,Math.pow(10,f)-1,!1),s=""+h,E=Ji("n",c[1],p[1]),E.charAt(E.length-1)==" "&&(E=E.substr(0,E.length-1)+"0"),s+=E+c[2]+"/"+c[3],E=zd(p[2],f),E.length<c[4].length&&(E=Kr(c[4].substr(c[4].length-E.length))+E),s+=E,s;if(c=a.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(Math.max(c[1].length,c[4].length),7),p=Hd(g,Math.pow(10,f)-1,!0),h+(p[0]||(p[1]?"":"0"))+" "+(p[1]?Yp(p[1],f)+c[2]+"/"+c[3]+zd(p[2],f):Pa(" ",2*f+1+c[2].length+c[3].length));if(c=a.match(/^[#0?]+$/))return s=""+t,a.length<=s.length?s:Kr(a.substr(0,a.length-s.length))+s;if(c=a.match(/^([#0]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),f=s.indexOf(".");var A=a.indexOf(".")-f,_=a.length-s.length-A;return Kr(a.substr(0,A)+s+a.substr(a.length-_))}if(c=a.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Ei(e,a,-t):Ms(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(N){return"00,"+(N.length<3?si(0,3-N.length):"")+N})+"."+si(0,c[1].length);switch(a){case"###,###":case"##,###":case"#,###":var w=Ms(""+g);return w!=="0"?h+w:"";default:if(a.match(/\.[0#?]*$/))return Ei(e,a.slice(0,a.lastIndexOf(".")),t)+Kr(a.slice(a.lastIndexOf(".")))}throw new Error("unsupported format |"+a+"|")}function Ji(e,a,t){return(t|0)===t?Ei(e,a,t):zn(e,a,t)}function eS(e){for(var a=[],t=!1,i=0,s=0;i<e.length;++i)switch(e.charCodeAt(i)){case 34:t=!t;break;case 95:case 42:case 92:++i;break;case 59:a[a.length]=e.substr(s,i-s),s=i+1}if(a[a.length]=e.substr(s),t===!0)throw new Error("Format |"+e+"| unterminated string ");return a}var rv=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function No(e){for(var a=0,t="",i="";a<e.length;)switch(t=e.charAt(a)){case"G":Ud(e,a)&&(a+=6),a++;break;case'"':for(;e.charCodeAt(++a)!==34&&a<e.length;);++a;break;case"\\":a+=2;break;case"_":a+=2;break;case"@":++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(a,3).toUpperCase()==="A/P"||e.substr(a,5).toUpperCase()==="AM/PM"||e.substr(a,5).toUpperCase()==="/")return!0;++a;break;case"[":for(i=t;e.charAt(a++)!=="]"&&a<e.length;)i+=e.charAt(a);if(i.match(rv))return!0;break;case".":case"0":case"#":for(;a<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++a))>-1||t=="\\"&&e.charAt(a+1)=="-"&&"0#".indexOf(e.charAt(a+2))>-1););break;case"?":for(;e.charAt(++a)===t;);break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;);break;case" ":++a;break;default:++a;break}return!1}function tS(e,a,t,i){for(var s=[],c="",f=0,p="",g="t",h,E,A,_="H";f<e.length;)switch(p=e.charAt(f)){case"G":if(!Ud(e,f))throw new Error("unrecognized character "+p+" in "+e);s[s.length]={t:"G",v:"General"},f+=7;break;case'"':for(c="";(A=e.charCodeAt(++f))!==34&&f<e.length;)c+=String.fromCharCode(A);s[s.length]={t:"t",v:c},++f;break;case"\\":var w=e.charAt(++f),N=w==="("||w===")"?w:"t";s[s.length]={t:N,v:w},++f;break;case"_":s[s.length]={t:"t",v:" "},f+=2;break;case"@":s[s.length]={t:"T",v:a},++f;break;case"B":case"b":if(e.charAt(f+1)==="1"||e.charAt(f+1)==="2"){if(h==null&&(h=xl(a,t,e.charAt(f+1)==="2"),h==null))return"";s[s.length]={t:"X",v:e.substr(f,2)},g=p,f+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":p=p.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(a<0||h==null&&(h=xl(a,t),h==null))return"";for(c=p;++f<e.length&&e.charAt(f).toLowerCase()===p;)c+=p;p==="m"&&g.toLowerCase()==="h"&&(p="M"),p==="h"&&(p=_),s[s.length]={t:p,v:c},g=p;break;case"A":case"a":case"":var k={t:p,v:p};if(h==null&&(h=xl(a,t)),e.substr(f,3).toUpperCase()==="A/P"?(h!=null&&(k.v=h.H>=12?"P":"A"),k.t="T",_="h",f+=3):e.substr(f,5).toUpperCase()==="AM/PM"?(h!=null&&(k.v=h.H>=12?"PM":"AM"),k.t="T",f+=5,_="h"):e.substr(f,5).toUpperCase()==="/"?(h!=null&&(k.v=h.H>=12?"":""),k.t="T",f+=5,_="h"):(k.t="t",++f),h==null&&k.t==="T")return"";s[s.length]=k,g=p;break;case"[":for(c=p;e.charAt(f++)!=="]"&&f<e.length;)c+=e.charAt(f);if(c.slice(-1)!=="]")throw'unterminated "[" block: |'+c+"|";if(c.match(rv)){if(h==null&&(h=xl(a,t),h==null))return"";s[s.length]={t:"Z",v:c.toLowerCase()},g=c.charAt(1)}else c.indexOf("$")>-1&&(c=(c.match(/\$([^-\[\]]*)/)||[])[1]||"$",No(e)||(s[s.length]={t:"t",v:c}));break;case".":if(h!=null){for(c=p;++f<e.length&&(p=e.charAt(f))==="0";)c+=p;s[s.length]={t:"s",v:c};break}case"0":case"#":for(c=p;++f<e.length&&"0#?.,E+-%".indexOf(p=e.charAt(f))>-1;)c+=p;s[s.length]={t:"n",v:c};break;case"?":for(c=p;e.charAt(++f)===p;)c+=p;s[s.length]={t:p,v:c},g=p;break;case"*":++f,(e.charAt(f)==" "||e.charAt(f)=="*")&&++f;break;case"(":case")":s[s.length]={t:i===1?"t":p,v:p},++f;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(c=p;f<e.length&&"0123456789".indexOf(e.charAt(++f))>-1;)c+=e.charAt(f);s[s.length]={t:"D",v:c};break;case" ":s[s.length]={t:p,v:p},++f;break;case"$":s[s.length]={t:"t",v:"$"},++f;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(p)===-1)throw new Error("unrecognized character "+p+" in "+e);s[s.length]={t:"t",v:p},++f;break}var F=0,z=0,q;for(f=s.length-1,g="t";f>=0;--f)switch(s[f].t){case"h":case"H":s[f].t=_,g="h",F<1&&(F=1);break;case"s":(q=s[f].v.match(/\.0+$/))&&(z=Math.max(z,q[0].length-1)),F<3&&(F=3);case"d":case"y":case"M":case"e":g=s[f].t;break;case"m":g==="s"&&(s[f].t="M",F<2&&(F=2));break;case"X":break;case"Z":F<1&&s[f].v.match(/[Hh]/)&&(F=1),F<2&&s[f].v.match(/[Mm]/)&&(F=2),F<3&&s[f].v.match(/[Ss]/)&&(F=3)}switch(F){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var B="",ie;for(f=0;f<s.length;++f)switch(s[f].t){case"t":case"T":case" ":case"D":break;case"X":s[f].v="",s[f].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[f].v=Y2(s[f].t.charCodeAt(0),s[f].v,h,z),s[f].t="t";break;case"n":case"?":for(ie=f+1;s[ie]!=null&&((p=s[ie].t)==="?"||p==="D"||(p===" "||p==="t")&&s[ie+1]!=null&&(s[ie+1].t==="?"||s[ie+1].t==="t"&&s[ie+1].v==="/")||s[f].t==="("&&(p===" "||p==="n"||p===")")||p==="t"&&(s[ie].v==="/"||s[ie].v===" "&&s[ie+1]!=null&&s[ie+1].t=="?"));)s[f].v+=s[ie].v,s[ie]={v:"",t:";"},++ie;B+=s[f].v,f=ie-1;break;case"G":s[f].t="t",s[f].v=Sl(a,t);break}var se="",ne,H;if(B.length>0){B.charCodeAt(0)==40?(ne=a<0&&B.charCodeAt(0)===45?-a:a,H=Ji("n",B,ne)):(ne=a<0&&i>1?-a:a,H=Ji("n",B,ne),ne<0&&s[0]&&s[0].t=="t"&&(H=H.substr(1),s[0].v="-"+s[0].v)),ie=H.length-1;var le=s.length;for(f=0;f<s.length;++f)if(s[f]!=null&&s[f].t!="t"&&s[f].v.indexOf(".")>-1){le=f;break}var oe=s.length;if(le===s.length&&H.indexOf("E")===-1){for(f=s.length-1;f>=0;--f)s[f]==null||"n?".indexOf(s[f].t)===-1||(ie>=s[f].v.length-1?(ie-=s[f].v.length,s[f].v=H.substr(ie+1,s[f].v.length)):ie<0?s[f].v="":(s[f].v=H.substr(0,ie+1),ie=-1),s[f].t="t",oe=f);ie>=0&&oe<s.length&&(s[oe].v=H.substr(0,ie+1)+s[oe].v)}else if(le!==s.length&&H.indexOf("E")===-1){for(ie=H.indexOf(".")-1,f=le;f>=0;--f)if(!(s[f]==null||"n?".indexOf(s[f].t)===-1)){for(E=s[f].v.indexOf(".")>-1&&f===le?s[f].v.indexOf(".")-1:s[f].v.length-1,se=s[f].v.substr(E+1);E>=0;--E)ie>=0&&(s[f].v.charAt(E)==="0"||s[f].v.charAt(E)==="#")&&(se=H.charAt(ie--)+se);s[f].v=se,s[f].t="t",oe=f}for(ie>=0&&oe<s.length&&(s[oe].v=H.substr(0,ie+1)+s[oe].v),ie=H.indexOf(".")+1,f=le;f<s.length;++f)if(!(s[f]==null||"n?(".indexOf(s[f].t)===-1&&f!==le)){for(E=s[f].v.indexOf(".")>-1&&f===le?s[f].v.indexOf(".")+1:0,se=s[f].v.substr(0,E);E<s[f].v.length;++E)ie<H.length&&(se+=H.charAt(ie++));s[f].v=se,s[f].t="t",oe=f}}}for(f=0;f<s.length;++f)s[f]!=null&&"n?".indexOf(s[f].t)>-1&&(ne=i>1&&a<0&&f>0&&s[f-1].v==="-"?-a:a,s[f].v=Ji(s[f].t,s[f].v,ne),s[f].t="t");var m="";for(f=0;f!==s.length;++f)s[f]!=null&&(m+=s[f].v);return m}var Hx=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function $x(e,a){if(a==null)return!1;var t=parseFloat(a[2]);switch(a[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function aS(e,a){var t=eS(e),i=t.length,s=t[i-1].indexOf("@");if(i<4&&s>-1&&--i,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof a!="number")return[4,t.length===4||s>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=s>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=s>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=s>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var c=a>0?t[0]:a<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[i,c];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var f=t[0].match(Hx),p=t[1].match(Hx);return $x(a,f)?[i,t[0]]:$x(a,p)?[i,t[1]]:[i,t[f!=null&&p!=null?2:1]]}return[i,c]}function Wn(e,a,t){t==null&&(t={});var i="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?i=t.dateNF:i=e;break;case"number":e==14&&t.dateNF?i=t.dateNF:i=(t.table!=null?t.table:mt)[e],i==null&&(i=t.table&&t.table[Px[e]]||mt[Px[e]]),i==null&&(i=L2[e]||"General");break}if(Ud(i,0))return Sl(a,t);a instanceof Date&&(a=qm(a,t.date1904));var s=aS(i,a);if(Ud(s[1]))return Sl(a,t);if(a===!0)a="TRUE";else if(a===!1)a="FALSE";else if(a===""||a==null)return"";return tS(s[1],a,t,s[0])}function Qi(e,a){if(typeof a!="number"){a=+a||-1;for(var t=0;t<392;++t){if(mt[t]==null){a<0&&(a=t);continue}if(mt[t]==e){a=t;break}}a<0&&(a=391)}return mt[a]=e,a}function ef(e){for(var a=0;a!=392;++a)e[a]!==void 0&&Qi(e[a],a)}function Fo(){mt=M2()}var rS={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},nv=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function nS(e){var a=typeof e=="number"?mt[e]:e;return a=a.replace(nv,"(\\d+)"),new RegExp("^"+a+"$")}function iS(e,a,t){var i=-1,s=-1,c=-1,f=-1,p=-1,g=-1;(a.match(nv)||[]).forEach(function(A,_){var w=parseInt(t[_+1],10);switch(A.toLowerCase().charAt(0)){case"y":i=w;break;case"d":c=w;break;case"h":f=w;break;case"s":g=w;break;case"m":f>=0?p=w:s=w;break}}),g>=0&&p==-1&&s>=0&&(p=s,s=-1);var h=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(c>=1?c:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var E=("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(p>=0?p:0)).slice(-2)+":"+("00"+(g>=0?g:0)).slice(-2);return f==-1&&p==-1&&g==-1?h:i==-1&&s==-1&&c==-1?E:h+"T"+E}var sS=(function(){var e={};e.version="1.2.0";function a(){for(var H=0,le=new Array(256),oe=0;oe!=256;++oe)H=oe,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,le[oe]=H;return typeof Int32Array<"u"?new Int32Array(le):le}var t=a();function i(H){var le=0,oe=0,m=0,Se=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(m=0;m!=256;++m)Se[m]=H[m];for(m=0;m!=256;++m)for(oe=H[m],le=256+m;le<4096;le+=256)oe=Se[le]=oe>>>8^H[oe&255];var ue=[];for(m=1;m!=16;++m)ue[m-1]=typeof Int32Array<"u"?Se.subarray(m*256,m*256+256):Se.slice(m*256,m*256+256);return ue}var s=i(t),c=s[0],f=s[1],p=s[2],g=s[3],h=s[4],E=s[5],A=s[6],_=s[7],w=s[8],N=s[9],k=s[10],F=s[11],z=s[12],q=s[13],B=s[14];function ie(H,le){for(var oe=le^-1,m=0,Se=H.length;m<Se;)oe=oe>>>8^t[(oe^H.charCodeAt(m++))&255];return~oe}function se(H,le){for(var oe=le^-1,m=H.length-15,Se=0;Se<m;)oe=B[H[Se++]^oe&255]^q[H[Se++]^oe>>8&255]^z[H[Se++]^oe>>16&255]^F[H[Se++]^oe>>>24]^k[H[Se++]]^N[H[Se++]]^w[H[Se++]]^_[H[Se++]]^A[H[Se++]]^E[H[Se++]]^h[H[Se++]]^g[H[Se++]]^p[H[Se++]]^f[H[Se++]]^c[H[Se++]]^t[H[Se++]];for(m+=15;Se<m;)oe=oe>>>8^t[(oe^H[Se++])&255];return~oe}function ne(H,le){for(var oe=le^-1,m=0,Se=H.length,ue=0,Pe=0;m<Se;)ue=H.charCodeAt(m++),ue<128?oe=oe>>>8^t[(oe^ue)&255]:ue<2048?(oe=oe>>>8^t[(oe^(192|ue>>6&31))&255],oe=oe>>>8^t[(oe^(128|ue&63))&255]):ue>=55296&&ue<57344?(ue=(ue&1023)+64,Pe=H.charCodeAt(m++)&1023,oe=oe>>>8^t[(oe^(240|ue>>8&7))&255],oe=oe>>>8^t[(oe^(128|ue>>2&63))&255],oe=oe>>>8^t[(oe^(128|Pe>>6&15|(ue&3)<<4))&255],oe=oe>>>8^t[(oe^(128|Pe&63))&255]):(oe=oe>>>8^t[(oe^(224|ue>>12&15))&255],oe=oe>>>8^t[(oe^(128|ue>>6&63))&255],oe=oe>>>8^t[(oe^(128|ue&63))&255]);return~oe}return e.table=t,e.bstr=ie,e.buf=se,e.str=ne,e})(),pt=(function(){var a={};a.version="1.2.1";function t(D,W){for(var P=D.split("/"),U=W.split("/"),G=0,V=0,xe=Math.min(P.length,U.length);G<xe;++G){if(V=P[G].length-U[G].length)return V;if(P[G]!=U[G])return P[G]<U[G]?-1:1}return P.length-U.length}function i(D){if(D.charAt(D.length-1)=="/")return D.slice(0,-1).indexOf("/")===-1?D:i(D.slice(0,-1));var W=D.lastIndexOf("/");return W===-1?D:D.slice(0,W+1)}function s(D){if(D.charAt(D.length-1)=="/")return s(D.slice(0,-1));var W=D.lastIndexOf("/");return W===-1?D:D.slice(W+1)}function c(D,W){typeof W=="string"&&(W=new Date(W));var P=W.getHours();P=P<<6|W.getMinutes(),P=P<<5|W.getSeconds()>>>1,D.write_shift(2,P);var U=W.getFullYear()-1980;U=U<<4|W.getMonth()+1,U=U<<5|W.getDate(),D.write_shift(2,U)}function f(D){var W=D.read_shift(2)&65535,P=D.read_shift(2)&65535,U=new Date,G=P&31;P>>>=5;var V=P&15;P>>>=4,U.setMilliseconds(0),U.setFullYear(P+1980),U.setMonth(V-1),U.setDate(G);var xe=W&31;W>>>=5;var Re=W&63;return W>>>=6,U.setHours(W),U.setMinutes(Re),U.setSeconds(xe<<1),U}function p(D){Fr(D,0);for(var W={},P=0;D.l<=D.length-4;){var U=D.read_shift(2),G=D.read_shift(2),V=D.l+G,xe={};U===21589&&(P=D.read_shift(1),P&1&&(xe.mtime=D.read_shift(4)),G>5&&(P&2&&(xe.atime=D.read_shift(4)),P&4&&(xe.ctime=D.read_shift(4))),xe.mtime&&(xe.mt=new Date(xe.mtime*1e3))),D.l=V,W[U]=xe}return W}var g;function h(){return g||(g={})}function E(D,W){if(D[0]==80&&D[1]==75)return Yt(D,W);if((D[0]|32)==109&&(D[1]|32)==105)return Xn(D,W);if(D.length<512)throw new Error("CFB file size "+D.length+" < 512");var P=3,U=512,G=0,V=0,xe=0,Re=0,Ee=0,Te=[],ge=D.slice(0,512);Fr(ge,0);var De=A(ge);switch(P=De[0],P){case 3:U=512;break;case 4:U=4096;break;case 0:if(De[1]==0)return Yt(D,W);default:throw new Error("Major Version: Expected 3 or 4 saw "+P)}U!==512&&(ge=D.slice(0,U),Fr(ge,28));var Ve=D.slice(0,U);_(ge,P);var Xe=ge.read_shift(4,"i");if(P===3&&Xe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Xe);ge.l+=4,xe=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),Re=ge.read_shift(4,"i"),G=ge.read_shift(4,"i"),Ee=ge.read_shift(4,"i"),V=ge.read_shift(4,"i");for(var Ge=-1,We=0;We<109&&(Ge=ge.read_shift(4,"i"),!(Ge<0));++We)Te[We]=Ge;var it=w(D,U);F(Ee,V,it,U,Te);var Nt=q(it,xe,Te,U);Nt[xe].name="!Directory",G>0&&Re!==Pe&&(Nt[Re].name="!MiniFAT"),Nt[Te[0]].name="!FAT",Nt.fat_addrs=Te,Nt.ssz=U;var Wt={},Vt=[],sr=[],Or=[];B(xe,Nt,it,Vt,G,Wt,sr,Re),N(sr,Or,Vt),Vt.shift();var Vr={FileIndex:sr,FullPaths:Or};return W&&W.raw&&(Vr.raw={header:Ve,sectors:it}),Vr}function A(D){if(D[D.l]==80&&D[D.l+1]==75)return[0,0];D.chk(tt,"Header Signature: "),D.l+=16;var W=D.read_shift(2,"u");return[D.read_shift(2,"u"),W]}function _(D,W){var P=9;switch(D.l+=2,P=D.read_shift(2)){case 9:if(W!=3)throw new Error("Sector Shift: Expected 9 saw "+P);break;case 12:if(W!=4)throw new Error("Sector Shift: Expected 12 saw "+P);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+P)}D.chk("0600","Mini Sector Shift: "),D.chk("000000000000","Reserved: ")}function w(D,W){for(var P=Math.ceil(D.length/W)-1,U=[],G=1;G<P;++G)U[G-1]=D.slice(G*W,(G+1)*W);return U[P-1]=D.slice(P*W),U}function N(D,W,P){for(var U=0,G=0,V=0,xe=0,Re=0,Ee=P.length,Te=[],ge=[];U<Ee;++U)Te[U]=ge[U]=U,W[U]=P[U];for(;Re<ge.length;++Re)U=ge[Re],G=D[U].L,V=D[U].R,xe=D[U].C,Te[U]===U&&(G!==-1&&Te[G]!==G&&(Te[U]=Te[G]),V!==-1&&Te[V]!==V&&(Te[U]=Te[V])),xe!==-1&&(Te[xe]=U),G!==-1&&U!=Te[U]&&(Te[G]=Te[U],ge.lastIndexOf(G)<Re&&ge.push(G)),V!==-1&&U!=Te[U]&&(Te[V]=Te[U],ge.lastIndexOf(V)<Re&&ge.push(V));for(U=1;U<Ee;++U)Te[U]===U&&(V!==-1&&Te[V]!==V?Te[U]=Te[V]:G!==-1&&Te[G]!==G&&(Te[U]=Te[G]));for(U=1;U<Ee;++U)if(D[U].type!==0){if(Re=U,Re!=Te[Re])do Re=Te[Re],W[U]=W[Re]+"/"+W[U];while(Re!==0&&Te[Re]!==-1&&Re!=Te[Re]);Te[U]=-1}for(W[0]+="/",U=1;U<Ee;++U)D[U].type!==2&&(W[U]+="/")}function k(D,W,P){for(var U=D.start,G=D.size,V=[],xe=U;P&&G>0&&xe>=0;)V.push(W.slice(xe*ue,xe*ue+ue)),G-=ue,xe=gl(P,xe*4);return V.length===0?Ne(0):br(V).slice(0,D.size)}function F(D,W,P,U,G){var V=Pe;if(D===Pe){if(W!==0)throw new Error("DIFAT chain shorter than expected")}else if(D!==-1){var xe=P[D],Re=(U>>>2)-1;if(!xe)return;for(var Ee=0;Ee<Re&&(V=gl(xe,Ee*4))!==Pe;++Ee)G.push(V);F(gl(xe,U-4),W-1,P,U,G)}}function z(D,W,P,U,G){var V=[],xe=[];G||(G=[]);var Re=U-1,Ee=0,Te=0;for(Ee=W;Ee>=0;){G[Ee]=!0,V[V.length]=Ee,xe.push(D[Ee]);var ge=P[Math.floor(Ee*4/U)];if(Te=Ee*4&Re,U<4+Te)throw new Error("FAT boundary crossed: "+Ee+" 4 "+U);if(!D[ge])break;Ee=gl(D[ge],Te)}return{nodes:V,data:tm([xe])}}function q(D,W,P,U){var G=D.length,V=[],xe=[],Re=[],Ee=[],Te=U-1,ge=0,De=0,Ve=0,Xe=0;for(ge=0;ge<G;++ge)if(Re=[],Ve=ge+W,Ve>=G&&(Ve-=G),!xe[Ve]){Ee=[];var Ge=[];for(De=Ve;De>=0;){Ge[De]=!0,xe[De]=!0,Re[Re.length]=De,Ee.push(D[De]);var We=P[Math.floor(De*4/U)];if(Xe=De*4&Te,U<4+Xe)throw new Error("FAT boundary crossed: "+De+" 4 "+U);if(!D[We]||(De=gl(D[We],Xe),Ge[De]))break}V[Ve]={nodes:Re,data:tm([Ee])}}return V}function B(D,W,P,U,G,V,xe,Re){for(var Ee=0,Te=U.length?2:0,ge=W[D].data,De=0,Ve=0,Xe;De<ge.length;De+=128){var Ge=ge.slice(De,De+128);Fr(Ge,64),Ve=Ge.read_shift(2),Xe=Zp(Ge,0,Ve-Te),U.push(Xe);var We={name:Xe,type:Ge.read_shift(1),color:Ge.read_shift(1),L:Ge.read_shift(4,"i"),R:Ge.read_shift(4,"i"),C:Ge.read_shift(4,"i"),clsid:Ge.read_shift(16),state:Ge.read_shift(4,"i"),start:0,size:0},it=Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2);it!==0&&(We.ct=ie(Ge,Ge.l-8));var Nt=Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2)+Ge.read_shift(2);Nt!==0&&(We.mt=ie(Ge,Ge.l-8)),We.start=Ge.read_shift(4,"i"),We.size=Ge.read_shift(4,"i"),We.size<0&&We.start<0&&(We.size=We.type=0,We.start=Pe,We.name=""),We.type===5?(Ee=We.start,G>0&&Ee!==Pe&&(W[Ee].name="!StreamData")):We.size>=4096?(We.storage="fat",W[We.start]===void 0&&(W[We.start]=z(P,We.start,W.fat_addrs,W.ssz)),W[We.start].name=We.name,We.content=W[We.start].data.slice(0,We.size)):(We.storage="minifat",We.size<0?We.size=0:Ee!==Pe&&We.start!==Pe&&W[Ee]&&(We.content=k(We,W[Ee].data,(W[Re]||{}).data))),We.content&&Fr(We.content,0),V[Xe]=We,xe.push(We)}}function ie(D,W){return new Date((Tn(D,W+4)/1e7*Math.pow(2,32)+Tn(D,W)/1e7-11644473600)*1e3)}function se(D,W){return h(),E(g.readFileSync(D),W)}function ne(D,W){var P=W&&W.type;switch(P||It&&Buffer.isBuffer(D)&&(P="buffer"),P||"base64"){case"file":return se(D,W);case"base64":return E(An(Cn(D)),W);case"binary":return E(An(D),W)}return E(D,W)}function H(D,W){var P=W||{},U=P.root||"Root Entry";if(D.FullPaths||(D.FullPaths=[]),D.FileIndex||(D.FileIndex=[]),D.FullPaths.length!==D.FileIndex.length)throw new Error("inconsistent CFB structure");D.FullPaths.length===0&&(D.FullPaths[0]=U+"/",D.FileIndex[0]={name:U,type:5}),P.CLSID&&(D.FileIndex[0].clsid=P.CLSID),le(D)}function le(D){var W="Sh33tJ5";if(!pt.find(D,"/"+W)){var P=Ne(4);P[0]=55,P[1]=P[3]=50,P[2]=54,D.FileIndex.push({name:W,type:2,content:P,size:4,L:69,R:69,C:69}),D.FullPaths.push(D.FullPaths[0]+W),oe(D)}}function oe(D,W){H(D);for(var P=!1,U=!1,G=D.FullPaths.length-1;G>=0;--G){var V=D.FileIndex[G];switch(V.type){case 0:U?P=!0:(D.FileIndex.pop(),D.FullPaths.pop());break;case 1:case 2:case 5:U=!0,isNaN(V.R*V.L*V.C)&&(P=!0),V.R>-1&&V.L>-1&&V.R==V.L&&(P=!0);break;default:P=!0;break}}if(!(!P&&!W)){var xe=new Date(1987,1,19),Re=0,Ee=Object.create?Object.create(null):{},Te=[];for(G=0;G<D.FullPaths.length;++G)Ee[D.FullPaths[G]]=!0,D.FileIndex[G].type!==0&&Te.push([D.FullPaths[G],D.FileIndex[G]]);for(G=0;G<Te.length;++G){var ge=i(Te[G][0]);U=Ee[ge],U||(Te.push([ge,{name:s(ge).replace("/",""),type:1,clsid:de,ct:xe,mt:xe,content:null}]),Ee[ge]=!0)}for(Te.sort(function(Xe,Ge){return t(Xe[0],Ge[0])}),D.FullPaths=[],D.FileIndex=[],G=0;G<Te.length;++G)D.FullPaths[G]=Te[G][0],D.FileIndex[G]=Te[G][1];for(G=0;G<Te.length;++G){var De=D.FileIndex[G],Ve=D.FullPaths[G];if(De.name=s(Ve).replace("/",""),De.L=De.R=De.C=-(De.color=1),De.size=De.content?De.content.length:0,De.start=0,De.clsid=De.clsid||de,G===0)De.C=Te.length>1?1:-1,De.size=0,De.type=5;else if(Ve.slice(-1)=="/"){for(Re=G+1;Re<Te.length&&i(D.FullPaths[Re])!=Ve;++Re);for(De.C=Re>=Te.length?-1:Re,Re=G+1;Re<Te.length&&i(D.FullPaths[Re])!=i(Ve);++Re);De.R=Re>=Te.length?-1:Re,De.type=1}else i(D.FullPaths[G+1]||"")==i(Ve)&&(De.R=G+1),De.type=2}}}function m(D,W){var P=W||{};if(P.fileType=="mad")return p0(D,P);if(oe(D),P.fileType==="zip")return Ha(D,P);var U=(function(Xe){for(var Ge=0,We=0,it=0;it<Xe.FileIndex.length;++it){var Nt=Xe.FileIndex[it];if(Nt.content){var Wt=Nt.content.length;Wt>0&&(Wt<4096?Ge+=Wt+63>>6:We+=Wt+511>>9)}}for(var Vt=Xe.FullPaths.length+3>>2,sr=Ge+7>>3,Or=Ge+127>>7,Vr=sr+We+Vt+Or,$a=Vr+127>>7,Nn=$a<=109?0:Math.ceil(($a-109)/127);Vr+$a+Nn+127>>7>$a;)Nn=++$a<=109?0:Math.ceil(($a-109)/127);var ya=[1,Nn,$a,Or,Vt,We,Ge,0];return Xe.FileIndex[0].size=Ge<<6,ya[7]=(Xe.FileIndex[0].start=ya[0]+ya[1]+ya[2]+ya[3]+ya[4]+ya[5])+(ya[6]+7>>3),ya})(D),G=Ne(U[7]<<9),V=0,xe=0;{for(V=0;V<8;++V)G.write_shift(1,ke[V]);for(V=0;V<8;++V)G.write_shift(2,0);for(G.write_shift(2,62),G.write_shift(2,3),G.write_shift(2,65534),G.write_shift(2,9),G.write_shift(2,6),V=0;V<3;++V)G.write_shift(2,0);for(G.write_shift(4,0),G.write_shift(4,U[2]),G.write_shift(4,U[0]+U[1]+U[2]+U[3]-1),G.write_shift(4,0),G.write_shift(4,4096),G.write_shift(4,U[3]?U[0]+U[1]+U[2]-1:Pe),G.write_shift(4,U[3]),G.write_shift(-4,U[1]?U[0]-1:Pe),G.write_shift(4,U[1]),V=0;V<109;++V)G.write_shift(-4,V<U[2]?U[1]+V:-1)}if(U[1])for(xe=0;xe<U[1];++xe){for(;V<236+xe*127;++V)G.write_shift(-4,V<U[2]?U[1]+V:-1);G.write_shift(-4,xe===U[1]-1?Pe:xe+1)}var Re=function(Xe){for(xe+=Xe;V<xe-1;++V)G.write_shift(-4,V+1);Xe&&(++V,G.write_shift(-4,Pe))};for(xe=V=0,xe+=U[1];V<xe;++V)G.write_shift(-4,_e.DIFSECT);for(xe+=U[2];V<xe;++V)G.write_shift(-4,_e.FATSECT);Re(U[3]),Re(U[4]);for(var Ee=0,Te=0,ge=D.FileIndex[0];Ee<D.FileIndex.length;++Ee)ge=D.FileIndex[Ee],ge.content&&(Te=ge.content.length,!(Te<4096)&&(ge.start=xe,Re(Te+511>>9)));for(Re(U[6]+7>>3);G.l&511;)G.write_shift(-4,_e.ENDOFCHAIN);for(xe=V=0,Ee=0;Ee<D.FileIndex.length;++Ee)ge=D.FileIndex[Ee],ge.content&&(Te=ge.content.length,!(!Te||Te>=4096)&&(ge.start=xe,Re(Te+63>>6)));for(;G.l&511;)G.write_shift(-4,_e.ENDOFCHAIN);for(V=0;V<U[4]<<2;++V){var De=D.FullPaths[V];if(!De||De.length===0){for(Ee=0;Ee<17;++Ee)G.write_shift(4,0);for(Ee=0;Ee<3;++Ee)G.write_shift(4,-1);for(Ee=0;Ee<12;++Ee)G.write_shift(4,0);continue}ge=D.FileIndex[V],V===0&&(ge.start=ge.size?ge.start-1:Pe);var Ve=V===0&&P.root||ge.name;if(Te=2*(Ve.length+1),G.write_shift(64,Ve,"utf16le"),G.write_shift(2,Te),G.write_shift(1,ge.type),G.write_shift(1,ge.color),G.write_shift(-4,ge.L),G.write_shift(-4,ge.R),G.write_shift(-4,ge.C),ge.clsid)G.write_shift(16,ge.clsid,"hex");else for(Ee=0;Ee<4;++Ee)G.write_shift(4,0);G.write_shift(4,ge.state||0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,ge.start),G.write_shift(4,ge.size),G.write_shift(4,0)}for(V=1;V<D.FileIndex.length;++V)if(ge=D.FileIndex[V],ge.size>=4096)if(G.l=ge.start+1<<9,It&&Buffer.isBuffer(ge.content))ge.content.copy(G,G.l,0,ge.size),G.l+=ge.size+511&-512;else{for(Ee=0;Ee<ge.size;++Ee)G.write_shift(1,ge.content[Ee]);for(;Ee&511;++Ee)G.write_shift(1,0)}for(V=1;V<D.FileIndex.length;++V)if(ge=D.FileIndex[V],ge.size>0&&ge.size<4096)if(It&&Buffer.isBuffer(ge.content))ge.content.copy(G,G.l,0,ge.size),G.l+=ge.size+63&-64;else{for(Ee=0;Ee<ge.size;++Ee)G.write_shift(1,ge.content[Ee]);for(;Ee&63;++Ee)G.write_shift(1,0)}if(It)G.l=G.length;else for(;G.l<G.length;)G.write_shift(1,0);return G}function Se(D,W){var P=D.FullPaths.map(function(Ee){return Ee.toUpperCase()}),U=P.map(function(Ee){var Te=Ee.split("/");return Te[Te.length-(Ee.slice(-1)=="/"?2:1)]}),G=!1;W.charCodeAt(0)===47?(G=!0,W=P[0].slice(0,-1)+W):G=W.indexOf("/")!==-1;var V=W.toUpperCase(),xe=G===!0?P.indexOf(V):U.indexOf(V);if(xe!==-1)return D.FileIndex[xe];var Re=!V.match(Ic);for(V=V.replace(Qr,""),Re&&(V=V.replace(Ic,"!")),xe=0;xe<P.length;++xe)if((Re?P[xe].replace(Ic,"!"):P[xe]).replace(Qr,"")==V||(Re?U[xe].replace(Ic,"!"):U[xe]).replace(Qr,"")==V)return D.FileIndex[xe];return null}var ue=64,Pe=-2,tt="d0cf11e0a1b11ae1",ke=[208,207,17,224,161,177,26,225],de="00000000000000000000000000000000",_e={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Pe,FREESECT:-1,HEADER_SIGNATURE:tt,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:de,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ze(D,W,P){h();var U=m(D,P);g.writeFileSync(W,U)}function fe(D){for(var W=new Array(D.length),P=0;P<D.length;++P)W[P]=String.fromCharCode(D[P]);return W.join("")}function Je(D,W){var P=m(D,W);switch(W&&W.type||"buffer"){case"file":return h(),g.writeFileSync(W.filename,P),P;case"binary":return typeof P=="string"?P:fe(P);case"base64":return Wc(typeof P=="string"?P:fe(P));case"buffer":if(It)return Buffer.isBuffer(P)?P:ts(P);case"array":return typeof P=="string"?An(P):P}return P}var ee;function O(D){try{var W=D.InflateRaw,P=new W;if(P._processChunk(new Uint8Array([3,0]),P._finishFlushFlag),P.bytesRead)ee=D;else throw new Error("zlib does not expose bytesRead")}catch(U){console.error("cannot use native zlib: "+(U.message||U))}}function L(D,W){if(!ee)return kn(D,W);var P=ee.InflateRaw,U=new P,G=U._processChunk(D.slice(D.l),U._finishFlushFlag);return D.l+=U.bytesRead,G}function K(D){return ee?ee.deflateRawSync(D):ht(D)}var te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],he=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Oe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ue(D){var W=(D<<1|D<<11)&139536|(D<<5|D<<15)&558144;return(W>>16|W>>8|W)&255}for(var Ie=typeof Uint8Array<"u",He=Ie?new Uint8Array(256):[],gt=0;gt<256;++gt)He[gt]=Ue(gt);function Z(D,W){var P=He[D&255];return W<=8?P>>>8-W:(P=P<<8|He[D>>8&255],W<=16?P>>>16-W:(P=P<<8|He[D>>16&255],P>>>24-W))}function aa(D,W){var P=W&7,U=W>>>3;return(D[U]|(P<=6?0:D[U+1]<<8))>>>P&3}function St(D,W){var P=W&7,U=W>>>3;return(D[U]|(P<=5?0:D[U+1]<<8))>>>P&7}function Mt(D,W){var P=W&7,U=W>>>3;return(D[U]|(P<=4?0:D[U+1]<<8))>>>P&15}function yt(D,W){var P=W&7,U=W>>>3;return(D[U]|(P<=3?0:D[U+1]<<8))>>>P&31}function et(D,W){var P=W&7,U=W>>>3;return(D[U]|(P<=1?0:D[U+1]<<8))>>>P&127}function ra(D,W,P){var U=W&7,G=W>>>3,V=(1<<P)-1,xe=D[G]>>>U;return P<8-U||(xe|=D[G+1]<<8-U,P<16-U)||(xe|=D[G+2]<<16-U,P<24-U)||(xe|=D[G+3]<<24-U),xe&V}function Ba(D,W,P){var U=W&7,G=W>>>3;return U<=5?D[G]|=(P&7)<<U:(D[G]|=P<<U&255,D[G+1]=(P&7)>>8-U),W+3}function Qa(D,W,P){var U=W&7,G=W>>>3;return P=(P&1)<<U,D[G]|=P,W+1}function Rt(D,W,P){var U=W&7,G=W>>>3;return P<<=U,D[G]|=P&255,P>>>=8,D[G+1]=P,W+8}function Yr(D,W,P){var U=W&7,G=W>>>3;return P<<=U,D[G]|=P&255,P>>>=8,D[G+1]=P&255,D[G+2]=P>>>8,W+16}function Zr(D,W){var P=D.length,U=2*P>W?2*P:W+5,G=0;if(P>=W)return D;if(It){var V=Bx(U);if(D.copy)D.copy(V);else for(;G<D.length;++G)V[G]=D[G];return V}else if(Ie){var xe=new Uint8Array(U);if(xe.set)xe.set(D);else for(;G<P;++G)xe[G]=D[G];return xe}return D.length=U,D}function ia(D){for(var W=new Array(D),P=0;P<D;++P)W[P]=0;return W}function Dr(D,W,P){var U=1,G=0,V=0,xe=0,Re=0,Ee=D.length,Te=Ie?new Uint16Array(32):ia(32);for(V=0;V<32;++V)Te[V]=0;for(V=Ee;V<P;++V)D[V]=0;Ee=D.length;var ge=Ie?new Uint16Array(Ee):ia(Ee);for(V=0;V<Ee;++V)Te[G=D[V]]++,U<G&&(U=G),ge[V]=0;for(Te[0]=0,V=1;V<=U;++V)Te[V+16]=Re=Re+Te[V-1]<<1;for(V=0;V<Ee;++V)Re=D[V],Re!=0&&(ge[V]=Te[Re+16]++);var De=0;for(V=0;V<Ee;++V)if(De=D[V],De!=0)for(Re=Z(ge[V],U)>>U-De,xe=(1<<U+4-De)-1;xe>=0;--xe)W[Re|xe<<De]=De&15|V<<4;return U}var sa=Ie?new Uint16Array(512):ia(512),ki=Ie?new Uint16Array(32):ia(32);if(!Ie){for(var Lt=0;Lt<512;++Lt)sa[Lt]=0;for(Lt=0;Lt<32;++Lt)ki[Lt]=0}(function(){for(var D=[],W=0;W<32;W++)D.push(5);Dr(D,ki,32);var P=[];for(W=0;W<=143;W++)P.push(8);for(;W<=255;W++)P.push(9);for(;W<=279;W++)P.push(7);for(;W<=287;W++)P.push(8);Dr(P,sa,288)})();var Et=(function(){for(var W=Ie?new Uint8Array(32768):[],P=0,U=0;P<Oe.length-1;++P)for(;U<Oe[P+1];++U)W[U]=P;for(;U<32768;++U)W[U]=29;var G=Ie?new Uint8Array(259):[];for(P=0,U=0;P<he.length-1;++P)for(;U<he[P+1];++U)G[U]=P;function V(Re,Ee){for(var Te=0;Te<Re.length;){var ge=Math.min(65535,Re.length-Te),De=Te+ge==Re.length;for(Ee.write_shift(1,+De),Ee.write_shift(2,ge),Ee.write_shift(2,~ge&65535);ge-- >0;)Ee[Ee.l++]=Re[Te++]}return Ee.l}function xe(Re,Ee){for(var Te=0,ge=0,De=Ie?new Uint16Array(32768):[];ge<Re.length;){var Ve=Math.min(65535,Re.length-ge);if(Ve<10){for(Te=Ba(Ee,Te,+(ge+Ve==Re.length)),Te&7&&(Te+=8-(Te&7)),Ee.l=Te/8|0,Ee.write_shift(2,Ve),Ee.write_shift(2,~Ve&65535);Ve-- >0;)Ee[Ee.l++]=Re[ge++];Te=Ee.l*8;continue}Te=Ba(Ee,Te,+(ge+Ve==Re.length)+2);for(var Xe=0;Ve-- >0;){var Ge=Re[ge];Xe=(Xe<<5^Ge)&32767;var We=-1,it=0;if((We=De[Xe])&&(We|=ge&-32768,We>ge&&(We-=32768),We<ge))for(;Re[We+it]==Re[ge+it]&&it<250;)++it;if(it>2){Ge=G[it],Ge<=22?Te=Rt(Ee,Te,He[Ge+1]>>1)-1:(Rt(Ee,Te,3),Te+=5,Rt(Ee,Te,He[Ge-23]>>5),Te+=3);var Nt=Ge<8?0:Ge-4>>2;Nt>0&&(Yr(Ee,Te,it-he[Ge]),Te+=Nt),Ge=W[ge-We],Te=Rt(Ee,Te,He[Ge]>>3),Te-=3;var Wt=Ge<4?0:Ge-2>>1;Wt>0&&(Yr(Ee,Te,ge-We-Oe[Ge]),Te+=Wt);for(var Vt=0;Vt<it;++Vt)De[Xe]=ge&32767,Xe=(Xe<<5^Re[ge])&32767,++ge;Ve-=it-1}else Ge<=143?Ge=Ge+48:Te=Qa(Ee,Te,1),Te=Rt(Ee,Te,He[Ge]),De[Xe]=ge&32767,++ge}Te=Rt(Ee,Te,0)-1}return Ee.l=(Te+7)/8|0,Ee.l}return function(Ee,Te){return Ee.length<8?V(Ee,Te):xe(Ee,Te)}})();function ht(D){var W=Ne(50+Math.floor(D.length*1.1)),P=Et(D,W);return W.slice(0,P)}var Ea=Ie?new Uint16Array(32768):ia(32768),hr=Ie?new Uint16Array(32768):ia(32768),na=Ie?new Uint16Array(128):ia(128),Ta=1,pn=1;function Ut(D,W){var P=yt(D,W)+257;W+=5;var U=yt(D,W)+1;W+=5;var G=Mt(D,W)+4;W+=4;for(var V=0,xe=Ie?new Uint8Array(19):ia(19),Re=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ee=1,Te=Ie?new Uint8Array(8):ia(8),ge=Ie?new Uint8Array(8):ia(8),De=xe.length,Ve=0;Ve<G;++Ve)xe[te[Ve]]=V=St(D,W),Ee<V&&(Ee=V),Te[V]++,W+=3;var Xe=0;for(Te[0]=0,Ve=1;Ve<=Ee;++Ve)ge[Ve]=Xe=Xe+Te[Ve-1]<<1;for(Ve=0;Ve<De;++Ve)(Xe=xe[Ve])!=0&&(Re[Ve]=ge[Xe]++);var Ge=0;for(Ve=0;Ve<De;++Ve)if(Ge=xe[Ve],Ge!=0){Xe=He[Re[Ve]]>>8-Ge;for(var We=(1<<7-Ge)-1;We>=0;--We)na[Xe|We<<Ge]=Ge&7|Ve<<3}var it=[];for(Ee=1;it.length<P+U;)switch(Xe=na[et(D,W)],W+=Xe&7,Xe>>>=3){case 16:for(V=3+aa(D,W),W+=2,Xe=it[it.length-1];V-- >0;)it.push(Xe);break;case 17:for(V=3+St(D,W),W+=3;V-- >0;)it.push(0);break;case 18:for(V=11+et(D,W),W+=7;V-- >0;)it.push(0);break;default:it.push(Xe),Ee<Xe&&(Ee=Xe);break}var Nt=it.slice(0,P),Wt=it.slice(P);for(Ve=P;Ve<286;++Ve)Nt[Ve]=0;for(Ve=U;Ve<30;++Ve)Wt[Ve]=0;return Ta=Dr(Nt,Ea,286),pn=Dr(Wt,hr,30),W}function ns(D,W){if(D[0]==3&&!(D[1]&3))return[Ls(W),2];for(var P=0,U=0,G=Bx(W||1<<18),V=0,xe=G.length>>>0,Re=0,Ee=0;(U&1)==0;){if(U=St(D,P),P+=3,U>>>1)U>>1==1?(Re=9,Ee=5):(P=Ut(D,P),Re=Ta,Ee=pn);else{P&7&&(P+=8-(P&7));var Te=D[P>>>3]|D[(P>>>3)+1]<<8;if(P+=32,Te>0)for(!W&&xe<V+Te&&(G=Zr(G,V+Te),xe=G.length);Te-- >0;)G[V++]=D[P>>>3],P+=8;continue}for(;;){!W&&xe<V+32767&&(G=Zr(G,V+32767),xe=G.length);var ge=ra(D,P,Re),De=U>>>1==1?sa[ge]:Ea[ge];if(P+=De&15,De>>>=4,(De>>>8&255)===0)G[V++]=De;else{if(De==256)break;De-=257;var Ve=De<8?0:De-4>>2;Ve>5&&(Ve=0);var Xe=V+he[De];Ve>0&&(Xe+=ra(D,P,Ve),P+=Ve),ge=ra(D,P,Ee),De=U>>>1==1?ki[ge]:hr[ge],P+=De&15,De>>>=4;var Ge=De<4?0:De-2>>1,We=Oe[De];for(Ge>0&&(We+=ra(D,P,Ge),P+=Ge),!W&&xe<Xe&&(G=Zr(G,Xe+100),xe=G.length);V<Xe;)G[V]=G[V-We],++V}}}return W?[G,P+7>>>3]:[G.slice(0,V),P+7>>>3]}function kn(D,W){var P=D.slice(D.l||0),U=ns(P,W);return D.l+=U[1],U[0]}function is(D,W){if(D)typeof console<"u"&&console.error(W);else throw new Error(W)}function Yt(D,W){var P=D;Fr(P,0);var U=[],G=[],V={FileIndex:U,FullPaths:G};H(V,{root:W.root});for(var xe=P.length-4;(P[xe]!=80||P[xe+1]!=75||P[xe+2]!=5||P[xe+3]!=6)&&xe>=0;)--xe;P.l=xe+4,P.l+=4;var Re=P.read_shift(2);P.l+=6;var Ee=P.read_shift(4);for(P.l=Ee,xe=0;xe<Re;++xe){P.l+=20;var Te=P.read_shift(4),ge=P.read_shift(4),De=P.read_shift(2),Ve=P.read_shift(2),Xe=P.read_shift(2);P.l+=8;var Ge=P.read_shift(4),We=p(P.slice(P.l+De,P.l+De+Ve));P.l+=De+Ve+Xe;var it=P.l;P.l=Ge+4,wi(P,Te,ge,V,We),P.l=it}return V}function wi(D,W,P,U,G){D.l+=2;var V=D.read_shift(2),xe=D.read_shift(2),Re=f(D);if(V&8257)throw new Error("Unsupported ZIP encryption");for(var Ee=D.read_shift(4),Te=D.read_shift(4),ge=D.read_shift(4),De=D.read_shift(2),Ve=D.read_shift(2),Xe="",Ge=0;Ge<De;++Ge)Xe+=String.fromCharCode(D[D.l++]);if(Ve){var We=p(D.slice(D.l,D.l+Ve));(We[21589]||{}).mt&&(Re=We[21589].mt),((G||{})[21589]||{}).mt&&(Re=G[21589].mt)}D.l+=Ve;var it=D.slice(D.l,D.l+Te);switch(xe){case 8:it=L(D,ge);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+xe)}var Nt=!1;V&8&&(Ee=D.read_shift(4),Ee==134695760&&(Ee=D.read_shift(4),Nt=!0),Te=D.read_shift(4),ge=D.read_shift(4)),Te!=W&&is(Nt,"Bad compressed size: "+W+" != "+Te),ge!=P&&is(Nt,"Bad uncompressed size: "+P+" != "+ge),gr(U,Xe,it,{unsafe:!0,mt:Re})}function Ha(D,W){var P=W||{},U=[],G=[],V=Ne(1),xe=P.compression?8:0,Re=0,Ee=0,Te=0,ge=0,De=0,Ve=D.FullPaths[0],Xe=Ve,Ge=D.FileIndex[0],We=[],it=0;for(Ee=1;Ee<D.FullPaths.length;++Ee)if(Xe=D.FullPaths[Ee].slice(Ve.length),Ge=D.FileIndex[Ee],!(!Ge.size||!Ge.content||Xe=="Sh33tJ5")){var Nt=ge,Wt=Ne(Xe.length);for(Te=0;Te<Xe.length;++Te)Wt.write_shift(1,Xe.charCodeAt(Te)&127);Wt=Wt.slice(0,Wt.l),We[De]=sS.buf(Ge.content,0);var Vt=Ge.content;xe==8&&(Vt=K(Vt)),V=Ne(30),V.write_shift(4,67324752),V.write_shift(2,20),V.write_shift(2,Re),V.write_shift(2,xe),Ge.mt?c(V,Ge.mt):V.write_shift(4,0),V.write_shift(-4,We[De]),V.write_shift(4,Vt.length),V.write_shift(4,Ge.content.length),V.write_shift(2,Wt.length),V.write_shift(2,0),ge+=V.length,U.push(V),ge+=Wt.length,U.push(Wt),ge+=Vt.length,U.push(Vt),V=Ne(46),V.write_shift(4,33639248),V.write_shift(2,0),V.write_shift(2,20),V.write_shift(2,Re),V.write_shift(2,xe),V.write_shift(4,0),V.write_shift(-4,We[De]),V.write_shift(4,Vt.length),V.write_shift(4,Ge.content.length),V.write_shift(2,Wt.length),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(4,0),V.write_shift(4,Nt),it+=V.l,G.push(V),it+=Wt.length,G.push(Wt),++De}return V=Ne(22),V.write_shift(4,101010256),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,De),V.write_shift(2,De),V.write_shift(4,it),V.write_shift(4,ge),V.write_shift(2,0),br([br(U),br(G),V])}var Wr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function wn(D,W){if(D.ctype)return D.ctype;var P=D.name||"",U=P.match(/\.([^\.]+)$/);return U&&Wr[U[1]]||W&&(U=(P=W).match(/[\.\\]([^\.\\])+$/),U&&Wr[U[1]])?Wr[U[1]]:"application/octet-stream"}function Er(D){for(var W=Wc(D),P=[],U=0;U<W.length;U+=76)P.push(W.slice(U,U+76));return P.join(`\r
`)+`\r
`}function ci(D){var W=D.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Te){var ge=Te.charCodeAt(0).toString(16).toUpperCase();return"="+(ge.length==1?"0"+ge:ge)});W=W.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),W.charAt(0)==`
`&&(W="=0D"+W.slice(1)),W=W.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var P=[],U=W.split(`\r
`),G=0;G<U.length;++G){var V=U[G];if(V.length==0){P.push("");continue}for(var xe=0;xe<V.length;){var Re=76,Ee=V.slice(xe,xe+Re);Ee.charAt(Re-1)=="="?Re--:Ee.charAt(Re-2)=="="?Re-=2:Ee.charAt(Re-3)=="="&&(Re-=3),Ee=V.slice(xe,xe+Re),xe+=Re,xe<V.length&&(Ee+="="),P.push(Ee)}}return P.join(`\r
`)}function Ys(D){for(var W=[],P=0;P<D.length;++P){for(var U=D[P];P<=D.length&&U.charAt(U.length-1)=="=";)U=U.slice(0,U.length-1)+D[++P];W.push(U)}for(var G=0;G<W.length;++G)W[G]=W[G].replace(/[=][0-9A-Fa-f]{2}/g,function(V){return String.fromCharCode(parseInt(V.slice(1),16))});return An(W.join(`\r
`))}function Rn(D,W,P){for(var U="",G="",V="",xe,Re=0;Re<10;++Re){var Ee=W[Re];if(!Ee||Ee.match(/^\s*$/))break;var Te=Ee.match(/^(.*?):\s*([^\s].*)$/);if(Te)switch(Te[1].toLowerCase()){case"content-location":U=Te[2].trim();break;case"content-type":V=Te[2].trim();break;case"content-transfer-encoding":G=Te[2].trim();break}}switch(++Re,G.toLowerCase()){case"base64":xe=An(Cn(W.slice(Re).join("")));break;case"quoted-printable":xe=Ys(W.slice(Re));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+G)}var ge=gr(D,U.slice(P.length),xe,{unsafe:!0});V&&(ge.ctype=V)}function Xn(D,W){if(fe(D.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var P=W&&W.root||"",U=(It&&Buffer.isBuffer(D)?D.toString("binary"):fe(D)).split(`\r
`),G=0,V="";for(G=0;G<U.length;++G)if(V=U[G],!!/^Content-Location:/i.test(V)&&(V=V.slice(V.indexOf("file")),P||(P=V.slice(0,V.lastIndexOf("/")+1)),V.slice(0,P.length)!=P))for(;P.length>0&&(P=P.slice(0,P.length-1),P=P.slice(0,P.lastIndexOf("/")+1),V.slice(0,P.length)!=P););var xe=(U[1]||"").match(/boundary="(.*?)"/);if(!xe)throw new Error("MAD cannot find boundary");var Re="--"+(xe[1]||""),Ee=[],Te=[],ge={FileIndex:Ee,FullPaths:Te};H(ge);var De,Ve=0;for(G=0;G<U.length;++G){var Xe=U[G];Xe!==Re&&Xe!==Re+"--"||(Ve++&&Rn(ge,U.slice(De,G),P),De=G)}return ge}function p0(D,W){var P=W||{},U=P.boundary||"SheetJS";U="------="+U;for(var G=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+U.slice(2)+'"',"","",""],V=D.FullPaths[0],xe=V,Re=D.FileIndex[0],Ee=1;Ee<D.FullPaths.length;++Ee)if(xe=D.FullPaths[Ee].slice(V.length),Re=D.FileIndex[Ee],!(!Re.size||!Re.content||xe=="Sh33tJ5")){xe=xe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(it){return"_x"+it.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(it){return"_u"+it.charCodeAt(0).toString(16)+"_"});for(var Te=Re.content,ge=It&&Buffer.isBuffer(Te)?Te.toString("binary"):fe(Te),De=0,Ve=Math.min(1024,ge.length),Xe=0,Ge=0;Ge<=Ve;++Ge)(Xe=ge.charCodeAt(Ge))>=32&&Xe<128&&++De;var We=De>=Ve*4/5;G.push(U),G.push("Content-Location: "+(P.root||"file:///C:/SheetJS/")+xe),G.push("Content-Transfer-Encoding: "+(We?"quoted-printable":"base64")),G.push("Content-Type: "+wn(Re,xe)),G.push(""),G.push(We?ci(ge):Er(ge))}return G.push(U+`--\r
`),G.join(`\r
`)}function Dl(D){var W={};return H(W,D),W}function gr(D,W,P,U){var G=U&&U.unsafe;G||H(D);var V=!G&&pt.find(D,W);if(!V){var xe=D.FullPaths[0];W.slice(0,xe.length)==xe?xe=W:(xe.slice(-1)!="/"&&(xe+="/"),xe=(xe+W).replace("//","/")),V={name:s(W),type:2},D.FileIndex.push(V),D.FullPaths.push(xe),G||pt.utils.cfb_gc(D)}return V.content=P,V.size=P?P.length:0,U&&(U.CLSID&&(V.clsid=U.CLSID),U.mt&&(V.mt=U.mt),U.ct&&(V.ct=U.ct)),V}function Ri(D,W){H(D);var P=pt.find(D,W);if(P){for(var U=0;U<D.FileIndex.length;++U)if(D.FileIndex[U]==P)return D.FileIndex.splice(U,1),D.FullPaths.splice(U,1),!0}return!1}function Ol(D,W,P){H(D);var U=pt.find(D,W);if(U){for(var G=0;G<D.FileIndex.length;++G)if(D.FileIndex[G]==U)return D.FileIndex[G].name=s(P),D.FullPaths[G]=P,!0}return!1}function Il(D){oe(D,!0)}return a.find=Se,a.read=ne,a.parse=E,a.write=Je,a.writeFile=Ze,a.utils={cfb_new:Dl,cfb_add:gr,cfb_del:Ri,cfb_mov:Ol,cfb_gc:Il,ReadShift:Mc,CheckField:Cv,prep_blob:Fr,bconcat:br,use_zlib:O,_deflateRaw:ht,_inflateRaw:kn,consts:_e},a})();function lS(e){return typeof e=="string"?Zd(e):Array.isArray(e)?D2(e):e}function i0(e,a,t){if(typeof Deno<"u"){if(t&&typeof a=="string")switch(t){case"utf8":a=new TextEncoder(t).encode(a);break;case"binary":a=Zd(a);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,a)}var i=t=="utf8"?Ai(a):a;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,e);if(typeof Blob<"u"){var s=new Blob([lS(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var c=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),chrome.downloads.download({url:c,filename:e,saveAs:!0});var f=document.createElement("a");if(f.download!=null)return f.download=e,f.href=c,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),c}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var p=File(e);return p.open("w"),p.encoding="binary",Array.isArray(a)&&(a=Hs(a)),p.write(a),p.close(),a}catch(g){if(!g.message||!g.message.match(/onstruct/))throw g}throw new Error("cannot save file "+e)}function oS(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(e);a.open("r"),a.encoding="binary";var t=a.read();return a.close(),t}catch(i){if(!i.message||!i.message.match(/onstruct/))throw i}throw new Error("Cannot access file "+e)}function Ua(e){for(var a=Object.keys(e),t=[],i=0;i<a.length;++i)Object.prototype.hasOwnProperty.call(e,a[i])&&t.push(a[i]);return t}function Gx(e,a){for(var t=[],i=Ua(e),s=0;s!==i.length;++s)t[e[i[s]][a]]==null&&(t[e[i[s]][a]]=i[s]);return t}function tf(e){for(var a=[],t=Ua(e),i=0;i!==t.length;++i)a[e[t[i]]]=t[i];return a}function af(e){for(var a=[],t=Ua(e),i=0;i!==t.length;++i)a[e[t[i]]]=parseInt(t[i],10);return a}function cS(e){for(var a=[],t=Ua(e),i=0;i!==t.length;++i)a[e[t[i]]]==null&&(a[e[t[i]]]=[]),a[e[t[i]]].push(t[i]);return a}var $d=new Date(1899,11,30,0,0,0);function pr(e,a){var t=e.getTime(),i=$d.getTime()+(e.getTimezoneOffset()-$d.getTimezoneOffset())*6e4;return(t-i)/(1440*60*1e3)}var iv=new Date,dS=$d.getTime()+(iv.getTimezoneOffset()-$d.getTimezoneOffset())*6e4,Yx=iv.getTimezoneOffset();function rf(e){var a=new Date;return a.setTime(e*24*60*60*1e3+dS),a.getTimezoneOffset()!==Yx&&a.setTime(a.getTime()+(a.getTimezoneOffset()-Yx)*6e4),a}function fS(e){var a=0,t=0,i=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var c=1;c!=s.length;++c)if(s[c]){switch(t=1,c>3&&(i=!0),s[c].slice(s[c].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[c].slice(s[c].length-1));case"D":t*=24;case"H":t*=60;case"M":if(i)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}a+=t*parseInt(s[c],10)}return a}var Wx=new Date("2017-02-19T19:06:09.000Z"),sv=isNaN(Wx.getFullYear())?new Date("2/19/17"):Wx,uS=sv.getFullYear()==2017;function ka(e,a){var t=new Date(e);if(uS)return a>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):a<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(sv.getFullYear()==1917&&!isNaN(t.getFullYear())){var i=t.getFullYear();return e.indexOf(""+i)>-1||t.setFullYear(t.getFullYear()+100),t}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],c=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(c=new Date(c.getTime()-c.getTimezoneOffset()*60*1e3)),c}function El(e,a){if(It&&Buffer.isBuffer(e)){if(a){if(e[0]==255&&e[1]==254)return Ai(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ai(Vm(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(a){if(e[0]==255&&e[1]==254)return Ai(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ai(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(c){return t[c]||c})}catch{}for(var i=[],s=0;s!=e.length;++s)i.push(String.fromCharCode(e[s]));return i.join("")}function wa(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var a={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(a[t]=wa(e[t]));return a}function Pa(e,a){for(var t="";t.length<a;)t+=e;return t}function li(e){var a=Number(e);if(!isNaN(a))return isFinite(a)?a:NaN;if(!/\d/.test(e))return a;var t=1,i=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(a=Number(i))||(i=i.replace(/[(](.*)[)]/,function(s,c){return t=-t,c}),!isNaN(a=Number(i)))?a/t:a}var pS=["january","february","march","april","may","june","july","august","september","october","november","december"];function ko(e){var a=new Date(e),t=new Date(NaN),i=a.getYear(),s=a.getMonth(),c=a.getDate();if(isNaN(c))return t;var f=e.toLowerCase();if(f.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(f=f.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),f.length>3&&pS.indexOf(f)==-1)return t}else if(f.match(/[a-z]/))return t;return i<0||i>8099?t:(s>0||c>1)&&i!=101?a:e.match(/[^-0-9:,\/\\]/)?t:a}var hS=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,i,s){if(e||typeof i=="string")return t.split(i);for(var c=t.split(i),f=[c[0]],p=1;p<c.length;++p)f.push(s),f.push(c[p]);return f}})();function lv(e){return e?e.content&&e.type?El(e.content,!0):e.data?Oc(e.data):e.asNodeBuffer&&It?Oc(e.asNodeBuffer().toString("binary")):e.asBinary?Oc(e.asBinary()):e._data&&e._data.getContent?Oc(El(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function ov(e){if(!e)return null;if(e.data)return Ox(e.data);if(e.asNodeBuffer&&It)return e.asNodeBuffer();if(e._data&&e._data.getContent){var a=e._data.getContent();return typeof a=="string"?Ox(a):Array.prototype.slice.call(a)}return e.content&&e.type?e.content:null}function gS(e){return e&&e.name.slice(-4)===".bin"?ov(e):lv(e)}function $n(e,a){for(var t=e.FullPaths||Ua(e.files),i=a.toLowerCase().replace(/[\/]/g,"\\"),s=i.replace(/\\/g,"/"),c=0;c<t.length;++c){var f=t[c].replace(/^Root Entry[\/]/,"").toLowerCase();if(i==f||s==f)return e.files?e.files[t[c]]:e.FileIndex[c]}return null}function Vp(e,a){var t=$n(e,a);if(t==null)throw new Error("Cannot find file "+a+" in zip");return t}function nr(e,a,t){if(!t)return gS(Vp(e,a));if(!a)return null;try{return nr(e,a)}catch{return null}}function _n(e,a,t){if(!t)return lv(Vp(e,a));if(!a)return null;try{return _n(e,a)}catch{return null}}function xS(e,a,t){return ov(Vp(e,a))}function Vx(e){for(var a=e.FullPaths||Ua(e.files),t=[],i=0;i<a.length;++i)a[i].slice(-1)!="/"&&t.push(a[i].replace(/^Root Entry[\/]/,""));return t.sort()}function Dt(e,a,t){if(e.FullPaths){if(typeof t=="string"){var i;return It?i=ts(t):i=O2(t),pt.utils.cfb_add(e,a,i)}pt.utils.cfb_add(e,a,t)}else e.file(a,t)}function Xp(){return pt.utils.cfb_new()}function cv(e,a){switch(a.type){case"base64":return pt.read(e,{type:"base64"});case"binary":return pt.read(e,{type:"binary"});case"buffer":case"array":return pt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+a.type)}function Bc(e,a){if(e.charAt(0)=="/")return e.slice(1);var t=a.split("/");a.slice(-1)!="/"&&t.pop();for(var i=e.split("/");i.length!==0;){var s=i.shift();s===".."?t.pop():s!=="."&&t.push(s)}return t.join("/")}var Ja=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,mS=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Xx=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,vS=/<[^>]*>/g,Gr=Ja.match(Xx)?Xx:vS,yS=/<\w*:/,bS=/<(\/?)\w+:/;function bt(e,a,t){for(var i={},s=0,c=0;s!==e.length&&!((c=e.charCodeAt(s))===32||c===10||c===13);++s);if(a||(i[0]=e.slice(0,s)),s===e.length)return i;var f=e.match(mS),p=0,g="",h=0,E="",A="",_=1;if(f)for(h=0;h!=f.length;++h){for(A=f[h],c=0;c!=A.length&&A.charCodeAt(c)!==61;++c);for(E=A.slice(0,c).trim();A.charCodeAt(c+1)==32;)++c;for(_=(s=A.charCodeAt(c+1))==34||s==39?1:0,g=A.slice(c+1+_,A.length-_),p=0;p!=E.length&&E.charCodeAt(p)!==58;++p);if(p===E.length)E.indexOf("_")>0&&(E=E.slice(0,E.indexOf("_"))),i[E]=g,i[E.toLowerCase()]=g;else{var w=(p===5&&E.slice(0,5)==="xmlns"?"xmlns":"")+E.slice(p+1);if(i[w]&&E.slice(p-3,p)=="ext")continue;i[w]=g,i[w.toLowerCase()]=g}}return i}function _i(e){return e.replace(bS,"<$1")}var dv={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},qp=tf(dv),qt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,a=/_x([\da-fA-F]{4})_/ig;return function t(i){var s=i+"",c=s.indexOf("<![CDATA[");if(c==-1)return s.replace(e,function(p,g){return dv[p]||String.fromCharCode(parseInt(g,p.indexOf("x")>-1?16:10))||p}).replace(a,function(p,g){return String.fromCharCode(parseInt(g,16))});var f=s.indexOf("]]>");return t(s.slice(0,c))+s.slice(c+9,f)+t(s.slice(f+3))}})(),Kp=/[&<>'"]/g,SS=/[\u0000-\u0008\u000b-\u001f]/g;function fa(e){var a=e+"";return a.replace(Kp,function(t){return qp[t]}).replace(SS,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function qx(e){return fa(e).replace(/ /g,"_x0020_")}var fv=/[\u0000-\u001f]/g;function Jp(e){var a=e+"";return a.replace(Kp,function(t){return qp[t]}).replace(/\n/g,"<br/>").replace(fv,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function ES(e){var a=e+"";return a.replace(Kp,function(t){return qp[t]}).replace(fv,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var Kx=(function(){var e=/&#(\d+);/g;function a(t,i){return String.fromCharCode(parseInt(i,10))}return function(i){return i.replace(e,a)}})();function TS(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ca(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function gp(e){for(var a="",t=0,i=0,s=0,c=0,f=0,p=0;t<e.length;){if(i=e.charCodeAt(t++),i<128){a+=String.fromCharCode(i);continue}if(s=e.charCodeAt(t++),i>191&&i<224){f=(i&31)<<6,f|=s&63,a+=String.fromCharCode(f);continue}if(c=e.charCodeAt(t++),i<240){a+=String.fromCharCode((i&15)<<12|(s&63)<<6|c&63);continue}f=e.charCodeAt(t++),p=((i&7)<<18|(s&63)<<12|(c&63)<<6|f&63)-65536,a+=String.fromCharCode(55296+(p>>>10&1023)),a+=String.fromCharCode(56320+(p&1023))}return a}function Jx(e){var a=Ls(2*e.length),t,i,s=1,c=0,f=0,p;for(i=0;i<e.length;i+=s)s=1,(p=e.charCodeAt(i))<128?t=p:p<224?(t=(p&31)*64+(e.charCodeAt(i+1)&63),s=2):p<240?(t=(p&15)*4096+(e.charCodeAt(i+1)&63)*64+(e.charCodeAt(i+2)&63),s=3):(s=4,t=(p&7)*262144+(e.charCodeAt(i+1)&63)*4096+(e.charCodeAt(i+2)&63)*64+(e.charCodeAt(i+3)&63),t-=65536,f=55296+(t>>>10&1023),t=56320+(t&1023)),f!==0&&(a[c++]=f&255,a[c++]=f>>>8,f=0),a[c++]=t%256,a[c++]=t>>>8;return a.slice(0,c).toString("ucs2")}function Qx(e){return ts(e,"binary").toString("utf8")}var Rd="foo bar baz",ga=It&&(Qx(Rd)==gp(Rd)&&Qx||Jx(Rd)==gp(Rd)&&Jx)||gp,Ai=It?function(e){return ts(e,"utf8").toString("binary")}:function(e){for(var a=[],t=0,i=0,s=0;t<e.length;)switch(i=e.charCodeAt(t++),!0){case i<128:a.push(String.fromCharCode(i));break;case i<2048:a.push(String.fromCharCode(192+(i>>6))),a.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,s=e.charCodeAt(t++)-56320+(i<<10),a.push(String.fromCharCode(240+(s>>18&7))),a.push(String.fromCharCode(144+(s>>12&63))),a.push(String.fromCharCode(128+(s>>6&63))),a.push(String.fromCharCode(128+(s&63)));break;default:a.push(String.fromCharCode(224+(i>>12))),a.push(String.fromCharCode(128+(i>>6&63))),a.push(String.fromCharCode(128+(i&63)))}return a.join("")},Xc=(function(){var e={};return function(t,i){var s=t+"|"+(i||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",i||"")}})(),uv=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(a){return[new RegExp("&"+a[0]+";","ig"),a[1]]});return function(t){for(var i=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)i=i.replace(e[s][0],e[s][1]);return i}})(),AS=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),_S=/<\/?(?:vt:)?variant>/g,CS=/<(?:vt:)([^>]*)>([\s\S]*)</;function Zx(e,a){var t=bt(e),i=e.match(AS(t.baseType))||[],s=[];if(i.length!=t.size){if(a.WTF)throw new Error("unexpected vector length "+i.length+" != "+t.size);return s}return i.forEach(function(c){var f=c.replace(_S,"").match(CS);f&&s.push({v:ga(f[2]),t:f[1]})}),s}var pv=/(^\s|\s$|\n)/;function jr(e,a){return"<"+e+(a.match(pv)?' xml:space="preserve"':"")+">"+a+"</"+e+">"}function qc(e){return Ua(e).map(function(a){return" "+a+'="'+e[a]+'"'}).join("")}function Ke(e,a,t){return"<"+e+(t!=null?qc(t):"")+(a!=null?(a.match(pv)?' xml:space="preserve"':"")+">"+a+"</"+e:"/")+">"}function Rp(e,a){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(a)throw t}return""}function kS(e,a){switch(typeof e){case"string":var t=Ke("vt:lpwstr",fa(e));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Ke((e|0)==e?"vt:i4":"vt:r8",fa(String(e)));case"boolean":return Ke("vt:bool",e?"true":"false")}if(e instanceof Date)return Ke("vt:filetime",Rp(e));throw new Error("Unable to serialize "+e)}function Qp(e){if(It&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ga(Hs(Gp(e)));throw new Error("Bad input format: expected Buffer or string")}var Kc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ur={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},kl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],En={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function wS(e,a){for(var t=1-2*(e[a+7]>>>7),i=((e[a+7]&127)<<4)+(e[a+6]>>>4&15),s=e[a+6]&15,c=5;c>=0;--c)s=s*256+e[a+c];return i==2047?s==0?t*(1/0):NaN:(i==0?i=-1022:(i-=1023,s+=Math.pow(2,52)),t*Math.pow(2,i-52)*s)}function RS(e,a,t){var i=(a<0||1/a==-1/0?1:0)<<7,s=0,c=0,f=i?-a:a;isFinite(f)?f==0?s=c=0:(s=Math.floor(Math.log(f)/Math.LN2),c=f*Math.pow(2,52-s),s<=-1023&&(!isFinite(c)||c<Math.pow(2,52))?s=-1022:(c-=Math.pow(2,52),s+=1023)):(s=2047,c=isNaN(a)?26985:0);for(var p=0;p<=5;++p,c/=256)e[t+p]=c&255;e[t+6]=(s&15)<<4|c&15,e[t+7]=s>>4|i}var em=function(e){for(var a=[],t=10240,i=0;i<e[0].length;++i)if(e[0][i])for(var s=0,c=e[0][i].length;s<c;s+=t)a.push.apply(a,e[0][i].slice(s,s+t));return a},tm=It?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(a){return Buffer.isBuffer(a)?a:ts(a)})):em(e)}:em,am=function(e,a,t){for(var i=[],s=a;s<t;s+=2)i.push(String.fromCharCode(Ki(e,s)));return i.join("").replace(Qr,"")},Zp=It?function(e,a,t){return Buffer.isBuffer(e)?e.toString("utf16le",a,t).replace(Qr,""):am(e,a,t)}:am,rm=function(e,a,t){for(var i=[],s=a;s<a+t;++s)i.push(("0"+e[s].toString(16)).slice(-2));return i.join("")},hv=It?function(e,a,t){return Buffer.isBuffer(e)?e.toString("hex",a,a+t):rm(e,a,t)}:rm,nm=function(e,a,t){for(var i=[],s=a;s<t;s++)i.push(String.fromCharCode(So(e,s)));return i.join("")},s0=It?function(a,t,i){return Buffer.isBuffer(a)?a.toString("utf8",t,i):nm(a,t,i)}:nm,gv=function(e,a){var t=Tn(e,a);return t>0?s0(e,a+4,a+4+t-1):""},xv=gv,mv=function(e,a){var t=Tn(e,a);return t>0?s0(e,a+4,a+4+t-1):""},vv=mv,yv=function(e,a){var t=2*Tn(e,a);return t>0?s0(e,a+4,a+4+t-1):""},bv=yv,Sv=function(a,t){var i=Tn(a,t);return i>0?Zp(a,t+4,t+4+i):""},Ev=Sv,Tv=function(e,a){var t=Tn(e,a);return t>0?s0(e,a+4,a+4+t):""},Av=Tv,_v=function(e,a){return wS(e,a)},Gd=_v,eh=function(a){return Array.isArray(a)||typeof Uint8Array<"u"&&a instanceof Uint8Array};It&&(xv=function(a,t){if(!Buffer.isBuffer(a))return gv(a,t);var i=a.readUInt32LE(t);return i>0?a.toString("utf8",t+4,t+4+i-1):""},vv=function(a,t){if(!Buffer.isBuffer(a))return mv(a,t);var i=a.readUInt32LE(t);return i>0?a.toString("utf8",t+4,t+4+i-1):""},bv=function(a,t){if(!Buffer.isBuffer(a))return yv(a,t);var i=2*a.readUInt32LE(t);return a.toString("utf16le",t+4,t+4+i-1)},Ev=function(a,t){if(!Buffer.isBuffer(a))return Sv(a,t);var i=a.readUInt32LE(t);return a.toString("utf16le",t+4,t+4+i)},Av=function(a,t){if(!Buffer.isBuffer(a))return Tv(a,t);var i=a.readUInt32LE(t);return a.toString("utf8",t+4,t+4+i)},Gd=function(a,t){return Buffer.isBuffer(a)?a.readDoubleLE(t):_v(a,t)},eh=function(a){return Buffer.isBuffer(a)||Array.isArray(a)||typeof Uint8Array<"u"&&a instanceof Uint8Array});var So=function(e,a){return e[a]},Ki=function(e,a){return e[a+1]*256+e[a]},NS=function(e,a){var t=e[a+1]*256+e[a];return t<32768?t:(65535-t+1)*-1},Tn=function(e,a){return e[a+3]*(1<<24)+(e[a+2]<<16)+(e[a+1]<<8)+e[a]},gl=function(e,a){return e[a+3]<<24|e[a+2]<<16|e[a+1]<<8|e[a]},FS=function(e,a){return e[a]<<24|e[a+1]<<16|e[a+2]<<8|e[a+3]};function Mc(e,a){var t="",i,s,c=[],f,p,g,h;switch(a){case"dbcs":if(h=this.l,It&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(g=0;g<e;++g)t+=String.fromCharCode(Ki(this,h)),h+=2;e*=2;break;case"utf8":t=s0(this,this.l,this.l+e);break;case"utf16le":e*=2,t=Zp(this,this.l,this.l+e);break;case"wstr":return Mc.call(this,e,"dbcs");case"lpstr-ansi":t=xv(this,this.l),e=4+Tn(this,this.l);break;case"lpstr-cp":t=vv(this,this.l),e=4+Tn(this,this.l);break;case"lpwstr":t=bv(this,this.l),e=4+2*Tn(this,this.l);break;case"lpp4":e=4+Tn(this,this.l),t=Ev(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Tn(this,this.l),t=Av(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(f=So(this,this.l+e++))!==0;)c.push(wd(f));t=c.join("");break;case"_wstr":for(e=0,t="";(f=Ki(this,this.l+e))!==0;)c.push(wd(f)),e+=2;e+=2,t=c.join("");break;case"dbcs-cont":for(t="",h=this.l,g=0;g<e;++g){if(this.lens&&this.lens.indexOf(h)!==-1)return f=So(this,h),this.l=h+1,p=Mc.call(this,e-g,f?"dbcs-cont":"sbcs-cont"),c.join("")+p;c.push(wd(Ki(this,h))),h+=2}t=c.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",h=this.l,g=0;g!=e;++g){if(this.lens&&this.lens.indexOf(h)!==-1)return f=So(this,h),this.l=h+1,p=Mc.call(this,e-g,f?"dbcs-cont":"sbcs-cont"),c.join("")+p;c.push(wd(So(this,h))),h+=1}t=c.join("");break;default:switch(e){case 1:return i=So(this,this.l),this.l++,i;case 2:return i=(a==="i"?NS:Ki)(this,this.l),this.l+=2,i;case 4:case-4:return a==="i"||(this[this.l+3]&128)===0?(i=(e>0?gl:FS)(this,this.l),this.l+=4,i):(s=Tn(this,this.l),this.l+=4,s);case 8:case-8:if(a==="f")return e==8?s=Gd(this,this.l):s=Gd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:t=hv(this,this.l,e);break}}return this.l+=e,t}var jS=function(e,a,t){e[t]=a&255,e[t+1]=a>>>8&255,e[t+2]=a>>>16&255,e[t+3]=a>>>24&255},DS=function(e,a,t){e[t]=a&255,e[t+1]=a>>8&255,e[t+2]=a>>16&255,e[t+3]=a>>24&255},OS=function(e,a,t){e[t]=a&255,e[t+1]=a>>>8&255};function IS(e,a,t){var i=0,s=0;if(t==="dbcs"){for(s=0;s!=a.length;++s)OS(this,a.charCodeAt(s),this.l+2*s);i=2*a.length}else if(t==="sbcs"){for(a=a.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=a.length;++s)this[this.l+s]=a.charCodeAt(s)&255;i=a.length}else if(t==="hex"){for(;s<e;++s)this[this.l++]=parseInt(a.slice(2*s,2*s+2),16)||0;return this}else if(t==="utf16le"){var c=Math.min(this.l+e,this.length);for(s=0;s<Math.min(a.length,e);++s){var f=a.charCodeAt(s);this[this.l++]=f&255,this[this.l++]=f>>8}for(;this.l<c;)this[this.l++]=0;return this}else switch(e){case 1:i=1,this[this.l]=a&255;break;case 2:i=2,this[this.l]=a&255,a>>>=8,this[this.l+1]=a&255;break;case 3:i=3,this[this.l]=a&255,a>>>=8,this[this.l+1]=a&255,a>>>=8,this[this.l+2]=a&255;break;case 4:i=4,jS(this,a,this.l);break;case 8:if(i=8,t==="f"){RS(this,a,this.l);break}case 16:break;case-4:i=4,DS(this,a,this.l);break}return this.l+=i,this}function Cv(e,a){var t=hv(this,this.l,e.length>>1);if(t!==e)throw new Error(a+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Fr(e,a){e.l=a,e.read_shift=Mc,e.chk=Cv,e.write_shift=IS}function $r(e,a){e.l+=a}function Ne(e){var a=Ls(e);return Fr(a,0),a}function as(e,a,t){if(e){var i,s,c;Fr(e,e.l||0);for(var f=e.length,p=0,g=0;e.l<f;){p=e.read_shift(1),p&128&&(p=(p&127)+((e.read_shift(1)&127)<<7));var h=a0[p]||a0[65535];for(i=e.read_shift(1),c=i&127,s=1;s<4&&i&128;++s)c+=((i=e.read_shift(1))&127)<<7*s;g=e.l+c;var E=h.f&&h.f(e,c,t);if(e.l=g,a(E,h,p))return}}}function fn(){var e=[],a=It?256:2048,t=function(h){var E=Ne(h);return Fr(E,0),E},i=t(a),s=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&e.push(i),i=null)},c=function(h){return i&&h<i.length-i.l?i:(s(),i=t(Math.max(h+1,a)))},f=function(){return s(),br(e)},p=function(h){s(),i=h,i.l==null&&(i.l=i.length),c(a)};return{next:c,push:p,end:f,_bufs:e}}function $e(e,a,t,i){var s=+a,c;if(!isNaN(s)){i||(i=a0[s].p||(t||[]).length||0),c=1+(s>=128?1:0)+1,i>=128&&++c,i>=16384&&++c,i>=2097152&&++c;var f=e.next(c);s<=127?f.write_shift(1,s):(f.write_shift(1,(s&127)+128),f.write_shift(1,s>>7));for(var p=0;p!=4;++p)if(i>=128)f.write_shift(1,(i&127)+128),i>>=7;else{f.write_shift(1,i);break}i>0&&eh(t)&&e.push(t)}}function Lc(e,a,t){var i=wa(e);if(a.s?(i.cRel&&(i.c+=a.s.c),i.rRel&&(i.r+=a.s.r)):(i.cRel&&(i.c+=a.c),i.rRel&&(i.r+=a.r)),!t||t.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function im(e,a,t){var i=wa(e);return i.s=Lc(i.s,a.s,t),i.e=Lc(i.e,a.s,t),i}function Pc(e,a){if(e.cRel&&e.c<0)for(e=wa(e);e.c<0;)e.c+=a>8?16384:256;if(e.rRel&&e.r<0)for(e=wa(e);e.r<0;)e.r+=a>8?1048576:a>5?65536:16384;var t=vt(e);return!e.cRel&&e.cRel!=null&&(t=LS(t)),!e.rRel&&e.rRel!=null&&(t=BS(t)),t}function xp(e,a){return e.s.r==0&&!e.s.rRel&&e.e.r==(a.biff>=12?1048575:a.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Oa(e.s.c)+":"+(e.e.cRel?"":"$")+Oa(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(a.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ka(e.s.r)+":"+(e.e.rRel?"":"$")+Ka(e.e.r):Pc(e.s,a.biff)+":"+Pc(e.e,a.biff)}function th(e){return parseInt(MS(e),10)-1}function Ka(e){return""+(e+1)}function BS(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function MS(e){return e.replace(/\$(\d+)$/,"$1")}function ah(e){for(var a=PS(e),t=0,i=0;i!==a.length;++i)t=26*t+a.charCodeAt(i)-64;return t-1}function Oa(e){if(e<0)throw new Error("invalid column "+e);var a="";for(++e;e;e=Math.floor((e-1)/26))a=String.fromCharCode((e-1)%26+65)+a;return a}function LS(e){return e.replace(/^([A-Z])/,"$$$1")}function PS(e){return e.replace(/^\$([A-Z])/,"$1")}function zS(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ia(e){for(var a=0,t=0,i=0;i<e.length;++i){var s=e.charCodeAt(i);s>=48&&s<=57?a=10*a+(s-48):s>=65&&s<=90&&(t=26*t+(s-64))}return{c:t-1,r:a-1}}function vt(e){for(var a=e.c+1,t="";a;a=(a-1)/26|0)t=String.fromCharCode((a-1)%26+65)+t;return t+(e.r+1)}function un(e){var a=e.indexOf(":");return a==-1?{s:Ia(e),e:Ia(e)}:{s:Ia(e.slice(0,a)),e:Ia(e.slice(a+1))}}function wt(e,a){return typeof a>"u"||typeof a=="number"?wt(e.s,e.e):(typeof e!="string"&&(e=vt(e)),typeof a!="string"&&(a=vt(a)),e==a?e:e+":"+a)}function Kt(e){var a={s:{c:0,r:0},e:{c:0,r:0}},t=0,i=0,s=0,c=e.length;for(t=0;i<c&&!((s=e.charCodeAt(i)-64)<1||s>26);++i)t=26*t+s;for(a.s.c=--t,t=0;i<c&&!((s=e.charCodeAt(i)-48)<0||s>9);++i)t=10*t+s;if(a.s.r=--t,i===c||s!=10)return a.e.c=a.s.c,a.e.r=a.s.r,a;for(++i,t=0;i!=c&&!((s=e.charCodeAt(i)-64)<1||s>26);++i)t=26*t+s;for(a.e.c=--t,t=0;i!=c&&!((s=e.charCodeAt(i)-48)<0||s>9);++i)t=10*t+s;return a.e.r=--t,a}function sm(e,a){var t=e.t=="d"&&a instanceof Date;if(e.z!=null)try{return e.w=Wn(e.z,t?pr(a):a)}catch{}try{return e.w=Wn((e.XF||{}).numFmtId||(t?14:0),t?pr(a):a)}catch{return""+a}}function es(e,a,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?rs[e.v]||e.v:a==null?sm(e,e.v):sm(e,a))}function $s(e,a){var t=a&&a.sheet?a.sheet:"Sheet1",i={};return i[t]=e,{SheetNames:[t],Sheets:i}}function kv(e,a,t){var i=t||{},s=e?Array.isArray(e):i.dense,c=e||(s?[]:{}),f=0,p=0;if(c&&i.origin!=null){if(typeof i.origin=="number")f=i.origin;else{var g=typeof i.origin=="string"?Ia(i.origin):i.origin;f=g.r,p=g.c}c["!ref"]||(c["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(c["!ref"]){var E=Kt(c["!ref"]);h.s.c=E.s.c,h.s.r=E.s.r,h.e.c=Math.max(h.e.c,E.e.c),h.e.r=Math.max(h.e.r,E.e.r),f==-1&&(h.e.r=f=E.e.r+1)}for(var A=0;A!=a.length;++A)if(a[A]){if(!Array.isArray(a[A]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=a[A].length;++_)if(!(typeof a[A][_]>"u")){var w={v:a[A][_]},N=f+A,k=p+_;if(h.s.r>N&&(h.s.r=N),h.s.c>k&&(h.s.c=k),h.e.r<N&&(h.e.r=N),h.e.c<k&&(h.e.c=k),a[A][_]&&typeof a[A][_]=="object"&&!Array.isArray(a[A][_])&&!(a[A][_]instanceof Date))w=a[A][_];else if(Array.isArray(w.v)&&(w.f=a[A][_][1],w.v=w.v[0]),w.v===null)if(w.f)w.t="n";else if(i.nullError)w.t="e",w.v=0;else if(i.sheetStubs)w.t="z";else continue;else typeof w.v=="number"?w.t="n":typeof w.v=="boolean"?w.t="b":w.v instanceof Date?(w.z=i.dateNF||mt[14],i.cellDates?(w.t="d",w.w=Wn(w.z,pr(w.v))):(w.t="n",w.v=pr(w.v),w.w=Wn(w.z,w.v))):w.t="s";if(s)c[N]||(c[N]=[]),c[N][k]&&c[N][k].z&&(w.z=c[N][k].z),c[N][k]=w;else{var F=vt({c:k,r:N});c[F]&&c[F].z&&(w.z=c[F].z),c[F]=w}}}return h.s.c<1e7&&(c["!ref"]=wt(h)),c}function jo(e,a){return kv(null,e,a)}function US(e){return e.read_shift(4,"i")}function oi(e,a){return a||(a=Ne(4)),a.write_shift(4,e),a}function Hr(e){var a=e.read_shift(4);return a===0?"":e.read_shift(a,"dbcs")}function Sr(e,a){var t=!1;return a==null&&(t=!0,a=Ne(4+2*e.length)),a.write_shift(4,e.length),e.length>0&&a.write_shift(0,e,"dbcs"),t?a.slice(0,a.l):a}function HS(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function $S(e,a){return a||(a=Ne(4)),a.write_shift(2,0),a.write_shift(2,0),a}function rh(e,a){var t=e.l,i=e.read_shift(1),s=Hr(e),c=[],f={t:s,h:s};if((i&1)!==0){for(var p=e.read_shift(4),g=0;g!=p;++g)c.push(HS(e));f.r=c}else f.r=[{ich:0,ifnt:0}];return e.l=t+a,f}function GS(e,a){var t=!1;return a==null&&(t=!0,a=Ne(15+4*e.t.length)),a.write_shift(1,0),Sr(e.t,a),t?a.slice(0,a.l):a}var YS=rh;function WS(e,a){var t=!1;return a==null&&(t=!0,a=Ne(23+4*e.t.length)),a.write_shift(1,1),Sr(e.t,a),a.write_shift(4,1),$S({},a),t?a.slice(0,a.l):a}function Vn(e){var a=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:a,iStyleRef:t}}function wl(e,a){return a==null&&(a=Ne(8)),a.write_shift(-4,e.c),a.write_shift(3,e.iStyleRef||e.s),a.write_shift(1,0),a}function Rl(e){var a=e.read_shift(2);return a+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:a}}function Nl(e,a){return a==null&&(a=Ne(4)),a.write_shift(3,e.iStyleRef||e.s),a.write_shift(1,0),a}var VS=Hr,wv=Sr;function nh(e){var a=e.read_shift(4);return a===0||a===4294967295?"":e.read_shift(a,"dbcs")}function Yd(e,a){var t=!1;return a==null&&(t=!0,a=Ne(127)),a.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&a.write_shift(0,e,"dbcs"),t?a.slice(0,a.l):a}var XS=Hr,Np=nh,ih=Yd;function sh(e){var a=e.slice(e.l,e.l+4),t=a[0]&1,i=a[0]&2;e.l+=4;var s=i===0?Gd([0,0,0,0,a[0]&252,a[1],a[2],a[3]],0):gl(a,0)>>2;return t?s/100:s}function Rv(e,a){a==null&&(a=Ne(4));var t=0,i=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?i=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(i=1,t=1),i)a.write_shift(-4,((t?s:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function Nv(e){var a={s:{},e:{}};return a.s.r=e.read_shift(4),a.e.r=e.read_shift(4),a.s.c=e.read_shift(4),a.e.c=e.read_shift(4),a}function qS(e,a){return a||(a=Ne(16)),a.write_shift(4,e.s.r),a.write_shift(4,e.e.r),a.write_shift(4,e.s.c),a.write_shift(4,e.e.c),a}var Fl=Nv,Do=qS;function Ur(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Tl(e,a){return(a||Ne(8)).write_shift(8,e,"f")}function KS(e){var a={},t=e.read_shift(1),i=t>>>1,s=e.read_shift(1),c=e.read_shift(2,"i"),f=e.read_shift(1),p=e.read_shift(1),g=e.read_shift(1);switch(e.l++,i){case 0:a.auto=1;break;case 1:a.index=s;var h=ml[s];h&&(a.rgb=Qc(h));break;case 2:a.rgb=Qc([f,p,g]);break;case 3:a.theme=s;break}return c!=0&&(a.tint=c>0?c/32767:c/32768),a}function Wd(e,a){if(a||(a=Ne(8)),!e||e.auto)return a.write_shift(4,0),a.write_shift(4,0),a;e.index!=null?(a.write_shift(1,2),a.write_shift(1,e.index)):e.theme!=null?(a.write_shift(1,6),a.write_shift(1,e.theme)):(a.write_shift(1,5),a.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),a.write_shift(2,t),!e.rgb||e.theme!=null)a.write_shift(2,0),a.write_shift(1,0),a.write_shift(1,0);else{var i=e.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),a.write_shift(1,parseInt(i.slice(0,2),16)),a.write_shift(1,parseInt(i.slice(2,4),16)),a.write_shift(1,parseInt(i.slice(4,6),16)),a.write_shift(1,255)}return a}function JS(e){var a=e.read_shift(1);e.l++;var t={fBold:a&1,fItalic:a&2,fUnderline:a&4,fStrikeout:a&8,fOutline:a&16,fShadow:a&32,fCondense:a&64,fExtend:a&128};return t}function QS(e,a){a||(a=Ne(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return a.write_shift(1,t),a.write_shift(1,0),a}function Fv(e,a){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},i=e.read_shift(4);switch(i){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(i>400)throw new Error("Unsupported Clipboard: "+i.toString(16));return e.l-=4,e.read_shift(0,a==1?"lpstr":"lpwstr")}function ZS(e){return Fv(e,1)}function eE(e){return Fv(e,2)}var lh=2,dn=3,Nd=11,lm=12,Vd=19,Fd=64,tE=65,aE=71,rE=4108,nE=4126,yr=80,jv=81,iE=[yr,jv],Fp={1:{n:"CodePage",t:lh},2:{n:"Category",t:yr},3:{n:"PresentationFormat",t:yr},4:{n:"ByteCount",t:dn},5:{n:"LineCount",t:dn},6:{n:"ParagraphCount",t:dn},7:{n:"SlideCount",t:dn},8:{n:"NoteCount",t:dn},9:{n:"HiddenCount",t:dn},10:{n:"MultimediaClipCount",t:dn},11:{n:"ScaleCrop",t:Nd},12:{n:"HeadingPairs",t:rE},13:{n:"TitlesOfParts",t:nE},14:{n:"Manager",t:yr},15:{n:"Company",t:yr},16:{n:"LinksUpToDate",t:Nd},17:{n:"CharacterCount",t:dn},19:{n:"SharedDoc",t:Nd},22:{n:"HyperlinksChanged",t:Nd},23:{n:"AppVersion",t:dn,p:"version"},24:{n:"DigSig",t:tE},26:{n:"ContentType",t:yr},27:{n:"ContentStatus",t:yr},28:{n:"Language",t:yr},29:{n:"Version",t:yr},255:{},2147483648:{n:"Locale",t:Vd},2147483651:{n:"Behavior",t:Vd},1919054434:{}},jp={1:{n:"CodePage",t:lh},2:{n:"Title",t:yr},3:{n:"Subject",t:yr},4:{n:"Author",t:yr},5:{n:"Keywords",t:yr},6:{n:"Comments",t:yr},7:{n:"Template",t:yr},8:{n:"LastAuthor",t:yr},9:{n:"RevNumber",t:yr},10:{n:"EditTime",t:Fd},11:{n:"LastPrinted",t:Fd},12:{n:"CreatedDate",t:Fd},13:{n:"ModifiedDate",t:Fd},14:{n:"PageCount",t:dn},15:{n:"WordCount",t:dn},16:{n:"CharCount",t:dn},17:{n:"Thumbnail",t:aE},18:{n:"Application",t:yr},19:{n:"DocSecurity",t:dn},255:{},2147483648:{n:"Locale",t:Vd},2147483651:{n:"Behavior",t:Vd},1919054434:{}},om={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},sE=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function lE(e){return e.map(function(a){return[a>>16&255,a>>8&255,a&255]})}var oE=lE([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ml=wa(oE),rs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Dv={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Dp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},jd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function oh(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function cE(e){var a=oh();if(!e||!e.match)return a;var t={};if((e.match(Gr)||[]).forEach(function(i){var s=bt(i);switch(s[0].replace(yS,"<")){case"<?xml":break;case"<Types":a.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[s.Extension]=s.ContentType;break;case"<Override":a[Dp[s.ContentType]]!==void 0&&a[Dp[s.ContentType]].push(s.PartName);break}}),a.xmlns!==ur.CT)throw new Error("Unknown Namespace: "+a.xmlns);return a.calcchain=a.calcchains.length>0?a.calcchains[0]:"",a.sst=a.strs.length>0?a.strs[0]:"",a.style=a.styles.length>0?a.styles[0]:"",a.defaults=t,delete a.calcchains,a}function Ov(e,a){var t=cS(Dp),i=[],s;i[i.length]=Ja,i[i.length]=Ke("Types",null,{xmlns:ur.CT,"xmlns:xsd":ur.xsd,"xmlns:xsi":ur.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(g){return Ke("Default",null,{Extension:g[0],ContentType:g[1]})}));var c=function(g){e[g]&&e[g].length>0&&(s=e[g][0],i[i.length]=Ke("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:jd[g][a.bookType]||jd[g].xlsx}))},f=function(g){(e[g]||[]).forEach(function(h){i[i.length]=Ke("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:jd[g][a.bookType]||jd[g].xlsx})})},p=function(g){(e[g]||[]).forEach(function(h){i[i.length]=Ke("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:t[g][0]})})};return c("workbooks"),f("sheets"),f("charts"),p("themes"),["strs","styles"].forEach(c),["coreprops","extprops","custprops"].forEach(p),p("vba"),p("comments"),p("threadedcomments"),p("drawings"),f("metadata"),p("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var Bt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Jc(e){var a=e.lastIndexOf("/");return e.slice(0,a+1)+"_rels/"+e.slice(a+1)+".rels"}function zc(e,a){var t={"!id":{}};if(!e)return t;a.charAt(0)!=="/"&&(a="/"+a);var i={};return(e.match(Gr)||[]).forEach(function(s){var c=bt(s);if(c[0]==="<Relationship"){var f={};f.Type=c.Type,f.Target=c.Target,f.Id=c.Id,c.TargetMode&&(f.TargetMode=c.TargetMode);var p=c.TargetMode==="External"?c.Target:Bc(c.Target,a);t[p]=f,i[c.Id]=f}}),t["!id"]=i,t}function Ao(e){var a=[Ja,Ke("Relationships",null,{xmlns:ur.RELS})];return Ua(e["!id"]).forEach(function(t){a[a.length]=Ke("Relationship",null,e["!id"][t])}),a.length>2&&(a[a.length]="</Relationships>",a[1]=a[1].replace("/>",">")),a.join("")}function da(e,a,t,i,s,c){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),a<0)for(a=e["!idx"];e["!id"]["rId"+a];++a);if(e["!idx"]=a+1,s.Id="rId"+a,s.Type=i,s.Target=t,[Bt.HLINK,Bt.XPATH,Bt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+a);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,a}var dE="application/vnd.oasis.opendocument.spreadsheet";function fE(e,a){for(var t=Qp(e),i,s;i=Kc.exec(t);)switch(i[3]){case"manifest":break;case"file-entry":if(s=bt(i[0],!1),s.path=="/"&&s.type!==dE)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(a&&a.WTF)throw i}}function uE(e){var a=[Ja];a.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),a.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)a.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return a.push("</manifest:manifest>"),a.join("")}function cm(e,a,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+a+`"/>
`,`  </rdf:Description>
`].join("")}function pE(e,a){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+a+`"/>
`,`  </rdf:Description>
`].join("")}function hE(e){var a=[Ja];a.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)a.push(cm(e[t][0],e[t][1])),a.push(pE("",e[t][0]));return a.push(cm("","Document","pkg")),a.push("</rdf:RDF>"),a.join("")}function Iv(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Pd.version+"</meta:generator></office:meta></office:document-meta>"}var Yn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],gE=(function(){for(var e=new Array(Yn.length),a=0;a<Yn.length;++a){var t=Yn[a],i="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[a]=new RegExp("<"+i+"[^>]*>([\\s\\S]*?)</"+i+">")}return e})();function Bv(e){var a={};e=ga(e);for(var t=0;t<Yn.length;++t){var i=Yn[t],s=e.match(gE[t]);s!=null&&s.length>0&&(a[i[1]]=qt(s[1])),i[2]==="date"&&a[i[1]]&&(a[i[1]]=ka(a[i[1]]))}return a}function mp(e,a,t,i,s){s[e]!=null||a==null||a===""||(s[e]=a,a=fa(a),i[i.length]=t?Ke(e,a,t):jr(e,a))}function Mv(e,a){var t=a||{},i=[Ja,Ke("cp:coreProperties",null,{"xmlns:cp":ur.CORE_PROPS,"xmlns:dc":ur.dc,"xmlns:dcterms":ur.dcterms,"xmlns:dcmitype":ur.dcmitype,"xmlns:xsi":ur.xsi})],s={};if(!e&&!t.Props)return i.join("");e&&(e.CreatedDate!=null&&mp("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Rp(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,s),e.ModifiedDate!=null&&mp("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Rp(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,s));for(var c=0;c!=Yn.length;++c){var f=Yn[c],p=t.Props&&t.Props[f[1]]!=null?t.Props[f[1]]:e?e[f[1]]:null;p===!0?p="1":p===!1?p="0":typeof p=="number"&&(p=String(p)),p!=null&&mp(f[0],p,null,i,s)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var vl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Lv=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Pv(e,a,t,i){var s=[];if(typeof e=="string")s=Zx(e,i);else for(var c=0;c<e.length;++c)s=s.concat(e[c].map(function(E){return{v:E}}));var f=typeof a=="string"?Zx(a,i).map(function(E){return E.v}):a,p=0,g=0;if(f.length>0)for(var h=0;h!==s.length;h+=2){switch(g=+s[h+1].v,s[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=g,t.SheetNames=f.slice(p,p+g);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=g,t.DefinedNames=f.slice(p,p+g);break;case"Charts":case"Diagramme":t.Chartsheets=g,t.ChartNames=f.slice(p,p+g);break}p+=g}}function xE(e,a,t){var i={};return a||(a={}),e=ga(e),vl.forEach(function(s){var c=(e.match(Xc(s[0]))||[])[1];switch(s[2]){case"string":c&&(a[s[1]]=qt(c));break;case"bool":a[s[1]]=c==="true";break;case"raw":var f=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));f&&f.length>0&&(i[s[1]]=f[1]);break}}),i.HeadingPairs&&i.TitlesOfParts&&Pv(i.HeadingPairs,i.TitlesOfParts,a,t),a}function zv(e){var a=[],t=Ke;return e||(e={}),e.Application="SheetJS",a[a.length]=Ja,a[a.length]=Ke("Properties",null,{xmlns:ur.EXT_PROPS,"xmlns:vt":ur.vt}),vl.forEach(function(i){if(e[i[1]]!==void 0){var s;switch(i[2]){case"string":s=fa(String(e[i[1]]));break;case"bool":s=e[i[1]]?"true":"false";break}s!==void 0&&(a[a.length]=t(i[0],s))}}),a[a.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),a[a.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(i){return"<vt:lpstr>"+fa(i)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),a.length>2&&(a[a.length]="</Properties>",a[1]=a[1].replace("/>",">")),a.join("")}var mE=/<[^>]+>[^<]*/g;function vE(e,a){var t={},i="",s=e.match(mE);if(s)for(var c=0;c!=s.length;++c){var f=s[c],p=bt(f);switch(p[0]){case"<?xml":break;case"<Properties":break;case"<property":i=qt(p.name);break;case"</property>":i=null;break;default:if(f.indexOf("<vt:")===0){var g=f.split(">"),h=g[0].slice(4),E=g[1];switch(h){case"lpstr":case"bstr":case"lpwstr":t[i]=qt(E);break;case"bool":t[i]=Ca(E);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[i]=parseInt(E,10);break;case"r4":case"r8":case"decimal":t[i]=parseFloat(E);break;case"filetime":case"date":t[i]=ka(E);break;case"cy":case"error":t[i]=qt(E);break;default:if(h.slice(-1)=="/")break;a.WTF&&typeof console<"u"&&console.warn("Unexpected",f,h,g)}}else if(f.slice(0,2)!=="</"){if(a.WTF)throw new Error(f)}}}return t}function Uv(e){var a=[Ja,Ke("Properties",null,{xmlns:ur.CUST_PROPS,"xmlns:vt":ur.vt})];if(!e)return a.join("");var t=1;return Ua(e).forEach(function(s){++t,a[a.length]=Ke("property",kS(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:fa(s)})}),a.length>2&&(a[a.length]="</Properties>",a[1]=a[1].replace("/>",">")),a.join("")}var Op={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},vp;function yE(e,a,t){vp||(vp=tf(Op)),a=vp[a]||a,e[a]=t}function bE(e,a){var t=[];return Ua(Op).map(function(i){for(var s=0;s<Yn.length;++s)if(Yn[s][1]==i)return Yn[s];for(s=0;s<vl.length;++s)if(vl[s][1]==i)return vl[s];throw i}).forEach(function(i){if(e[i[1]]!=null){var s=a&&a.Props&&a.Props[i[1]]!=null?a.Props[i[1]]:e[i[1]];i[2]==="date"&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"Z")),typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),t.push(jr(Op[i[1]]||i[1],s))}}),Ke("DocumentProperties",t.join(""),{xmlns:En.o})}function SE(e,a){var t=["Worksheets","SheetNames"],i="CustomDocumentProperties",s=[];return e&&Ua(e).forEach(function(c){if(Object.prototype.hasOwnProperty.call(e,c)){for(var f=0;f<Yn.length;++f)if(c==Yn[f][1])return;for(f=0;f<vl.length;++f)if(c==vl[f][1])return;for(f=0;f<t.length;++f)if(c==t[f])return;var p=e[c],g="string";typeof p=="number"?(g="float",p=String(p)):p===!0||p===!1?(g="boolean",p=p?"1":"0"):p=String(p),s.push(Ke(qx(c),p,{"dt:dt":g}))}}),a&&Ua(a).forEach(function(c){if(Object.prototype.hasOwnProperty.call(a,c)&&!(e&&Object.prototype.hasOwnProperty.call(e,c))){var f=a[c],p="string";typeof f=="number"?(p="float",f=String(f)):f===!0||f===!1?(p="boolean",f=f?"1":"0"):f instanceof Date?(p="dateTime.tz",f=f.toISOString()):f=String(f),s.push(Ke(qx(c),f,{"dt:dt":p}))}}),"<"+i+' xmlns="'+En.o+'">'+s.join("")+"</"+i+">"}function ch(e){var a=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+a/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function EE(e){var a=typeof e=="string"?new Date(Date.parse(e)):e,t=a.getTime()/1e3+11644473600,i=t%Math.pow(2,32),s=(t-i)/Math.pow(2,32);i*=1e7,s*=1e7;var c=i/Math.pow(2,32)|0;c>0&&(i=i%Math.pow(2,32),s+=c);var f=Ne(8);return f.write_shift(4,i),f.write_shift(4,s),f}function Hv(e,a,t){var i=e.l,s=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-i&3;)++e.l;return s}function $v(e,a,t){var i=e.read_shift(0,"lpwstr");return i}function Gv(e,a,t){return a===31?$v(e):Hv(e,a,t)}function Ip(e,a,t){return Gv(e,a,t===!1?0:4)}function TE(e,a){if(!a)throw new Error("VtUnalignedString must have positive length");return Gv(e,a,0)}function AE(e){for(var a=e.read_shift(4),t=[],i=0;i!=a;++i){var s=e.l;t[i]=e.read_shift(0,"lpwstr").replace(Qr,""),e.l-s&2&&(e.l+=2)}return t}function _E(e){for(var a=e.read_shift(4),t=[],i=0;i!=a;++i)t[i]=e.read_shift(0,"lpstr-cp").replace(Qr,"");return t}function CE(e){var a=e.l,t=Xd(e,jv);e[e.l]==0&&e[e.l+1]==0&&e.l-a&2&&(e.l+=2);var i=Xd(e,dn);return[t,i]}function kE(e){for(var a=e.read_shift(4),t=[],i=0;i<a/2;++i)t.push(CE(e));return t}function dm(e,a){for(var t=e.read_shift(4),i={},s=0;s!=t;++s){var c=e.read_shift(4),f=e.read_shift(4);i[c]=e.read_shift(f,a===1200?"utf16le":"utf8").replace(Qr,"").replace(Ic,"!"),a===1200&&f%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),i}function Yv(e){var a=e.read_shift(4),t=e.slice(e.l,e.l+a);return e.l+=a,(a&3)>0&&(e.l+=4-(a&3)&3),t}function wE(e){var a={};return a.Size=e.read_shift(4),e.l+=a.Size+3-(a.Size-1)%4,a}function Xd(e,a,t){var i=e.read_shift(2),s,c=t||{};if(e.l+=2,a!==lm&&i!==a&&iE.indexOf(a)===-1&&!((a&65534)==4126&&(i&65534)==4126))throw new Error("Expected type "+a+" saw "+i);switch(a===lm?i:a){case 2:return s=e.read_shift(2,"i"),c.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return Hv(e,i,4).replace(Qr,"");case 31:return $v(e);case 64:return ch(e);case 65:return Yv(e);case 71:return wE(e);case 80:return Ip(e,i,!c.raw).replace(Qr,"");case 81:return TE(e,i).replace(Qr,"");case 4108:return kE(e);case 4126:case 4127:return i==4127?AE(e):_E(e);default:throw new Error("TypedPropertyValue unrecognized type "+a+" "+i)}}function fm(e,a){var t=Ne(4),i=Ne(4);switch(t.write_shift(4,e==80?31:e),e){case 3:i.write_shift(-4,a);break;case 5:i=Ne(8),i.write_shift(8,a,"f");break;case 11:i.write_shift(4,a?1:0);break;case 64:i=EE(a);break;case 31:case 80:for(i=Ne(4+2*(a.length+1)+(a.length%2?0:2)),i.write_shift(4,a.length+1),i.write_shift(0,a,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+a)}return br([t,i])}function um(e,a){var t=e.l,i=e.read_shift(4),s=e.read_shift(4),c=[],f=0,p=0,g=-1,h={};for(f=0;f!=s;++f){var E=e.read_shift(4),A=e.read_shift(4);c[f]=[E,A+t]}c.sort(function(q,B){return q[1]-B[1]});var _={};for(f=0;f!=s;++f){if(e.l!==c[f][1]){var w=!0;if(f>0&&a)switch(a[c[f-1][0]].t){case 2:e.l+2===c[f][1]&&(e.l+=2,w=!1);break;case 80:e.l<=c[f][1]&&(e.l=c[f][1],w=!1);break;case 4108:e.l<=c[f][1]&&(e.l=c[f][1],w=!1);break}if((!a||f==0)&&e.l<=c[f][1]&&(w=!1,e.l=c[f][1]),w)throw new Error("Read Error: Expected address "+c[f][1]+" at "+e.l+" :"+f)}if(a){var N=a[c[f][0]];if(_[N.n]=Xd(e,N.t,{raw:!0}),N.p==="version"&&(_[N.n]=String(_[N.n]>>16)+"."+("0000"+String(_[N.n]&65535)).slice(-4)),N.n=="CodePage")switch(_[N.n]){case 0:_[N.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ii(p=_[N.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[N.n])}}else if(c[f][0]===1){if(p=_.CodePage=Xd(e,lh),ii(p),g!==-1){var k=e.l;e.l=c[g][1],h=dm(e,p),e.l=k}}else if(c[f][0]===0){if(p===0){g=f,e.l=c[f+1][1];continue}h=dm(e,p)}else{var F=h[c[f][0]],z;switch(e[e.l]){case 65:e.l+=4,z=Yv(e);break;case 30:e.l+=4,z=Ip(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,z=Ip(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,z=e.read_shift(4,"i");break;case 19:e.l+=4,z=e.read_shift(4);break;case 5:e.l+=4,z=e.read_shift(8,"f");break;case 11:e.l+=4,z=qa(e,4);break;case 64:e.l+=4,z=ka(ch(e));break;default:throw new Error("unparsed value: "+e[e.l])}_[F]=z}}return e.l=t+i,_}var Wv=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function RE(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function pm(e,a,t){var i=Ne(8),s=[],c=[],f=8,p=0,g=Ne(8),h=Ne(8);if(g.write_shift(4,2),g.write_shift(4,1200),h.write_shift(4,1),c.push(g),s.push(h),f+=8+g.length,!a){h=Ne(8),h.write_shift(4,0),s.unshift(h);var E=[Ne(4)];for(E[0].write_shift(4,e.length),p=0;p<e.length;++p){var A=e[p][0];for(g=Ne(8+2*(A.length+1)+(A.length%2?0:2)),g.write_shift(4,p+2),g.write_shift(4,A.length+1),g.write_shift(0,A,"dbcs");g.l!=g.length;)g.write_shift(1,0);E.push(g)}g=br(E),c.unshift(g),f+=8+g.length}for(p=0;p<e.length;++p)if(!(a&&!a[e[p][0]])&&!(Wv.indexOf(e[p][0])>-1||Lv.indexOf(e[p][0])>-1)&&e[p][1]!=null){var _=e[p][1],w=0;if(a){w=+a[e[p][0]];var N=t[w];if(N.p=="version"&&typeof _=="string"){var k=_.split(".");_=(+k[0]<<16)+(+k[1]||0)}g=fm(N.t,_)}else{var F=RE(_);F==-1&&(F=31,_=String(_)),g=fm(F,_)}c.push(g),h=Ne(8),h.write_shift(4,a?w:2+p),s.push(h),f+=8+g.length}var z=8*(c.length+1);for(p=0;p<c.length;++p)s[p].write_shift(4,z),z+=c[p].length;return i.write_shift(4,f),i.write_shift(4,c.length),br([i].concat(s).concat(c))}function hm(e,a,t){var i=e.content;if(!i)return{};Fr(i,0);var s,c,f,p,g=0;i.chk("feff","Byte Order: "),i.read_shift(2);var h=i.read_shift(4),E=i.read_shift(16);if(E!==pt.utils.consts.HEADER_CLSID&&E!==t)throw new Error("Bad PropertySet CLSID "+E);if(s=i.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(c=i.read_shift(16),p=i.read_shift(4),s===1&&p!==i.l)throw new Error("Length mismatch: "+p+" !== "+i.l);s===2&&(f=i.read_shift(16),g=i.read_shift(4));var A=um(i,a),_={SystemIdentifier:h};for(var w in A)_[w]=A[w];if(_.FMTID=c,s===1)return _;if(g-i.l==2&&(i.l+=2),i.l!==g)throw new Error("Length mismatch 2: "+i.l+" !== "+g);var N;try{N=um(i,null)}catch{}for(w in N)_[w]=N[w];return _.FMTID=[c,f],_}function gm(e,a,t,i,s,c){var f=Ne(s?68:48),p=[f];f.write_shift(2,65534),f.write_shift(2,0),f.write_shift(4,842412599),f.write_shift(16,pt.utils.consts.HEADER_CLSID,"hex"),f.write_shift(4,s?2:1),f.write_shift(16,a,"hex"),f.write_shift(4,s?68:48);var g=pm(e,t,i);if(p.push(g),s){var h=pm(s,null,null);f.write_shift(16,c,"hex"),f.write_shift(4,68+g.length),p.push(h)}return br(p)}function Is(e,a){return e.read_shift(a),null}function NE(e,a){a||(a=Ne(e));for(var t=0;t<e;++t)a.write_shift(1,0);return a}function FE(e,a,t){for(var i=[],s=e.l+a;e.l<s;)i.push(t(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return i}function qa(e,a){return e.read_shift(a)===1}function Jr(e,a){return a||(a=Ne(2)),a.write_shift(2,+!!e),a}function ir(e){return e.read_shift(2,"u")}function Gn(e,a){return a||(a=Ne(2)),a.write_shift(2,e),a}function Vv(e,a){return FE(e,a,ir)}function jE(e){var a=e.read_shift(1),t=e.read_shift(1);return t===1?a:a===1}function Xv(e,a,t){return t||(t=Ne(2)),t.write_shift(1,a=="e"?+e:+!!e),t.write_shift(1,a=="e"?1:0),t}function l0(e,a,t){var i=e.read_shift(t&&t.biff>=12?2:1),s="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var c=e.read_shift(1);c&&(s="dbcs-cont")}else t.biff==12&&(s="wstr");t.biff>=2&&t.biff<=5&&(s="cpstr");var f=i?e.read_shift(i,s):"";return f}function DE(e){var a=e.read_shift(2),t=e.read_shift(1),i=t&4,s=t&8,c=1+(t&1),f=0,p,g={};s&&(f=e.read_shift(2)),i&&(p=e.read_shift(4));var h=c==2?"dbcs-cont":"sbcs-cont",E=a===0?"":e.read_shift(a,h);return s&&(e.l+=4*f),i&&(e.l+=p),g.t=E,s||(g.raw="<t>"+g.t+"</t>",g.r=g.t),g}function OE(e){var a=e.t||"",t=Ne(3);t.write_shift(2,a.length),t.write_shift(1,1);var i=Ne(2*a.length);i.write_shift(2*a.length,a,"utf16le");var s=[t,i];return br(s)}function Al(e,a,t){var i;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(a,"cpstr");if(t.biff>=12)return e.read_shift(a,"dbcs-cont")}var s=e.read_shift(1);return s===0?i=e.read_shift(a,"sbcs-cont"):i=e.read_shift(a,"dbcs-cont"),i}function o0(e,a,t){var i=e.read_shift(t&&t.biff==2?1:2);return i===0?(e.l++,""):Al(e,i,t)}function jl(e,a,t){if(t.biff>5)return o0(e,a,t);var i=e.read_shift(1);return i===0?(e.l++,""):e.read_shift(i,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function qv(e,a,t){return t||(t=Ne(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function IE(e){var a=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[a,t]}function BE(e){var a=e.read_shift(4),t=e.l,i=!1;a>24&&(e.l+=a-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(i=!0),e.l=t);var s=e.read_shift((i?a-24:a)>>1,"utf16le").replace(Qr,"");return i&&(e.l+=24),s}function ME(e){for(var a=e.read_shift(2),t="";a-- >0;)t+="../";var i=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return t+i.replace(/\\/g,"/");var c=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var f=e.read_shift(c>>1,"utf16le").replace(Qr,"");return t+f}function LE(e,a){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return BE(e);case"0303000000000000c000000000000046":return ME(e);default:throw new Error("Unsupported Moniker "+t)}}function Dd(e){var a=e.read_shift(4),t=a>0?e.read_shift(a,"utf16le").replace(Qr,""):"";return t}function xm(e,a){a||(a=Ne(6+e.length*2)),a.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)a.write_shift(2,e.charCodeAt(t));return a.write_shift(2,0),a}function PE(e,a){var t=e.l+a,i=e.read_shift(4);if(i!==2)throw new Error("Unrecognized streamVersion: "+i);var s=e.read_shift(2);e.l+=2;var c,f,p,g,h="",E,A;s&16&&(c=Dd(e,t-e.l)),s&128&&(f=Dd(e,t-e.l)),(s&257)===257&&(p=Dd(e,t-e.l)),(s&257)===1&&(g=LE(e,t-e.l)),s&8&&(h=Dd(e,t-e.l)),s&32&&(E=e.read_shift(16)),s&64&&(A=ch(e)),e.l=t;var _=f||p||g||"";_&&h&&(_+="#"+h),_||(_="#"+h),s&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var w={Target:_};return E&&(w.guid=E),A&&(w.time=A),c&&(w.Tooltip=c),w}function zE(e){var a=Ne(512),t=0,i=e.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var s=i.indexOf("#"),c=s>-1?31:23;switch(i.charAt(0)){case"#":c=28;break;case".":c&=-3;break}a.write_shift(4,2),a.write_shift(4,c);var f=[8,6815827,6619237,4849780,83];for(t=0;t<f.length;++t)a.write_shift(4,f[t]);if(c==28)i=i.slice(1),xm(i,a);else if(c&2){for(f="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<f.length;++t)a.write_shift(1,parseInt(f[t],16));var p=s>-1?i.slice(0,s):i;for(a.write_shift(4,2*(p.length+1)),t=0;t<p.length;++t)a.write_shift(2,p.charCodeAt(t));a.write_shift(2,0),c&8&&xm(s>-1?i.slice(s+1):"",a)}else{for(f="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<f.length;++t)a.write_shift(1,parseInt(f[t],16));for(var g=0;i.slice(g*3,g*3+3)=="../"||i.slice(g*3,g*3+3)=="..\\";)++g;for(a.write_shift(2,g),a.write_shift(4,i.length-3*g+1),t=0;t<i.length-3*g;++t)a.write_shift(1,i.charCodeAt(t+3*g)&255);for(a.write_shift(1,0),a.write_shift(2,65535),a.write_shift(2,57005),t=0;t<6;++t)a.write_shift(4,0)}return a.slice(0,a.l)}function Kv(e){var a=e.read_shift(1),t=e.read_shift(1),i=e.read_shift(1),s=e.read_shift(1);return[a,t,i,s]}function Jv(e,a){var t=Kv(e);return t[3]=0,t}function Ci(e){var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(2);return{r:a,c:t,ixfe:i}}function _l(e,a,t,i){return i||(i=Ne(6)),i.write_shift(2,e),i.write_shift(2,a),i.write_shift(2,t||0),i}function UE(e){var a=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:a,flags:t}}function HE(e,a,t){return a===0?"":jl(e,a,t)}function $E(e,a,t){var i=t.biff>8?4:2,s=e.read_shift(i),c=e.read_shift(i,"i"),f=e.read_shift(i,"i");return[s,c,f]}function Qv(e){var a=e.read_shift(2),t=sh(e);return[a,t]}function GE(e,a,t){e.l+=4,a-=4;var i=e.l+a,s=l0(e,a,t),c=e.read_shift(2);if(i-=e.l,c!==i)throw new Error("Malformed AddinUdf: padding = "+i+" != "+c);return e.l+=c,s}function nf(e){var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);return{s:{c:i,r:a},e:{c:s,r:t}}}function Zv(e,a){return a||(a=Ne(8)),a.write_shift(2,e.s.r),a.write_shift(2,e.e.r),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c),a}function ey(e){var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1);return{s:{c:i,r:a},e:{c:s,r:t}}}var YE=ey;function ty(e){e.l+=4;var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(2);return e.l+=12,[t,a,i]}function WE(e){var a={};return e.l+=4,e.l+=16,a.fSharedNote=e.read_shift(2),e.l+=4,a}function VE(e){var a={};return e.l+=4,e.cf=e.read_shift(2),a}function Mr(e){e.l+=2,e.l+=e.read_shift(2)}var XE={0:Mr,4:Mr,5:Mr,6:Mr,7:VE,8:Mr,9:Mr,10:Mr,11:Mr,12:Mr,13:WE,14:Mr,15:Mr,16:Mr,17:Mr,18:Mr,19:Mr,20:Mr,21:ty};function qE(e,a){for(var t=e.l+a,i=[];e.l<t;){var s=e.read_shift(2);e.l-=2;try{i.push(XE[s](e,t-e.l))}catch{return e.l=t,i}}return e.l!=t&&(e.l=t),i}function Od(e,a){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),a-=2,a>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(a>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(a),t}function dh(e,a,t){var i=1536,s=16;switch(t.bookType){case"biff8":break;case"biff5":i=1280,s=8;break;case"biff4":i=4,s=6;break;case"biff3":i=3,s=6;break;case"biff2":i=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var c=Ne(s);return c.write_shift(2,i),c.write_shift(2,a),s>4&&c.write_shift(2,29282),s>6&&c.write_shift(2,1997),s>8&&(c.write_shift(2,49161),c.write_shift(2,1),c.write_shift(2,1798),c.write_shift(2,0)),c}function KE(e,a){return a===0||e.read_shift(2),1200}function JE(e,a,t){if(t.enc)return e.l+=a,"";var i=e.l,s=jl(e,0,t);return e.read_shift(a+i-e.l),s}function QE(e,a){var t=!a||a.biff==8,i=Ne(t?112:54);for(i.write_shift(a.biff==8?2:1,7),t&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(t?0:536870912));i.l<i.length;)i.write_shift(1,t?0:32);return i}function ZE(e,a,t){var i=t&&t.biff==8||a==2?e.read_shift(2):(e.l+=a,0);return{fDialog:i&16,fBelow:i&64,fRight:i&128}}function eT(e,a,t){var i=e.read_shift(4),s=e.read_shift(1)&3,c=e.read_shift(1);switch(c){case 0:c="Worksheet";break;case 1:c="Macrosheet";break;case 2:c="Chartsheet";break;case 6:c="VBAModule";break}var f=l0(e,0,t);return f.length===0&&(f="Sheet1"),{pos:i,hs:s,dt:c,name:f}}function tT(e,a){var t=!a||a.biff>=8?2:1,i=Ne(8+t*e.name.length);i.write_shift(4,e.pos),i.write_shift(1,e.hs||0),i.write_shift(1,e.dt),i.write_shift(1,e.name.length),a.biff>=8&&i.write_shift(1,1),i.write_shift(t*e.name.length,e.name,a.biff<8?"sbcs":"utf16le");var s=i.slice(0,i.l);return s.l=i.l,s}function aT(e,a){for(var t=e.l+a,i=e.read_shift(4),s=e.read_shift(4),c=[],f=0;f!=s&&e.l<t;++f)c.push(DE(e));return c.Count=i,c.Unique=s,c}function rT(e,a){var t=Ne(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var i=[],s=0;s<e.length;++s)i[s]=OE(e[s]);var c=br([t].concat(i));return c.parts=[t.length].concat(i.map(function(f){return f.length})),c}function nT(e,a){var t={};return t.dsst=e.read_shift(2),e.l+=a-2,t}function iT(e){var a={};a.r=e.read_shift(2),a.c=e.read_shift(2),a.cnt=e.read_shift(2)-a.c;var t=e.read_shift(2);e.l+=4;var i=e.read_shift(1);return e.l+=3,i&7&&(a.level=i&7),i&32&&(a.hidden=!0),i&64&&(a.hpt=t/20),a}function sT(e){var a=UE(e);if(a.type!=2211)throw new Error("Invalid Future Record "+a.type);var t=e.read_shift(4);return t!==0}function lT(e){return e.read_shift(2),e.read_shift(4)}function mm(e,a,t){var i=0;t&&t.biff==2||(i=e.read_shift(2));var s=e.read_shift(2);t&&t.biff==2&&(i=1-(s>>15),s&=32767);var c={Unsynced:i&1,DyZero:(i&2)>>1,ExAsc:(i&4)>>2,ExDsc:(i&8)>>3};return[c,s]}function oT(e){var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),p=e.read_shift(2),g=e.read_shift(2),h=e.read_shift(2);return{Pos:[a,t],Dim:[i,s],Flags:c,CurTab:f,FirstTab:p,Selected:g,TabRatio:h}}function cT(){var e=Ne(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function dT(e,a,t){if(t&&t.biff>=2&&t.biff<5)return{};var i=e.read_shift(2);return{RTL:i&64}}function fT(e){var a=Ne(18),t=1718;return e&&e.RTL&&(t|=64),a.write_shift(2,t),a.write_shift(4,0),a.write_shift(4,64),a.write_shift(4,0),a.write_shift(4,0),a}function uT(){}function pT(e,a,t){var i={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return i.name=l0(e,0,t),i}function hT(e,a){var t=e.name||"Arial",i=a&&a.biff==5,s=i?15+t.length:16+2*t.length,c=Ne(s);return c.write_shift(2,e.sz*20),c.write_shift(4,0),c.write_shift(2,400),c.write_shift(4,0),c.write_shift(2,0),c.write_shift(1,t.length),i||c.write_shift(1,1),c.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le"),c}function gT(e){var a=Ci(e);return a.isst=e.read_shift(4),a}function xT(e,a,t,i){var s=Ne(10);return _l(e,a,i,s),s.write_shift(4,t),s}function mT(e,a,t){t.biffguess&&t.biff==2&&(t.biff=5);var i=e.l+a,s=Ci(e);t.biff==2&&e.l++;var c=o0(e,i-e.l,t);return s.val=c,s}function vT(e,a,t,i,s){var c=!s||s.biff==8,f=Ne(8+ +c+(1+c)*t.length);return _l(e,a,i,f),f.write_shift(2,t.length),c&&f.write_shift(1,1),f.write_shift((1+c)*t.length,t,c?"utf16le":"sbcs"),f}function yT(e,a,t){var i=e.read_shift(2),s=jl(e,0,t);return[i,s]}function bT(e,a,t,i){var s=t&&t.biff==5;i||(i=Ne(s?3+a.length:5+2*a.length)),i.write_shift(2,e),i.write_shift(s?1:2,a.length),s||i.write_shift(1,1),i.write_shift((s?1:2)*a.length,a,s?"sbcs":"utf16le");var c=i.length>i.l?i.slice(0,i.l):i;return c.l==null&&(c.l=c.length),c}var ST=jl;function vm(e,a,t){var i=e.l+a,s=t.biff==8||!t.biff?4:2,c=e.read_shift(s),f=e.read_shift(s),p=e.read_shift(2),g=e.read_shift(2);return e.l=i,{s:{r:c,c:p},e:{r:f,c:g}}}function ET(e,a){var t=a.biff==8||!a.biff?4:2,i=Ne(2*t+6);return i.write_shift(t,e.s.r),i.write_shift(t,e.e.r+1),i.write_shift(2,e.s.c),i.write_shift(2,e.e.c+1),i.write_shift(2,0),i}function TT(e){var a=e.read_shift(2),t=e.read_shift(2),i=Qv(e);return{r:a,c:t,ixfe:i[0],rknum:i[1]}}function AT(e,a){for(var t=e.l+a-2,i=e.read_shift(2),s=e.read_shift(2),c=[];e.l<t;)c.push(Qv(e));if(e.l!==t)throw new Error("MulRK read error");var f=e.read_shift(2);if(c.length!=f-s+1)throw new Error("MulRK length mismatch");return{r:i,c:s,C:f,rkrec:c}}function _T(e,a){for(var t=e.l+a-2,i=e.read_shift(2),s=e.read_shift(2),c=[];e.l<t;)c.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var f=e.read_shift(2);if(c.length!=f-s+1)throw new Error("MulBlank length mismatch");return{r:i,c:s,C:f,ixfe:c}}function CT(e,a,t,i){var s={},c=e.read_shift(4),f=e.read_shift(4),p=e.read_shift(4),g=e.read_shift(2);return s.patternType=sE[p>>26],i.cellStyles&&(s.alc=c&7,s.fWrap=c>>3&1,s.alcV=c>>4&7,s.fJustLast=c>>7&1,s.trot=c>>8&255,s.cIndent=c>>16&15,s.fShrinkToFit=c>>20&1,s.iReadOrder=c>>22&2,s.fAtrNum=c>>26&1,s.fAtrFnt=c>>27&1,s.fAtrAlc=c>>28&1,s.fAtrBdr=c>>29&1,s.fAtrPat=c>>30&1,s.fAtrProt=c>>31&1,s.dgLeft=f&15,s.dgRight=f>>4&15,s.dgTop=f>>8&15,s.dgBottom=f>>12&15,s.icvLeft=f>>16&127,s.icvRight=f>>23&127,s.grbitDiag=f>>30&3,s.icvTop=p&127,s.icvBottom=p>>7&127,s.icvDiag=p>>14&127,s.dgDiag=p>>21&15,s.icvFore=g&127,s.icvBack=g>>7&127,s.fsxButton=g>>14&1),s}function kT(e,a,t){var i={};return i.ifnt=e.read_shift(2),i.numFmtId=e.read_shift(2),i.flags=e.read_shift(2),i.fStyle=i.flags>>2&1,a-=6,i.data=CT(e,a,i.fStyle,t),i}function ym(e,a,t,i){var s=t&&t.biff==5;i||(i=Ne(s?16:20)),i.write_shift(2,0),e.style?(i.write_shift(2,e.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,e.numFmtId||0),i.write_shift(2,a<<4));var c=0;return e.numFmtId>0&&s&&(c|=1024),i.write_shift(4,c),i.write_shift(4,0),s||i.write_shift(4,0),i.write_shift(2,0),i}function wT(e){e.l+=4;var a=[e.read_shift(2),e.read_shift(2)];if(a[0]!==0&&a[0]--,a[1]!==0&&a[1]--,a[0]>7||a[1]>7)throw new Error("Bad Gutters: "+a.join("|"));return a}function RT(e){var a=Ne(8);return a.write_shift(4,0),a.write_shift(2,0),a.write_shift(2,0),a}function bm(e,a,t){var i=Ci(e);(t.biff==2||a==9)&&++e.l;var s=jE(e);return i.val=s,i.t=s===!0||s===!1?"b":"e",i}function NT(e,a,t,i,s,c){var f=Ne(8);return _l(e,a,i,f),Xv(t,c,f),f}function FT(e,a,t){t.biffguess&&t.biff==2&&(t.biff=5);var i=Ci(e),s=Ur(e);return i.val=s,i}function jT(e,a,t,i){var s=Ne(14);return _l(e,a,i,s),Tl(t,s),s}var Sm=HE;function DT(e,a,t){var i=e.l+a,s=e.read_shift(2),c=e.read_shift(2);if(t.sbcch=c,c==1025||c==14849)return[c,s];if(c<1||c>255)throw new Error("Unexpected SupBook type: "+c);for(var f=Al(e,c),p=[];i>e.l;)p.push(o0(e));return[c,s,f,p]}function Em(e,a,t){var i=e.read_shift(2),s,c={fBuiltIn:i&1,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return t.sbcch===14849&&(s=GE(e,a-2,t)),c.body=s||e.read_shift(a-2),typeof s=="string"&&(c.Name=s),c}var OT=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Tm(e,a,t){var i=e.l+a,s=e.read_shift(2),c=e.read_shift(1),f=e.read_shift(1),p=e.read_shift(t&&t.biff==2?1:2),g=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),g=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var h=Al(e,f,t);s&32&&(h=OT[h.charCodeAt(0)]);var E=i-e.l;t&&t.biff==2&&--E;var A=i==e.l||p===0||!(E>0)?[]:q3(e,E,t,p);return{chKey:c,Name:h,itab:g,rgce:A}}function ay(e,a,t){if(t.biff<8)return IT(e,a,t);for(var i=[],s=e.l+a,c=e.read_shift(t.biff>8?4:2);c--!==0;)i.push($E(e,t.biff>8?12:6,t));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return i}function IT(e,a,t){e[e.l+1]==3&&e[e.l]++;var i=l0(e,a,t);return i.charCodeAt(0)==3?i.slice(1):i}function BT(e,a,t){if(t.biff<8){e.l+=a;return}var i=e.read_shift(2),s=e.read_shift(2),c=Al(e,i,t),f=Al(e,s,t);return[c,f]}function MT(e,a,t){var i=ey(e);e.l++;var s=e.read_shift(1);return a-=8,[K3(e,a,t),s,i]}function Am(e,a,t){var i=YE(e);switch(t.biff){case 2:e.l++,a-=7;break;case 3:case 4:e.l+=2,a-=8;break;default:e.l+=6,a-=12}return[i,V3(e,a,t)]}function LT(e){var a=e.read_shift(4)!==0,t=e.read_shift(4)!==0,i=e.read_shift(4);return[a,t,i]}function PT(e,a,t){if(!(t.biff<8)){var i=e.read_shift(2),s=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),p=jl(e,0,t);return t.biff<8&&e.read_shift(1),[{r:i,c:s},p,f,c]}}function zT(e,a,t){return PT(e,a,t)}function UT(e,a){for(var t=[],i=e.read_shift(2);i--;)t.push(nf(e));return t}function HT(e){var a=Ne(2+e.length*8);a.write_shift(2,e.length);for(var t=0;t<e.length;++t)Zv(e[t],a);return a}function $T(e,a,t){if(t&&t.biff<8)return YT(e,a,t);var i=ty(e),s=qE(e,a-22,i[1]);return{cmo:i,ft:s}}var GT={8:function(e,a){var t=e.l+a;e.l+=10;var i=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=t,{fmt:i}}};function YT(e,a,t){e.l+=4;var i=e.read_shift(2),s=e.read_shift(2),c=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,a-=36;var f=[];return f.push((GT[i]||$r)(e,a,t)),{cmo:[s,i,c],ft:f}}function WT(e,a,t){var i=e.l,s="";try{e.l+=4;var c=(t.lastobj||{cmo:[0,0]}).cmo[1],f;[0,5,7,11,12,14].indexOf(c)==-1?e.l+=6:f=IE(e,6,t);var p=e.read_shift(2);e.read_shift(2),ir(e,2);var g=e.read_shift(2);e.l+=g;for(var h=1;h<e.lens.length-1;++h){if(e.l-i!=e.lens[h])throw new Error("TxO: bad continue record");var E=e[e.l],A=Al(e,e.lens[h+1]-e.lens[h]-1);if(s+=A,s.length>=(E?p:2*p))break}if(s.length!==p&&s.length!==p*2)throw new Error("cchText: "+p+" != "+s.length);return e.l=i+a,{t:s}}catch{return e.l=i+a,{t:s}}}function VT(e,a){var t=nf(e);e.l+=16;var i=PE(e,a-24);return[t,i]}function XT(e){var a=Ne(24),t=Ia(e[0]);a.write_shift(2,t.r),a.write_shift(2,t.r),a.write_shift(2,t.c),a.write_shift(2,t.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)a.write_shift(1,parseInt(i[s],16));return br([a,zE(e[1])])}function qT(e,a){e.read_shift(2);var t=nf(e),i=e.read_shift((a-10)/2,"dbcs-cont");return i=i.replace(Qr,""),[t,i]}function KT(e){var a=e[1].Tooltip,t=Ne(10+2*(a.length+1));t.write_shift(2,2048);var i=Ia(e[0]);t.write_shift(2,i.r),t.write_shift(2,i.r),t.write_shift(2,i.c),t.write_shift(2,i.c);for(var s=0;s<a.length;++s)t.write_shift(2,a.charCodeAt(s));return t.write_shift(2,0),t}function JT(e){var a=[0,0],t;return t=e.read_shift(2),a[0]=om[t]||t,t=e.read_shift(2),a[1]=om[t]||t,a}function QT(e){return e||(e=Ne(4)),e.write_shift(2,1),e.write_shift(2,1),e}function ZT(e){for(var a=e.read_shift(2),t=[];a-- >0;)t.push(Jv(e));return t}function eA(e){for(var a=e.read_shift(2),t=[];a-- >0;)t.push(Jv(e));return t}function tA(e){e.l+=2;var a={cxfs:0,crc:0};return a.cxfs=e.read_shift(2),a.crc=e.read_shift(4),a}function ry(e,a,t){if(!t.cellStyles)return $r(e,a);var i=t&&t.biff>=12?4:2,s=e.read_shift(i),c=e.read_shift(i),f=e.read_shift(i),p=e.read_shift(i),g=e.read_shift(2);i==2&&(e.l+=2);var h={s,e:c,w:f,ixfe:p,flags:g};return(t.biff>=5||!t.biff)&&(h.level=g>>8&7),h}function aA(e,a){var t=Ne(12);t.write_shift(2,a),t.write_shift(2,a),t.write_shift(2,e.width*256),t.write_shift(2,0);var i=0;return e.hidden&&(i|=1),t.write_shift(1,i),i=e.level||0,t.write_shift(1,i),t.write_shift(2,0),t}function rA(e,a){var t={};return a<32||(e.l+=16,t.header=Ur(e),t.footer=Ur(e),e.l+=2),t}function nA(e,a,t){var i={area:!1};if(t.biff!=5)return e.l+=a,i;var s=e.read_shift(1);return e.l+=3,s&16&&(i.area=!0),i}function iA(e){for(var a=Ne(2*e),t=0;t<e;++t)a.write_shift(2,t+1);return a}var sA=Ci,lA=Vv,oA=o0;function cA(e){var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(4),s={fmt:a,env:t,len:i,data:e.slice(e.l,e.l+i)};return e.l+=i,s}function dA(e,a,t){t.biffguess&&t.biff==5&&(t.biff=2);var i=Ci(e);++e.l;var s=jl(e,a-7,t);return i.t="str",i.val=s,i}function fA(e){var a=Ci(e);++e.l;var t=Ur(e);return a.t="n",a.val=t,a}function uA(e,a,t){var i=Ne(15);return u0(i,e,a),i.write_shift(8,t,"f"),i}function pA(e){var a=Ci(e);++e.l;var t=e.read_shift(2);return a.t="n",a.val=t,a}function hA(e,a,t){var i=Ne(9);return u0(i,e,a),i.write_shift(2,t),i}function gA(e){var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,"sbcs-cont")}function xA(e,a){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=a-13}function mA(e,a,t){var i=e.l+a,s=Ci(e),c=e.read_shift(2),f=Al(e,c,t);return e.l=i,s.t="str",s.val=f,s}var vA=[2,3,48,49,131,139,140,245],Bp=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},a=tf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(p,g){var h=[],E=Ls(1);switch(g.type){case"base64":E=An(Cn(p));break;case"binary":E=An(p);break;case"buffer":case"array":E=p;break}Fr(E,0);var A=E.read_shift(1),_=!!(A&136),w=!1,N=!1;switch(A){case 2:break;case 3:break;case 48:w=!0,_=!0;break;case 49:w=!0,_=!0;break;case 131:break;case 139:break;case 140:N=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+A.toString(16))}var k=0,F=521;A==2&&(k=E.read_shift(2)),E.l+=3,A!=2&&(k=E.read_shift(4)),k>1048576&&(k=1e6),A!=2&&(F=E.read_shift(2));var z=E.read_shift(2),q=g.codepage||1252;A!=2&&(E.l+=16,E.read_shift(1),E[E.l]!==0&&(q=e[E[E.l]]),E.l+=1,E.l+=2),N&&(E.l+=36);for(var B=[],ie={},se=Math.min(E.length,A==2?521:F-10-(w?264:0)),ne=N?32:11;E.l<se&&E[E.l]!=13;)switch(ie={},ie.name=Yc.utils.decode(q,E.slice(E.l,E.l+ne)).replace(/[\u0000\r\n].*$/g,""),E.l+=ne,ie.type=String.fromCharCode(E.read_shift(1)),A!=2&&!N&&(ie.offset=E.read_shift(4)),ie.len=E.read_shift(1),A==2&&(ie.offset=E.read_shift(2)),ie.dec=E.read_shift(1),ie.name.length&&B.push(ie),A!=2&&(E.l+=N?13:14),ie.type){case"B":(!w||ie.len!=8)&&g.WTF&&console.log("Skipping "+ie.name+":"+ie.type);break;case"G":case"P":g.WTF&&console.log("Skipping "+ie.name+":"+ie.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+ie.type)}if(E[E.l]!==13&&(E.l=F-1),E.read_shift(1)!==13)throw new Error("DBF Terminator not found "+E.l+" "+E[E.l]);E.l=F;var H=0,le=0;for(h[0]=[],le=0;le!=B.length;++le)h[0][le]=B[le].name;for(;k-- >0;){if(E[E.l]===42){E.l+=z;continue}for(++E.l,h[++H]=[],le=0,le=0;le!=B.length;++le){var oe=E.slice(E.l,E.l+B[le].len);E.l+=B[le].len,Fr(oe,0);var m=Yc.utils.decode(q,oe);switch(B[le].type){case"C":m.trim().length&&(h[H][le]=m.replace(/\s+$/,""));break;case"D":m.length===8?h[H][le]=new Date(+m.slice(0,4),+m.slice(4,6)-1,+m.slice(6,8)):h[H][le]=m;break;case"F":h[H][le]=parseFloat(m.trim());break;case"+":case"I":h[H][le]=N?oe.read_shift(-4,"i")^2147483648:oe.read_shift(4,"i");break;case"L":switch(m.trim().toUpperCase()){case"Y":case"T":h[H][le]=!0;break;case"N":case"F":h[H][le]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+m+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+A.toString(16));h[H][le]="##MEMO##"+(N?parseInt(m.trim(),10):oe.read_shift(4));break;case"N":m=m.replace(/\u0000/g,"").trim(),m&&m!="."&&(h[H][le]=+m||0);break;case"@":h[H][le]=new Date(oe.read_shift(-8,"f")-621356832e5);break;case"T":h[H][le]=new Date((oe.read_shift(4)-2440588)*864e5+oe.read_shift(4));break;case"Y":h[H][le]=oe.read_shift(4,"i")/1e4+oe.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[H][le]=-oe.read_shift(-8,"f");break;case"B":if(w&&B[le].len==8){h[H][le]=oe.read_shift(8,"f");break}case"G":case"P":oe.l+=B[le].len;break;case"0":if(B[le].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+B[le].type)}}}if(A!=2&&E.l<E.length&&E[E.l++]!=26)throw new Error("DBF EOF Marker missing "+(E.l-1)+" of "+E.length+" "+E[E.l-1].toString(16));return g&&g.sheetRows&&(h=h.slice(0,g.sheetRows)),g.DBF=B,h}function i(p,g){var h=g||{};h.dateNF||(h.dateNF="yyyymmdd");var E=jo(t(p,h),h);return E["!cols"]=h.DBF.map(function(A){return{wch:A.len,DBF:A}}),delete h.DBF,E}function s(p,g){try{return $s(i(p,g),g)}catch(h){if(g&&g.WTF)throw h}return{SheetNames:[],Sheets:{}}}var c={B:8,C:250,L:1,D:8,"?":0,"":0};function f(p,g){var h=g||{};if(+h.codepage>=0&&ii(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var E=fn(),A=Qd(p,{header:1,raw:!0,cellDates:!0}),_=A[0],w=A.slice(1),N=p["!cols"]||[],k=0,F=0,z=0,q=1;for(k=0;k<_.length;++k){if(((N[k]||{}).DBF||{}).name){_[k]=N[k].DBF.name,++z;continue}if(_[k]!=null){if(++z,typeof _[k]=="number"&&(_[k]=_[k].toString(10)),typeof _[k]!="string")throw new Error("DBF Invalid column name "+_[k]+" |"+typeof _[k]+"|");if(_.indexOf(_[k])!==k){for(F=0;F<1024;++F)if(_.indexOf(_[k]+"_"+F)==-1){_[k]+="_"+F;break}}}}var B=Kt(p["!ref"]),ie=[],se=[],ne=[];for(k=0;k<=B.e.c-B.s.c;++k){var H="",le="",oe=0,m=[];for(F=0;F<w.length;++F)w[F][k]!=null&&m.push(w[F][k]);if(m.length==0||_[k]==null){ie[k]="?";continue}for(F=0;F<m.length;++F){switch(typeof m[F]){case"number":le="B";break;case"string":le="C";break;case"boolean":le="L";break;case"object":le=m[F]instanceof Date?"D":"C";break;default:le="C"}oe=Math.max(oe,String(m[F]).length),H=H&&H!=le?"C":le}oe>250&&(oe=250),le=((N[k]||{}).DBF||{}).type,le=="C"&&N[k].DBF.len>oe&&(oe=N[k].DBF.len),H=="B"&&le=="N"&&(H="N",ne[k]=N[k].DBF.dec,oe=N[k].DBF.len),se[k]=H=="C"||le=="N"?oe:c[H]||0,q+=se[k],ie[k]=H}var Se=E.next(32);for(Se.write_shift(4,318902576),Se.write_shift(4,w.length),Se.write_shift(2,296+32*z),Se.write_shift(2,q),k=0;k<4;++k)Se.write_shift(4,0);for(Se.write_shift(4,0|(+a[Wm]||3)<<8),k=0,F=0;k<_.length;++k)if(_[k]!=null){var ue=E.next(32),Pe=(_[k].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ue.write_shift(1,Pe,"sbcs"),ue.write_shift(1,ie[k]=="?"?"C":ie[k],"sbcs"),ue.write_shift(4,F),ue.write_shift(1,se[k]||c[ie[k]]||0),ue.write_shift(1,ne[k]||0),ue.write_shift(1,2),ue.write_shift(4,0),ue.write_shift(1,0),ue.write_shift(4,0),ue.write_shift(4,0),F+=se[k]||c[ie[k]]||0}var tt=E.next(264);for(tt.write_shift(4,13),k=0;k<65;++k)tt.write_shift(4,0);for(k=0;k<w.length;++k){var ke=E.next(q);for(ke.write_shift(1,0),F=0;F<_.length;++F)if(_[F]!=null)switch(ie[F]){case"L":ke.write_shift(1,w[k][F]==null?63:w[k][F]?84:70);break;case"B":ke.write_shift(8,w[k][F]||0,"f");break;case"N":var de="0";for(typeof w[k][F]=="number"&&(de=w[k][F].toFixed(ne[F]||0)),z=0;z<se[F]-de.length;++z)ke.write_shift(1,32);ke.write_shift(1,de,"sbcs");break;case"D":w[k][F]?(ke.write_shift(4,("0000"+w[k][F].getFullYear()).slice(-4),"sbcs"),ke.write_shift(2,("00"+(w[k][F].getMonth()+1)).slice(-2),"sbcs"),ke.write_shift(2,("00"+w[k][F].getDate()).slice(-2),"sbcs")):ke.write_shift(8,"00000000","sbcs");break;case"C":var _e=String(w[k][F]!=null?w[k][F]:"").slice(0,se[F]);for(ke.write_shift(1,_e,"sbcs"),z=0;z<se[F]-_e.length;++z)ke.write_shift(1,32);break}}return E.next(1).write_shift(1,26),E.end()}return{to_workbook:s,to_sheet:i,from_sheet:f}})(),ny=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},a=new RegExp("\x1BN("+Ua(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(_,w){var N=e[w];return typeof N=="number"?Ix(N):N},i=function(_,w,N){var k=w.charCodeAt(0)-32<<4|N.charCodeAt(0)-48;return k==59?_:Ix(k)};e["|"]=254;function s(_,w){switch(w.type){case"base64":return c(Cn(_),w);case"binary":return c(_,w);case"buffer":return c(It&&Buffer.isBuffer(_)?_.toString("binary"):Hs(_),w);case"array":return c(El(_),w)}throw new Error("Unrecognized type "+w.type)}function c(_,w){var N=_.split(/[\n\r]+/),k=-1,F=-1,z=0,q=0,B=[],ie=[],se=null,ne={},H=[],le=[],oe=[],m=0,Se;for(+w.codepage>=0&&ii(+w.codepage);z!==N.length;++z){m=0;var ue=N[z].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(a,t),Pe=ue.replace(/;;/g,"\0").split(";").map(function(te){return te.replace(/\u0000/g,";")}),tt=Pe[0],ke;if(ue.length>0)switch(tt){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Pe[1].charAt(0)=="P"&&ie.push(ue.slice(3).replace(/;;/g,";"));break;case"C":var de=!1,_e=!1,Ze=!1,fe=!1,Je=-1,ee=-1;for(q=1;q<Pe.length;++q)switch(Pe[q].charAt(0)){case"A":break;case"X":F=parseInt(Pe[q].slice(1))-1,_e=!0;break;case"Y":for(k=parseInt(Pe[q].slice(1))-1,_e||(F=0),Se=B.length;Se<=k;++Se)B[Se]=[];break;case"K":ke=Pe[q].slice(1),ke.charAt(0)==='"'?ke=ke.slice(1,ke.length-1):ke==="TRUE"?ke=!0:ke==="FALSE"?ke=!1:isNaN(li(ke))?isNaN(ko(ke).getDate())||(ke=ka(ke)):(ke=li(ke),se!==null&&No(se)&&(ke=rf(ke))),de=!0;break;case"E":fe=!0;var O=_o(Pe[q].slice(1),{r:k,c:F});B[k][F]=[B[k][F],O];break;case"S":Ze=!0,B[k][F]=[B[k][F],"S5S"];break;case"G":break;case"R":Je=parseInt(Pe[q].slice(1))-1;break;case"C":ee=parseInt(Pe[q].slice(1))-1;break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+ue)}if(de&&(B[k][F]&&B[k][F].length==2?B[k][F][0]=ke:B[k][F]=ke,se=null),Ze){if(fe)throw new Error("SYLK shared formula cannot have own formula");var L=Je>-1&&B[Je][ee];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");B[k][F][1]=Ey(L[1],{r:k-Je,c:F-ee})}break;case"F":var K=0;for(q=1;q<Pe.length;++q)switch(Pe[q].charAt(0)){case"X":F=parseInt(Pe[q].slice(1))-1,++K;break;case"Y":for(k=parseInt(Pe[q].slice(1))-1,Se=B.length;Se<=k;++Se)B[Se]=[];break;case"M":m=parseInt(Pe[q].slice(1))/20;break;case"F":break;case"G":break;case"P":se=ie[parseInt(Pe[q].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(oe=Pe[q].slice(1).split(" "),Se=parseInt(oe[0],10);Se<=parseInt(oe[1],10);++Se)m=parseInt(oe[2],10),le[Se-1]=m===0?{hidden:!0}:{wch:m},Ps(le[Se-1]);break;case"C":F=parseInt(Pe[q].slice(1))-1,le[F]||(le[F]={});break;case"R":k=parseInt(Pe[q].slice(1))-1,H[k]||(H[k]={}),m>0?(H[k].hpt=m,H[k].hpx=Ro(m)):m===0&&(H[k].hidden=!0);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+ue)}K<1&&(se=null);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+ue)}}return H.length>0&&(ne["!rows"]=H),le.length>0&&(ne["!cols"]=le),w&&w.sheetRows&&(B=B.slice(0,w.sheetRows)),[B,ne]}function f(_,w){var N=s(_,w),k=N[0],F=N[1],z=jo(k,w);return Ua(F).forEach(function(q){z[q]=F[q]}),z}function p(_,w){return $s(f(_,w),w)}function g(_,w,N,k){var F="C;Y"+(N+1)+";X"+(k+1)+";K";switch(_.t){case"n":F+=_.v||0,_.f&&!_.F&&(F+=";E"+xh(_.f,{r:N,c:k}));break;case"b":F+=_.v?"TRUE":"FALSE";break;case"e":F+=_.w||_.v;break;case"d":F+='"'+(_.w||_.v)+'"';break;case"s":F+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return F}function h(_,w){w.forEach(function(N,k){var F="F;W"+(k+1)+" "+(k+1)+" ";N.hidden?F+="0":(typeof N.width=="number"&&!N.wpx&&(N.wpx=Zc(N.width)),typeof N.wpx=="number"&&!N.wch&&(N.wch=e0(N.wpx)),typeof N.wch=="number"&&(F+=Math.round(N.wch))),F.charAt(F.length-1)!=" "&&_.push(F)})}function E(_,w){w.forEach(function(N,k){var F="F;";N.hidden?F+="M0;":N.hpt?F+="M"+20*N.hpt+";":N.hpx&&(F+="M"+20*t0(N.hpx)+";"),F.length>2&&_.push(F+"R"+(k+1))})}function A(_,w){var N=["ID;PWXL;N;E"],k=[],F=Kt(_["!ref"]),z,q=Array.isArray(_),B=`\r
`;N.push("P;PGeneral"),N.push("F;P0;DG0G8;M255"),_["!cols"]&&h(N,_["!cols"]),_["!rows"]&&E(N,_["!rows"]),N.push("B;Y"+(F.e.r-F.s.r+1)+";X"+(F.e.c-F.s.c+1)+";D"+[F.s.c,F.s.r,F.e.c,F.e.r].join(" "));for(var ie=F.s.r;ie<=F.e.r;++ie)for(var se=F.s.c;se<=F.e.c;++se){var ne=vt({r:ie,c:se});z=q?(_[ie]||[])[se]:_[ne],!(!z||z.v==null&&(!z.f||z.F))&&k.push(g(z,_,ie,se))}return N.join(B)+B+k.join(B)+B+"E"+B}return{to_workbook:p,to_sheet:f,from_sheet:A}})(),iy=(function(){function e(c,f){switch(f.type){case"base64":return a(Cn(c),f);case"binary":return a(c,f);case"buffer":return a(It&&Buffer.isBuffer(c)?c.toString("binary"):Hs(c),f);case"array":return a(El(c),f)}throw new Error("Unrecognized type "+f.type)}function a(c,f){for(var p=c.split(`
`),g=-1,h=-1,E=0,A=[];E!==p.length;++E){if(p[E].trim()==="BOT"){A[++g]=[],h=0;continue}if(!(g<0)){var _=p[E].trim().split(","),w=_[0],N=_[1];++E;for(var k=p[E]||"";(k.match(/["]/g)||[]).length&1&&E<p.length-1;)k+=`
`+p[++E];switch(k=k.trim(),+w){case-1:if(k==="BOT"){A[++g]=[],h=0;continue}else if(k!=="EOD")throw new Error("Unrecognized DIF special command "+k);break;case 0:k==="TRUE"?A[g][h]=!0:k==="FALSE"?A[g][h]=!1:isNaN(li(N))?isNaN(ko(N).getDate())?A[g][h]=N:A[g][h]=ka(N):A[g][h]=li(N),++h;break;case 1:k=k.slice(1,k.length-1),k=k.replace(/""/g,'"'),k&&k.match(/^=".*"$/)&&(k=k.slice(2,-1)),A[g][h++]=k!==""?k:null;break}if(k==="EOD")break}}return f&&f.sheetRows&&(A=A.slice(0,f.sheetRows)),A}function t(c,f){return jo(e(c,f),f)}function i(c,f){return $s(t(c,f),f)}var s=(function(){var c=function(g,h,E,A,_){g.push(h),g.push(E+","+A),g.push('"'+_.replace(/"/g,'""')+'"')},f=function(g,h,E,A){g.push(h+","+E),g.push(h==1?'"'+A.replace(/"/g,'""')+'"':A)};return function(g){var h=[],E=Kt(g["!ref"]),A,_=Array.isArray(g);c(h,"TABLE",0,1,"sheetjs"),c(h,"VECTORS",0,E.e.r-E.s.r+1,""),c(h,"TUPLES",0,E.e.c-E.s.c+1,""),c(h,"DATA",0,0,"");for(var w=E.s.r;w<=E.e.r;++w){f(h,-1,0,"BOT");for(var N=E.s.c;N<=E.e.c;++N){var k=vt({r:w,c:N});if(A=_?(g[w]||[])[N]:g[k],!A){f(h,1,0,"");continue}switch(A.t){case"n":var F=A.w;!F&&A.v!=null&&(F=A.v),F==null?A.f&&!A.F?f(h,1,0,"="+A.f):f(h,1,0,""):f(h,0,F,"V");break;case"b":f(h,0,A.v?1:0,A.v?"TRUE":"FALSE");break;case"s":f(h,1,0,isNaN(A.v)?A.v:'="'+A.v+'"');break;case"d":A.w||(A.w=Wn(A.z||mt[14],pr(ka(A.v)))),f(h,0,A.w,"V");break;default:f(h,1,0,"")}}}f(h,-1,0,"EOD");var z=`\r
`,q=h.join(z);return q}})();return{to_workbook:i,to_sheet:t,from_sheet:s}})(),sy=(function(){function e(A){return A.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function a(A){return A.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(A,_){for(var w=A.split(`
`),N=-1,k=-1,F=0,z=[];F!==w.length;++F){var q=w[F].trim().split(":");if(q[0]==="cell"){var B=Ia(q[1]);if(z.length<=B.r)for(N=z.length;N<=B.r;++N)z[N]||(z[N]=[]);switch(N=B.r,k=B.c,q[2]){case"t":z[N][k]=e(q[3]);break;case"v":z[N][k]=+q[3];break;case"vtf":var ie=q[q.length-1];case"vtc":q[3]==="nl"?z[N][k]=!!+q[4]:z[N][k]=+q[4],q[2]=="vtf"&&(z[N][k]=[z[N][k],ie])}}}return _&&_.sheetRows&&(z=z.slice(0,_.sheetRows)),z}function i(A,_){return jo(t(A,_),_)}function s(A,_){return $s(i(A,_),_)}var c=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),f=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,p=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),g="--SocialCalcSpreadsheetControlSave--";function h(A){if(!A||!A["!ref"])return"";for(var _=[],w=[],N,k="",F=un(A["!ref"]),z=Array.isArray(A),q=F.s.r;q<=F.e.r;++q)for(var B=F.s.c;B<=F.e.c;++B)if(k=vt({r:q,c:B}),N=z?(A[q]||[])[B]:A[k],!(!N||N.v==null||N.t==="z")){switch(w=["cell",k,"t"],N.t){case"s":case"str":w.push(a(N.v));break;case"n":N.f?(w[2]="vtf",w[3]="n",w[4]=N.v,w[5]=a(N.f)):(w[2]="v",w[3]=N.v);break;case"b":w[2]="vt"+(N.f?"f":"c"),w[3]="nl",w[4]=N.v?"1":"0",w[5]=a(N.f||(N.v?"TRUE":"FALSE"));break;case"d":var ie=pr(ka(N.v));w[2]="vtc",w[3]="nd",w[4]=""+ie,w[5]=N.w||Wn(N.z||mt[14],ie);break;case"e":continue}_.push(w.join(":"))}return _.push("sheet:c:"+(F.e.c-F.s.c+1)+":r:"+(F.e.r-F.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function E(A){return[c,f,p,f,h(A),g].join(`
`)}return{to_workbook:s,to_sheet:i,from_sheet:E}})(),wo=(function(){function e(E,A,_,w,N){N.raw?A[_][w]=E:E===""||(E==="TRUE"?A[_][w]=!0:E==="FALSE"?A[_][w]=!1:isNaN(li(E))?isNaN(ko(E).getDate())?A[_][w]=E:A[_][w]=ka(E):A[_][w]=li(E))}function a(E,A){var _=A||{},w=[];if(!E||E.length===0)return w;for(var N=E.split(/[\r\n]/),k=N.length-1;k>=0&&N[k].length===0;)--k;for(var F=10,z=0,q=0;q<=k;++q)z=N[q].indexOf(" "),z==-1?z=N[q].length:z++,F=Math.max(F,z);for(q=0;q<=k;++q){w[q]=[];var B=0;for(e(N[q].slice(0,F).trim(),w,q,B,_),B=1;B<=(N[q].length-F)/10+1;++B)e(N[q].slice(F+(B-1)*10,F+B*10).trim(),w,q,B,_)}return _.sheetRows&&(w=w.slice(0,_.sheetRows)),w}var t={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function s(E){for(var A={},_=!1,w=0,N=0;w<E.length;++w)(N=E.charCodeAt(w))==34?_=!_:!_&&N in t&&(A[N]=(A[N]||0)+1);N=[];for(w in A)Object.prototype.hasOwnProperty.call(A,w)&&N.push([A[w],w]);if(!N.length){A=i;for(w in A)Object.prototype.hasOwnProperty.call(A,w)&&N.push([A[w],w])}return N.sort(function(k,F){return k[0]-F[0]||i[k[1]]-i[F[1]]}),t[N.pop()[1]]||44}function c(E,A){var _=A||{},w="",N=_.dense?[]:{},k={s:{c:0,r:0},e:{c:0,r:0}};E.slice(0,4)=="sep="?E.charCodeAt(5)==13&&E.charCodeAt(6)==10?(w=E.charAt(4),E=E.slice(7)):E.charCodeAt(5)==13||E.charCodeAt(5)==10?(w=E.charAt(4),E=E.slice(6)):w=s(E.slice(0,1024)):_&&_.FS?w=_.FS:w=s(E.slice(0,1024));var F=0,z=0,q=0,B=0,ie=0,se=w.charCodeAt(0),ne=!1,H=0,le=E.charCodeAt(0);E=E.replace(/\r\n/mg,`
`);var oe=_.dateNF!=null?nS(_.dateNF):null;function m(){var Se=E.slice(B,ie),ue={};if(Se.charAt(0)=='"'&&Se.charAt(Se.length-1)=='"'&&(Se=Se.slice(1,-1).replace(/""/g,'"')),Se.length===0)ue.t="z";else if(_.raw)ue.t="s",ue.v=Se;else if(Se.trim().length===0)ue.t="s",ue.v=Se;else if(Se.charCodeAt(0)==61)Se.charCodeAt(1)==34&&Se.charCodeAt(Se.length-1)==34?(ue.t="s",ue.v=Se.slice(2,-1).replace(/""/g,'"')):D4(Se)?(ue.t="n",ue.f=Se.slice(1)):(ue.t="s",ue.v=Se);else if(Se=="TRUE")ue.t="b",ue.v=!0;else if(Se=="FALSE")ue.t="b",ue.v=!1;else if(!isNaN(q=li(Se)))ue.t="n",_.cellText!==!1&&(ue.w=Se),ue.v=q;else if(!isNaN(ko(Se).getDate())||oe&&Se.match(oe)){ue.z=_.dateNF||mt[14];var Pe=0;oe&&Se.match(oe)&&(Se=iS(Se,_.dateNF,Se.match(oe)||[]),Pe=1),_.cellDates?(ue.t="d",ue.v=ka(Se,Pe)):(ue.t="n",ue.v=pr(ka(Se,Pe))),_.cellText!==!1&&(ue.w=Wn(ue.z,ue.v instanceof Date?pr(ue.v):ue.v)),_.cellNF||delete ue.z}else ue.t="s",ue.v=Se;if(ue.t=="z"||(_.dense?(N[F]||(N[F]=[]),N[F][z]=ue):N[vt({c:z,r:F})]=ue),B=ie+1,le=E.charCodeAt(B),k.e.c<z&&(k.e.c=z),k.e.r<F&&(k.e.r=F),H==se)++z;else if(z=0,++F,_.sheetRows&&_.sheetRows<=F)return!0}e:for(;ie<E.length;++ie)switch(H=E.charCodeAt(ie)){case 34:le===34&&(ne=!ne);break;case se:case 10:case 13:if(!ne&&m())break e;break}return ie-B>0&&m(),N["!ref"]=wt(k),N}function f(E,A){return!(A&&A.PRN)||A.FS||E.slice(0,4)=="sep="||E.indexOf("	")>=0||E.indexOf(",")>=0||E.indexOf(";")>=0?c(E,A):jo(a(E,A),A)}function p(E,A){var _="",w=A.type=="string"?[0,0,0,0]:Ah(E,A);switch(A.type){case"base64":_=Cn(E);break;case"binary":_=E;break;case"buffer":A.codepage==65001?_=E.toString("utf8"):A.codepage&&typeof Yc<"u"||(_=It&&Buffer.isBuffer(E)?E.toString("binary"):Hs(E));break;case"array":_=El(E);break;case"string":_=E;break;default:throw new Error("Unrecognized type "+A.type)}return w[0]==239&&w[1]==187&&w[2]==191?_=ga(_.slice(3)):A.type!="string"&&A.type!="buffer"&&A.codepage==65001?_=ga(_):A.type=="binary"&&typeof Yc<"u",_.slice(0,19)=="socialcalc:version:"?sy.to_sheet(A.type=="string"?_:ga(_),A):f(_,A)}function g(E,A){return $s(p(E,A),A)}function h(E){for(var A=[],_=Kt(E["!ref"]),w,N=Array.isArray(E),k=_.s.r;k<=_.e.r;++k){for(var F=[],z=_.s.c;z<=_.e.c;++z){var q=vt({r:k,c:z});if(w=N?(E[k]||[])[z]:E[q],!w||w.v==null){F.push("          ");continue}for(var B=(w.w||(es(w),w.w)||"").slice(0,10);B.length<10;)B+=" ";F.push(B+(z===0?" ":""))}A.push(F.join(""))}return A.join(`
`)}return{to_workbook:g,to_sheet:p,from_sheet:h}})();function yA(e,a){var t=a||{},i=!!t.WTF;t.WTF=!0;try{var s=ny.to_workbook(e,t);return t.WTF=i,s}catch(c){if(t.WTF=i,!c.message.match(/SYLK bad record ID/)&&i)throw c;return wo.to_workbook(e,a)}}var yl=(function(){function e(O,L,K){if(O){Fr(O,O.l||0);for(var te=K.Enum||Je;O.l<O.length;){var he=O.read_shift(2),Oe=te[he]||te[65535],Ue=O.read_shift(2),Ie=O.l+Ue,He=Oe.f&&Oe.f(O,Ue,K);if(O.l=Ie,L(He,Oe,he))return}}}function a(O,L){switch(L.type){case"base64":return t(An(Cn(O)),L);case"binary":return t(An(O),L);case"buffer":case"array":return t(O,L)}throw"Unsupported type "+L.type}function t(O,L){if(!O)return O;var K=L||{},te=K.dense?[]:{},he="Sheet1",Oe="",Ue=0,Ie={},He=[],gt=[],Z={s:{r:0,c:0},e:{r:0,c:0}},aa=K.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)K.Enum=Je,e(O,function(et,ra,Ba){switch(Ba){case 0:K.vers=et,et>=4096&&(K.qpro=!0);break;case 6:Z=et;break;case 204:et&&(Oe=et);break;case 222:Oe=et;break;case 15:case 51:K.qpro||(et[1].v=et[1].v.slice(1));case 13:case 14:case 16:Ba==14&&(et[2]&112)==112&&(et[2]&15)>1&&(et[2]&15)<15&&(et[1].z=K.dateNF||mt[14],K.cellDates&&(et[1].t="d",et[1].v=rf(et[1].v))),K.qpro&&et[3]>Ue&&(te["!ref"]=wt(Z),Ie[he]=te,He.push(he),te=K.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},Ue=et[3],he=Oe||"Sheet"+(Ue+1),Oe="");var Qa=K.dense?(te[et[0].r]||[])[et[0].c]:te[vt(et[0])];if(Qa){Qa.t=et[1].t,Qa.v=et[1].v,et[1].z!=null&&(Qa.z=et[1].z),et[1].f!=null&&(Qa.f=et[1].f);break}K.dense?(te[et[0].r]||(te[et[0].r]=[]),te[et[0].r][et[0].c]=et[1]):te[vt(et[0])]=et[1];break}},K);else if(O[2]==26||O[2]==14)K.Enum=ee,O[2]==14&&(K.qpro=!0,O.l=0),e(O,function(et,ra,Ba){switch(Ba){case 204:he=et;break;case 22:et[1].v=et[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(et[3]>Ue&&(te["!ref"]=wt(Z),Ie[he]=te,He.push(he),te=K.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},Ue=et[3],he="Sheet"+(Ue+1)),aa>0&&et[0].r>=aa)break;K.dense?(te[et[0].r]||(te[et[0].r]=[]),te[et[0].r][et[0].c]=et[1]):te[vt(et[0])]=et[1],Z.e.c<et[0].c&&(Z.e.c=et[0].c),Z.e.r<et[0].r&&(Z.e.r=et[0].r);break;case 27:et[14e3]&&(gt[et[14e3][0]]=et[14e3][1]);break;case 1537:gt[et[0]]=et[1],et[0]==Ue&&(he=et[1]);break}},K);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(te["!ref"]=wt(Z),Ie[Oe||he]=te,He.push(Oe||he),!gt.length)return{SheetNames:He,Sheets:Ie};for(var St={},Mt=[],yt=0;yt<gt.length;++yt)Ie[He[yt]]?(Mt.push(gt[yt]||He[yt]),St[gt[yt]]=Ie[gt[yt]]||Ie[He[yt]]):(Mt.push(gt[yt]),St[gt[yt]]={"!ref":"A1"});return{SheetNames:Mt,Sheets:St}}function i(O,L){var K=L||{};if(+K.codepage>=0&&ii(+K.codepage),K.type=="string")throw new Error("Cannot write WK1 to JS string");var te=fn(),he=Kt(O["!ref"]),Oe=Array.isArray(O),Ue=[];Qe(te,0,c(1030)),Qe(te,6,g(he));for(var Ie=Math.min(he.e.r,8191),He=he.s.r;He<=Ie;++He)for(var gt=Ka(He),Z=he.s.c;Z<=he.e.c;++Z){He===he.s.r&&(Ue[Z]=Oa(Z));var aa=Ue[Z]+gt,St=Oe?(O[He]||[])[Z]:O[aa];if(!(!St||St.t=="z"))if(St.t=="n")(St.v|0)==St.v&&St.v>=-32768&&St.v<=32767?Qe(te,13,w(He,Z,St.v)):Qe(te,14,k(He,Z,St.v));else{var Mt=es(St);Qe(te,15,A(He,Z,Mt.slice(0,239)))}}return Qe(te,1),te.end()}function s(O,L){var K=L||{};if(+K.codepage>=0&&ii(+K.codepage),K.type=="string")throw new Error("Cannot write WK3 to JS string");var te=fn();Qe(te,0,f(O));for(var he=0,Oe=0;he<O.SheetNames.length;++he)(O.Sheets[O.SheetNames[he]]||{})["!ref"]&&Qe(te,27,fe(O.SheetNames[he],Oe++));var Ue=0;for(he=0;he<O.SheetNames.length;++he){var Ie=O.Sheets[O.SheetNames[he]];if(!(!Ie||!Ie["!ref"])){for(var He=Kt(Ie["!ref"]),gt=Array.isArray(Ie),Z=[],aa=Math.min(He.e.r,8191),St=He.s.r;St<=aa;++St)for(var Mt=Ka(St),yt=He.s.c;yt<=He.e.c;++yt){St===He.s.r&&(Z[yt]=Oa(yt));var et=Z[yt]+Mt,ra=gt?(Ie[St]||[])[yt]:Ie[et];if(!(!ra||ra.t=="z"))if(ra.t=="n")Qe(te,23,m(St,yt,Ue,ra.v));else{var Ba=es(ra);Qe(te,22,H(St,yt,Ue,Ba.slice(0,239)))}}++Ue}}return Qe(te,1),te.end()}function c(O){var L=Ne(2);return L.write_shift(2,O),L}function f(O){var L=Ne(26);L.write_shift(2,4096),L.write_shift(2,4),L.write_shift(4,0);for(var K=0,te=0,he=0,Oe=0;Oe<O.SheetNames.length;++Oe){var Ue=O.SheetNames[Oe],Ie=O.Sheets[Ue];if(!(!Ie||!Ie["!ref"])){++he;var He=un(Ie["!ref"]);K<He.e.r&&(K=He.e.r),te<He.e.c&&(te=He.e.c)}}return K>8191&&(K=8191),L.write_shift(2,K),L.write_shift(1,he),L.write_shift(1,te),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,1),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(4,0),L}function p(O,L,K){var te={s:{c:0,r:0},e:{c:0,r:0}};return L==8&&K.qpro?(te.s.c=O.read_shift(1),O.l++,te.s.r=O.read_shift(2),te.e.c=O.read_shift(1),O.l++,te.e.r=O.read_shift(2),te):(te.s.c=O.read_shift(2),te.s.r=O.read_shift(2),L==12&&K.qpro&&(O.l+=2),te.e.c=O.read_shift(2),te.e.r=O.read_shift(2),L==12&&K.qpro&&(O.l+=2),te.s.c==65535&&(te.s.c=te.e.c=te.s.r=te.e.r=0),te)}function g(O){var L=Ne(8);return L.write_shift(2,O.s.c),L.write_shift(2,O.s.r),L.write_shift(2,O.e.c),L.write_shift(2,O.e.r),L}function h(O,L,K){var te=[{c:0,r:0},{t:"n",v:0},0,0];return K.qpro&&K.vers!=20768?(te[0].c=O.read_shift(1),te[3]=O.read_shift(1),te[0].r=O.read_shift(2),O.l+=2):(te[2]=O.read_shift(1),te[0].c=O.read_shift(2),te[0].r=O.read_shift(2)),te}function E(O,L,K){var te=O.l+L,he=h(O,L,K);if(he[1].t="s",K.vers==20768){O.l++;var Oe=O.read_shift(1);return he[1].v=O.read_shift(Oe,"utf8"),he}return K.qpro&&O.l++,he[1].v=O.read_shift(te-O.l,"cstr"),he}function A(O,L,K){var te=Ne(7+K.length);te.write_shift(1,255),te.write_shift(2,L),te.write_shift(2,O),te.write_shift(1,39);for(var he=0;he<te.length;++he){var Oe=K.charCodeAt(he);te.write_shift(1,Oe>=128?95:Oe)}return te.write_shift(1,0),te}function _(O,L,K){var te=h(O,L,K);return te[1].v=O.read_shift(2,"i"),te}function w(O,L,K){var te=Ne(7);return te.write_shift(1,255),te.write_shift(2,L),te.write_shift(2,O),te.write_shift(2,K,"i"),te}function N(O,L,K){var te=h(O,L,K);return te[1].v=O.read_shift(8,"f"),te}function k(O,L,K){var te=Ne(13);return te.write_shift(1,255),te.write_shift(2,L),te.write_shift(2,O),te.write_shift(8,K,"f"),te}function F(O,L,K){var te=O.l+L,he=h(O,L,K);if(he[1].v=O.read_shift(8,"f"),K.qpro)O.l=te;else{var Oe=O.read_shift(2);ie(O.slice(O.l,O.l+Oe),he),O.l+=Oe}return he}function z(O,L,K){var te=L&32768;return L&=-32769,L=(te?O:0)+(L>=8192?L-16384:L),(te?"":"$")+(K?Oa(L):Ka(L))}var q={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},B=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function ie(O,L){Fr(O,0);for(var K=[],te=0,he="",Oe="",Ue="",Ie="";O.l<O.length;){var He=O[O.l++];switch(He){case 0:K.push(O.read_shift(8,"f"));break;case 1:Oe=z(L[0].c,O.read_shift(2),!0),he=z(L[0].r,O.read_shift(2),!1),K.push(Oe+he);break;case 2:{var gt=z(L[0].c,O.read_shift(2),!0),Z=z(L[0].r,O.read_shift(2),!1);Oe=z(L[0].c,O.read_shift(2),!0),he=z(L[0].r,O.read_shift(2),!1),K.push(gt+Z+":"+Oe+he)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:K.push("("+K.pop()+")");break;case 5:K.push(O.read_shift(2));break;case 6:{for(var aa="";He=O[O.l++];)aa+=String.fromCharCode(He);K.push('"'+aa.replace(/"/g,'""')+'"')}break;case 8:K.push("-"+K.pop());break;case 23:K.push("+"+K.pop());break;case 22:K.push("NOT("+K.pop()+")");break;case 20:case 21:Ie=K.pop(),Ue=K.pop(),K.push(["AND","OR"][He-20]+"("+Ue+","+Ie+")");break;default:if(He<32&&B[He])Ie=K.pop(),Ue=K.pop(),K.push(Ue+B[He]+Ie);else if(q[He]){if(te=q[He][1],te==69&&(te=O[O.l++]),te>K.length){console.error("WK1 bad formula parse 0x"+He.toString(16)+":|"+K.join("|")+"|");return}var St=K.slice(-te);K.length-=te,K.push(q[He][0]+"("+St.join(",")+")")}else return He<=7?console.error("WK1 invalid opcode "+He.toString(16)):He<=24?console.error("WK1 unsupported op "+He.toString(16)):He<=30?console.error("WK1 invalid opcode "+He.toString(16)):He<=115?console.error("WK1 unsupported function opcode "+He.toString(16)):console.error("WK1 unrecognized opcode "+He.toString(16))}}K.length==1?L[1].f=""+K[0]:console.error("WK1 bad formula parse |"+K.join("|")+"|")}function se(O){var L=[{c:0,r:0},{t:"n",v:0},0];return L[0].r=O.read_shift(2),L[3]=O[O.l++],L[0].c=O[O.l++],L}function ne(O,L){var K=se(O);return K[1].t="s",K[1].v=O.read_shift(L-4,"cstr"),K}function H(O,L,K,te){var he=Ne(6+te.length);he.write_shift(2,O),he.write_shift(1,K),he.write_shift(1,L),he.write_shift(1,39);for(var Oe=0;Oe<te.length;++Oe){var Ue=te.charCodeAt(Oe);he.write_shift(1,Ue>=128?95:Ue)}return he.write_shift(1,0),he}function le(O,L){var K=se(O);K[1].v=O.read_shift(2);var te=K[1].v>>1;if(K[1].v&1)switch(te&7){case 0:te=(te>>3)*5e3;break;case 1:te=(te>>3)*500;break;case 2:te=(te>>3)/20;break;case 3:te=(te>>3)/200;break;case 4:te=(te>>3)/2e3;break;case 5:te=(te>>3)/2e4;break;case 6:te=(te>>3)/16;break;case 7:te=(te>>3)/64;break}return K[1].v=te,K}function oe(O,L){var K=se(O),te=O.read_shift(4),he=O.read_shift(4),Oe=O.read_shift(2);if(Oe==65535)return te===0&&he===3221225472?(K[1].t="e",K[1].v=15):te===0&&he===3489660928?(K[1].t="e",K[1].v=42):K[1].v=0,K;var Ue=Oe&32768;return Oe=(Oe&32767)-16446,K[1].v=(1-Ue*2)*(he*Math.pow(2,Oe+32)+te*Math.pow(2,Oe)),K}function m(O,L,K,te){var he=Ne(14);if(he.write_shift(2,O),he.write_shift(1,K),he.write_shift(1,L),te==0)return he.write_shift(4,0),he.write_shift(4,0),he.write_shift(2,65535),he;var Oe=0,Ue=0,Ie=0,He=0;return te<0&&(Oe=1,te=-te),Ue=Math.log2(te)|0,te/=Math.pow(2,Ue-31),He=te>>>0,(He&2147483648)==0&&(te/=2,++Ue,He=te>>>0),te-=He,He|=2147483648,He>>>=0,te*=Math.pow(2,32),Ie=te>>>0,he.write_shift(4,Ie),he.write_shift(4,He),Ue+=16383+(Oe?32768:0),he.write_shift(2,Ue),he}function Se(O,L){var K=oe(O);return O.l+=L-14,K}function ue(O,L){var K=se(O),te=O.read_shift(4);return K[1].v=te>>6,K}function Pe(O,L){var K=se(O),te=O.read_shift(8,"f");return K[1].v=te,K}function tt(O,L){var K=Pe(O);return O.l+=L-10,K}function ke(O,L){return O[O.l+L-1]==0?O.read_shift(L,"cstr"):""}function de(O,L){var K=O[O.l++];K>L-1&&(K=L-1);for(var te="";te.length<K;)te+=String.fromCharCode(O[O.l++]);return te}function _e(O,L,K){if(!(!K.qpro||L<21)){var te=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var he=O.read_shift(L-21,"cstr");return[te,he]}}function Ze(O,L){for(var K={},te=O.l+L;O.l<te;){var he=O.read_shift(2);if(he==14e3){for(K[he]=[0,""],K[he][0]=O.read_shift(2);O[O.l];)K[he][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return K}function fe(O,L){var K=Ne(5+O.length);K.write_shift(2,14e3),K.write_shift(2,L);for(var te=0;te<O.length;++te){var he=O.charCodeAt(te);K[K.l++]=he>127?95:he}return K[K.l++]=0,K}var Je={0:{n:"BOF",f:ir},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:p},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:N},15:{n:"LABEL",f:E},16:{n:"FORMULA",f:F},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:E},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ke},222:{n:"SHEETNAMELP",f:de},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:ne},23:{n:"NUMBER17",f:oe},24:{n:"NUMBER18",f:le},25:{n:"FORMULA19",f:Se},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ze},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ue},38:{n:"??"},39:{n:"NUMBER27",f:Pe},40:{n:"FORMULA28",f:tt},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ke},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:_e},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:s,to_workbook:a}})();function bA(e){var a={},t=e.match(Gr),i=0,s=!1;if(t)for(;i!=t.length;++i){var c=bt(t[i]);switch(c[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!c.val)break;case"<shadow>":case"<shadow/>":a.shadow=1;break;case"</shadow>":break;case"<charset":if(c.val=="1")break;a.cp=Up[parseInt(c.val,10)];break;case"<outline":if(!c.val)break;case"<outline>":case"<outline/>":a.outline=1;break;case"</outline>":break;case"<rFont":a.name=c.val;break;case"<sz":a.sz=c.val;break;case"<strike":if(!c.val)break;case"<strike>":case"<strike/>":a.strike=1;break;case"</strike>":break;case"<u":if(!c.val)break;switch(c.val){case"double":a.uval="double";break;case"singleAccounting":a.uval="single-accounting";break;case"doubleAccounting":a.uval="double-accounting";break}case"<u>":case"<u/>":a.u=1;break;case"</u>":break;case"<b":if(c.val=="0")break;case"<b>":case"<b/>":a.b=1;break;case"</b>":break;case"<i":if(c.val=="0")break;case"<i>":case"<i/>":a.i=1;break;case"</i>":break;case"<color":c.rgb&&(a.color=c.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":a.family=c.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":a.valign=c.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(c[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+c[0])}}return a}var SA=(function(){var e=Xc("t"),a=Xc("rPr");function t(c){var f=c.match(e);if(!f)return{t:"s",v:""};var p={t:"s",v:qt(f[1])},g=c.match(a);return g&&(p.s=bA(g[1])),p}var i=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(f){return f.replace(i,"").split(s).map(t).filter(function(p){return p.v})}})(),EA=(function(){var a=/(\r\n|\n)/g;function t(s,c,f){var p=[];s.u&&p.push("text-decoration: underline;"),s.uval&&p.push("text-underline-style:"+s.uval+";"),s.sz&&p.push("font-size:"+s.sz+"pt;"),s.outline&&p.push("text-effect: outline;"),s.shadow&&p.push("text-shadow: auto;"),c.push('<span style="'+p.join("")+'">'),s.b&&(c.push("<b>"),f.push("</b>")),s.i&&(c.push("<i>"),f.push("</i>")),s.strike&&(c.push("<s>"),f.push("</s>"));var g=s.valign||"";return g=="superscript"||g=="super"?g="sup":g=="subscript"&&(g="sub"),g!=""&&(c.push("<"+g+">"),f.push("</"+g+">")),f.push("</span>"),s}function i(s){var c=[[],s.v,[]];return s.v?(s.s&&t(s.s,c[0],c[2]),c[0].join("")+c[1].replace(a,"<br/>")+c[2].join("")):""}return function(c){return c.map(i).join("")}})(),TA=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,AA=/<(?:\w+:)?r>/,_A=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function fh(e,a){var t=a?a.cellHTML:!0,i={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(i.t=qt(ga(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),i.r=ga(e),t&&(i.h=Jp(i.t))):e.match(AA)&&(i.r=ga(e),i.t=qt(ga((e.replace(_A,"").match(TA)||[]).join("").replace(Gr,""))),t&&(i.h=EA(SA(i.r)))),i):{t:""}}var CA=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,kA=/<(?:\w+:)?(?:si|sstItem)>/g,wA=/<\/(?:\w+:)?(?:si|sstItem)>/;function RA(e,a){var t=[],i="";if(!e)return t;var s=e.match(CA);if(s){i=s[2].replace(kA,"").split(wA);for(var c=0;c!=i.length;++c){var f=fh(i[c].trim(),a);f!=null&&(t[t.length]=f)}s=bt(s[1]),t.Count=s.count,t.Unique=s.uniqueCount}return t}var NA=/^\s|\s$|[\t\n\r]/;function ly(e,a){if(!a.bookSST)return"";var t=[Ja];t[t.length]=Ke("sst",null,{xmlns:kl[0],count:e.Count,uniqueCount:e.Unique});for(var i=0;i!=e.length;++i)if(e[i]!=null){var s=e[i],c="<si>";s.r?c+=s.r:(c+="<t",s.t||(s.t=""),s.t.match(NA)&&(c+=' xml:space="preserve"'),c+=">"+fa(s.t)+"</t>"),c+="</si>",t[t.length]=c}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function FA(e){return[e.read_shift(4),e.read_shift(4)]}function jA(e,a){var t=[],i=!1;return as(e,function(c,f,p){switch(p){case 159:t.Count=c[0],t.Unique=c[1];break;case 19:t.push(c);break;case 160:return!0;case 35:i=!0;break;case 36:i=!1;break;default:if(f.T,!i||a.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}),t}function DA(e,a){return a||(a=Ne(8)),a.write_shift(4,e.Count),a.write_shift(4,e.Unique),a}var OA=GS;function IA(e){var a=fn();$e(a,159,DA(e));for(var t=0;t<e.length;++t)$e(a,19,OA(e[t]));return $e(a,160),a.end()}function oy(e){for(var a=[],t=e.split(""),i=0;i<t.length;++i)a[i]=t[i].charCodeAt(0);return a}function Zi(e,a){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),a>=4&&(e.l+=a-4),t}function BA(e){var a={};return a.id=e.read_shift(0,"lpp4"),a.R=Zi(e,4),a.U=Zi(e,4),a.W=Zi(e,4),a}function MA(e){for(var a=e.read_shift(4),t=e.l+a-4,i={},s=e.read_shift(4),c=[];s-- >0;)c.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(i.name=e.read_shift(0,"lpp4"),i.comps=c,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return i}function LA(e){var a=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)a.push(MA(e));return a}function PA(e){var a=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)a.push(e.read_shift(0,"lpp4"));return a}function zA(e){var a={};return e.read_shift(4),e.l+=4,a.id=e.read_shift(0,"lpp4"),a.name=e.read_shift(0,"lpp4"),a.R=Zi(e,4),a.U=Zi(e,4),a.W=Zi(e,4),a}function UA(e){var a=zA(e);if(a.ename=e.read_shift(0,"8lpp4"),a.blksz=e.read_shift(4),a.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return a}function cy(e,a){var t=e.l+a,i={};i.Flags=e.read_shift(4)&63,e.l+=4,i.AlgID=e.read_shift(4);var s=!1;switch(i.AlgID){case 26126:case 26127:case 26128:s=i.Flags==36;break;case 26625:s=i.Flags==4;break;case 0:s=i.Flags==16||i.Flags==4||i.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+i.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return i.AlgIDHash=e.read_shift(4),i.KeySize=e.read_shift(4),i.ProviderType=e.read_shift(4),e.l+=8,i.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,i}function dy(e,a){var t={},i=e.l+a;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,i),e.l=i,t}function HA(e){var a=Zi(e);switch(a.Minor){case 2:return[a.Minor,$A(e)];case 3:return[a.Minor,GA()];case 4:return[a.Minor,YA(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+a.Minor)}function $A(e){var a=e.read_shift(4);if((a&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),i=cy(e,t),s=dy(e,e.length-e.l);return{t:"Std",h:i,v:s}}function GA(){throw new Error("File is password-protected: ECMA-376 Extensible")}function YA(e){var a=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),i={};return t.replace(Gr,function(c){var f=bt(c);switch(_i(f[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":a.forEach(function(p){i[p]=f[p]});break;case"<dataIntegrity":i.encryptedHmacKey=f.encryptedHmacKey,i.encryptedHmacValue=f.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":i.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":i.uri=f.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":i.encs.push(f);break;default:throw f[0]}}),i}function WA(e,a){var t={},i=t.EncryptionVersionInfo=Zi(e,4);if(a-=4,i.Minor!=2)throw new Error("unrecognized minor version code: "+i.Minor);if(i.Major>4||i.Major<2)throw new Error("unrecognized major version code: "+i.Major);t.Flags=e.read_shift(4),a-=4;var s=e.read_shift(4);return a-=4,t.EncryptionHeader=cy(e,s),a-=s,t.EncryptionVerifier=dy(e,a),t}function VA(e){var a={},t=a.EncryptionVersionInfo=Zi(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return a.Salt=e.read_shift(16),a.EncryptedVerifier=e.read_shift(16),a.EncryptedVerifierHash=e.read_shift(16),a}function uh(e){var a=0,t,i=oy(e),s=i.length+1,c,f,p,g,h;for(t=Ls(s),t[0]=i.length,c=1;c!=s;++c)t[c]=i[c-1];for(c=s-1;c>=0;--c)f=t[c],p=(a&16384)===0?0:1,g=a<<1&32767,h=p|g,a=h^f;return a^52811}var fy=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],a=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],i=function(f){return(f/2|f*128)&255},s=function(f,p){return i(f^p)},c=function(f){for(var p=a[f.length-1],g=104,h=f.length-1;h>=0;--h)for(var E=f[h],A=0;A!=7;++A)E&64&&(p^=t[g]),E*=2,--g;return p};return function(f){for(var p=oy(f),g=c(p),h=p.length,E=Ls(16),A=0;A!=16;++A)E[A]=0;var _,w,N;for((h&1)===1&&(_=g>>8,E[h]=s(e[0],_),--h,_=g&255,w=p[p.length-1],E[h]=s(w,_));h>0;)--h,_=g>>8,E[h]=s(p[h],_),--h,_=g&255,E[h]=s(p[h],_);for(h=15,N=15-p.length;N>0;)_=g>>8,E[h]=s(e[N],_),--h,--N,_=g&255,E[h]=s(p[h],_),--h,--N;return E}})(),XA=function(e,a,t,i,s){s||(s=a),i||(i=fy(e));var c,f;for(c=0;c!=a.length;++c)f=a[c],f^=i[t],f=(f>>5|f<<3)&255,s[c]=f,++t;return[s,t,i]},qA=function(e){var a=0,t=fy(e);return function(i){var s=XA("",i,a,t);return a=s[1],s[0]}};function KA(e,a,t,i){var s={key:ir(e),verificationBytes:ir(e)};return t.password&&(s.verifier=uh(t.password)),i.valid=s.verificationBytes===s.verifier,i.valid&&(i.insitu=qA(t.password)),s}function JA(e,a,t){var i=t||{};return i.Info=e.read_shift(2),e.l-=2,i.Info===1?i.Data=VA(e):i.Data=WA(e,a),i}function QA(e,a,t){var i={Type:t.biff>=8?e.read_shift(2):0};return i.Type?JA(e,a-2,i):KA(e,t.biff>=8?a:a-2,t,i),i}var uy=(function(){function e(s,c){switch(c.type){case"base64":return a(Cn(s),c);case"binary":return a(s,c);case"buffer":return a(It&&Buffer.isBuffer(s)?s.toString("binary"):Hs(s),c);case"array":return a(El(s),c)}throw new Error("Unrecognized type "+c.type)}function a(s,c){var f=c||{},p=f.dense?[]:{},g=s.match(/\\trowd.*?\\row\b/g);if(!g.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:g.length-1}};return g.forEach(function(E,A){Array.isArray(p)&&(p[A]=[]);for(var _=/\\\w+\b/g,w=0,N,k=-1;N=_.exec(E);){switch(N[0]){case"\\cell":var F=E.slice(w,_.lastIndex-N[0].length);if(F[0]==" "&&(F=F.slice(1)),++k,F.length){var z={v:F,t:"s"};Array.isArray(p)?p[A][k]=z:p[vt({r:A,c:k})]=z}break}w=_.lastIndex}k>h.e.c&&(h.e.c=k)}),p["!ref"]=wt(h),p}function t(s,c){return $s(e(s,c),c)}function i(s){for(var c=["{\\rtf1\\ansi"],f=Kt(s["!ref"]),p,g=Array.isArray(s),h=f.s.r;h<=f.e.r;++h){c.push("\\trowd\\trautofit1");for(var E=f.s.c;E<=f.e.c;++E)c.push("\\cellx"+(E+1));for(c.push("\\pard\\intbl"),E=f.s.c;E<=f.e.c;++E){var A=vt({r:h,c:E});p=g?(s[h]||[])[E]:s[A],!(!p||p.v==null&&(!p.f||p.F))&&(c.push(" "+(p.w||(es(p),p.w))),c.push("\\cell"))}c.push("\\pard\\intbl\\row")}return c.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:i}})();function ZA(e){var a=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(a.slice(0,2),16),parseInt(a.slice(2,4),16),parseInt(a.slice(4,6),16)]}function Qc(e){for(var a=0,t=1;a!=3;++a)t=t*256+(e[a]>255?255:e[a]<0?0:e[a]);return t.toString(16).toUpperCase().slice(1)}function e_(e){var a=e[0]/255,t=e[1]/255,i=e[2]/255,s=Math.max(a,t,i),c=Math.min(a,t,i),f=s-c;if(f===0)return[0,0,a];var p=0,g=0,h=s+c;switch(g=f/(h>1?2-h:h),s){case a:p=((t-i)/f+6)%6;break;case t:p=(i-a)/f+2;break;case i:p=(a-t)/f+4;break}return[p/6,g,h/2]}function t_(e){var a=e[0],t=e[1],i=e[2],s=t*2*(i<.5?i:1-i),c=i-s/2,f=[c,c,c],p=6*a,g;if(t!==0)switch(p|0){case 0:case 6:g=s*p,f[0]+=s,f[1]+=g;break;case 1:g=s*(2-p),f[0]+=g,f[1]+=s;break;case 2:g=s*(p-2),f[1]+=s,f[2]+=g;break;case 3:g=s*(4-p),f[1]+=g,f[2]+=s;break;case 4:g=s*(p-4),f[2]+=s,f[0]+=g;break;case 5:g=s*(6-p),f[2]+=g,f[0]+=s;break}for(var h=0;h!=3;++h)f[h]=Math.round(f[h]*255);return f}function qd(e,a){if(a===0)return e;var t=e_(ZA(e));return a<0?t[2]=t[2]*(1+a):t[2]=1-(1-t[2])*(1-a),Qc(t_(t))}var py=6,a_=15,r_=1,zr=py;function Zc(e){return Math.floor((e+Math.round(128/zr)/256)*zr)}function e0(e){return Math.floor((e-5)/zr*100+.5)/100}function Kd(e){return Math.round((e*zr+5)/zr*256)/256}function yp(e){return Kd(e0(Zc(e)))}function ph(e){var a=Math.abs(e-yp(e)),t=zr;if(a>.005)for(zr=r_;zr<a_;++zr)Math.abs(e-yp(e))<=a&&(a=Math.abs(e-yp(e)),t=zr);zr=t}function Ps(e){e.width?(e.wpx=Zc(e.width),e.wch=e0(e.wpx),e.MDW=zr):e.wpx?(e.wch=e0(e.wpx),e.width=Kd(e.wch),e.MDW=zr):typeof e.wch=="number"&&(e.width=Kd(e.wch),e.wpx=Zc(e.width),e.MDW=zr),e.customWidth&&delete e.customWidth}var n_=96,hy=n_;function t0(e){return e*96/hy}function Ro(e){return e*hy/96}var i_={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function s_(e,a,t,i){a.Borders=[];var s={},c=!1;(e[0].match(Gr)||[]).forEach(function(f){var p=bt(f);switch(_i(p[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},p.diagonalUp&&(s.diagonalUp=Ca(p.diagonalUp)),p.diagonalDown&&(s.diagonalDown=Ca(p.diagonalDown)),a.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(i&&i.WTF&&!c)throw new Error("unrecognized "+p[0]+" in borders")}})}function l_(e,a,t,i){a.Fills=[];var s={},c=!1;(e[0].match(Gr)||[]).forEach(function(f){var p=bt(f);switch(_i(p[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},a.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":a.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":p.patternType&&(s.patternType=p.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),p.indexed&&(s.bgColor.indexed=parseInt(p.indexed,10)),p.theme&&(s.bgColor.theme=parseInt(p.theme,10)),p.tint&&(s.bgColor.tint=parseFloat(p.tint)),p.rgb&&(s.bgColor.rgb=p.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),p.theme&&(s.fgColor.theme=parseInt(p.theme,10)),p.tint&&(s.fgColor.tint=parseFloat(p.tint)),p.rgb!=null&&(s.fgColor.rgb=p.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(i&&i.WTF&&!c)throw new Error("unrecognized "+p[0]+" in fills")}})}function o_(e,a,t,i){a.Fonts=[];var s={},c=!1;(e[0].match(Gr)||[]).forEach(function(f){var p=bt(f);switch(_i(p[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":a.Fonts.push(s),s={};break;case"<name":p.val&&(s.name=ga(p.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=p.val?Ca(p.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=p.val?Ca(p.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(p.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=p.val?Ca(p.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=p.val?Ca(p.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=p.val?Ca(p.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=p.val?Ca(p.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=p.val?Ca(p.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":p.val&&(s.sz=+p.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":p.val&&(s.vertAlign=p.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":p.val&&(s.family=parseInt(p.val,10));break;case"<family/>":case"</family>":break;case"<scheme":p.val&&(s.scheme=p.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(p.val=="1")break;p.codepage=Up[parseInt(p.val,10)];break;case"<color":if(s.color||(s.color={}),p.auto&&(s.color.auto=Ca(p.auto)),p.rgb)s.color.rgb=p.rgb.slice(-6);else if(p.indexed){s.color.index=parseInt(p.indexed,10);var g=ml[s.color.index];s.color.index==81&&(g=ml[1]),g||(g=ml[1]),s.color.rgb=g[0].toString(16)+g[1].toString(16)+g[2].toString(16)}else p.theme&&(s.color.theme=parseInt(p.theme,10),p.tint&&(s.color.tint=parseFloat(p.tint)),p.theme&&t.themeElements&&t.themeElements.clrScheme&&(s.color.rgb=qd(t.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":c=!0;break;case"</AlternateContent>":c=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(i&&i.WTF&&!c)throw new Error("unrecognized "+p[0]+" in fonts")}})}function c_(e,a,t){a.NumberFmt=[];for(var i=Ua(mt),s=0;s<i.length;++s)a.NumberFmt[i[s]]=mt[i[s]];var c=e[0].match(Gr);if(c)for(s=0;s<c.length;++s){var f=bt(c[s]);switch(_i(f[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var p=qt(ga(f.formatCode)),g=parseInt(f.numFmtId,10);if(a.NumberFmt[g]=p,g>0){if(g>392){for(g=392;g>60&&a.NumberFmt[g]!=null;--g);a.NumberFmt[g]=p}Qi(p,g)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+f[0]+" in numFmts")}}}function d_(e){var a=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var i=t[0];i<=t[1];++i)e[i]!=null&&(a[a.length]=Ke("numFmt",null,{numFmtId:i,formatCode:fa(e[i])}))}),a.length===1?"":(a[a.length]="</numFmts>",a[0]=Ke("numFmts",null,{count:a.length-2}).replace("/>",">"),a.join(""))}var Id=["numFmtId","fillId","fontId","borderId","xfId"],Bd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function f_(e,a,t){a.CellXf=[];var i,s=!1;(e[0].match(Gr)||[]).forEach(function(c){var f=bt(c),p=0;switch(_i(f[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(i=f,delete i[0],p=0;p<Id.length;++p)i[Id[p]]&&(i[Id[p]]=parseInt(i[Id[p]],10));for(p=0;p<Bd.length;++p)i[Bd[p]]&&(i[Bd[p]]=Ca(i[Bd[p]]));if(a.NumberFmt&&i.numFmtId>392){for(p=392;p>60;--p)if(a.NumberFmt[i.numFmtId]==a.NumberFmt[p]){i.numFmtId=p;break}}a.CellXf.push(i);break;case"</xf>":break;case"<alignment":case"<alignment/>":var g={};f.vertical&&(g.vertical=f.vertical),f.horizontal&&(g.horizontal=f.horizontal),f.textRotation!=null&&(g.textRotation=f.textRotation),f.indent&&(g.indent=f.indent),f.wrapText&&(g.wrapText=Ca(f.wrapText)),i.alignment=g;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(t&&t.WTF&&!s)throw new Error("unrecognized "+f[0]+" in cellXfs")}})}function u_(e){var a=[];return a[a.length]=Ke("cellXfs",null),e.forEach(function(t){a[a.length]=Ke("xf",null,t)}),a[a.length]="</cellXfs>",a.length===2?"":(a[0]=Ke("cellXfs",null,{count:a.length-2}).replace("/>",">"),a.join(""))}var p_=(function(){var a=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,i=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,c=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(p,g,h){var E={};if(!p)return E;p=p.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var A;return(A=p.match(a))&&c_(A,E,h),(A=p.match(s))&&o_(A,E,g,h),(A=p.match(i))&&l_(A,E,g,h),(A=p.match(c))&&s_(A,E,g,h),(A=p.match(t))&&f_(A,E,h),E}})();function gy(e,a){var t=[Ja,Ke("styleSheet",null,{xmlns:kl[0],"xmlns:vt":ur.vt})],i;return e.SSF&&(i=d_(e.SSF))!=null&&(t[t.length]=i),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=u_(a.cellXfs))&&(t[t.length]=i),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function h_(e,a){var t=e.read_shift(2),i=Hr(e);return[t,i]}function g_(e,a,t){t||(t=Ne(6+4*a.length)),t.write_shift(2,e),Sr(a,t);var i=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),i}function x_(e,a,t){var i={};i.sz=e.read_shift(2)/20;var s=JS(e);s.fItalic&&(i.italic=1),s.fCondense&&(i.condense=1),s.fExtend&&(i.extend=1),s.fShadow&&(i.shadow=1),s.fOutline&&(i.outline=1),s.fStrikeout&&(i.strike=1);var c=e.read_shift(2);switch(c===700&&(i.bold=1),e.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var f=e.read_shift(1);f!=0&&(i.underline=f);var p=e.read_shift(1);p>0&&(i.family=p);var g=e.read_shift(1);switch(g>0&&(i.charset=g),e.l++,i.color=KS(e),e.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=Hr(e),i}function m_(e,a){a||(a=Ne(153)),a.write_shift(2,e.sz*20),QS(e,a),a.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),a.write_shift(2,t),a.write_shift(1,e.underline||0),a.write_shift(1,e.family||0),a.write_shift(1,e.charset||0),a.write_shift(1,0),Wd(e.color,a);var i=0;return i=2,a.write_shift(1,i),Sr(e.name,a),a.length>a.l?a.slice(0,a.l):a}var v_=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],bp,y_=$r;function _m(e,a){a||(a=Ne(84)),bp||(bp=tf(v_));var t=bp[e.patternType];t==null&&(t=40),a.write_shift(4,t);var i=0;if(t!=40)for(Wd({auto:1},a),Wd({auto:1},a);i<12;++i)a.write_shift(4,0);else{for(;i<4;++i)a.write_shift(4,0);for(;i<12;++i)a.write_shift(4,0)}return a.length>a.l?a.slice(0,a.l):a}function b_(e,a){var t=e.l+a,i=e.read_shift(2),s=e.read_shift(2);return e.l=t,{ixfe:i,numFmtId:s}}function xy(e,a,t){t||(t=Ne(16)),t.write_shift(2,a||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var i=0;return t.write_shift(1,i),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Dc(e,a){return a||(a=Ne(10)),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(4,0),a.write_shift(4,0),a}var S_=$r;function E_(e,a){return a||(a=Ne(51)),a.write_shift(1,0),Dc(null,a),Dc(null,a),Dc(null,a),Dc(null,a),Dc(null,a),a.length>a.l?a.slice(0,a.l):a}function T_(e,a){return a||(a=Ne(52)),a.write_shift(4,e.xfId),a.write_shift(2,1),a.write_shift(1,0),a.write_shift(1,0),Yd(e.name||"",a),a.length>a.l?a.slice(0,a.l):a}function A_(e,a,t){var i=Ne(2052);return i.write_shift(4,e),Yd(a,i),Yd(t,i),i.length>i.l?i.slice(0,i.l):i}function __(e,a,t){var i={};i.NumberFmt=[];for(var s in mt)i.NumberFmt[s]=mt[s];i.CellXf=[],i.Fonts=[];var c=[],f=!1;return as(e,function(g,h,E){switch(E){case 44:i.NumberFmt[g[0]]=g[1],Qi(g[1],g[0]);break;case 43:i.Fonts.push(g),g.color.theme!=null&&a&&a.themeElements&&a.themeElements.clrScheme&&(g.color.rgb=qd(a.themeElements.clrScheme[g.color.theme].rgb,g.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:c[c.length-1]==617&&i.CellXf.push(g);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:f=!0;break;case 36:f=!1;break;case 37:c.push(E),f=!0;break;case 38:c.pop(),f=!1;break;default:if(h.T>0)c.push(E);else if(h.T<0)c.pop();else if(!f||t.WTF&&c[c.length-1]!=37)throw new Error("Unexpected record 0x"+E.toString(16))}}),i}function C_(e,a){if(a){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)a[s]!=null&&++t}),t!=0&&($e(e,615,oi(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)a[s]!=null&&$e(e,44,g_(s,a[s]))}),$e(e,616))}}function k_(e){var a=1;$e(e,611,oi(a)),$e(e,43,m_({sz:12,color:{theme:1},name:"Calibri",family:2})),$e(e,612)}function w_(e){var a=2;$e(e,603,oi(a)),$e(e,45,_m({patternType:"none"})),$e(e,45,_m({patternType:"gray125"})),$e(e,604)}function R_(e){var a=1;$e(e,613,oi(a)),$e(e,46,E_()),$e(e,614)}function N_(e){var a=1;$e(e,626,oi(a)),$e(e,47,xy({numFmtId:0},65535)),$e(e,627)}function F_(e,a){$e(e,617,oi(a.length)),a.forEach(function(t){$e(e,47,xy(t,0))}),$e(e,618)}function j_(e){var a=1;$e(e,619,oi(a)),$e(e,48,T_({xfId:0,name:"Normal"})),$e(e,620)}function D_(e){var a=0;$e(e,505,oi(a)),$e(e,506)}function O_(e){var a=0;$e(e,508,A_(a,"TableStyleMedium9","PivotStyleMedium4")),$e(e,509)}function I_(e,a){var t=fn();return $e(t,278),C_(t,e.SSF),k_(t),w_(t),R_(t),N_(t),F_(t,a.cellXfs),j_(t),D_(t),O_(t),$e(t,279),t.end()}var B_=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function M_(e,a,t){a.themeElements.clrScheme=[];var i={};(e[0].match(Gr)||[]).forEach(function(s){var c=bt(s);switch(c[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":i.rgb=c.val;break;case"<a:sysClr":i.rgb=c.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":c[0].charAt(1)==="/"?(a.themeElements.clrScheme[B_.indexOf(c[0])]=i,i={}):i.name=c[0].slice(3,c[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+c[0]+" in clrScheme")}})}function L_(){}function P_(){}var z_=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,U_=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,H_=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function $_(e,a,t){a.themeElements={};var i;[["clrScheme",z_,M_],["fontScheme",U_,L_],["fmtScheme",H_,P_]].forEach(function(s){if(!(i=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](i,a,t)})}var G_=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function my(e,a){(!e||e.length===0)&&(e=hh());var t,i={};if(!(t=e.match(G_)))throw new Error("themeElements not found in theme");return $_(t[0],i,a),i.raw=e,i}function hh(e,a){if(a&&a.themeXLSX)return a.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[Ja];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function Y_(e,a,t){var i=e.l+a,s=e.read_shift(4);if(s!==124226){if(!t.cellStyles){e.l=i;return}var c=e.slice(e.l);e.l=i;var f;try{f=cv(c,{type:"array"})}catch{return}var p=_n(f,"theme/theme/theme1.xml",!0);if(p)return my(p,t)}}function W_(e){return e.read_shift(4)}function V_(e){var a={};switch(a.xclrType=e.read_shift(2),a.nTintShade=e.read_shift(2),a.xclrType){case 0:e.l+=4;break;case 1:a.xclrValue=X_(e,4);break;case 2:a.xclrValue=Kv(e);break;case 3:a.xclrValue=W_(e);break;case 4:e.l+=4;break}return e.l+=8,a}function X_(e,a){return $r(e,a)}function q_(e,a){return $r(e,a)}function K_(e){var a=e.read_shift(2),t=e.read_shift(2)-4,i=[a];switch(a){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:i[1]=V_(e);break;case 6:i[1]=q_(e,t);break;case 14:case 15:i[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+a+" "+t)}return i}function J_(e,a){var t=e.l+a;e.l+=2;var i=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),c=[];s-- >0;)c.push(K_(e,t-e.l));return{ixfe:i,ext:c}}function Q_(e,a){a.forEach(function(t){t[0]})}function Z_(e,a){return{flags:e.read_shift(4),version:e.read_shift(4),name:Hr(e)}}function e4(e){var a=Ne(12+2*e.name.length);return a.write_shift(4,e.flags),a.write_shift(4,e.version),Sr(e.name,a),a.slice(0,a.l)}function t4(e){for(var a=[],t=e.read_shift(4);t-- >0;)a.push([e.read_shift(4),e.read_shift(4)]);return a}function a4(e){var a=Ne(4+8*e.length);a.write_shift(4,e.length);for(var t=0;t<e.length;++t)a.write_shift(4,e[t][0]),a.write_shift(4,e[t][1]);return a}function r4(e,a){var t=Ne(8+2*a.length);return t.write_shift(4,e),Sr(a,t),t.slice(0,t.l)}function n4(e){return e.l+=4,e.read_shift(4)!=0}function i4(e,a){var t=Ne(8);return t.write_shift(4,e),t.write_shift(4,1),t}function s4(e,a,t){var i={Types:[],Cell:[],Value:[]},s=t||{},c=[],f=!1,p=2;return as(e,function(g,h,E){switch(E){case 335:i.Types.push({name:g.name});break;case 51:g.forEach(function(A){p==1?i.Cell.push({type:i.Types[A[0]-1].name,index:A[1]}):p==0&&i.Value.push({type:i.Types[A[0]-1].name,index:A[1]})});break;case 337:p=g?1:0;break;case 338:p=2;break;case 35:c.push(E),f=!0;break;case 36:c.pop(),f=!1;break;default:if(!h.T){if(!f||s.WTF&&c[c.length-1]!=35)throw new Error("Unexpected record 0x"+E.toString(16))}}}),i}function l4(){var e=fn();return $e(e,332),$e(e,334,oi(1)),$e(e,335,e4({name:"XLDAPR",version:12e4,flags:3496657072})),$e(e,336),$e(e,339,r4(1,"XLDAPR")),$e(e,52),$e(e,35,oi(514)),$e(e,4096,oi(0)),$e(e,4097,Gn(1)),$e(e,36),$e(e,53),$e(e,340),$e(e,337,i4(1)),$e(e,51,a4([[1,0]])),$e(e,338),$e(e,333),e.end()}function o4(e,a,t){var i={Types:[],Cell:[],Value:[]};if(!e)return i;var s=!1,c=2,f;return e.replace(Gr,function(p){var g=bt(p);switch(_i(g[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":i.Types.push({name:g.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<i.Types.length;++h)i.Types[h].name==g.name&&(f=i.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":c==1?i.Cell.push({type:i.Types[g.t-1].name,index:+g.v}):c==0&&i.Value.push({type:i.Types[g.t-1].name,index:+g.v});break;case"</rc>":break;case"<cellMetadata":c=1;break;case"</cellMetadata>":c=2;break;case"<valueMetadata":c=0;break;case"</valueMetadata>":c=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!f)break;f.offsets||(f.offsets=[]),f.offsets.push(+g.i);break;default:if(!s&&t.WTF)throw new Error("unrecognized "+g[0]+" in metadata")}return p}),i}function vy(){var e=[Ja];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function c4(e){var a=[];if(!e)return a;var t=1;return(e.match(Gr)||[]).forEach(function(i){var s=bt(i);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?t=s.i:s.i=t,a.push(s);break}}),a}function d4(e){var a={};a.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),a.r=vt(t);var i=e.read_shift(1);return i&2&&(a.l="1"),i&8&&(a.a="1"),a}function f4(e,a,t){var i=[];return as(e,function(c,f,p){switch(p){case 63:i.push(c);break;default:if(!f.T)throw new Error("Unexpected record 0x"+p.toString(16))}}),i}function u4(e,a,t,i){if(!e)return e;var s=i||{},c=!1;as(e,function(p,g,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:c=!0;break;case 36:c=!1;break;default:if(!g.T){if(!c||s.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},s)}function p4(e,a){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return a["!id"][t].Target}var Eo=1024;function yy(e,a){for(var t=[21600,21600],i=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),s=[Ke("xml",null,{"xmlns:v":En.v,"xmlns:o":En.o,"xmlns:x":En.x,"xmlns:mv":En.mv}).replace(/\/>/,">"),Ke("o:shapelayout",Ke("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ke("v:shapetype",[Ke("v:stroke",null,{joinstyle:"miter"}),Ke("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:i})];Eo<e*1e3;)Eo+=1e3;return a.forEach(function(c){var f=Ia(c[0]),p={color2:"#BEFF82",type:"gradient"};p.type=="gradient"&&(p.angle="-180");var g=p.type=="gradient"?Ke("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Ke("v:fill",g,p),E={on:"t",obscured:"t"};++Eo,s=s.concat(["<v:shape"+qc({id:"_x0000_s"+Eo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(c[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Ke("v:shadow",null,E),Ke("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",jr("x:Anchor",[f.c+1,0,f.r+1,0,f.c+3,20,f.r+5,20].join(",")),jr("x:AutoFill","False"),jr("x:Row",String(f.r)),jr("x:Column",String(f.c)),c[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function Cm(e,a,t,i){var s=Array.isArray(e),c;a.forEach(function(f){var p=Ia(f.ref);if(s?(e[p.r]||(e[p.r]=[]),c=e[p.r][p.c]):c=e[f.ref],!c){c={t:"z"},s?e[p.r][p.c]=c:e[f.ref]=c;var g=Kt(e["!ref"]||"BDWGO1000001:A1");g.s.r>p.r&&(g.s.r=p.r),g.e.r<p.r&&(g.e.r=p.r),g.s.c>p.c&&(g.s.c=p.c),g.e.c<p.c&&(g.e.c=p.c);var h=wt(g);h!==e["!ref"]&&(e["!ref"]=h)}c.c||(c.c=[]);var E={a:f.author,t:f.t,r:f.r,T:t};f.h&&(E.h=f.h);for(var A=c.c.length-1;A>=0;--A){if(!t&&c.c[A].T)return;t&&!c.c[A].T&&c.c.splice(A,1)}if(t&&i){for(A=0;A<i.length;++A)if(E.a==i[A].id){E.a=i[A].name||E.a;break}}c.c.push(E)})}function h4(e,a){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],i=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(f){if(!(f===""||f.trim()==="")){var p=f.match(/<(?:\w+:)?author[^>]*>(.*)/);p&&t.push(p[1])}});var c=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return c&&c[1]&&c[1].split(/<\/\w*:?comment>/).forEach(function(f){if(!(f===""||f.trim()==="")){var p=f.match(/<(?:\w+:)?comment[^>]*>/);if(p){var g=bt(p[0]),h={author:g.authorId&&t[g.authorId]||"sheetjsghost",ref:g.ref,guid:g.guid},E=Ia(g.ref);if(!(a.sheetRows&&a.sheetRows<=E.r)){var A=f.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!A&&!!A[1]&&fh(A[1])||{r:"",t:"",h:""};h.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),h.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),a.cellHTML&&(h.h=_.h),i.push(h)}}}}),i}function by(e){var a=[Ja,Ke("comments",null,{xmlns:kl[0]})],t=[];return a.push("<authors>"),e.forEach(function(i){i[1].forEach(function(s){var c=fa(s.a);t.indexOf(c)==-1&&(t.push(c),a.push("<author>"+c+"</author>")),s.T&&s.ID&&t.indexOf("tc="+s.ID)==-1&&(t.push("tc="+s.ID),a.push("<author>tc="+s.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),a.push("<author>SheetJ5</author>")),a.push("</authors>"),a.push("<commentList>"),e.forEach(function(i){var s=0,c=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?s=t.indexOf("tc="+i[1][0].ID):i[1].forEach(function(g){g.a&&(s=t.indexOf(fa(g.a))),c.push(g.t||"")}),a.push('<comment ref="'+i[0]+'" authorId="'+s+'"><text>'),c.length<=1)a.push(jr("t",fa(c[0]||"")));else{for(var f=`Comment:
    `+c[0]+`
`,p=1;p<c.length;++p)f+=`Reply:
    `+c[p]+`
`;a.push(jr("t",fa(f)))}a.push("</text></comment>")}),a.push("</commentList>"),a.length>2&&(a[a.length]="</comments>",a[1]=a[1].replace("/>",">")),a.join("")}function g4(e,a){var t=[],i=!1,s={},c=0;return e.replace(Gr,function(p,g){var h=bt(p);switch(_i(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":s.t!=null&&t.push(s);break;case"<text>":case"<text":c=g+p.length;break;case"</text>":s.t=e.slice(c,g).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":i=!0;break;case"</mentions>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&a.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return p}),t}function x4(e,a,t){var i=[Ja,Ke("ThreadedComments",null,{xmlns:ur.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var c="";(s[1]||[]).forEach(function(f,p){if(!f.T){delete f.ID;return}f.a&&a.indexOf(f.a)==-1&&a.push(f.a);var g={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};p==0?c=g.id:g.parentId=c,f.ID=g.id,f.a&&(g.personId="{54EE7950-7262-4200-6969-"+("000000000000"+a.indexOf(f.a)).slice(-12)+"}"),i.push(Ke("threadedComment",jr("text",f.t||""),g))})}),i.push("</ThreadedComments>"),i.join("")}function m4(e,a){var t=[],i=!1;return e.replace(Gr,function(c){var f=bt(c);switch(_i(f[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:f.displayname,id:f.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&a.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return c}),t}function v4(e){var a=[Ja,Ke("personList",null,{xmlns:ur.TCMNT,"xmlns:x":kl[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,i){a.push(Ke("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:t,providerId:"None"}))}),a.push("</personList>"),a.join("")}function y4(e){var a={};a.iauthor=e.read_shift(4);var t=Fl(e);return a.rfx=t.s,a.ref=vt(t.s),e.l+=16,a}function b4(e,a){return a==null&&(a=Ne(36)),a.write_shift(4,e[1].iauthor),Do(e[0],a),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a}var S4=Hr;function E4(e){return Sr(e.slice(0,54))}function T4(e,a){var t=[],i=[],s={},c=!1;return as(e,function(p,g,h){switch(h){case 632:i.push(p);break;case 635:s=p;break;case 637:s.t=p.t,s.h=p.h,s.r=p.r;break;case 636:if(s.author=i[s.iauthor],delete s.iauthor,a.sheetRows&&s.rfx&&a.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,t.push(s);break;case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!g.T){if(!c||a.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),t}function A4(e){var a=fn(),t=[];return $e(a,628),$e(a,630),e.forEach(function(i){i[1].forEach(function(s){t.indexOf(s.a)>-1||(t.push(s.a.slice(0,54)),$e(a,632,E4(s.a)))})}),$e(a,631),$e(a,633),e.forEach(function(i){i[1].forEach(function(s){s.iauthor=t.indexOf(s.a);var c={s:Ia(i[0]),e:Ia(i[0])};$e(a,635,b4([c,s])),s.t&&s.t.length>0&&$e(a,637,WS(s)),$e(a,636),delete s.iauthor})}),$e(a,634),$e(a,629),a.end()}var _4="application/vnd.ms-office.vbaProject";function C4(e){var a=pt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,i){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var s=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");pt.utils.cfb_add(a,s,e.FileIndex[i].content)}}),pt.write(a)}function k4(e,a){a.FullPaths.forEach(function(t,i){if(i!=0){var s=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&pt.utils.cfb_add(e,s,a.FileIndex[i].content)}})}var Sy=["xlsb","xlsm","xlam","biff8","xla"];function w4(){return{"!type":"dialog"}}function R4(){return{"!type":"dialog"}}function N4(){return{"!type":"macro"}}function F4(){return{"!type":"macro"}}var _o=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,a={r:0,c:0};function t(i,s,c,f){var p=!1,g=!1;c.length==0?g=!0:c.charAt(0)=="["&&(g=!0,c=c.slice(1,-1)),f.length==0?p=!0:f.charAt(0)=="["&&(p=!0,f=f.slice(1,-1));var h=c.length>0?parseInt(c,10)|0:0,E=f.length>0?parseInt(f,10)|0:0;return p?E+=a.c:--E,g?h+=a.r:--h,s+(p?"":"$")+Oa(E)+(g?"":"$")+Ka(h)}return function(s,c){return a=c,s.replace(e,t)}})(),gh=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,xh=(function(){return function(a,t){return a.replace(gh,function(i,s,c,f,p,g){var h=ah(f)-(c?0:t.c),E=th(g)-(p?0:t.r),A=E==0?"":p?E+1:"["+E+"]",_=h==0?"":c?h+1:"["+h+"]";return s+"R"+A+"C"+_})}})();function Ey(e,a){return e.replace(gh,function(t,i,s,c,f,p){return i+(s=="$"?s+c:Oa(ah(c)+a.c))+(f=="$"?f+p:Ka(th(p)+a.r))})}function j4(e,a,t){var i=un(a),s=i.s,c=Ia(t),f={r:c.r-s.r,c:c.c-s.c};return Ey(e,f)}function D4(e){return e.length!=1}function km(e){return e.replace(/_xlfn\./g,"")}function rr(e){e.l+=1}function zs(e,a){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function Ty(e,a,t){var i=2;if(t){if(t.biff>=2&&t.biff<=5)return Ay(e);t.biff==12&&(i=4)}var s=e.read_shift(i),c=e.read_shift(i),f=zs(e),p=zs(e);return{s:{r:s,c:f[0],cRel:f[1],rRel:f[2]},e:{r:c,c:p[0],cRel:p[1],rRel:p[2]}}}function Ay(e){var a=zs(e),t=zs(e),i=e.read_shift(1),s=e.read_shift(1);return{s:{r:a[0],c:i,cRel:a[1],rRel:a[2]},e:{r:t[0],c:s,cRel:t[1],rRel:t[2]}}}function O4(e,a,t){if(t.biff<8)return Ay(e);var i=e.read_shift(t.biff==12?4:2),s=e.read_shift(t.biff==12?4:2),c=zs(e),f=zs(e);return{s:{r:i,c:c[0],cRel:c[1],rRel:c[2]},e:{r:s,c:f[0],cRel:f[1],rRel:f[2]}}}function _y(e,a,t){if(t&&t.biff>=2&&t.biff<=5)return I4(e);var i=e.read_shift(t&&t.biff==12?4:2),s=zs(e);return{r:i,c:s[0],cRel:s[1],rRel:s[2]}}function I4(e){var a=zs(e),t=e.read_shift(1);return{r:a[0],c:t,cRel:a[1],rRel:a[2]}}function B4(e){var a=e.read_shift(2),t=e.read_shift(2);return{r:a,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function M4(e,a,t){var i=t&&t.biff?t.biff:8;if(i>=2&&i<=5)return L4(e);var s=e.read_shift(i>=12?4:2),c=e.read_shift(2),f=(c&16384)>>14,p=(c&32768)>>15;if(c&=16383,p==1)for(;s>524287;)s-=1048576;if(f==1)for(;c>8191;)c=c-16384;return{r:s,c,cRel:f,rRel:p}}function L4(e){var a=e.read_shift(2),t=e.read_shift(1),i=(a&32768)>>15,s=(a&16384)>>14;return a&=16383,i==1&&a>=8192&&(a=a-16384),s==1&&t>=128&&(t=t-256),{r:a,c:t,cRel:s,rRel:i}}function P4(e,a,t){var i=(e[e.l++]&96)>>5,s=Ty(e,t.biff>=2&&t.biff<=5?6:8,t);return[i,s]}function z4(e,a,t){var i=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),c=8;if(t)switch(t.biff){case 5:e.l+=12,c=6;break;case 12:c=12;break}var f=Ty(e,c,t);return[i,s,f]}function U4(e,a,t){var i=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[i]}function H4(e,a,t){var i=(e[e.l++]&96)>>5,s=e.read_shift(2),c=8;if(t)switch(t.biff){case 5:e.l+=12,c=6;break;case 12:c=12;break}return e.l+=c,[i,s]}function $4(e,a,t){var i=(e[e.l++]&96)>>5,s=O4(e,a-1,t);return[i,s]}function G4(e,a,t){var i=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[i]}function wm(e){var a=e[e.l+1]&1,t=1;return e.l+=4,[a,t]}function Y4(e,a,t){e.l+=2;for(var i=e.read_shift(t&&t.biff==2?1:2),s=[],c=0;c<=i;++c)s.push(e.read_shift(t&&t.biff==2?1:2));return s}function W4(e,a,t){var i=e[e.l+1]&255?1:0;return e.l+=2,[i,e.read_shift(t&&t.biff==2?1:2)]}function V4(e,a,t){var i=e[e.l+1]&255?1:0;return e.l+=2,[i,e.read_shift(t&&t.biff==2?1:2)]}function X4(e){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(2)]}function q4(e,a,t){var i=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[i]}function Cy(e){var a=e.read_shift(1),t=e.read_shift(1);return[a,t]}function K4(e){return e.read_shift(2),Cy(e)}function J4(e){return e.read_shift(2),Cy(e)}function Q4(e,a,t){var i=(e[e.l]&96)>>5;e.l+=1;var s=_y(e,0,t);return[i,s]}function Z4(e,a,t){var i=(e[e.l]&96)>>5;e.l+=1;var s=M4(e,0,t);return[i,s]}function e3(e,a,t){var i=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var c=_y(e,0,t);return[i,s,c]}function t3(e,a,t){var i=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(t&&t.biff<=3?1:2);return[nC[s],Ry[s],i]}function a3(e,a,t){var i=e[e.l++],s=e.read_shift(1),c=t&&t.biff<=3?[i==88?-1:0,e.read_shift(1)]:r3(e);return[s,(c[0]===0?Ry:rC)[c[1]]]}function r3(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function n3(e,a,t){e.l+=t&&t.biff==2?3:4}function i3(e,a,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var i=e.read_shift(2),s=e.read_shift(t&&t.biff==2?1:2);return[i,s]}function s3(e){return e.l++,rs[e.read_shift(1)]}function l3(e){return e.l++,e.read_shift(2)}function o3(e){return e.l++,e.read_shift(1)!==0}function c3(e){return e.l++,Ur(e)}function d3(e,a,t){return e.l++,l0(e,a-1,t)}function f3(e,a){var t=[e.read_shift(1)];if(a==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=qa(e,1)?"TRUE":"FALSE",a!=12&&(e.l+=7);break;case 37:case 16:t[1]=rs[e[e.l]],e.l+=a==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Ur(e);break;case 2:t[1]=jl(e,0,{biff:a>0&&a<8?2:a});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function u3(e,a,t){for(var i=e.read_shift(t.biff==12?4:2),s=[],c=0;c!=i;++c)s.push((t.biff==12?Fl:nf)(e));return s}function p3(e,a,t){var i=0,s=0;t.biff==12?(i=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),i=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--i,--s==0&&(s=256));for(var c=0,f=[];c!=i&&(f[c]=[]);++c)for(var p=0;p!=s;++p)f[c][p]=f3(e,t.biff);return f}function h3(e,a,t){var i=e.read_shift(1)>>>5&3,s=!t||t.biff>=8?4:2,c=e.read_shift(s);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[i,0,c]}function g3(e,a,t){if(t.biff==5)return x3(e);var i=e.read_shift(1)>>>5&3,s=e.read_shift(2),c=e.read_shift(4);return[i,s,c]}function x3(e){var a=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var i=e.read_shift(2);return e.l+=12,[a,t,i]}function m3(e,a,t){var i=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var s=e.read_shift(t&&t.biff==2?1:2);return[i,s]}function v3(e,a,t){var i=e.read_shift(1)>>>5&3,s=e.read_shift(t&&t.biff==2?1:2);return[i,s]}function y3(e,a,t){var i=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[i]}function b3(e,a,t){var i=(e[e.l++]&96)>>5,s=e.read_shift(2),c=4;if(t)switch(t.biff){case 5:c=15;break;case 12:c=6;break}return e.l+=c,[i,s]}var S3=$r,E3=$r,T3=$r;function c0(e,a,t){return e.l+=2,[B4(e)]}function mh(e){return e.l+=6,[]}var A3=c0,_3=mh,C3=mh,k3=c0;function ky(e){return e.l+=2,[ir(e),e.read_shift(2)&1]}var w3=c0,R3=ky,N3=mh,F3=c0,j3=c0,D3=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function O3(e){e.l+=2;var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(4),s=e.read_shift(2),c=e.read_shift(2),f=D3[t>>2&31];return{ixti:a,coltype:t&3,rt:f,idx:i,c:s,C:c}}function I3(e){return e.l+=2,[e.read_shift(4)]}function B3(e,a,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function M3(e,a,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function L3(e){var a=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[a,t]}function P3(e){var a=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[a,t]}function z3(e){return e.l+=4,[0,0]}var Rm={1:{n:"PtgExp",f:i3},2:{n:"PtgTbl",f:T3},3:{n:"PtgAdd",f:rr},4:{n:"PtgSub",f:rr},5:{n:"PtgMul",f:rr},6:{n:"PtgDiv",f:rr},7:{n:"PtgPower",f:rr},8:{n:"PtgConcat",f:rr},9:{n:"PtgLt",f:rr},10:{n:"PtgLe",f:rr},11:{n:"PtgEq",f:rr},12:{n:"PtgGe",f:rr},13:{n:"PtgGt",f:rr},14:{n:"PtgNe",f:rr},15:{n:"PtgIsect",f:rr},16:{n:"PtgUnion",f:rr},17:{n:"PtgRange",f:rr},18:{n:"PtgUplus",f:rr},19:{n:"PtgUminus",f:rr},20:{n:"PtgPercent",f:rr},21:{n:"PtgParen",f:rr},22:{n:"PtgMissArg",f:rr},23:{n:"PtgStr",f:d3},26:{n:"PtgSheet",f:B3},27:{n:"PtgEndSheet",f:M3},28:{n:"PtgErr",f:s3},29:{n:"PtgBool",f:o3},30:{n:"PtgInt",f:l3},31:{n:"PtgNum",f:c3},32:{n:"PtgArray",f:G4},33:{n:"PtgFunc",f:t3},34:{n:"PtgFuncVar",f:a3},35:{n:"PtgName",f:h3},36:{n:"PtgRef",f:Q4},37:{n:"PtgArea",f:P4},38:{n:"PtgMemArea",f:m3},39:{n:"PtgMemErr",f:S3},40:{n:"PtgMemNoMem",f:E3},41:{n:"PtgMemFunc",f:v3},42:{n:"PtgRefErr",f:y3},43:{n:"PtgAreaErr",f:U4},44:{n:"PtgRefN",f:Z4},45:{n:"PtgAreaN",f:$4},46:{n:"PtgMemAreaN",f:L3},47:{n:"PtgMemNoMemN",f:P3},57:{n:"PtgNameX",f:g3},58:{n:"PtgRef3d",f:e3},59:{n:"PtgArea3d",f:z4},60:{n:"PtgRefErr3d",f:b3},61:{n:"PtgAreaErr3d",f:H4},255:{}},U3={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},H3={1:{n:"PtgElfLel",f:ky},2:{n:"PtgElfRw",f:F3},3:{n:"PtgElfCol",f:A3},6:{n:"PtgElfRwV",f:j3},7:{n:"PtgElfColV",f:k3},10:{n:"PtgElfRadical",f:w3},11:{n:"PtgElfRadicalS",f:N3},13:{n:"PtgElfColS",f:_3},15:{n:"PtgElfColSV",f:C3},16:{n:"PtgElfRadicalLel",f:R3},25:{n:"PtgList",f:O3},29:{n:"PtgSxName",f:I3},255:{}},$3={0:{n:"PtgAttrNoop",f:z3},1:{n:"PtgAttrSemi",f:q4},2:{n:"PtgAttrIf",f:V4},4:{n:"PtgAttrChoose",f:Y4},8:{n:"PtgAttrGoto",f:W4},16:{n:"PtgAttrSum",f:n3},32:{n:"PtgAttrBaxcel",f:wm},33:{n:"PtgAttrBaxcel",f:wm},64:{n:"PtgAttrSpace",f:K4},65:{n:"PtgAttrSpaceSemi",f:J4},128:{n:"PtgAttrIfError",f:X4},255:{}};function d0(e,a,t,i){if(i.biff<8)return $r(e,a);for(var s=e.l+a,c=[],f=0;f!==t.length;++f)switch(t[f][0]){case"PtgArray":t[f][1]=p3(e,0,i),c.push(t[f][1]);break;case"PtgMemArea":t[f][2]=u3(e,t[f][1],i),c.push(t[f][2]);break;case"PtgExp":i&&i.biff==12&&(t[f][1][1]=e.read_shift(4),c.push(t[f][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[f][0]}return a=s-e.l,a!==0&&c.push($r(e,a)),c}function f0(e,a,t){for(var i=e.l+a,s,c,f=[];i!=e.l;)a=i-e.l,c=e[e.l],s=Rm[c]||Rm[U3[c]],(c===24||c===25)&&(s=(c===24?H3:$3)[e[e.l+1]]),!s||!s.f?$r(e,a):f.push([s.n,s.f(e,a,t)]);return f}function G3(e){for(var a=[],t=0;t<e.length;++t){for(var i=e[t],s=[],c=0;c<i.length;++c){var f=i[c];f?f[0]===2?s.push('"'+f[1].replace(/"/g,'""')+'"'):s.push(f[1]):s.push("")}a.push(s.join(","))}return a.join(";")}var Y3={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function W3(e,a){if(!e&&!(a&&a.biff<=5&&a.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function wy(e,a,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[a]))return e.SheetNames[a];if(!e.XTI)return"SH33TJSERR6";var i=e.XTI[a];if(t.biff<8)return a>1e4&&(a-=65536),a<0&&(a=-a),a==0?"":e.XTI[a-1];if(!i)return"SH33TJSERR1";var s="";if(t.biff>8)switch(e[i[0]][0]){case 357:return s=i[1]==-1?"#REF":e.SheetNames[i[1]],i[1]==i[2]?s:s+":"+e.SheetNames[i[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[i[0]][0];default:return"SH33TJSSRC"+e[i[0]][0]}switch(e[i[0]][0][0]){case 1025:return s=i[1]==-1?"#REF":e.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?s:s+":"+e.SheetNames[i[2]];case 14849:return e[i[0]].slice(1).map(function(c){return c.Name}).join(";;");default:return e[i[0]][0][3]?(s=i[1]==-1?"#REF":e[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?s:s+":"+e[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function Nm(e,a,t){var i=wy(e,a,t);return i=="#REF"?i:W3(i,t)}function Pr(e,a,t,i,s){var c=s&&s.biff||8,f={s:{c:0,r:0}},p=[],g,h,E,A=0,_=0,w,N="";if(!e[0]||!e[0][0])return"";for(var k=-1,F="",z=0,q=e[0].length;z<q;++z){var B=e[0][z];switch(B[0]){case"PtgUminus":p.push("-"+p.pop());break;case"PtgUplus":p.push("+"+p.pop());break;case"PtgPercent":p.push(p.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(g=p.pop(),h=p.pop(),k>=0){switch(e[0][k][1][0]){case 0:F=Pa(" ",e[0][k][1][1]);break;case 1:F=Pa("\r",e[0][k][1][1]);break;default:if(F="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][k][1][0])}h=h+F,k=-1}p.push(h+Y3[B[0]]+g);break;case"PtgIsect":g=p.pop(),h=p.pop(),p.push(h+" "+g);break;case"PtgUnion":g=p.pop(),h=p.pop(),p.push(h+","+g);break;case"PtgRange":g=p.pop(),h=p.pop(),p.push(h+":"+g);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":E=Lc(B[1][1],f,s),p.push(Pc(E,c));break;case"PtgRefN":E=t?Lc(B[1][1],t,s):B[1][1],p.push(Pc(E,c));break;case"PtgRef3d":A=B[1][1],E=Lc(B[1][2],f,s),N=Nm(i,A,s),p.push(N+"!"+Pc(E,c));break;case"PtgFunc":case"PtgFuncVar":var ie=B[1][0],se=B[1][1];ie||(ie=0),ie&=127;var ne=ie==0?[]:p.slice(-ie);p.length-=ie,se==="User"&&(se=ne.shift()),p.push(se+"("+ne.join(",")+")");break;case"PtgBool":p.push(B[1]?"TRUE":"FALSE");break;case"PtgInt":p.push(B[1]);break;case"PtgNum":p.push(String(B[1]));break;case"PtgStr":p.push('"'+B[1].replace(/"/g,'""')+'"');break;case"PtgErr":p.push(B[1]);break;case"PtgAreaN":w=im(B[1][1],t?{s:t}:f,s),p.push(xp(w,s));break;case"PtgArea":w=im(B[1][1],f,s),p.push(xp(w,s));break;case"PtgArea3d":A=B[1][1],w=B[1][2],N=Nm(i,A,s),p.push(N+"!"+xp(w,s));break;case"PtgAttrSum":p.push("SUM("+p.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=B[1][2];var H=(i.names||[])[_-1]||(i[0]||[])[_],le=H?H.Name:"SH33TJSNAME"+String(_);le&&le.slice(0,6)=="_xlfn."&&!s.xlfn&&(le=le.slice(6)),p.push(le);break;case"PtgNameX":var oe=B[1][1];_=B[1][2];var m;if(s.biff<=5)oe<0&&(oe=-oe),i[oe]&&(m=i[oe][_]);else{var Se="";if(((i[oe]||[])[0]||[])[0]==14849||(((i[oe]||[])[0]||[])[0]==1025?i[oe][_]&&i[oe][_].itab>0&&(Se=i.SheetNames[i[oe][_].itab-1]+"!"):Se=i.SheetNames[_-1]+"!"),i[oe]&&i[oe][_])Se+=i[oe][_].Name;else if(i[0]&&i[0][_])Se+=i[0][_].Name;else{var ue=(wy(i,oe,s)||"").split(";;");ue[_-1]?Se=ue[_-1]:Se+="SH33TJSERRX"}p.push(Se);break}m||(m={Name:"SH33TJSERRY"}),p.push(m.Name);break;case"PtgParen":var Pe="(",tt=")";if(k>=0){switch(F="",e[0][k][1][0]){case 2:Pe=Pa(" ",e[0][k][1][1])+Pe;break;case 3:Pe=Pa("\r",e[0][k][1][1])+Pe;break;case 4:tt=Pa(" ",e[0][k][1][1])+tt;break;case 5:tt=Pa("\r",e[0][k][1][1])+tt;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][k][1][0])}k=-1}p.push(Pe+p.pop()+tt);break;case"PtgRefErr":p.push("#REF!");break;case"PtgRefErr3d":p.push("#REF!");break;case"PtgExp":E={c:B[1][1],r:B[1][0]};var ke={c:t.c,r:t.r};if(i.sharedf[vt(E)]){var de=i.sharedf[vt(E)];p.push(Pr(de,f,ke,i,s))}else{var _e=!1;for(g=0;g!=i.arrayf.length;++g)if(h=i.arrayf[g],!(E.c<h[0].s.c||E.c>h[0].e.c)&&!(E.r<h[0].s.r||E.r>h[0].e.r)){p.push(Pr(h[1],f,ke,i,s)),_e=!0;break}_e||p.push(B[1])}break;case"PtgArray":p.push("{"+G3(B[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":k=z;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":p.push("");break;case"PtgAreaErr":p.push("#REF!");break;case"PtgAreaErr3d":p.push("#REF!");break;case"PtgList":p.push("Table"+B[1].idx+"[#"+B[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(B));default:throw new Error("Unrecognized Formula Token: "+String(B))}var Ze=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&k>=0&&Ze.indexOf(e[0][z][0])==-1){B=e[0][k];var fe=!0;switch(B[1][0]){case 4:fe=!1;case 0:F=Pa(" ",B[1][1]);break;case 5:fe=!1;case 1:F=Pa("\r",B[1][1]);break;default:if(F="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+B[1][0])}p.push((fe?F:"")+p.pop()+(fe?"":F)),k=-1}}if(p.length>1&&s.WTF)throw new Error("bad formula stack");return p[0]}function V3(e,a,t){var i=e.l+a,s=t.biff==2?1:2,c,f=e.read_shift(s);if(f==65535)return[[],$r(e,a-2)];var p=f0(e,f,t);return a!==f+s&&(c=d0(e,a-f-s,p,t)),e.l=i,[p,c]}function X3(e,a,t){var i=e.l+a,s=t.biff==2?1:2,c,f=e.read_shift(s);if(f==65535)return[[],$r(e,a-2)];var p=f0(e,f,t);return a!==f+s&&(c=d0(e,a-f-s,p,t)),e.l=i,[p,c]}function q3(e,a,t,i){var s=e.l+a,c=f0(e,i,t),f;return s!==e.l&&(f=d0(e,s-e.l,c,t)),[c,f]}function K3(e,a,t){var i=e.l+a,s,c=e.read_shift(2),f=f0(e,c,t);return c==65535?[[],$r(e,a-2)]:(a!==c+2&&(s=d0(e,i-c-2,f,t)),[f,s])}function J3(e){var a;if(Ki(e,e.l+6)!==65535)return[Ur(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return a=e[e.l+2]===1,e.l+=8,[a,"b"];case 2:return a=e[e.l+2],e.l+=8,[a,"e"];case 3:return e.l+=8,["","s"]}return[]}function Q3(e){if(e==null){var a=Ne(8);return a.write_shift(1,3),a.write_shift(1,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,65535),a}else if(typeof e=="number")return Tl(e);return Tl(0)}function Sp(e,a,t){var i=e.l+a,s=Ci(e);t.biff==2&&++e.l;var c=J3(e),f=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var p=X3(e,i-e.l,t);return{cell:s,val:c[0],formula:p,shared:f>>3&1,tt:c[1]}}function Z3(e,a,t,i,s){var c=_l(a,t,s),f=Q3(e.v),p=Ne(6),g=33;p.write_shift(2,g),p.write_shift(4,0);for(var h=Ne(e.bf.length),E=0;E<e.bf.length;++E)h[E]=e.bf[E];var A=br([c,f,p,h]);return A}function sf(e,a,t){var i=e.read_shift(4),s=f0(e,i,t),c=e.read_shift(4),f=c>0?d0(e,c,s,t):null;return[s,f]}var eC=sf,lf=sf,tC=sf,aC=sf,rC={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ry={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},nC={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Fm(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(a,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function iC(e){var a="of:="+e.replace(gh,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return a.replace(/;/g,"|").replace(/,/g,";")}function Ep(e){var a=e.split(":"),t=a[0].split(".")[0];return[t,a[0].split(".")[1]+(a.length>1?":"+(a[1].split(".")[1]||a[1].split(".")[0]):"")]}function sC(e){return e.replace(/\./,"!")}var Uc={},Co={},Hc=typeof Map<"u";function vh(e,a,t){var i=0,s=e.length;if(t){if(Hc?t.has(a):Object.prototype.hasOwnProperty.call(t,a)){for(var c=Hc?t.get(a):t[a];i<c.length;++i)if(e[c[i]].t===a)return e.Count++,c[i]}}else for(;i<s;++i)if(e[i].t===a)return e.Count++,i;return e[s]={t:a},e.Count++,e.Unique++,t&&(Hc?(t.has(a)||t.set(a,[]),t.get(a).push(s)):(Object.prototype.hasOwnProperty.call(t,a)||(t[a]=[]),t[a].push(s))),s}function of(e,a){var t={min:e+1,max:e+1},i=-1;return a.MDW&&(zr=a.MDW),a.width!=null?t.customWidth=1:a.wpx!=null?i=e0(a.wpx):a.wch!=null&&(i=a.wch),i>-1?(t.width=Kd(i),t.customWidth=1):a.width!=null&&(t.width=a.width),a.hidden&&(t.hidden=!0),a.level!=null&&(t.outlineLevel=t.level=a.level),t}function bl(e,a){if(e){var t=[.7,.7,.75,.75,.3,.3];a=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function Gs(e,a,t){var i=t.revssf[a.z!=null?a.z:"General"],s=60,c=e.length;if(i==null&&t.ssf){for(;s<392;++s)if(t.ssf[s]==null){Qi(a.z,s),t.ssf[s]=a.z,t.revssf[a.z]=i=s;break}}for(s=0;s!=c;++s)if(e[s].numFmtId===i)return s;return e[c]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},c}function Ny(e,a,t,i,s,c){try{i.cellNF&&(e.z=mt[a])}catch(p){if(i.WTF)throw p}if(!(e.t==="z"&&!i.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ka(e.v)),(!i||i.cellText!==!1)&&e.t!=="z")try{if(mt[a]==null&&Qi(rS[a]||"General",a),e.t==="e")e.w=e.w||rs[e.v];else if(a===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Vc(e.v);else if(e.t==="d"){var f=pr(e.v);(f|0)===f?e.w=f.toString(10):e.w=Vc(f)}else{if(e.v===void 0)return"";e.w=Sl(e.v,Co)}else e.t==="d"?e.w=Wn(a,pr(e.v),Co):e.w=Wn(a,e.v,Co)}catch(p){if(i.WTF)throw p}if(i.cellStyles&&t!=null)try{e.s=c.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=qd(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),i.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=qd(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),i.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(p){if(i.WTF&&c.Fills)throw p}}}function lC(e,a,t){if(e&&e["!ref"]){var i=Kt(e["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function oC(e,a){var t=Kt(a);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=wt(t))}var cC=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,dC=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,fC=/<(?:\w:)?hyperlink [^>]*>/mg,uC=/"(\w*:\w*)"/,pC=/<(?:\w:)?col\b[^>]*[\/]?>/g,hC=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,gC=/<(?:\w:)?pageMargins[^>]*\/>/g,Fy=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,xC=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,mC=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function vC(e,a,t,i,s,c,f){if(!e)return e;i||(i={"!id":{}});var p=a.dense?[]:{},g={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",E="",A=e.match(dC);A?(h=e.slice(0,A.index),E=e.slice(A.index+A[0].length)):h=E=e;var _=h.match(Fy);_?yh(_[0],p,s,t):(_=h.match(xC))&&bC(_[0],_[1]||"",p,s,t);var w=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(w>0){var N=h.slice(w,w+50).match(uC);N&&oC(p,N[1])}var k=h.match(mC);k&&k[1]&&DC(k[1],s);var F=[];if(a.cellStyles){var z=h.match(pC);z&&wC(F,z)}A&&BC(A[1],p,a,g,c,f);var q=E.match(hC);q&&(p["!autofilter"]=NC(q[0]));var B=[],ie=E.match(cC);if(ie)for(w=0;w!=ie.length;++w)B[w]=Kt(ie[w].slice(ie[w].indexOf('"')+1));var se=E.match(fC);se&&_C(p,se,i);var ne=E.match(gC);if(ne&&(p["!margins"]=CC(bt(ne[0]))),!p["!ref"]&&g.e.c>=g.s.c&&g.e.r>=g.s.r&&(p["!ref"]=wt(g)),a.sheetRows>0&&p["!ref"]){var H=Kt(p["!ref"]);a.sheetRows<=+H.e.r&&(H.e.r=a.sheetRows-1,H.e.r>g.e.r&&(H.e.r=g.e.r),H.e.r<H.s.r&&(H.s.r=H.e.r),H.e.c>g.e.c&&(H.e.c=g.e.c),H.e.c<H.s.c&&(H.s.c=H.e.c),p["!fullref"]=p["!ref"],p["!ref"]=wt(H))}return F.length>0&&(p["!cols"]=F),B.length>0&&(p["!merges"]=B),p}function yC(e){if(e.length===0)return"";for(var a='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)a+='<mergeCell ref="'+wt(e[t])+'"/>';return a+"</mergeCells>"}function yh(e,a,t,i){var s=bt(e);t.Sheets[i]||(t.Sheets[i]={}),s.codeName&&(t.Sheets[i].CodeName=qt(ga(s.codeName)))}function bC(e,a,t,i,s){yh(e.slice(0,e.indexOf(">")),t,i,s)}function SC(e,a,t,i,s){var c=!1,f={},p=null;if(i.bookType!=="xlsx"&&a.vbaraw){var g=a.SheetNames[t];try{a.Workbook&&(g=a.Workbook.Sheets[t].CodeName||g)}catch{}c=!0,f.codeName=Ai(fa(g))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),p=(p||"")+Ke("outlinePr",null,h)}!c&&!p||(s[s.length]=Ke("sheetPr",p,f))}var EC=["objects","scenarios","selectLockedCells","selectUnlockedCells"],TC=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function AC(e){var a={sheet:1};return EC.forEach(function(t){e[t]!=null&&e[t]&&(a[t]="1")}),TC.forEach(function(t){e[t]!=null&&!e[t]&&(a[t]="0")}),e.password&&(a.password=uh(e.password).toString(16).toUpperCase()),Ke("sheetProtection",null,a)}function _C(e,a,t){for(var i=Array.isArray(e),s=0;s!=a.length;++s){var c=bt(ga(a[s]),!0);if(!c.ref)return;var f=((t||{})["!id"]||[])[c.id];f?(c.Target=f.Target,c.location&&(c.Target+="#"+qt(c.location))):(c.Target="#"+qt(c.location),f={Target:c.Target,TargetMode:"Internal"}),c.Rel=f,c.tooltip&&(c.Tooltip=c.tooltip,delete c.tooltip);for(var p=Kt(c.ref),g=p.s.r;g<=p.e.r;++g)for(var h=p.s.c;h<=p.e.c;++h){var E=vt({c:h,r:g});i?(e[g]||(e[g]=[]),e[g][h]||(e[g][h]={t:"z",v:void 0}),e[g][h].l=c):(e[E]||(e[E]={t:"z",v:void 0}),e[E].l=c)}}}function CC(e){var a={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(a[t]=parseFloat(e[t]))}),a}function kC(e){return bl(e),Ke("pageMargins",null,e)}function wC(e,a){for(var t=!1,i=0;i!=a.length;++i){var s=bt(a[i],!0);s.hidden&&(s.hidden=Ca(s.hidden));var c=parseInt(s.min,10)-1,f=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!t&&s.width&&(t=!0,ph(s.width)),Ps(s);c<=f;)e[c++]=wa(s)}}function RC(e,a){for(var t=["<cols>"],i,s=0;s!=a.length;++s)(i=a[s])&&(t[t.length]=Ke("col",null,of(s,i)));return t[t.length]="</cols>",t.join("")}function NC(e){var a={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return a}function FC(e,a,t,i){var s=typeof e.ref=="string"?e.ref:wt(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var c=t.Workbook.Names,f=un(s);f.s.r==f.e.r&&(f.e.r=un(a["!ref"]).e.r,s=wt(f));for(var p=0;p<c.length;++p){var g=c[p];if(g.Name=="_xlnm._FilterDatabase"&&g.Sheet==i){g.Ref="'"+t.SheetNames[i]+"'!"+s;break}}return p==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+s}),Ke("autoFilter",null,{ref:s})}var jC=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function DC(e,a){a.Views||(a.Views=[{}]),(e.match(jC)||[]).forEach(function(t,i){var s=bt(t);a.Views[i]||(a.Views[i]={}),+s.zoomScale&&(a.Views[i].zoom=+s.zoomScale),Ca(s.rightToLeft)&&(a.Views[i].RTL=!0)})}function OC(e,a,t,i){var s={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),Ke("sheetViews",Ke("sheetView",null,s),{})}function IC(e,a,t,i){if(e.c&&t["!comments"].push([a,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",c=e.t,f=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=rs[e.v];break;case"d":i&&i.cellDates?s=ka(e.v,-1).toISOString():(e=wa(e),e.t="n",s=""+(e.v=pr(ka(e.v)))),typeof e.z>"u"&&(e.z=mt[14]);break;default:s=e.v;break}var p=jr("v",fa(s)),g={r:a},h=Gs(i.cellXfs,e,i);switch(h!==0&&(g.s=h),e.t){case"n":break;case"d":g.t="d";break;case"b":g.t="b";break;case"e":g.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){p=jr("v",""+vh(i.Strings,e.v,i.revStrings)),g.t="s";break}g.t="str";break}if(e.t!=c&&(e.t=c,e.v=f),typeof e.f=="string"&&e.f){var E=e.F&&e.F.slice(0,a.length)==a?{t:"array",ref:e.F}:null;p=Ke("f",fa(e.f),E)+(e.v!=null?p:"")}return e.l&&t["!links"].push([a,e.l]),e.D&&(g.cm=1),Ke("c",p,g)}var BC=(function(){var e=/<(?:\w+:)?c[ \/>]/,a=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,i=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,c=Xc("v"),f=Xc("f");return function(g,h,E,A,_,w){for(var N=0,k="",F=[],z=[],q=0,B=0,ie=0,se="",ne,H,le=0,oe=0,m,Se,ue=0,Pe=0,tt=Array.isArray(w.CellXf),ke,de=[],_e=[],Ze=Array.isArray(h),fe=[],Je={},ee=!1,O=!!E.sheetStubs,L=g.split(a),K=0,te=L.length;K!=te;++K){k=L[K].trim();var he=k.length;if(he!==0){var Oe=0;e:for(N=0;N<he;++N)switch(k[N]){case">":if(k[N-1]!="/"){++N;break e}if(E&&E.cellStyles){if(H=bt(k.slice(Oe,N),!0),le=H.r!=null?parseInt(H.r,10):le+1,oe=-1,E.sheetRows&&E.sheetRows<le)continue;Je={},ee=!1,H.ht&&(ee=!0,Je.hpt=parseFloat(H.ht),Je.hpx=Ro(Je.hpt)),H.hidden=="1"&&(ee=!0,Je.hidden=!0),H.outlineLevel!=null&&(ee=!0,Je.level=+H.outlineLevel),ee&&(fe[le-1]=Je)}break;case"<":Oe=N;break}if(Oe>=N)break;if(H=bt(k.slice(Oe,N),!0),le=H.r!=null?parseInt(H.r,10):le+1,oe=-1,!(E.sheetRows&&E.sheetRows<le)){A.s.r>le-1&&(A.s.r=le-1),A.e.r<le-1&&(A.e.r=le-1),E&&E.cellStyles&&(Je={},ee=!1,H.ht&&(ee=!0,Je.hpt=parseFloat(H.ht),Je.hpx=Ro(Je.hpt)),H.hidden=="1"&&(ee=!0,Je.hidden=!0),H.outlineLevel!=null&&(ee=!0,Je.level=+H.outlineLevel),ee&&(fe[le-1]=Je)),F=k.slice(N).split(e);for(var Ue=0;Ue!=F.length&&F[Ue].trim().charAt(0)=="<";++Ue);for(F=F.slice(Ue),N=0;N!=F.length;++N)if(k=F[N].trim(),k.length!==0){if(z=k.match(t),q=N,B=0,ie=0,k="<c "+(k.slice(0,1)=="<"?">":"")+k,z!=null&&z.length===2){for(q=0,se=z[1],B=0;B!=se.length&&!((ie=se.charCodeAt(B)-64)<1||ie>26);++B)q=26*q+ie;--q,oe=q}else++oe;for(B=0;B!=k.length&&k.charCodeAt(B)!==62;++B);if(++B,H=bt(k.slice(0,B),!0),H.r||(H.r=vt({r:le-1,c:oe})),se=k.slice(B),ne={t:""},(z=se.match(c))!=null&&z[1]!==""&&(ne.v=qt(z[1])),E.cellFormula){if((z=se.match(f))!=null&&z[1]!==""){if(ne.f=qt(ga(z[1])).replace(/\r\n/g,`
`),E.xlfn||(ne.f=km(ne.f)),z[0].indexOf('t="array"')>-1)ne.F=(se.match(s)||[])[1],ne.F.indexOf(":")>-1&&de.push([Kt(ne.F),ne.F]);else if(z[0].indexOf('t="shared"')>-1){Se=bt(z[0]);var Ie=qt(ga(z[1]));E.xlfn||(Ie=km(Ie)),_e[parseInt(Se.si,10)]=[Se,Ie,H.r]}}else(z=se.match(/<f[^>]*\/>/))&&(Se=bt(z[0]),_e[Se.si]&&(ne.f=j4(_e[Se.si][1],_e[Se.si][2],H.r)));var He=Ia(H.r);for(B=0;B<de.length;++B)He.r>=de[B][0].s.r&&He.r<=de[B][0].e.r&&He.c>=de[B][0].s.c&&He.c<=de[B][0].e.c&&(ne.F=de[B][1])}if(H.t==null&&ne.v===void 0)if(ne.f||ne.F)ne.v=0,ne.t="n";else if(O)ne.t="z";else continue;else ne.t=H.t||"n";switch(A.s.c>oe&&(A.s.c=oe),A.e.c<oe&&(A.e.c=oe),ne.t){case"n":if(ne.v==""||ne.v==null){if(!O)continue;ne.t="z"}else ne.v=parseFloat(ne.v);break;case"s":if(typeof ne.v>"u"){if(!O)continue;ne.t="z"}else m=Uc[parseInt(ne.v,10)],ne.v=m.t,ne.r=m.r,E.cellHTML&&(ne.h=m.h);break;case"str":ne.t="s",ne.v=ne.v!=null?ga(ne.v):"",E.cellHTML&&(ne.h=Jp(ne.v));break;case"inlineStr":z=se.match(i),ne.t="s",z!=null&&(m=fh(z[1]))?(ne.v=m.t,E.cellHTML&&(ne.h=m.h)):ne.v="";break;case"b":ne.v=Ca(ne.v);break;case"d":E.cellDates?ne.v=ka(ne.v,1):(ne.v=pr(ka(ne.v,1)),ne.t="n");break;case"e":(!E||E.cellText!==!1)&&(ne.w=ne.v),ne.v=Dv[ne.v];break}if(ue=Pe=0,ke=null,tt&&H.s!==void 0&&(ke=w.CellXf[H.s],ke!=null&&(ke.numFmtId!=null&&(ue=ke.numFmtId),E.cellStyles&&ke.fillId!=null&&(Pe=ke.fillId))),Ny(ne,ue,Pe,E,_,w),E.cellDates&&tt&&ne.t=="n"&&No(mt[ue])&&(ne.t="d",ne.v=rf(ne.v)),H.cm&&E.xlmeta){var gt=(E.xlmeta.Cell||[])[+H.cm-1];gt&&gt.type=="XLDAPR"&&(ne.D=!0)}if(Ze){var Z=Ia(H.r);h[Z.r]||(h[Z.r]=[]),h[Z.r][Z.c]=ne}else h[H.r]=ne}}}}fe.length>0&&(h["!rows"]=fe)}})();function MC(e,a,t,i){var s=[],c=[],f=Kt(e["!ref"]),p="",g,h="",E=[],A=0,_=0,w=e["!rows"],N=Array.isArray(e),k={r:h},F,z=-1;for(_=f.s.c;_<=f.e.c;++_)E[_]=Oa(_);for(A=f.s.r;A<=f.e.r;++A){for(c=[],h=Ka(A),_=f.s.c;_<=f.e.c;++_){g=E[_]+h;var q=N?(e[A]||[])[_]:e[g];q!==void 0&&(p=IC(q,g,e,a))!=null&&c.push(p)}(c.length>0||w&&w[A])&&(k={r:h},w&&w[A]&&(F=w[A],F.hidden&&(k.hidden=1),z=-1,F.hpx?z=t0(F.hpx):F.hpt&&(z=F.hpt),z>-1&&(k.ht=z,k.customHeight=1),F.level&&(k.outlineLevel=F.level)),s[s.length]=Ke("row",c.join(""),k))}if(w)for(;A<w.length;++A)w&&w[A]&&(k={r:A+1},F=w[A],F.hidden&&(k.hidden=1),z=-1,F.hpx?z=t0(F.hpx):F.hpt&&(z=F.hpt),z>-1&&(k.ht=z,k.customHeight=1),F.level&&(k.outlineLevel=F.level),s[s.length]=Ke("row","",k));return s.join("")}function jy(e,a,t,i){var s=[Ja,Ke("worksheet",null,{xmlns:kl[0],"xmlns:r":ur.r})],c=t.SheetNames[e],f=0,p="",g=t.Sheets[c];g==null&&(g={});var h=g["!ref"]||"A1",E=Kt(h);if(E.e.c>16383||E.e.r>1048575){if(a.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");E.e.c=Math.min(E.e.c,16383),E.e.r=Math.min(E.e.c,1048575),h=wt(E)}i||(i={}),g["!comments"]=[];var A=[];SC(g,t,e,a,s),s[s.length]=Ke("dimension",null,{ref:h}),s[s.length]=OC(g,a,e,t),a.sheetFormat&&(s[s.length]=Ke("sheetFormatPr",null,{defaultRowHeight:a.sheetFormat.defaultRowHeight||"16",baseColWidth:a.sheetFormat.baseColWidth||"10",outlineLevelRow:a.sheetFormat.outlineLevelRow||"7"})),g["!cols"]!=null&&g["!cols"].length>0&&(s[s.length]=RC(g,g["!cols"])),s[f=s.length]="<sheetData/>",g["!links"]=[],g["!ref"]!=null&&(p=MC(g,a),p.length>0&&(s[s.length]=p)),s.length>f+1&&(s[s.length]="</sheetData>",s[f]=s[f].replace("/>",">")),g["!protect"]&&(s[s.length]=AC(g["!protect"])),g["!autofilter"]!=null&&(s[s.length]=FC(g["!autofilter"],g,t,e)),g["!merges"]!=null&&g["!merges"].length>0&&(s[s.length]=yC(g["!merges"]));var _=-1,w,N=-1;return g["!links"].length>0&&(s[s.length]="<hyperlinks>",g["!links"].forEach(function(k){k[1].Target&&(w={ref:k[0]},k[1].Target.charAt(0)!="#"&&(N=da(i,-1,fa(k[1].Target).replace(/#.*$/,""),Bt.HLINK),w["r:id"]="rId"+N),(_=k[1].Target.indexOf("#"))>-1&&(w.location=fa(k[1].Target.slice(_+1))),k[1].Tooltip&&(w.tooltip=fa(k[1].Tooltip)),s[s.length]=Ke("hyperlink",null,w))}),s[s.length]="</hyperlinks>"),delete g["!links"],g["!margins"]!=null&&(s[s.length]=kC(g["!margins"])),(!a||a.ignoreEC||a.ignoreEC==null)&&(s[s.length]=jr("ignoredErrors",Ke("ignoredError",null,{numberStoredAsText:1,sqref:h}))),A.length>0&&(N=da(i,-1,"../drawings/drawing"+(e+1)+".xml",Bt.DRAW),s[s.length]=Ke("drawing",null,{"r:id":"rId"+N}),g["!drawing"]=A),g["!comments"].length>0&&(N=da(i,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Bt.VML),s[s.length]=Ke("legacyDrawing",null,{"r:id":"rId"+N}),g["!legacy"]=N),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function LC(e,a){var t={},i=e.l+a;t.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var c=e.read_shift(1);return e.l=i,c&7&&(t.level=c&7),c&16&&(t.hidden=!0),c&32&&(t.hpt=s/20),t}function PC(e,a,t){var i=Ne(145),s=(t["!rows"]||[])[e]||{};i.write_shift(4,e),i.write_shift(4,0);var c=320;s.hpx?c=t0(s.hpx)*20:s.hpt&&(c=s.hpt*20),i.write_shift(2,c),i.write_shift(1,0);var f=0;s.level&&(f|=s.level),s.hidden&&(f|=16),(s.hpx||s.hpt)&&(f|=32),i.write_shift(1,f),i.write_shift(1,0);var p=0,g=i.l;i.l+=4;for(var h={r:e,c:0},E=0;E<16;++E)if(!(a.s.c>E+1<<10||a.e.c<E<<10)){for(var A=-1,_=-1,w=E<<10;w<E+1<<10;++w){h.c=w;var N=Array.isArray(t)?(t[h.r]||[])[h.c]:t[vt(h)];N&&(A<0&&(A=w),_=w)}A<0||(++p,i.write_shift(4,A),i.write_shift(4,_))}var k=i.l;return i.l=g,i.write_shift(4,p),i.l=k,i.length>i.l?i.slice(0,i.l):i}function zC(e,a,t,i){var s=PC(i,t,a);(s.length>17||(a["!rows"]||[])[i])&&$e(e,0,s)}var UC=Fl,HC=Do;function $C(){}function GC(e,a){var t={},i=e[e.l];return++e.l,t.above=!(i&64),t.left=!(i&128),e.l+=18,t.name=VS(e),t}function YC(e,a,t){t==null&&(t=Ne(84+4*e.length));var i=192;a&&(a.above&&(i&=-65),a.left&&(i&=-129)),t.write_shift(1,i);for(var s=1;s<3;++s)t.write_shift(1,0);return Wd({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),wv(e,t),t.slice(0,t.l)}function WC(e){var a=Vn(e);return[a]}function VC(e,a,t){return t==null&&(t=Ne(8)),wl(a,t)}function XC(e){var a=Rl(e);return[a]}function qC(e,a,t){return t==null&&(t=Ne(4)),Nl(a,t)}function KC(e){var a=Vn(e),t=e.read_shift(1);return[a,t,"b"]}function JC(e,a,t){return t==null&&(t=Ne(9)),wl(a,t),t.write_shift(1,e.v?1:0),t}function QC(e){var a=Rl(e),t=e.read_shift(1);return[a,t,"b"]}function ZC(e,a,t){return t==null&&(t=Ne(5)),Nl(a,t),t.write_shift(1,e.v?1:0),t}function ek(e){var a=Vn(e),t=e.read_shift(1);return[a,t,"e"]}function tk(e,a,t){return t==null&&(t=Ne(9)),wl(a,t),t.write_shift(1,e.v),t}function ak(e){var a=Rl(e),t=e.read_shift(1);return[a,t,"e"]}function rk(e,a,t){return t==null&&(t=Ne(8)),Nl(a,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function nk(e){var a=Vn(e),t=e.read_shift(4);return[a,t,"s"]}function ik(e,a,t){return t==null&&(t=Ne(12)),wl(a,t),t.write_shift(4,a.v),t}function sk(e){var a=Rl(e),t=e.read_shift(4);return[a,t,"s"]}function lk(e,a,t){return t==null&&(t=Ne(8)),Nl(a,t),t.write_shift(4,a.v),t}function ok(e){var a=Vn(e),t=Ur(e);return[a,t,"n"]}function ck(e,a,t){return t==null&&(t=Ne(16)),wl(a,t),Tl(e.v,t),t}function Dy(e){var a=Rl(e),t=Ur(e);return[a,t,"n"]}function dk(e,a,t){return t==null&&(t=Ne(12)),Nl(a,t),Tl(e.v,t),t}function fk(e){var a=Vn(e),t=sh(e);return[a,t,"n"]}function uk(e,a,t){return t==null&&(t=Ne(12)),wl(a,t),Rv(e.v,t),t}function pk(e){var a=Rl(e),t=sh(e);return[a,t,"n"]}function hk(e,a,t){return t==null&&(t=Ne(8)),Nl(a,t),Rv(e.v,t),t}function gk(e){var a=Vn(e),t=rh(e);return[a,t,"is"]}function xk(e){var a=Vn(e),t=Hr(e);return[a,t,"str"]}function mk(e,a,t){return t==null&&(t=Ne(12+4*e.v.length)),wl(a,t),Sr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function vk(e){var a=Rl(e),t=Hr(e);return[a,t,"str"]}function yk(e,a,t){return t==null&&(t=Ne(8+4*e.v.length)),Nl(a,t),Sr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function bk(e,a,t){var i=e.l+a,s=Vn(e);s.r=t["!row"];var c=e.read_shift(1),f=[s,c,"b"];if(t.cellFormula){e.l+=2;var p=lf(e,i-e.l,t);f[3]=Pr(p,null,s,t.supbooks,t)}else e.l=i;return f}function Sk(e,a,t){var i=e.l+a,s=Vn(e);s.r=t["!row"];var c=e.read_shift(1),f=[s,c,"e"];if(t.cellFormula){e.l+=2;var p=lf(e,i-e.l,t);f[3]=Pr(p,null,s,t.supbooks,t)}else e.l=i;return f}function Ek(e,a,t){var i=e.l+a,s=Vn(e);s.r=t["!row"];var c=Ur(e),f=[s,c,"n"];if(t.cellFormula){e.l+=2;var p=lf(e,i-e.l,t);f[3]=Pr(p,null,s,t.supbooks,t)}else e.l=i;return f}function Tk(e,a,t){var i=e.l+a,s=Vn(e);s.r=t["!row"];var c=Hr(e),f=[s,c,"str"];if(t.cellFormula){e.l+=2;var p=lf(e,i-e.l,t);f[3]=Pr(p,null,s,t.supbooks,t)}else e.l=i;return f}var Ak=Fl,_k=Do;function Ck(e,a){return a==null&&(a=Ne(4)),a.write_shift(4,e),a}function kk(e,a){var t=e.l+a,i=Fl(e),s=nh(e),c=Hr(e),f=Hr(e),p=Hr(e);e.l=t;var g={rfx:i,relId:s,loc:c,display:p};return f&&(g.Tooltip=f),g}function wk(e,a){var t=Ne(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Do({s:Ia(e[0]),e:Ia(e[0])},t),ih("rId"+a,t);var i=e[1].Target.indexOf("#"),s=i==-1?"":e[1].Target.slice(i+1);return Sr(s||"",t),Sr(e[1].Tooltip||"",t),Sr("",t),t.slice(0,t.l)}function Rk(){}function Nk(e,a,t){var i=e.l+a,s=Nv(e),c=e.read_shift(1),f=[s];if(f[2]=c,t.cellFormula){var p=eC(e,i-e.l,t);f[1]=p}else e.l=i;return f}function Fk(e,a,t){var i=e.l+a,s=Fl(e),c=[s];if(t.cellFormula){var f=aC(e,i-e.l,t);c[1]=f,e.l=i}else e.l=i;return c}function jk(e,a,t){t==null&&(t=Ne(18));var i=of(e,a);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(i.width||10)*256),t.write_shift(4,0);var s=0;return a.hidden&&(s|=1),typeof i.width=="number"&&(s|=2),a.level&&(s|=a.level<<8),t.write_shift(2,s),t}var Oy=["left","right","top","bottom","header","footer"];function Dk(e){var a={};return Oy.forEach(function(t){a[t]=Ur(e)}),a}function Ok(e,a){return a==null&&(a=Ne(48)),bl(e),Oy.forEach(function(t){Tl(e[t],a)}),a}function Ik(e){var a=e.read_shift(2);return e.l+=28,{RTL:a&32}}function Bk(e,a,t){t==null&&(t=Ne(30));var i=924;return(((a||{}).Views||[])[0]||{}).RTL&&(i|=32),t.write_shift(2,i),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function Mk(e){var a=Ne(24);return a.write_shift(4,4),a.write_shift(4,1),Do(e,a),a}function Lk(e,a){return a==null&&(a=Ne(66)),a.write_shift(2,e.password?uh(e.password):0),a.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?a.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):a.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),a}function Pk(){}function zk(){}function Uk(e,a,t,i,s,c,f){if(!e)return e;var p=a||{};i||(i={"!id":{}});var g=p.dense?[]:{},h,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},A=!1,_=!1,w,N,k,F,z,q,B,ie,se,ne=[];p.biff=12,p["!row"]=0;var H=0,le=!1,oe=[],m={},Se=p.supbooks||s.supbooks||[[]];if(Se.sharedf=m,Se.arrayf=oe,Se.SheetNames=s.SheetNames||s.Sheets.map(function(Ze){return Ze.name}),!p.supbooks&&(p.supbooks=Se,s.Names))for(var ue=0;ue<s.Names.length;++ue)Se[0][ue+1]=s.Names[ue];var Pe=[],tt=[],ke=!1;a0[16]={n:"BrtShortReal",f:Dy};var de;if(as(e,function(fe,Je,ee){if(!_)switch(ee){case 148:h=fe;break;case 0:w=fe,p.sheetRows&&p.sheetRows<=w.r&&(_=!0),ie=Ka(F=w.r),p["!row"]=w.r,(fe.hidden||fe.hpt||fe.level!=null)&&(fe.hpt&&(fe.hpx=Ro(fe.hpt)),tt[fe.r]=fe);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(N={t:fe[2]},fe[2]){case"n":N.v=fe[1];break;case"s":B=Uc[fe[1]],N.v=B.t,N.r=B.r;break;case"b":N.v=!!fe[1];break;case"e":N.v=fe[1],p.cellText!==!1&&(N.w=rs[N.v]);break;case"str":N.t="s",N.v=fe[1];break;case"is":N.t="s",N.v=fe[1].t;break}if((k=f.CellXf[fe[0].iStyleRef])&&Ny(N,k.numFmtId,null,p,c,f),z=fe[0].c==-1?z+1:fe[0].c,p.dense?(g[F]||(g[F]=[]),g[F][z]=N):g[Oa(z)+ie]=N,p.cellFormula){for(le=!1,H=0;H<oe.length;++H){var O=oe[H];w.r>=O[0].s.r&&w.r<=O[0].e.r&&z>=O[0].s.c&&z<=O[0].e.c&&(N.F=wt(O[0]),le=!0)}!le&&fe.length>3&&(N.f=fe[3])}if(E.s.r>w.r&&(E.s.r=w.r),E.s.c>z&&(E.s.c=z),E.e.r<w.r&&(E.e.r=w.r),E.e.c<z&&(E.e.c=z),p.cellDates&&k&&N.t=="n"&&No(mt[k.numFmtId])){var L=xl(N.v);L&&(N.t="d",N.v=new Date(L.y,L.m-1,L.d,L.H,L.M,L.S,L.u))}de&&(de.type=="XLDAPR"&&(N.D=!0),de=void 0);break;case 1:case 12:if(!p.sheetStubs||A)break;N={t:"z",v:void 0},z=fe[0].c==-1?z+1:fe[0].c,p.dense?(g[F]||(g[F]=[]),g[F][z]=N):g[Oa(z)+ie]=N,E.s.r>w.r&&(E.s.r=w.r),E.s.c>z&&(E.s.c=z),E.e.r<w.r&&(E.e.r=w.r),E.e.c<z&&(E.e.c=z),de&&(de.type=="XLDAPR"&&(N.D=!0),de=void 0);break;case 176:ne.push(fe);break;case 49:de=((p.xlmeta||{}).Cell||[])[fe-1];break;case 494:var K=i["!id"][fe.relId];for(K?(fe.Target=K.Target,fe.loc&&(fe.Target+="#"+fe.loc),fe.Rel=K):fe.relId==""&&(fe.Target="#"+fe.loc),F=fe.rfx.s.r;F<=fe.rfx.e.r;++F)for(z=fe.rfx.s.c;z<=fe.rfx.e.c;++z)p.dense?(g[F]||(g[F]=[]),g[F][z]||(g[F][z]={t:"z",v:void 0}),g[F][z].l=fe):(q=vt({c:z,r:F}),g[q]||(g[q]={t:"z",v:void 0}),g[q].l=fe);break;case 426:if(!p.cellFormula)break;oe.push(fe),se=p.dense?g[F][z]:g[Oa(z)+ie],se.f=Pr(fe[1],E,{r:w.r,c:z},Se,p),se.F=wt(fe[0]);break;case 427:if(!p.cellFormula)break;m[vt(fe[0].s)]=fe[1],se=p.dense?g[F][z]:g[Oa(z)+ie],se.f=Pr(fe[1],E,{r:w.r,c:z},Se,p);break;case 60:if(!p.cellStyles)break;for(;fe.e>=fe.s;)Pe[fe.e--]={width:fe.w/256,hidden:!!(fe.flags&1),level:fe.level},ke||(ke=!0,ph(fe.w/256)),Ps(Pe[fe.e+1]);break;case 161:g["!autofilter"]={ref:wt(fe)};break;case 476:g["!margins"]=fe;break;case 147:s.Sheets[t]||(s.Sheets[t]={}),fe.name&&(s.Sheets[t].CodeName=fe.name),(fe.above||fe.left)&&(g["!outline"]={above:fe.above,left:fe.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),fe.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:A=!0;break;case 36:A=!1;break;case 37:A=!0;break;case 38:A=!1;break;default:if(!Je.T){if(!A||p.WTF)throw new Error("Unexpected record 0x"+ee.toString(16))}}},p),delete p.supbooks,delete p["!row"],!g["!ref"]&&(E.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(g["!ref"]=wt(h||E)),p.sheetRows&&g["!ref"]){var _e=Kt(g["!ref"]);p.sheetRows<=+_e.e.r&&(_e.e.r=p.sheetRows-1,_e.e.r>E.e.r&&(_e.e.r=E.e.r),_e.e.r<_e.s.r&&(_e.s.r=_e.e.r),_e.e.c>E.e.c&&(_e.e.c=E.e.c),_e.e.c<_e.s.c&&(_e.s.c=_e.e.c),g["!fullref"]=g["!ref"],g["!ref"]=wt(_e))}return ne.length>0&&(g["!merges"]=ne),Pe.length>0&&(g["!cols"]=Pe),tt.length>0&&(g["!rows"]=tt),g}function Hk(e,a,t,i,s,c,f){if(a.v===void 0)return!1;var p="";switch(a.t){case"b":p=a.v?"1":"0";break;case"d":a=wa(a),a.z=a.z||mt[14],a.v=pr(ka(a.v)),a.t="n";break;case"n":case"e":p=""+a.v;break;default:p=a.v;break}var g={r:t,c:i};switch(g.s=Gs(s.cellXfs,a,s),a.l&&c["!links"].push([vt(g),a.l]),a.c&&c["!comments"].push([vt(g),a.c]),a.t){case"s":case"str":return s.bookSST?(p=vh(s.Strings,a.v,s.revStrings),g.t="s",g.v=p,f?$e(e,18,lk(a,g)):$e(e,7,ik(a,g))):(g.t="str",f?$e(e,17,yk(a,g)):$e(e,6,mk(a,g))),!0;case"n":return a.v==(a.v|0)&&a.v>-1e3&&a.v<1e3?f?$e(e,13,hk(a,g)):$e(e,2,uk(a,g)):f?$e(e,16,dk(a,g)):$e(e,5,ck(a,g)),!0;case"b":return g.t="b",f?$e(e,15,ZC(a,g)):$e(e,4,JC(a,g)),!0;case"e":return g.t="e",f?$e(e,14,rk(a,g)):$e(e,3,tk(a,g)),!0}return f?$e(e,12,qC(a,g)):$e(e,1,VC(a,g)),!0}function $k(e,a,t,i){var s=Kt(a["!ref"]||"A1"),c,f="",p=[];$e(e,145);var g=Array.isArray(a),h=s.e.r;a["!rows"]&&(h=Math.max(s.e.r,a["!rows"].length-1));for(var E=s.s.r;E<=h;++E){f=Ka(E),zC(e,a,s,E);var A=!1;if(E<=s.e.r)for(var _=s.s.c;_<=s.e.c;++_){E===s.s.r&&(p[_]=Oa(_)),c=p[_]+f;var w=g?(a[E]||[])[_]:a[c];if(!w){A=!1;continue}A=Hk(e,w,E,_,i,a,A)}}$e(e,146)}function Gk(e,a){!a||!a["!merges"]||($e(e,177,Ck(a["!merges"].length)),a["!merges"].forEach(function(t){$e(e,176,_k(t))}),$e(e,178))}function Yk(e,a){!a||!a["!cols"]||($e(e,390),a["!cols"].forEach(function(t,i){t&&$e(e,60,jk(i,t))}),$e(e,391))}function Wk(e,a){!a||!a["!ref"]||($e(e,648),$e(e,649,Mk(Kt(a["!ref"]))),$e(e,650))}function Vk(e,a,t){a["!links"].forEach(function(i){if(i[1].Target){var s=da(t,-1,i[1].Target.replace(/#.*$/,""),Bt.HLINK);$e(e,494,wk(i,s))}}),delete a["!links"]}function Xk(e,a,t,i){if(a["!comments"].length>0){var s=da(i,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Bt.VML);$e(e,551,ih("rId"+s)),a["!legacy"]=s}}function qk(e,a,t,i){if(a["!autofilter"]){var s=a["!autofilter"],c=typeof s.ref=="string"?s.ref:wt(s.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var f=t.Workbook.Names,p=un(c);p.s.r==p.e.r&&(p.e.r=un(a["!ref"]).e.r,c=wt(p));for(var g=0;g<f.length;++g){var h=f[g];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==i){h.Ref="'"+t.SheetNames[i]+"'!"+c;break}}g==f.length&&f.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+c}),$e(e,161,Do(Kt(c))),$e(e,162)}}function Kk(e,a,t){$e(e,133),$e(e,137,Bk(a,t)),$e(e,138),$e(e,134)}function Jk(e,a){a["!protect"]&&$e(e,535,Lk(a["!protect"]))}function Qk(e,a,t,i){var s=fn(),c=t.SheetNames[e],f=t.Sheets[c]||{},p=c;try{t&&t.Workbook&&(p=t.Workbook.Sheets[e].CodeName||p)}catch{}var g=Kt(f["!ref"]||"A1");if(g.e.c>16383||g.e.r>1048575){if(a.WTF)throw new Error("Range "+(f["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575)}return f["!links"]=[],f["!comments"]=[],$e(s,129),(t.vbaraw||f["!outline"])&&$e(s,147,YC(p,f["!outline"])),$e(s,148,HC(g)),Kk(s,f,t.Workbook),Yk(s,f),$k(s,f,e,a),Jk(s,f),qk(s,f,t,e),Gk(s,f),Vk(s,f,i),f["!margins"]&&$e(s,476,Ok(f["!margins"])),(!a||a.ignoreEC||a.ignoreEC==null)&&Wk(s,f),Xk(s,f,e,i),$e(s,130),s.end()}function Zk(e){var a=[],t=e.match(/^<c:numCache>/),i;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(c){var f=c.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);f&&(a[+f[1]]=t?+f[2]:f[2])});var s=qt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(c){i=c.replace(/<.*?>/g,"")}),[a,s,i]}function ew(e,a,t,i,s,c){var f=c||{"!type":"chart"};if(!e)return c;var p=0,g=0,h="A",E={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(A){var _=Zk(A);E.s.r=E.s.c=0,E.e.c=p,h=Oa(p),_[0].forEach(function(w,N){f[h+Ka(N)]={t:"n",v:w,z:_[1]},g=N}),E.e.r<g&&(E.e.r=g),++p}),p>0&&(f["!ref"]=wt(E)),f}function tw(e,a,t,i,s){if(!e)return e;i||(i={"!id":{}});var c={"!type":"chart","!drawel":null,"!rel":""},f,p=e.match(Fy);return p&&yh(p[0],c,s,t),(f=e.match(/drawing r:id="(.*?)"/))&&(c["!rel"]=f[1]),i["!id"][c["!rel"]]&&(c["!drawel"]=i["!id"][c["!rel"]]),c}function aw(e,a){e.l+=10;var t=Hr(e);return{name:t}}function rw(e,a,t,i,s){if(!e)return e;i||(i={"!id":{}});var c={"!type":"chart","!drawel":null,"!rel":""},f=!1;return as(e,function(g,h,E){switch(E){case 550:c["!rel"]=g;break;case 651:s.Sheets[t]||(s.Sheets[t]={}),g.name&&(s.Sheets[t].CodeName=g.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:f=!0;break;case 36:f=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!f||a.WTF)throw new Error("Unexpected record 0x"+E.toString(16))}}}},a),i["!id"][c["!rel"]]&&(c["!drawel"]=i["!id"][c["!rel"]]),c}var bh=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],nw=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],iw=[],sw=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function jm(e,a){for(var t=0;t!=e.length;++t)for(var i=e[t],s=0;s!=a.length;++s){var c=a[s];if(i[c[0]]==null)i[c[0]]=c[1];else switch(c[2]){case"bool":typeof i[c[0]]=="string"&&(i[c[0]]=Ca(i[c[0]]));break;case"int":typeof i[c[0]]=="string"&&(i[c[0]]=parseInt(i[c[0]],10));break}}}function Dm(e,a){for(var t=0;t!=a.length;++t){var i=a[t];if(e[i[0]]==null)e[i[0]]=i[1];else switch(i[2]){case"bool":typeof e[i[0]]=="string"&&(e[i[0]]=Ca(e[i[0]]));break;case"int":typeof e[i[0]]=="string"&&(e[i[0]]=parseInt(e[i[0]],10));break}}}function Iy(e){Dm(e.WBProps,bh),Dm(e.CalcPr,sw),jm(e.WBView,nw),jm(e.Sheets,iw),Co.date1904=Ca(e.WBProps.date1904)}function lw(e){return!e.Workbook||!e.Workbook.WBProps?"false":Ca(e.Workbook.WBProps.date1904)?"true":"false"}var ow="][*?/\\".split("");function By(e,a){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return ow.forEach(function(i){if(e.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function cw(e,a,t){e.forEach(function(i,s){By(i);for(var c=0;c<s;++c)if(i==e[c])throw new Error("Duplicate Sheet Name: "+i);if(t){var f=a&&a[s]&&a[s].CodeName||i;if(f.charCodeAt(0)==95&&f.length>22)throw new Error("Bad Code Name: Worksheet"+f)}})}function dw(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var a=e.Workbook&&e.Workbook.Sheets||[];cw(e.SheetNames,a,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)lC(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}var fw=/<\w+:workbook/;function uw(e,a){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},i=!1,s="xmlns",c={},f=0;if(e.replace(Gr,function(g,h){var E=bt(g);switch(_i(E[0])){case"<?xml":break;case"<workbook":g.match(fw)&&(s="xmlns"+g.match(/<(\w+):/)[1]),t.xmlns=E[s];break;case"</workbook>":break;case"<fileVersion":delete E[0],t.AppVersion=E;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":bh.forEach(function(A){if(E[A[0]]!=null)switch(A[2]){case"bool":t.WBProps[A[0]]=Ca(E[A[0]]);break;case"int":t.WBProps[A[0]]=parseInt(E[A[0]],10);break;default:t.WBProps[A[0]]=E[A[0]]}}),E.codeName&&(t.WBProps.CodeName=ga(E.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete E[0],t.WBView.push(E);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(E.state){case"hidden":E.Hidden=1;break;case"veryHidden":E.Hidden=2;break;default:E.Hidden=0}delete E.state,E.name=qt(ga(E.name)),delete E[0],t.Sheets.push(E);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":i=!0;break;case"</definedNames>":i=!1;break;case"<definedName":c={},c.Name=ga(E.name),E.comment&&(c.Comment=E.comment),E.localSheetId&&(c.Sheet=+E.localSheetId),Ca(E.hidden||"0")&&(c.Hidden=!0),f=h+g.length;break;case"</definedName>":c.Ref=qt(ga(e.slice(f,h))),t.Names.push(c);break;case"<definedName/>":break;case"<calcPr":delete E[0],t.CalcPr=E;break;case"<calcPr/>":delete E[0],t.CalcPr=E;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":i=!0;break;case"</AlternateContent>":i=!1;break;case"<revisionPtr":break;default:if(!i&&a.WTF)throw new Error("unrecognized "+E[0]+" in workbook")}return g}),kl.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return Iy(t),t}function My(e){var a=[Ja];a[a.length]=Ke("workbook",null,{xmlns:kl[0],"xmlns:r":ur.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(bh.forEach(function(p){e.Workbook.WBProps[p[0]]!=null&&e.Workbook.WBProps[p[0]]!=p[1]&&(i[p[0]]=e.Workbook.WBProps[p[0]])}),e.Workbook.WBProps.CodeName&&(i.codeName=e.Workbook.WBProps.CodeName,delete i.CodeName)),a[a.length]=Ke("workbookPr",null,i);var s=e.Workbook&&e.Workbook.Sheets||[],c=0;if(s&&s[0]&&s[0].Hidden){for(a[a.length]="<bookViews>",c=0;c!=e.SheetNames.length&&!(!s[c]||!s[c].Hidden);++c);c==e.SheetNames.length&&(c=0),a[a.length]='<workbookView firstSheet="'+c+'" activeTab="'+c+'"/>',a[a.length]="</bookViews>"}for(a[a.length]="<sheets>",c=0;c!=e.SheetNames.length;++c){var f={name:fa(e.SheetNames[c].slice(0,31))};if(f.sheetId=""+(c+1),f["r:id"]="rId"+(c+1),s[c])switch(s[c].Hidden){case 1:f.state="hidden";break;case 2:f.state="veryHidden";break}a[a.length]=Ke("sheet",null,f)}return a[a.length]="</sheets>",t&&(a[a.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(p){var g={name:p.Name};p.Comment&&(g.comment=p.Comment),p.Sheet!=null&&(g.localSheetId=""+p.Sheet),p.Hidden&&(g.hidden="1"),p.Ref&&(a[a.length]=Ke("definedName",fa(p.Ref),g))}),a[a.length]="</definedNames>"),a.length>2&&(a[a.length]="</workbook>",a[1]=a[1].replace("/>",">")),a.join("")}function pw(e,a){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Np(e),t.name=Hr(e),t}function hw(e,a){return a||(a=Ne(127)),a.write_shift(4,e.Hidden),a.write_shift(4,e.iTabID),ih(e.strRelID,a),Sr(e.name.slice(0,31),a),a.length>a.l?a.slice(0,a.l):a}function gw(e,a){var t={},i=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var s=a>8?Hr(e):"";return s.length>0&&(t.CodeName=s),t.autoCompressPictures=!!(i&65536),t.backupFile=!!(i&64),t.checkCompatibility=!!(i&4096),t.date1904=!!(i&1),t.filterPrivacy=!!(i&8),t.hidePivotFieldList=!!(i&1024),t.promptedSolutions=!!(i&16),t.publishItems=!!(i&2048),t.refreshAllConnections=!!(i&262144),t.saveExternalLinkValues=!!(i&128),t.showBorderUnselectedTables=!!(i&4),t.showInkAnnotation=!!(i&32),t.showObjects=["all","placeholders","none"][i>>13&3],t.showPivotChartFilter=!!(i&32768),t.updateLinks=["userSet","never","always"][i>>8&3],t}function xw(e,a){a||(a=Ne(72));var t=0;return e&&e.filterPrivacy&&(t|=8),a.write_shift(4,t),a.write_shift(4,0),wv(e&&e.CodeName||"ThisWorkbook",a),a.slice(0,a.l)}function mw(e,a){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=a-8,t}function vw(e,a,t){var i=e.l+a;e.l+=4,e.l+=1;var s=e.read_shift(4),c=XS(e),f=tC(e,0,t),p=nh(e);e.l=i;var g={Name:c,Ptg:f};return s<268435455&&(g.Sheet=s),p&&(g.Comment=p),g}function yw(e,a){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},i=[],s=!1;a||(a={}),a.biff=12;var c=[],f=[[]];return f.SheetNames=[],f.XTI=[],a0[16]={n:"BrtFRTArchID$",f:mw},as(e,function(g,h,E){switch(E){case 156:f.SheetNames.push(g.name),t.Sheets.push(g);break;case 153:t.WBProps=g;break;case 39:g.Sheet!=null&&(a.SID=g.Sheet),g.Ref=Pr(g.Ptg,null,null,f,a),delete a.SID,delete g.Ptg,c.push(g);break;case 1036:break;case 357:case 358:case 355:case 667:f[0].length?f.push([E,g]):f[0]=[E,g],f[f.length-1].XTI=[];break;case 362:f.length===0&&(f[0]=[],f[0].XTI=[]),f[f.length-1].XTI=f[f.length-1].XTI.concat(g),f.XTI=f.XTI.concat(g);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:i.push(E),s=!0;break;case 36:i.pop(),s=!1;break;case 37:i.push(E),s=!0;break;case 38:i.pop(),s=!1;break;case 16:break;default:if(!h.T){if(!s||a.WTF&&i[i.length-1]!=37&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+E.toString(16))}}},a),Iy(t),t.Names=c,t.supbooks=f,t}function bw(e,a){$e(e,143);for(var t=0;t!=a.SheetNames.length;++t){var i=a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[t]&&a.Workbook.Sheets[t].Hidden||0,s={Hidden:i,iTabID:t+1,strRelID:"rId"+(t+1),name:a.SheetNames[t]};$e(e,156,hw(s))}$e(e,144)}function Sw(e,a){a||(a=Ne(127));for(var t=0;t!=4;++t)a.write_shift(4,0);return Sr("SheetJS",a),Sr(Pd.version,a),Sr(Pd.version,a),Sr("7262",a),a.length>a.l?a.slice(0,a.l):a}function Ew(e,a){a||(a=Ne(29)),a.write_shift(-4,0),a.write_shift(-4,460),a.write_shift(4,28800),a.write_shift(4,17600),a.write_shift(4,500),a.write_shift(4,e),a.write_shift(4,e);var t=120;return a.write_shift(1,t),a.length>a.l?a.slice(0,a.l):a}function Tw(e,a){if(!(!a.Workbook||!a.Workbook.Sheets)){for(var t=a.Workbook.Sheets,i=0,s=-1,c=-1;i<t.length;++i)!t[i]||!t[i].Hidden&&s==-1?s=i:t[i].Hidden==1&&c==-1&&(c=i);c>s||($e(e,135),$e(e,158,Ew(s)),$e(e,136))}}function Aw(e,a){var t=fn();return $e(t,131),$e(t,128,Sw()),$e(t,153,xw(e.Workbook&&e.Workbook.WBProps||null)),Tw(t,e),bw(t,e),$e(t,132),t.end()}function _w(e,a,t){return a.slice(-4)===".bin"?yw(e,t):uw(e,t)}function Cw(e,a,t,i,s,c,f,p){return a.slice(-4)===".bin"?Uk(e,i,t,s,c,f,p):vC(e,i,t,s,c,f,p)}function kw(e,a,t,i,s,c,f,p){return a.slice(-4)===".bin"?rw(e,i,t,s,c):tw(e,i,t,s,c)}function ww(e,a,t,i,s,c,f,p){return a.slice(-4)===".bin"?N4():F4()}function Rw(e,a,t,i,s,c,f,p){return a.slice(-4)===".bin"?w4():R4()}function Nw(e,a,t,i){return a.slice(-4)===".bin"?__(e,t,i):p_(e,t,i)}function Fw(e,a,t){return my(e,t)}function jw(e,a,t){return a.slice(-4)===".bin"?jA(e,t):RA(e,t)}function Dw(e,a,t){return a.slice(-4)===".bin"?T4(e,t):h4(e,t)}function Ow(e,a,t){return a.slice(-4)===".bin"?f4(e):c4(e)}function Iw(e,a,t,i){return t.slice(-4)===".bin"?u4(e,a,t,i):void 0}function Bw(e,a,t){return a.slice(-4)===".bin"?s4(e,a,t):o4(e,a,t)}function Mw(e,a,t){return(a.slice(-4)===".bin"?Aw:My)(e)}function Lw(e,a,t,i,s){return(a.slice(-4)===".bin"?Qk:jy)(e,t,i,s)}function Pw(e,a,t){return(a.slice(-4)===".bin"?I_:gy)(e,t)}function zw(e,a,t){return(a.slice(-4)===".bin"?IA:ly)(e,t)}function Uw(e,a,t){return(a.slice(-4)===".bin"?A4:by)(e)}function Hw(e){return(e.slice(-4)===".bin"?l4:vy)()}var Ly=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Py=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ri(e,a){var t=e.split(/\s+/),i=[];if(i[0]=t[0],t.length===1)return i;var s=e.match(Ly),c,f,p,g;if(s)for(g=0;g!=s.length;++g)c=s[g].match(Py),(f=c[1].indexOf(":"))===-1?i[c[1]]=c[2].slice(1,c[2].length-1):(c[1].slice(0,6)==="xmlns:"?p="xmlns"+c[1].slice(6):p=c[1].slice(f+1),i[p]=c[2].slice(1,c[2].length-1));return i}function $w(e){var a=e.split(/\s+/),t={};if(a.length===1)return t;var i=e.match(Ly),s,c,f,p;if(i)for(p=0;p!=i.length;++p)s=i[p].match(Py),(c=s[1].indexOf(":"))===-1?t[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?f="xmlns"+s[1].slice(6):f=s[1].slice(c+1),t[f]=s[2].slice(1,s[2].length-1));return t}var $c;function Gw(e,a){var t=$c[e]||qt(e);return t==="General"?Sl(a):Wn(t,a)}function Yw(e,a,t,i){var s=i;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Ca(i);break;case"i2":case"int":s=parseInt(i,10);break;case"r4":case"float":s=parseFloat(i);break;case"date":case"dateTime.tz":s=ka(i);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[qt(a)]=s}function Ww(e,a,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||rs[e.v]:a==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Vc(e.v):e.w=Sl(e.v):e.w=Gw(a||"General",e.v)}catch(c){if(t.WTF)throw c}try{var i=$c[a]||a||"General";if(t.cellNF&&(e.z=i),t.cellDates&&e.t=="n"&&No(i)){var s=xl(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(c){if(t.WTF)throw c}}}function Vw(e,a,t){if(t.cellStyles&&a.Interior){var i=a.Interior;i.Pattern&&(i.patternType=i_[i.Pattern]||i.Pattern)}e[a.ID]=a}function Xw(e,a,t,i,s,c,f,p,g,h){var E="General",A=i.StyleID,_={};h=h||{};var w=[],N=0;for(A===void 0&&p&&(A=p.StyleID),A===void 0&&f&&(A=f.StyleID);c[A]!==void 0&&(c[A].nf&&(E=c[A].nf),c[A].Interior&&w.push(c[A].Interior),!!c[A].Parent);)A=c[A].Parent;switch(t.Type){case"Boolean":i.t="b",i.v=Ca(e);break;case"String":i.t="s",i.r=Kx(qt(e)),i.v=e.indexOf("<")>-1?qt(a||e).replace(/<.*?>/g,""):i.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),i.v=(ka(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),i.v!==i.v?i.v=qt(e):i.v<60&&(i.v=i.v-1),(!E||E=="General")&&(E="yyyy-mm-dd");case"Number":i.v===void 0&&(i.v=+e),i.t||(i.t="n");break;case"Error":i.t="e",i.v=Dv[e],h.cellText!==!1&&(i.w=e);break;default:e==""&&a==""?i.t="z":(i.t="s",i.v=Kx(a||e));break}if(Ww(i,E,h),h.cellFormula!==!1)if(i.Formula){var k=qt(i.Formula);k.charCodeAt(0)==61&&(k=k.slice(1)),i.f=_o(k,s),delete i.Formula,i.ArrayRange=="RC"?i.F=_o("RC:RC",s):i.ArrayRange&&(i.F=_o(i.ArrayRange,s),g.push([Kt(i.F),i.F]))}else for(N=0;N<g.length;++N)s.r>=g[N][0].s.r&&s.r<=g[N][0].e.r&&s.c>=g[N][0].s.c&&s.c<=g[N][0].e.c&&(i.F=g[N][1]);h.cellStyles&&(w.forEach(function(F){!_.patternType&&F.patternType&&(_.patternType=F.patternType)}),i.s=_),i.StyleID!==void 0&&(i.ixfe=i.StyleID)}function qw(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Tp(e,a){var t=a||{};Fo();var i=Oc(Qp(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(i=ga(i));var s=i.slice(0,1024).toLowerCase(),c=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var f=wa(t);return f.type="string",wo.to_workbook(i,f)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ra){s.indexOf("<"+ra)>=0&&(c=!0)}),c)return O6(i,t);$c={"General Number":"General","General Date":mt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":mt[15],"Short Date":mt[14],"Long Time":mt[19],"Medium Time":mt[18],"Short Time":mt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:mt[2],Standard:mt[4],Percent:mt[10],Scientific:mt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var p,g=[],h,E={},A=[],_=t.dense?[]:{},w="",N={},k={},F=ri('<Data ss:Type="String">'),z=0,q=0,B=0,ie={s:{r:2e6,c:2e6},e:{r:0,c:0}},se={},ne={},H="",le=0,oe=[],m={},Se={},ue=0,Pe=[],tt=[],ke={},de=[],_e,Ze=!1,fe=[],Je=[],ee={},O=0,L=0,K={Sheets:[],WBProps:{date1904:!1}},te={};Kc.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"");for(var he="";p=Kc.exec(i);)switch(p[3]=(he=p[3]).toLowerCase()){case"data":if(he=="data"){if(p[1]==="/"){if((h=g.pop())[0]!==p[3])throw new Error("Bad state: "+h.join("|"))}else p[0].charAt(p[0].length-2)!=="/"&&g.push([p[3],!0]);break}if(g[g.length-1][1])break;p[1]==="/"?Xw(i.slice(z,p.index),H,F,g[g.length-1][0]=="comment"?ke:N,{c:q,r:B},se,de[q],k,fe,t):(H="",F=ri(p[0]),z=p.index+p[0].length);break;case"cell":if(p[1]==="/")if(tt.length>0&&(N.c=tt),(!t.sheetRows||t.sheetRows>B)&&N.v!==void 0&&(t.dense?(_[B]||(_[B]=[]),_[B][q]=N):_[Oa(q)+Ka(B)]=N),N.HRef&&(N.l={Target:qt(N.HRef)},N.HRefScreenTip&&(N.l.Tooltip=N.HRefScreenTip),delete N.HRef,delete N.HRefScreenTip),(N.MergeAcross||N.MergeDown)&&(O=q+(parseInt(N.MergeAcross,10)|0),L=B+(parseInt(N.MergeDown,10)|0),oe.push({s:{c:q,r:B},e:{c:O,r:L}})),!t.sheetStubs)N.MergeAcross?q=O+1:++q;else if(N.MergeAcross||N.MergeDown){for(var Oe=q;Oe<=O;++Oe)for(var Ue=B;Ue<=L;++Ue)(Oe>q||Ue>B)&&(t.dense?(_[Ue]||(_[Ue]=[]),_[Ue][Oe]={t:"z"}):_[Oa(Oe)+Ka(Ue)]={t:"z"});q=O+1}else++q;else N=$w(p[0]),N.Index&&(q=+N.Index-1),q<ie.s.c&&(ie.s.c=q),q>ie.e.c&&(ie.e.c=q),p[0].slice(-2)==="/>"&&++q,tt=[];break;case"row":p[1]==="/"||p[0].slice(-2)==="/>"?(B<ie.s.r&&(ie.s.r=B),B>ie.e.r&&(ie.e.r=B),p[0].slice(-2)==="/>"&&(k=ri(p[0]),k.Index&&(B=+k.Index-1)),q=0,++B):(k=ri(p[0]),k.Index&&(B=+k.Index-1),ee={},(k.AutoFitHeight=="0"||k.Height)&&(ee.hpx=parseInt(k.Height,10),ee.hpt=t0(ee.hpx),Je[B]=ee),k.Hidden=="1"&&(ee.hidden=!0,Je[B]=ee));break;case"worksheet":if(p[1]==="/"){if((h=g.pop())[0]!==p[3])throw new Error("Bad state: "+h.join("|"));A.push(w),ie.s.r<=ie.e.r&&ie.s.c<=ie.e.c&&(_["!ref"]=wt(ie),t.sheetRows&&t.sheetRows<=ie.e.r&&(_["!fullref"]=_["!ref"],ie.e.r=t.sheetRows-1,_["!ref"]=wt(ie))),oe.length&&(_["!merges"]=oe),de.length>0&&(_["!cols"]=de),Je.length>0&&(_["!rows"]=Je),E[w]=_}else ie={s:{r:2e6,c:2e6},e:{r:0,c:0}},B=q=0,g.push([p[3],!1]),h=ri(p[0]),w=qt(h.Name),_=t.dense?[]:{},oe=[],fe=[],Je=[],te={name:w,Hidden:0},K.Sheets.push(te);break;case"table":if(p[1]==="/"){if((h=g.pop())[0]!==p[3])throw new Error("Bad state: "+h.join("|"))}else{if(p[0].slice(-2)=="/>")break;g.push([p[3],!1]),de=[],Ze=!1}break;case"style":p[1]==="/"?Vw(se,ne,t):ne=ri(p[0]);break;case"numberformat":ne.nf=qt(ri(p[0]).Format||"General"),$c[ne.nf]&&(ne.nf=$c[ne.nf]);for(var Ie=0;Ie!=392&&mt[Ie]!=ne.nf;++Ie);if(Ie==392){for(Ie=57;Ie!=392;++Ie)if(mt[Ie]==null){Qi(ne.nf,Ie);break}}break;case"column":if(g[g.length-1][0]!=="table")break;if(_e=ri(p[0]),_e.Hidden&&(_e.hidden=!0,delete _e.Hidden),_e.Width&&(_e.wpx=parseInt(_e.Width,10)),!Ze&&_e.wpx>10){Ze=!0,zr=py;for(var He=0;He<de.length;++He)de[He]&&Ps(de[He])}Ze&&Ps(_e),de[_e.Index-1||de.length]=_e;for(var gt=0;gt<+_e.Span;++gt)de[de.length]=wa(_e);break;case"namedrange":if(p[1]==="/")break;K.Names||(K.Names=[]);var Z=bt(p[0]),aa={Name:Z.Name,Ref:_o(Z.RefersTo.slice(1),{r:0,c:0})};K.Sheets.length>0&&(aa.Sheet=K.Sheets.length-1),K.Names.push(aa);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(p[0].slice(-2)==="/>")break;p[1]==="/"?H+=i.slice(le,p.index):le=p.index+p[0].length;break;case"interior":if(!t.cellStyles)break;ne.Interior=ri(p[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(p[0].slice(-2)==="/>")break;p[1]==="/"?yE(m,he,i.slice(ue,p.index)):ue=p.index+p[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(p[1]==="/"){if((h=g.pop())[0]!==p[3])throw new Error("Bad state: "+h.join("|"))}else g.push([p[3],!1]);break;case"comment":if(p[1]==="/"){if((h=g.pop())[0]!==p[3])throw new Error("Bad state: "+h.join("|"));qw(ke),tt.push(ke)}else g.push([p[3],!1]),h=ri(p[0]),ke={a:h.Author};break;case"autofilter":if(p[1]==="/"){if((h=g.pop())[0]!==p[3])throw new Error("Bad state: "+h.join("|"))}else if(p[0].charAt(p[0].length-2)!=="/"){var St=ri(p[0]);_["!autofilter"]={ref:_o(St.Range).replace(/\$/g,"")},g.push([p[3],!0])}break;case"name":break;case"datavalidation":if(p[1]==="/"){if((h=g.pop())[0]!==p[3])throw new Error("Bad state: "+h.join("|"))}else p[0].charAt(p[0].length-2)!=="/"&&g.push([p[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(p[1]==="/"){if((h=g.pop())[0]!==p[3])throw new Error("Bad state: "+h.join("|"))}else p[0].charAt(p[0].length-2)!=="/"&&g.push([p[3],!0]);break;case"null":break;default:if(g.length==0&&p[3]=="document"||g.length==0&&p[3]=="uof")return Lm(i,t);var Mt=!0;switch(g[g.length-1][0]){case"officedocumentsettings":switch(p[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Mt=!1}break;case"componentoptions":switch(p[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Mt=!1}break;case"excelworkbook":switch(p[3]){case"date1904":K.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Mt=!1}break;case"workbookoptions":switch(p[3]){case"owcversion":break;case"height":break;case"width":break;default:Mt=!1}break;case"worksheetoptions":switch(p[3]){case"visible":if(p[0].slice(-2)!=="/>")if(p[1]==="/")switch(i.slice(ue,p.index)){case"SheetHidden":te.Hidden=1;break;case"SheetVeryHidden":te.Hidden=2;break}else ue=p.index+p[0].length;break;case"header":_["!margins"]||bl(_["!margins"]={},"xlml"),isNaN(+bt(p[0]).Margin)||(_["!margins"].header=+bt(p[0]).Margin);break;case"footer":_["!margins"]||bl(_["!margins"]={},"xlml"),isNaN(+bt(p[0]).Margin)||(_["!margins"].footer=+bt(p[0]).Margin);break;case"pagemargins":var yt=bt(p[0]);_["!margins"]||bl(_["!margins"]={},"xlml"),isNaN(+yt.Top)||(_["!margins"].top=+yt.Top),isNaN(+yt.Left)||(_["!margins"].left=+yt.Left),isNaN(+yt.Right)||(_["!margins"].right=+yt.Right),isNaN(+yt.Bottom)||(_["!margins"].bottom=+yt.Bottom);break;case"displayrighttoleft":K.Views||(K.Views=[]),K.Views[0]||(K.Views[0]={}),K.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Mt=!1}break;case"pivottable":case"pivotcache":switch(p[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Mt=!1}break;case"pagebreaks":switch(p[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Mt=!1}break;case"autofilter":switch(p[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Mt=!1}break;case"querytable":switch(p[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Mt=!1}break;case"datavalidation":switch(p[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Mt=!1}break;case"sorting":case"conditionalformatting":switch(p[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Mt=!1}break;case"mapinfo":case"schema":case"data":switch(p[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Mt=!1}break;case"smarttags":break;default:Mt=!1;break}if(Mt||p[3].match(/!\[CDATA/))break;if(!g[g.length-1][1])throw"Unrecognized tag: "+p[3]+"|"+g.join("|");if(g[g.length-1][0]==="customdocumentproperties"){if(p[0].slice(-2)==="/>")break;p[1]==="/"?Yw(Se,he,Pe,i.slice(ue,p.index)):(Pe=p,ue=p.index+p[0].length);break}if(t.WTF)throw"Unrecognized tag: "+p[3]+"|"+g.join("|")}var et={};return!t.bookSheets&&!t.bookProps&&(et.Sheets=E),et.SheetNames=A,et.Workbook=K,et.SSF=wa(mt),et.Props=m,et.Custprops=Se,et}function Mp(e,a){switch(Eh(a=a||{}),a.type||"base64"){case"base64":return Tp(Cn(e),a);case"binary":case"buffer":case"file":return Tp(e,a);case"array":return Tp(Hs(e),a)}}function Kw(e,a){var t=[];return e.Props&&t.push(bE(e.Props,a)),e.Custprops&&t.push(SE(e.Props,e.Custprops)),t.join("")}function Jw(){return""}function Qw(e,a){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return a.cellXfs.forEach(function(i,s){var c=[];c.push(Ke("NumberFormat",null,{"ss:Format":fa(mt[i.numFmtId])}));var f={"ss:ID":"s"+(21+s)};t.push(Ke("Style",c.join(""),f))}),Ke("Styles",t.join(""))}function zy(e){return Ke("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+xh(e.Ref,{r:0,c:0})})}function Zw(e){if(!((e||{}).Workbook||{}).Names)return"";for(var a=e.Workbook.Names,t=[],i=0;i<a.length;++i){var s=a[i];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||t.push(zy(s)))}return Ke("Names",t.join(""))}function e6(e,a,t,i){if(!e||!((i||{}).Workbook||{}).Names)return"";for(var s=i.Workbook.Names,c=[],f=0;f<s.length;++f){var p=s[f];p.Sheet==t&&(p.Name.match(/^_xlfn\./)||c.push(zy(p)))}return c.join("")}function t6(e,a,t,i){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Ke("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Ke("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Ke("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[t])if(i.Workbook.Sheets[t].Hidden)s.push(Ke("Visible",i.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var c=0;c<t&&!(i.Workbook.Sheets[c]&&!i.Workbook.Sheets[c].Hidden);++c);c==t&&s.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(jr("ProtectContents","True")),e["!protect"].objects&&s.push(jr("ProtectObjects","True")),e["!protect"].scenarios&&s.push(jr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(jr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(jr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(f){e["!protect"][f[0]]&&s.push("<"+f[1]+"/>")})),s.length==0?"":Ke("WorksheetOptions",s.join(""),{xmlns:En.x})}function a6(e){return e.map(function(a){var t=TS(a.t||""),i=Ke("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ke("Comment",i,{"ss:Author":a.a})}).join("")}function r6(e,a,t,i,s,c,f){if(!e||e.v==null&&e.f==null)return"";var p={};if(e.f&&(p["ss:Formula"]="="+fa(xh(e.f,f))),e.F&&e.F.slice(0,a.length)==a){var g=Ia(e.F.slice(a.length+1));p["ss:ArrayRange"]="RC:R"+(g.r==f.r?"":"["+(g.r-f.r)+"]")+"C"+(g.c==f.c?"":"["+(g.c-f.c)+"]")}if(e.l&&e.l.Target&&(p["ss:HRef"]=fa(e.l.Target),e.l.Tooltip&&(p["x:HRefScreenTip"]=fa(e.l.Tooltip))),t["!merges"])for(var h=t["!merges"],E=0;E!=h.length;++E)h[E].s.c!=f.c||h[E].s.r!=f.r||(h[E].e.c>h[E].s.c&&(p["ss:MergeAcross"]=h[E].e.c-h[E].s.c),h[E].e.r>h[E].s.r&&(p["ss:MergeDown"]=h[E].e.r-h[E].s.r));var A="",_="";switch(e.t){case"z":if(!i.sheetStubs)return"";break;case"n":A="Number",_=String(e.v);break;case"b":A="Boolean",_=e.v?"1":"0";break;case"e":A="Error",_=rs[e.v];break;case"d":A="DateTime",_=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||mt[14]);break;case"s":A="String",_=ES(e.v||"");break}var w=Gs(i.cellXfs,e,i);p["ss:StyleID"]="s"+(21+w),p["ss:Index"]=f.c+1;var N=e.v!=null?_:"",k=e.t=="z"?"":'<Data ss:Type="'+A+'">'+N+"</Data>";return(e.c||[]).length>0&&(k+=a6(e.c)),Ke("Cell",k,p)}function n6(e,a){var t='<Row ss:Index="'+(e+1)+'"';return a&&(a.hpt&&!a.hpx&&(a.hpx=Ro(a.hpt)),a.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+a.hpx+'"'),a.hidden&&(t+=' ss:Hidden="1"')),t+">"}function i6(e,a,t,i){if(!e["!ref"])return"";var s=Kt(e["!ref"]),c=e["!merges"]||[],f=0,p=[];e["!cols"]&&e["!cols"].forEach(function(F,z){Ps(F);var q=!!F.width,B=of(z,F),ie={"ss:Index":z+1};q&&(ie["ss:Width"]=Zc(B.width)),F.hidden&&(ie["ss:Hidden"]="1"),p.push(Ke("Column",null,ie))});for(var g=Array.isArray(e),h=s.s.r;h<=s.e.r;++h){for(var E=[n6(h,(e["!rows"]||[])[h])],A=s.s.c;A<=s.e.c;++A){var _=!1;for(f=0;f!=c.length;++f)if(!(c[f].s.c>A)&&!(c[f].s.r>h)&&!(c[f].e.c<A)&&!(c[f].e.r<h)){(c[f].s.c!=A||c[f].s.r!=h)&&(_=!0);break}if(!_){var w={r:h,c:A},N=vt(w),k=g?(e[h]||[])[A]:e[N];E.push(r6(k,N,e,a,t,i,w))}}E.push("</Row>"),E.length>2&&p.push(E.join(""))}return p.join("")}function s6(e,a,t){var i=[],s=t.SheetNames[e],c=t.Sheets[s],f=c?e6(c,a,e,t):"";return f.length>0&&i.push("<Names>"+f+"</Names>"),f=c?i6(c,a,e,t):"",f.length>0&&i.push("<Table>"+f+"</Table>"),i.push(t6(c,a,e,t)),i.join("")}function l6(e,a){a||(a={}),e.SSF||(e.SSF=wa(mt)),e.SSF&&(Fo(),ef(e.SSF),a.revssf=af(e.SSF),a.revssf[e.SSF[65535]]=0,a.ssf=e.SSF,a.cellXfs=[],Gs(a.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(Kw(e,a)),t.push(Jw()),t.push(""),t.push("");for(var i=0;i<e.SheetNames.length;++i)t.push(Ke("Worksheet",s6(i,a,e),{"ss:Name":fa(e.SheetNames[i])}));return t[2]=Qw(e,a),t[3]=Zw(e),Ja+Ke("Workbook",t.join(""),{xmlns:En.ss,"xmlns:o":En.o,"xmlns:x":En.x,"xmlns:ss":En.ss,"xmlns:dt":En.dt,"xmlns:html":En.html})}function o6(e){var a={},t=e.content;if(t.l=28,a.AnsiUserType=t.read_shift(0,"lpstr-ansi"),a.AnsiClipboardFormat=ZS(t),t.length-t.l<=4)return a;var i=t.read_shift(4);if(i==0||i>40||(t.l-=4,a.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(i=t.read_shift(4),i!==1907505652)||(a.UnicodeClipboardFormat=eE(t),i=t.read_shift(4),i==0||i>40))return a;t.l-=4,a.Reserved2=t.read_shift(0,"lpwstr")}var c6=[60,1084,2066,2165,2175];function d6(e,a,t,i,s){var c=i,f=[],p=t.slice(t.l,t.l+c);if(s&&s.enc&&s.enc.insitu&&p.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(p)}f.push(p),t.l+=c;for(var g=Ki(t,t.l),h=Lp[g],E=0;h!=null&&c6.indexOf(g)>-1;)c=Ki(t,t.l+2),E=t.l+4,g==2066?E+=4:(g==2165||g==2175)&&(E+=12),p=t.slice(E,t.l+4+c),f.push(p),t.l+=4+c,h=Lp[g=Ki(t,t.l)];var A=br(f);Fr(A,0);var _=0;A.lens=[];for(var w=0;w<f.length;++w)A.lens.push(_),_+=f[w].length;if(A.length<i)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+A.length+" < "+i;return a.f(A,A.length,s)}function Si(e,a,t){if(e.t!=="z"&&e.XF){var i=0;try{i=e.z||e.XF.numFmtId||0,a.cellNF&&(e.z=mt[i])}catch(c){if(a.WTF)throw c}if(!a||a.cellText!==!1)try{e.t==="e"?e.w=e.w||rs[e.v]:i===0||i=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Vc(e.v):e.w=Sl(e.v):e.w=Wn(i,e.v,{date1904:!!t,dateNF:a&&a.dateNF})}catch(c){if(a.WTF)throw c}if(a.cellDates&&i&&e.t=="n"&&No(mt[i]||String(i))){var s=xl(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Md(e,a,t){return{v:e,ixfe:a,t}}function f6(e,a){var t={opts:{}},i={},s=a.dense?[]:{},c={},f={},p=null,g=[],h="",E={},A,_="",w,N,k,F,z={},q=[],B,ie,se=[],ne=[],H={Sheets:[],WBProps:{date1904:!1},Views:[{}]},le={},oe=function(ht){return ht<8?ml[ht]:ht<64&&ne[ht-8]||ml[ht]},m=function(ht,Ea,hr){var na=Ea.XF.data;if(!(!na||!na.patternType||!hr||!hr.cellStyles)){Ea.s={},Ea.s.patternType=na.patternType;var Ta;(Ta=Qc(oe(na.icvFore)))&&(Ea.s.fgColor={rgb:Ta}),(Ta=Qc(oe(na.icvBack)))&&(Ea.s.bgColor={rgb:Ta})}},Se=function(ht,Ea,hr){if(!(ee>1)&&!(hr.sheetRows&&ht.r>=hr.sheetRows)){if(hr.cellStyles&&Ea.XF&&Ea.XF.data&&m(ht,Ea,hr),delete Ea.ixfe,delete Ea.XF,A=ht,_=vt(ht),(!f||!f.s||!f.e)&&(f={s:{r:0,c:0},e:{r:0,c:0}}),ht.r<f.s.r&&(f.s.r=ht.r),ht.c<f.s.c&&(f.s.c=ht.c),ht.r+1>f.e.r&&(f.e.r=ht.r+1),ht.c+1>f.e.c&&(f.e.c=ht.c+1),hr.cellFormula&&Ea.f){for(var na=0;na<q.length;++na)if(!(q[na][0].s.c>ht.c||q[na][0].s.r>ht.r)&&!(q[na][0].e.c<ht.c||q[na][0].e.r<ht.r)){Ea.F=wt(q[na][0]),(q[na][0].s.c!=ht.c||q[na][0].s.r!=ht.r)&&delete Ea.f,Ea.f&&(Ea.f=""+Pr(q[na][1],f,ht,fe,ue));break}}hr.dense?(s[ht.r]||(s[ht.r]=[]),s[ht.r][ht.c]=Ea):s[_]=Ea}},ue={enc:!1,sbcch:0,snames:[],sharedf:z,arrayf:q,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!a&&!!a.cellStyles,WTF:!!a&&!!a.wtf};a.password&&(ue.password=a.password);var Pe,tt=[],ke=[],de=[],_e=[],Ze=!1,fe=[];fe.SheetNames=ue.snames,fe.sharedf=ue.sharedf,fe.arrayf=ue.arrayf,fe.names=[],fe.XTI=[];var Je=0,ee=0,O=0,L=[],K=[],te;ue.codepage=1200,ii(1200);for(var he=!1;e.l<e.length-1;){var Oe=e.l,Ue=e.read_shift(2);if(Ue===0&&Je===10)break;var Ie=e.l===e.length?0:e.read_shift(2),He=Lp[Ue];if(He&&He.f){if(a.bookSheets&&Je===133&&Ue!==133)break;if(Je=Ue,He.r===2||He.r==12){var gt=e.read_shift(2);if(Ie-=2,!ue.enc&&gt!==Ue&&((gt&255)<<8|gt>>8)!==Ue)throw new Error("rt mismatch: "+gt+"!="+Ue);He.r==12&&(e.l+=10,Ie-=10)}var Z={};if(Ue===10?Z=He.f(e,Ie,ue):Z=d6(Ue,He,e,Ie,ue),ee==0&&[9,521,1033,2057].indexOf(Je)===-1)continue;switch(Ue){case 34:t.opts.Date1904=H.WBProps.date1904=Z;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(ue.enc||(e.l=0),ue.enc=Z,!a.password)throw new Error("File is password-protected");if(Z.valid==null)throw new Error("Encryption scheme unsupported");if(!Z.valid)throw new Error("Password is incorrect");break;case 92:ue.lastuser=Z;break;case 66:var aa=Number(Z);switch(aa){case 21010:aa=1200;break;case 32768:aa=1e4;break;case 32769:aa=1252;break}ii(ue.codepage=aa),he=!0;break;case 317:ue.rrtabid=Z;break;case 25:ue.winlocked=Z;break;case 439:t.opts.RefreshAll=Z;break;case 12:t.opts.CalcCount=Z;break;case 16:t.opts.CalcDelta=Z;break;case 17:t.opts.CalcIter=Z;break;case 13:t.opts.CalcMode=Z;break;case 14:t.opts.CalcPrecision=Z;break;case 95:t.opts.CalcSaveRecalc=Z;break;case 15:ue.CalcRefMode=Z;break;case 2211:t.opts.FullCalc=Z;break;case 129:Z.fDialog&&(s["!type"]="dialog"),Z.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),Z.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:se.push(Z);break;case 430:fe.push([Z]),fe[fe.length-1].XTI=[];break;case 35:case 547:fe[fe.length-1].push(Z);break;case 24:case 536:te={Name:Z.Name,Ref:Pr(Z.rgce,f,null,fe,ue)},Z.itab>0&&(te.Sheet=Z.itab-1),fe.names.push(te),fe[0]||(fe[0]=[],fe[0].XTI=[]),fe[fe.length-1].push(Z),Z.Name=="_xlnm._FilterDatabase"&&Z.itab>0&&Z.rgce&&Z.rgce[0]&&Z.rgce[0][0]&&Z.rgce[0][0][0]=="PtgArea3d"&&(K[Z.itab-1]={ref:wt(Z.rgce[0][0][1][2])});break;case 22:ue.ExternCount=Z;break;case 23:fe.length==0&&(fe[0]=[],fe[0].XTI=[]),fe[fe.length-1].XTI=fe[fe.length-1].XTI.concat(Z),fe.XTI=fe.XTI.concat(Z);break;case 2196:if(ue.biff<8)break;te!=null&&(te.Comment=Z[1]);break;case 18:s["!protect"]=Z;break;case 19:Z!==0&&ue.WTF&&console.error("Password verifier: "+Z);break;case 133:c[Z.pos]=Z,ue.snames.push(Z.name);break;case 10:{if(--ee)break;if(f.e){if(f.e.r>0&&f.e.c>0){if(f.e.r--,f.e.c--,s["!ref"]=wt(f),a.sheetRows&&a.sheetRows<=f.e.r){var St=f.e.r;f.e.r=a.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=wt(f),f.e.r=St}f.e.r++,f.e.c++}tt.length>0&&(s["!merges"]=tt),ke.length>0&&(s["!objects"]=ke),de.length>0&&(s["!cols"]=de),_e.length>0&&(s["!rows"]=_e),H.Sheets.push(le)}h===""?E=s:i[h]=s,s=a.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(ue.biff===8&&(ue.biff={9:2,521:3,1033:4}[Ue]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Z.BIFFVer]||8),ue.biffguess=Z.BIFFVer==0,Z.BIFFVer==0&&Z.dt==4096&&(ue.biff=5,he=!0,ii(ue.codepage=28591)),ue.biff==8&&Z.BIFFVer==0&&Z.dt==16&&(ue.biff=2),ee++)break;if(s=a.dense?[]:{},ue.biff<8&&!he&&(he=!0,ii(ue.codepage=a.codepage||1252)),ue.biff<5||Z.BIFFVer==0&&Z.dt==4096){h===""&&(h="Sheet1"),f={s:{r:0,c:0},e:{r:0,c:0}};var Mt={pos:e.l-Ie,name:h};c[Mt.pos]=Mt,ue.snames.push(h)}else h=(c[Oe]||{name:""}).name;Z.dt==32&&(s["!type"]="chart"),Z.dt==64&&(s["!type"]="macro"),tt=[],ke=[],ue.arrayf=q=[],de=[],_e=[],Ze=!1,le={Hidden:(c[Oe]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(a.dense?(s[Z.r]||[])[Z.c]:s[vt({c:Z.c,r:Z.r})])&&++Z.c,B={ixfe:Z.ixfe,XF:se[Z.ixfe]||{},v:Z.val,t:"n"},O>0&&(B.z=L[B.ixfe>>8&63]),Si(B,a,t.opts.Date1904),Se({c:Z.c,r:Z.r},B,a);break;case 5:case 517:B={ixfe:Z.ixfe,XF:se[Z.ixfe],v:Z.val,t:Z.t},O>0&&(B.z=L[B.ixfe>>8&63]),Si(B,a,t.opts.Date1904),Se({c:Z.c,r:Z.r},B,a);break;case 638:B={ixfe:Z.ixfe,XF:se[Z.ixfe],v:Z.rknum,t:"n"},O>0&&(B.z=L[B.ixfe>>8&63]),Si(B,a,t.opts.Date1904),Se({c:Z.c,r:Z.r},B,a);break;case 189:for(var yt=Z.c;yt<=Z.C;++yt){var et=Z.rkrec[yt-Z.c][0];B={ixfe:et,XF:se[et],v:Z.rkrec[yt-Z.c][1],t:"n"},O>0&&(B.z=L[B.ixfe>>8&63]),Si(B,a,t.opts.Date1904),Se({c:yt,r:Z.r},B,a)}break;case 6:case 518:case 1030:{if(Z.val=="String"){p=Z;break}if(B=Md(Z.val,Z.cell.ixfe,Z.tt),B.XF=se[B.ixfe],a.cellFormula){var ra=Z.formula;if(ra&&ra[0]&&ra[0][0]&&ra[0][0][0]=="PtgExp"){var Ba=ra[0][0][1][0],Qa=ra[0][0][1][1],Rt=vt({r:Ba,c:Qa});z[Rt]?B.f=""+Pr(Z.formula,f,Z.cell,fe,ue):B.F=((a.dense?(s[Ba]||[])[Qa]:s[Rt])||{}).F}else B.f=""+Pr(Z.formula,f,Z.cell,fe,ue)}O>0&&(B.z=L[B.ixfe>>8&63]),Si(B,a,t.opts.Date1904),Se(Z.cell,B,a),p=Z}break;case 7:case 519:if(p)p.val=Z,B=Md(Z,p.cell.ixfe,"s"),B.XF=se[B.ixfe],a.cellFormula&&(B.f=""+Pr(p.formula,f,p.cell,fe,ue)),O>0&&(B.z=L[B.ixfe>>8&63]),Si(B,a,t.opts.Date1904),Se(p.cell,B,a),p=null;else throw new Error("String record expects Formula");break;case 33:case 545:{q.push(Z);var Yr=vt(Z[0].s);if(w=a.dense?(s[Z[0].s.r]||[])[Z[0].s.c]:s[Yr],a.cellFormula&&w){if(!p||!Yr||!w)break;w.f=""+Pr(Z[1],f,Z[0],fe,ue),w.F=wt(Z[0])}}break;case 1212:{if(!a.cellFormula)break;if(_){if(!p)break;z[vt(p.cell)]=Z[0],w=a.dense?(s[p.cell.r]||[])[p.cell.c]:s[vt(p.cell)],(w||{}).f=""+Pr(Z[0],f,A,fe,ue)}}break;case 253:B=Md(g[Z.isst].t,Z.ixfe,"s"),g[Z.isst].h&&(B.h=g[Z.isst].h),B.XF=se[B.ixfe],O>0&&(B.z=L[B.ixfe>>8&63]),Si(B,a,t.opts.Date1904),Se({c:Z.c,r:Z.r},B,a);break;case 513:a.sheetStubs&&(B={ixfe:Z.ixfe,XF:se[Z.ixfe],t:"z"},O>0&&(B.z=L[B.ixfe>>8&63]),Si(B,a,t.opts.Date1904),Se({c:Z.c,r:Z.r},B,a));break;case 190:if(a.sheetStubs)for(var Zr=Z.c;Zr<=Z.C;++Zr){var ia=Z.ixfe[Zr-Z.c];B={ixfe:ia,XF:se[ia],t:"z"},O>0&&(B.z=L[B.ixfe>>8&63]),Si(B,a,t.opts.Date1904),Se({c:Zr,r:Z.r},B,a)}break;case 214:case 516:case 4:B=Md(Z.val,Z.ixfe,"s"),B.XF=se[B.ixfe],O>0&&(B.z=L[B.ixfe>>8&63]),Si(B,a,t.opts.Date1904),Se({c:Z.c,r:Z.r},B,a);break;case 0:case 512:ee===1&&(f=Z);break;case 252:g=Z;break;case 1054:if(ue.biff==4){L[O++]=Z[1];for(var Dr=0;Dr<O+163&&mt[Dr]!=Z[1];++Dr);Dr>=163&&Qi(Z[1],O+163)}else Qi(Z[1],Z[0]);break;case 30:{L[O++]=Z;for(var sa=0;sa<O+163&&mt[sa]!=Z;++sa);sa>=163&&Qi(Z,O+163)}break;case 229:tt=tt.concat(Z);break;case 93:ke[Z.cmo[0]]=ue.lastobj=Z;break;case 438:ue.lastobj.TxO=Z;break;case 127:ue.lastobj.ImData=Z;break;case 440:for(F=Z[0].s.r;F<=Z[0].e.r;++F)for(k=Z[0].s.c;k<=Z[0].e.c;++k)w=a.dense?(s[F]||[])[k]:s[vt({c:k,r:F})],w&&(w.l=Z[1]);break;case 2048:for(F=Z[0].s.r;F<=Z[0].e.r;++F)for(k=Z[0].s.c;k<=Z[0].e.c;++k)w=a.dense?(s[F]||[])[k]:s[vt({c:k,r:F})],w&&w.l&&(w.l.Tooltip=Z[1]);break;case 28:{if(ue.biff<=5&&ue.biff>=2)break;w=a.dense?(s[Z[0].r]||[])[Z[0].c]:s[vt(Z[0])];var ki=ke[Z[2]];w||(a.dense?(s[Z[0].r]||(s[Z[0].r]=[]),w=s[Z[0].r][Z[0].c]={t:"z"}):w=s[vt(Z[0])]={t:"z"},f.e.r=Math.max(f.e.r,Z[0].r),f.s.r=Math.min(f.s.r,Z[0].r),f.e.c=Math.max(f.e.c,Z[0].c),f.s.c=Math.min(f.s.c,Z[0].c)),w.c||(w.c=[]),N={a:Z[1],t:ki.TxO.t},w.c.push(N)}break;case 2173:Q_(se[Z.ixfe],Z.ext);break;case 125:{if(!ue.cellStyles)break;for(;Z.e>=Z.s;)de[Z.e--]={width:Z.w/256,level:Z.level||0,hidden:!!(Z.flags&1)},Ze||(Ze=!0,ph(Z.w/256)),Ps(de[Z.e+1])}break;case 520:{var Lt={};Z.level!=null&&(_e[Z.r]=Lt,Lt.level=Z.level),Z.hidden&&(_e[Z.r]=Lt,Lt.hidden=!0),Z.hpt&&(_e[Z.r]=Lt,Lt.hpt=Z.hpt,Lt.hpx=Ro(Z.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||bl(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ue]]=Z;break;case 161:s["!margins"]||bl(s["!margins"]={}),s["!margins"].header=Z.header,s["!margins"].footer=Z.footer;break;case 574:Z.RTL&&(H.Views[0].RTL=!0);break;case 146:ne=Z;break;case 2198:Pe=Z;break;case 140:ie=Z;break;case 442:h?le.CodeName=Z||le.name:H.WBProps.CodeName=Z||"ThisWorkbook";break}}else He||console.error("Missing Info for XLS Record 0x"+Ue.toString(16)),e.l+=Ie}return t.SheetNames=Ua(c).sort(function(Et,ht){return Number(Et)-Number(ht)}).map(function(Et){return c[Et].name}),a.bookSheets||(t.Sheets=i),!t.SheetNames.length&&E["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=E)):t.Preamble=E,t.Sheets&&K.forEach(function(Et,ht){t.Sheets[t.SheetNames[ht]]["!autofilter"]=Et}),t.Strings=g,t.SSF=wa(mt),ue.enc&&(t.Encryption=ue.enc),Pe&&(t.Themes=Pe),t.Metadata={},ie!==void 0&&(t.Metadata.Country=ie),fe.names.length>0&&(H.Names=fe.names),t.Workbook=H,t}var Gc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function u6(e,a,t){var i=pt.find(e,"/!DocumentSummaryInformation");if(i&&i.size>0)try{var s=hm(i,Fp,Gc.DSI);for(var c in s)a[c]=s[c]}catch(h){if(t.WTF)throw h}var f=pt.find(e,"/!SummaryInformation");if(f&&f.size>0)try{var p=hm(f,jp,Gc.SI);for(var g in p)a[g]==null&&(a[g]=p[g])}catch(h){if(t.WTF)throw h}a.HeadingPairs&&a.TitlesOfParts&&(Pv(a.HeadingPairs,a.TitlesOfParts,a,t),delete a.HeadingPairs,delete a.TitlesOfParts)}function p6(e,a){var t=[],i=[],s=[],c=0,f,p=Gx(Fp,"n"),g=Gx(jp,"n");if(e.Props)for(f=Ua(e.Props),c=0;c<f.length;++c)(Object.prototype.hasOwnProperty.call(p,f[c])?t:Object.prototype.hasOwnProperty.call(g,f[c])?i:s).push([f[c],e.Props[f[c]]]);if(e.Custprops)for(f=Ua(e.Custprops),c=0;c<f.length;++c)Object.prototype.hasOwnProperty.call(e.Props||{},f[c])||(Object.prototype.hasOwnProperty.call(p,f[c])?t:Object.prototype.hasOwnProperty.call(g,f[c])?i:s).push([f[c],e.Custprops[f[c]]]);var h=[];for(c=0;c<s.length;++c)Wv.indexOf(s[c][0])>-1||Lv.indexOf(s[c][0])>-1||s[c][1]!=null&&h.push(s[c]);i.length&&pt.utils.cfb_add(a,"/SummaryInformation",gm(i,Gc.SI,g,jp)),(t.length||h.length)&&pt.utils.cfb_add(a,"/DocumentSummaryInformation",gm(t,Gc.DSI,p,Fp,h.length?h:null,Gc.UDI))}function Uy(e,a){a||(a={}),Eh(a),$p(),a.codepage&&Hp(a.codepage);var t,i;if(e.FullPaths){if(pt.find(e,"/encryption"))throw new Error("File is password-protected");t=pt.find(e,"!CompObj"),i=pt.find(e,"/Workbook")||pt.find(e,"/Book")}else{switch(a.type){case"base64":e=An(Cn(e));break;case"binary":e=An(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Fr(e,0),i={content:e}}var s,c;if(t&&o6(t),a.bookProps&&!a.bookSheets)s={};else{var f=It?"buffer":"array";if(i&&i.content)s=f6(i.content,a);else if((c=pt.find(e,"PerfectOffice_MAIN"))&&c.content)s=yl.to_workbook(c.content,(a.type=f,a));else if((c=pt.find(e,"NativeContent_MAIN"))&&c.content)s=yl.to_workbook(c.content,(a.type=f,a));else throw(c=pt.find(e,"MN0"))&&c.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");a.bookVBA&&e.FullPaths&&pt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=C4(e))}var p={};return e.FullPaths&&u6(e,p,a),s.Props=s.Custprops=p,a.bookFiles&&(s.cfb=e),s}function h6(e,a){var t=a||{},i=pt.utils.cfb_new({root:"R"}),s="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":s="/Workbook",t.biff=8;break;case"biff5":s="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return pt.utils.cfb_add(i,s,Hy(e,t)),t.biff==8&&(e.Props||e.Custprops)&&p6(e,i),t.biff==8&&e.vbaraw&&k4(i,pt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),i}var a0={0:{f:LC},1:{f:WC},2:{f:fk},3:{f:ek},4:{f:KC},5:{f:ok},6:{f:xk},7:{f:nk},8:{f:Tk},9:{f:Ek},10:{f:bk},11:{f:Sk},12:{f:XC},13:{f:pk},14:{f:ak},15:{f:QC},16:{f:Dy},17:{f:vk},18:{f:sk},19:{f:rh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:vw},40:{},42:{},43:{f:x_},44:{f:h_},45:{f:y_},46:{f:S_},47:{f:b_},48:{},49:{f:US},50:{},51:{f:t4},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ry},62:{f:gk},63:{f:d4},64:{f:Pk},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:$r,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Ik},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:GC},148:{f:UC,p:16},151:{f:Rk},152:{},153:{f:gw},154:{},155:{},156:{f:pw},157:{},158:{},159:{T:1,f:FA},160:{T:-1},161:{T:1,f:Fl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Ak},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Z_},336:{T:-1},337:{f:n4,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Np},357:{},358:{},359:{},360:{T:1},361:{},362:{f:ay},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Nk},427:{f:Fk},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Dk},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:$C},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:kk},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Np},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:S4},633:{T:1},634:{T:-1},635:{T:1,f:y4},636:{T:-1},637:{f:YS},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:aw},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:zk},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Lp={6:{f:Sp},10:{f:Is},12:{f:ir},13:{f:ir},14:{f:qa},15:{f:qa},16:{f:Ur},17:{f:qa},18:{f:qa},19:{f:ir},20:{f:Sm},21:{f:Sm},23:{f:ay},24:{f:Tm},25:{f:qa},26:{},27:{},28:{f:zT},29:{},34:{f:qa},35:{f:Em},38:{f:Ur},39:{f:Ur},40:{f:Ur},41:{f:Ur},42:{f:qa},43:{f:qa},47:{f:QA},49:{f:pT},51:{f:ir},60:{},61:{f:oT},64:{f:qa},65:{f:uT},66:{f:ir},77:{},80:{},81:{},82:{},85:{f:ir},89:{},90:{},91:{},92:{f:JE},93:{f:$T},94:{},95:{f:qa},96:{},97:{},99:{f:qa},125:{f:ry},128:{f:wT},129:{f:ZE},130:{f:ir},131:{f:qa},132:{f:qa},133:{f:eT},134:{},140:{f:JT},141:{f:ir},144:{},146:{f:eA},151:{},152:{},153:{},154:{},155:{},156:{f:ir},157:{},158:{},160:{f:lA},161:{f:rA},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:AT},190:{f:_T},193:{f:Is},197:{},198:{},199:{},200:{},201:{},202:{f:qa},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ir},220:{},221:{f:qa},222:{},224:{f:kT},225:{f:KE},226:{f:Is},227:{},229:{f:UT},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:aT},253:{f:gT},255:{f:nT},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Vv},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:qa},353:{f:Is},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:DT},431:{f:qa},432:{},433:{},434:{},437:{},438:{f:WT},439:{f:qa},440:{f:VT},441:{},442:{f:o0},443:{},444:{f:ir},445:{},446:{},448:{f:Is},449:{f:lT,r:2},450:{f:Is},512:{f:vm},513:{f:sA},515:{f:FT},516:{f:mT},517:{f:bm},519:{f:oA},520:{f:iT},523:{},545:{f:Am},549:{f:mm},566:{},574:{f:dT},638:{f:TT},659:{},1048:{},1054:{f:yT},1084:{},1212:{f:MT},2048:{f:qT},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Od},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Is},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:tA,r:12},2173:{f:J_,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:qa,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:BT,r:12},2197:{},2198:{f:Y_,r:12},2199:{},2200:{},2201:{},2202:{f:LT,r:12},2203:{f:Is},2204:{},2205:{},2206:{},2207:{},2211:{f:sT},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ir},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:nA},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:ZT},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:vm},1:{},2:{f:pA},3:{f:fA},4:{f:dA},5:{f:bm},7:{f:gA},8:{},9:{f:Od},11:{},22:{f:ir},30:{f:ST},31:{},32:{},33:{f:Am},36:{},37:{f:mm},50:{f:xA},62:{},52:{},67:{},68:{f:ir},69:{},86:{},126:{},127:{f:cA},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:mA},223:{},234:{},354:{},421:{},518:{f:Sp},521:{f:Od},536:{f:Tm},547:{f:Em},561:{},579:{},1030:{f:Sp},1033:{f:Od},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Qe(e,a,t,i){var s=a;if(!isNaN(s)){var c=i||(t||[]).length||0,f=e.next(4);f.write_shift(2,s),f.write_shift(2,c),c>0&&eh(t)&&e.push(t)}}function g6(e,a,t,i){var s=(t||[]).length||0;if(s<=8224)return Qe(e,a,t,s);var c=a;if(!isNaN(c)){for(var f=t.parts||[],p=0,g=0,h=0;h+(f[p]||8224)<=8224;)h+=f[p]||8224,p++;var E=e.next(4);for(E.write_shift(2,c),E.write_shift(2,h),e.push(t.slice(g,g+h)),g+=h;g<s;){for(E=e.next(4),E.write_shift(2,60),h=0;h+(f[p]||8224)<=8224;)h+=f[p]||8224,p++;E.write_shift(2,h),e.push(t.slice(g,g+h)),g+=h}}}function u0(e,a,t){return e||(e=Ne(7)),e.write_shift(2,a),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function x6(e,a,t,i){var s=Ne(9);return u0(s,e,a),Xv(t,i||"b",s),s}function m6(e,a,t){var i=Ne(8+2*t.length);return u0(i,e,a),i.write_shift(1,t.length),i.write_shift(t.length,t,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function v6(e,a,t,i){if(a.v!=null)switch(a.t){case"d":case"n":var s=a.t=="d"?pr(ka(a.v)):a.v;s==(s|0)&&s>=0&&s<65536?Qe(e,2,hA(t,i,s)):Qe(e,3,uA(t,i,s));return;case"b":case"e":Qe(e,5,x6(t,i,a.v,a.t));return;case"s":case"str":Qe(e,4,m6(t,i,(a.v||"").slice(0,255)));return}Qe(e,1,u0(null,t,i))}function y6(e,a,t,i){var s=Array.isArray(a),c=Kt(a["!ref"]||"A1"),f,p="",g=[];if(c.e.c>255||c.e.r>16383){if(i.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");c.e.c=Math.min(c.e.c,255),c.e.r=Math.min(c.e.c,16383),f=wt(c)}for(var h=c.s.r;h<=c.e.r;++h){p=Ka(h);for(var E=c.s.c;E<=c.e.c;++E){h===c.s.r&&(g[E]=Oa(E)),f=g[E]+p;var A=s?(a[h]||[])[E]:a[f];A&&v6(e,A,h,E)}}}function b6(e,a){for(var t=a||{},i=fn(),s=0,c=0;c<e.SheetNames.length;++c)e.SheetNames[c]==t.sheet&&(s=c);if(s==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Qe(i,t.biff==4?1033:t.biff==3?521:9,dh(e,16,t)),y6(i,e.Sheets[e.SheetNames[s]],s,t),Qe(i,10),i.end()}function S6(e,a,t){Qe(e,49,hT({sz:12,name:"Arial"},t))}function E6(e,a,t){a&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)a[s]!=null&&Qe(e,1054,bT(s,a[s],t))})}function T6(e,a){var t=Ne(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Qe(e,2151,t),t=Ne(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),Zv(Kt(a["!ref"]||"A1"),t),t.write_shift(4,4),Qe(e,2152,t)}function A6(e,a){for(var t=0;t<16;++t)Qe(e,224,ym({numFmtId:0,style:!0},0,a));a.cellXfs.forEach(function(i){Qe(e,224,ym(i,0,a))})}function _6(e,a){for(var t=0;t<a["!links"].length;++t){var i=a["!links"][t];Qe(e,440,XT(i)),i[1].Tooltip&&Qe(e,2048,KT(i))}delete a["!links"]}function C6(e,a){if(a){var t=0;a.forEach(function(i,s){++t<=256&&i&&Qe(e,125,aA(of(s,i),s))})}}function k6(e,a,t,i,s){var c=16+Gs(s.cellXfs,a,s);if(a.v==null&&!a.bf){Qe(e,513,_l(t,i,c));return}if(a.bf)Qe(e,6,Z3(a,t,i,s,c));else switch(a.t){case"d":case"n":var f=a.t=="d"?pr(ka(a.v)):a.v;Qe(e,515,jT(t,i,f,c));break;case"b":case"e":Qe(e,517,NT(t,i,a.v,c,s,a.t));break;case"s":case"str":if(s.bookSST){var p=vh(s.Strings,a.v,s.revStrings);Qe(e,253,xT(t,i,p,c))}else Qe(e,516,vT(t,i,(a.v||"").slice(0,255),c,s));break;default:Qe(e,513,_l(t,i,c))}}function w6(e,a,t){var i=fn(),s=t.SheetNames[e],c=t.Sheets[s]||{},f=(t||{}).Workbook||{},p=(f.Sheets||[])[e]||{},g=Array.isArray(c),h=a.biff==8,E,A="",_=[],w=Kt(c["!ref"]||"A1"),N=h?65536:16384;if(w.e.c>255||w.e.r>=N){if(a.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:IV16384");w.e.c=Math.min(w.e.c,255),w.e.r=Math.min(w.e.c,N-1)}Qe(i,2057,dh(t,16,a)),Qe(i,13,Gn(1)),Qe(i,12,Gn(100)),Qe(i,15,Jr(!0)),Qe(i,17,Jr(!1)),Qe(i,16,Tl(.001)),Qe(i,95,Jr(!0)),Qe(i,42,Jr(!1)),Qe(i,43,Jr(!1)),Qe(i,130,Gn(1)),Qe(i,128,RT()),Qe(i,131,Jr(!1)),Qe(i,132,Jr(!1)),h&&C6(i,c["!cols"]),Qe(i,512,ET(w,a)),h&&(c["!links"]=[]);for(var k=w.s.r;k<=w.e.r;++k){A=Ka(k);for(var F=w.s.c;F<=w.e.c;++F){k===w.s.r&&(_[F]=Oa(F)),E=_[F]+A;var z=g?(c[k]||[])[F]:c[E];z&&(k6(i,z,k,F,a),h&&z.l&&c["!links"].push([E,z.l]))}}var q=p.CodeName||p.name||s;return h&&Qe(i,574,fT((f.Views||[])[0])),h&&(c["!merges"]||[]).length&&Qe(i,229,HT(c["!merges"])),h&&_6(i,c),Qe(i,442,qv(q)),h&&T6(i,c),Qe(i,10),i.end()}function R6(e,a,t){var i=fn(),s=(e||{}).Workbook||{},c=s.Sheets||[],f=s.WBProps||{},p=t.biff==8,g=t.biff==5;if(Qe(i,2057,dh(e,5,t)),t.bookType=="xla"&&Qe(i,135),Qe(i,225,p?Gn(1200):null),Qe(i,193,NE(2)),g&&Qe(i,191),g&&Qe(i,192),Qe(i,226),Qe(i,92,QE("SheetJS",t)),Qe(i,66,Gn(p?1200:1252)),p&&Qe(i,353,Gn(0)),p&&Qe(i,448),Qe(i,317,iA(e.SheetNames.length)),p&&e.vbaraw&&Qe(i,211),p&&e.vbaraw){var h=f.CodeName||"ThisWorkbook";Qe(i,442,qv(h))}Qe(i,156,Gn(17)),Qe(i,25,Jr(!1)),Qe(i,18,Jr(!1)),Qe(i,19,Gn(0)),p&&Qe(i,431,Jr(!1)),p&&Qe(i,444,Gn(0)),Qe(i,61,cT()),Qe(i,64,Jr(!1)),Qe(i,141,Gn(0)),Qe(i,34,Jr(lw(e)=="true")),Qe(i,14,Jr(!0)),p&&Qe(i,439,Jr(!1)),Qe(i,218,Gn(0)),S6(i,e,t),E6(i,e.SSF,t),A6(i,t),p&&Qe(i,352,Jr(!1));var E=i.end(),A=fn();p&&Qe(A,140,QT()),p&&t.Strings&&g6(A,252,rT(t.Strings)),Qe(A,10);var _=A.end(),w=fn(),N=0,k=0;for(k=0;k<e.SheetNames.length;++k)N+=(p?12:11)+(p?2:1)*e.SheetNames[k].length;var F=E.length+N+_.length;for(k=0;k<e.SheetNames.length;++k){var z=c[k]||{};Qe(w,133,tT({pos:F,hs:z.Hidden||0,dt:0,name:e.SheetNames[k]},t)),F+=a[k].length}var q=w.end();if(N!=q.length)throw new Error("BS8 "+N+" != "+q.length);var B=[];return E.length&&B.push(E),q.length&&B.push(q),_.length&&B.push(_),br(B)}function N6(e,a){var t=a||{},i=[];e&&!e.SSF&&(e.SSF=wa(mt)),e&&e.SSF&&(Fo(),ef(e.SSF),t.revssf=af(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Th(t),t.cellXfs=[],Gs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)i[i.length]=w6(s,t,e);return i.unshift(R6(e,i,t)),br(i)}function Hy(e,a){for(var t=0;t<=e.SheetNames.length;++t){var i=e.Sheets[e.SheetNames[t]];if(!(!i||!i["!ref"])){var s=un(i["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var c=a||{};switch(c.biff||2){case 8:case 5:return N6(e,a);case 4:case 3:case 2:return b6(e,a)}throw new Error("invalid type "+c.bookType+" for BIFF")}function Om(e,a){var t=a||{},i=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var c=e.match(/<\/table/i),f=s.index,p=c&&c.index||e.length,g=hS(e.slice(f,p),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,E=0,A=0,_=0,w={s:{r:1e7,c:1e7},e:{r:0,c:0}},N=[];for(f=0;f<g.length;++f){var k=g[f].trim(),F=k.slice(0,3).toLowerCase();if(F=="<tr"){if(++h,t.sheetRows&&t.sheetRows<=h){--h;break}E=0;continue}if(!(F!="<td"&&F!="<th")){var z=k.split(/<\/t[dh]>/i);for(p=0;p<z.length;++p){var q=z[p].trim();if(q.match(/<t[dh]/i)){for(var B=q,ie=0;B.charAt(0)=="<"&&(ie=B.indexOf(">"))>-1;)B=B.slice(ie+1);for(var se=0;se<N.length;++se){var ne=N[se];ne.s.c==E&&ne.s.r<h&&h<=ne.e.r&&(E=ne.e.c+1,se=-1)}var H=bt(q.slice(0,q.indexOf(">")));_=H.colspan?+H.colspan:1,((A=+H.rowspan)>1||_>1)&&N.push({s:{r:h,c:E},e:{r:h+(A||1)-1,c:E+_-1}});var le=H.t||H["data-t"]||"";if(!B.length){E+=_;continue}if(B=uv(B),w.s.r>h&&(w.s.r=h),w.e.r<h&&(w.e.r=h),w.s.c>E&&(w.s.c=E),w.e.c<E&&(w.e.c=E),!B.length){E+=_;continue}var oe={t:"s",v:B};t.raw||!B.trim().length||le=="s"||(B==="TRUE"?oe={t:"b",v:!0}:B==="FALSE"?oe={t:"b",v:!1}:isNaN(li(B))?isNaN(ko(B).getDate())||(oe={t:"d",v:ka(B)},t.cellDates||(oe={t:"n",v:pr(oe.v)}),oe.z=t.dateNF||mt[14]):oe={t:"n",v:li(B)}),t.dense?(i[h]||(i[h]=[]),i[h][E]=oe):i[vt({r:h,c:E})]=oe,E+=_}}}}return i["!ref"]=wt(w),N.length&&(i["!merges"]=N),i}function F6(e,a,t,i){for(var s=e["!merges"]||[],c=[],f=a.s.c;f<=a.e.c;++f){for(var p=0,g=0,h=0;h<s.length;++h)if(!(s[h].s.r>t||s[h].s.c>f)&&!(s[h].e.r<t||s[h].e.c<f)){if(s[h].s.r<t||s[h].s.c<f){p=-1;break}p=s[h].e.r-s[h].s.r+1,g=s[h].e.c-s[h].s.c+1;break}if(!(p<0)){var E=vt({r:t,c:f}),A=i.dense?(e[t]||[])[f]:e[E],_=A&&A.v!=null&&(A.h||Jp(A.w||(es(A),A.w)||""))||"",w={};p>1&&(w.rowspan=p),g>1&&(w.colspan=g),i.editable?_='<span contenteditable="true">'+_+"</span>":A&&(w["data-t"]=A&&A.t||"z",A.v!=null&&(w["data-v"]=A.v),A.z!=null&&(w["data-z"]=A.z),A.l&&(A.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+A.l.Target+'">'+_+"</a>")),w.id=(i.id||"sjs")+"-"+E,c.push(Ke("td",_,w))}}var N="<tr>";return N+c.join("")+"</tr>"}var j6='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',D6="</body></html>";function O6(e,a){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return $s(Om(t[0],a),a);var i=Ch();return t.forEach(function(s,c){kh(i,Om(s,a),"Sheet"+(c+1))}),i}function I6(e,a,t){var i=[];return i.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function $y(e,a){var t=a||{},i=t.header!=null?t.header:j6,s=t.footer!=null?t.footer:D6,c=[i],f=un(e["!ref"]);t.dense=Array.isArray(e),c.push(I6(e,f,t));for(var p=f.s.r;p<=f.e.r;++p)c.push(F6(e,f,p,t));return c.push("</table>"+s),c.join("")}function Gy(e,a,t){var i=t||{},s=0,c=0;if(i.origin!=null)if(typeof i.origin=="number")s=i.origin;else{var f=typeof i.origin=="string"?Ia(i.origin):i.origin;s=f.r,c=f.c}var p=a.getElementsByTagName("tr"),g=Math.min(i.sheetRows||1e7,p.length),h={s:{r:0,c:0},e:{r:s,c}};if(e["!ref"]){var E=un(e["!ref"]);h.s.r=Math.min(h.s.r,E.s.r),h.s.c=Math.min(h.s.c,E.s.c),h.e.r=Math.max(h.e.r,E.e.r),h.e.c=Math.max(h.e.c,E.e.c),s==-1&&(h.e.r=s=E.e.r+1)}var A=[],_=0,w=e["!rows"]||(e["!rows"]=[]),N=0,k=0,F=0,z=0,q=0,B=0;for(e["!cols"]||(e["!cols"]=[]);N<p.length&&k<g;++N){var ie=p[N];if(Im(ie)){if(i.display)continue;w[k]={hidden:!0}}var se=ie.children;for(F=z=0;F<se.length;++F){var ne=se[F];if(!(i.display&&Im(ne))){var H=ne.hasAttribute("data-v")?ne.getAttribute("data-v"):ne.hasAttribute("v")?ne.getAttribute("v"):uv(ne.innerHTML),le=ne.getAttribute("data-z")||ne.getAttribute("z");for(_=0;_<A.length;++_){var oe=A[_];oe.s.c==z+c&&oe.s.r<k+s&&k+s<=oe.e.r&&(z=oe.e.c+1-c,_=-1)}B=+ne.getAttribute("colspan")||1,((q=+ne.getAttribute("rowspan")||1)>1||B>1)&&A.push({s:{r:k+s,c:z+c},e:{r:k+s+(q||1)-1,c:z+c+(B||1)-1}});var m={t:"s",v:H},Se=ne.getAttribute("data-t")||ne.getAttribute("t")||"";H!=null&&(H.length==0?m.t=Se||"z":i.raw||H.trim().length==0||Se=="s"||(H==="TRUE"?m={t:"b",v:!0}:H==="FALSE"?m={t:"b",v:!1}:isNaN(li(H))?isNaN(ko(H).getDate())||(m={t:"d",v:ka(H)},i.cellDates||(m={t:"n",v:pr(m.v)}),m.z=i.dateNF||mt[14]):m={t:"n",v:li(H)})),m.z===void 0&&le!=null&&(m.z=le);var ue="",Pe=ne.getElementsByTagName("A");if(Pe&&Pe.length)for(var tt=0;tt<Pe.length&&!(Pe[tt].hasAttribute("href")&&(ue=Pe[tt].getAttribute("href"),ue.charAt(0)!="#"));++tt);ue&&ue.charAt(0)!="#"&&(m.l={Target:ue}),i.dense?(e[k+s]||(e[k+s]=[]),e[k+s][z+c]=m):e[vt({c:z+c,r:k+s})]=m,h.e.c<z+c&&(h.e.c=z+c),z+=B}}++k}return A.length&&(e["!merges"]=(e["!merges"]||[]).concat(A)),h.e.r=Math.max(h.e.r,k-1+s),e["!ref"]=wt(h),k>=g&&(e["!fullref"]=wt((h.e.r=p.length-N+k-1+s,h))),e}function Yy(e,a){var t=a||{},i=t.dense?[]:{};return Gy(i,e,a)}function B6(e,a){return $s(Yy(e,a),a)}function Im(e){var a="",t=M6(e);return t&&(a=t(e).getPropertyValue("display")),a||(a=e.style&&e.style.display),a==="none"}function M6(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function L6(e){var a=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(i,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=qt(a.replace(/<[^>]*>/g,""));return[t]}var Bm={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Wy(e,a){var t=a||{},i=Qp(e),s=[],c,f,p={name:""},g="",h=0,E,A,_={},w=[],N=t.dense?[]:{},k,F,z={value:""},q="",B=0,ie=[],se=-1,ne=-1,H={s:{r:1e6,c:1e7},e:{r:0,c:0}},le=0,oe={},m=[],Se={},ue=0,Pe=0,tt=[],ke=1,de=1,_e=[],Ze={Names:[]},fe={},Je=["",""],ee=[],O={},L="",K=0,te=!1,he=!1,Oe=0;for(Kc.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");k=Kc.exec(i);)switch(k[3]=k[3].replace(/_.*$/,"")){case"table":case"":k[1]==="/"?(H.e.c>=H.s.c&&H.e.r>=H.s.r?N["!ref"]=wt(H):N["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=H.e.r&&(N["!fullref"]=N["!ref"],H.e.r=t.sheetRows-1,N["!ref"]=wt(H)),m.length&&(N["!merges"]=m),tt.length&&(N["!rows"]=tt),E.name=E.||E.name,typeof JSON<"u"&&JSON.stringify(E),w.push(E.name),_[E.name]=N,he=!1):k[0].charAt(k[0].length-2)!=="/"&&(E=bt(k[0],!1),se=ne=-1,H.s.r=H.s.c=1e7,H.e.r=H.e.c=0,N=t.dense?[]:{},m=[],tt=[],he=!0);break;case"table-row-group":k[1]==="/"?--le:++le;break;case"table-row":case"":if(k[1]==="/"){se+=ke,ke=1;break}if(A=bt(k[0],!1),A.?se=A.-1:se==-1&&(se=0),ke=+A["number-rows-repeated"]||1,ke<10)for(Oe=0;Oe<ke;++Oe)le>0&&(tt[se+Oe]={level:le});ne=-1;break;case"covered-table-cell":k[1]!=="/"&&++ne,t.sheetStubs&&(t.dense?(N[se]||(N[se]=[]),N[se][ne]={t:"z"}):N[vt({r:se,c:ne})]={t:"z"}),q="",ie=[];break;case"table-cell":case"":if(k[0].charAt(k[0].length-2)==="/")++ne,z=bt(k[0],!1),de=parseInt(z["number-columns-repeated"]||"1",10),F={t:"z",v:null},z.formula&&t.cellFormula!=!1&&(F.f=Fm(qt(z.formula))),(z.||z["value-type"])=="string"&&(F.t="s",F.v=qt(z["string-value"]||""),t.dense?(N[se]||(N[se]=[]),N[se][ne]=F):N[vt({r:se,c:ne})]=F),ne+=de-1;else if(k[1]!=="/"){++ne,q="",B=0,ie=[],de=1;var Ue=ke?se+ke-1:se;if(ne>H.e.c&&(H.e.c=ne),ne<H.s.c&&(H.s.c=ne),se<H.s.r&&(H.s.r=se),Ue>H.e.r&&(H.e.r=Ue),z=bt(k[0],!1),ee=[],O={},F={t:z.||z["value-type"],v:null},t.cellFormula)if(z.formula&&(z.formula=qt(z.formula)),z["number-matrix-columns-spanned"]&&z["number-matrix-rows-spanned"]&&(ue=parseInt(z["number-matrix-rows-spanned"],10)||0,Pe=parseInt(z["number-matrix-columns-spanned"],10)||0,Se={s:{r:se,c:ne},e:{r:se+ue-1,c:ne+Pe-1}},F.F=wt(Se),_e.push([Se,F.F])),z.formula)F.f=Fm(z.formula);else for(Oe=0;Oe<_e.length;++Oe)se>=_e[Oe][0].s.r&&se<=_e[Oe][0].e.r&&ne>=_e[Oe][0].s.c&&ne<=_e[Oe][0].e.c&&(F.F=_e[Oe][1]);switch((z["number-columns-spanned"]||z["number-rows-spanned"])&&(ue=parseInt(z["number-rows-spanned"],10)||0,Pe=parseInt(z["number-columns-spanned"],10)||0,Se={s:{r:se,c:ne},e:{r:se+ue-1,c:ne+Pe-1}},m.push(Se)),z["number-columns-repeated"]&&(de=parseInt(z["number-columns-repeated"],10)),F.t){case"boolean":F.t="b",F.v=Ca(z["boolean-value"]);break;case"float":F.t="n",F.v=parseFloat(z.value);break;case"percentage":F.t="n",F.v=parseFloat(z.value);break;case"currency":F.t="n",F.v=parseFloat(z.value);break;case"date":F.t="d",F.v=ka(z["date-value"]),t.cellDates||(F.t="n",F.v=pr(F.v)),F.z="m/d/yy";break;case"time":F.t="n",F.v=fS(z["time-value"])/86400,t.cellDates&&(F.t="d",F.v=rf(F.v)),F.z="HH:MM:SS";break;case"number":F.t="n",F.v=parseFloat(z.);break;default:if(F.t==="string"||F.t==="text"||!F.t)F.t="s",z["string-value"]!=null&&(q=qt(z["string-value"]),ie=[]);else throw new Error("Unsupported value type "+F.t)}}else{if(te=!1,F.t==="s"&&(F.v=q||"",ie.length&&(F.R=ie),te=B==0),fe.Target&&(F.l=fe),ee.length>0&&(F.c=ee,ee=[]),q&&t.cellText!==!1&&(F.w=q),te&&(F.t="z",delete F.v),(!te||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=se))for(var Ie=0;Ie<ke;++Ie){if(de=parseInt(z["number-columns-repeated"]||"1",10),t.dense)for(N[se+Ie]||(N[se+Ie]=[]),N[se+Ie][ne]=Ie==0?F:wa(F);--de>0;)N[se+Ie][ne+de]=wa(F);else for(N[vt({r:se+Ie,c:ne})]=F;--de>0;)N[vt({r:se+Ie,c:ne+de})]=wa(F);H.e.c<=ne&&(H.e.c=ne)}de=parseInt(z["number-columns-repeated"]||"1",10),ne+=de-1,de=0,F={},q="",ie=[]}fe={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(k[1]==="/"){if((c=s.pop())[0]!==k[3])throw"Bad state: "+c}else k[0].charAt(k[0].length-2)!=="/"&&s.push([k[3],!0]);break;case"annotation":if(k[1]==="/"){if((c=s.pop())[0]!==k[3])throw"Bad state: "+c;O.t=q,ie.length&&(O.R=ie),O.a=L,ee.push(O)}else k[0].charAt(k[0].length-2)!=="/"&&s.push([k[3],!1]);L="",K=0,q="",B=0,ie=[];break;case"creator":k[1]==="/"?L=i.slice(K,k.index):K=k.index+k[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(k[1]==="/"){if((c=s.pop())[0]!==k[3])throw"Bad state: "+c}else k[0].charAt(k[0].length-2)!=="/"&&s.push([k[3],!1]);q="",B=0,ie=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(k[1]==="/"){if(oe[p.name]=g,(c=s.pop())[0]!==k[3])throw"Bad state: "+c}else k[0].charAt(k[0].length-2)!=="/"&&(g="",p=bt(k[0],!1),s.push([k[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":f=bt(k[0],!1),g+=Bm[k[3]][f.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":f=bt(k[0],!1),g+=Bm[k[3]][f.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(k[0].slice(-2)==="/>")break;if(k[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":g+=i.slice(h,k.index);break}else h=k.index+k[0].length;break;case"named-range":f=bt(k[0],!1),Je=Ep(f["cell-range-address"]);var He={Name:f.name,Ref:Je[0]+"!"+Je[1]};he&&(He.Sheet=w.length),Ze.Names.push(He);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(k[1]==="/"&&(!z||!z["string-value"])){var gt=L6(i.slice(B,k.index));q=(q.length>0?q+`
`:"")+gt[0]}else bt(k[0],!1),B=k.index+k[0].length;break;case"s":break;case"database-range":if(k[1]==="/")break;try{Je=Ep(bt(k[0])["target-range-address"]),_[Je[0]]["!autofilter"]={ref:Je[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(k[1]!=="/"){if(fe=bt(k[0],!1),!fe.href)break;fe.Target=qt(fe.href),delete fe.href,fe.Target.charAt(0)=="#"&&fe.Target.indexOf(".")>-1?(Je=Ep(fe.Target.slice(1)),fe.Target="#"+Je[0]+"!"+Je[1]):fe.Target.match(/^\.\.[\\\/]/)&&(fe.Target=fe.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(k[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(k)}}var Z={Sheets:_,SheetNames:w,Workbook:Ze};return t.bookSheets&&delete Z.Sheets,Z}function Mm(e,a){a=a||{},$n(e,"META-INF/manifest.xml")&&fE(nr(e,"META-INF/manifest.xml"),a);var t=_n(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var i=Wy(ga(t),a);return $n(e,"meta.xml")&&(i.Props=Bv(nr(e,"meta.xml"))),i}function Lm(e,a){return Wy(e,a)}var P6=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),a="<office:document-styles "+qc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Ja+a}})(),Pm=(function(){var e=function(c){return fa(c).replace(/  +/g,function(f){return'<text:s text:c="'+f.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},a=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,i=function(c,f,p){var g=[];g.push('      <table:table table:name="'+fa(f.SheetNames[p])+`" table:style-name="ta1">
`);var h=0,E=0,A=un(c["!ref"]||"A1"),_=c["!merges"]||[],w=0,N=Array.isArray(c);if(c["!cols"])for(E=0;E<=A.e.c;++E)g.push("        <table:table-column"+(c["!cols"][E]?' table:style-name="co'+c["!cols"][E].ods+'"':"")+`></table:table-column>
`);var k="",F=c["!rows"]||[];for(h=0;h<A.s.r;++h)k=F[h]?' table:style-name="ro'+F[h].ods+'"':"",g.push("        <table:table-row"+k+`></table:table-row>
`);for(;h<=A.e.r;++h){for(k=F[h]?' table:style-name="ro'+F[h].ods+'"':"",g.push("        <table:table-row"+k+`>
`),E=0;E<A.s.c;++E)g.push(a);for(;E<=A.e.c;++E){var z=!1,q={},B="";for(w=0;w!=_.length;++w)if(!(_[w].s.c>E)&&!(_[w].s.r>h)&&!(_[w].e.c<E)&&!(_[w].e.r<h)){(_[w].s.c!=E||_[w].s.r!=h)&&(z=!0),q["table:number-columns-spanned"]=_[w].e.c-_[w].s.c+1,q["table:number-rows-spanned"]=_[w].e.r-_[w].s.r+1;break}if(z){g.push(t);continue}var ie=vt({r:h,c:E}),se=N?(c[h]||[])[E]:c[ie];if(se&&se.f&&(q["table:formula"]=fa(iC(se.f)),se.F&&se.F.slice(0,ie.length)==ie)){var ne=un(se.F);q["table:number-matrix-columns-spanned"]=ne.e.c-ne.s.c+1,q["table:number-matrix-rows-spanned"]=ne.e.r-ne.s.r+1}if(!se){g.push(a);continue}switch(se.t){case"b":B=se.v?"TRUE":"FALSE",q["office:value-type"]="boolean",q["office:boolean-value"]=se.v?"true":"false";break;case"n":B=se.w||String(se.v||0),q["office:value-type"]="float",q["office:value"]=se.v||0;break;case"s":case"str":B=se.v==null?"":se.v,q["office:value-type"]="string";break;case"d":B=se.w||ka(se.v).toISOString(),q["office:value-type"]="date",q["office:date-value"]=ka(se.v).toISOString(),q["table:style-name"]="ce1";break;default:g.push(a);continue}var H=e(B);if(se.l&&se.l.Target){var le=se.l.Target;le=le.charAt(0)=="#"?"#"+sC(le.slice(1)):le,le.charAt(0)!="#"&&!le.match(/^\w+:/)&&(le="../"+le),H=Ke("text:a",H,{"xlink:href":le.replace(/&/g,"&amp;")})}g.push("          "+Ke("table:table-cell",Ke("text:p",H,{}),q)+`
`)}g.push(`        </table:table-row>
`)}return g.push(`      </table:table>
`),g.join("")},s=function(c,f){c.push(` <office:automatic-styles>
`),c.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),c.push(`   <number:month number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:day number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:year/>
`),c.push(`  </number:date-style>
`);var p=0;f.SheetNames.map(function(h){return f.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var E=0;E<h["!cols"].length;++E)if(h["!cols"][E]){var A=h["!cols"][E];if(A.width==null&&A.wpx==null&&A.wch==null)continue;Ps(A),A.ods=p;var _=h["!cols"][E].wpx+"px";c.push('  <style:style style:name="co'+p+`" style:family="table-column">
`),c.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_+`"/>
`),c.push(`  </style:style>
`),++p}}});var g=0;f.SheetNames.map(function(h){return f.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var E=0;E<h["!rows"].length;++E)if(h["!rows"][E]){h["!rows"][E].ods=g;var A=h["!rows"][E].hpx+"px";c.push('  <style:style style:name="ro'+g+`" style:family="table-row">
`),c.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+A+`"/>
`),c.push(`  </style:style>
`),++g}}}),c.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),c.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),c.push(`  </style:style>
`),c.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),c.push(` </office:automatic-styles>
`)};return function(f,p){var g=[Ja],h=qc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),E=qc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});p.bookType=="fods"?(g.push("<office:document"+h+E+`>
`),g.push(Iv().replace(/office:document-meta/g,"office:meta"))):g.push("<office:document-content"+h+`>
`),s(g,f),g.push(`  <office:body>
`),g.push(`    <office:spreadsheet>
`);for(var A=0;A!=f.SheetNames.length;++A)g.push(i(f.Sheets[f.SheetNames[A]],f,A));return g.push(`    </office:spreadsheet>
`),g.push(`  </office:body>
`),p.bookType=="fods"?g.push("</office:document>"):g.push("</office:document-content>"),g.join("")}})();function Vy(e,a){if(a.bookType=="fods")return Pm(e,a);var t=Xp(),i="",s=[],c=[];return i="mimetype",Dt(t,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",Dt(t,i,Pm(e,a)),s.push([i,"text/xml"]),c.push([i,"ContentFile"]),i="styles.xml",Dt(t,i,P6(e,a)),s.push([i,"text/xml"]),c.push([i,"StylesFile"]),i="meta.xml",Dt(t,i,Ja+Iv()),s.push([i,"text/xml"]),c.push([i,"MetadataFile"]),i="manifest.rdf",Dt(t,i,hE(c)),s.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",Dt(t,i,uE(s)),t}function Cl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Pp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ga(Hs(e))}function z6(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):An(Ai(e))}function U6(e,a){e:for(var t=0;t<=e.length-a.length;++t){for(var i=0;i<a.length;++i)if(e[t+i]!=a[i])continue e;return!0}return!1}function Us(e){var a=e.reduce(function(s,c){return s+c.length},0),t=new Uint8Array(a),i=0;return e.forEach(function(s){t.set(s,i),i+=s.length}),t}function zm(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function H6(e,a){for(var t=(e[a+15]&127)<<7|e[a+14]>>1,i=e[a+14]&1,s=a+13;s>=a;--s)i=i*256+e[s];return(e[a+15]&128?-i:i)*Math.pow(10,t-6176)}function $6(e,a,t){var i=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,s=t/Math.pow(10,i-6176);e[a+15]|=i>>7,e[a+14]|=(i&127)<<1;for(var c=0;s>=1;++c,s/=256)e[a+c]=s&255;e[a+15]|=t>=0?0:128}function r0(e,a){var t=a?a[0]:0,i=e[t]&127;e:if(e[t++]>=128&&(i|=(e[t]&127)<<7,e[t++]<128||(i|=(e[t]&127)<<14,e[t++]<128)||(i|=(e[t]&127)<<21,e[t++]<128)||(i+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(i+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(i+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return a&&(a[0]=t),i}function ca(e){var a=new Uint8Array(7);a[0]=e&127;var t=1;e:if(e>127){if(a[t-1]|=128,a[t]=e>>7&127,++t,e<=16383||(a[t-1]|=128,a[t]=e>>14&127,++t,e<=2097151)||(a[t-1]|=128,a[t]=e>>21&127,++t,e<=268435455)||(a[t-1]|=128,a[t]=e/256>>>21&127,++t,e<=34359738367)||(a[t-1]|=128,a[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;a[t-1]|=128,a[t]=e/16777216>>>21&127,++t}return a.slice(0,t)}function za(e){var a=0,t=e[a]&127;e:if(e[a++]>=128){if(t|=(e[a]&127)<<7,e[a++]<128||(t|=(e[a]&127)<<14,e[a++]<128)||(t|=(e[a]&127)<<21,e[a++]<128))break e;t|=(e[a]&127)<<28}return t}function Zt(e){for(var a=[],t=[0];t[0]<e.length;){var i=t[0],s=r0(e,t),c=s&7;s=Math.floor(s/8);var f=0,p;if(s==0)break;switch(c){case 0:{for(var g=t[0];e[t[0]++]>=128;);p=e.slice(g,t[0])}break;case 5:f=4,p=e.slice(t[0],t[0]+f),t[0]+=f;break;case 1:f=8,p=e.slice(t[0],t[0]+f),t[0]+=f;break;case 2:f=r0(e,t),p=e.slice(t[0],t[0]+f),t[0]+=f;break;default:throw new Error("PB Type ".concat(c," for Field ").concat(s," at offset ").concat(i))}var h={data:p,type:c};a[s]==null?a[s]=[h]:a[s].push(h)}return a}function Nr(e){var a=[];return e.forEach(function(t,i){t.forEach(function(s){s.data&&(a.push(ca(i*8+s.type)),s.type==2&&a.push(ca(s.data.length)),a.push(s.data))})}),Us(a)}function Sh(e,a){return e?.map(function(t){return a(t.data)})||[]}function Un(e){for(var a,t=[],i=[0];i[0]<e.length;){var s=r0(e,i),c=Zt(e.slice(i[0],i[0]+s));i[0]+=s;var f={id:za(c[1][0].data),messages:[]};c[2].forEach(function(p){var g=Zt(p.data),h=za(g[3][0].data);f.messages.push({meta:g,data:e.slice(i[0],i[0]+h)}),i[0]+=h}),(a=c[3])!=null&&a[0]&&(f.merge=za(c[3][0].data)>>>0>0),t.push(f)}return t}function yo(e){var a=[];return e.forEach(function(t){var i=[];i[1]=[{data:ca(t.id),type:0}],i[2]=[],t.merge!=null&&(i[3]=[{data:ca(+!!t.merge),type:0}]);var s=[];t.messages.forEach(function(f){s.push(f.data),f.meta[3]=[{type:0,data:ca(f.data.length)}],i[2].push({data:Nr(f.meta),type:2})});var c=Nr(i);a.push(ca(c.length)),a.push(c),s.forEach(function(f){return a.push(f)})}),Us(a)}function G6(e,a){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],i=r0(a,t),s=[];t[0]<a.length;){var c=a[t[0]]&3;if(c==0){var f=a[t[0]++]>>2;if(f<60)++f;else{var p=f-59;f=a[t[0]],p>1&&(f|=a[t[0]+1]<<8),p>2&&(f|=a[t[0]+2]<<16),p>3&&(f|=a[t[0]+3]<<24),f>>>=0,f++,t[0]+=p}s.push(a.slice(t[0],t[0]+f)),t[0]+=f;continue}else{var g=0,h=0;if(c==1?(h=(a[t[0]]>>2&7)+4,g=(a[t[0]++]&224)<<3,g|=a[t[0]++]):(h=(a[t[0]++]>>2)+1,c==2?(g=a[t[0]]|a[t[0]+1]<<8,t[0]+=2):(g=(a[t[0]]|a[t[0]+1]<<8|a[t[0]+2]<<16|a[t[0]+3]<<24)>>>0,t[0]+=4)),s=[Us(s)],g==0)throw new Error("Invalid offset 0");if(g>s[0].length)throw new Error("Invalid offset beyond length");if(h>=g)for(s.push(s[0].slice(-g)),h-=g;h>=s[s.length-1].length;)s.push(s[s.length-1]),h-=s[s.length-1].length;s.push(s[0].slice(-g,-g+h))}}var E=Us(s);if(E.length!=i)throw new Error("Unexpected length: ".concat(E.length," != ").concat(i));return E}function Hn(e){for(var a=[],t=0;t<e.length;){var i=e[t++],s=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,a.push(G6(i,e.slice(t,t+s))),t+=s}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Us(a)}function bo(e){for(var a=[],t=0;t<e.length;){var i=Math.min(e.length-t,268435455),s=new Uint8Array(4);a.push(s);var c=ca(i),f=c.length;a.push(c),i<=60?(f++,a.push(new Uint8Array([i-1<<2]))):i<=256?(f+=2,a.push(new Uint8Array([240,i-1&255]))):i<=65536?(f+=3,a.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(f+=4,a.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(f+=5,a.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),a.push(e.slice(t,t+i)),f+=i,s[0]=0,s[1]=f&255,s[2]=f>>8&255,s[3]=f>>16&255,t+=i}return Us(a)}function Y6(e,a,t,i){var s=Cl(e),c=s.getUint32(4,!0),f=(i>1?12:8)+zm(c&(i>1?3470:398))*4,p=-1,g=-1,h=NaN,E=new Date(2001,0,1);c&512&&(p=s.getUint32(f,!0),f+=4),f+=zm(c&(i>1?12288:4096))*4,c&16&&(g=s.getUint32(f,!0),f+=4),c&32&&(h=s.getFloat64(f,!0),f+=8),c&64&&(E.setTime(E.getTime()+s.getFloat64(f,!0)*1e3),f+=8);var A;switch(e[2]){case 0:break;case 2:A={t:"n",v:h};break;case 3:A={t:"s",v:a[g]};break;case 5:A={t:"d",v:E};break;case 6:A={t:"b",v:h>0};break;case 7:A={t:"n",v:h/86400};break;case 8:A={t:"e",v:0};break;case 9:if(p>-1)A={t:"s",v:t[p]};else if(g>-1)A={t:"s",v:a[g]};else if(!isNaN(h))A={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return A}function W6(e,a,t){var i=Cl(e),s=i.getUint32(8,!0),c=12,f=-1,p=-1,g=NaN,h=NaN,E=new Date(2001,0,1);s&1&&(g=H6(e,c),c+=16),s&2&&(h=i.getFloat64(c,!0),c+=8),s&4&&(E.setTime(E.getTime()+i.getFloat64(c,!0)*1e3),c+=8),s&8&&(p=i.getUint32(c,!0),c+=4),s&16&&(f=i.getUint32(c,!0),c+=4);var A;switch(e[1]){case 0:break;case 2:A={t:"n",v:g};break;case 3:A={t:"s",v:a[p]};break;case 5:A={t:"d",v:E};break;case 6:A={t:"b",v:h>0};break;case 7:A={t:"n",v:h/86400};break;case 8:A={t:"e",v:0};break;case 9:if(f>-1)A={t:"s",v:t[f]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:A={t:"n",v:g};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return A}function Ap(e,a){var t=new Uint8Array(32),i=Cl(t),s=12,c=0;switch(t[0]=5,e.t){case"n":t[1]=2,$6(t,s,e.v),c|=1,s+=16;break;case"b":t[1]=6,i.setFloat64(s,e.v?1:0,!0),c|=2,s+=8;break;case"s":if(a.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,i.setUint32(s,a.indexOf(e.v),!0),c|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return i.setUint32(8,c,!0),t.slice(0,s)}function _p(e,a){var t=new Uint8Array(32),i=Cl(t),s=12,c=0;switch(t[0]=3,e.t){case"n":t[2]=2,i.setFloat64(s,e.v,!0),c|=32,s+=8;break;case"b":t[2]=6,i.setFloat64(s,e.v?1:0,!0),c|=32,s+=8;break;case"s":if(a.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,i.setUint32(s,a.indexOf(e.v),!0),c|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return i.setUint32(4,c,!0),t.slice(0,s)}function V6(e,a,t){switch(e[0]){case 0:case 1:case 2:case 3:return Y6(e,a,t,e[0]);case 5:return W6(e,a,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Lr(e){var a=Zt(e);return r0(a[1][0].data)}function Um(e,a){var t=Zt(a.data),i=za(t[1][0].data),s=t[3],c=[];return(s||[]).forEach(function(f){var p=Zt(f.data),g=za(p[1][0].data)>>>0;switch(i){case 1:c[g]=Pp(p[3][0].data);break;case 8:{var h=e[Lr(p[9][0].data)][0],E=Zt(h.data),A=e[Lr(E[1][0].data)][0],_=za(A.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var w=Zt(A.data);c[g]=w[3].map(function(N){return Pp(N.data)}).join("")}break}}),c}function X6(e,a){var t,i,s,c,f,p,g,h,E,A,_,w,N,k,F=Zt(e),z=za(F[1][0].data)>>>0,q=za(F[2][0].data)>>>0,B=((i=(t=F[8])==null?void 0:t[0])==null?void 0:i.data)&&za(F[8][0].data)>0||!1,ie,se;if((c=(s=F[7])==null?void 0:s[0])!=null&&c.data&&a!=0)ie=(p=(f=F[7])==null?void 0:f[0])==null?void 0:p.data,se=(h=(g=F[6])==null?void 0:g[0])==null?void 0:h.data;else if((A=(E=F[4])==null?void 0:E[0])!=null&&A.data&&a!=1)ie=(w=(_=F[4])==null?void 0:_[0])==null?void 0:w.data,se=(k=(N=F[3])==null?void 0:N[0])==null?void 0:k.data;else throw"NUMBERS Tile missing ".concat(a," cell storage");for(var ne=B?4:1,H=Cl(ie),le=[],oe=0;oe<ie.length/2;++oe){var m=H.getUint16(oe*2,!0);m<65535&&le.push([oe,m])}if(le.length!=q)throw"Expected ".concat(q," cells, found ").concat(le.length);var Se=[];for(oe=0;oe<le.length-1;++oe)Se[le[oe][0]]=se.subarray(le[oe][1]*ne,le[oe+1][1]*ne);return le.length>=1&&(Se[le[le.length-1][0]]=se.subarray(le[le.length-1][1]*ne)),{R:z,cells:Se}}function q6(e,a){var t,i=Zt(a.data),s=(t=i?.[7])!=null&&t[0]?za(i[7][0].data)>>>0>0?1:0:-1,c=Sh(i[5],function(f){return X6(f,s)});return{nrows:za(i[4][0].data)>>>0,data:c.reduce(function(f,p){return f[p.R]||(f[p.R]=[]),p.cells.forEach(function(g,h){if(f[p.R][h])throw new Error("Duplicate cell r=".concat(p.R," c=").concat(h));f[p.R][h]=g}),f},[])}}function K6(e,a,t){var i,s=Zt(a.data),c={s:{r:0,c:0},e:{r:0,c:0}};if(c.e.r=(za(s[6][0].data)>>>0)-1,c.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(c.e.c=(za(s[7][0].data)>>>0)-1,c.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));t["!ref"]=wt(c);var f=Zt(s[4][0].data),p=Um(e,e[Lr(f[4][0].data)][0]),g=(i=f[17])!=null&&i[0]?Um(e,e[Lr(f[17][0].data)][0]):[],h=Zt(f[3][0].data),E=0;h[1].forEach(function(A){var _=Zt(A.data),w=e[Lr(_[2][0].data)][0],N=za(w.meta[1][0].data);if(N!=6002)throw new Error("6001 unexpected reference to ".concat(N));var k=q6(e,w);k.data.forEach(function(F,z){F.forEach(function(q,B){var ie=vt({r:E+z,c:B}),se=V6(q,p,g);se&&(t[ie]=se)})}),E+=k.nrows})}function J6(e,a){var t=Zt(a.data),i={"!ref":"A1"},s=e[Lr(t[2][0].data)],c=za(s[0].meta[1][0].data);if(c!=6001)throw new Error("6000 unexpected reference to ".concat(c));return K6(e,s[0],i),i}function Q6(e,a){var t,i=Zt(a.data),s={name:(t=i[1])!=null&&t[0]?Pp(i[1][0].data):"",sheets:[]},c=Sh(i[2],Lr);return c.forEach(function(f){e[f].forEach(function(p){var g=za(p.meta[1][0].data);g==6e3&&s.sheets.push(J6(e,p))})}),s}function Z6(e,a){var t=Ch(),i=Zt(a.data),s=Sh(i[1],Lr);if(s.forEach(function(c){e[c].forEach(function(f){var p=za(f.meta[1][0].data);if(p==2){var g=Q6(e,f);g.sheets.forEach(function(h,E){kh(t,h,E==0?g.name:g.name+"_"+E,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Cp(e){var a,t,i,s,c={},f=[];if(e.FullPaths.forEach(function(g){if(g.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(g){if(g.name.match(/\.iwa$/)){var h;try{h=Hn(g.content)}catch(A){return console.log("?? "+g.content.length+" "+(A.message||A))}var E;try{E=Un(h)}catch(A){return console.log("## "+(A.message||A))}E.forEach(function(A){c[A.id]=A.messages,f.push(A.id)})}}),!f.length)throw new Error("File has no messages");var p=((s=(i=(t=(a=c?.[1])==null?void 0:a[0])==null?void 0:t.meta)==null?void 0:i[1])==null?void 0:s[0].data)&&za(c[1][0].meta[1][0].data)==1&&c[1][0];if(p||f.forEach(function(g){c[g].forEach(function(h){var E=za(h.meta[1][0].data)>>>0;if(E==1)if(!p)p=h;else throw new Error("Document has multiple roots")})}),!p)throw new Error("Cannot find Document root");return Z6(c,p)}function e8(e,a,t){var i,s,c,f;if(!((i=e[6])!=null&&i[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var p=((f=(c=e[8])==null?void 0:c[0])==null?void 0:f.data)&&za(e[8][0].data)>0||!1;if(p)throw"Math only works with normal offsets";for(var g=0,h=Cl(e[7][0].data),E=0,A=[],_=Cl(e[4][0].data),w=0,N=[],k=0;k<a.length;++k){if(a[k]==null){h.setUint16(k*2,65535,!0),_.setUint16(k*2,65535);continue}h.setUint16(k*2,E,!0),_.setUint16(k*2,w,!0);var F,z;switch(typeof a[k]){case"string":F=Ap({t:"s",v:a[k]},t),z=_p({t:"s",v:a[k]},t);break;case"number":F=Ap({t:"n",v:a[k]},t),z=_p({t:"n",v:a[k]},t);break;case"boolean":F=Ap({t:"b",v:a[k]},t),z=_p({t:"b",v:a[k]},t);break;default:throw new Error("Unsupported value "+a[k])}A.push(F),E+=F.length,N.push(z),w+=z.length,++g}for(e[2][0].data=ca(g);k<e[7][0].data.length/2;++k)h.setUint16(k*2,65535,!0),_.setUint16(k*2,65535,!0);return e[6][0].data=Us(A),e[3][0].data=Us(N),g}function t8(e,a){if(!a||!a.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=un(t["!ref"]);i.s.r=i.s.c=0;var s=!1;i.e.c>9&&(s=!0,i.e.c=9),i.e.r>49&&(s=!0,i.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(wt(i)));var c=Qd(t,{range:i,header:1}),f=["~Sh33tJ5~"];c.forEach(function(L){return L.forEach(function(K){typeof K=="string"&&f.push(K)})});var p={},g=[],h=pt.read(a.numbers,{type:"base64"});h.FileIndex.map(function(L,K){return[L,h.FullPaths[K]]}).forEach(function(L){var K=L[0],te=L[1];if(K.type==2&&K.name.match(/\.iwa/)){var he=K.content,Oe=Hn(he),Ue=Un(Oe);Ue.forEach(function(Ie){g.push(Ie.id),p[Ie.id]={deps:[],location:te,type:za(Ie.messages[0].meta[1][0].data)}})}}),g.sort(function(L,K){return L-K});var E=g.filter(function(L){return L>1}).map(function(L){return[L,ca(L)]});h.FileIndex.map(function(L,K){return[L,h.FullPaths[K]]}).forEach(function(L){var K=L[0];if(L[1],!!K.name.match(/\.iwa/)){var te=Un(Hn(K.content));te.forEach(function(he){he.messages.forEach(function(Oe){E.forEach(function(Ue){he.messages.some(function(Ie){return za(Ie.meta[1][0].data)!=11006&&U6(Ie.data,Ue[1])})&&p[Ue[0]].deps.push(he.id)})})})}});for(var A=pt.find(h,p[1].location),_=Un(Hn(A.content)),w,N=0;N<_.length;++N){var k=_[N];k.id==1&&(w=k)}var F=Lr(Zt(w.messages[0].data)[1][0].data);for(A=pt.find(h,p[F].location),_=Un(Hn(A.content)),N=0;N<_.length;++N)k=_[N],k.id==F&&(w=k);for(F=Lr(Zt(w.messages[0].data)[2][0].data),A=pt.find(h,p[F].location),_=Un(Hn(A.content)),N=0;N<_.length;++N)k=_[N],k.id==F&&(w=k);for(F=Lr(Zt(w.messages[0].data)[2][0].data),A=pt.find(h,p[F].location),_=Un(Hn(A.content)),N=0;N<_.length;++N)k=_[N],k.id==F&&(w=k);var z=Zt(w.messages[0].data);{z[6][0].data=ca(i.e.r+1),z[7][0].data=ca(i.e.c+1);var q=Lr(z[46][0].data),B=pt.find(h,p[q].location),ie=Un(Hn(B.content));{for(var se=0;se<ie.length&&ie[se].id!=q;++se);if(ie[se].id!=q)throw"Bad ColumnRowUIDMapArchive";var ne=Zt(ie[se].messages[0].data);ne[1]=[],ne[2]=[],ne[3]=[];for(var H=0;H<=i.e.c;++H){var le=[];le[1]=le[2]=[{type:0,data:ca(H+420690)}],ne[1].push({type:2,data:Nr(le)}),ne[2].push({type:0,data:ca(H)}),ne[3].push({type:0,data:ca(H)})}ne[4]=[],ne[5]=[],ne[6]=[];for(var oe=0;oe<=i.e.r;++oe)le=[],le[1]=le[2]=[{type:0,data:ca(oe+726270)}],ne[4].push({type:2,data:Nr(le)}),ne[5].push({type:0,data:ca(oe)}),ne[6].push({type:0,data:ca(oe)});ie[se].messages[0].data=Nr(ne)}B.content=bo(yo(ie)),B.size=B.content.length,delete z[46];var m=Zt(z[4][0].data);{m[7][0].data=ca(i.e.r+1);var Se=Zt(m[1][0].data),ue=Lr(Se[2][0].data);B=pt.find(h,p[ue].location),ie=Un(Hn(B.content));{if(ie[0].id!=ue)throw"Bad HeaderStorageBucket";var Pe=Zt(ie[0].messages[0].data);for(oe=0;oe<c.length;++oe){var tt=Zt(Pe[2][0].data);tt[1][0].data=ca(oe),tt[4][0].data=ca(c[oe].length),Pe[2][oe]={type:Pe[2][0].type,data:Nr(tt)}}ie[0].messages[0].data=Nr(Pe)}B.content=bo(yo(ie)),B.size=B.content.length;var ke=Lr(m[2][0].data);B=pt.find(h,p[ke].location),ie=Un(Hn(B.content));{if(ie[0].id!=ke)throw"Bad HeaderStorageBucket";for(Pe=Zt(ie[0].messages[0].data),H=0;H<=i.e.c;++H)tt=Zt(Pe[2][0].data),tt[1][0].data=ca(H),tt[4][0].data=ca(i.e.r+1),Pe[2][H]={type:Pe[2][0].type,data:Nr(tt)};ie[0].messages[0].data=Nr(Pe)}B.content=bo(yo(ie)),B.size=B.content.length;var de=Lr(m[4][0].data);(function(){for(var L=pt.find(h,p[de].location),K=Un(Hn(L.content)),te,he=0;he<K.length;++he){var Oe=K[he];Oe.id==de&&(te=Oe)}var Ue=Zt(te.messages[0].data);{Ue[3]=[];var Ie=[];f.forEach(function(Z,aa){Ie[1]=[{type:0,data:ca(aa)}],Ie[2]=[{type:0,data:ca(1)}],Ie[3]=[{type:2,data:z6(Z)}],Ue[3].push({type:2,data:Nr(Ie)})})}te.messages[0].data=Nr(Ue);var He=yo(K),gt=bo(He);L.content=gt,L.size=L.content.length})();var _e=Zt(m[3][0].data);{var Ze=_e[1][0];delete _e[2];var fe=Zt(Ze.data);{var Je=Lr(fe[2][0].data);(function(){for(var L=pt.find(h,p[Je].location),K=Un(Hn(L.content)),te,he=0;he<K.length;++he){var Oe=K[he];Oe.id==Je&&(te=Oe)}var Ue=Zt(te.messages[0].data);{delete Ue[6],delete _e[7];var Ie=new Uint8Array(Ue[5][0].data);Ue[5]=[];for(var He=0,gt=0;gt<=i.e.r;++gt){var Z=Zt(Ie);He+=e8(Z,c[gt],f),Z[1][0].data=ca(gt),Ue[5].push({data:Nr(Z),type:2})}Ue[1]=[{type:0,data:ca(i.e.c+1)}],Ue[2]=[{type:0,data:ca(i.e.r+1)}],Ue[3]=[{type:0,data:ca(He)}],Ue[4]=[{type:0,data:ca(i.e.r+1)}]}te.messages[0].data=Nr(Ue);var aa=yo(K),St=bo(aa);L.content=St,L.size=L.content.length})()}Ze.data=Nr(fe)}m[3][0].data=Nr(_e)}z[4][0].data=Nr(m)}w.messages[0].data=Nr(z);var ee=yo(_),O=bo(ee);return A.content=O,A.size=A.content.length,h}function Xy(e){return function(t){for(var i=0;i!=e.length;++i){var s=e[i];t[s[0]]===void 0&&(t[s[0]]=s[1]),s[2]==="n"&&(t[s[0]]=Number(t[s[0]]))}}}function Eh(e){Xy([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Th(e){Xy([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function a8(e){return Bt.WS.indexOf(e)>-1?"sheet":e==Bt.CS?"chart":e==Bt.DS?"dialog":e==Bt.MS?"macro":e&&e.length?e:"sheet"}function r8(e,a){if(!e)return 0;try{e=a.map(function(i){return i.id||(i.id=i.strRelID),[i.name,e["!id"][i.id].Target,a8(e["!id"][i.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function n8(e,a,t,i,s,c,f,p,g,h,E,A){try{c[i]=zc(_n(e,t,!0),a);var _=nr(e,a),w;switch(p){case"sheet":w=Cw(_,a,s,g,c[i],h,E,A);break;case"chart":if(w=kw(_,a,s,g,c[i],h,E,A),!w||!w["!drawel"])break;var N=Bc(w["!drawel"].Target,a),k=Jc(N),F=p4(_n(e,N,!0),zc(_n(e,k,!0),N)),z=Bc(F,N),q=Jc(z);w=ew(_n(e,z,!0),z,g,zc(_n(e,q,!0),z),h,w);break;case"macro":w=ww(_,a,s,g,c[i],h,E,A);break;case"dialog":w=Rw(_,a,s,g,c[i],h,E,A);break;default:throw new Error("Unrecognized sheet type "+p)}f[i]=w;var B=[];c&&c[i]&&Ua(c[i]).forEach(function(ie){var se="";if(c[i][ie].Type==Bt.CMNT){se=Bc(c[i][ie].Target,a);var ne=Dw(nr(e,se,!0),se,g);if(!ne||!ne.length)return;Cm(w,ne,!1)}c[i][ie].Type==Bt.TCMNT&&(se=Bc(c[i][ie].Target,a),B=B.concat(g4(nr(e,se,!0),g)))}),B&&B.length&&Cm(w,B,!0,g.people||[])}catch(ie){if(g.WTF)throw ie}}function Pn(e){return e.charAt(0)=="/"?e.slice(1):e}function i8(e,a){if(Fo(),a=a||{},Eh(a),$n(e,"META-INF/manifest.xml")||$n(e,"objectdata.xml"))return Mm(e,a);if($n(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Cp<"u"){if(e.FileIndex)return Cp(e);var t=pt.utils.cfb_new();return Vx(e).forEach(function(tt){Dt(t,tt,xS(e,tt))}),Cp(t)}throw new Error("Unsupported NUMBERS file")}if(!$n(e,"[Content_Types].xml"))throw $n(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):$n(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var i=Vx(e),s=cE(_n(e,"[Content_Types].xml")),c=!1,f,p;if(s.workbooks.length===0&&(p="xl/workbook.xml",nr(e,p,!0)&&s.workbooks.push(p)),s.workbooks.length===0){if(p="xl/workbook.bin",!nr(e,p,!0))throw new Error("Could not find workbook");s.workbooks.push(p),c=!0}s.workbooks[0].slice(-3)=="bin"&&(c=!0);var g={},h={};if(!a.bookSheets&&!a.bookProps){if(Uc=[],s.sst)try{Uc=jw(nr(e,Pn(s.sst)),s.sst,a)}catch(tt){if(a.WTF)throw tt}a.cellStyles&&s.themes.length&&(g=Fw(_n(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],a)),s.style&&(h=Nw(nr(e,Pn(s.style)),s.style,g,a))}s.links.map(function(tt){try{var ke=zc(_n(e,Jc(Pn(tt))),tt);return Iw(nr(e,Pn(tt)),ke,tt,a)}catch{}});var E=_w(nr(e,Pn(s.workbooks[0])),s.workbooks[0],a),A={},_="";s.coreprops.length&&(_=nr(e,Pn(s.coreprops[0]),!0),_&&(A=Bv(_)),s.extprops.length!==0&&(_=nr(e,Pn(s.extprops[0]),!0),_&&xE(_,A,a)));var w={};(!a.bookSheets||a.bookProps)&&s.custprops.length!==0&&(_=_n(e,Pn(s.custprops[0]),!0),_&&(w=vE(_,a)));var N={};if((a.bookSheets||a.bookProps)&&(E.Sheets?f=E.Sheets.map(function(ke){return ke.name}):A.Worksheets&&A.SheetNames.length>0&&(f=A.SheetNames),a.bookProps&&(N.Props=A,N.Custprops=w),a.bookSheets&&typeof f<"u"&&(N.SheetNames=f),a.bookSheets?N.SheetNames:a.bookProps))return N;f={};var k={};a.bookDeps&&s.calcchain&&(k=Ow(nr(e,Pn(s.calcchain)),s.calcchain));var F=0,z={},q,B;{var ie=E.Sheets;A.Worksheets=ie.length,A.SheetNames=[];for(var se=0;se!=ie.length;++se)A.SheetNames[se]=ie[se].name}var ne=c?"bin":"xml",H=s.workbooks[0].lastIndexOf("/"),le=(s.workbooks[0].slice(0,H+1)+"_rels/"+s.workbooks[0].slice(H+1)+".rels").replace(/^\//,"");$n(e,le)||(le="xl/_rels/workbook."+ne+".rels");var oe=zc(_n(e,le,!0),le.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(a.xlmeta=Bw(nr(e,Pn(s.metadata[0])),s.metadata[0],a)),(s.people||[]).length>=1&&(a.people=m4(nr(e,Pn(s.people[0])),a)),oe&&(oe=r8(oe,E.Sheets));var m=nr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(F=0;F!=A.Worksheets;++F){var Se="sheet";if(oe&&oe[F]?(q="xl/"+oe[F][1].replace(/[\/]?xl\//,""),$n(e,q)||(q=oe[F][1]),$n(e,q)||(q=le.replace(/_rels\/.*$/,"")+oe[F][1]),Se=oe[F][2]):(q="xl/worksheets/sheet"+(F+1-m)+"."+ne,q=q.replace(/sheet0\./,"sheet.")),B=q.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),a&&a.sheets!=null)switch(typeof a.sheets){case"number":if(F!=a.sheets)continue e;break;case"string":if(A.SheetNames[F].toLowerCase()!=a.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(a.sheets)){for(var ue=!1,Pe=0;Pe!=a.sheets.length;++Pe)typeof a.sheets[Pe]=="number"&&a.sheets[Pe]==F&&(ue=1),typeof a.sheets[Pe]=="string"&&a.sheets[Pe].toLowerCase()==A.SheetNames[F].toLowerCase()&&(ue=1);if(!ue)continue e}}n8(e,q,B,A.SheetNames[F],F,z,f,Se,a,E,g,h)}return N={Directory:s,Workbook:E,Props:A,Custprops:w,Deps:k,Sheets:f,SheetNames:A.SheetNames,Strings:Uc,Styles:h,Themes:g,SSF:wa(mt)},a&&a.bookFiles&&(e.files?(N.keys=i,N.files=e.files):(N.keys=[],N.files={},e.FullPaths.forEach(function(tt,ke){tt=tt.replace(/^Root Entry[\/]/,""),N.keys.push(tt),N.files[tt]=e.FileIndex[ke]}))),a&&a.bookVBA&&(s.vba.length>0?N.vbaraw=nr(e,Pn(s.vba[0]),!0):s.defaults&&s.defaults.bin===_4&&(N.vbaraw=nr(e,"xl/vbaProject.bin",!0))),N}function s8(e,a){var t=a||{},i="Workbook",s=pt.find(e,i);try{if(i="/!DataSpaces/Version",s=pt.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(BA(s.content),i="/!DataSpaces/DataSpaceMap",s=pt.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);var c=LA(s.content);if(c.length!==1||c[0].comps.length!==1||c[0].comps[0].t!==0||c[0].name!=="StrongEncryptionDataSpace"||c[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=pt.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);var f=PA(s.content);if(f.length!=1||f[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=pt.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);UA(s.content)}catch{}if(i="/EncryptionInfo",s=pt.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);var p=HA(s.content);if(i="/EncryptedPackage",s=pt.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(p[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(p[1],s.content,t.password||"",t);if(p[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(p[1],s.content,t.password||"",t);throw new Error("File is password-protected")}function l8(e,a){return a.bookType=="ods"?Vy(e,a):a.bookType=="numbers"?t8(e,a):a.bookType=="xlsb"?o8(e,a):c8(e,a)}function o8(e,a){Eo=1024,e&&!e.SSF&&(e.SSF=wa(mt)),e&&e.SSF&&(Fo(),ef(e.SSF),a.revssf=af(e.SSF),a.revssf[e.SSF[65535]]=0,a.ssf=e.SSF),a.rels={},a.wbrels={},a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,Hc?a.revStrings=new Map:(a.revStrings={},a.revStrings.foo=[],delete a.revStrings.foo);var t=a.bookType=="xlsb"?"bin":"xml",i=Sy.indexOf(a.bookType)>-1,s=oh();Th(a=a||{});var c=Xp(),f="",p=0;if(a.cellXfs=[],Gs(a.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),f="docProps/core.xml",Dt(c,f,Mv(e.Props,a)),s.coreprops.push(f),da(a.rels,2,f,Bt.CORE_PROPS),f="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var g=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&g.push(e.SheetNames[h]);e.Props.SheetNames=g}for(e.Props.Worksheets=e.Props.SheetNames.length,Dt(c,f,zv(e.Props)),s.extprops.push(f),da(a.rels,3,f,Bt.EXT_PROPS),e.Custprops!==e.Props&&Ua(e.Custprops||{}).length>0&&(f="docProps/custom.xml",Dt(c,f,Uv(e.Custprops)),s.custprops.push(f),da(a.rels,4,f,Bt.CUST_PROPS)),p=1;p<=e.SheetNames.length;++p){var E={"!id":{}},A=e.Sheets[e.SheetNames[p-1]],_=(A||{})["!type"]||"sheet";if(f="xl/worksheets/sheet"+p+"."+t,Dt(c,f,Lw(p-1,f,a,e,E)),s.sheets.push(f),da(a.wbrels,-1,"worksheets/sheet"+p+"."+t,Bt.WS[0]),A){var w=A["!comments"],N=!1,k="";w&&w.length>0&&(k="xl/comments"+p+"."+t,Dt(c,k,Uw(w,k)),s.comments.push(k),da(E,-1,"../comments"+p+"."+t,Bt.CMNT),N=!0),A["!legacy"]&&N&&Dt(c,"xl/drawings/vmlDrawing"+p+".vml",yy(p,A["!comments"])),delete A["!comments"],delete A["!legacy"]}E["!id"].rId1&&Dt(c,Jc(f),Ao(E))}return a.Strings!=null&&a.Strings.length>0&&(f="xl/sharedStrings."+t,Dt(c,f,zw(a.Strings,f,a)),s.strs.push(f),da(a.wbrels,-1,"sharedStrings."+t,Bt.SST)),f="xl/workbook."+t,Dt(c,f,Mw(e,f)),s.workbooks.push(f),da(a.rels,1,f,Bt.WB),f="xl/theme/theme1.xml",Dt(c,f,hh(e.Themes,a)),s.themes.push(f),da(a.wbrels,-1,"theme/theme1.xml",Bt.THEME),f="xl/styles."+t,Dt(c,f,Pw(e,f,a)),s.styles.push(f),da(a.wbrels,-1,"styles."+t,Bt.STY),e.vbaraw&&i&&(f="xl/vbaProject.bin",Dt(c,f,e.vbaraw),s.vba.push(f),da(a.wbrels,-1,"vbaProject.bin",Bt.VBA)),f="xl/metadata."+t,Dt(c,f,Hw(f)),s.metadata.push(f),da(a.wbrels,-1,"metadata."+t,Bt.XLMETA),Dt(c,"[Content_Types].xml",Ov(s,a)),Dt(c,"_rels/.rels",Ao(a.rels)),Dt(c,"xl/_rels/workbook."+t+".rels",Ao(a.wbrels)),delete a.revssf,delete a.ssf,c}function c8(e,a){Eo=1024,e&&!e.SSF&&(e.SSF=wa(mt)),e&&e.SSF&&(Fo(),ef(e.SSF),a.revssf=af(e.SSF),a.revssf[e.SSF[65535]]=0,a.ssf=e.SSF),a.rels={},a.wbrels={},a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,Hc?a.revStrings=new Map:(a.revStrings={},a.revStrings.foo=[],delete a.revStrings.foo);var t="xml",i=Sy.indexOf(a.bookType)>-1,s=oh();Th(a=a||{});var c=Xp(),f="",p=0;if(a.cellXfs=[],Gs(a.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),f="docProps/core.xml",Dt(c,f,Mv(e.Props,a)),s.coreprops.push(f),da(a.rels,2,f,Bt.CORE_PROPS),f="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var g=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&g.push(e.SheetNames[h]);e.Props.SheetNames=g}e.Props.Worksheets=e.Props.SheetNames.length,Dt(c,f,zv(e.Props)),s.extprops.push(f),da(a.rels,3,f,Bt.EXT_PROPS),e.Custprops!==e.Props&&Ua(e.Custprops||{}).length>0&&(f="docProps/custom.xml",Dt(c,f,Uv(e.Custprops)),s.custprops.push(f),da(a.rels,4,f,Bt.CUST_PROPS));var E=["SheetJ5"];for(a.tcid=0,p=1;p<=e.SheetNames.length;++p){var A={"!id":{}},_=e.Sheets[e.SheetNames[p-1]],w=(_||{})["!type"]||"sheet";if(f="xl/worksheets/sheet"+p+"."+t,Dt(c,f,jy(p-1,a,e,A)),s.sheets.push(f),da(a.wbrels,-1,"worksheets/sheet"+p+"."+t,Bt.WS[0]),_){var N=_["!comments"],k=!1,F="";if(N&&N.length>0){var z=!1;N.forEach(function(q){q[1].forEach(function(B){B.T==!0&&(z=!0)})}),z&&(F="xl/threadedComments/threadedComment"+p+"."+t,Dt(c,F,x4(N,E,a)),s.threadedcomments.push(F),da(A,-1,"../threadedComments/threadedComment"+p+"."+t,Bt.TCMNT)),F="xl/comments"+p+"."+t,Dt(c,F,by(N)),s.comments.push(F),da(A,-1,"../comments"+p+"."+t,Bt.CMNT),k=!0}_["!legacy"]&&k&&Dt(c,"xl/drawings/vmlDrawing"+p+".vml",yy(p,_["!comments"])),delete _["!comments"],delete _["!legacy"]}A["!id"].rId1&&Dt(c,Jc(f),Ao(A))}return a.Strings!=null&&a.Strings.length>0&&(f="xl/sharedStrings."+t,Dt(c,f,ly(a.Strings,a)),s.strs.push(f),da(a.wbrels,-1,"sharedStrings."+t,Bt.SST)),f="xl/workbook."+t,Dt(c,f,My(e)),s.workbooks.push(f),da(a.rels,1,f,Bt.WB),f="xl/theme/theme1.xml",Dt(c,f,hh(e.Themes,a)),s.themes.push(f),da(a.wbrels,-1,"theme/theme1.xml",Bt.THEME),f="xl/styles."+t,Dt(c,f,gy(e,a)),s.styles.push(f),da(a.wbrels,-1,"styles."+t,Bt.STY),e.vbaraw&&i&&(f="xl/vbaProject.bin",Dt(c,f,e.vbaraw),s.vba.push(f),da(a.wbrels,-1,"vbaProject.bin",Bt.VBA)),f="xl/metadata."+t,Dt(c,f,vy()),s.metadata.push(f),da(a.wbrels,-1,"metadata."+t,Bt.XLMETA),E.length>1&&(f="xl/persons/person.xml",Dt(c,f,v4(E)),s.people.push(f),da(a.wbrels,-1,"persons/person.xml",Bt.PEOPLE)),Dt(c,"[Content_Types].xml",Ov(s,a)),Dt(c,"_rels/.rels",Ao(a.rels)),Dt(c,"xl/_rels/workbook."+t+".rels",Ao(a.wbrels)),delete a.revssf,delete a.ssf,c}function Ah(e,a){var t="";switch((a||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Cn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(a&&a.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function d8(e,a){return pt.find(e,"EncryptedPackage")?s8(e,a):Uy(e,a)}function f8(e,a){var t,i=e,s=a||{};return s.type||(s.type=It&&Buffer.isBuffer(e)?"buffer":"base64"),t=cv(i,s),i8(t,s)}function qy(e,a){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Mp(e.slice(t),a);default:break e}return wo.to_workbook(e,a)}function u8(e,a){var t="",i=Ah(e,a);switch(a.type){case"base64":t=Cn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=El(e);break;default:throw new Error("Unrecognized type "+a.type)}return i[0]==239&&i[1]==187&&i[2]==191&&(t=ga(t)),a.type="binary",qy(t,a)}function p8(e,a){var t=e;return a.type=="base64"&&(t=Cn(t)),t=Yc.utils.decode(1200,t.slice(2),"str"),a.type="binary",qy(t,a)}function h8(e){return e.match(/[^\x00-\x7F]/)?Ai(e):e}function kp(e,a,t,i){return i?(t.type="string",wo.to_workbook(e,t)):wo.to_workbook(a,t)}function Jd(e,a){$p();var t=a||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Jd(new Uint8Array(e),(t=wa(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var i=e,s=[0,0,0,0],c=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Co={},t.dateNF&&(Co.dateNF=t.dateNF),t.type||(t.type=It&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=It?"buffer":"binary",i=oS(e),typeof Uint8Array<"u"&&!It&&(t.type="array")),t.type=="string"&&(c=!0,t.type="binary",t.codepage=65001,i=h8(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var f=new ArrayBuffer(3),p=new Uint8Array(f);if(p.foo="bar",!p.foo)return t=wa(t),t.type="array",Jd(Gp(i),t)}switch((s=Ah(i,t))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return d8(pt.read(i,t),t);break;case 9:if(s[1]<=8)return Uy(i,t);break;case 60:return Mp(i,t);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return yA(i,t);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return iy.to_workbook(i,t);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?f8(i,t):kp(e,i,t,c);case 239:return s[3]===60?Mp(i,t):kp(e,i,t,c);case 255:if(s[1]===254)return p8(i,t);if(s[1]===0&&s[2]===2&&s[3]===0)return yl.to_workbook(i,t);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return yl.to_workbook(i,t);break;case 3:case 131:case 139:case 140:return Bp.to_workbook(i,t);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return uy.to_workbook(i,t);break;case 10:case 13:case 32:return u8(i,t);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return vA.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Bp.to_workbook(i,t):kp(e,i,t,c)}function Ky(e,a){switch(a.type){case"base64":case"binary":break;case"buffer":case"array":a.type="";break;case"file":return i0(a.file,pt.write(e,{type:It?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+a.bookType+"' files");default:throw new Error("Unrecognized type "+a.type)}return pt.write(e,a)}function g8(e,a){var t=wa(a||{}),i=l8(e,t);return x8(i,t)}function x8(e,a){var t={},i=It?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(a.compression&&(t.compression="DEFLATE"),a.password)t.type=i;else switch(a.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+a.bookType+"' files");case"buffer":case"file":t.type=i;break;default:throw new Error("Unrecognized type "+a.type)}var s=e.FullPaths?pt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!a.compression}):e.generate(t);if(typeof Deno<"u"&&typeof s=="string"){if(a.type=="binary"||a.type=="base64")return s;s=new Uint8Array(Zd(s))}return a.password&&typeof encrypt_agile<"u"?Ky(encrypt_agile(s,a.password),a):a.type==="file"?i0(a.file,s):a.type=="string"?ga(s):s}function m8(e,a){var t=a||{},i=h6(e,t);return Ky(i,t)}function Ti(e,a,t){t||(t="");var i=t+e;switch(a.type){case"base64":return Wc(Ai(i));case"binary":return Ai(i);case"string":return e;case"file":return i0(a.file,i,"utf8");case"buffer":return It?ts(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):Ti(i,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+a.type)}function v8(e,a){switch(a.type){case"base64":return Wc(e);case"binary":return e;case"string":return e;case"file":return i0(a.file,e,"binary");case"buffer":return It?ts(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+a.type)}function Ld(e,a){switch(a.type){case"string":case"base64":case"binary":for(var t="",i=0;i<e.length;++i)t+=String.fromCharCode(e[i]);return a.type=="base64"?Wc(t):a.type=="string"?ga(t):t;case"file":return i0(a.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+a.type)}}function Jy(e,a){$p(),dw(e);var t=wa(a||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var i=Jy(e,t);return t.type="array",Zd(i)}var s=0;if(t.sheet&&(typeof t.sheet=="number"?s=t.sheet:s=e.SheetNames.indexOf(t.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Ti(l6(e,t),t);case"slk":case"sylk":return Ti(ny.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"htm":case"html":return Ti($y(e.Sheets[e.SheetNames[s]],t),t);case"txt":return v8(Qy(e.Sheets[e.SheetNames[s]],t),t);case"csv":return Ti(_h(e.Sheets[e.SheetNames[s]],t),t,"\uFEFF");case"dif":return Ti(iy.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"dbf":return Ld(Bp.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"prn":return Ti(wo.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"rtf":return Ti(uy.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"eth":return Ti(sy.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"fods":return Ti(Vy(e,t),t);case"wk1":return Ld(yl.sheet_to_wk1(e.Sheets[e.SheetNames[s]],t),t);case"wk3":return Ld(yl.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Ld(Hy(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),m8(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return g8(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function y8(e,a,t,i,s,c,f,p){var g=Ka(t),h=p.defval,E=p.raw||!Object.prototype.hasOwnProperty.call(p,"raw"),A=!0,_=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:t,enumerable:!1})}catch{_.__rowNum__=t}else _.__rowNum__=t;if(!f||e[t])for(var w=a.s.c;w<=a.e.c;++w){var N=f?e[t][w]:e[i[w]+g];if(N===void 0||N.t===void 0){if(h===void 0)continue;c[w]!=null&&(_[c[w]]=h);continue}var k=N.v;switch(N.t){case"z":if(k==null)break;continue;case"e":k=k==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+N.t)}if(c[w]!=null){if(k==null)if(N.t=="e"&&k===null)_[c[w]]=null;else if(h!==void 0)_[c[w]]=h;else if(E&&k===null)_[c[w]]=null;else continue;else _[c[w]]=E&&(N.t!=="n"||N.t==="n"&&p.rawNumbers!==!1)?k:es(N,k,p);k!=null&&(A=!1)}}return{row:_,isempty:A}}function Qd(e,a){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},i=0,s=1,c=[],f=0,p="",g={s:{r:0,c:0},e:{r:0,c:0}},h=a||{},E=h.range!=null?h.range:e["!ref"];switch(h.header===1?i=1:h.header==="A"?i=2:Array.isArray(h.header)?i=3:h.header==null&&(i=0),typeof E){case"string":g=Kt(E);break;case"number":g=Kt(e["!ref"]),g.s.r=E;break;default:g=E}i>0&&(s=0);var A=Ka(g.s.r),_=[],w=[],N=0,k=0,F=Array.isArray(e),z=g.s.r,q=0,B={};F&&!e[z]&&(e[z]=[]);var ie=h.skipHidden&&e["!cols"]||[],se=h.skipHidden&&e["!rows"]||[];for(q=g.s.c;q<=g.e.c;++q)if(!(ie[q]||{}).hidden)switch(_[q]=Oa(q),t=F?e[z][q]:e[_[q]+A],i){case 1:c[q]=q-g.s.c;break;case 2:c[q]=_[q];break;case 3:c[q]=h.header[q-g.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),p=f=es(t,null,h),k=B[f]||0,!k)B[f]=1;else{do p=f+"_"+k++;while(B[p]);B[f]=k,B[p]=1}c[q]=p}for(z=g.s.r+s;z<=g.e.r;++z)if(!(se[z]||{}).hidden){var ne=y8(e,g,z,_,i,c,F,h);(ne.isempty===!1||(i===1?h.blankrows!==!1:h.blankrows))&&(w[N++]=ne.row)}return w.length=N,w}var Hm=/"/g;function b8(e,a,t,i,s,c,f,p){for(var g=!0,h=[],E="",A=Ka(t),_=a.s.c;_<=a.e.c;++_)if(i[_]){var w=p.dense?(e[t]||[])[_]:e[i[_]+A];if(w==null)E="";else if(w.v!=null){g=!1,E=""+(p.rawNumbers&&w.t=="n"?w.v:es(w,null,p));for(var N=0,k=0;N!==E.length;++N)if((k=E.charCodeAt(N))===s||k===c||k===34||p.forceQuotes){E='"'+E.replace(Hm,'""')+'"';break}E=="ID"&&(E='"ID"')}else w.f!=null&&!w.F?(g=!1,E="="+w.f,E.indexOf(",")>=0&&(E='"'+E.replace(Hm,'""')+'"')):E="";h.push(E)}return p.blankrows===!1&&g?null:h.join(f)}function _h(e,a){var t=[],i=a??{};if(e==null||e["!ref"]==null)return"";var s=Kt(e["!ref"]),c=i.FS!==void 0?i.FS:",",f=c.charCodeAt(0),p=i.RS!==void 0?i.RS:`
`,g=p.charCodeAt(0),h=new RegExp((c=="|"?"\\|":c)+"+$"),E="",A=[];i.dense=Array.isArray(e);for(var _=i.skipHidden&&e["!cols"]||[],w=i.skipHidden&&e["!rows"]||[],N=s.s.c;N<=s.e.c;++N)(_[N]||{}).hidden||(A[N]=Oa(N));for(var k=0,F=s.s.r;F<=s.e.r;++F)(w[F]||{}).hidden||(E=b8(e,s,F,A,f,g,c,i),E!=null&&(i.strip&&(E=E.replace(h,"")),(E||i.blankrows!==!1)&&t.push((k++?p:"")+E)));return delete i.dense,t.join("")}function Qy(e,a){a||(a={}),a.FS="	",a.RS=`
`;var t=_h(e,a);return t}function S8(e){var a="",t,i="";if(e==null||e["!ref"]==null)return[];var s=Kt(e["!ref"]),c="",f=[],p,g=[],h=Array.isArray(e);for(p=s.s.c;p<=s.e.c;++p)f[p]=Oa(p);for(var E=s.s.r;E<=s.e.r;++E)for(c=Ka(E),p=s.s.c;p<=s.e.c;++p)if(a=f[p]+c,t=h?(e[E]||[])[p]:e[a],i="",t!==void 0){if(t.F!=null){if(a=t.F,!t.f)continue;i=t.f,a.indexOf(":")==-1&&(a=a+":"+a)}if(t.f!=null)i=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)i=""+t.v;else if(t.t=="b")i=t.v?"TRUE":"FALSE";else if(t.w!==void 0)i="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?i="'"+t.v:i=""+t.v}}g[g.length]=a+"="+i}return g}function Zy(e,a,t){var i=t||{},s=+!i.skipHeader,c=e||{},f=0,p=0;if(c&&i.origin!=null)if(typeof i.origin=="number")f=i.origin;else{var g=typeof i.origin=="string"?Ia(i.origin):i.origin;f=g.r,p=g.c}var h,E={s:{c:0,r:0},e:{c:p,r:f+a.length-1+s}};if(c["!ref"]){var A=Kt(c["!ref"]);E.e.c=Math.max(E.e.c,A.e.c),E.e.r=Math.max(E.e.r,A.e.r),f==-1&&(f=A.e.r+1,E.e.r=f+a.length-1+s)}else f==-1&&(f=0,E.e.r=a.length-1+s);var _=i.header||[],w=0;a.forEach(function(k,F){Ua(k).forEach(function(z){(w=_.indexOf(z))==-1&&(_[w=_.length]=z);var q=k[z],B="z",ie="",se=vt({c:p+w,r:f+F+s});h=n0(c,se),q&&typeof q=="object"&&!(q instanceof Date)?c[se]=q:(typeof q=="number"?B="n":typeof q=="boolean"?B="b":typeof q=="string"?B="s":q instanceof Date?(B="d",i.cellDates||(B="n",q=pr(q)),ie=i.dateNF||mt[14]):q===null&&i.nullError&&(B="e",q=0),h?(h.t=B,h.v=q,delete h.w,delete h.R,ie&&(h.z=ie)):c[se]=h={t:B,v:q},ie&&(h.z=ie))})}),E.e.c=Math.max(E.e.c,p+_.length-1);var N=Ka(f);if(s)for(w=0;w<_.length;++w)c[Oa(w+p)+N]={t:"s",v:_[w]};return c["!ref"]=wt(E),c}function E8(e,a){return Zy(null,e,a)}function n0(e,a,t){if(typeof a=="string"){if(Array.isArray(e)){var i=Ia(a);return e[i.r]||(e[i.r]=[]),e[i.r][i.c]||(e[i.r][i.c]={t:"z"})}return e[a]||(e[a]={t:"z"})}return typeof a!="number"?n0(e,vt(a)):n0(e,vt({r:a,c:t||0}))}function T8(e,a){if(typeof a=="number"){if(a>=0&&e.SheetNames.length>a)return a;throw new Error("Cannot find sheet # "+a)}else if(typeof a=="string"){var t=e.SheetNames.indexOf(a);if(t>-1)return t;throw new Error("Cannot find sheet name |"+a+"|")}else throw new Error("Cannot find sheet |"+a+"|")}function Ch(){return{SheetNames:[],Sheets:{}}}function kh(e,a,t,i){var s=1;if(!t)for(;s<=65535&&e.SheetNames.indexOf(t="Sheet"+s)!=-1;++s,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&e.SheetNames.indexOf(t)>=0){var c=t.match(/(^.*?)(\d+)$/);s=c&&+c[2]||0;var f=c&&c[1]||t;for(++s;s<=65535&&e.SheetNames.indexOf(t=f+s)!=-1;++s);}if(By(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=a,t}function A8(e,a,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var i=T8(e,a);switch(e.Workbook.Sheets[i]||(e.Workbook.Sheets[i]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[i].Hidden=t}function _8(e,a){return e.z=a,e}function eb(e,a,t){return a?(e.l={Target:a},t&&(e.l.Tooltip=t)):delete e.l,e}function C8(e,a,t){return eb(e,"#"+a,t)}function k8(e,a,t){e.c||(e.c=[]),e.c.push({t:a,a:t||"SheetJS"})}function w8(e,a,t,i){for(var s=typeof a!="string"?a:Kt(a),c=typeof a=="string"?a:wt(a),f=s.s.r;f<=s.e.r;++f)for(var p=s.s.c;p<=s.e.c;++p){var g=n0(e,f,p);g.t="n",g.F=c,delete g.v,f==s.s.r&&p==s.s.c&&(g.f=t,i&&(g.D=!0))}return e}var va={encode_col:Oa,encode_row:Ka,encode_cell:vt,encode_range:wt,decode_col:ah,decode_row:th,split_cell:zS,decode_cell:Ia,decode_range:un,format_cell:es,sheet_add_aoa:kv,sheet_add_json:Zy,sheet_add_dom:Gy,aoa_to_sheet:jo,json_to_sheet:E8,table_to_sheet:Yy,table_to_book:B6,sheet_to_csv:_h,sheet_to_txt:Qy,sheet_to_json:Qd,sheet_to_html:$y,sheet_to_formulae:S8,sheet_to_row_object_array:Qd,sheet_get_cell:n0,book_new:Ch,book_append_sheet:kh,book_set_sheet_visibility:A8,cell_set_number_format:_8,cell_set_hyperlink:eb,cell_set_internal_link:C8,cell_add_comment:k8,sheet_set_array_formula:w8,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const $m={SDN_BHD:{name:"Sdn Bhd (Private Limited)",standard:"MPERS",fullStandard:"Malaysian Private Entities Reporting Standard",taxInfo:"17% (RM500k) / 24% (>RM500k)",calcTax:e=>e<=0?0:e<=5e5?Math.round(e*.17):Math.round(5e5*.17+(e-5e5)*.24)},ENTERPRISE:{name:"Enterprise (Sole Prop/Partnership)",standard:"MPERS-Micro",fullStandard:"MPERS for Micro Entities",taxInfo:"Personal Tax Rates (0-28%)",calcTax:e=>{if(e<=0)return 0;let a=0,t=e;const i=[[5e3,0],[15e3,.01],[15e3,.03],[15e3,.06],[2e4,.11],[3e4,.19],[15e4,.25],[15e4,.26],[1/0,.28]];for(const[s,c]of i){if(t<=0)break;const f=Math.min(t,s);a+=f*c,t-=s}return Math.round(a)}},BERHAD:{name:"Berhad (Public Listed)",standard:"MFRS",fullStandard:"Malaysian Financial Reporting Standards (IFRS)",taxInfo:"24% Flat Rate",calcTax:e=>e<=0?0:Math.round(e*.24)}},Gm={1e3:{name:"Property, Plant & Equipment",type:"nca",fsId:"PPE"},1010:{name:"Land & Buildings",type:"nca",fsId:"PPE",subAccount:!0},1020:{name:"Plant & Machinery",type:"nca",fsId:"PPE",subAccount:!0},1030:{name:"Motor Vehicles",type:"nca",fsId:"PPE",subAccount:!0},1040:{name:"Office Equipment",type:"nca",fsId:"PPE",subAccount:!0},1050:{name:"Computer Equipment",type:"nca",fsId:"PPE",subAccount:!0},1060:{name:"Furniture & Fittings",type:"nca",fsId:"PPE",subAccount:!0},1070:{name:"Renovation",type:"nca",fsId:"PPE",subAccount:!0},1100:{name:"Accumulated Depreciation",type:"nca_contra",fsId:"ACC_DEP"},1110:{name:"Acc Dep - Land & Buildings",type:"nca_contra",fsId:"ACC_DEP",subAccount:!0},1120:{name:"Acc Dep - Plant & Machinery",type:"nca_contra",fsId:"ACC_DEP",subAccount:!0},1130:{name:"Acc Dep - Motor Vehicles",type:"nca_contra",fsId:"ACC_DEP",subAccount:!0},1140:{name:"Acc Dep - Office Equipment",type:"nca_contra",fsId:"ACC_DEP",subAccount:!0},1150:{name:"Acc Dep - Computer Equipment",type:"nca_contra",fsId:"ACC_DEP",subAccount:!0},1160:{name:"Acc Dep - Furniture & Fittings",type:"nca_contra",fsId:"ACC_DEP",subAccount:!0},1170:{name:"Acc Dep - Renovation",type:"nca_contra",fsId:"ACC_DEP",subAccount:!0},1200:{name:"Intangible Assets",type:"nca",fsId:"INTANGIBLES"},1300:{name:"Investments",type:"nca",fsId:"INVESTMENTS"},1500:{name:"Inventory",type:"ca",fsId:"INVENTORY"},1510:{name:"Raw Materials",type:"ca",fsId:"INVENTORY",subAccount:!0},1520:{name:"Work in Progress",type:"ca",fsId:"INVENTORY",subAccount:!0},1530:{name:"Finished Goods",type:"ca",fsId:"INVENTORY",subAccount:!0},1600:{name:"Trade Receivables",type:"ca",fsId:"TRADE_RECEIVABLES"},1610:{name:"Trade Debtors Control",type:"ca",fsId:"TRADE_RECEIVABLES",subAccount:!0},1620:{name:"Allowance for Doubtful Debts",type:"ca_contra",fsId:"TRADE_RECEIVABLES",subAccount:!0},1700:{name:"Other Receivables",type:"ca",fsId:"OTHER_RECEIVABLES"},1710:{name:"Deposits",type:"ca",fsId:"OTHER_RECEIVABLES",subAccount:!0},1720:{name:"Prepayments",type:"ca",fsId:"OTHER_RECEIVABLES",subAccount:!0},1730:{name:"GST Input Tax",type:"ca",fsId:"OTHER_RECEIVABLES",subAccount:!0},1740:{name:"Staff Advances",type:"ca",fsId:"OTHER_RECEIVABLES",subAccount:!0},1800:{name:"Tax Prepaid",type:"ca",fsId:"TAX_PREPAID"},1900:{name:"Cash & Bank",type:"ca",fsId:"CASH_BANK"},1910:{name:"Cash in Hand",type:"ca",fsId:"CASH_BANK",subAccount:!0},1920:{name:"Bank - Current Account",type:"ca",fsId:"CASH_BANK",subAccount:!0},1930:{name:"Bank - Savings Account",type:"ca",fsId:"CASH_BANK",subAccount:!0},1940:{name:"Fixed Deposits",type:"ca",fsId:"CASH_BANK",subAccount:!0},2e3:{name:"Long Term Borrowings",type:"ncl",fsId:"LONG_TERM_LOAN"},2010:{name:"Term Loan",type:"ncl",fsId:"LONG_TERM_LOAN",subAccount:!0},2020:{name:"Hire Purchase",type:"ncl",fsId:"LONG_TERM_LOAN",subAccount:!0},2100:{name:"Deferred Tax Liability",type:"ncl",fsId:"DEFERRED_TAX"},2500:{name:"Short Term Borrowings",type:"cl",fsId:"SHORT_TERM_LOAN"},2510:{name:"Bank Overdraft",type:"cl",fsId:"SHORT_TERM_LOAN",subAccount:!0},2520:{name:"Short Term Loan",type:"cl",fsId:"SHORT_TERM_LOAN",subAccount:!0},2600:{name:"Trade Payables",type:"cl",fsId:"TRADE_PAYABLES"},2610:{name:"Trade Creditors Control",type:"cl",fsId:"TRADE_PAYABLES",subAccount:!0},2700:{name:"Other Payables",type:"cl",fsId:"OTHER_PAYABLES"},2710:{name:"Accrued Expenses",type:"cl",fsId:"OTHER_PAYABLES",subAccount:!0},2720:{name:"GST Output Tax",type:"cl",fsId:"OTHER_PAYABLES",subAccount:!0},2730:{name:"Deposits Received",type:"cl",fsId:"OTHER_PAYABLES",subAccount:!0},2800:{name:"Tax Payable",type:"cl",fsId:"TAX_PAYABLE"},2810:{name:"Income Tax Payable",type:"cl",fsId:"TAX_PAYABLE",subAccount:!0},2820:{name:"GST/SST Payable",type:"cl",fsId:"GST_SST_PAYABLE",subAccount:!0},2900:{name:"Directors Account",type:"cl",fsId:"OTHER_PAYABLES"},3e3:{name:"Share Capital",type:"equity",fsId:"SHARE_CAPITAL"},3010:{name:"Ordinary Shares",type:"equity",fsId:"SHARE_CAPITAL",subAccount:!0},3020:{name:"Preference Shares",type:"equity",fsId:"SHARE_CAPITAL",subAccount:!0},3100:{name:"Retained Profits",type:"equity",fsId:"RETAINED_PROFITS"},3200:{name:"Reserves",type:"equity",fsId:"RESERVES"},3900:{name:"Drawings",type:"equity_contra",fsId:"DRAWINGS"},4e3:{name:"Sales Revenue",type:"revenue",fsId:"SALES"},4010:{name:"Sales - Products",type:"revenue",fsId:"SALES",subAccount:!0},4020:{name:"Sales - Services",type:"revenue",fsId:"SERVICE_REVENUE",subAccount:!0},4100:{name:"Other Income",type:"other_income",fsId:"OTHER_INCOME"},4110:{name:"Interest Income",type:"other_income",fsId:"INTEREST_INC",subAccount:!0},4120:{name:"Dividend Income",type:"other_income",fsId:"DIVIDEND_INC",subAccount:!0},4130:{name:"Rental Income",type:"other_income",fsId:"RENTAL_INC",subAccount:!0},4140:{name:"Gain on Disposal",type:"other_income",fsId:"OTHER_INCOME",subAccount:!0},4150:{name:"Forex Gain",type:"other_income",fsId:"OTHER_INCOME",subAccount:!0},5e3:{name:"Cost of Sales",type:"cogs",fsId:"PURCHASE"},5010:{name:"Purchases",type:"cogs",fsId:"PURCHASE",subAccount:!0},5020:{name:"Direct Labour",type:"cogs",fsId:"DIRECT_COSTS",subAccount:!0},5030:{name:"Freight In",type:"cogs",fsId:"FREIGHT_IN",subAccount:!0},5040:{name:"Import Duties",type:"cogs",fsId:"DIRECT_COSTS",subAccount:!0},5050:{name:"Subcontractor Costs",type:"cogs",fsId:"DIRECT_COSTS",subAccount:!0},6e3:{name:"Staff Costs",type:"expense",fsId:"SALARY",group:"Staff"},6010:{name:"Salaries & Wages",type:"expense",fsId:"SALARY",subAccount:!0,group:"Staff"},6020:{name:"EPF - Employer",type:"expense",fsId:"EPF",subAccount:!0,group:"Staff"},6030:{name:"SOCSO - Employer",type:"expense",fsId:"SOCSO",subAccount:!0,group:"Staff"},6040:{name:"EIS - Employer",type:"expense",fsId:"SOCSO",subAccount:!0,group:"Staff"},6050:{name:"HRDF Levy",type:"expense",fsId:"HRDF",subAccount:!0,group:"Staff"},6060:{name:"Staff Benefits",type:"expense",fsId:"SALARY",subAccount:!0,group:"Staff"},6100:{name:"Rental Expenses",type:"expense",fsId:"RENT",group:"Premises"},6110:{name:"Office Rental",type:"expense",fsId:"RENT",subAccount:!0,group:"Premises"},6120:{name:"Warehouse Rental",type:"expense",fsId:"RENT",subAccount:!0,group:"Premises"},6200:{name:"Utilities",type:"expense",fsId:"UTILITIES",group:"Premises"},6210:{name:"Electricity",type:"expense",fsId:"UTILITIES",subAccount:!0,group:"Premises"},6220:{name:"Water",type:"expense",fsId:"UTILITIES",subAccount:!0,group:"Premises"},6230:{name:"Gas",type:"expense",fsId:"UTILITIES",subAccount:!0,group:"Premises"},6300:{name:"Telephone & Internet",type:"expense",fsId:"TELEPHONE",group:"Premises"},6400:{name:"Marketing & Advertising",type:"expense",fsId:"ADVERTISING",group:"Marketing"},6410:{name:"Advertising",type:"expense",fsId:"ADVERTISING",subAccount:!0,group:"Marketing"},6420:{name:"Digital Marketing",type:"expense",fsId:"ADVERTISING",subAccount:!0,group:"Marketing"},6500:{name:"Entertainment",type:"expense",fsId:"ENTERTAINMENT",group:"Marketing"},6600:{name:"Travelling",type:"expense",fsId:"TRAVEL",group:"Marketing"},6610:{name:"Local Travel",type:"expense",fsId:"TRAVEL",subAccount:!0,group:"Marketing"},6620:{name:"Overseas Travel",type:"expense",fsId:"TRAVEL",subAccount:!0,group:"Marketing"},6700:{name:"Professional Fees",type:"expense",fsId:"PROFESSIONAL_FEE",group:"Professional"},6710:{name:"Audit Fee",type:"expense",fsId:"PROFESSIONAL_FEE",subAccount:!0,group:"Professional"},6720:{name:"Accounting Fee",type:"expense",fsId:"PROFESSIONAL_FEE",subAccount:!0,group:"Professional"},6730:{name:"Legal Fee",type:"expense",fsId:"PROFESSIONAL_FEE",subAccount:!0,group:"Professional"},6740:{name:"Secretarial Fee",type:"expense",fsId:"PROFESSIONAL_FEE",subAccount:!0,group:"Professional"},6750:{name:"Tax Agent Fee",type:"expense",fsId:"PROFESSIONAL_FEE",subAccount:!0,group:"Professional"},6800:{name:"License & Subscriptions",type:"expense",fsId:"LICENSE_FEE",group:"Professional"},6900:{name:"Insurance",type:"expense",fsId:"INSURANCE",group:"Professional"},7e3:{name:"Office Supplies",type:"expense",fsId:"OFFICE_SUPPLIES",group:"Office"},7100:{name:"Repairs & Maintenance",type:"expense",fsId:"REPAIR_MAINTENANCE",group:"Office"},7200:{name:"Cleaning & Upkeep",type:"expense",fsId:"CLEANING",group:"Office"},7300:{name:"Depreciation",type:"expense",fsId:"DEPRECIATION",group:"Other"},7310:{name:"Depreciation - Buildings",type:"expense",fsId:"DEPRECIATION",subAccount:!0,group:"Other"},7320:{name:"Depreciation - Plant & Machinery",type:"expense",fsId:"DEPRECIATION",subAccount:!0,group:"Other"},7330:{name:"Depreciation - Motor Vehicles",type:"expense",fsId:"DEPRECIATION",subAccount:!0,group:"Other"},7340:{name:"Depreciation - Office Equipment",type:"expense",fsId:"DEPRECIATION",subAccount:!0,group:"Other"},7350:{name:"Depreciation - Computer Equipment",type:"expense",fsId:"DEPRECIATION",subAccount:!0,group:"Other"},7400:{name:"Bad Debts",type:"expense",fsId:"BAD_DEBT",group:"Other"},7500:{name:"Other Expenses",type:"other_expense",fsId:"OTHER_EXPENSE"},7510:{name:"Forex Loss",type:"other_expense",fsId:"FOREX_LOSS",subAccount:!0},7520:{name:"Loss on Disposal",type:"other_expense",fsId:"OTHER_EXPENSE",subAccount:!0},8e3:{name:"Bank Charges",type:"finance",fsId:"BANK_CHARGES"},8100:{name:"Interest Expense",type:"finance",fsId:"INTEREST_EXP"},8110:{name:"Interest on Term Loan",type:"finance",fsId:"INTEREST_EXP",subAccount:!0},8120:{name:"Interest on Hire Purchase",type:"finance",fsId:"INTEREST_EXP",subAccount:!0},8130:{name:"Interest on Overdraft",type:"finance",fsId:"INTEREST_EXP",subAccount:!0},9e3:{name:"Income Tax Expense",type:"tax",fsId:"TAX_EXPENSE"},9100:{name:"Deferred Tax Expense",type:"tax",fsId:"TAX_EXPENSE",subAccount:!0}},Gt={income:{revenue:[{id:"SALES",label:"Sales Revenue",glCode:"4000",kw:["sales","revenue","service fee","collection","payment received","customer payment","inward","receipt","proceed"]}],cost_of_sales:[{id:"PURCHASE",label:"Purchases",glCode:"5010",kw:["purchase","inventory","stock","goods","supplier","vendor","buy","cost of sales","raw material"]},{id:"FREIGHT_IN",label:"Freight & Delivery",glCode:"5030",kw:["freight in","shipping cost","delivery charge","import","carriage inward"]}],other_income:[{id:"INTEREST_INC",label:"Interest Income",glCode:"4110",kw:["interest income","interest received","interest credit","interest earn","hibah"]},{id:"DIVIDEND_INC",label:"Dividend Income",glCode:"4120",kw:["dividend","dividend income","dividend received"]},{id:"RENTAL_INC",label:"Rental Income",glCode:"4130",kw:["rental income","rent received","tenant","sewa diterima"]},{id:"OTHER_INCOME",label:"Other Income",glCode:"4100",kw:["other income","miscellaneous income","gain on disposal","forex gain","commission income","rebate","refund received"]}],operating_expenses:[{id:"SALARY",label:"Staff Costs",glCode:"6000",kw:["salary","wages","payroll","bonus","staff","employee","gaji","allowance","commission paid"],group:"Staff"},{id:"EPF",label:"EPF Contribution",glCode:"6020",kw:["epf","kwsp","employees provident"],group:"Staff"},{id:"SOCSO",label:"SOCSO/EIS",glCode:"6030",kw:["socso","perkeso","eis","employment insurance"],group:"Staff"},{id:"HRDF",label:"HRDF Levy",glCode:"6050",kw:["hrdf","training levy"],group:"Staff"},{id:"RENT",label:"Rental",glCode:"6100",kw:["rent","lease","tenancy","rental","premises","sewa","office space"],group:"Premises"},{id:"UTILITIES",label:"Utilities",glCode:"6200",kw:["electric","water","gas","utility","utilities","tnb","syabas","indah water","tenaga","sewerage"],group:"Premises"},{id:"TELEPHONE",label:"Telephone & Internet",glCode:"6300",kw:["telephone","phone","mobile","internet","telco","unifi","maxis","celcom","digi","time","broadband","wifi"],group:"Premises"},{id:"ADVERTISING",label:"Advertising & Marketing",glCode:"6400",kw:["advertising","advertisement","ads","marketing","promotion","branding","social media","google ads","facebook","instagram","digital marketing"],group:"Marketing"},{id:"ENTERTAINMENT",label:"Entertainment",glCode:"6500",kw:["entertainment","client meal","business meal","corporate gift","hamper","gift","makan","lunch meeting","dinner"],group:"Marketing"},{id:"TRAVEL",label:"Travelling",glCode:"6600",kw:["travel","travelling","accommodation","hotel","flight","airfare","petrol","toll","parking","grab","uber","transport","mileage"],group:"Marketing"},{id:"PROFESSIONAL_FEE",label:"Professional Fees",glCode:"6700",kw:["professional fee","audit fee","accounting fee","legal fee","consultation","consultant","secretary fee","tax agent","company secretary"],group:"Professional"},{id:"LICENSE_FEE",label:"License & Subscriptions",glCode:"6800",kw:["license","licence","permit","renewal","ssm","registration","subscription","software license"],group:"Professional"},{id:"INSURANCE",label:"Insurance",glCode:"6900",kw:["insurance","takaful","premium","coverage","policy"],group:"Professional"},{id:"OFFICE_SUPPLIES",label:"Office Supplies",glCode:"7000",kw:["office supplies","stationery","printing","toner","cartridge","paper","pen","pantry"],group:"Office"},{id:"REPAIR_MAINTENANCE",label:"Repairs & Maintenance",glCode:"7100",kw:["repair","maintenance","service","fix","servicing","upkeep","baiki"],group:"Office"},{id:"CLEANING",label:"Cleaning",glCode:"7200",kw:["cleaning","cleaner","housekeeping","pest control","waste disposal"],group:"Office"},{id:"DEPRECIATION",label:"Depreciation",glCode:"7300",kw:["depreciation","amortisation","amortization"],group:"Other"},{id:"BAD_DEBT",label:"Bad Debts",glCode:"7400",kw:["bad debt","doubtful debt","write off","impairment","provision"],group:"Other"}],other_expenses:[{id:"FOREX_LOSS",label:"Forex Loss",glCode:"7510",kw:["forex loss","exchange loss","currency loss"]},{id:"OTHER_EXPENSE",label:"Other Expenses",glCode:"7500",kw:["other expense","miscellaneous expense","sundry expense","general expense"]}],finance_costs:[{id:"BANK_CHARGES",label:"Bank Charges",glCode:"8000",kw:["bank charge","bank fee","service charge","annual fee","monthly fee","atm fee","card fee","transaction fee"]},{id:"INTEREST_EXP",label:"Interest Expense",glCode:"8100",kw:["interest expense","interest paid","loan interest","finance charge","overdraft interest"]}],tax:[{id:"TAX_EXPENSE",label:"Tax Expense",glCode:"9000",kw:[]}]},balance:{non_current_assets:[{id:"PPE",label:"Property, Plant & Equipment",glCode:"1000",kw:["equipment","machinery","vehicle","furniture","computer","laptop","printer","asset purchase","renovation","air cond","aircon"],classCode:"FIXED_ASSET"},{id:"INTANGIBLES",label:"Intangible Assets",glCode:"1200",kw:["intangible","software","trademark","patent"]},{id:"INVESTMENTS",label:"Investments",glCode:"1300",kw:["investment","shares","unit trust"]}],current_assets:[{id:"INVENTORY",label:"Inventory",glCode:"1500",kw:[]},{id:"TRADE_RECEIVABLES",label:"Trade Receivables",glCode:"1600",kw:[]},{id:"OTHER_RECEIVABLES",label:"Other Receivables",glCode:"1700",kw:["deposit","prepaid","prepayment","advance"]},{id:"TAX_PREPAID",label:"Tax Prepaid",glCode:"1800",kw:[]},{id:"CASH_BANK",label:"Cash & Bank",glCode:"1900",kw:[]}],non_current_liabilities:[{id:"LONG_TERM_LOAN",label:"Long Term Borrowings",glCode:"2000",kw:["term loan","long term loan","hp","hire purchase"]},{id:"DEFERRED_TAX",label:"Deferred Tax",glCode:"2100",kw:[]}],current_liabilities:[{id:"SHORT_TERM_LOAN",label:"Short Term Borrowings",glCode:"2500",kw:["loan disbursement","loan drawdown","borrowing","financing","instalment","installment","loan repayment"],classCode:"LOAN"},{id:"TRADE_PAYABLES",label:"Trade Payables",glCode:"2600",kw:[]},{id:"OTHER_PAYABLES",label:"Other Payables",glCode:"2700",kw:["accrual","accrued"]},{id:"TAX_PAYABLE",label:"Tax Payable",glCode:"2800",kw:[],classCode:"TAX_PAYMENT"},{id:"GST_SST_PAYABLE",label:"GST/SST Payable",glCode:"2820",kw:["gst payment","sst payment","gst","sst","service tax","sales tax"],classCode:"GST_SST"}],equity:[{id:"SHARE_CAPITAL",label:"Share Capital",glCode:"3000",kw:["capital injection","share capital","director loan","shareholder fund","capital contribution"],classCode:"CAPITAL"},{id:"RETAINED_PROFITS",label:"Retained Profits",glCode:"3100",kw:[]},{id:"CURRENT_YEAR_PROFIT",label:"Current Year Profit/(Loss)",glCode:"3100",kw:[]}]},other:[{id:"DRAWINGS",label:"Drawings",glCode:"3900",kw:["drawings","personal withdrawal","director withdrawal","owner withdrawal"],type:"drawings"},{id:"TRANSFER",label:"Transfer (Internal)",glCode:null,kw:["ibg transfer","interbank giro","internal transfer","own account transfer","transfer to own","transfer from own","self transfer"],type:"transfer"},{id:"CASH_TRANSFER",label:"Cash Transfer (BankCash)",glCode:null,kw:["petty cash","cash withdrawal","cash deposit","atm withdrawal","atm deposit","cash top up","cash topup"],type:"cash_transfer"},{id:"TAX_PAYMENT",label:"Tax Payment",glCode:"2800",kw:["tax payment","lhdn","income tax","cp204","cp500","pcb","mtd"],type:"tax_payment"},{id:"PAY_SUPPLIER",label:"Payment to Supplier",glCode:"2600",kw:["payment to supplier","supplier payment","vendor payment","creditor payment"],type:"pay_supplier"},{id:"PAY_CREDITOR",label:"Payment to Creditor",glCode:"2700",kw:["payment to creditor","creditor","accrual payment"],type:"pay_creditor"},{id:"LOAN_REPAY_ST",label:"Loan Repayment (ST)",glCode:"2500",kw:["loan repayment","loan payment","instalment","installment","monthly repayment","loan instalment"],type:"loan_repay_st"},{id:"LOAN_REPAY_LT",label:"Loan Repayment (LT)",glCode:"2000",kw:["term loan repayment","hp repayment","hire purchase repayment","mortgage payment"],type:"loan_repay_lt"},{id:"LOAN_DRAWDOWN",label:"Loan Drawdown",glCode:"2500",kw:["loan disbursement","loan drawdown","loan proceeds","facility drawdown","od utilization","overdraft"],type:"loan_drawdown"},{id:"RECEIPT_DEBTOR",label:"Receipt from Debtor",glCode:"1600",kw:["receipt from debtor","debtor receipt","customer receipt","collection","received from customer"],type:"receipt_debtor"},{id:"DEPOSIT_RECEIVED",label:"Deposit Received",glCode:"2700",kw:["deposit received","advance received","customer deposit"],type:"deposit_received"},{id:"DUITNOW_OUT",label:"DuitNow (Payment)",glCode:"2600",kw:["duitnow"],type:"duitnow_payment"},{id:"SUSPENSE",label:"Suspense",glCode:"9999",kw:[],type:"suspense"}]},tb={PURCHASES:"PURCHASE",COST_OF_SALES:"PURCHASE",COGS:"PURCHASE",MISC_EXPENSE:"MISCELLANEOUS",OFFICE:"OFFICE_SUPPLIES"},cn={rules:(()=>{const e={};return Gt.income.revenue.forEach(a=>{e[a.id]={kw:a.kw,type:"revenue",label:a.label}}),Gt.income.cost_of_sales.forEach(a=>{e[a.id]={kw:a.kw,type:"cogs",label:a.label}}),Gt.income.other_income.forEach(a=>{e[a.id]={kw:a.kw,type:"other_income",label:a.label}}),Gt.income.operating_expenses.forEach(a=>{e[a.id]={kw:a.kw,type:"expense",label:a.label,group:a.group}}),Gt.income.other_expenses.forEach(a=>{e[a.id]={kw:a.kw,type:"other_expense",label:a.label}}),Gt.income.finance_costs.forEach(a=>{e[a.id]={kw:a.kw,type:"finance",label:a.label}}),Gt.balance.non_current_assets.forEach(a=>{a.kw.length>0&&(e[a.classCode||a.id]={kw:a.kw,type:"asset",label:a.label})}),Gt.balance.current_liabilities.forEach(a=>{a.kw.length>0&&a.classCode&&(e[a.classCode]={kw:a.kw,type:"liability",label:a.label})}),Gt.balance.equity.forEach(a=>{a.kw.length>0&&a.classCode&&(e[a.classCode]={kw:a.kw,type:"equity",label:a.label})}),Gt.other.forEach(a=>{e[a.id]={kw:a.kw,type:a.type,label:a.label}}),e})(),classify(e){if(!e)return{code:"SUSPENSE",type:"suspense"};const a=e.toLowerCase();for(const[t,i]of Object.entries(this.rules))if(i.kw.some(s=>a.includes(s)))return{code:t,type:i.type};return{code:"SUSPENSE",type:"suspense"}},createJE(e,a){const t=[],i=Math.abs(e.amount||0),s=(e.amount||0)>0,c="cash_on_hand",f=e.source==="Cash"||e.source==="CashVoucher"||e.cashLedger==="PETTY_CASH",p=e.bankAccount?`bank_${e.bankAccount.toLowerCase().replace(/\s+/g,"_")}`:"bank",g=f?c:p;return a.type==="cash_transfer"||e.transferDirection?(e.transferDirection==="bank_to_cash"?t.push({acc:c,dr:i,cr:0},{acc:p,dr:0,cr:i}):e.transferDirection==="cash_to_bank"?t.push({acc:p,dr:i,cr:0},{acc:c,dr:0,cr:i}):t.push({acc:g,dr:s?i:0,cr:s?0:i},{acc:"transfer_suspense",dr:s?0:i,cr:s?i:0}),{date:e.date||"",desc:e.description||"",ref:e.reference||"",entries:t,cls:a.code,source:e.source||"Manual",bank:e.bankAccount||"Default",documentType:f?"CV":"BT"}):(a.type==="revenue"||a.type==="other_income"?t.push({acc:g,dr:i,cr:0},{acc:a.code.toLowerCase(),dr:0,cr:i}):a.type==="cogs"||a.type==="expense"||a.type==="finance"||a.type==="other_expense"?t.push({acc:a.code.toLowerCase(),dr:i,cr:0},{acc:g,dr:0,cr:i}):a.type==="asset"?t.push({acc:s?g:a.code.toLowerCase(),dr:i,cr:0},{acc:s?a.code.toLowerCase():g,dr:0,cr:i}):a.type==="liability"?t.push({acc:g,dr:s?i:0,cr:s?0:i},{acc:a.code.toLowerCase(),dr:s?0:i,cr:s?i:0}):a.type==="transfer"?t.push({acc:g,dr:s?i:0,cr:s?0:i},{acc:"transfer_suspense",dr:s?0:i,cr:s?i:0}):a.type==="equity"?t.push({acc:g,dr:s?i:0,cr:s?0:i},{acc:a.code.toLowerCase(),dr:s?0:i,cr:s?i:0}):a.type==="drawings"?t.push({acc:a.code.toLowerCase(),dr:i,cr:0},{acc:g,dr:0,cr:i}):a.type==="tax_payment"?t.push({acc:"tax_payable",dr:i,cr:0},{acc:g,dr:0,cr:i}):a.type==="pay_supplier"?t.push({acc:"trade_payables",dr:i,cr:0},{acc:g,dr:0,cr:i}):a.type==="pay_creditor"?t.push({acc:"other_payables",dr:i,cr:0},{acc:g,dr:0,cr:i}):a.type==="loan_repay_st"?t.push({acc:"short_term_loan",dr:i,cr:0},{acc:g,dr:0,cr:i}):a.type==="loan_repay_lt"?t.push({acc:"long_term_loan",dr:i,cr:0},{acc:g,dr:0,cr:i}):a.type==="loan_drawdown"?t.push({acc:g,dr:i,cr:0},{acc:"short_term_loan",dr:0,cr:i}):a.type==="receipt_debtor"?t.push({acc:g,dr:i,cr:0},{acc:"trade_receivables",dr:0,cr:i}):a.type==="deposit_received"?t.push({acc:g,dr:i,cr:0},{acc:"other_payables",dr:0,cr:i}):a.type==="duitnow_payment"?s?t.push({acc:g,dr:i,cr:0},{acc:"trade_receivables",dr:0,cr:i}):t.push({acc:"trade_payables",dr:i,cr:0},{acc:g,dr:0,cr:i}):t.push({acc:"suspense",dr:s?i:0,cr:s?0:i},{acc:g,dr:s?0:i,cr:s?i:0}),{date:e.date||"",desc:e.description||"",ref:e.reference||"",entries:t,cls:a.code,source:e.source||"Manual",bank:e.bankAccount||"Default",documentType:f?"CV":"BT"})},createSubledgerJEs(e){const a=[],t=new Date().toISOString().split("T")[0];return e.depreciation>0&&a.push({date:t,desc:"Depreciation for the year (from PPE Register)",ref:"SL-DEP",entries:[{acc:"depreciation",dr:e.depreciation,cr:0},{acc:"accumulated_depreciation",dr:0,cr:e.depreciation}],cls:"DEPRECIATION",source:"Subledger",bank:"N/A"}),a},buildTB(e,a={}){const t={};for(const[i,s]of Object.entries(a))t[i]={op:s,dr:0,cr:0};for(const i of e)for(const s of i.entries)t[s.acc]||(t[s.acc]={op:0,dr:0,cr:0}),t[s.acc].dr+=s.dr,t[s.acc].cr+=s.cr;return Object.entries(t).map(([i,s])=>({acc:i,op:s.op,dr:s.dr,cr:s.cr,cl:s.op+s.dr-s.cr}))},genFS(e,a=null,t=null,i=null,s=null,c=[],f=[],p={}){const g={rev:0,cos:0,gp:0,adm:0,dep:0,op:0,oi:0,oe:0,fin:0,pbt:0,tax:0,np:0,details:{}},h={ppe_cost:0,ppe_accDep:0,ppe:0,intangibles:0,investments:0,inv:0,tr:0,or:0,cash:0,totNCA:0,totCA:0,totA:0,ltBorr:0,defTax:0,borr:0,tp:0,op:0,taxPay:0,gstSst:0,totNCL:0,totCL:0,totL:0,cap:0,ret:0,cyp:0,totE:0,details:{}};Object.keys(cn.rules).forEach(_=>{g.details[_]=0});for(const _ of e){const w=_.acc.toUpperCase(),N=cn.rules[w];if(N){let F=0;N.type==="revenue"||N.type==="other_income"?(F=_.cr-_.dr,F<0&&(F=0)):N.type==="cogs"||N.type==="expense"||N.type==="finance"||N.type==="other_expense"?(F=_.dr-_.cr,F<0&&(F=0)):F=Math.abs(_.cl),g.details[w]=F,N.type==="revenue"?g.rev+=F:N.type==="cogs"?g.cos+=F:N.type==="expense"?(g.adm+=F,w==="DEPRECIATION"&&(g.dep+=F)):N.type==="other_income"?g.oi+=F:N.type==="other_expense"?g.oe+=F:N.type==="finance"&&(g.fin+=F)}const k=_.acc.toLowerCase();k==="bank"||k.startsWith("bank_")||k==="cash_on_hand"?(h.cash+=_.cl,k==="cash_on_hand"&&(h.cashInHand=(h.cashInHand||0)+_.cl)):k==="fixed_asset"||k==="ppe"?h.ppe_cost+=_.cl:k==="accumulated_depreciation"?h.ppe_accDep+=Math.abs(_.cl):k==="intangibles"||k==="intangible_assets"?h.intangibles=(h.intangibles||0)+_.cl:k==="investments"?h.investments=(h.investments||0)+_.cl:k==="inventory"?h.inv+=_.cl:k==="trade_receivables"?h.tr+=_.cl:k==="other_receivables"?h.or+=_.cl:k==="long_term_loan"||k==="lt_loan"?h.ltBorr+=Math.abs(_.cl):k==="deferred_tax"?h.defTax=(h.defTax||0)+Math.abs(_.cl):k==="loan"||k==="short_term_loan"?h.borr+=Math.abs(_.cl):k==="trade_payables"?h.tp+=Math.abs(_.cl):k==="other_payables"?h.op+=Math.abs(_.cl):k==="tax_payable"?_.cl<0?h.taxPay+=Math.abs(_.cl):_.cl>0&&(h.taxPrepaid=(h.taxPrepaid||0)+_.cl):k==="gst_sst"?_.cl<0?h.gstSst=(h.gstSst||0)+Math.abs(_.cl):h.gstSst=(h.gstSst||0)-_.cl:k==="capital"||k==="share_capital"?h.cap+=Math.abs(_.cl):(k==="retained_profits"||k==="retained_earnings")&&(h.ret+=Math.abs(_.cl))}if(s){if(s.ppe&&s.ppe.cost>0&&(h.ppe_cost=s.ppe.cost,h.ppe_accDep=s.ppe.accDepCF,s.ppe.currentDep>0)){const _=g.details.DEPRECIATION||0;_===0?(g.dep=s.ppe.currentDep,g.details.DEPRECIATION=s.ppe.currentDep,g.adm+=s.ppe.currentDep):g.dep=_}s.inventory>0&&h.inv===0&&(h.inv=s.inventory),s.receivables>0&&h.tr===0&&(h.tr=s.receivables),s.payables>0&&h.tp===0&&(h.tp=s.payables),s.otherDebtors>0&&(h.or=s.otherDebtors),s.otherCreditors>0&&(h.op=s.otherCreditors),s.hasSTBorrowings&&(h.stBorr=s.shortTermBorrowings||0,h.borr=s.shortTermBorrowings||0),s.hasLTBorrowings&&(h.ltBorr=s.longTermBorrowings||0),s.borrowingsDrawdowns!==void 0&&(h.loanDrawdowns=s.borrowingsDrawdowns),s.borrowingsRepayments!==void 0&&(h.loanRepayments=s.borrowingsRepayments),s.stBorrOpening!==void 0&&(h.py_stBorr=s.stBorrOpening),s.ltBorrOpening!==void 0&&(h.py_ltBorr=s.ltBorrOpening)}if(h.ppe=h.ppe_cost-h.ppe_accDep,g.gp=g.rev-g.cos,g.op=g.gp-g.adm,g.pbt=g.op+g.oi-g.oe-g.fin,g.tax=i?i(g.pbt):0,g.np=g.pbt-g.tax,h.taxPrepaid&&h.taxPrepaid>0){const _=g.tax-h.taxPrepaid;_>0?(h.taxPay+=_,h.taxPrepaid=0):h.taxPrepaid=-_}else h.taxPay+=g.tax;h.totNCA=h.ppe+h.intangibles+h.investments,h.totCA=h.cash+h.tr+h.or+h.inv+(h.taxPrepaid||0),h.totA=h.totNCA+h.totCA;const E=h.stBorr||h.borr||0;h.stBorr=E,h.totNCL=h.ltBorr+h.defTax,h.totCL=E+h.tp+h.op+h.taxPay,h.totL=h.totNCL+h.totCL,h.borr=E,h.cyp=g.np,h.totE=h.cap+h.ret+h.cyp,a&&(g.py_rev=parseFloat(a.revenue)||0,g.py_cos=parseFloat(a.cost_of_sales)||0,g.py_gp=g.py_rev-g.py_cos,g.py_dep=parseFloat(a.depreciation)||0,g.py_adm=parseFloat(a.admin_expenses)||0,g.py_totalAdm=g.py_dep+g.py_adm,g.py_op=g.py_gp-g.py_totalAdm,g.py_oi=parseFloat(a.other_income)||0,g.py_oe=parseFloat(a.other_expenses)||0,g.py_fin=parseFloat(a.finance_costs)||0,g.py_pbt=g.py_op+g.py_oi-g.py_oe-g.py_fin,g.py_tax=parseFloat(a.tax)||0,g.py_np=g.py_pbt-g.py_tax),t&&(h.py_ppe=parseFloat(t.ppe)||0,h.py_intangibles=parseFloat(t.intangibles)||0,h.py_investments=parseFloat(t.investments)||0,h.py_inv=parseFloat(t.inventory)||0,h.py_tr=parseFloat(t.trade_receivables)||0,h.py_or=parseFloat(t.other_receivables)||0,h.py_cash=parseFloat(t.bank)||0,h.py_totNCA=h.py_ppe+h.py_intangibles+h.py_investments,h.py_totCA=h.py_cash+h.py_tr+h.py_or+h.py_inv,h.py_totA=h.py_totNCA+h.py_totCA,h.py_ltLoan=parseFloat(t.long_term_loan)||0,h.py_defTax=parseFloat(t.deferred_tax)||0,h.py_loan=parseFloat(t.loan)||0,h.py_tp=parseFloat(t.trade_payables)||0,h.py_op=parseFloat(t.other_payables)||0,h.py_taxPay=parseFloat(t.tax_payable)||0,h.py_borr=h.py_ltLoan+h.py_loan,h.py_totNCL=h.py_ltLoan+h.py_defTax,h.py_totCL=h.py_loan+h.py_tp+h.py_op+h.py_taxPay,h.py_totL=h.py_totNCL+h.py_totCL,h.py_cap=parseFloat(t.share_capital)||0,h.py_ret=parseFloat(t.retained_profits)||0,h.py_reserves=parseFloat(t.reserves)||0,h.py_totE=h.py_cap+h.py_ret+h.py_reserves,h.py_diff=h.py_totA-(h.py_totL+h.py_totE));const A={pbt:g.pbt,adjustments:{depreciation:g.dep||0,interestExpense:g.fin||0,interestIncome:-(g.details.INTEREST_INC||0)},workingCapitalChanges:{inventory:(h.py_inv||0)-h.inv,tradeReceivables:(h.py_tr||0)-h.tr,otherReceivables:(h.py_or||0)-h.or,tradePayables:h.tp-(h.py_tp||0),otherPayables:h.op-(h.py_op||0)},taxPaid:0,interestPaid:0,ppePurchases:-Math.max(0,h.ppe-(h.py_ppe||0)+(g.dep||0)),ppeDisposals:0,investmentPurchases:-Math.max(0,(h.investments||0)-(h.py_investments||0)),investmentDisposals:Math.max(0,(h.py_investments||0)-(h.investments||0)),interestReceived:g.details.INTEREST_INC||0,loanProceeds:h.loanDrawdowns!==void 0?h.loanDrawdowns:Math.max(0,h.stBorr+(h.ltBorr||0)-((h.py_stBorr||h.py_loan||0)+(h.py_ltBorr||h.py_ltLoan||0))),loanRepayments:h.loanRepayments!==void 0?-h.loanRepayments:-Math.max(0,(h.py_stBorr||h.py_loan||0)+(h.py_ltBorr||h.py_ltLoan||0)-(h.stBorr+(h.ltBorr||0))),capitalInjection:Math.max(0,h.cap-(h.py_cap||0)),dividendsPaid:0,drawingsWithdrawals:0};return A.totalAdjustments=A.adjustments.depreciation+A.adjustments.interestExpense+A.adjustments.interestIncome,A.totalWCChanges=A.workingCapitalChanges.inventory+A.workingCapitalChanges.tradeReceivables+A.workingCapitalChanges.otherReceivables+A.workingCapitalChanges.tradePayables+A.workingCapitalChanges.otherPayables,A.cashFromOperations=A.pbt+A.totalAdjustments+A.totalWCChanges,A.netOperating=A.cashFromOperations-A.taxPaid-A.interestPaid,A.netInvesting=A.ppePurchases+A.ppeDisposals+A.investmentPurchases+A.investmentDisposals+A.interestReceived,A.netFinancing=A.loanProceeds+A.loanRepayments+A.capitalInjection+A.dividendsPaid+A.drawingsWithdrawals,A.netChangeInCash=A.netOperating+A.netInvesting+A.netFinancing,h.py_cash&&h.py_cash>0?A.openingCash=h.py_cash:A.openingCash=Object.entries(p).reduce((_,[w,N])=>w==="bank"||w.startsWith("bank_")?_+(parseFloat(N)||0):_,0),A.closingCash=A.openingCash+A.netChangeInCash,A.cashPerBS=h.cash,A.difference=A.closingCash-A.cashPerBS,{is:g,bs:h,cf:A}},process(e,a={},t=null,i=null,s=null,c=null,f=[],p=[]){const g=[],h=[];for(const _ of e){const w=_.classification,N=w?tb[w]||w:null,k=N?{code:N,type:this.rules[N]?.type||"suspense"}:this.classify(_.description),F={..._,classification:k.code};g.push(this.createJE(F,k)),k.code==="SUSPENSE"&&h.push(_)}if(c){const _=this.createSubledgerJEs(c);g.push(..._)}const E=this.buildTB(g,a),A=this.genFS(E,t,i,s,c,f,p,a);return{jes:g,tb:E,is:A.is,bs:A.bs,cf:A.cf,susp:h}}},wp=(e,a,t,i,s=null)=>{const c=e.split(`
`).filter(A=>A.trim()),f=[],p={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12"},g=[/balance\s*(c\/f|b\/f|from|brought|carried)/i,/^date[\s,]+transaction/i,/^tarikh/i,/closing\s*balance/i,/opening\s*balance/i,/baki\s*(harian|penutup)/i],h=s||new Date().getFullYear(),E=A=>{const _=[];let w="",N=!1;for(let k=0;k<A.length;k++){const F=A[k];F==='"'?N=!N:F===","&&!N?(_.push(w.trim()),w=""):w+=F}return _.push(w.trim()),_};for(let A=0;A<c.length;A++){const _=c[A].trim();if(!_||_.length<5||g.some(se=>se.test(_)))continue;let w;_.includes(",")?w=E(_):w=_.split(/\t/).map(se=>se.trim());let N=null;const k=(w[0]||"").trim(),F=k.match(/^(\d{1,2})[\/\-](\d{1,2})$/);if(F){const se=F[1].padStart(2,"0"),ne=F[2].padStart(2,"0");N=`${h}-${ne}-${se}`}if(!N){const se=k.match(/^(\d{1,2})[\/\-\.]?([A-Za-z]{3})/i);if(se){const ne=se[1].padStart(2,"0"),H=se[2].toLowerCase(),le=p[H];le&&(N=`${h}-${le}-${ne}`)}}if(!N){const se=k.match(/^(\d{1,2})[\/\-\.](\d{1,2})[\/\-\.](\d{2,4})/);if(se){const ne=se[1].padStart(2,"0"),H=se[2].padStart(2,"0");let le=se[3];le.length===2&&(le=parseInt(le)>50?"19"+le:"20"+le),N=`${le}-${H}-${ne}`}}if(!N){const se=k.match(/^(\d{4})[\/\-\.](\d{1,2})[\/\-\.](\d{1,2})/);se&&(N=`${se[1]}-${se[2].padStart(2,"0")}-${se[3].padStart(2,"0")}`)}if(!N)continue;let z="";if(w.length>=2&&(z=(w[1]||"").trim()),/balance\s*(c\/f|b\/f|from|brought|carried)/i.test(z))continue;let q=0,B=0;if(w.length>=4){const se=(w[2]||"").replace(/"/g,"").trim(),ne=(w[3]||"").replace(/"/g,"").trim();if(se){const H=se.replace(/,/g,""),le=parseFloat(H);!isNaN(le)&&le>0&&(q=le)}if(ne){const H=ne.replace(/,/g,""),le=parseFloat(H);!isNaN(le)&&le>0&&(B=le)}}else{const se=[],ne=_.match(/([\d,]+\.\d{2})/g)||[];for(const H of ne){const le=parseFloat(H.replace(/,/g,""));!isNaN(le)&&le>0&&se.push(le)}se.length>=1&&(/\b(dr|debit|withdrawal|payment|paid|transfer\s*dr|trsf\s*dr)\b/i.test(_)?q=se[0]:B=se[0])}if(q===0&&B===0)continue;const ie=B>0?B:-q;z=z.replace(/([\d,]+\.\d{2})/g,"").trim(),z=z.replace(/\s+/g," ").trim(),z.length<2&&(z="Bank Transaction"),f.push({date:N,description:z.substring(0,100),reference:`${(t||"BNK").substring(0,3).toUpperCase()}-${i}-${f.length+1}`,amount:ie,source:a,bankAccount:t||"Unknown",month:i})}return f},ae=e=>new Intl.NumberFormat("en-MY",{style:"currency",currency:"MYR"}).format(e||0),ni=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Ym=[{id:"maybank",name:"Maybank",accNo:"5123456789"},{id:"cimb",name:"CIMB",accNo:"8001234567"}],R8=[{date:"2024-01-05",description:"Sales collection - ABC Sdn Bhd",reference:"MAY-Jan-1",amount:5e4,source:"Sample",bankAccount:"Maybank",month:"Jan"},{date:"2024-01-08",description:"Purchase inventory - Supplier XYZ",reference:"MAY-Jan-2",amount:-2e4,source:"Sample",bankAccount:"Maybank",month:"Jan"},{date:"2024-02-15",description:"Salary February 2024",reference:"MAY-Feb-1",amount:-12e3,source:"Sample",bankAccount:"Maybank",month:"Feb"},{date:"2024-02-18",description:"Office rent payment",reference:"CIM-Feb-1",amount:-3500,source:"Sample",bankAccount:"CIMB",month:"Feb"},{date:"2024-03-22",description:"Sales collection - DEF Enterprise",reference:"MAY-Mar-1",amount:28e3,source:"Sample",bankAccount:"Maybank",month:"Mar"},{date:"2024-03-25",description:"TNB Electric bill",reference:"CIM-Mar-1",amount:-850,source:"Sample",bankAccount:"CIMB",month:"Mar"}];function N8(){const[e,a]=dt.useState("setup"),[t,i]=dt.useState(""),[s,c]=dt.useState(""),[f,p]=dt.useState(""),[g,h]=dt.useState("12"),[E,A]=dt.useState(""),[_,w]=dt.useState([]),[N,k]=dt.useState([]),[F,z]=dt.useState("ALL"),[q,B]=dt.useState(""),[ie,se]=dt.useState(new Set),[ne,H]=dt.useState(""),[le,oe]=dt.useState({}),[m,Se]=dt.useState(null),[ue,Pe]=dt.useState(!1),[tt,ke]=dt.useState([]),[de,_e]=dt.useState({acc:"",amt:""}),Ze=dt.useRef(null),[fe,Je]=dt.useState(new Date().getFullYear()-1),[ee,O]=dt.useState(!1),[L,K]=dt.useState(new Date().getFullYear()),[te,he]=dt.useState(!1),[Oe,Ue]=dt.useState(null),[Ie,He]=dt.useState(null),[gt,Z]=dt.useState([]),[aa,St]=dt.useState(!1),[Mt,yt]=dt.useState({periodType:"Monthly",periodLabel:"",note:"",createdBy:"Accountant"}),[et,ra]=dt.useState([]),[Ba,Qa]=dt.useState({periodLabel:"",type:"Correction",amount:"",description:""}),[Rt,Yr]=dt.useState({date:new Date().toISOString().split("T")[0],description:"",reference:"CV-001",amount:"",type:"out",classification:""}),Zr={MFRS:{name:"MFRS",fullName:"Malaysian Financial Reporting Standards",desc:"Full IFRS-equivalent standards for public companies"},MPERS:{name:"MPERS",fullName:"Malaysian Private Entities Reporting Standard",desc:"Simplified standards for private entities"},"MPERS-Micro":{name:"MPERS for Micro Entities",fullName:"MPERS for Micro Entities",desc:"Simplified standards for micro entities"}},ia=u=>u==="BERHAD"?"MFRS":u==="ENTERPRISE"?"MPERS-Micro":"MPERS",Dr=$m[t],sa=Dr?{...Dr,standard:E||Dr.standard,fullStandard:E?Zr[E]?.fullName:Dr.fullStandard}:null,Lt=g?`${["","January","February","March","April","May","June","July","August","September","October","November","December"][parseInt(g)]} ${L}`:"",[Et,ht]=dt.useState({sdnBhd:{tier1Limit:5e5,tier1Rate:17,tier2Rate:24},enterprise:{brackets:[{limit:5e3,rate:0},{limit:15e3,rate:1},{limit:15e3,rate:3},{limit:15e3,rate:6},{limit:2e4,rate:11},{limit:3e4,rate:19},{limit:15e4,rate:25},{limit:15e4,rate:26},{limit:1/0,rate:28}]},berhad:{rate:24},corporateDeductions:{capitalAllowance:"",reinvestmentAllowance:"",pioneerStatus:"",investmentTaxAllowance:"",exportIncentive:"",rdDeduction:"",lossCarryForward:""},personalDeductions:{selfRelief:"9000",spouseRelief:"",childRelief:"",parentsMedical:"",epfContribution:"",lifeInsurance:"",educationFees:"",medicalExpenses:"",lifestyleRelief:"",socsoContribution:"",privateRetirement:"",sspnDeposit:"",domesticTravel:"",evCharging:""},addBackExpenses:{depreciation:"",generalProvisionBadDebt:"",entertainmentClients:"",entertainmentPotential:"",privateExpenses:"",finesAndPenalties:"",donationsUnapproved:"",capitalExpenditure:"",leavePasages:"",excessiveCarLease:"",excessiveEpfContribution:"",withholdingTaxNotPaid:"",foreignExchangeLossUnrealised:"",provisionForExpenses:"",lossOnDisposalAssets:"",clubEntranceFees:"",taxPenalties:"",preCommencementExpenses:"",otherNonDeductible:""},taxRebates:{zakat:"",taxRebateIndividual:"",spouseRebate:"",departureLevyRebate:""}}),Ea=[{category:"Depreciation & Provisions",items:[{key:"depreciation",label:"Accounting Depreciation",tooltip:"Depreciation is not tax deductible. Claim Capital Allowance instead under Schedule 3 ITA 1967."},{key:"generalProvisionBadDebt",label:"General Bad Debt Provision",tooltip:"Only specific bad debts written off are deductible. General provisions must be added back."},{key:"provisionForExpenses",label:"General Provisions",tooltip:"Provisions for future expenses are not incurred and must be added back."},{key:"foreignExchangeLossUnrealised",label:"Unrealised Forex Loss",tooltip:"Only realised foreign exchange losses are deductible."}]},{category:"Entertainment Expenses",items:[{key:"entertainmentClients",label:"Entertainment (Clients) - 50%",tooltip:"Entertainment for existing clients/suppliers: only 50% is deductible. Add back the other 50%."},{key:"entertainmentPotential",label:"Entertainment (Potential Clients)",tooltip:"Entertainment for potential customers is 100% non-deductible per Section 39(1)(l) ITA."}]},{category:"Private & Capital Expenses",items:[{key:"privateExpenses",label:"Private/Domestic Expenses",tooltip:"Personal expenses like personal travel, home utilities, personal phone bills are not deductible."},{key:"capitalExpenditure",label:"Capital Expenditure in P&L",tooltip:"Capital items wrongly expensed (e.g., renovation, equipment) must be added back. Claim CA instead."},{key:"lossOnDisposalAssets",label:"Loss on Disposal of Assets",tooltip:"Loss on sale of capital assets is not deductible for tax purposes."},{key:"preCommencementExpenses",label:"Pre-Commencement Expenses",tooltip:"Expenses incurred before business commencement are capital in nature (except Schedule 4B items)."}]},{category:"Staff & Benefits",items:[{key:"leavePasages",label:"Leave Passages",tooltip:"Leave passages are not deductible except for yearly company events in Malaysia for employees."},{key:"excessiveEpfContribution",label:"Excess EPF (>19%)",tooltip:"Employer EPF contributions exceeding 19% of employee remuneration must be added back."},{key:"excessiveCarLease",label:"Excess Car Lease Rental",tooltip:"Car lease exceeding RM50,000 (or RM100,000 for cars RM150,000) per car per year is disallowed."}]},{category:"Fines, Donations & Others",items:[{key:"finesAndPenalties",label:"Fines & Penalties",tooltip:"All fines, penalties, compounds, and summons are not tax deductible."},{key:"taxPenalties",label:"Tax Penalties & Appeal Costs",tooltip:"Income tax penalties and costs of tax appeals are expressly disallowed."},{key:"donationsUnapproved",label:"Unapproved Donations",tooltip:"Only donations to LHDN-approved institutions are deductible. Unapproved donations must be added back."},{key:"clubEntranceFees",label:"Club Entrance/Membership",tooltip:"Club entrance fees and subscriptions are capital in nature and not deductible."}]},{category:"Payments to Non-Residents",items:[{key:"withholdingTaxNotPaid",label:"WHT Not Deducted",tooltip:"Payments to non-residents (royalties, fees, interest, rent) without deducting withholding tax are disallowed until WHT is paid."}]},{category:"Other Non-Deductible",items:[{key:"otherNonDeductible",label:"Other Non-Deductible",tooltip:"Any other expenses not wholly and exclusively incurred for business purposes."}]}],hr=u=>{const v={grossTax:0,zakat:0,netTax:0,taxableIncome:0,adjustedProfit:0,totalDeductions:0,capitalAllowance:0,brackets:[]};let b=0;if(Et.addBackExpenses&&Object.values(Et.addBackExpenses).forEach(T=>{b+=parseFloat(T)||0}),v.adjustedProfit=u+b,v.adjustedProfit<=0)return v;const S=parseFloat(Et.corporateDeductions?.capitalAllowanceManual)||0;if(v.capitalAllowance=S>0?S:ss(),v.totalDeductions=v.capitalAllowance,t==="ENTERPRISE"?Object.values(Et.personalDeductions).forEach(T=>{v.totalDeductions+=parseFloat(T)||0}):Object.entries(Et.corporateDeductions).forEach(([T,Q])=>{T!=="capitalAllowance"&&T!=="capitalAllowanceManual"&&(v.totalDeductions+=parseFloat(Q)||0)}),v.taxableIncome=Math.max(0,v.adjustedProfit-v.totalDeductions),v.taxableIncome<=0)return v;if(t==="SDN_BHD"){const{tier1Limit:T,tier1Rate:Q,tier2Rate:j}=Et.sdnBhd;if(v.taxableIncome<=T)v.grossTax=Math.round(v.taxableIncome*(Q/100)),v.brackets=[{range:`First RM${T.toLocaleString()}`,amount:v.taxableIncome,rate:Q,tax:v.grossTax}];else{const C=Math.round(T*(Q/100)),M=Math.round((v.taxableIncome-T)*(j/100));v.grossTax=C+M,v.brackets=[{range:`First RM${T.toLocaleString()}`,amount:T,rate:Q,tax:C},{range:`Balance RM${(v.taxableIncome-T).toLocaleString()}`,amount:v.taxableIncome-T,rate:j,tax:M}]}}if(t==="ENTERPRISE"){let T=0,Q=v.taxableIncome,j=0;const C=[{min:0,max:5e3,rate:0},{min:5001,max:2e4,rate:1},{min:20001,max:35e3,rate:3},{min:35001,max:5e4,rate:6},{min:50001,max:7e4,rate:11},{min:70001,max:1e5,rate:19},{min:100001,max:25e4,rate:25},{min:250001,max:4e5,rate:26},{min:400001,max:1/0,rate:28}];for(const M of Et.enterprise.brackets){if(Q<=0)break;const X=Math.min(Q,M.limit),ye=Math.round(X*(M.rate/100));T+=ye,X>0&&(C.find(Fe=>j>=Fe.min-1&&j<Fe.max)||C[C.length-1],v.brackets.push({range:`RM${(j+1).toLocaleString()} - RM${(j+X).toLocaleString()}`,amount:X,rate:M.rate,tax:ye})),j+=M.limit,Q-=M.limit}v.grossTax=Math.round(T)}return t==="BERHAD"&&(v.grossTax=Math.round(v.taxableIncome*(Et.berhad.rate/100)),v.brackets=[{range:"All chargeable income",amount:v.taxableIncome,rate:Et.berhad.rate,tax:v.grossTax}]),Et.taxRebates&&(v.zakat=Math.min(parseFloat(Et.taxRebates.zakat)||0,v.grossTax)),v.netTax=Math.max(0,v.grossTax-v.zakat),v},na=u=>hr(u).netTax,Ta=()=>Et.addBackExpenses?Object.values(Et.addBackExpenses).reduce((u,v)=>u+(parseFloat(v)||0),0):0,pn=()=>{if(!m)return null;const u=m.is.rev||0,v=m.is.cos||0,b=m.is.gp||0,S=m.is.oi||0,T=m.is.adm||0,Q=m.is.fin||0,j=b+S-T,C=m.is.pbt||0,M=m.is.tax||0,X=m.is.np||0,ye=m.bs.totA||0,Fe=m.bs.totL||0,Ce=m.bs.totE||0,J=m.bs.totCA||0,Y=m.bs.totCL||(m.bs.tp||0)+(m.bs.borr||0)+(m.bs.op||0)+(m.bs.taxPayable||0),ze=m.bs.totNCA||0,Le=m.bs.totNCL||m.bs.ltl||0,me=We.reduce((Ct,dr)=>Ct+(parseFloat(dr.amount)||0)-(parseFloat(dr.paid)||0),0),qe=Nt.reduce((Ct,dr)=>Ct+(parseFloat(dr.amount)||0)-(parseFloat(dr.paid)||0),0),Ye=Xe.reduce((Ct,dr)=>Ct+(parseFloat(dr.qty)||0)*(parseFloat(dr.unitCost)||0),0),ot=$a.reduce((Ct,dr)=>Ct+(parseFloat(dr.closingBalance)||0),0),Xt=m.is.py_rev||0,ct=m.is.py_np||0,ba=m.is.py_gp||0,nt=m.bs.py_totA||0,Aa=m.bs.py_totE||0,Wa=u>0?b/u*100:0,gn=u>0?X/u*100:0,Zn=u>0?j/u*100:0,Sa=Ce>0?X/Ce*100:0,vi=ye>0?X/ye*100:0,Da=Y>0?J/Y:J>0?999:0,Dn=Y>0?(J-Ye)/Y:0,Ii=Y>0?ot/Y:0,mr=u>0?me/u*365:0,Xr=v>0?qe/v*365:0,xn=v>0?Ye/v*365:0,On=mr+xn-Xr,Cr=Ce>0?Fe/Ce:0,ei=ye>0?Fe/ye:0,hs=Xt>0?(u-Xt)/Xt*100:0,Bi=ct!==0?(X-ct)/Math.abs(ct)*100:X>0?100:0,Zo=nt>0?(ye-nt)/nt*100:0,F0=Aa>0?(Ce-Aa)/Aa*100:0,cr=J-Y,At=[];return X>0?At.push({type:"success",icon:"",category:"Profitability",title:"Profitable Operation",text:`The company generated a net profit of RM ${ae(X)} for FY${L}.`,detail:`Net profit margin is ${gn.toFixed(1)}%, meaning RM ${(gn/100).toFixed(2)} is retained from every RM 1 of revenue.`}):X<0&&At.push({type:"danger",icon:"",category:"Profitability",title:"Loss-Making Operation",text:`The company incurred a net loss of RM ${ae(Math.abs(X))} for FY${L}.`,detail:"Urgent review of cost structure and revenue streams recommended. Consider cost-cutting measures or pricing strategy revision."}),Wa<20&&u>0?At.push({type:"warning",icon:"",category:"Profitability",title:"Low Gross Margin",text:`Gross margin is ${Wa.toFixed(1)}% which is below industry standard (20-30%).`,detail:"This may indicate: (1) High cost of goods, (2) Pricing pressure, (3) Inefficient production. Review supplier contracts and pricing strategy."}):Wa>40&&u>0&&At.push({type:"success",icon:"",category:"Profitability",title:"Strong Gross Margin",text:`Excellent gross margin at ${Wa.toFixed(1)}%.`,detail:"The company maintains strong pricing power and/or efficient cost management. This provides buffer for operating expenses."}),hs>15?At.push({type:"success",icon:"",category:"Growth",title:"Strong Revenue Growth",text:`Revenue grew ${hs.toFixed(1)}% from RM ${ae(Xt)} to RM ${ae(u)}.`,detail:"This growth rate exceeds typical market growth. Assess if growth is sustainable and whether infrastructure can support continued expansion."}):hs<-10&&Xt>0&&At.push({type:"danger",icon:"",category:"Growth",title:"Revenue Decline",text:`Revenue declined ${Math.abs(hs).toFixed(1)}% from RM ${ae(Xt)} to RM ${ae(u)}.`,detail:"Investigate causes: market conditions, lost customers, competitive pressure, or product lifecycle issues."}),Bi>20&&ct>0?At.push({type:"success",icon:"",category:"Growth",title:"Profit Growth Momentum",text:`Net profit increased ${Bi.toFixed(1)}% year-on-year.`,detail:"Profit growth outpacing revenue growth indicates improving operational efficiency and cost management."}):Bi<-20&&ct>0&&At.push({type:"danger",icon:"",category:"Growth",title:"Profit Erosion",text:`Net profit declined ${Math.abs(Bi).toFixed(1)}% year-on-year.`,detail:"Profit declining faster than revenue suggests cost pressures or margin compression. Review expense categories."}),Da<1?At.push({type:"danger",icon:"",category:"Liquidity",title:"Liquidity Risk",text:`Current ratio is ${Da.toFixed(2)}x (below 1.0).`,detail:`The company may struggle to meet short-term obligations. Current liabilities (RM ${ae(Y)}) exceed current assets (RM ${ae(J)}). Consider: (1) Accelerating receivables collection, (2) Extending payables terms, (3) Short-term financing.`}):Da>=1.5&&Da<999?At.push({type:"success",icon:"",category:"Liquidity",title:"Healthy Liquidity",text:`Current ratio of ${Da.toFixed(2)}x indicates strong short-term financial health.`,detail:"Sufficient current assets to cover current liabilities. Working capital position is sound."}):Da>3&&At.push({type:"warning",icon:"",category:"Liquidity",title:"Excess Liquidity",text:`Current ratio of ${Da.toFixed(2)}x may indicate excess idle assets.`,detail:"Consider deploying excess cash into productive investments or returning to shareholders."}),mr>60&&u>0&&At.push({type:"warning",icon:"",category:"Efficiency",title:"Slow Receivables Collection",text:`Days Sales Outstanding is ${mr.toFixed(0)} days.`,detail:"Cash is tied up in receivables. Review credit terms and collection procedures. Consider: (1) Tighter credit policy, (2) Early payment discounts, (3) Factoring."}),xn>90&&v>0&&At.push({type:"warning",icon:"",category:"Efficiency",title:"High Inventory Days",text:`Days Inventory Outstanding is ${xn.toFixed(0)} days.`,detail:"Inventory turnover is slow. Risk of obsolescence and storage costs. Review: (1) Demand forecasting, (2) SKU rationalization, (3) Supplier lead times."}),Cr>2?At.push({type:"warning",icon:"",category:"Leverage",title:"High Financial Leverage",text:`Debt-to-equity ratio is ${Cr.toFixed(2)}x.`,detail:"Heavy reliance on debt financing increases financial risk and interest burden. Consider equity injection or debt reduction."}):Cr<.5&&Cr>0&&At.push({type:"success",icon:"",category:"Leverage",title:"Conservative Capital Structure",text:`Low debt-to-equity ratio of ${Cr.toFixed(2)}x.`,detail:"Conservative financing provides financial flexibility. May consider strategic debt to optimize capital structure if growth opportunities exist."}),Sa>15?At.push({type:"success",icon:"",category:"Returns",title:"Strong Return on Equity",text:`ROE of ${Sa.toFixed(1)}% exceeds cost of equity benchmark.`,detail:"Shareholders are earning attractive returns. The business is creating value above the opportunity cost of capital."}):Sa<8&&Sa>0&&At.push({type:"warning",icon:"",category:"Returns",title:"Below-Average ROE",text:`ROE of ${Sa.toFixed(1)}% is below typical market returns.`,detail:"Returns may not justify the risk of equity investment. Review business model efficiency and capital allocation."}),{kpis:{revenue:u,cogs:v,grossProfit:b,operatingProfit:j,pbt:C,tax:M,pat:X,otherIncome:S,adminExpenses:T,financeExpenses:Q,totalAssets:ye,totalLiabilities:Fe,totalEquity:Ce,currentAssets:J,currentLiabilities:Y,nonCurrentAssets:ze,nonCurrentLiabilities:Le,arTotal:me,apTotal:qe,inventoryTotal:Ye,cashTotal:ot,workingCapital:cr},ratios:{grossMargin:Wa,netMargin:gn,operatingMargin:Zn,roe:Sa,roa:vi,currentRatio:Da,quickRatio:Dn,cashRatio:Ii,dso:mr,dpo:Xr,dio:xn,ccc:On,debtToEquity:Cr,debtToAssets:ei,revenueGrowth:hs,profitGrowth:Bi,assetGrowth:Zo,equityGrowth:F0},comparatives:{pyRevenue:Xt,pyPat:ct,pyGp:ba,pyTotalAssets:nt,pyTotalEquity:Aa},insights:At}},[Ut,ns]=dt.useState([]),[kn,is]=dt.useState({name:"",accNo:""}),[Yt,wi]=dt.useState(""),[Ha,Wr]=dt.useState("Jan"),[wn,Er]=dt.useState({}),[ci,Ys]=dt.useState(""),[Rn,Xn]=dt.useState("manual"),[p0,Dl]=dt.useState(null),[gr,Ri]=dt.useState([]),[Ol,Il]=dt.useState({}),[D,W]=dt.useState(""),P=()=>{const u=[];return Gt.income.revenue.forEach(v=>{u.push({id:v.id,label:v.label,value:"",type:"revenue",section:"revenue"})}),Gt.income.cost_of_sales.forEach(v=>{u.push({id:v.id,label:v.label,value:"",type:"cogs",section:"cost_of_sales"})}),Gt.income.operating_expenses.forEach(v=>{u.push({id:v.id,label:v.label,value:"",type:"expense",section:"operating_expenses",group:v.group})}),Gt.income.other_income.forEach(v=>{u.push({id:v.id,label:v.label,value:"",type:"other_income",section:"other_income"})}),Gt.income.other_expenses.forEach(v=>{u.push({id:v.id,label:v.label,value:"",type:"other_expense",section:"other_expenses"})}),Gt.income.finance_costs.forEach(v=>{u.push({id:v.id,label:v.label,value:"",type:"finance",section:"finance_costs"})}),u.push({id:"TAX_EXPENSE",label:"Tax Expense",value:"",type:"tax",section:"tax"}),u},U=()=>{const u=[];return Gt.balance.non_current_assets.forEach(v=>{u.push({id:v.id,label:v.label,value:"",type:"nca",section:"non_current_assets"})}),Gt.balance.current_assets.forEach(v=>{u.push({id:v.id,label:v.label,value:"",type:"ca",section:"current_assets"})}),Gt.balance.non_current_liabilities.forEach(v=>{u.push({id:v.id,label:v.label,value:"",type:"ncl",section:"non_current_liabilities"})}),Gt.balance.current_liabilities.forEach(v=>{u.push({id:v.id,label:v.label,value:"",type:"cl",section:"current_liabilities"})}),Gt.balance.equity.filter(v=>v.id!=="CURRENT_YEAR_PROFIT").forEach(v=>{u.push({id:v.id,label:v.label,value:"",type:"equity",section:"equity"})}),u},[G,V]=dt.useState(P),[xe,Re]=dt.useState(U),[Ee,Te]=dt.useState(""),ge={LAND:{label:"Land",years:0,rate:0},BUILDING:{label:"Buildings",years:50,rate:2},RENOVATION:{label:"Renovation & Improvements",years:10,rate:10},PLANT_MACHINERY:{label:"Plant & Machinery",years:10,rate:10},FACTORY_EQUIPMENT:{label:"Factory Equipment",years:10,rate:10},OFFICE_EQUIPMENT:{label:"Office Equipment",years:10,rate:10},FURNITURE_FITTINGS:{label:"Furniture & Fittings",years:10,rate:10},MOTOR_VEHICLES:{label:"Motor Vehicles",years:5,rate:20},COMPUTER_EQUIPMENT:{label:"Computer & IT Equipment",years:3,rate:33.33},ELECTRICAL_FITTINGS:{label:"Electrical Fittings",years:10,rate:10},AIR_CONDITIONING:{label:"Air Conditioning",years:10,rate:10},SIGNBOARD:{label:"Signboard",years:10,rate:10},TOOLS_EQUIPMENT:{label:"Tools & Small Equipment",years:5,rate:20}},[De,Ve]=dt.useState([]),[Xe,Ge]=dt.useState([]),[We,it]=dt.useState([]),[Nt,Wt]=dt.useState([]),[Vt,sr]=dt.useState([]),[Or,Vr]=dt.useState([]),[$a,Nn]=dt.useState([]),[ya,di]=dt.useState([]),[Ga,xr]=dt.useState([]),h0=()=>{const u=`ppe_${Date.now()}`;Ve(v=>[...v,{id:u,description:"",category:"OFFICE_EQUIPMENT",acquisitionDate:"",cost:0,residualValue:0,accDepBF:0}])},Bl=(u,v,b)=>{Ve(S=>S.map(T=>T.id===u?{...T,[v]:b}:T))},Oo=u=>Ve(v=>v.filter(b=>b.id!==u)),Ws=u=>{const v=parseFloat(u.cost)||0,b=parseFloat(u.residualValue)||0,S=parseFloat(u.accDepBF)||0,Q=(ge[u.category]||ge.OFFICE_EQUIPMENT).years;if(Q===0)return{depreciableAmount:0,annualDep:0,currentDep:0,accDepCF:0,nbv:v};const j=v-b,C=j/Q,X=Math.max(0,j-S),ye=Math.min(C,X),Fe=S+ye,Ce=v-Fe;return{depreciableAmount:j,annualDep:C,currentDep:ye,accDepCF:Fe,nbv:Ce}},fi={LAND:{ia:0,aa:0,label:"Land (No CA)"},BUILDING:{ia:10,aa:3,label:"Industrial Building"},RENOVATION:{ia:0,aa:0,label:"Renovation (S.Deduction)"},PLANT_MACHINERY:{ia:20,aa:14,label:"Plant & Machinery"},FACTORY_EQUIPMENT:{ia:20,aa:14,label:"Factory Equipment"},OFFICE_EQUIPMENT:{ia:20,aa:10,label:"Office Equipment"},FURNITURE_FITTINGS:{ia:20,aa:10,label:"Furniture & Fittings"},MOTOR_VEHICLES:{ia:20,aa:20,label:"Motor Vehicles"},COMPUTER_EQUIPMENT:{ia:20,aa:40,label:"Computer/ICT Equipment"},ELECTRICAL_FITTINGS:{ia:20,aa:10,label:"Electrical Fittings"},AIR_CONDITIONING:{ia:20,aa:10,label:"Air Conditioning"},SIGNBOARD:{ia:20,aa:10,label:"Signboard"},TOOLS_EQUIPMENT:{ia:20,aa:20,label:"Tools & Equipment"},HEAVY_MACHINERY:{ia:20,aa:10,label:"Heavy Machinery"},ENVIRONMENTAL:{ia:40,aa:20,label:"Environmental Equipment"},SMALL_VALUE:{ia:0,aa:100,label:"Small Value Asset (<RM2000)"}},[en,Tr]=dt.useState([]),Io=()=>{const u=`ca_${Date.now()}`;Tr(v=>[...v,{id:u,acquisitionDate:"",description:"",category:"OFFICE_EQUIPMENT",cost:0}])},Vs=(u,v,b)=>{Tr(S=>S.map(T=>T.id===u?{...T,[v]:b}:T))},Bo=u=>{Tr(v=>v.filter(b=>b.id!==u))},Fn=u=>{const v=parseFloat(u.cost)||0,b=fi[u.category]||fi.OFFICE_EQUIPMENT,S=parseInt(L)||new Date().getFullYear();let T=S;if(u.acquisitionDate){const X=new Date(u.acquisitionDate);isNaN(X.getTime())||(T=X.getFullYear())}const Q=T>=S,j=Q?v*(b.ia/100):0,C=v*(b.aa/100),M=j+C;return{ia:j,aa:C,totalCA:M,isCurrentYear:Q,rates:b}},ss=()=>en.reduce((u,v)=>{const b=Fn(v);return u+b.totalCA},0),Ml=()=>en.reduce((u,v)=>u+(parseFloat(v.cost)||0),0),ui=()=>De.reduce((u,v)=>u+(parseFloat(v.cost)||0),0),Ll=()=>Math.abs(Ml()-ui())<.01,g0=()=>{const u=`inv_${Date.now()}`;Ge(v=>[...v,{id:u,itemCode:"",description:"",qty:0,unitCost:0,category:"Raw Materials"}])},Xs=(u,v,b)=>{Ge(S=>S.map(T=>T.id===u?{...T,[v]:b}:T))},Mo=u=>Ge(v=>v.filter(b=>b.id!==u)),cf=()=>{const u=`ar_${Date.now()}`;it(v=>[...v,{id:u,customerName:"",invoiceNo:"",invoiceDate:"",dueDate:"",amount:0,paid:0}])},Pl=(u,v,b)=>{it(S=>S.map(T=>T.id===u?{...T,[v]:b}:T))},zl=u=>it(v=>v.filter(b=>b.id!==u)),qn=()=>{const u=`ap_${Date.now()}`;Wt(v=>[...v,{id:u,supplierName:"",invoiceNo:"",invoiceDate:"",dueDate:"",amount:0,paid:0}])},ls=(u,v,b)=>{Wt(S=>S.map(T=>T.id===u?{...T,[v]:b}:T))},Lo=u=>Wt(v=>v.filter(b=>b.id!==u)),os=()=>{const u=`od_${Date.now()}`;sr(v=>[...v,{id:u,description:"",type:"DEPOSIT",amount:0,remarks:""}])},pi=(u,v,b)=>{sr(S=>S.map(T=>T.id===u?{...T,[v]:b}:T))},x0=u=>sr(v=>v.filter(b=>b.id!==u)),Po=()=>{const u=`oc_${Date.now()}`;Vr(v=>[...v,{id:u,description:"",type:"ACCRUAL",amount:0,remarks:""}])},Ul=(u,v,b)=>{Vr(S=>S.map(T=>T.id===u?{...T,[v]:b}:T))},qs=u=>Vr(v=>v.filter(b=>b.id!==u)),Kn=()=>{const u=`cb_${Date.now()}`;Nn(v=>[...v,{id:u,accountName:"",bankName:"",accountNo:"",openingBalance:0,closingBalance:0,reconciled:!1}])},Ks=(u,v,b)=>{Nn(S=>S.map(T=>T.id===u?{...T,[v]:b}:T))},Js=u=>Nn(v=>v.filter(b=>b.id!==u)),hi=()=>{const u=`stb_${Date.now()}`;di(v=>[...v,{id:u,lender:"",loanType:"SHORT_TERM_LOAN",loanNo:"",openingBalance:0,drawdown:0,repayment:0,interestRate:0,remarks:""}])},Ni=(u,v,b)=>{di(S=>S.map(T=>T.id===u?{...T,[v]:b}:T))},Hl=u=>di(v=>v.filter(b=>b.id!==u)),m0=()=>{const u=`ltb_${Date.now()}`;xr(v=>[...v,{id:u,lender:"",loanType:"TERM_LOAN",loanNo:"",openingBalance:0,drawdown:0,repayment:0,interestRate:0,tenureMonths:60,startDate:"",remarks:""}])},gi=(u,v,b)=>{xr(S=>S.map(T=>T.id===u?{...T,[v]:b}:T))},$l=u=>xr(v=>v.filter(b=>b.id!==u)),rt=E2.useMemo(()=>{const u=De.reduce((J,Y)=>{const ze=parseFloat(Y.cost)||0,Le=parseFloat(Y.accDepBF)||0,me=Ws(Y);return{cost:J.cost+ze,accDepBF:J.accDepBF+Le,currentDep:J.currentDep+me.currentDep,accDepCF:J.accDepCF+me.accDepCF,nbv:J.nbv+me.nbv}},{cost:0,accDepBF:0,currentDep:0,accDepCF:0,nbv:0}),v=Xe.reduce((J,Y)=>{const ze=parseFloat(Y.qty)||0,Le=parseFloat(Y.unitCost)||0;return J+ze*Le},0),b=We.reduce((J,Y)=>{const ze=parseFloat(Y.amount)||0,Le=parseFloat(Y.paid)||0;return J+(ze-Le)},0),S=Nt.reduce((J,Y)=>{const ze=parseFloat(Y.amount)||0,Le=parseFloat(Y.paid)||0;return J+(ze-Le)},0),T=Vt.reduce((J,Y)=>J+(parseFloat(Y.amount)||0),0),Q=Or.reduce((J,Y)=>J+(parseFloat(Y.amount)||0),0),j=$a.reduce((J,Y)=>J+(parseFloat(Y.closingBalance)||0),0),C=ya.reduce((J,Y)=>{const ze=parseFloat(Y.openingBalance)||0,Le=parseFloat(Y.drawdown)||0,me=parseFloat(Y.repayment)||0;return J+(ze+Le-me)},0),M=Ga.reduce((J,Y)=>{const ze=parseFloat(Y.openingBalance)||0,Le=parseFloat(Y.drawdown)||0,me=parseFloat(Y.repayment)||0;return J+(ze+Le-me)},0),X=ya.reduce((J,Y)=>J+(parseFloat(Y.drawdown)||0),0)+Ga.reduce((J,Y)=>J+(parseFloat(Y.drawdown)||0),0),ye=ya.reduce((J,Y)=>J+(parseFloat(Y.repayment)||0),0)+Ga.reduce((J,Y)=>J+(parseFloat(Y.repayment)||0),0),Fe=ya.reduce((J,Y)=>J+(parseFloat(Y.openingBalance)||0),0),Ce=Ga.reduce((J,Y)=>J+(parseFloat(Y.openingBalance)||0),0);return{ppe:u,inventory:v,receivables:b,payables:S,otherDebtors:T,otherCreditors:Q,cashBank:j,shortTermBorrowings:C,longTermBorrowings:M,borrowingsDrawdowns:X,borrowingsRepayments:ye,stBorrOpening:Fe,ltBorrOpening:Ce,hasSTBorrowings:ya.length>0,hasLTBorrowings:Ga.length>0}},[De,Xe,We,Nt,Vt,Or,$a,ya,Ga]),Ya=(u="expense")=>{const v=`custom_is_${Date.now()}`;V(b=>[...b,{id:v,label:"New Item",value:"",type:u,mapped:"",custom:!0}])},hn=(u="ca")=>{const v=`custom_bs_${Date.now()}`;Re(b=>[...b,{id:v,label:"New Item",value:"",type:u,mapped:"",custom:!0}])},Jn=u=>V(v=>v.filter(b=>b.id!==u)),Qn=u=>Re(v=>v.filter(b=>b.id!==u)),Ir=(u,v,b)=>{V(S=>S.map(T=>T.id===u?{...T,[v]:b}:T))},tn=(u,v,b)=>{Re(S=>S.map(T=>T.id===u?{...T,[v]:b}:T))},zo=async u=>{const v=u.target.files[0];if(!v)return;Dl(v);const b=v.name.toLowerCase();try{if(b.endsWith(".xlsx")||b.endsWith(".xls")){const S=await v.arrayBuffer(),T=Jd(S,{type:"array",cellDates:!0}),Q=[];T.SheetNames.forEach((j,C)=>{const M=T.Sheets[j];va.sheet_to_json(M,{header:1,defval:""}).forEach((ye,Fe)=>{if(!Array.isArray(ye)||ye.length<2)return;let Ce="",J=null;ye.forEach(Y=>{if(Y==null||Y==="")return;const ze=String(Y).trim(),Le=ze.replace(/[,\s()RM$]/gi,""),me=parseFloat(Le);!isNaN(me)&&J===null&&Le!==""?J=ze.includes("(")?-Math.abs(me):me:ze&&!Ce&&isNaN(parseFloat(ze.replace(/[,\s]/g,"")))&&(Ce=ze)}),Ce&&J!==null&&Q.push({idx:Q.length,label:Ce,value:J,cells:ye.map(Y=>String(Y||"")),sheet:j,sheetIdx:C})})}),Ri(Q),ke(j=>[...j,{t:"ok",m:` Excel: ${Q.length} items from ${T.SheetNames.length} sheets (${T.SheetNames.join(", ")})`}])}else if(b.endsWith(".pdf"))ke(S=>[...S,{t:"warn",m:" PDF detected. Please open the PDF, copy (Ctrl+A, Ctrl+C) and paste the text below."}]),Ri([]),Xn("upload");else{const T=(await v.text()).split(`
`).filter(j=>j.trim()),Q=[];T.forEach((j,C)=>{const M=j.split(/[,\t]/).map(X=>X.trim().replace(/^["']|["']$/g,""));if(M.length>=2){let X="",ye=null;M.forEach(Fe=>{const Ce=Fe.replace(/[,\s()RM$]/gi,""),J=parseFloat(Ce);!isNaN(J)&&ye===null&&Ce!==""?ye=Fe.includes("(")?-Math.abs(J):J:Fe&&!X&&isNaN(parseFloat(Fe.replace(/[,\s]/g,"")))&&(X=Fe)}),X&&ye!==null&&Q.push({idx:C,label:X,value:ye,cells:M})}}),Ri(Q),ke(j=>[...j,{t:"ok",m:` Parsed ${Q.length} line items from ${v.name}`}])}}catch(S){ke(T=>[...T,{t:"err",m:` Error reading file: ${S.message}`}])}},Qs=u=>{if(!u.trim())return;const v=u.split(`
`).filter(S=>S.trim()),b=[];v.forEach((S,T)=>{if(S.match(/^(note|rm|page|\d{4}|total|as at|for the)/i)&&S.length<50)return;const Q=S.match(/^(.+?)\s+([\d,]+(?:\.\d{2})?)\s*(?:[\d,]+(?:\.\d{2})?)?\s*$/),j=S.match(/^(.+?)\s+\(([\d,]+(?:\.\d{2})?)\)\s*$/),C=S.match(/^([A-Za-z][A-Za-z\s&,\-]+?)\s{2,}([\d,]+(?:\.\d{2})?)/);let M="",X=null;j?(M=j[1].trim(),X=-parseFloat(j[2].replace(/,/g,""))):Q?(M=Q[1].trim(),X=parseFloat(Q[2].replace(/,/g,""))):C&&(M=C[1].trim(),X=parseFloat(C[2].replace(/,/g,""))),M&&X!==null&&M.length>2&&!M.match(/^\d+$/)&&Math.abs(X)>0&&b.push({idx:b.length,label:M,value:X,source:"pdf"})}),Ri(b),ke(S=>[...S,{t:"ok",m:` Parsed ${b.length} items from pasted text`}])},Gl=()=>{const u={SALES:["revenue","sales","turnover","income from operations","jualan","pendapatan"],PURCHASE:["cost of sales","cost of goods","cogs","direct costs","kos jualan","purchase"],DIRECT_LABOUR:["direct labour","direct labor","buruh langsung"],DEPRECIATION:["depreciation","susutnilai","amortisation","amortization"],SALARY:["salary","wages","staff cost","employee","gaji"],RENT:["rental","rent","sewa"],UTILITIES:["utility","utilities","electric","water","tnb","air"],INTEREST_INC:["interest income","pendapatan faedah"],INTEREST_EXP:["interest expense","finance cost","borrowing cost","kos kewangan","faedah"],TAX_EXPENSE:["tax","taxation","income tax","cukai"],PPE:["property plant equipment","ppe","fixed asset","net book value","nbv","aset tetap"],INTANGIBLES:["intangible","goodwill","trademark"],INVESTMENTS:["investment","pelaburan"],INVENTORY:["inventory","stock","inventories","inventori"],TRADE_RECEIVABLES:["trade receivable","accounts receivable","debtors","penghutang dagangan"],OTHER_RECEIVABLES:["other receivable","prepaid","deposit","penghutang lain"],CASH_BANK:["cash","bank","cash and cash equivalent","tunai"],LONG_TERM_LOAN:["long term","term loan","long-term borrowing","pinjaman jangka panjang"],DEFERRED_TAX:["deferred tax","cukai tertunda"],SHORT_TERM_LOAN:["short term borrowing","bank overdraft","pinjaman jangka pendek","loan"],TRADE_PAYABLES:["trade payable","accounts payable","creditors","pemiutang dagangan"],OTHER_PAYABLES:["other payable","accrual","accrued","pemiutang lain"],TAX_PAYABLE:["tax payable","cukai kena bayar"],SHARE_CAPITAL:["share capital","issued capital","paid-up capital","modal saham"],RETAINED_PROFITS:["retained","accumulated profit","retained earning","keuntungan terkumpul"]};let v=0;const b=["SALES","SERVICE_REVENUE","PURCHASE","DIRECT_COSTS","SALARY","RENT","UTILITIES","DEPRECIATION","OFFICE_SUPPLIES","PROFESSIONAL_FEES","MARKETING","TRANSPORT","ENTERTAINMENT","INSURANCE","REPAIR_MAINTENANCE","TELEPHONE","BANK_CHARGES","MISC_EXPENSE","INTEREST_EXP","TAX_EXPENSE","PPE","INTANGIBLES","INVESTMENTS","INVENTORY","TRADE_RECEIVABLES","OTHER_RECEIVABLES","CASH_BANK","LONG_TERM_LOAN","DEFERRED_TAX","SHORT_TERM_LOAN","TRADE_PAYABLES","OTHER_PAYABLES","TAX_PAYABLE","SHARE_CAPITAL","RETAINED_PROFITS"];V(S=>S.map(T=>{const Q=u[T.id]||[T.label.toLowerCase()],j=gr.find(C=>Q.some(M=>C.label.toLowerCase().includes(M)));if(j){v++;const C=b.includes(T.id)?Math.abs(j.value):j.value;return{...T,value:String(C),mapped:j.label}}return T})),Re(S=>S.map(T=>{const Q=u[T.id]||[T.label.toLowerCase()],j=gr.find(C=>Q.some(M=>C.label.toLowerCase().includes(M)));if(j){v++;const C=b.includes(T.id)?Math.abs(j.value):j.value;return{...T,value:String(C),mapped:j.label}}return T})),ke(S=>[...S,{t:"ok",m:` Auto-mapped ${v} items`}])},at=(()=>{const u={revenue:0,cos:0,depreciation:0,admin:0,oi:0,oe:0,fin:0,tax:0};return G.forEach(v=>{const b=parseFloat(v.value)||0;v.section==="revenue"||v.type==="revenue"?u.revenue+=b:v.section==="cost_of_sales"||v.type==="cogs"?u.cos+=b:v.section==="operating_expenses"||v.type==="expense"?(v.id==="DEPRECIATION"&&(u.depreciation+=b),u.admin+=b):v.section==="other_income"||v.type==="other_income"?u.oi+=b:v.section==="other_expenses"||v.type==="other_expense"?u.oe+=b:v.section==="finance_costs"||v.type==="finance"?u.fin+=b:(v.section==="tax"||v.type==="tax")&&(u.tax+=b)}),u.gp=u.revenue-u.cos,u.totalAdminWithDep=u.admin,u.op=u.gp-u.admin,u.pbt=u.op+u.oi-u.oe-u.fin,u.np=u.pbt-u.tax,u.nca=0,u.ca=0,u.ncl=0,u.cl=0,u.equity=0,u.ppe=0,u.intangibles=0,u.investments=0,u.bank=0,u.tr=0,u.or=0,u.inv=0,u.ltLoan=0,u.defTax=0,u.loan=0,u.tp=0,u.op_pay=0,u.taxPay=0,u.gstSst=0,u.cap=0,u.ret=0,u.reserves=0,xe.forEach(v=>{const b=parseFloat(v.value)||0;v.type==="nca"?u.nca+=b:v.type==="ca"?u.ca+=b:v.type==="ncl"?u.ncl+=b:v.type==="cl"?u.cl+=b:v.type==="equity"&&(u.equity+=b),v.id==="PPE"&&(u.ppe=b),v.id==="INTANGIBLES"&&(u.intangibles=b),v.id==="INVESTMENTS"&&(u.investments=b),v.id==="CASH_BANK"&&(u.bank=b),v.id==="TRADE_RECEIVABLES"&&(u.tr=b),v.id==="OTHER_RECEIVABLES"&&(u.or=b),v.id==="INVENTORY"&&(u.inv=b),v.id==="LONG_TERM_LOAN"&&(u.ltLoan=b),v.id==="DEFERRED_TAX"&&(u.defTax=b),v.id==="SHORT_TERM_LOAN"&&(u.loan=b),v.id==="TRADE_PAYABLES"&&(u.tp=b),v.id==="OTHER_PAYABLES"&&(u.op_pay=b),v.id==="TAX_PAYABLE"&&(u.taxPay=b),v.id==="GST_SST_PAYABLE"&&(u.gstSst=b),v.id==="SHARE_CAPITAL"&&(u.cap=b),v.id==="RETAINED_PROFITS"&&(u.ret=b)}),u.totA=u.nca+u.ca,u.totL=u.ncl+u.cl,u.totE=u.equity,u.totLE=u.totL+u.totE,u.diff=u.totA-u.totLE,u.balanced=Math.abs(u.diff)<1,u})(),cs={revenue:String(at.revenue),cost_of_sales:String(at.cos),admin_expenses:String(at.admin),other_income:String(at.oi),finance_costs:String(at.fin),tax:String(at.tax)},Tt={ppe:String(at.ppe),intangibles:String(at.intangibles),investments:String(at.investments),bank:String(at.bank),trade_receivables:String(at.tr),other_receivables:String(at.or),inventory:String(at.inv),long_term_loan:String(at.ltLoan),deferred_tax:String(at.defTax),loan:String(at.loan),trade_payables:String(at.tp),other_payables:String(at.op_pay),tax_payable:String(at.taxPay),share_capital:String(at.cap),retained_profits:String(at.ret),reserves:String(at.reserves)},df=()=>{if(kn.name){const u=kn.name.toLowerCase().replace(/\s+/g,"_");ns(b=>[...b,{id:u,name:kn.name,accNo:kn.accNo}]);const v={};ni.forEach(b=>{v[b]={uploaded:!1,txCount:0,file:null}}),Er(b=>({...b,[u]:v})),is({name:"",accNo:""}),ke(b=>[...b,{t:"ok",m:` Added bank: ${kn.name}`}])}},Yl=(u,v)=>{const S=Ut.find(Q=>Q.id===u)?.name||u,T=_.filter(Q=>Q.bankAccount===S&&Q.month===v);if(T.length===0){ke(Q=>[...Q,{t:"warn",m:` No transactions found for ${S} - ${v}`}]);return}w(Q=>Q.filter(j=>!(j.bankAccount===S&&j.month===v))),Er(Q=>({...Q,[u]:{...Q[u],[v]:{uploaded:!1,txCount:0,file:null}}})),ke(Q=>[...Q,{t:"ok",m:` Removed ${T.length} transactions (${S} - ${v})`}])},ff=async u=>{const v=Array.from(u.target.files||[]);if(!v.length||!Yt)return;Pe(!0);let b=[...tt];for(const S of v){try{const T=S.type==="application/pdf"||S.name.toLowerCase().endsWith(".pdf"),Q=S.name.toLowerCase().endsWith(".xlsx")||S.name.toLowerCase().endsWith(".xls");if(T)b.push({t:"info",m:` PDF detected: ${S.name}`}),b.push({t:"warn",m:" PDF parsing requires manual text extraction. Please copy text from PDF and paste below."}),ke([...b]),Er(j=>({...j,[Yt]:{...j[Yt],[Ha]:{uploaded:!0,txCount:0,file:S.name,needsManual:!0}}}));else if(Q){const j=`Reading Excel: ${S.name}...`;b.push({t:"info",m:j}),ke([...b]);const C=await S.arrayBuffer(),M=Jd(C,{type:"array",cellDates:!0}),X=M.SheetNames[0],ye=M.Sheets[X],Ce=va.sheet_to_json(ye,{header:1,defval:""}).map(ze=>ze.join(",")).join(`
`),J=Ut.find(ze=>ze.id===Yt),Y=wp(Ce,S.name,J?.name||Yt,Ha,L);b=b.filter(ze=>ze.m!==j),Y.length>0?(w(ze=>[...ze,...Y]),Er(ze=>({...ze,[Yt]:{...ze[Yt],[Ha]:{uploaded:!0,txCount:Y.length,file:S.name}}})),b.push({t:"ok",m:` ${S.name}: ${Y.length} transactions (${J?.name} - ${Ha})`})):b.push({t:"warn",m:` ${S.name}: No transactions found`})}else{const j=`Reading: ${S.name}...`;b.push({t:"info",m:j}),ke([...b]);const C=await S.text(),M=Ut.find(ye=>ye.id===Yt),X=wp(C,S.name,M?.name||Yt,Ha,L);b=b.filter(ye=>ye.m!==j),X.length>0?(w(ye=>[...ye,...X]),Er(ye=>({...ye,[Yt]:{...ye[Yt],[Ha]:{uploaded:!0,txCount:X.length,file:S.name}}})),b.push({t:"ok",m:` ${S.name}: ${X.length} transactions (${M?.name} - ${Ha})`})):b.push({t:"warn",m:` ${S.name}: No transactions found`})}}catch(T){b=b.filter(Q=>!Q.m.includes("Reading:")),b.push({t:"err",m:` ${S.name}: ${T.message}`})}ke([...b])}Pe(!1),Ze.current&&(Ze.current.value="")},uf=()=>{if(!ci.trim()||!Yt)return;const u=Ut.find(b=>b.id===Yt),v=wp(ci,"PDF-Paste",u?.name||Yt,Ha,L);v.length>0?(w(b=>[...b,...v]),Er(b=>({...b,[Yt]:{...b[Yt],[Ha]:{uploaded:!0,txCount:v.length,file:"Pasted PDF text"}}})),ke(b=>[...b,{t:"ok",m:` Parsed ${v.length} transactions from pasted text (${u?.name} - ${Ha})`}]),Ys("")):ke(b=>[...b,{t:"warn",m:" No transactions found in pasted text"}])},pf=()=>{const u={};if(Tt.ppe){const v=parseFloat(Tt.ppe)||0;u.fixed_asset=v,u.accumulated_depreciation=0}Tt.trade_receivables&&(u.trade_receivables=parseFloat(Tt.trade_receivables)||0),Tt.inventory&&(u.inventory=parseFloat(Tt.inventory)||0),Tt.other_receivables&&(u.other_receivables=parseFloat(Tt.other_receivables)||0),Tt.bank&&(Ut.length>0?u[`bank_${Ut[0].name.toLowerCase().replace(/\s+/g,"_")}`]=parseFloat(Tt.bank)||0:u.bank=parseFloat(Tt.bank)||0),Tt.long_term_loan&&(u.long_term_loan=-(parseFloat(Tt.long_term_loan)||0)),Tt.loan&&(u.loan=-(parseFloat(Tt.loan)||0)),Tt.trade_payables&&(u.trade_payables=-(parseFloat(Tt.trade_payables)||0)),Tt.other_payables&&(u.other_payables=-(parseFloat(Tt.other_payables)||0)),Tt.tax_payable&&(u.tax_payable=-(parseFloat(Tt.tax_payable)||0)),Tt.share_capital&&(u.share_capital=-(parseFloat(Tt.share_capital)||0)),Tt.retained_profits&&(u.retained_profits=-(parseFloat(Tt.retained_profits)||0)),Tt.reserves&&(u.reserves=-(parseFloat(Tt.reserves)||0)),oe(u),ke(v=>[...v,{t:"ok",m:` Prior year (${fe}) balances applied`}]),ke(v=>[...v,{t:"warn",m:" PPE set as NBV. Update PPE register with actual cost/acc dep for accurate depreciation."}])},hf=()=>{i("SDN_BHD"),c("ABC Trading Sdn Bhd"),p("202401012345"),h("12"),A("MPERS"),K(2024),Je(2023),ns(Ym);const u={};Ym.forEach(S=>{u[S.id]={},ni.forEach(T=>{u[S.id][T]={uploaded:!1,txCount:0,file:null}})}),u.maybank.Jan={uploaded:!0,txCount:2,file:"Sample"},u.maybank.Feb={uploaded:!0,txCount:1,file:"Sample"},u.maybank.Mar={uploaded:!0,txCount:1,file:"Sample"},u.cimb.Feb={uploaded:!0,txCount:1,file:"Sample"},u.cimb.Mar={uploaded:!0,txCount:1,file:"Sample"},Er(u),w(R8);const v=P();v.forEach(S=>{S.id==="SALES"?S.value="500000":S.id==="PURCHASE"?S.value="280000":S.id==="FREIGHT_IN"?S.value="20000":S.id==="SALARY"?S.value="50000":S.id==="EPF"?S.value="6000":S.id==="SOCSO"?S.value="1000":S.id==="RENT"?S.value="12000":S.id==="UTILITIES"?S.value="5000":S.id==="DEPRECIATION"?S.value="8000":S.id==="INTEREST_INC"?S.value="2000":S.id==="BANK_CHARGES"?S.value="1500":S.id==="INTEREST_EXP"?S.value="3500":S.id==="TAX_EXPENSE"&&(S.value="28250")}),V(v);const b=U();b.forEach(S=>{S.id==="PPE"?S.value="92000":S.id==="INVENTORY"?S.value="35000":S.id==="TRADE_RECEIVABLES"?S.value="45000":S.id==="OTHER_RECEIVABLES"?S.value="12000":S.id==="CASH_BANK"?S.value="100000":S.id==="SHORT_TERM_LOAN"?S.value="50000":S.id==="TRADE_PAYABLES"?S.value="25000":S.id==="OTHER_PAYABLES"?S.value="9000":S.id==="TAX_PAYABLE"?S.value="10000":S.id==="SHARE_CAPITAL"?S.value="100000":S.id==="RETAINED_PROFITS"&&(S.value="90000")}),Re(b),oe({fixed_asset:12e4,accumulated_depreciation:-28e3,inventory:35e3,trade_receivables:45e3,other_receivables:12e3,bank_maybank:7e4,bank_cimb:3e4,loan:-5e4,trade_payables:-25e3,other_payables:-9e3,tax_payable:-1e4,share_capital:-1e5,retained_profits:-9e4}),Ve([{id:"ppe_1",description:"Office Computer (Dell Desktop)",category:"OFFICE_EQUIPMENT",acquisitionDate:"2022-01-01",cost:5e3,residualValue:500,accDepBF:2250},{id:"ppe_2",description:"Office Furniture & Fittings",category:"FURNITURE_FITTINGS",acquisitionDate:"2021-01-01",cost:15e3,residualValue:1500,accDepBF:4050},{id:"ppe_3",description:"Company Vehicle (Proton X70)",category:"MOTOR_VEHICLES",acquisitionDate:"2022-07-01",cost:1e5,residualValue:2e4,accDepBF:21700}]),Ge([{id:"inv_1",itemCode:"SKU-001",description:"Product A - Widget Standard",qty:100,unitCost:120,category:"Finished Goods"},{id:"inv_2",itemCode:"SKU-002",description:"Product B - Widget Premium",qty:50,unitCost:200,category:"Finished Goods"},{id:"inv_3",itemCode:"RAW-001",description:"Raw Material - Steel Sheet",qty:100,unitCost:80,category:"Raw Materials"},{id:"inv_4",itemCode:"RAW-002",description:"Raw Material - Plastic Pellets",qty:300,unitCost:10,category:"Raw Materials"}]),it([{id:"ar_1",customerName:"XYZ Enterprise Sdn Bhd",invoiceNo:"INV-2023-088",invoiceDate:"2023-11-15",dueDate:"2023-12-14",amount:2e4,paid:0},{id:"ar_2",customerName:"ABC Trading Co",invoiceNo:"INV-2023-092",invoiceDate:"2023-12-01",dueDate:"2024-01-01",amount:15e3,paid:0},{id:"ar_3",customerName:"DEF Industries",invoiceNo:"INV-2023-095",invoiceDate:"2023-12-20",dueDate:"2024-01-19",amount:1e4,paid:0}]),Wt([{id:"ap_1",supplierName:"Supplier One Sdn Bhd",invoiceNo:"SUP-2023-045",invoiceDate:"2023-11-20",dueDate:"2023-12-19",amount:12e3,paid:0},{id:"ap_2",supplierName:"Material Supplies Co",invoiceNo:"SUP-2023-052",invoiceDate:"2023-12-15",dueDate:"2024-01-14",amount:8e3,paid:0},{id:"ap_3",supplierName:"Equipment Parts Ltd",invoiceNo:"SUP-2023-058",invoiceDate:"2023-12-28",dueDate:"2024-01-27",amount:5e3,paid:0}]),sr([{id:"od_1",description:"Rental Deposit - Office",type:"DEPOSIT",amount:6e3,remarks:"3 months deposit for office rental"},{id:"od_2",description:"Utilities Deposit - TNB",type:"DEPOSIT",amount:2e3,remarks:"Electricity deposit"},{id:"od_3",description:"Prepaid Insurance",type:"PREPAID",amount:3e3,remarks:"Insurance premium paid in advance"},{id:"od_4",description:"Staff Advance - Ahmad",type:"ADVANCE",amount:1e3,remarks:"Salary advance to be deducted"}]),Vr([{id:"oc_1",description:"Accrued Audit Fee",type:"ACCRUAL",amount:4e3,remarks:"Year-end audit fee"},{id:"oc_2",description:"Accrued Bonus",type:"ACCRUAL",amount:3e3,remarks:"Staff bonus payable"},{id:"oc_3",description:"Customer Deposit Received",type:"DEPOSIT_RECEIVED",amount:2e3,remarks:"Deposit from customer for future order"}]),Nn([{id:"cb_1",accountName:"Maybank Current Account",bankName:"Maybank",accountNo:"5123-4567-8901",openingBalance:7e4,closingBalance:116e3,reconciled:!0},{id:"cb_2",accountName:"CIMB Current Account",bankName:"CIMB",accountNo:"1234-5678-9012",openingBalance:3e4,closingBalance:25650,reconciled:!0}]),ke([{t:"ok",m:" Comprehensive sample loaded: Sdn Bhd, 2 banks, 6 transactions, Prior FS, Opening Balances, PPE Register (3 assets), Inventory (4 items), AR (3 customers), AP (3 suppliers), Other Debtors (4 items), Other Creditors (3 items), Cash Ledger (2 accounts)"}]),a("priorfs")},gf=()=>{de.acc&&de.amt&&(oe(u=>({...u,[de.acc.toLowerCase().replace(/\s+/g,"_")]:parseFloat(de.amt)})),_e({acc:"",amt:""}))},v0=u=>w(v=>v.filter((b,S)=>S!==u)),Zs=(u,v,b)=>w(S=>S.map((T,Q)=>Q===u?{...T,[v]:v==="amount"?parseFloat(b)||0:b}:T)),xf=()=>`${JSON.stringify({ob:le,banks:Ut,txsLength:_.length,cashTxsLength:N.length,subledgerCounts:{ppe:De.length,inv:Xe.length,ar:We.length,ap:Nt.length},currentYear:L,companyName:s}).length}-${_.length+N.length}`,mf=(u,v,b)=>{const S=[],T=u.snapshotRes,Q=.01,j=(qe,Ye)=>Math.abs((qe||0)-(Ye||0))>Q;[{key:"rev",label:"Total Revenue",type:"Reclass",category:"IS"},{key:"cos",label:"Total Cost of Sales",type:"Reclass",category:"IS"},{key:"gp",label:"Gross Profit",type:"Reclass",category:"IS"},{key:"adm",label:"Total Admin Expenses",type:"Reclass",category:"IS"},{key:"oi",label:"Total Other Income",type:"Reclass",category:"IS"},{key:"oe",label:"Total Other Expenses",type:"Reclass",category:"IS"},{key:"fin",label:"Total Finance Costs",type:"Reclass",category:"IS"},{key:"dep",label:"Depreciation",type:"Depreciation",category:"IS"},{key:"pbt",label:"Profit Before Tax",type:"Reclass",category:"IS"},{key:"tax",label:"Tax Expense",type:"TaxAdj",category:"IS"},{key:"np",label:"Net Profit",type:"Reclass",category:"IS"}].forEach(({key:qe,label:Ye,type:ot,category:Xt})=>{const ct=T.is?.[qe]||0,ba=v.is?.[qe]||0;if(j(ct,ba)){const nt=ba-ct;S.push({id:`ADJ-${Date.now()}-is-${qe}`,date:new Date().toISOString().split("T")[0],periodLabel:b,type:ot,category:Xt,field:Ye,oldValue:ct,newValue:ba,amount:nt,description:`${Ye}: ${ae(ct)}  ${ae(ba)}`,isAuto:!0,createdAt:new Date().toISOString()})}});const M=T.is?.details||{},X=v.is?.details||{};new Set([...Object.keys(M),...Object.keys(X)]).forEach(qe=>{const Ye=M[qe]||0,ot=X[qe]||0;if(j(Ye,ot)){const Xt=ot-Ye,ct=cn.rules[qe],ba=ct?.label||qe,nt=ct?.type==="revenue"||ct?.type==="other_income"||ct?.type==="cogs"||ct?.type==="expense"?"Reclass":"Correction";S.push({id:`ADJ-${Date.now()}-det-${qe}`,date:new Date().toISOString().split("T")[0],periodLabel:b,type:nt,category:"IS-Detail",field:ba,glCode:qe,oldValue:Ye,newValue:ot,amount:Xt,description:`${ba} (${qe}): ${ae(Ye)}  ${ae(ot)}`,isAuto:!0,createdAt:new Date().toISOString()})}}),[{key:"ppe",label:"PPE (Net)",type:"Correction",category:"BS-NCA"},{key:"ppe_cost",label:"PPE Cost",type:"Correction",category:"BS-NCA"},{key:"ppe_accDep",label:"Accumulated Depreciation",type:"Depreciation",category:"BS-NCA"},{key:"inv",label:"Inventory",type:"Correction",category:"BS-CA"},{key:"tr",label:"Trade Receivables",type:"Correction",category:"BS-CA"},{key:"or",label:"Other Receivables",type:"Correction",category:"BS-CA"},{key:"cash",label:"Cash & Bank",type:"Correction",category:"BS-CA"},{key:"cashInHand",label:"Cash in Hand",type:"Correction",category:"BS-CA"},{key:"totCA",label:"Total Current Assets",type:"Correction",category:"BS-CA"},{key:"totNCA",label:"Total Non-Current Assets",type:"Correction",category:"BS-NCA"},{key:"totA",label:"Total Assets",type:"Correction",category:"BS"},{key:"tp",label:"Trade Payables",type:"Correction",category:"BS-CL"},{key:"op",label:"Other Payables",type:"Correction",category:"BS-CL"},{key:"borr",label:"ST Borrowings",type:"Correction",category:"BS-CL"},{key:"ltBorr",label:"LT Borrowings",type:"Correction",category:"BS-NCL"},{key:"taxPay",label:"Tax Payable",type:"TaxAdj",category:"BS-CL"},{key:"totCL",label:"Total Current Liabilities",type:"Correction",category:"BS-CL"},{key:"totNCL",label:"Total Non-Current Liabilities",type:"Correction",category:"BS-NCL"},{key:"totL",label:"Total Liabilities",type:"Correction",category:"BS"},{key:"cap",label:"Share Capital",type:"Correction",category:"BS-EQ"},{key:"ret",label:"Retained Earnings",type:"Correction",category:"BS-EQ"},{key:"cyp",label:"Current Year Profit",type:"Correction",category:"BS-EQ"},{key:"totE",label:"Total Equity",type:"Correction",category:"BS-EQ"}].forEach(({key:qe,label:Ye,type:ot,category:Xt})=>{const ct=T.bs?.[qe]||0,ba=v.bs?.[qe]||0;if(j(ct,ba)){const nt=ba-ct;S.push({id:`ADJ-${Date.now()}-bs-${qe}`,date:new Date().toISOString().split("T")[0],periodLabel:b,type:ot,category:Xt,field:Ye,oldValue:ct,newValue:ba,amount:nt,description:`${Ye}: ${ae(ct)}  ${ae(ba)}`,isAuto:!0,createdAt:new Date().toISOString()})}});const Ce=u.snapshotMeta?.counts?.bankTxs||0,J=u.snapshotMeta?.counts?.cashTxs||0,Y=_.length,ze=N.length;Ce!==Y&&S.push({id:`ADJ-${Date.now()}-banktx`,date:new Date().toISOString().split("T")[0],periodLabel:b,type:"Other",category:"Count",field:"Bank Transactions",oldValue:Ce,newValue:Y,amount:Y-Ce,description:`Bank Transactions: ${Ce}  ${Y}`,isAuto:!0,createdAt:new Date().toISOString()}),J!==ze&&S.push({id:`ADJ-${Date.now()}-cashtx`,date:new Date().toISOString().split("T")[0],periodLabel:b,type:"Other",category:"Count",field:"Cash Vouchers",oldValue:J,newValue:ze,amount:ze-J,description:`Cash Vouchers: ${J}  ${ze}`,isAuto:!0,createdAt:new Date().toISOString()});const Le=u.snapshotMeta?.counts?.jes||0,me=v.jes?.length||0;return Le!==me&&S.push({id:`ADJ-${Date.now()}-jecount`,date:new Date().toISOString().split("T")[0],periodLabel:b,type:"Other",category:"Count",field:"Journal Entries",oldValue:Le,newValue:me,amount:me-Le,description:`Journal Entries: ${Le}  ${me}`,isAuto:!0,createdAt:new Date().toISOString()}),S},vf=()=>{if(!m){alert("Please generate FS first before saving a snapshot.");return}const{periodType:u,periodLabel:v,note:b,createdBy:S}=Mt;if(!v.trim()){alert('Please enter a period label (e.g., "2025-01" for monthly or "FY2025" for yearly)');return}const T=gt.filter(X=>X.periodLabel===v&&X.periodType===u).sort((X,ye)=>ye.version-X.version),Q=T.map(X=>X.version),j=Q.length>0?Math.max(...Q)+1:1;let C=[];if(T.length>0){const X=T[0];C=mf(X,m,v.trim())}const M={id:`SNAP-${Date.now()}`,periodType:u,periodLabel:v.trim(),version:j,createdAt:new Date().toISOString(),createdBy:S||"Accountant",note:b.trim(),inputsHash:xf(),snapshotRes:JSON.parse(JSON.stringify(m)),snapshotMeta:{companyName:s,companyRegNo:f,companyType:t,accountingStandard:E,currentYear:L,financialYearEnd:g,counts:{bankTxs:_.length,cashTxs:N.length,jes:m.jes?m.jes.length:0}},previousVersionId:T.length>0?T[0].id:null};C.length>0&&ra(X=>[...C,...X]),Z(X=>[M,...X]),St(!1),yt({periodType:"Monthly",periodLabel:"",note:"",createdBy:"Accountant"}),C.length>0?alert(`Snapshot saved: ${v} v${j}

${C.length} change(s) auto-detected and logged.`):alert(`Snapshot saved: ${v} v${j}`)},Uo=u=>{confirm(`Load snapshot "${u.periodLabel} v${u.version}"?

This will show the snapshot's FS in the preview.`)&&(Se(u.snapshotRes),a("journal"))},yf=u=>{confirm("Delete this snapshot?")&&Z(v=>v.filter(b=>b.id!==u))},bf=()=>{const{periodLabel:u,type:v,amount:b,description:S}=Ba;if(!u.trim()||!S.trim()){alert("Please enter period label and description");return}const T={id:`ADJ-${Date.now()}`,date:new Date().toISOString().split("T")[0],periodLabel:u.trim(),type:v,amount:parseFloat(b)||0,description:S.trim(),isAuto:!1,createdAt:new Date().toISOString()};ra(Q=>[T,...Q]),Qa({periodLabel:"",type:"Correction",amount:"",description:""})},Sf=u=>{confirm("Delete this adjustment entry?")&&ra(v=>v.filter(b=>b.id!==u))},y0=()=>{if(!Rt.amount)return null;const u=Math.abs(parseFloat(Rt.amount)||0);if(u===0)return null;const v=Rt.type==="in",b=Rt.type.includes("bank"),S=Rt.classification||(b?"CASH_TRANSFER":"SUSPENSE"),T=tb[S]||S,Q=cn.rules[T],j="Cash on Hand",C="Bank";let M="",X="";if(Rt.type==="bank_to_cash")M=j,X=C;else if(Rt.type==="cash_to_bank")M=C,X=j;else if(Q){const ye=Q.type;ye==="revenue"||ye==="other_income"?(M=j,X=Q.label||T):ye==="cogs"||ye==="expense"||ye==="finance"||ye==="other_expense"||ye==="drawings"?(M=Q.label||T,X=j):(M=v?j:"Suspense",X=v?"Suspense":j)}else M=v?j:"Suspense",X=v?"Suspense":j;return{drAcc:M,crAcc:X,amt:u}},Ef=()=>{if(!Rt.description||!Rt.amount){alert("Please enter description and amount");return}const u=parseFloat(Rt.amount);if(isNaN(u)||u===0){alert("Please enter a valid amount");return}let v=Math.abs(u);(Rt.type==="out"||Rt.type==="cash_to_bank")&&(v=-v);const b={date:Rt.date,description:Rt.description,reference:Rt.reference,amount:v,month:new Date(Rt.date).toLocaleString("en",{month:"short"}).toUpperCase(),classification:Rt.classification||(Rt.type.includes("bank")?"CASH_TRANSFER":""),source:"Cash",cashLedger:"PETTY_CASH",transferDirection:Rt.type.includes("bank")?Rt.type:null};k(S=>[...S,b]),Yr({date:new Date().toISOString().split("T")[0],description:"",reference:`CV-${String(N.length+2).padStart(3,"0")}`,amount:"",type:"out",classification:""})},b0=()=>{Pe(!0),setTimeout(()=>{const u={revenue:parseFloat(cs.revenue)||0,cost_of_sales:parseFloat(cs.cost_of_sales)||0,admin_expenses:parseFloat(cs.admin_expenses)||0,other_income:parseFloat(cs.other_income)||0,other_expenses:at.oe||0,finance_costs:parseFloat(cs.finance_costs)||0,tax:parseFloat(cs.tax)||0},v={ppe:parseFloat(Tt.ppe)||0,intangibles:parseFloat(Tt.intangibles)||0,investments:parseFloat(Tt.investments)||0,inventory:parseFloat(Tt.inventory)||0,trade_receivables:parseFloat(Tt.trade_receivables)||0,other_receivables:parseFloat(Tt.other_receivables)||0,bank:parseFloat(Tt.bank)||0,long_term_loan:parseFloat(Tt.long_term_loan)||0,deferred_tax:parseFloat(Tt.deferred_tax)||0,loan:parseFloat(Tt.loan)||0,trade_payables:parseFloat(Tt.trade_payables)||0,other_payables:parseFloat(Tt.other_payables)||0,tax_payable:parseFloat(Tt.tax_payable)||0,share_capital:parseFloat(Tt.share_capital)||0,retained_profits:parseFloat(Tt.retained_profits)||0,reserves:parseFloat(Tt.reserves)||0},b={ppe:rt.ppe,inventory:rt.inventory,receivables:rt.receivables,payables:rt.payables,otherDebtors:rt.otherDebtors,otherCreditors:rt.otherCreditors,cashBank:rt.cashBank,depreciation:rt.ppe.currentDep,shortTermBorrowings:rt.shortTermBorrowings,longTermBorrowings:rt.longTermBorrowings,hasSTBorrowings:rt.hasSTBorrowings,hasLTBorrowings:rt.hasLTBorrowings,borrowingsDrawdowns:rt.borrowingsDrawdowns,borrowingsRepayments:rt.borrowingsRepayments,stBorrOpening:rt.stBorrOpening,ltBorrOpening:rt.ltBorrOpening},S=[..._,...N],T=cn.process(S,le,u,v,na,b,G,xe),Q=hr(T.is.pbt);T.taxComputation={pbt:T.is.pbt,totalAddBack:Ta(),adjustedProfit:Q.adjustedProfit,capitalAllowance:Q.capitalAllowance,otherDeductions:Q.totalDeductions-Q.capitalAllowance,taxableIncome:Q.taxableIncome,grossTax:Q.grossTax,zakat:Q.zakat,netTax:Q.netTax,brackets:Q.brackets},Se(T),Pe(!1),a("journal")},400)},Tf=(u="EN")=>{if(!m)return alert("Please generate financial statements first before exporting."),null;try{const v=s||"Company Name",b=f||"____________",S=sa?.fullStandard||"Malaysian Private Entities Reporting Standard",T=sa?.standard||"MPERS",Q=sa?.taxInfo||"24%",j=sa?.name||"Private Limited Company",C=u==="EN",M={title:C?"FINANCIAL STATEMENTS":"PENYATA KEWANGAN",forYear:C?"FOR THE FINANCIAL YEAR ENDED":"BAGI TAHUN KEWANGAN BERAKHIR",asAt:C?"AS AT":"PADA",regNo:C?"Registration No.":"No. Pendaftaran",contents:C?"CONTENTS":"KANDUNGAN",sofp:C?"STATEMENT OF FINANCIAL POSITION":"PENYATA KEDUDUKAN KEWANGAN",sopl:C?"STATEMENT OF PROFIT OR LOSS AND OTHER COMPREHENSIVE INCOME":"PENYATA UNTUNG RUGI DAN PENDAPATAN KOMPREHENSIF LAIN",soce:C?"STATEMENT OF CHANGES IN EQUITY":"PENYATA PERUBAHAN EKUITI",socf:C?"STATEMENT OF CASH FLOWS":"PENYATA ALIRAN TUNAI",notes:C?"NOTES TO THE FINANCIAL STATEMENTS":"NOTA-NOTA KEPADA PENYATA KEWANGAN",statementByDirectors:C?"STATEMENT BY DIRECTORS":"PENYATA PENGARAH",statutoryDeclaration:C?"STATUTORY DECLARATION":"AKUAN BERKANUN",revenue:C?"Revenue":"Hasil",costOfSales:C?"Cost of sales":"Kos jualan",grossProfit:C?"Gross profit":"Untung kasar",otherIncome:C?"Other income":"Pendapatan lain",adminExp:C?"Administrative expenses":"Perbelanjaan pentadbiran",finCosts:C?"Finance costs":"Kos kewangan",pbt:C?"Profit before taxation":"Untung sebelum cukai",tax:C?"Taxation":"Cukai",profitYear:C?"Profit for the financial year":"Untung bagi tahun kewangan",oci:C?"Other comprehensive income":"Pendapatan komprehensif lain",totalCI:C?"Total comprehensive income for the year":"Jumlah pendapatan komprehensif bagi tahun",assets:C?"ASSETS":"ASET",nca:C?"Non-Current Assets":"Aset Bukan Semasa",ppe:C?"Property, plant and equipment":"Hartanah, loji dan peralatan",ca:C?"Current Assets":"Aset Semasa",inventories:C?"Inventories":"Inventori",tradeRec:C?"Trade and other receivables":"Penghutang perdagangan dan lain-lain",cashBank:C?"Cash and bank balances":"Tunai dan baki bank",totalAssets:C?"TOTAL ASSETS":"JUMLAH ASET",equityLiab:C?"EQUITY AND LIABILITIES":"EKUITI DAN LIABILITI",equity:C?"Equity":"Ekuiti",shareCap:C?"Share capital":"Modal saham",retained:C?"Retained earnings":"Pendapatan tertahan",totalEquity:C?"Total Equity":"Jumlah Ekuiti",liabilities:C?"Liabilities":"Liabiliti",cl:C?"Current Liabilities":"Liabiliti Semasa",tradePay:C?"Trade and other payables":"Pemiutang perdagangan dan lain-lain",borrowings:C?"Borrowings":"Pinjaman",totalLiab:C?"Total Liabilities":"Jumlah Liabiliti",totalEL:C?"TOTAL EQUITY AND LIABILITIES":"JUMLAH EKUITI DAN LIABILITI",note:C?"Note":"Nota",rm:"RM",balanceAt:C?"Balance at":"Baki pada",total:C?"Total":"Jumlah",notesIntegral:C?"The accompanying notes form an integral part of these financial statements.":"Nota-nota yang disertakan merupakan sebahagian daripada penyata kewangan ini.",incMalaysia:C?"Incorporated in Malaysia":"Diperbadankan di Malaysia",page:C?"Page":"Muka Surat"},X=J=>J==null?"-":Number(J).toLocaleString("en-MY",{minimumFractionDigits:0,maximumFractionDigits:0}),ye=J=>J==null?"-":J<0?"("+X(Math.abs(J))+")":X(J);let Fe="";return De&&De.length>0&&De.forEach(J=>{const Y=Ws(J);Fe+="<tr><td>"+(J.description||"-")+"</td>",Fe+='<td class="right">'+X(J.cost)+"</td>",Fe+='<td class="right">'+X(Y.accDepCF)+"</td>",Fe+='<td class="right">'+X(Y.nbv)+"</td></tr>"}),'<!DOCTYPE html><html lang="'+(C?"en":"ms")+'"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>'+v+" - "+M.title+" "+L+'</title><style>@page { size: A4; margin: 2cm; }@media print { .page { page-break-after: always; } .page:last-child { page-break-after: avoid; } }* { box-sizing: border-box; }body { font-family: "Times New Roman", Times, serif; font-size: 11pt; line-height: 1.5; color: #000; max-width: 210mm; margin: 0 auto; padding: 20px; }.page { page-break-after: always; page-break-inside: avoid; padding-bottom: 20px; margin-bottom: 20px; }.page:last-child { page-break-after: avoid; }.header { text-align: center; margin-bottom: 25px; page-break-after: avoid; }.header h1 { font-size: 14pt; font-weight: bold; margin: 0 0 5px 0; text-transform: uppercase; }.header h2 { font-size: 12pt; font-weight: bold; margin: 0 0 5px 0; text-transform: uppercase; }.header p { font-size: 11pt; margin: 3px 0; }.section-title { font-size: 11pt; font-weight: bold; text-transform: uppercase; margin: 20px 0 10px 0; page-break-after: avoid; }.subsection { font-size: 11pt; font-weight: bold; margin: 15px 0 8px 0; page-break-after: avoid; }table { width: 100%; border-collapse: collapse; margin: 10px 0; page-break-inside: avoid; }table.fs th, table.fs td { padding: 4px 8px; text-align: left; vertical-align: top; font-size: 10pt; }.right { text-align: right; }.center { text-align: center; }.bold { font-weight: bold; }.indent { padding-left: 15px; }.indent2 { padding-left: 30px; }.total td { border-top: 1px solid #000; font-weight: bold; }.double td { border-top: 2px solid #000; font-weight: bold; }.subtotal td { border-top: 1px solid #000; }.underline { border-bottom: 1px solid #000; }.note-text { font-size: 10pt; margin: 8px 0; text-align: justify; line-height: 1.6; }.note-table th, .note-table td { border: 1px solid #000; padding: 4px 6px; font-size: 9pt; }.note-table th { background: #f5f5f5; font-weight: bold; }.toc-item { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px dotted #ccc; }.company-header { text-align: right; font-size: 9pt; margin-bottom: 10px; color: #666; }.keep-together { page-break-inside: avoid; }</style></head><body><div class="page" style="display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center;"><div style="margin-bottom: 80px;"><h1 style="font-size: 22pt; margin-bottom: 15px; letter-spacing: 1px;">'+v.toUpperCase()+'</h1><p style="font-size: 11pt;">('+M.regNo+": "+b+')</p><p style="font-size: 10pt; margin-top: 3px;">('+M.incMalaysia+')</p></div><div style="margin-bottom: 80px;"><h2 style="font-size: 18pt; font-weight: bold; letter-spacing: 2px;">'+M.title+'</h2><p style="font-size: 12pt; margin-top: 25px;">'+M.forYear+'</p><p style="font-size: 14pt; font-weight: bold; margin-top: 5px;">'+Lt.toUpperCase()+'</p></div><div style="margin-top: 60px;"><p style="font-size: 10pt; font-style: italic;">'+S+'</p></div></div><div class="page"><div class="header"><h1>'+v.toUpperCase()+'</h1></div><h2 style="text-align:center; margin-bottom:30px;">'+M.contents+'</h2><div style="max-width:400px; margin:0 auto;"><div class="toc-item"><span>'+M.sofp+'</span><span>3</span></div><div class="toc-item"><span>'+M.sopl+'</span><span>4</span></div><div class="toc-item"><span>'+M.soce+'</span><span>5</span></div><div class="toc-item"><span>'+M.socf+'</span><span>6</span></div><div class="toc-item"><span>'+M.notes+'</span><span>7 - 11</span></div></div></div><div class="page"><div class="company-header">'+v.toUpperCase()+" ("+b+')</div><div class="header"><h2>'+M.sofp+"</h2><p>"+M.asAt+" "+Lt.toUpperCase()+'</p></div><table class="fs"><thead><tr><th style="width:50%"></th><th class="center" style="width:8%">'+M.note+'</th><th class="right" style="width:21%">'+L+"<br>"+M.rm+'</th><th class="right" style="width:21%">'+fe+"<br>"+M.rm+'</th></tr></thead><tbody><tr><td class="bold">'+M.assets+'</td><td></td><td></td><td></td></tr><tr><td class="bold indent">'+M.nca+'</td><td></td><td></td><td></td></tr><tr><td class="indent2">'+M.ppe+'</td><td class="center">3</td><td class="right">'+X(m.bs.ppe)+'</td><td class="right">'+X(m.bs.py_ppe)+'</td></tr><tr class="subtotal"><td></td><td></td><td class="right">'+X(m.bs.totNCA)+'</td><td class="right">'+X(m.bs.py_totNCA)+'</td></tr><tr><td class="bold indent">'+M.ca+'</td><td></td><td></td><td></td></tr><tr><td class="indent2">'+M.inventories+'</td><td class="center">4</td><td class="right">'+X(m.bs.inv)+'</td><td class="right">'+X(m.bs.py_inv)+'</td></tr><tr><td class="indent2">'+M.tradeRec+'</td><td class="center">5</td><td class="right">'+X(m.bs.tr)+'</td><td class="right">'+X(m.bs.py_tr)+'</td></tr><tr><td class="indent2">'+M.cashBank+'</td><td class="center">6</td><td class="right">'+X(m.bs.cash)+'</td><td class="right">'+X(m.bs.py_cash)+'</td></tr><tr class="subtotal"><td></td><td></td><td class="right">'+X(m.bs.totCA)+'</td><td class="right">'+X(m.bs.py_totCA)+'</td></tr><tr class="double"><td class="bold">'+M.totalAssets+'</td><td></td><td class="right">'+X(m.bs.totA)+'</td><td class="right">'+X(m.bs.py_totA)+'</td></tr><tr><td colspan="4" style="height:15px"></td></tr><tr><td class="bold">'+M.equityLiab+'</td><td></td><td></td><td></td></tr><tr><td class="bold indent">'+M.equity+'</td><td></td><td></td><td></td></tr><tr><td class="indent2">'+M.shareCap+'</td><td class="center">7</td><td class="right">'+X(m.bs.cap)+'</td><td class="right">'+X(m.bs.py_cap)+'</td></tr><tr><td class="indent2">'+M.retained+'</td><td></td><td class="right">'+X(m.bs.ret+m.bs.cyp)+'</td><td class="right">'+X(m.bs.py_ret)+'</td></tr><tr class="subtotal"><td class="bold indent">'+M.totalEquity+'</td><td></td><td class="right">'+X(m.bs.totE)+'</td><td class="right">'+X(m.bs.py_totE)+'</td></tr><tr><td class="bold indent">'+M.cl+'</td><td></td><td></td><td></td></tr><tr><td class="indent2">'+M.tradePay+'</td><td class="center">8</td><td class="right">'+X(m.bs.tp)+'</td><td class="right">'+X(m.bs.py_tp)+'</td></tr><tr><td class="indent2">'+M.borrowings+'</td><td class="center">9</td><td class="right">'+X(m.bs.borr)+'</td><td class="right">'+X(m.bs.py_borr)+'</td></tr><tr class="subtotal"><td class="bold indent">'+M.totalLiab+'</td><td></td><td class="right">'+X(m.bs.totL)+'</td><td class="right">'+X(m.bs.py_totL)+'</td></tr><tr class="double"><td class="bold">'+M.totalEL+'</td><td></td><td class="right">'+X(m.bs.totE+m.bs.totL)+'</td><td class="right">'+X((m.bs.py_totE||0)+(m.bs.py_totL||0))+'</td></tr></tbody></table><p style="font-size:9pt; margin-top:20px; font-style:italic">'+M.notesIntegral+'</p></div><div class="page"><div class="company-header">'+v.toUpperCase()+" ("+b+')</div><div class="header"><h2>'+M.sopl+"</h2><p>"+M.forYear+" "+Lt.toUpperCase()+'</p></div><table class="fs"><thead><tr><th style="width:50%"></th><th class="center" style="width:8%">'+M.note+'</th><th class="right" style="width:21%">'+L+"<br>"+M.rm+'</th><th class="right" style="width:21%">'+fe+"<br>"+M.rm+"</th></tr></thead><tbody><tr><td>"+M.revenue+'</td><td class="center">10</td><td class="right">'+X(m.is.rev)+'</td><td class="right">'+X(m.is.py_rev)+"</td></tr><tr><td>"+M.costOfSales+'</td><td></td><td class="right">'+ye(-m.is.cos)+'</td><td class="right">'+ye(-(m.is.py_cos||0))+'</td></tr><tr class="subtotal"><td class="bold">'+M.grossProfit+'</td><td></td><td class="right">'+X(m.is.gp)+'</td><td class="right">'+X(m.is.py_gp)+"</td></tr><tr><td>"+M.otherIncome+'</td><td></td><td class="right">'+X(m.is.oi)+'</td><td class="right">'+X(m.is.py_oi)+"</td></tr><tr><td>"+M.adminExp+'</td><td class="center">11</td><td class="right">'+ye(-m.is.adm)+'</td><td class="right">'+ye(-(m.is.py_adm||0))+"</td></tr><tr><td>"+M.finCosts+'</td><td class="center">12</td><td class="right">'+ye(-m.is.fin)+'</td><td class="right">'+ye(-(m.is.py_fin||0))+'</td></tr><tr class="subtotal"><td class="bold">'+M.pbt+'</td><td></td><td class="right">'+X(m.is.pbt)+'</td><td class="right">'+X(m.is.py_pbt)+"</td></tr><tr><td>"+M.tax+'</td><td class="center">13</td><td class="right">'+ye(-m.is.tax)+'</td><td class="right">'+ye(-(m.is.py_tax||0))+'</td></tr><tr class="subtotal"><td class="bold">'+M.profitYear+'</td><td></td><td class="right">'+X(m.is.np)+'</td><td class="right">'+X(m.is.py_np)+"</td></tr><tr><td>"+M.oci+'</td><td></td><td class="right">-</td><td class="right">-</td></tr><tr class="double"><td class="bold">'+M.totalCI+'</td><td></td><td class="right">'+X(m.is.np)+'</td><td class="right">'+X(m.is.py_np)+'</td></tr></tbody></table><p style="font-size:9pt; margin-top:20px; font-style:italic">'+M.notesIntegral+'</p></div><div class="page"><div class="company-header">'+v.toUpperCase()+" ("+b+')</div><div class="header"><h2>'+M.soce+"</h2><p>"+M.forYear+" "+Lt.toUpperCase()+'</p></div><table class="fs"><thead><tr><th style="width:40%"></th><th class="right" style="width:20%">'+M.shareCap+"<br>"+M.rm+'</th><th class="right" style="width:20%">'+M.retained+"<br>"+M.rm+'</th><th class="right" style="width:20%">'+M.total+"<br>"+M.rm+"</th></tr></thead><tbody><tr><td>"+M.balanceAt+" 1.1."+fe+'</td><td class="right">'+X(m.bs.py_cap)+'</td><td class="right">'+X((m.bs.py_ret||0)-(m.is.py_np||0))+'</td><td class="right">'+X((m.bs.py_totE||0)-(m.is.py_np||0))+'</td></tr><tr><td class="indent">'+M.profitYear+'</td><td class="right">-</td><td class="right">'+X(m.is.py_np)+'</td><td class="right">'+X(m.is.py_np)+'</td></tr><tr><td class="indent">'+M.totalCI+'</td><td class="right">-</td><td class="right">'+X(m.is.py_np)+'</td><td class="right">'+X(m.is.py_np)+'</td></tr><tr class="subtotal"><td class="bold">'+M.balanceAt+" 31.12."+fe+'</td><td class="right">'+X(m.bs.py_cap)+'</td><td class="right">'+X(m.bs.py_ret)+'</td><td class="right">'+X(m.bs.py_totE)+'</td></tr><tr><td class="indent">'+M.profitYear+'</td><td class="right">-</td><td class="right">'+X(m.is.np)+'</td><td class="right">'+X(m.is.np)+'</td></tr><tr><td class="indent">'+M.totalCI+'</td><td class="right">-</td><td class="right">'+X(m.is.np)+'</td><td class="right">'+X(m.is.np)+'</td></tr><tr class="double"><td class="bold">'+M.balanceAt+" 31.12."+L+'</td><td class="right">'+X(m.bs.cap)+'</td><td class="right">'+X(m.bs.ret+m.bs.cyp)+'</td><td class="right">'+X(m.bs.totE)+'</td></tr></tbody></table><p style="font-size:9pt; margin-top:20px; font-style:italic">'+M.notesIntegral+'</p></div><div class="page"><div class="company-header">'+v.toUpperCase()+" ("+b+')</div><div class="header"><h2>'+M.socf+"</h2><p>"+M.forYear+" "+Lt.toUpperCase()+'</p></div><table class="fs"><thead><tr><th style="width:70%"></th><th class="right" style="width:15%">'+L+"<br>"+M.rm+'</th><th class="right" style="width:15%">'+fe+"<br>"+M.rm+'</th></tr></thead><tbody><tr><td class="bold">'+(C?"CASH FLOWS FROM OPERATING ACTIVITIES":"ALIRAN TUNAI DARIPADA AKTIVITI OPERASI")+'</td><td></td><td></td></tr><tr><td class="indent">'+(C?"Profit before taxation":"Untung sebelum cukai")+'</td><td class="right">'+X(m.cf.pbt)+'</td><td class="right">'+X(m.is.py_pbt||0)+'</td></tr><tr><td class="indent">'+(C?"Adjustments for:":"Pelarasan untuk:")+'</td><td></td><td></td></tr><tr><td class="indent2">'+(C?"Depreciation":"Susut nilai")+'</td><td class="right">'+X(m.cf.adjustments.depreciation)+'</td><td class="right">-</td></tr><tr><td class="indent2">'+(C?"Interest expense":"Perbelanjaan faedah")+'</td><td class="right">'+X(m.cf.adjustments.interestExpense)+'</td><td class="right">-</td></tr>'+(m.cf.adjustments.interestIncome!==0?'<tr><td class="indent2">'+(C?"Interest income":"Pendapatan faedah")+'</td><td class="right">'+ye(m.cf.adjustments.interestIncome)+'</td><td class="right">-</td></tr>':"")+'<tr class="subtotal"><td class="indent">'+(C?"Operating profit before working capital changes":"Keuntungan operasi sebelum perubahan modal kerja")+'</td><td class="right">'+X(m.cf.pbt+m.cf.totalAdjustments)+'</td><td class="right">-</td></tr><tr><td class="indent">'+(C?"Changes in working capital:":"Perubahan dalam modal kerja:")+"</td><td></td><td></td></tr>"+(m.cf.workingCapitalChanges.inventory!==0?'<tr><td class="indent2">'+(C?"(Increase)/Decrease in inventories":"(Pertambahan)/Pengurangan dalam inventori")+'</td><td class="right">'+ye(m.cf.workingCapitalChanges.inventory)+'</td><td class="right">-</td></tr>':"")+(m.cf.workingCapitalChanges.tradeReceivables!==0?'<tr><td class="indent2">'+(C?"(Increase)/Decrease in trade receivables":"(Pertambahan)/Pengurangan dalam penghutang perdagangan")+'</td><td class="right">'+ye(m.cf.workingCapitalChanges.tradeReceivables)+'</td><td class="right">-</td></tr>':"")+(m.cf.workingCapitalChanges.otherReceivables!==0?'<tr><td class="indent2">'+(C?"(Increase)/Decrease in other receivables":"(Pertambahan)/Pengurangan dalam penghutang lain")+'</td><td class="right">'+ye(m.cf.workingCapitalChanges.otherReceivables)+'</td><td class="right">-</td></tr>':"")+(m.cf.workingCapitalChanges.tradePayables!==0?'<tr><td class="indent2">'+(C?"Increase/(Decrease) in trade payables":"Pertambahan/(Pengurangan) dalam pemiutang perdagangan")+'</td><td class="right">'+ye(m.cf.workingCapitalChanges.tradePayables)+'</td><td class="right">-</td></tr>':"")+(m.cf.workingCapitalChanges.otherPayables!==0?'<tr><td class="indent2">'+(C?"Increase/(Decrease) in other payables":"Pertambahan/(Pengurangan) dalam pemiutang lain")+'</td><td class="right">'+ye(m.cf.workingCapitalChanges.otherPayables)+'</td><td class="right">-</td></tr>':"")+'<tr class="subtotal"><td class="indent bold">'+(C?"Cash generated from operations":"Tunai dijana daripada operasi")+'</td><td class="right">'+X(m.cf.cashFromOperations)+'</td><td class="right">-</td></tr>'+(m.cf.taxPaid!==0?'<tr><td class="indent2">'+(C?"Tax paid":"Cukai dibayar")+'</td><td class="right">'+ye(m.cf.taxPaid)+'</td><td class="right">-</td></tr>':"")+(m.cf.interestPaid!==0?'<tr><td class="indent2">'+(C?"Interest paid":"Faedah dibayar")+'</td><td class="right">'+ye(m.cf.interestPaid)+'</td><td class="right">-</td></tr>':"")+'<tr class="subtotal"><td class="bold">'+(C?"Net cash from operating activities":"Tunai bersih daripada aktiviti operasi")+'</td><td class="right bold">'+X(m.cf.netOperating)+'</td><td class="right">-</td></tr><tr><td colspan="3" style="height:10px"></td></tr><tr><td class="bold">'+(C?"CASH FLOWS FROM INVESTING ACTIVITIES":"ALIRAN TUNAI DARIPADA AKTIVITI PELABURAN")+"</td><td></td><td></td></tr>"+(m.cf.ppePurchases!==0?'<tr><td class="indent">'+(C?"Purchase of property, plant and equipment":"Pembelian hartanah, loji dan peralatan")+'</td><td class="right">'+ye(m.cf.ppePurchases)+'</td><td class="right">-</td></tr>':"")+(m.cf.ppeDisposals!==0?'<tr><td class="indent">'+(C?"Proceeds from disposal of PPE":"Hasil daripada pelupusan PPE")+'</td><td class="right">'+X(m.cf.ppeDisposals)+'</td><td class="right">-</td></tr>':"")+(m.cf.investmentPurchases!==0?'<tr><td class="indent">'+(C?"Purchase of investments":"Pembelian pelaburan")+'</td><td class="right">'+ye(m.cf.investmentPurchases)+'</td><td class="right">-</td></tr>':"")+(m.cf.investmentDisposals!==0?'<tr><td class="indent">'+(C?"Proceeds from disposal of investments":"Hasil daripada pelupusan pelaburan")+'</td><td class="right">'+X(m.cf.investmentDisposals)+'</td><td class="right">-</td></tr>':"")+(m.cf.interestReceived!==0?'<tr><td class="indent">'+(C?"Interest received":"Faedah diterima")+'</td><td class="right">'+X(m.cf.interestReceived)+'</td><td class="right">-</td></tr>':"")+(m.cf.netInvesting===0?'<tr><td class="indent" style="font-style:italic;color:#666">'+(C?"No investing activities":"Tiada aktiviti pelaburan")+'</td><td class="right">-</td><td class="right">-</td></tr>':"")+'<tr class="subtotal"><td class="bold">'+(C?"Net cash from investing activities":"Tunai bersih daripada aktiviti pelaburan")+'</td><td class="right bold">'+ye(m.cf.netInvesting)+'</td><td class="right">-</td></tr><tr><td colspan="3" style="height:10px"></td></tr><tr><td class="bold">'+(C?"CASH FLOWS FROM FINANCING ACTIVITIES":"ALIRAN TUNAI DARIPADA AKTIVITI PEMBIAYAAN")+"</td><td></td><td></td></tr>"+(m.cf.loanProceeds!==0?'<tr><td class="indent">'+(C?"Proceeds from borrowings":"Penerimaan daripada pinjaman")+'</td><td class="right">'+X(m.cf.loanProceeds)+'</td><td class="right">-</td></tr>':"")+(m.cf.loanRepayments!==0?'<tr><td class="indent">'+(C?"Repayment of borrowings":"Bayaran balik pinjaman")+'</td><td class="right">'+ye(m.cf.loanRepayments)+'</td><td class="right">-</td></tr>':"")+(m.cf.capitalInjection!==0?'<tr><td class="indent">'+(C?"Capital injection / Share issuance":"Suntikan modal / Terbitan saham")+'</td><td class="right">'+X(m.cf.capitalInjection)+'</td><td class="right">-</td></tr>':"")+(m.cf.dividendsPaid!==0?'<tr><td class="indent">'+(C?"Dividends paid":"Dividen dibayar")+'</td><td class="right">'+ye(m.cf.dividendsPaid)+'</td><td class="right">-</td></tr>':"")+(m.cf.drawingsWithdrawals!==0?'<tr><td class="indent">'+(C?"Drawings / Withdrawals":"Pengeluaran")+'</td><td class="right">'+ye(m.cf.drawingsWithdrawals)+'</td><td class="right">-</td></tr>':"")+(m.cf.netFinancing===0?'<tr><td class="indent" style="font-style:italic;color:#666">'+(C?"No financing activities":"Tiada aktiviti pembiayaan")+'</td><td class="right">-</td><td class="right">-</td></tr>':"")+'<tr class="subtotal"><td class="bold">'+(C?"Net cash from financing activities":"Tunai bersih daripada aktiviti pembiayaan")+'</td><td class="right bold">'+ye(m.cf.netFinancing)+'</td><td class="right">-</td></tr><tr><td colspan="3" style="height:15px"></td></tr><tr class="subtotal"><td class="bold">'+(C?"Net increase/(decrease) in cash and cash equivalents":"Pertambahan/(Pengurangan) bersih dalam tunai dan setara tunai")+'</td><td class="right bold">'+ye(m.cf.netChangeInCash)+'</td><td class="right">-</td></tr><tr><td>'+(C?"Cash and cash equivalents at beginning of year":"Tunai dan setara tunai pada awal tahun")+'</td><td class="right">'+X(m.cf.openingCash)+'</td><td class="right">'+X(m.bs.py_cash||0)+'</td></tr><tr class="double"><td class="bold">'+(C?"Cash and cash equivalents at end of year":"Tunai dan setara tunai pada akhir tahun")+'</td><td class="right bold">'+X(m.cf.closingCash)+'</td><td class="right">'+X(m.cf.openingCash)+'</td></tr></tbody></table><p style="font-size:9pt; margin-top:20px; font-style:italic">'+M.notesIntegral+'</p></div><div class="page"><div class="company-header">'+v.toUpperCase()+" ("+b+')</div><div class="header"><h2>'+M.notes+'</h2></div><div class="section-title">1. '+(C?"GENERAL INFORMATION":"MAKLUMAT AM")+'</div><p class="note-text">'+v+(C?" is a "+j.toLowerCase()+", incorporated and domiciled in Malaysia.":" adalah sebuah "+j.toLowerCase()+", diperbadankan dan bermastautin di Malaysia.")+'</p><p class="note-text">'+(C?"The registered office of the Company is located in Malaysia.":"Pejabat berdaftar Syarikat terletak di Malaysia.")+'</p><p class="note-text">'+(C?"The principal activities of the Company are ":"Aktiviti utama Syarikat adalah ")+(C?"general trading and provision of services.":"perdagangan am dan penyediaan perkhidmatan.")+'</p><p class="note-text">'+(C?"The financial statements were authorised for issue by the Board of Directors on ":"Penyata kewangan ini telah diluluskan untuk diterbitkan oleh Lembaga Pengarah pada ")+new Date().toLocaleDateString(C?"en-MY":"ms-MY",{day:"numeric",month:"long",year:"numeric"})+'.</p><div class="section-title">2. '+(C?"BASIS OF PREPARATION":"ASAS PENYEDIAAN")+'</div><p class="note-text"><strong>2.1 '+(C?"Statement of compliance":"Penyata pematuhan")+'</strong></p><p class="note-text">'+(C?"The financial statements of the Company have been prepared in accordance with "+S+' ("'+T+'") and the requirements of the Companies Act 2016 in Malaysia.':"Penyata kewangan Syarikat telah disediakan mengikut "+S+' ("'+T+'") dan keperluan Akta Syarikat 2016 di Malaysia.')+'</p><p class="note-text"><strong>2.2 '+(C?"Basis of measurement":"Asas pengukuran")+'</strong></p><p class="note-text">'+(C?"The financial statements have been prepared on the historical cost basis.":"Penyata kewangan telah disediakan berdasarkan kos sejarah.")+'</p><p class="note-text"><strong>2.3 '+(C?"Functional and presentation currency":"Mata wang fungsian dan pembentangan")+'</strong></p><p class="note-text">'+(C?`The financial statements are presented in Ringgit Malaysia ("RM"), which is the Company's functional currency.`:'Penyata kewangan ini dibentangkan dalam Ringgit Malaysia ("RM"), iaitu mata wang fungsian Syarikat.')+'</p></div><div class="page"><div class="company-header">'+v.toUpperCase()+" ("+b+')</div><div class="header"><h2>'+M.notes+" ("+(C?"continued":"sambungan")+')</h2></div><div class="section-title">3. '+(C?"SIGNIFICANT ACCOUNTING POLICIES":"DASAR PERAKAUNAN PENTING")+'</div><p class="note-text"><strong>3.1 '+(C?"Property, plant and equipment":"Hartanah, loji dan peralatan")+'</strong></p><p class="note-text">'+(C?"Property, plant and equipment are measured at cost less accumulated depreciation and any accumulated impairment losses.":"Hartanah, loji dan peralatan diukur pada kos ditolak susut nilai terkumpul dan kerugian rosot nilai terkumpul.")+'</p><p class="note-text">'+(C?"Depreciation is calculated using the straight-line method to allocate the cost of assets over their estimated useful lives. The annual depreciation rates used are as follows:":"Susut nilai dikira menggunakan kaedah garis lurus untuk memperuntukkan kos aset sepanjang anggaran hayat berguna. Kadar susut nilai tahunan yang digunakan adalah seperti berikut:")+'</p><table class="fs" style="margin:10px 0 10px 20px;width:90%"><tbody>'+(m.bs.ppe>0?De&&De.length>0?[...new Set(De.map(J=>J.category))].map(J=>{const Y=ge[J]||ge.OFFICE_EQUIPMENT;return'<tr><td style="width:60%">'+Y.label+'</td><td class="right">'+(Y.rate>0?Y.rate+"%":C?"Not depreciated":"Tidak disusutnilaikan")+"</td></tr>"}).join(""):'<tr><td style="width:60%">'+(C?"Buildings":"Bangunan")+'</td><td class="right">2%</td></tr><tr><td>'+(C?"Renovation":"Pengubahsuaian")+'</td><td class="right">10%</td></tr><tr><td>'+(C?"Plant and machinery":"Loji dan jentera")+'</td><td class="right">10%</td></tr><tr><td>'+(C?"Motor vehicles":"Kenderaan bermotor")+'</td><td class="right">20%</td></tr><tr><td>'+(C?"Office equipment":"Peralatan pejabat")+'</td><td class="right">10%</td></tr><tr><td>'+(C?"Computer equipment":"Peralatan komputer")+'</td><td class="right">33.33%</td></tr><tr><td>'+(C?"Furniture and fittings":"Perabot dan kelengkapan")+'</td><td class="right">10%</td></tr>':"")+'</tbody></table><p class="note-text"><strong>3.2 '+(C?"Inventories":"Inventori")+'</strong></p><p class="note-text">'+(C?"Inventories are measured at the lower of cost and net realisable value. Cost is determined using the first-in, first-out (FIFO) method.":"Inventori diukur pada kos atau nilai boleh realis bersih yang lebih rendah. Kos ditentukan menggunakan kaedah masuk-dahulu-keluar-dahulu (FIFO).")+'</p><p class="note-text"><strong>3.3 '+(C?"Financial instruments":"Instrumen kewangan")+'</strong></p><p class="note-text">'+(C?"Financial assets and liabilities are recognised when the Company becomes a party to the contractual provisions. Trade receivables and payables are initially measured at the transaction price and subsequently at amortised cost.":"Aset dan liabiliti kewangan diiktiraf apabila Syarikat menjadi pihak kepada peruntukan kontrak. Penghutang dan pemiutang perdagangan diukur pada mulanya pada harga transaksi dan seterusnya pada kos terlunas.")+'</p><p class="note-text"><strong>3.4 '+(C?"Revenue recognition":"Pengiktirafan hasil")+'</strong></p><p class="note-text">'+(C?"Revenue is measured at the fair value of the consideration received or receivable. Revenue from sale of goods is recognised when the significant risks and rewards of ownership have been transferred to the buyer. Revenue from services is recognised when the services are rendered.":"Hasil diukur pada nilai saksama balasan yang diterima atau akan diterima. Hasil daripada jualan barangan diiktiraf apabila risiko dan ganjaran pemilikan yang ketara telah dipindahkan kepada pembeli. Hasil daripada perkhidmatan diiktiraf apabila perkhidmatan diberikan.")+'</p></div><div class="page"><div class="company-header">'+v.toUpperCase()+" ("+b+')</div><div class="header"><h2>'+M.notes+" ("+(C?"continued":"sambungan")+')</h2></div><div class="section-title">4. '+(C?"PROPERTY, PLANT AND EQUIPMENT":"HARTANAH, LOJI DAN PERALATAN")+"</div>"+(De&&De.length>0?'<table class="note-table"><thead><tr><th style="width:35%">'+(C?"Description":"Keterangan")+'</th><th class="right" style="width:15%">'+(C?"Cost":"Kos")+'<br>RM</th><th class="right" style="width:20%">'+(C?"Accumulated Depreciation":"Susut Nilai Terkumpul")+'<br>RM</th><th class="right" style="width:15%">'+(C?"Net Book Value":"Nilai Buku Bersih")+'<br>RM</th><th class="right" style="width:15%">'+(C?"Rate":"Kadar")+"<br>%</th></tr></thead><tbody>"+De.map(J=>{const Y=ge[J.category]||ge.OFFICE_EQUIPMENT,ze=parseFloat(J.cost)||0,Le=parseFloat(J.accDepBF)||0,me=Math.min(ze*(Y.rate/100),ze-Le),qe=Le+me,Ye=ze-qe;return"<tr><td>"+(J.description||"-")+'</td><td class="right">'+X(ze)+'</td><td class="right">'+X(qe)+'</td><td class="right">'+X(Ye)+'</td><td class="right">'+Y.rate+"</td></tr>"}).join("")+'<tr style="font-weight:bold;border-top:2px solid #000"><td>'+(C?"Total":"Jumlah")+'</td><td class="right">'+X(rt.ppe.cost)+'</td><td class="right">'+X(rt.ppe.accDepCF)+'</td><td class="right">'+X(rt.ppe.nbv)+"</td><td></td></tr></tbody></table>":'<table class="fs"><tbody><tr><td style="width:60%">'+(C?"At cost":"Pada kos")+'</td><td class="right">'+X((m.bs.ppe||0)+(m.bs.accDep||0))+"</td></tr><tr><td>"+(C?"Less: Accumulated depreciation":"Tolak: Susut nilai terkumpul")+'</td><td class="right">('+X(m.bs.accDep||0)+')</td></tr><tr style="border-top:1px solid #000"><td class="bold">'+(C?"Net book value":"Nilai buku bersih")+'</td><td class="right bold">'+X(m.bs.ppe)+"</td></tr></tbody></table>")+'<p class="note-text" style="margin-top:10px">'+(C?"Depreciation charge for the year: RM "+X(rt.ppe.currentDep||m.is.details.DEPRECIATION||0):"Caj susut nilai bagi tahun: RM "+X(rt.ppe.currentDep||m.is.details.DEPRECIATION||0))+'</p><div class="section-title">5. '+(C?"INVENTORIES":"INVENTORI")+'</div><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Trading goods / Finished goods":"Barang dagangan / Barang siap")+'</td><td class="right">'+X(m.bs.inv)+"</td></tr></tbody></table>"+(m.bs.inv>0?'<p class="note-text">'+(C?"Inventories are stated at the lower of cost and net realisable value.":"Inventori dinyatakan pada kos atau nilai boleh realis bersih yang lebih rendah.")+"</p>":"")+'<div class="section-title">6. '+(C?"TRADE AND OTHER RECEIVABLES":"PENGHUTANG PERDAGANGAN DAN LAIN-LAIN")+'</div><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Trade receivables":"Penghutang perdagangan")+'</td><td class="right">'+X(m.bs.tr)+"</td></tr>"+(m.bs.or>0?"<tr><td>"+(C?"Other receivables":"Penghutang lain")+'</td><td class="right">'+X(m.bs.or)+"</td></tr>":"")+(m.bs.prepaid>0?"<tr><td>"+(C?"Prepayments":"Bayaran terdahulu")+'</td><td class="right">'+X(m.bs.prepaid)+"</td></tr>":"")+(m.bs.deposits>0?"<tr><td>"+(C?"Deposits":"Deposit")+'</td><td class="right">'+X(m.bs.deposits)+"</td></tr>":"")+'<tr style="border-top:1px solid #000"><td class="bold">'+(C?"Total":"Jumlah")+'</td><td class="right bold">'+X((m.bs.tr||0)+(m.bs.or||0)+(m.bs.prepaid||0)+(m.bs.deposits||0))+'</td></tr></tbody></table></div><div class="page"><div class="company-header">'+v.toUpperCase()+" ("+b+')</div><div class="header"><h2>'+M.notes+" ("+(C?"continued":"sambungan")+')</h2></div><div class="section-title">7. '+(C?"CASH AND BANK BALANCES":"TUNAI DAN BAKI BANK")+'</div><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Cash in hand":"Tunai dalam tangan")+'</td><td class="right">'+X(m.bs.cashInHand||0)+"</td></tr><tr><td>"+(C?"Cash at bank":"Tunai di bank")+'</td><td class="right">'+X(m.bs.cash-(m.bs.cashInHand||0))+'</td></tr><tr style="border-top:1px solid #000"><td class="bold">'+(C?"Total":"Jumlah")+'</td><td class="right bold">'+X(m.bs.cash)+'</td></tr></tbody></table><div class="section-title">8. '+(C?"SHARE CAPITAL":"MODAL SAHAM")+'</div><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Issued and fully paid:":"Diterbitkan dan berbayar penuh:")+'</td><td></td></tr><tr><td class="indent">'+(C?"Ordinary shares":"Saham biasa")+'</td><td class="right">'+X(m.bs.cap)+'</td></tr></tbody></table><div class="section-title">9. '+(C?"TRADE AND OTHER PAYABLES":"PEMIUTANG PERDAGANGAN DAN LAIN-LAIN")+'</div><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Trade payables":"Pemiutang perdagangan")+'</td><td class="right">'+X(m.bs.tp)+"</td></tr>"+(m.bs.op>0?"<tr><td>"+(C?"Other payables and accruals":"Pemiutang lain dan akruan")+'</td><td class="right">'+X(m.bs.op)+"</td></tr>":"")+'<tr style="border-top:1px solid #000"><td class="bold">'+(C?"Total":"Jumlah")+'</td><td class="right bold">'+X((m.bs.tp||0)+(m.bs.op||0))+"</td></tr></tbody></table>"+(m.bs.borr>0?'<div class="section-title">10. '+(C?"BORROWINGS":"PINJAMAN")+'</div><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Bank loan - secured":"Pinjaman bank - bercagar")+'</td><td class="right">'+X(m.bs.borr)+'</td></tr></tbody></table><p class="note-text">'+(C?"The bank loan is secured by a charge over the Company's assets.":"Pinjaman bank dijamin oleh gadaian ke atas aset Syarikat.")+"</p>":"")+'</div><div class="page"><div class="company-header">'+v.toUpperCase()+" ("+b+')</div><div class="header"><h2>'+M.notes+" ("+(C?"continued":"sambungan")+')</h2></div><div class="section-title">'+(m.bs.borr>0?"11":"10")+". "+(C?"REVENUE":"HASIL")+'</div><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Sale of goods":"Jualan barangan")+'</td><td class="right">'+X(m.is.details.SALES||m.is.rev)+"</td></tr>"+(m.is.details.SERVICE_REVENUE>0?"<tr><td>"+(C?"Rendering of services":"Pemberian perkhidmatan")+'</td><td class="right">'+X(m.is.details.SERVICE_REVENUE)+"</td></tr>":"")+'<tr style="border-top:1px solid #000"><td class="bold">'+(C?"Total revenue":"Jumlah hasil")+'</td><td class="right bold">'+X(m.is.rev)+'</td></tr></tbody></table><div class="section-title">'+(m.bs.borr>0?"12":"11")+". "+(C?"COST OF SALES":"KOS JUALAN")+'</div><table class="fs"><tbody>'+(m.is.details.OPENING_STOCK>0?'<tr><td style="width:60%">'+(C?"Opening inventory":"Inventori awal")+'</td><td class="right">'+X(m.is.details.OPENING_STOCK)+"</td></tr>":"")+'<tr><td style="width:60%">'+(C?"Purchases":"Belian")+'</td><td class="right">'+X(m.is.details.PURCHASE||m.is.cos)+"</td></tr>"+(m.is.details.DIRECT_COSTS>0?"<tr><td>"+(C?"Direct costs":"Kos langsung")+'</td><td class="right">'+X(m.is.details.DIRECT_COSTS)+"</td></tr>":"")+(m.is.details.CLOSING_STOCK>0?"<tr><td>"+(C?"Less: Closing inventory":"Tolak: Inventori akhir")+'</td><td class="right">('+X(m.is.details.CLOSING_STOCK)+")</td></tr>":"")+'<tr style="border-top:1px solid #000"><td class="bold">'+(C?"Total cost of sales":"Jumlah kos jualan")+'</td><td class="right bold">'+X(m.is.cos)+'</td></tr></tbody></table><div class="section-title">'+(m.bs.borr>0?"13":"12")+". "+(C?"ADMINISTRATIVE EXPENSES":"PERBELANJAAN PENTADBIRAN")+'</div><p class="note-text">'+(C?"Included in administrative expenses are:":"Termasuk dalam perbelanjaan pentadbiran adalah:")+'</p><table class="fs"><tbody>'+(m.is.details.SALARY>0?'<tr><td style="width:60%">'+(C?"Staff costs (salaries, wages, EPF, SOCSO)":"Kos kakitangan (gaji, upah, KWSP, PERKESO)")+'</td><td class="right">'+X(m.is.details.SALARY+(m.is.details.EPF||0)+(m.is.details.SOCSO||0))+"</td></tr>":"")+((rt.ppe.currentDep||m.is.details.DEPRECIATION||0)>0?"<tr><td>"+(C?"Depreciation of property, plant and equipment":"Susut nilai hartanah, loji dan peralatan")+'</td><td class="right">'+X(rt.ppe.currentDep||m.is.details.DEPRECIATION||0)+"</td></tr>":"")+(m.is.details.RENT>0?"<tr><td>"+(C?"Rental of premises":"Sewa premis")+'</td><td class="right">'+X(m.is.details.RENT)+"</td></tr>":"")+(m.is.details.UTILITIES>0?"<tr><td>"+(C?"Utilities":"Utiliti")+'</td><td class="right">'+X(m.is.details.UTILITIES)+"</td></tr>":"")+(m.is.details.PROFESSIONAL_FEES>0?"<tr><td>"+(C?"Professional fees":"Yuran profesional")+'</td><td class="right">'+X(m.is.details.PROFESSIONAL_FEES)+"</td></tr>":"")+(m.is.details.MARKETING>0?"<tr><td>"+(C?"Marketing and advertising":"Pemasaran dan pengiklanan")+'</td><td class="right">'+X(m.is.details.MARKETING)+"</td></tr>":"")+(m.is.details.TRANSPORT>0?"<tr><td>"+(C?"Transport and travelling":"Pengangkutan dan perjalanan")+'</td><td class="right">'+X(m.is.details.TRANSPORT)+"</td></tr>":"")+(m.is.details.REPAIR_MAINTENANCE>0?"<tr><td>"+(C?"Repairs and maintenance":"Pembaikan dan penyelenggaraan")+'</td><td class="right">'+X(m.is.details.REPAIR_MAINTENANCE)+"</td></tr>":"")+(m.is.details.INSURANCE>0?"<tr><td>"+(C?"Insurance":"Insurans")+'</td><td class="right">'+X(m.is.details.INSURANCE)+"</td></tr>":"")+(m.is.details.BANK_CHARGES>0?"<tr><td>"+(C?"Bank charges":"Caj bank")+'</td><td class="right">'+X(m.is.details.BANK_CHARGES)+"</td></tr>":"")+(m.is.details.ENTERTAINMENT>0?"<tr><td>"+(C?"Entertainment":"Keraian")+'</td><td class="right">'+X(m.is.details.ENTERTAINMENT)+"</td></tr>":"")+(()=>{const J=(m.is.details.SALARY||0)+(m.is.details.EPF||0)+(m.is.details.SOCSO||0)+(rt.ppe.currentDep||m.is.details.DEPRECIATION||0)+(m.is.details.RENT||0)+(m.is.details.UTILITIES||0)+(m.is.details.PROFESSIONAL_FEES||0)+(m.is.details.MARKETING||0)+(m.is.details.TRANSPORT||0)+(m.is.details.REPAIR_MAINTENANCE||0)+(m.is.details.INSURANCE||0)+(m.is.details.BANK_CHARGES||0)+(m.is.details.ENTERTAINMENT||0),Y=(m.is.adm||0)-J;return Y>100?"<tr><td>"+(C?"Other expenses":"Perbelanjaan lain")+'</td><td class="right">'+X(Math.round(Y))+"</td></tr>":""})()+'<tr style="border-top:1px solid #000"><td class="bold">'+(C?"Total administrative expenses":"Jumlah perbelanjaan pentadbiran")+'</td><td class="right bold">'+X(m.is.adm)+'</td></tr></tbody></table></div><div class="page"><div class="company-header">'+v.toUpperCase()+" ("+b+')</div><div class="header"><h2>'+M.notes+" ("+(C?"continued":"sambungan")+")</h2></div>"+(m.is.fin>0?'<div class="section-title">'+(m.bs.borr>0?"14":"13")+". "+(C?"FINANCE COSTS":"KOS KEWANGAN")+'</div><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Interest expense on borrowings":"Perbelanjaan faedah atas pinjaman")+'</td><td class="right">'+X(m.is.fin)+"</td></tr></tbody></table>":"")+'<div class="section-title">'+(m.bs.borr>0?m.is.fin>0?"15":"14":m.is.fin>0?"14":"13")+". "+(C?"TAXATION":"CUKAI")+'</div><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Current tax":"Cukai semasa")+'</td><td class="right">'+X(m.is.tax)+'</td></tr></tbody></table><p class="note-text">'+(C?"Malaysian income tax is calculated at the statutory tax rate of "+Q+" on the estimated chargeable income for the year.":"Cukai pendapatan Malaysia dikira pada kadar cukai berkanun sebanyak "+Q+" ke atas anggaran pendapatan bercukai bagi tahun tersebut.")+'</p><p class="note-text"><strong>'+(C?"Tax Computation:":"Pengiraan Cukai:")+'</strong></p><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Profit/(Loss) before taxation":"Untung/(Rugi) sebelum cukai")+'</td><td class="right">'+X(m.is.pbt)+"</td></tr>"+(m.taxComputation?.totalAddBack>0?"<tr><td>"+(C?"Add: Non-deductible expenses":"Tambah: Perbelanjaan tidak dibenarkan")+'</td><td class="right">'+X(m.taxComputation.totalAddBack)+"</td></tr>":"")+"<tr><td><strong>"+(C?"Adjusted profit":"Keuntungan terlaras")+'</strong></td><td class="right"><strong>'+X(m.taxComputation?.adjustedProfit||m.is.pbt)+"</strong></td></tr>"+(m.taxComputation?.capitalAllowance>0?"<tr><td>"+(C?"Less: Capital allowance":"Tolak: Elaun modal")+'</td><td class="right">('+X(m.taxComputation.capitalAllowance)+")</td></tr>":"")+(m.taxComputation?.otherDeductions>0?"<tr><td>"+(C?"Less: Other deductions/reliefs":"Tolak: Potongan/pelepasan lain")+'</td><td class="right">('+X(m.taxComputation.otherDeductions)+")</td></tr>":"")+"<tr><td><strong>"+(C?"Chargeable income":"Pendapatan bercukai")+'</strong></td><td class="right"><strong>'+X(m.taxComputation?.taxableIncome||Math.max(0,m.is.pbt))+"</strong></td></tr><tr><td>"+(C?"Tax at statutory rate":"Cukai pada kadar berkanun")+'</td><td class="right">'+X(m.taxComputation?.grossTax||m.is.tax)+"</td></tr>"+(m.taxComputation?.zakat>0?"<tr><td>"+(C?"Less: Zakat rebate":"Tolak: Rebat zakat")+'</td><td class="right">('+X(m.taxComputation.zakat)+")</td></tr>":"")+'<tr style="border-top: 2px solid #000;"><td><strong>'+(C?"Tax payable":"Cukai kena bayar")+'</strong></td><td class="right"><strong>'+X(m.is.tax)+"</strong></td></tr></tbody></table>"+(C?'<p class="note-text">A reconciliation of income tax expense applicable to profit before taxation at the statutory income tax rate to income tax expense at the effective income tax rate of the Company is not presented as there are no material reconciling items.</p>':'<p class="note-text">Penyesuaian perbelanjaan cukai pendapatan yang berkenaan dengan keuntungan sebelum cukai pada kadar cukai berkanun kepada perbelanjaan cukai pendapatan pada kadar cukai efektif Syarikat tidak dibentangkan kerana tiada item penyesuaian yang material.</p>')+'<div class="section-title">'+(m.bs.borr>0?m.is.fin>0?"16":"15":m.is.fin>0?"15":"14")+". "+(C?"RELATED PARTY DISCLOSURES":"PENDEDAHAN PIHAK BERKAITAN")+'</div><p class="note-text"><strong>(a) '+(C?"Identities of related parties":"Identiti pihak berkaitan")+'</strong></p><p class="note-text">'+(C?"The Company has related party relationships with its directors and key management personnel.":"Syarikat mempunyai hubungan pihak berkaitan dengan pengarahnya dan kakitangan pengurusan utama.")+'</p><p class="note-text"><strong>(b) '+(C?"Key management personnel compensation":"Pampasan kakitangan pengurusan utama")+'</strong></p><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Directors' remuneration":"Imbuhan pengarah")+'</td><td class="right">'+X(m.is.details.DIRECTOR_FEE||Math.round((m.is.adm||0)*.15))+'</td></tr></tbody></table><p class="note-text">'+(C?"The remuneration of directors is determined by the shareholders having regard to the performance of individuals and market trends.":"Imbuhan pengarah ditentukan oleh pemegang saham dengan mengambil kira prestasi individu dan trend pasaran.")+'</p><div class="section-title">'+(m.bs.borr>0?m.is.fin>0?"17":"16":m.is.fin>0?"16":"15")+". "+(C?"AUDITORS' REMUNERATION":"IMBUHAN JURUAUDIT")+'</div><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Statutory audit fees":"Yuran audit berkanun")+'</td><td class="right">'+X(m.is.details.AUDIT_FEE||Math.round((m.is.adm||0)*.02))+"</td></tr></tbody></table></div></body></html>"}catch(v){return console.error("Error generating FS:",v),alert("Error generating financial statements: "+v.message),null}},xi=u=>String(u||"").replace(/[&<>"]/g,v=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"})[v]),Af=`
@page { size: A4; margin: 2cm; }
body { font-family: "Times New Roman", Times, serif; font-size: 11pt; color: #000; line-height: 1.4; }
h1, h2, h3 { margin: 0; padding: 0; }
.p-center { text-align: center; }
.small { font-size: 10pt; }
.muted { color: #333; }
.sp-1 { margin-top: 6pt; }
.sp-2 { margin-top: 12pt; }
.sp-3 { margin-top: 18pt; }

/* Page blocks */
.page { page-break-after: always; }
.page:last-child { page-break-after: auto; }

/* Word page break hint */
.w-pb { mso-special-character: line-break; page-break-before: always; }

/* Financial Statement Tables */
table.fs { width: 100%; border-collapse: separate; border-spacing: 0; table-layout: fixed; margin: 10pt 0; }
table.fs th, table.fs td { padding: 3pt 5pt; vertical-align: top; border: none; }
table.fs thead th { font-weight: bold; text-align: center; }
.desc { text-align: left; }
.note { text-align: center; width: 8%; }
.amt { text-align: right; white-space: nowrap; }
.bold { font-weight: bold; }
.ind1 { padding-left: 15pt !important; }
.ind2 { padding-left: 30pt !important; }

/* Lines ONLY under amount columns - inner div prevents border bleed */
.amt-line-top > div { border-top: 1px solid #000; padding-top: 2pt; }
.amt-line-bottom > div { border-bottom: 1px solid #000; padding-bottom: 2pt; }
.amt-line-double > div { border-bottom: 3px double #000; padding-bottom: 2pt; }

/* Header row bottom border */
.hdr-border > div { border-bottom: 1px solid #000; padding-bottom: 3pt; font-weight: bold; }

/* Notes tables */
table.noteTbl { width: 100%; border-collapse: separate; border-spacing: 0; table-layout: fixed; margin: 8pt 0; }
table.noteTbl th, table.noteTbl td { padding: 2pt 4pt; border: none; vertical-align: top; }

/* Section headers */
.section-title { font-size: 12pt; font-weight: bold; text-align: center; margin: 15pt 0 10pt 0; text-transform: uppercase; }
.section-subtitle { font-size: 11pt; text-align: center; margin-bottom: 15pt; }

/* Integral notes text */
.integral-note { font-size: 9pt; font-style: italic; text-align: center; margin-top: 20pt; color: #333; }

/* Note section styling */
.note-title { font-size: 11pt; font-weight: bold; margin: 15pt 0 8pt 0; }
.note-text { margin: 5pt 0 10pt 0; text-align: justify; }
`,_f=({title:u,bodyHtml:v})=>`<!DOCTYPE html>
<html xmlns:o="urn:schemas-microsoft-com:office:office"
      xmlns:w="urn:schemas-microsoft-com:office:word"
      xmlns="http://www.w3.org/TR/REC-html40">
<head>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="ProgId" content="Word.Document"/>
<meta name="Generator" content="FS Automation V8"/>
<title>${xi(u)}</title>
<style>${Af}</style>
</head>
<body>
${v}
</body>
</html>`.trim(),S0=(u="EN")=>{if(!m)return null;const v=s||"Company Name",b=f||"____________",S=u==="EN",T=sa?.fullStandard||"Malaysian Private Entities Reporting Standard",Q=new Date().toLocaleDateString("en-MY",{day:"numeric",month:"long",year:"numeric"}),j={title:S?"FINANCIAL STATEMENTS":"PENYATA KEWANGAN",forYear:S?"FOR THE FINANCIAL YEAR ENDED":"BAGI TAHUN KEWANGAN BERAKHIR",contents:S?"CONTENTS":"KANDUNGAN",sofp:S?"STATEMENT OF FINANCIAL POSITION":"PENYATA KEDUDUKAN KEWANGAN",sopl:S?"STATEMENT OF PROFIT OR LOSS AND OTHER COMPREHENSIVE INCOME":"PENYATA UNTUNG RUGI DAN PENDAPATAN KOMPREHENSIF LAIN",soce:S?"STATEMENT OF CHANGES IN EQUITY":"PENYATA PERUBAHAN EKUITI",socf:S?"STATEMENT OF CASH FLOWS":"PENYATA ALIRAN TUNAI",notes:S?"NOTES TO THE FINANCIAL STATEMENTS":"NOTA-NOTA KEPADA PENYATA KEWANGAN",asAt:S?"AS AT":"PADA",note:S?"Note":"Nota",rm:"RM",assets:S?"ASSETS":"ASET",nca:S?"Non-Current Assets":"Aset Bukan Semasa",ppe:S?"Property, plant and equipment":"Hartanah, loji dan peralatan",ca:S?"Current Assets":"Aset Semasa",inventories:S?"Inventories":"Inventori",tradeRec:S?"Trade and other receivables":"Penghutang perdagangan dan lain-lain",cashBank:S?"Cash and bank balances":"Tunai dan baki bank",totalAssets:S?"TOTAL ASSETS":"JUMLAH ASET",equityLiab:S?"EQUITY AND LIABILITIES":"EKUITI DAN LIABILITI",equity:S?"Equity":"Ekuiti",shareCap:S?"Share capital":"Modal saham",retained:S?"Retained earnings":"Pendapatan tertahan",totalEquity:S?"Total Equity":"Jumlah Ekuiti",cl:S?"Current Liabilities":"Liabiliti Semasa",tradePay:S?"Trade and other payables":"Pemiutang perdagangan dan lain-lain",borrowings:S?"Borrowings":"Pinjaman",taxPayable:S?"Tax payable":"Cukai kena bayar",totalLiab:S?"Total Liabilities":"Jumlah Liabiliti",totalEL:S?"TOTAL EQUITY AND LIABILITIES":"JUMLAH EKUITI DAN LIABILITI",revenue:S?"Revenue":"Hasil",costOfSales:S?"Cost of sales":"Kos jualan",grossProfit:S?"Gross profit":"Untung kasar",otherIncome:S?"Other income":"Pendapatan lain",adminExp:S?"Administrative expenses":"Perbelanjaan pentadbiran",finCosts:S?"Finance costs":"Kos kewangan",pbt:S?"Profit before taxation":"Untung sebelum cukai",tax:S?"Taxation":"Cukai",profitYear:S?"Profit for the financial year":"Untung bagi tahun kewangan",oci:S?"Other comprehensive income":"Pendapatan komprehensif lain",totalCI:S?"Total comprehensive income for the year":"Jumlah pendapatan komprehensif bagi tahun",integral:S?"The accompanying notes form an integral part of these financial statements.":"Nota-nota yang dilampirkan merupakan sebahagian yang tidak terpisahkan daripada penyata kewangan ini.",genOn:S?"Generated on":"Dijana pada",incMalaysia:S?"Incorporated in Malaysia":"Diperbadankan di Malaysia",regNo:S?"Registration No.":"No. Pendaftaran"},C=Da=>{if(Da==null||Da===0)return"-";const Dn=Number(Da);return Dn<0?`(${Math.abs(Dn).toLocaleString("en-MY")})`:Dn.toLocaleString("en-MY")},M=(Da,Dn="",Ii=!1)=>`<td class="${["amt",Dn,Ii?"bold":""].filter(Boolean).join(" ")}"><div>${Da}</div></td>`,X='<colgroup><col style="width:60%"/><col style="width:8%"/><col style="width:16%"/><col style="width:16%"/></colgroup>',ye='<colgroup><col style="width:40%"/><col style="width:20%"/><col style="width:20%"/><col style="width:20%"/></colgroup>',Fe='<colgroup><col style="width:60%"/><col style="width:20%"/><col style="width:20%"/></colgroup>',Ce=`
<div class="page">
  <table style="width:100%; height:22cm;">
    <tr>
      <td style="text-align:center; vertical-align:middle;">
        <div style="font-size:16pt; font-weight:bold;">${xi(v.toUpperCase())}</div>
        <div class="sp-1" style="font-size:11pt;">(${j.regNo} ${xi(b)})</div>
        <div style="font-size:11pt;">(${j.incMalaysia})</div>
        <div class="sp-3" style="font-size:14pt; font-weight:bold;">${j.title}</div>
        <div class="sp-2" style="font-size:12pt;">${j.forYear}</div>
        <div style="font-size:12pt; font-weight:bold;">31 DECEMBER ${L}</div>
        <div class="sp-3 small muted">${xi(T)}</div>
        <div class="sp-2 small muted">${j.genOn}: ${xi(Q)}</div>
      </td>
    </tr>
  </table>
</div>`,J=`
<div class="page">
  <div class="section-title">${j.contents}</div>
  <table style="width:60%; margin:30pt auto;">
    <tr><td style="padding:5pt 0;">${j.sofp}</td><td style="text-align:right; width:50px;">1</td></tr>
    <tr><td style="padding:5pt 0;">${j.sopl}</td><td style="text-align:right;">2</td></tr>
    <tr><td style="padding:5pt 0;">${j.soce}</td><td style="text-align:right;">3</td></tr>
    <tr><td style="padding:5pt 0;">${j.socf}</td><td style="text-align:right;">4</td></tr>
    <tr><td style="padding:5pt 0;">${j.notes}</td><td style="text-align:right;">5 - 8</td></tr>
  </table>
</div>`;let Y="";Y+=`<tr>
      <td class="desc"></td>
      <td class="note hdr-border"><div>${j.note}</div></td>
      <td class="amt hdr-border"><div>${L}<br/>${j.rm}</div></td>
      <td class="amt hdr-border"><div>${L-1}<br/>${j.rm}</div></td>
    </tr>`,Y+=`<tr><td class="desc bold">${j.assets}</td><td class="note"></td><td class="amt"><div></div></td><td class="amt"><div></div></td></tr>`,Y+=`<tr><td class="desc bold">${j.nca}</td><td class="note"></td><td class="amt"><div></div></td><td class="amt"><div></div></td></tr>`,m.bs.ppe>0&&(Y+=`<tr><td class="desc ind1">${j.ppe}</td><td class="note">3</td>${M(C(m.bs.ppe))}${M("-")}</tr>`),Y+=`<tr><td class="desc"></td><td class="note"></td>${M(C(m.bs.ppe||0),"amt-line-bottom")}${M("-","amt-line-bottom")}</tr>`,Y+=`<tr><td class="desc bold" style="padding-top:10pt;">${j.ca}</td><td class="note"></td><td class="amt"><div></div></td><td class="amt"><div></div></td></tr>`,m.bs.inv>0&&(Y+=`<tr><td class="desc ind1">${j.inventories}</td><td class="note">4</td>${M(C(m.bs.inv))}${M("-")}</tr>`),m.bs.recv>0&&(Y+=`<tr><td class="desc ind1">${j.tradeRec}</td><td class="note">5</td>${M(C(m.bs.recv))}${M("-")}</tr>`),Y+=`<tr><td class="desc ind1">${j.cashBank}</td><td class="note">6</td>${M(C(m.bs.cash))}${M("-")}</tr>`,Y+=`<tr><td class="desc"></td><td class="note"></td>${M(C(m.bs.totCA),"amt-line-bottom")}${M("-","amt-line-bottom")}</tr>`,Y+=`<tr><td class="desc bold">${j.totalAssets}</td><td class="note"></td>${M(C(m.bs.totA),"amt-line-double",!0)}${M("-","amt-line-double",!0)}</tr>`,Y+=`<tr><td class="desc bold" style="padding-top:15pt;">${j.equityLiab}</td><td class="note"></td><td class="amt"><div></div></td><td class="amt"><div></div></td></tr>`,Y+=`<tr><td class="desc bold">${j.equity}</td><td class="note"></td><td class="amt"><div></div></td><td class="amt"><div></div></td></tr>`,Y+=`<tr><td class="desc ind1">${j.shareCap}</td><td class="note">7</td>${M(C(m.bs.shareCap))}${M("-")}</tr>`,Y+=`<tr><td class="desc ind1">${j.retained}</td><td class="note"></td>${M(C(m.bs.retainedEarnings))}${M("-")}</tr>`,Y+=`<tr><td class="desc bold">${j.totalEquity}</td><td class="note"></td>${M(C(m.bs.totE),"amt-line-bottom",!0)}${M("-","amt-line-bottom",!0)}</tr>`,Y+=`<tr><td class="desc bold" style="padding-top:10pt;">${j.cl}</td><td class="note"></td><td class="amt"><div></div></td><td class="amt"><div></div></td></tr>`,m.bs.payables>0&&(Y+=`<tr><td class="desc ind1">${j.tradePay}</td><td class="note">8</td>${M(C(m.bs.payables))}${M("-")}</tr>`),m.bs.borrowings>0&&(Y+=`<tr><td class="desc ind1">${j.borrowings}</td><td class="note">9</td>${M(C(m.bs.borrowings))}${M("-")}</tr>`),m.bs.taxPayable>0&&(Y+=`<tr><td class="desc ind1">${j.taxPayable}</td><td class="note"></td>${M(C(m.bs.taxPayable))}${M("-")}</tr>`),Y+=`<tr><td class="desc bold">${j.totalLiab}</td><td class="note"></td>${M(C(m.bs.totL),"amt-line-bottom",!0)}${M("-","amt-line-bottom",!0)}</tr>`,Y+=`<tr><td class="desc bold" style="padding-top:8pt;">${j.totalEL}</td><td class="note"></td>${M(C(m.bs.totA),"amt-line-double",!0)}${M("-","amt-line-double",!0)}</tr>`;const ze=`
<div class="page">
  <div class="section-title">${j.sofp}</div>
  <div class="section-subtitle">${j.asAt} 31 DECEMBER ${L}</div>
  <table class="fs">${X}<tbody>${Y}</tbody></table>
  <div class="integral-note">${j.integral}</div>
</div>`;let Le="";Le+=`<tr>
      <td class="desc"></td>
      <td class="note hdr-border"><div>${j.note}</div></td>
      <td class="amt hdr-border"><div>${L}<br/>${j.rm}</div></td>
      <td class="amt hdr-border"><div>${L-1}<br/>${j.rm}</div></td>
    </tr>`,Le+=`<tr><td class="desc">${j.revenue}</td><td class="note">10</td>${M(C(m.is.rev))}${M("-")}</tr>`,Le+=`<tr><td class="desc">${j.costOfSales}</td><td class="note"></td>${M("("+C(m.is.cos)+")")}${M("-")}</tr>`,Le+=`<tr><td class="desc bold">${j.grossProfit}</td><td class="note"></td>${M(C(m.is.gp),"amt-line-bottom",!0)}${M("-","amt-line-bottom",!0)}</tr>`,m.is.oi>0&&(Le+=`<tr><td class="desc">${j.otherIncome}</td><td class="note">11</td>${M(C(m.is.oi))}${M("-")}</tr>`),Le+=`<tr><td class="desc">${j.adminExp}</td><td class="note">12</td>${M("("+C(m.is.adm)+")")}${M("-")}</tr>`,m.is.fin>0&&(Le+=`<tr><td class="desc">${j.finCosts}</td><td class="note"></td>${M("("+C(m.is.fin)+")")}${M("-")}</tr>`),Le+=`<tr><td class="desc bold">${j.pbt}</td><td class="note"></td>${M(C(m.is.pbt),"amt-line-bottom",!0)}${M("-","amt-line-bottom",!0)}</tr>`,Le+=`<tr><td class="desc">${j.tax}</td><td class="note">13</td>${M(m.is.tax>0?"("+C(m.is.tax)+")":"-")}${M("-")}</tr>`,Le+=`<tr><td class="desc bold">${j.profitYear}</td><td class="note"></td>${M(C(m.is.np),"amt-line-double",!0)}${M("-","amt-line-double",!0)}</tr>`,Le+=`<tr><td class="desc" style="padding-top:12pt;"><em>${j.oci}</em></td><td class="note"></td>${M("-")}${M("-")}</tr>`,Le+=`<tr><td class="desc bold">${j.totalCI}</td><td class="note"></td>${M(C(m.is.np),"amt-line-double",!0)}${M("-","amt-line-double",!0)}</tr>`;const me=`
<div class="page">
  <div class="section-title">${j.sopl}</div>
  <div class="section-subtitle">${j.forYear} 31 DECEMBER ${L}</div>
  <table class="fs">${X}<tbody>${Le}</tbody></table>
  <div class="integral-note">${j.integral}</div>
</div>`,qe=(m.bs.retainedEarnings||0)-(m.is.np||0),Ye=(m.bs.shareCap||0)+qe;let ot="";ot+=`<tr>
      <td class="desc"></td>
      <td class="amt hdr-border"><div>${j.shareCap}<br/>${j.rm}</div></td>
      <td class="amt hdr-border"><div>${j.retained}<br/>${j.rm}</div></td>
      <td class="amt hdr-border"><div>${S?"Total":"Jumlah"}<br/>${j.rm}</div></td>
    </tr>`,ot+=`<tr><td class="desc">${S?"Balance at 1 January":"Baki pada 1 Januari"} ${L}</td>${M(C(m.bs.shareCap))}${M(C(qe))}${M(C(Ye))}</tr>`,ot+=`<tr><td class="desc">${j.profitYear}</td>${M("-")}${M(C(m.is.np))}${M(C(m.is.np))}</tr>`,ot+=`<tr><td class="desc bold">${S?"Balance at 31 December":"Baki pada 31 Disember"} ${L}</td>${M(C(m.bs.shareCap),"amt-line-double",!0)}${M(C(m.bs.retainedEarnings),"amt-line-double",!0)}${M(C(m.bs.totE),"amt-line-double",!0)}</tr>`;const Xt=`
<div class="page">
  <div class="section-title">${j.soce}</div>
  <div class="section-subtitle">${j.forYear} 31 DECEMBER ${L}</div>
  <table class="fs">${ye}<tbody>${ot}</tbody></table>
  <div class="integral-note">${j.integral}</div>
</div>`;let ct="";ct+=`<tr>
      <td class="desc"></td>
      <td class="amt hdr-border"><div>${L}<br/>${j.rm}</div></td>
      <td class="amt hdr-border"><div>${L-1}<br/>${j.rm}</div></td>
    </tr>`,ct+=`<tr><td class="desc bold">${S?"Cash flows from operating activities":"Aliran tunai daripada aktiviti operasi"}</td><td class="amt"><div></div></td><td class="amt"><div></div></td></tr>`,ct+=`<tr><td class="desc ind1">${j.profitYear}</td>${M(C(m.is.np))}${M("-")}</tr>`,ct+=`<tr><td class="desc ind1">${S?"Adjustments for:":"Pelarasan untuk:"}</td><td class="amt"><div></div></td><td class="amt"><div></div></td></tr>`,m.is.dep>0&&(ct+=`<tr><td class="desc ind2">${S?"Depreciation":"Susut nilai"}</td>${M(C(m.is.dep))}${M("-")}</tr>`),ct+=`<tr><td class="desc ind1">${S?"Operating profit before working capital changes":"Keuntungan operasi sebelum perubahan modal kerja"}</td>${M(C((m.is.np||0)+(m.is.dep||0)),"amt-line-bottom")}${M("-","amt-line-bottom")}</tr>`,m.bs.inv>0&&(ct+=`<tr><td class="desc ind1">${S?"Increase in inventories":"Kenaikan inventori"}</td>${M("("+C(m.bs.inv)+")")}${M("-")}</tr>`),m.bs.recv>0&&(ct+=`<tr><td class="desc ind1">${S?"Increase in receivables":"Kenaikan penghutang"}</td>${M("("+C(m.bs.recv)+")")}${M("-")}</tr>`),m.bs.payables>0&&(ct+=`<tr><td class="desc ind1">${S?"Increase in payables":"Kenaikan pemiutang"}</td>${M(C(m.bs.payables))}${M("-")}</tr>`);const ba=(m.is.np||0)+(m.is.dep||0)-(m.bs.inv||0)-(m.bs.recv||0)+(m.bs.payables||0);ct+=`<tr><td class="desc bold">${S?"Cash generated from operations":"Tunai dijana daripada operasi"}</td>${M(C(ba),"amt-line-bottom",!0)}${M("-","amt-line-bottom",!0)}</tr>`,ct+=`<tr><td class="desc bold" style="padding-top:12pt;">${S?"Cash flows from investing activities":"Aliran tunai daripada aktiviti pelaburan"}</td><td class="amt"><div></div></td><td class="amt"><div></div></td></tr>`,m.bs.ppe>0&&(ct+=`<tr><td class="desc ind1">${S?"Purchase of property, plant and equipment":"Pembelian hartanah, loji dan peralatan"}</td>${M("("+C(m.bs.ppe_cost||m.bs.ppe)+")")}${M("-")}</tr>`);const nt=-(m.bs.ppe_cost||m.bs.ppe||0);ct+=`<tr><td class="desc bold">${S?"Net cash used in investing activities":"Tunai bersih digunakan dalam aktiviti pelaburan"}</td>${M(C(nt),"amt-line-bottom",!0)}${M("-","amt-line-bottom",!0)}</tr>`,ct+=`<tr><td class="desc bold" style="padding-top:12pt;">${S?"Cash flows from financing activities":"Aliran tunai daripada aktiviti pembiayaan"}</td><td class="amt"><div></div></td><td class="amt"><div></div></td></tr>`,ct+=`<tr><td class="desc ind1">${S?"Proceeds from issuance of share capital":"Hasil daripada penerbitan modal saham"}</td>${M(C(m.bs.shareCap))}${M("-")}</tr>`,m.bs.borrowings>0&&(ct+=`<tr><td class="desc ind1">${S?"Proceeds from borrowings":"Hasil daripada pinjaman"}</td>${M(C(m.bs.borrowings))}${M("-")}</tr>`);const Aa=(m.bs.shareCap||0)+(m.bs.borrowings||0);ct+=`<tr><td class="desc bold">${S?"Net cash from financing activities":"Tunai bersih daripada aktiviti pembiayaan"}</td>${M(C(Aa),"amt-line-bottom",!0)}${M("-","amt-line-bottom",!0)}</tr>`,ct+=`<tr><td class="desc bold" style="padding-top:12pt;">${S?"Net increase in cash and cash equivalents":"Kenaikan bersih dalam tunai dan setara tunai"}</td>${M(C(m.bs.cash),"",!0)}${M("-")}</tr>`,ct+=`<tr><td class="desc">${S?"Cash and cash equivalents at beginning of year":"Tunai dan setara tunai pada awal tahun"}</td>${M("-")}${M("-")}</tr>`,ct+=`<tr><td class="desc bold">${S?"Cash and cash equivalents at end of year":"Tunai dan setara tunai pada akhir tahun"}</td>${M(C(m.bs.cash),"amt-line-double",!0)}${M("-","amt-line-double",!0)}</tr>`;const Wa=`
<div class="page">
  <div class="section-title">${j.socf}</div>
  <div class="section-subtitle">${j.forYear} 31 DECEMBER ${L}</div>
  <table class="fs">${Fe}<tbody>${ct}</tbody></table>
  <div class="integral-note">${j.integral}</div>
</div>`,Zn=`<div class="page">${`
<div class="section-title">${j.notes}</div>
<div class="section-subtitle">${j.forYear} 31 DECEMBER ${L}</div>

<div class="note-title">1. ${S?"GENERAL INFORMATION":"MAKLUMAT AM"}</div>
<p class="note-text">${xi(v)} ${S?"is a private limited company, incorporated and domiciled in Malaysia. The registered office and principal place of business of the Company is located in Malaysia.":"adalah sebuah syarikat sendirian berhad yang diperbadankan dan bermastautin di Malaysia. Pejabat berdaftar dan tempat perniagaan utama Syarikat terletak di Malaysia."}</p>
<p class="note-text">${S?"The principal activity of the Company is":"Aktiviti utama Syarikat adalah"} ${xi(sa?.activity||(S?"general trading and services.":"perdagangan dan perkhidmatan am."))}</p>

<div class="note-title">2. ${S?"BASIS OF PREPARATION":"ASAS PENYEDIAAN"}</div>
<p class="note-text">${S?"The financial statements of the Company have been prepared in accordance with":"Penyata kewangan Syarikat telah disediakan mengikut"} ${xi(T)} ${S?"and the requirements of the Companies Act 2016 in Malaysia.":"dan keperluan Akta Syarikat 2016 di Malaysia."}</p>

<div class="note-title">3. ${S?"PROPERTY, PLANT AND EQUIPMENT":"HARTANAH, LOJI DAN PERALATAN"}</div>
${m.bs.ppe>0?`
<table class="noteTbl">
  <colgroup><col style="width:50%"/><col style="width:16%"/><col style="width:17%"/><col style="width:17%"/></colgroup>
  <tr>
    <td></td>
    <td class="amt hdr-border"><div>${S?"Cost":"Kos"}<br/>${j.rm}</div></td>
    <td class="amt hdr-border"><div>${S?"Acc. Dep.":"Susut Nilai"}<br/>${j.rm}</div></td>
    <td class="amt hdr-border"><div>NBV<br/>${j.rm}</div></td>
  </tr>
  <tr>
    <td>${S?"Plant & equipment":"Loji & peralatan"}</td>
    ${M(C(m.bs.ppe_cost||m.bs.ppe))}
    ${M(C(m.bs.ppe_accDep||0))}
    ${M(C(m.bs.ppe),"amt-line-double")}
  </tr>
</table>
`:`<p class="note-text">${S?"The Company does not have any property, plant and equipment.":"Syarikat tidak mempunyai sebarang hartanah, loji dan peralatan."}</p>`}

<div class="note-title">4. ${S?"SHARE CAPITAL":"MODAL SAHAM"}</div>
<table class="noteTbl">
  <colgroup><col style="width:70%"/><col style="width:30%"/></colgroup>
  <tr>
    <td>${S?"Issued and fully paid ordinary shares":"Saham biasa diterbitkan dan dibayar penuh"}</td>
    ${M(C(m.bs.shareCap),"amt-line-double")}
  </tr>
</table>

<div class="note-title">5. ${S?"REVENUE":"HASIL"}</div>
<table class="noteTbl">
  <colgroup><col style="width:70%"/><col style="width:30%"/></colgroup>
  <tr>
    <td>${S?"Revenue from contracts with customers":"Hasil daripada kontrak dengan pelanggan"}</td>
    ${M(C(m.is.rev),"amt-line-double")}
  </tr>
</table>

<div class="note-title">6. ${S?"ADMINISTRATIVE EXPENSES":"PERBELANJAAN PENTADBIRAN"}</div>
<table class="noteTbl">
  <colgroup><col style="width:70%"/><col style="width:30%"/></colgroup>
  ${m.is.details?.SALARY>0?`<tr><td>${S?"Staff costs":"Kos kakitangan"}</td>${M(C(m.is.details.SALARY))}</tr>`:""}
  ${m.is.details?.RENT>0?`<tr><td>${S?"Rental":"Sewa"}</td>${M(C(m.is.details.RENT))}</tr>`:""}
  ${m.is.details?.UTILITIES>0?`<tr><td>${S?"Utilities":"Utiliti"}</td>${M(C(m.is.details.UTILITIES))}</tr>`:""}
  ${m.is.dep>0?`<tr><td>${S?"Depreciation":"Susut nilai"}</td>${M(C(m.is.dep))}</tr>`:""}
  ${m.is.details?.PROFESSIONAL_FEES>0?`<tr><td>${S?"Professional fees":"Yuran profesional"}</td>${M(C(m.is.details.PROFESSIONAL_FEES))}</tr>`:""}
  ${m.is.details?.MISCELLANEOUS>0?`<tr><td>${S?"Other expenses":"Perbelanjaan lain"}</td>${M(C(m.is.details.MISCELLANEOUS))}</tr>`:""}
  <tr><td class="bold">${S?"Total":"Jumlah"}</td>${M(C(m.is.adm),"amt-line-double",!0)}</tr>
</table>

<div class="note-title">7. ${S?"TAXATION":"CUKAI"}</div>
<table class="noteTbl">
  <colgroup><col style="width:70%"/><col style="width:30%"/></colgroup>
  <tr>
    <td>${S?"Current tax expense":"Perbelanjaan cukai semasa"}</td>
    ${M(C(m.is.tax),"amt-line-double")}
  </tr>
</table>
<p class="note-text small">${S?"The tax expense is calculated based on the estimated chargeable income at the prevailing tax rate.":"Perbelanjaan cukai dikira berdasarkan anggaran pendapatan boleh dicukai pada kadar cukai semasa."}</p>
`}</div>`,Sa=[Ce,J,ze,me,Xt,Wa,Zn],vi=Sa[0]+Sa.slice(1).map(Da=>`<br clear="all" class="w-pb"/>${Da}`).join("");return _f({title:`${v} - Financial Statements ${L}`,bodyHtml:vi})},an=(u,v)=>{const b=URL.createObjectURL(u),S=document.createElement("a");S.href=b,S.download=v,document.body.appendChild(S),S.click(),S.remove(),setTimeout(()=>URL.revokeObjectURL(b),1500)},E0=(u,v="Report")=>{try{const b=document.createElement("iframe");b.style.position="fixed",b.style.right="0",b.style.bottom="0",b.style.width="0",b.style.height="0",b.style.border="0",b.style.visibility="hidden",document.body.appendChild(b);const S=b.contentWindow.document;return S.open(),S.write(u),S.title=v,S.close(),b.onload=()=>{try{b.contentWindow.focus(),b.contentWindow.print()}catch(T){console.error("Print failed:",T)}setTimeout(()=>{try{document.body.removeChild(b)}catch{}},2e3)},setTimeout(()=>{try{b.contentWindow.focus(),b.contentWindow.print()}catch{const Q=window.open("","_blank");Q?(Q.document.open(),Q.document.write(u),Q.document.title=v,Q.document.close(),setTimeout(()=>{Q.focus(),Q.print()},500)):alert('Could not open print dialog. Please use "Download HTML" and print from your browser.')}},1e3),!0}catch(b){return console.error("printHtmlToPdf error:",b),!1}},el=(u,v)=>{try{const b=Jy(u,{bookType:"xlsx",type:"array"}),S=new Blob([b],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});return an(S,v),!0}catch(b){return console.error("Excel export error:",b),!1}},mi="V8",ea={NONE:"none",TOP:"top",BOTTOM:"bottom",DOUBLE_TOP:"double-top",DOUBLE_BOTTOM:"double-bottom"},T0=(u,v)=>!u||v===ea.NONE?"":{[ea.TOP]:"border-top: 1px solid #000;",[ea.BOTTOM]:"border-bottom: 1px solid #000;",[ea.DOUBLE_TOP]:"border-top: 2px solid #000;",[ea.DOUBLE_BOTTOM]:"border-bottom: 3px double #000;"}[v]||"",tl=(u,v=ea.NONE)=>"<tr>"+u.map(b=>{const S=b.isAmt===!0,T=T0(S,v),Q=S?"right":b.align==="center"?"center":"",j=b.bold?" bold":"",C=b.indent?` padding-left: ${b.indent*15}px;`:"",M=T||C?` style="${T}${C}"`:"";return`<td class="${Q}${j}"${M}>${b.content||""}</td>`}).join("")+"</tr>",Ft=(u,v,b,S,T={})=>{const{bold:Q=!1,indent:j=0,line:C=ea.NONE}=T;return tl([{content:u,isAmt:!1,bold:Q,indent:j},{content:v,isAmt:!1,align:"center"},{content:b,isAmt:!0,bold:Q},{content:S,isAmt:!0,bold:Q}],C)},Ra=(u,v,b,S={})=>{const{bold:T=!1,indent:Q=0,line:j=ea.NONE}=S;return tl([{content:u,isAmt:!1,bold:T,indent:Q},{content:v,isAmt:!0,bold:T},{content:b,isAmt:!0,bold:T}],j)},ds=(u,v,b,S,T={})=>{const{bold:Q=!1,line:j=ea.NONE}=T;return tl([{content:u,isAmt:!1,bold:Q},{content:v,isAmt:!0,bold:Q},{content:b,isAmt:!0,bold:Q},{content:S,isAmt:!0,bold:Q}],j)},Fi=(u,v,b={})=>{const{bold:S=!1,line:T=ea.NONE}=b;return tl([{content:u,isAmt:!1,bold:S},{content:v,isAmt:!0,bold:S}],T)},A0={EN:{title:"FINANCIAL STATEMENTS",forYear:"FOR THE FINANCIAL YEAR ENDED",asAt:"AS AT",regNo:"Registration No.",incMalaysia:"Incorporated in Malaysia",contents:"CONTENTS",page:"Page",continued:"continued",sofp:"STATEMENT OF FINANCIAL POSITION",sopl:"STATEMENT OF PROFIT OR LOSS AND OTHER COMPREHENSIVE INCOME",soplSimple:"STATEMENT OF PROFIT OR LOSS",soce:"STATEMENT OF CHANGES IN EQUITY",socf:"STATEMENT OF CASH FLOWS",notes:"NOTES TO THE FINANCIAL STATEMENTS",statementByDirectors:"STATEMENT BY DIRECTORS",statutoryDeclaration:"STATUTORY DECLARATION",revenue:"Revenue",costOfSales:"Cost of sales",grossProfit:"Gross profit",otherIncome:"Other income",adminExp:"Administrative expenses",otherExp:"Other expenses",finCosts:"Finance costs",pbt:"Profit before taxation",tax:"Taxation",profitYear:"Profit for the financial year",lossYear:"Loss for the financial year",oci:"Other comprehensive income for the year",totalCI:"Total comprehensive income for the year",assets:"ASSETS",nca:"Non-Current Assets",ppe:"Property, plant and equipment",intangibles:"Intangible assets",investments:"Investments",ca:"Current Assets",inventories:"Inventories",tradeRec:"Trade receivables",otherRec:"Other receivables, deposits and prepayments",taxRecoverable:"Tax recoverable",cashBank:"Cash and bank balances",totalAssets:"TOTAL ASSETS",equityLiab:"EQUITY AND LIABILITIES",equity:"Equity",shareCap:"Share capital",retained:"Retained earnings/(accumulated losses)",totalEquity:"Total Equity",ownerCapital:"Owner's capital",drawings:"Less: Drawings",liabilities:"Liabilities",ncl:"Non-Current Liabilities",ltBorrowings:"Long-term borrowings",deferredTax:"Deferred tax liabilities",cl:"Current Liabilities",tradePay:"Trade payables",otherPay:"Other payables and accruals",stBorrowings:"Short-term borrowings",taxPayable:"Tax payable",totalLiab:"Total Liabilities",totalEL:"TOTAL EQUITY AND LIABILITIES",cfOperating:"Cash flows from operating activities",cfInvesting:"Cash flows from investing activities",cfFinancing:"Cash flows from financing activities",netCashOps:"Net cash from operating activities",netCashInv:"Net cash used in investing activities",netCashFin:"Net cash from/(used in) financing activities",netIncrease:"Net increase/(decrease) in cash and cash equivalents",cashBF:"Cash and cash equivalents at beginning of year",cashCF:"Cash and cash equivalents at end of year",balanceAt:"Balance at",profitForYear:"Profit/(loss) for the year",dividendsPaid:"Dividends paid",note:"Note",rm:"RM",total:"Total",notesIntegral:"The accompanying notes form an integral part of these financial statements.",basisOfPrep:"BASIS OF PREPARATION",basisText:"The financial statements of the Company have been prepared in accordance with",summaryPolicies:"SUMMARY OF SIGNIFICANT ACCOUNTING POLICIES",revenueRecog:"Revenue recognition",ppePolicy:"Property, plant and equipment",inventoryPolicy:"Inventories",financialInstr:"Financial instruments",taxPolicy:"Taxation",notePPE:"PROPERTY, PLANT AND EQUIPMENT",noteInventory:"INVENTORIES",noteTradeRec:"TRADE AND OTHER RECEIVABLES",noteCash:"CASH AND BANK BALANCES",noteShareCap:"SHARE CAPITAL",noteOwnerCap:"OWNER'S CAPITAL",noteTradePay:"TRADE AND OTHER PAYABLES",noteBorrowings:"BORROWINGS",noteRevenue:"REVENUE",noteExpenses:"ADMINISTRATIVE EXPENSES",noteCostOfSales:"COST OF SALES",noteFinCosts:"FINANCE COSTS",noteTax:"TAXATION",noteRelatedParty:"RELATED PARTY DISCLOSURES",noteContingent:"CONTINGENT LIABILITIES",noteCommitments:"COMMITMENTS",noteSubseqEvents:"SUBSEQUENT EVENTS",atCost:"At cost",lessAccDep:"Less: Accumulated depreciation",nbv:"Net book value",depCharge:"Depreciation charge for the year",tradingGoods:"Trading goods / Finished goods",cashInHand:"Cash in hand",cashAtBank:"Cash at bank",issuedPaid:"Issued and fully paid:",ordinaryShares:"Ordinary shares",saleOfGoods:"Sale of goods",renderingServices:"Rendering of services",noContingent:"There were no contingent liabilities as at the end of the financial year.",noCommitments:"There were no capital commitments as at the end of the financial year.",noSubseqEvents:"There were no significant events occurring after the balance sheet date that require adjustments or disclosure in the financial statements."},BM:{title:"PENYATA KEWANGAN",forYear:"BAGI TAHUN KEWANGAN BERAKHIR",asAt:"PADA",regNo:"No. Pendaftaran",incMalaysia:"Diperbadankan di Malaysia",contents:"KANDUNGAN",page:"Muka Surat",continued:"sambungan",sofp:"PENYATA KEDUDUKAN KEWANGAN",sopl:"PENYATA UNTUNG RUGI DAN PENDAPATAN KOMPREHENSIF LAIN",soplSimple:"PENYATA UNTUNG RUGI",soce:"PENYATA PERUBAHAN EKUITI",socf:"PENYATA ALIRAN TUNAI",notes:"NOTA-NOTA KEPADA PENYATA KEWANGAN",statementByDirectors:"PENYATA OLEH PENGARAH",statutoryDeclaration:"AKUAN BERKANUN",revenue:"Hasil",costOfSales:"Kos jualan",grossProfit:"Untung kasar",otherIncome:"Pendapatan lain",adminExp:"Perbelanjaan pentadbiran",otherExp:"Perbelanjaan lain",finCosts:"Kos kewangan",pbt:"Untung sebelum cukai",tax:"Cukai",profitYear:"Untung bagi tahun kewangan",lossYear:"Rugi bagi tahun kewangan",oci:"Pendapatan komprehensif lain bagi tahun",totalCI:"Jumlah pendapatan komprehensif bagi tahun",assets:"ASET",nca:"Aset Bukan Semasa",ppe:"Hartanah, loji dan peralatan",intangibles:"Aset tak ketara",investments:"Pelaburan",ca:"Aset Semasa",inventories:"Inventori",tradeRec:"Penghutang perdagangan",otherRec:"Penghutang lain, deposit dan bayaran terdahulu",taxRecoverable:"Cukai boleh pulih",cashBank:"Tunai dan baki bank",totalAssets:"JUMLAH ASET",equityLiab:"EKUITI DAN LIABILITI",equity:"Ekuiti",shareCap:"Modal saham",retained:"Pendapatan tertahan/(kerugian terkumpul)",totalEquity:"Jumlah Ekuiti",ownerCapital:"Modal pemilik",drawings:"Tolak: Ambilan",liabilities:"Liabiliti",ncl:"Liabiliti Bukan Semasa",ltBorrowings:"Pinjaman jangka panjang",deferredTax:"Liabiliti cukai tertunda",cl:"Liabiliti Semasa",tradePay:"Pemiutang perdagangan",otherPay:"Pemiutang lain dan akruan",stBorrowings:"Pinjaman jangka pendek",taxPayable:"Cukai kena bayar",totalLiab:"Jumlah Liabiliti",totalEL:"JUMLAH EKUITI DAN LIABILITI",cfOperating:"Aliran tunai daripada aktiviti operasi",cfInvesting:"Aliran tunai daripada aktiviti pelaburan",cfFinancing:"Aliran tunai daripada aktiviti pembiayaan",netCashOps:"Tunai bersih daripada aktiviti operasi",netCashInv:"Tunai bersih digunakan dalam aktiviti pelaburan",netCashFin:"Tunai bersih daripada/(digunakan dalam) aktiviti pembiayaan",netIncrease:"Kenaikan/(penurunan) bersih tunai dan kesetaraan tunai",cashBF:"Tunai dan kesetaraan tunai pada awal tahun",cashCF:"Tunai dan kesetaraan tunai pada akhir tahun",balanceAt:"Baki pada",profitForYear:"Untung/(rugi) bagi tahun",dividendsPaid:"Dividen dibayar",note:"Nota",rm:"RM",total:"Jumlah",notesIntegral:"Nota-nota yang dilampirkan merupakan sebahagian yang tidak terpisahkan daripada penyata kewangan ini.",basisOfPrep:"ASAS PENYEDIAAN",basisText:"Penyata kewangan Syarikat telah disediakan selaras dengan",summaryPolicies:"RINGKASAN POLISI PERAKAUNAN YANG SIGNIFIKAN",revenueRecog:"Pengiktirafan hasil",ppePolicy:"Hartanah, loji dan peralatan",inventoryPolicy:"Inventori",financialInstr:"Instrumen kewangan",taxPolicy:"Percukaian",notePPE:"HARTANAH, LOJI DAN PERALATAN",noteInventory:"INVENTORI",noteTradeRec:"PENGHUTANG PERDAGANGAN DAN LAIN-LAIN",noteCash:"TUNAI DAN BAKI BANK",noteShareCap:"MODAL SAHAM",noteOwnerCap:"MODAL PEMILIK",noteTradePay:"PEMIUTANG PERDAGANGAN DAN LAIN-LAIN",noteBorrowings:"PINJAMAN",noteRevenue:"HASIL",noteExpenses:"PERBELANJAAN PENTADBIRAN",noteCostOfSales:"KOS JUALAN",noteFinCosts:"KOS KEWANGAN",noteTax:"PERCUKAIAN",noteRelatedParty:"PENDEDAHAN PIHAK BERKAITAN",noteContingent:"LIABILITI LUAR JANGKA",noteCommitments:"KOMITMEN",noteSubseqEvents:"PERISTIWA SELEPAS TARIKH PENYATA KEDUDUKAN KEWANGAN",atCost:"Pada kos",lessAccDep:"Tolak: Susut nilai terkumpul",nbv:"Nilai buku bersih",depCharge:"Caj susut nilai bagi tahun",tradingGoods:"Barang dagangan / Barang siap",cashInHand:"Tunai dalam tangan",cashAtBank:"Tunai di bank",issuedPaid:"Diterbitkan dan berbayar penuh:",ordinaryShares:"Saham biasa",saleOfGoods:"Jualan barangan",renderingServices:"Pemberian perkhidmatan",noContingent:"Tiada liabiliti luar jangka pada akhir tahun kewangan.",noCommitments:"Tiada komitmen modal pada akhir tahun kewangan.",noSubseqEvents:"Tiada peristiwa penting yang berlaku selepas tarikh penyata kedudukan kewangan yang memerlukan pelarasan atau pendedahan dalam penyata kewangan ini."}},Cf=(u,v,b={})=>{if(!u)return{};const S=.5,T=Math.abs;return{isEnterprise:v==="ENTERPRISE",isSdnBhd:v==="SDN_BHD",isPublic:v==="BERHAD"||v==="LLP",hasPPE:T(u.bs?.ppe||0)>S||T(u.bs?.ppe_cost||0)>S||De&&De.length>0,hasIntangibles:T(u.bs?.intangibles||0)>S,hasInvestments:T(u.bs?.investments||0)>S,hasInventory:T(u.bs?.inv||0)>S,hasTradeReceivables:T(u.bs?.tr||0)>S,hasOtherReceivables:T(u.bs?.or||0)>S||T(u.bs?.prepaid||0)>S||T(u.bs?.deposits||0)>S,hasCash:T(u.bs?.cash||0)>S,hasCashInHand:T(u.bs?.cashInHand||0)>S,hasShareCapital:v!=="ENTERPRISE"&&T(u.bs?.cap||0)>S,hasRetainedEarnings:T(u.bs?.ret||0)>S,hasTradePayables:T(u.bs?.tp||0)>S,hasOtherPayables:T(u.bs?.op||0)>S,hasSTBorrowings:T(u.bs?.borr||0)>S,hasLTBorrowings:T(u.bs?.ltBorr||0)>S,hasBorrowings:T(u.bs?.borr||0)>S||T(u.bs?.ltBorr||0)>S,hasTaxPayable:T(u.bs?.taxPay||0)>S,hasDeferredTax:T(u.bs?.defTax||0)>S,hasRevenue:T(u.is?.rev||0)>S,hasCostOfSales:T(u.is?.cos||0)>S,hasOtherIncome:T(u.is?.oi||0)>S,hasAdminExpenses:T(u.is?.adm||0)>S,hasOtherExpenses:T(u.is?.oe||0)>S,hasFinanceCosts:T(u.is?.fin||0)>S,hasDepreciation:T(u.is?.dep||0)>S,hasTaxExpense:T(u.is?.tax||0)>S,hasCashFlow:u.cf&&(T(u.cf?.operating||0)>S||T(u.cf?.investing||0)>S||T(u.cf?.financing||0)>S),hasPPERegister:De&&De.length>0,hasLoanRegister:loanRegister&&loanRegister.length>0,hasReceivablesRegister:receivablesRegister&&receivablesRegister.length>0,hasPayablesRegister:payablesRegister&&payablesRegister.length>0}},kf=({entityType:u,lang:v,company:b,fsRes:S,comparatives:T={},options:Q={}})=>{if(!S)return null;const j=A0[v]||A0.EN,C=Cf(S,u,{}),M=C.isEnterprise;C.isSdnBhd,C.isPublic;const X=Le=>Le==null?"-":Number(Le).toLocaleString("en-MY",{minimumFractionDigits:0,maximumFractionDigits:0}),ye=Le=>Le==null?"-":Le<0?"("+X(Math.abs(Le))+")":X(Le);let Fe=1;const Ce=()=>Fe++,Y=(()=>{const Le=[];if(Le.push({no:Ce(),id:"basis",title:j.basisOfPrep,include:!0,content:{type:"text",text:j.basisText+" "+(sa?.fullStandard||"Malaysian Private Entities Reporting Standard (MPERS)")+"."}}),M||Le.push({no:Ce(),id:"policies",title:j.summaryPolicies,include:!0,content:{type:"policies"}}),C.hasPPE&&Le.push({no:Ce(),id:"ppe",title:j.notePPE,include:!0,content:{type:"ppe",cost:S.bs.ppe_cost||0,accDep:S.bs.ppe_accDep||0,nbv:S.bs.ppe||0,currentDep:S.is.dep||0,register:De||[]}}),C.hasInventory&&Le.push({no:Ce(),id:"inventory",title:j.noteInventory,include:!0,content:{type:"simple",rows:[{label:j.tradingGoods,amount:S.bs.inv}]}}),C.hasTradeReceivables||C.hasOtherReceivables){const me=[];C.hasTradeReceivables&&me.push({label:j.tradeRec,amount:S.bs.tr}),S.bs.or>0&&me.push({label:v==="BM"?"Penghutang lain":"Other receivables",amount:S.bs.or}),S.bs.prepaid>0&&me.push({label:v==="BM"?"Bayaran terdahulu":"Prepayments",amount:S.bs.prepaid}),S.bs.deposits>0&&me.push({label:v==="BM"?"Deposit":"Deposits",amount:S.bs.deposits}),Le.push({no:Ce(),id:"receivables",title:j.noteTradeRec,include:!0,content:{type:"simple",rows:me,showTotal:me.length>1,total:(S.bs.tr||0)+(S.bs.or||0)+(S.bs.prepaid||0)+(S.bs.deposits||0)}})}if(C.hasCash&&Le.push({no:Ce(),id:"cash",title:j.noteCash,include:!0,content:{type:"simple",rows:[{label:j.cashInHand,amount:S.bs.cashInHand||0},{label:j.cashAtBank,amount:S.bs.cash-(S.bs.cashInHand||0)}],showTotal:!0,total:S.bs.cash}}),!M&&C.hasShareCapital&&Le.push({no:Ce(),id:"sharecapital",title:j.noteShareCap,include:!0,content:{type:"sharecapital",amount:S.bs.cap}}),M&&Le.push({no:Ce(),id:"ownercapital",title:j.noteOwnerCap,include:!0,content:{type:"simple",rows:[{label:j.ownerCapital,amount:S.bs.cap||0},{label:j.drawings,amount:-(S.bs.drawings||0)}],showTotal:!0,total:(S.bs.cap||0)-(S.bs.drawings||0)}}),C.hasTradePayables||C.hasOtherPayables){const me=[];C.hasTradePayables&&me.push({label:j.tradePay,amount:S.bs.tp}),C.hasOtherPayables&&me.push({label:j.otherPay,amount:S.bs.op}),Le.push({no:Ce(),id:"payables",title:j.noteTradePay,include:!0,content:{type:"simple",rows:me,showTotal:me.length>1,total:(S.bs.tp||0)+(S.bs.op||0)}})}if(C.hasBorrowings){const me=[];C.hasSTBorrowings&&me.push({label:j.stBorrowings,amount:S.bs.borr}),C.hasLTBorrowings&&me.push({label:j.ltBorrowings,amount:S.bs.ltBorr}),Le.push({no:Ce(),id:"borrowings",title:j.noteBorrowings,include:!0,content:{type:"simple",rows:me,showTotal:me.length>1,total:(S.bs.borr||0)+(S.bs.ltBorr||0)}})}if(C.hasRevenue&&Le.push({no:Ce(),id:"revenue",title:j.noteRevenue,include:!0,content:{type:"simple",rows:[{label:j.saleOfGoods,amount:S.is.rev}]}}),C.hasCostOfSales&&Le.push({no:Ce(),id:"costOfSales",title:j.noteCostOfSales,include:!0,content:{type:"simple",rows:[{label:v==="BM"?"Belian":"Purchases",amount:S.is.details?.PURCHASE||S.is.cos}]}}),C.hasAdminExpenses){const me=[];["SALARY","RENT","UTILITIES","DEPRECIATION","OFFICE_SUPPLIES","PROFESSIONAL_FEES","MARKETING","TRANSPORT","ENTERTAINMENT","INSURANCE","REPAIRS","COMMUNICATION"].forEach(Ye=>{if(S.is.details?.[Ye]>0){const ot={SALARY:v==="BM"?"Gaji dan upah":"Salaries and wages",RENT:v==="BM"?"Sewa":"Rental",UTILITIES:v==="BM"?"Utiliti":"Utilities",DEPRECIATION:v==="BM"?"Susut nilai":"Depreciation",OFFICE_SUPPLIES:v==="BM"?"Bekalan pejabat":"Office supplies",PROFESSIONAL_FEES:v==="BM"?"Yuran profesional":"Professional fees",MARKETING:v==="BM"?"Pemasaran dan pengiklanan":"Marketing and advertising",TRANSPORT:v==="BM"?"Pengangkutan":"Transport",ENTERTAINMENT:v==="BM"?"Keraian":"Entertainment",INSURANCE:v==="BM"?"Insurans":"Insurance",REPAIRS:v==="BM"?"Pembaikan dan penyelenggaraan":"Repairs and maintenance",COMMUNICATION:v==="BM"?"Komunikasi":"Communication"};me.push({label:ot[Ye]||Ye,amount:S.is.details[Ye]})}}),me.length===0&&me.push({label:j.adminExp,amount:S.is.adm}),Le.push({no:Ce(),id:"expenses",title:j.noteExpenses,include:!0,content:{type:"simple",rows:me,showTotal:me.length>1,total:S.is.adm}})}return C.hasFinanceCosts&&Le.push({no:Ce(),id:"fincosts",title:j.noteFinCosts,include:!0,content:{type:"simple",rows:[{label:v==="BM"?"Faedah atas pinjaman":"Interest on borrowings",amount:S.is.fin}]}}),(C.hasTaxExpense||C.hasTaxPayable)&&Le.push({no:Ce(),id:"tax",title:j.noteTax,include:!0,content:{type:"simple",rows:[{label:v==="BM"?"Cukai semasa":"Current tax",amount:S.is.tax}]}}),M||Le.push({no:Ce(),id:"relatedparty",title:j.noteRelatedParty,include:!0,content:{type:"relatedparty",directorFees:S.is.details?.DIRECTOR_FEE||Math.round((S.is.adm||0)*.15)}}),M||Le.push({no:Ce(),id:"contingent",title:j.noteContingent,include:!0,content:{type:"text",text:j.noContingent}}),M||Le.push({no:Ce(),id:"commitments",title:j.noteCommitments,include:!0,content:{type:"text",text:j.noCommitments}}),M||Le.push({no:Ce(),id:"subsequent",title:j.noteSubseqEvents,include:!0,content:{type:"text",text:j.noSubseqEvents}}),Le.filter(me=>me.include)})(),ze=7+Math.ceil(Y.length/3);return{meta:{entityType:u,lang:v,companyName:b.name||s,companyRegNo:b.regNo||f,accountingStandard:sa?.fullStandard||"Malaysian Private Entities Reporting Standard (MPERS)",currentYear:L,priorYear:L-1,fyeDate:g,fyeDisplay:(()=>{const[Le,me]=(g||"12-31").split("-"),ot=v==="BM"?["","Januari","Februari","Mac","April","Mei","Jun","Julai","Ogos","September","Oktober","November","Disember"]:["","January","February","March","April","May","June","July","August","September","October","November","December"];return me+" "+ot[parseInt(Le)]+" "+L})()},applicability:C,labels:j,helpers:{fmtNum:X,fmtBracket:ye},toc:[{title:j.sofp,page:3,include:!0},{title:M?j.soplSimple:j.sopl,page:4,include:!0},{title:j.soce,page:5,include:!M},{title:j.socf,page:6,include:C.hasCashFlow||!M},{title:j.notes,page:"7 - "+ze,include:!0}].filter(Le=>Le.include),sections:{cover:{include:!0},toc:{include:!0},sofp:{include:!0,title:j.sofp,data:S.bs},sopl:{include:!0,title:M?j.soplSimple:j.sopl,data:S.is,showOCI:!M},soce:{include:!M,title:j.soce,data:{openingRE:S.bs.ret-S.bs.cyp,profit:S.bs.cyp,closingRE:S.bs.ret,shareCap:S.bs.cap}},socf:{include:C.hasCashFlow||!M,title:j.socf,data:S.cf},notes:{include:!0,title:j.notes,items:Y}},includedNotes:Y.map(Le=>({no:Le.no,title:Le.title,id:Le.id}))}},al=u=>{if(!u)return"";const{meta:v,labels:b,helpers:S,sections:T,toc:Q,applicability:j}=u,{fmtNum:C,fmtBracket:M}=S,X=j.isEnterprise,ye=v.lang||"EN";let Ce=`<!DOCTYPE html><html lang="${ye==="BM"?"ms":"en"}"><head><meta charset="UTF-8"><title>${v.companyName} - ${b.title} ${v.currentYear}</title><style>
      @page { size: A4; margin: 2cm; }
      @media print { .page { page-break-after: always; } .page:last-child { page-break-after: avoid; } }
      * { box-sizing: border-box; }
      body { font-family: "Times New Roman", Times, serif; font-size: 11pt; line-height: 1.5; color: #000; max-width: 210mm; margin: 0 auto; padding: 20px; }
      .page { page-break-after: always; page-break-inside: avoid; padding-bottom: 20px; margin-bottom: 20px; min-height: 270mm; }
      .page:last-child { page-break-after: avoid; }
      .header { text-align: center; margin-bottom: 25px; }
      .header h1 { font-size: 14pt; font-weight: bold; margin: 0 0 5px 0; text-transform: uppercase; }
      .header h2 { font-size: 12pt; font-weight: bold; margin: 0 0 5px 0; text-transform: uppercase; }
      .section-title { font-size: 11pt; font-weight: bold; text-transform: uppercase; margin: 20px 0 10px 0; }
      .subsection { font-size: 11pt; font-weight: bold; margin: 15px 0 8px 0; }
      table { width: 100%; border-collapse: collapse; margin: 10px 0; }
      table.fs th, table.fs td { padding: 4px 8px; text-align: left; vertical-align: top; font-size: 10pt; }
      .right { text-align: right; }
      .center { text-align: center; }
      .bold { font-weight: bold; }
      .indent { padding-left: 15px; }
      .indent2 { padding-left: 30px; }
      .note-text { font-size: 10pt; margin: 8px 0; text-align: justify; line-height: 1.6; }
      .note-table th, .note-table td { border: 1px solid #000; padding: 4px 6px; font-size: 9pt; }
      .note-table th { background: #f5f5f5; font-weight: bold; }
      .toc-item { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px dotted #ccc; }
      .company-header { text-align: right; font-size: 9pt; margin-bottom: 10px; color: #666; }
      .integral-note { font-size: 9pt; font-style: italic; margin-top: 20px; text-align: center; }
      .version-footer { font-size: 8pt; color: #999; text-align: center; margin-top: 30px; }
    </style></head><body>`;if(Ce+=`<div class="page" style="display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;">
      <div style="margin-bottom:80px;">
        <h1 style="font-size:22pt;margin-bottom:15px;letter-spacing:1px;">${v.companyName.toUpperCase()}</h1>
        <p style="font-size:11pt;">(${b.regNo}: ${v.companyRegNo})</p>
        <p style="font-size:10pt;margin-top:3px;">(${b.incMalaysia})</p>
      </div>
      <div style="margin-bottom:80px;">
        <h2 style="font-size:18pt;font-weight:bold;letter-spacing:2px;">${b.title}</h2>
        <p style="font-size:12pt;margin-top:25px;">${b.forYear}</p>
        <p style="font-size:14pt;font-weight:bold;margin-top:5px;">${v.fyeDisplay.toUpperCase()}</p>
      </div>
      <div style="margin-top:60px;">
        <p style="font-size:10pt;font-style:italic;">${v.accountingStandard}</p>
        <p class="version-footer">Generated by FS Automation ${mi}</p>
      </div>
    </div>`,Ce+=`<div class="page">
      <div class="header"><h1>${v.companyName.toUpperCase()}</h1></div>
      <h2 style="text-align:center;margin-bottom:30px;">${b.contents}</h2>
      <div style="max-width:400px;margin:0 auto;">
        ${Q.map(J=>`<div class="toc-item"><span>${J.title}</span><span>${J.page}</span></div>`).join("")}
      </div>
    </div>`,T.sofp.include){const J=T.sofp.data;Ce+=`<div class="page">
        <div class="company-header">${v.companyName.toUpperCase()} (${v.companyRegNo})</div>
        <div class="header"><h2>${b.sofp}</h2><p>${b.asAt} ${v.fyeDisplay.toUpperCase()}</p></div>
        <table class="fs">
          <thead><tr><th style="width:55%"></th><th class="center" style="width:10%">${b.note}</th><th class="right" style="width:17%">${v.currentYear}<br>${b.rm}</th><th class="right" style="width:18%">${v.priorYear}<br>${b.rm}</th></tr></thead>
          <tbody>
            ${Ft(b.assets,"","","",{bold:!0})}
            ${Ft(b.nca,"","","",{bold:!0})}
            ${j.hasPPE?Ft(b.ppe,T.notes.items.find(Y=>Y.id==="ppe")?.no||"",C(J.ppe),C(J.py_ppe||0),{indent:1}):""}
            ${j.hasIntangibles?Ft(b.intangibles,"",C(J.intangibles),"-",{indent:1}):""}
            ${Ft("","",C(J.totNCA||J.ppe||0),C(J.py_totNCA||0),{bold:!0,line:ea.TOP})}
            ${Ft(b.ca,"","","",{bold:!0})}
            ${j.hasInventory?Ft(b.inventories,T.notes.items.find(Y=>Y.id==="inventory")?.no||"",C(J.inv),C(J.py_inv||0),{indent:1}):""}
            ${j.hasTradeReceivables||j.hasOtherReceivables?Ft(b.tradeRec,T.notes.items.find(Y=>Y.id==="receivables")?.no||"",C((J.tr||0)+(J.or||0)),C((J.py_tr||0)+(J.py_or||0)),{indent:1}):""}
            ${j.hasCash?Ft(b.cashBank,T.notes.items.find(Y=>Y.id==="cash")?.no||"",C(J.cash),C(J.py_cash||0),{indent:1}):""}
            ${Ft("","",C(J.totCA),C(J.py_totCA||0),{bold:!0,line:ea.TOP})}
            ${Ft(b.totalAssets,"",C(J.totA),C(J.py_totA||0),{bold:!0,line:ea.DOUBLE_TOP})}
            <tr><td colspan="4" style="height:15px;"></td></tr>
            ${Ft(b.equityLiab,"","","",{bold:!0})}
            ${Ft(b.equity,"","","",{bold:!0})}
            ${!X&&j.hasShareCapital?Ft(b.shareCap,T.notes.items.find(Y=>Y.id==="sharecapital")?.no||"",C(J.cap),C(J.py_cap||0),{indent:1}):""}
            ${X?Ft(b.ownerCapital,T.notes.items.find(Y=>Y.id==="ownercapital")?.no||"",C(J.cap),C(J.py_cap||0),{indent:1}):""}
            ${Ft(b.retained,"",C(J.ret),C(J.py_ret||0),{indent:1})}
            ${Ft("","",C(J.totE),C(J.py_totE||0),{bold:!0,line:ea.TOP})}
            ${Ft(b.liabilities,"","","",{bold:!0})}
            ${j.hasLTBorrowings||j.hasDeferredTax?Ft(b.ncl,"","","",{bold:!0}):""}
            ${j.hasLTBorrowings?Ft(b.ltBorrowings,"",C(J.ltBorr),C(J.py_ltBorr||0),{indent:1}):""}
            ${Ft(b.cl,"","","",{bold:!0})}
            ${j.hasTradePayables||j.hasOtherPayables?Ft(b.tradePay,T.notes.items.find(Y=>Y.id==="payables")?.no||"",C((J.tp||0)+(J.op||0)),C((J.py_tp||0)+(J.py_op||0)),{indent:1}):""}
            ${j.hasSTBorrowings?Ft(b.stBorrowings,T.notes.items.find(Y=>Y.id==="borrowings")?.no||"",C(J.borr),C(J.py_borr||0),{indent:1}):""}
            ${j.hasTaxPayable?Ft(b.taxPayable,"",C(J.taxPay),C(J.py_taxPay||0),{indent:1}):""}
            ${Ft("","",C(J.totL),C(J.py_totL||0),{bold:!0,line:ea.TOP})}
            ${Ft(b.totalEL,"",C(J.totE+J.totL),C((J.py_totE||0)+(J.py_totL||0)),{bold:!0,line:ea.DOUBLE_TOP})}
          </tbody>
        </table>
        <p class="integral-note">${b.notesIntegral}</p>
      </div>`}if(T.sopl.include){const J=T.sopl.data;Ce+=`<div class="page">
        <div class="company-header">${v.companyName.toUpperCase()} (${v.companyRegNo})</div>
        <div class="header"><h2>${T.sopl.title}</h2><p>${b.forYear} ${v.fyeDisplay.toUpperCase()}</p></div>
        <table class="fs">
          <thead><tr><th style="width:55%"></th><th class="center" style="width:10%">${b.note}</th><th class="right" style="width:17%">${v.currentYear}<br>${b.rm}</th><th class="right" style="width:18%">${v.priorYear}<br>${b.rm}</th></tr></thead>
          <tbody>
            ${Ft(b.revenue,T.notes.items.find(Y=>Y.id==="revenue")?.no||"",C(J.rev),C(J.py_rev||0))}
            ${Ft(b.costOfSales,T.notes.items.find(Y=>Y.id==="costOfSales")?.no||"","("+C(J.cos)+")","("+C(J.py_cos||0)+")")}
            ${Ft(b.grossProfit,"",C(J.gp),C(J.py_gp||0),{bold:!0,line:ea.TOP})}
            ${j.hasOtherIncome?Ft(b.otherIncome,"",C(J.oi),C(J.py_oi||0)):""}
            ${Ft(b.adminExp,T.notes.items.find(Y=>Y.id==="expenses")?.no||"","("+C(J.adm)+")","("+C(J.py_adm||0)+")")}
            ${j.hasOtherExpenses?Ft(b.otherExp,"","("+C(J.oe)+")","("+C(J.py_oe||0)+")"):""}
            ${j.hasFinanceCosts?Ft(b.finCosts,T.notes.items.find(Y=>Y.id==="fincosts")?.no||"","("+C(J.fin)+")","("+C(J.py_fin||0)+")"):""}
            ${Ft(b.pbt,"",C(J.pbt),C(J.py_pbt||0),{bold:!0,line:ea.TOP})}
            ${Ft(b.tax,T.notes.items.find(Y=>Y.id==="tax")?.no||"",J.tax>0?"("+C(J.tax)+")":"-",(J.py_tax||0)>0?"("+C(J.py_tax)+")":"-")}
            ${Ft(J.np>=0?b.profitYear:b.lossYear,"",C(J.np),C(J.py_np||0),{bold:!0,line:ea.DOUBLE_TOP})}
            ${T.sopl.showOCI?`
            <tr><td colspan="4" style="height:10px;"></td></tr>
            ${Ft(b.oci,"","-","-")}
            ${Ft(b.totalCI,"",C(J.np),C(J.py_np||0),{bold:!0,line:ea.DOUBLE_TOP})}
            `:""}
          </tbody>
        </table>
        <p class="integral-note">${b.notesIntegral}</p>
      </div>`}if(T.soce.include){const J=T.soce.data;Ce+=`<div class="page">
        <div class="company-header">${v.companyName.toUpperCase()} (${v.companyRegNo})</div>
        <div class="header"><h2>${b.soce}</h2><p>${b.forYear} ${v.fyeDisplay.toUpperCase()}</p></div>
        <table class="fs" style="margin-top:30px;">
          <thead><tr><th style="width:40%"></th><th class="right" style="width:20%">${b.shareCap}<br>${b.rm}</th><th class="right" style="width:20%">${b.retained}<br>${b.rm}</th><th class="right" style="width:20%">${b.total}<br>${b.rm}</th></tr></thead>
          <tbody>
            ${ds(b.balanceAt+" 1.1."+v.priorYear,C(J.shareCap),C(J.openingRE-(J.py_profit||0)),C(J.shareCap+J.openingRE-(J.py_profit||0)))}
            ${ds(b.profitForYear,"-",C(J.py_profit||0),C(J.py_profit||0))}
            ${ds(b.balanceAt+" 31.12."+v.priorYear,C(J.shareCap),C(J.openingRE),C(J.shareCap+J.openingRE),{line:ea.TOP})}
            ${ds(b.profitForYear,"-",C(J.profit),C(J.profit))}
            ${ds(b.balanceAt+" 31.12."+v.currentYear,C(J.shareCap),C(J.closingRE),C(J.shareCap+J.closingRE),{bold:!0,line:ea.DOUBLE_TOP})}
          </tbody>
        </table>
        <p class="integral-note">${b.notesIntegral}</p>
      </div>`}if(T.socf.include&&T.socf.data){const J=T.socf.data;Ce+=`<div class="page">
        <div class="company-header">${v.companyName.toUpperCase()} (${v.companyRegNo})</div>
        <div class="header"><h2>${b.socf}</h2><p>${b.forYear} ${v.fyeDisplay.toUpperCase()}</p></div>
        <table class="fs">
          <thead><tr><th style="width:70%"></th><th class="right" style="width:15%">${v.currentYear}<br>${b.rm}</th><th class="right" style="width:15%">${v.priorYear}<br>${b.rm}</th></tr></thead>
          <tbody>
            ${Ra(b.cfOperating,"","",{bold:!0})}
            ${Ra(b.pbt,C(J.pbt||m.is.pbt),C(J.py_pbt||0),{indent:1})}
            ${Ra(ye==="BM"?"Pelarasan untuk:":"Adjustments for:","","",{indent:1})}
            ${Ra(b.ppe.split(",")[0]+(ye==="BM"?" - susut nilai":" - depreciation"),C(J.depreciation||m.is.dep),C(J.py_dep||0),{indent:2})}
            ${j.hasFinanceCosts?Ra(b.finCosts,C(J.interest||m.is.fin),C(J.py_fin||0),{indent:2}):""}
            ${Ra(ye==="BM"?"Tunai operasi sebelum perubahan modal kerja":"Operating cash before working capital changes",C(J.opCashBefore||m.is.pbt+(m.is.dep||0)+(m.is.fin||0)),"-",{indent:1,line:ea.TOP})}
            ${Ra(ye==="BM"?"Perubahan dalam inventori":"Change in inventories",M(J.invChange||0),"-",{indent:1})}
            ${Ra(ye==="BM"?"Perubahan dalam penghutang":"Change in receivables",M(J.recChange||0),"-",{indent:1})}
            ${Ra(ye==="BM"?"Perubahan dalam pemiutang":"Change in payables",M(J.payChange||0),"-",{indent:1})}
            ${Ra(ye==="BM"?"Cukai dibayar":"Tax paid",M(J.taxPaid||0),"-",{indent:1})}
            ${Ra(b.netCashOps,C(J.operating||0),C(J.py_operating||0),{bold:!0,line:ea.TOP})}
            <tr><td colspan="3" style="height:10px;"></td></tr>
            ${Ra(b.cfInvesting,"","",{bold:!0})}
            ${Ra(ye==="BM"?"Pembelian hartanah, loji dan peralatan":"Purchase of property, plant and equipment",M(J.ppeAcq||0),"-",{indent:1})}
            ${Ra(b.netCashInv,M(J.investing||0),C(J.py_investing||0),{bold:!0,line:ea.TOP})}
            <tr><td colspan="3" style="height:10px;"></td></tr>
            ${Ra(b.cfFinancing,"","",{bold:!0})}
            ${j.hasBorrowings?Ra(ye==="BM"?"Bayaran balik pinjaman":"Repayment of borrowings",M(J.loanRepay||0),"-",{indent:1}):""}
            ${j.hasFinanceCosts?Ra(ye==="BM"?"Faedah dibayar":"Interest paid",M(J.interestPaid||m.is.fin),"-",{indent:1}):""}
            ${Ra(b.netCashFin,M(J.financing||0),C(J.py_financing||0),{bold:!0,line:ea.TOP})}
            <tr><td colspan="3" style="height:10px;"></td></tr>
            ${Ra(b.netIncrease,C((J.operating||0)+(J.investing||0)+(J.financing||0)),"-",{bold:!0,line:ea.TOP})}
            ${Ra(b.cashBF,C(J.cashBF||m.bs.py_cash||0),"-")}
            ${Ra(b.cashCF,C(J.cashCF||m.bs.cash),C(J.py_cashCF||0),{bold:!0,line:ea.DOUBLE_TOP})}
          </tbody>
        </table>
        <p class="integral-note">${b.notesIntegral}</p>
      </div>`}if(T.notes.include){const J=T.notes.items;let Y="",ze=0;for(;ze<J.length;){Y+=`<div class="page">
          <div class="company-header">${v.companyName.toUpperCase()} (${v.companyRegNo})</div>
          <div class="header"><h2>${b.notes}${ze>0?" ("+b.continued+")":""}</h2></div>`;const Le=Math.min(3,J.length-ze);for(let me=0;me<Le&&ze<J.length;me++,ze++){const qe=J[ze];if(Y+=`<div class="section-title">${qe.no}. ${qe.title}</div>`,qe.content.type==="text")Y+=`<p class="note-text">${qe.content.text}</p>`;else if(qe.content.type==="simple")Y+='<table class="fs"><tbody>',qe.content.rows.forEach(Ye=>{Y+=Fi(Ye.label,C(Ye.amount))}),qe.content.showTotal&&(Y+=Fi(b.total,C(qe.content.total),{bold:!0,line:ea.TOP})),Y+="</tbody></table>";else if(qe.content.type==="ppe"){const Ye=qe.content;Ye.register&&Ye.register.length>0?(Y+=`<table class="note-table"><thead><tr>
                <th style="width:35%">${ye==="BM"?"Keterangan":"Description"}</th>
                <th class="right" style="width:20%">${ye==="BM"?"Kos":"Cost"}<br>${b.rm}</th>
                <th class="right" style="width:20%">${ye==="BM"?"Susut Nilai Terkumpul":"Accum. Dep."}<br>${b.rm}</th>
                <th class="right" style="width:15%">NBV<br>${b.rm}</th>
              </tr></thead><tbody>`,Ye.register.forEach(ot=>{const Xt=ge[ot.category]||ge.OFFICE_EQUIPMENT,ct=parseFloat(ot.cost)||0,ba=parseFloat(ot.accDepBF)||0,nt=Math.min(ct*(Xt.rate/100),ct-ba),Aa=ba+nt,Wa=ct-Aa;Y+=`<tr><td>${ot.description||"-"}</td><td class="right">${C(ct)}</td><td class="right">${C(Aa)}</td><td class="right">${C(Wa)}</td></tr>`}),Y+=`<tr style="font-weight:bold;border-top:2px solid #000"><td>${b.total}</td><td class="right">${C(Ye.cost)}</td><td class="right">${C(Ye.accDep)}</td><td class="right">${C(Ye.nbv)}</td></tr>`,Y+="</tbody></table>"):Y+=`<table class="fs"><tbody>
                <tr><td style="width:60%">${b.atCost}</td><td class="right">${C(Ye.cost+Ye.accDep)}</td></tr>
                <tr><td>${b.lessAccDep}</td><td class="right">(${C(Ye.accDep)})</td></tr>
                <tr style="border-top:1px solid #000"><td class="bold">${b.nbv}</td><td class="right bold">${C(Ye.nbv)}</td></tr>
              </tbody></table>`,Y+=`<p class="note-text">${b.depCharge}: ${b.rm} ${C(Ye.currentDep)}</p>`}else qe.content.type==="sharecapital"?Y+=`<table class="fs"><tbody>
              <tr><td style="width:60%">${b.issuedPaid}</td><td></td></tr>
              <tr><td class="indent">${b.ordinaryShares}</td><td class="right">${C(qe.content.amount)}</td></tr>
            </tbody></table>`:qe.content.type==="policies"?Y+=`<p class="note-text"><strong>2.1 ${b.revenueRecog}</strong></p>
              <p class="note-text">${ye==="BM"?"Hasil diukur pada nilai saksama balasan yang diterima atau akan diterima. Hasil daripada jualan barangan diiktiraf apabila risiko dan ganjaran pemilikan yang ketara telah dipindahkan kepada pembeli.":"Revenue is measured at the fair value of consideration received or receivable. Revenue from sale of goods is recognised when significant risks and rewards of ownership have been transferred to the buyer."}</p>
              <p class="note-text"><strong>2.2 ${b.ppePolicy}</strong></p>
              <p class="note-text">${ye==="BM"?"Hartanah, loji dan peralatan dinyatakan pada kos tolak susut nilai terkumpul. Susut nilai dicaj ke penyata untung rugi secara garis lurus ke atas anggaran hayat berguna aset.":"Property, plant and equipment are stated at cost less accumulated depreciation. Depreciation is charged to profit or loss on a straight-line basis over the estimated useful lives of the assets."}</p>
              <p class="note-text"><strong>2.3 ${b.financialInstr}</strong></p>
              <p class="note-text">${ye==="BM"?"Aset dan liabiliti kewangan diiktiraf apabila Syarikat menjadi pihak kepada peruntukan kontrak instrumen tersebut.":"Financial assets and liabilities are recognised when the Company becomes a party to the contractual provisions of the instrument."}</p>`:qe.content.type==="relatedparty"&&(Y+=`<p class="note-text"><strong>(a) ${ye==="BM"?"Identiti pihak berkaitan":"Identities of related parties"}</strong></p>
              <p class="note-text">${ye==="BM"?"Syarikat mempunyai hubungan pihak berkaitan dengan pengarah dan kakitangan pengurusan utama.":"The Company has related party relationships with its directors and key management personnel."}</p>
              <p class="note-text"><strong>(b) ${ye==="BM"?"Pampasan kakitangan pengurusan utama":"Key management personnel compensation"}</strong></p>
              <table class="fs"><tbody>
                <tr><td style="width:60%">${ye==="BM"?"Imbuhan pengarah":"Directors' remuneration"}</td><td class="right">${C(qe.content.directorFees)}</td></tr>
              </tbody></table>`)}Y+="</div>"}Ce+=Y}return Ce+="</body></html>",Ce},wf=async(u,v)=>{if(!u){alert("Please generate financial statements first.");return}if(typeof jspdf>"u"&&typeof jsPDF>"u"){const b=al(u);E0(b,v.replace(".pdf",""));return}try{const{jsPDF:b}=window.jspdf||window,S=new b({orientation:"portrait",unit:"mm",format:"a4"}),{meta:T,labels:Q,helpers:j,sections:C,applicability:M}=u,{fmtNum:X,fmtBracket:ye}=j,Fe=210,Ce=297,J=20,Y=Fe-J*2;let ze=J;const Le=me=>{S.setFontSize(9),S.setTextColor(128),S.text(`${Q.page} ${me}`,Fe-J,Ce-10,{align:"right"}),S.setTextColor(0)};S.setFontSize(22),S.setFont("times","bold"),S.text(T.companyName.toUpperCase(),Fe/2,80,{align:"center"}),S.setFontSize(11),S.setFont("times","normal"),S.text(`(${Q.regNo}: ${T.companyRegNo})`,Fe/2,90,{align:"center"}),S.setFontSize(10),S.text(`(${Q.incMalaysia})`,Fe/2,97,{align:"center"}),S.setFontSize(18),S.setFont("times","bold"),S.text(Q.title,Fe/2,130,{align:"center"}),S.setFontSize(12),S.setFont("times","normal"),S.text(Q.forYear,Fe/2,145,{align:"center"}),S.setFontSize(14),S.setFont("times","bold"),S.text(T.fyeDisplay.toUpperCase(),Fe/2,155,{align:"center"}),S.setFontSize(10),S.setFont("times","italic"),S.text(T.accountingStandard,Fe/2,200,{align:"center"}),Le(1),S.addPage(),ze=J,S.setFontSize(14),S.setFont("times","bold"),S.text(T.companyName.toUpperCase(),Fe/2,ze,{align:"center"}),ze+=15,S.setFontSize(12),S.text(Q.contents,Fe/2,ze,{align:"center"}),ze+=20,S.setFontSize(11),S.setFont("times","normal"),u.toc.forEach(me=>{S.text(me.title,J+30,ze),S.text(String(me.page),Fe-J-30,ze,{align:"right"}),ze+=8}),Le(2),S.autoTable,S.save(v)}catch(b){console.error("PDF export error:",b);const S=al(u);E0(S,v.replace(".pdf",""))}},Wl=(u,v)=>{if(console.log("exportFullFSDocx called:",v),!u){alert("Please generate financial statements first.");return}try{const S=`<!DOCTYPE html>
<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">
<head>
<meta charset="UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--[if gte mso 9]>
<xml>
<w:WordDocument>
<w:View>Print</w:View>
<w:Zoom>100</w:Zoom>
<w:DoNotOptimizeForBrowser/>
</w:WordDocument>
</xml>
<![endif]-->
<style>
@page { size: A4; margin: 2cm; }
body { font-family: "Times New Roman", Times, serif; font-size: 11pt; line-height: 1.5; }
.page { page-break-after: always; }
.page:last-child { page-break-after: avoid; }
table { width: 100%; border-collapse: collapse; page-break-inside: avoid; }
.right { text-align: right; }
.center { text-align: center; }
.bold { font-weight: bold; }
</style>
</head>
<body>
${al(u).replace(/<html[^>]*>/,"").replace(/<\/html>/,"").replace(/<head>[\s\S]*<\/head>/,"").replace(/<body>/,"").replace(/<\/body>/,"")}
</body>
</html>`,T=new Blob([S],{type:"application/msword;charset=utf-8"});an(T,v),console.log("Word document downloaded:",v)}catch(b){console.error("exportFullFSDocx error:",b),alert("Error exporting Word document: "+b.message)}},rl=(u,v="EN")=>{if(console.log("downloadFullFS called:",u,v),!m){alert("Please generate financial statements first.");return}try{const b=kf({entityType:t,lang:v,company:{name:s,regNo:f},fsRes:m});if(!b){alert("Error building FS model.");return}const S=(s||"Company").replace(/[^a-zA-Z0-9]/g,"_"),T=v==="BM"?"_BM":"_EN";if(u==="html"){const Q=al(b),j=new Blob([Q],{type:"text/html;charset=utf-8"});an(j,`${S}_FS_${L}${T}.html`),ke(C=>[...C,{t:"ok",m:` Full FS HTML downloaded (${v})`}])}}catch(b){console.error("downloadFullFS error:",b),alert("Error exporting: "+b.message)}},fs=({lang:u="EN"})=>{if(!m)return null;const v=u!=="BM",b=Ce=>Ce==null?"-":Number(Ce).toLocaleString("en-MY",{minimumFractionDigits:0,maximumFractionDigits:0}),S=Ce=>Ce==null||isNaN(Ce)?"-":Ce.toFixed(1)+"%",T=Ce=>Ce==null?"-":Ce>=1e6?(Ce/1e6).toFixed(1)+"M":Ce>=1e3?(Ce/1e3).toFixed(0)+"K":b(Ce),j=Object.entries({SALARY:v?"Salaries":"Gaji",RENT:v?"Rent":"Sewa",UTILITIES:v?"Utilities":"Utiliti",DEPRECIATION:v?"Depreciation":"Susut Nilai",PROFESSIONAL_FEES:v?"Prof. Fees":"Yuran Prof.",MARKETING:v?"Marketing":"Pemasaran",TRANSPORT:v?"Transport":"Pengangkutan",INSURANCE:v?"Insurance":"Insurans",BANK_CHARGES:v?"Bank Charges":"Caj Bank",MISCELLANEOUS:v?"Others":"Lain-lain"}).filter(([Ce])=>m.is.details?.[Ce]>0).map(([Ce,J])=>({label:J,amount:m.is.details[Ce],pct:m.is.adm>0?m.is.details[Ce]/m.is.adm*100:0})).sort((Ce,J)=>J.amount-Ce.amount).slice(0,8),C=Ce=>{const J={current:0,d30:0,d60:0,d90:0,over90:0,total:0},Y=new Date;return Ce.forEach(ze=>{const Le=parseFloat(ze.amount)||0,me=Math.max(0,Math.floor((Y-new Date(ze.dueDate))/864e5));me<=0?J.current+=Le:me<=30?J.d30+=Le:me<=60?J.d60+=Le:me<=90?J.d90+=Le:J.over90+=Le,J.total+=Le}),J},M={gpMargin:m.is.rev>0?m.is.gp/m.is.rev*100:0,npMargin:m.is.rev>0?m.is.np/m.is.rev*100:0,currentRatio:m.bs.totCL>0?m.bs.totCA/m.bs.totCL:0,quickRatio:m.bs.totCL>0?(m.bs.totCA-(m.bs.inv||0))/m.bs.totCL:0,debtToEquity:m.bs.totE>0?m.bs.totL/m.bs.totE:0,roe:m.bs.totE>0?m.is.np/m.bs.totE*100:0,roa:m.bs.totA>0?m.is.np/m.bs.totA*100:0,workingCapital:m.bs.totCA-m.bs.totCL},X=De.map(Ce=>{const J=parseFloat(Ce.cost)||0,Y=parseFloat(Ce.accDepBF)||0,ze=ge[Ce.category]||ge.OFFICE_EQUIPMENT,Le=Math.min(J*(ze.rate/100),J-Y);return{desc:Ce.description,cost:J,nbv:J-Y-Le}}),ye=[...We].sort((Ce,J)=>(parseFloat(J.amount)||0)-(parseFloat(Ce.amount)||0)).slice(0,5),Fe=[...Nt].sort((Ce,J)=>(parseFloat(J.amount)||0)-(parseFloat(Ce.amount)||0)).slice(0,5);return{meta:{companyName:s||"Company",companyRegNo:f||"",year:L,lang:u,generated:new Date().toLocaleString()},is:m.is,bs:m.bs,ratios:M,expenses:j,arAgeing:C(We),apAgeing:C(Nt),ppeItems:X,topDebtors:ye,topCreditors:Fe,helpers:{fmtNum:b,fmtPct:S,fmtK:T}}},ji=u=>{if(!u)return"";const{meta:v,is:b,bs:S,ratios:T,expenses:Q,arAgeing:j,apAgeing:C,ppeItems:M,topDebtors:X,topCreditors:ye,helpers:{fmtNum:Fe,fmtPct:Ce,fmtK:J}}=u,Y=v.lang!=="BM",ze=(ot,Xt)=>`<div style="height:14px;background:#e5e7eb;border-radius:3px;overflow:hidden"><div style="height:100%;width:${Math.min(ot,100)}%;background:${Xt};border-radius:3px"></div></div>`,Le="@page{size:A4;margin:8mm}@media print{.page{page-break-after:always}.page:last-child{page-break-after:avoid}}*{box-sizing:border-box;margin:0;padding:0}body{font-family:'Segoe UI',Arial,sans-serif;font-size:9pt;color:#1f2937;max-width:210mm;margin:0 auto;background:#fff}.page{padding:12px;min-height:285mm;position:relative}.hdr{background:linear-gradient(135deg,#1e3a8a,#3b82f6);color:#fff;padding:12px 16px;border-radius:6px;margin-bottom:10px;display:flex;justify-content:space-between;align-items:center}.hdr h1{font-size:14pt;margin:0}.hdr .sub{font-size:8pt;opacity:.9}.hdr .meta{text-align:right;font-size:7pt;opacity:.8}.sec{margin-bottom:8px}.sec-title{font-size:10pt;font-weight:700;color:#1e3a8a;border-bottom:2px solid #3b82f6;padding-bottom:3px;margin-bottom:6px}.g2{display:grid;grid-template-columns:1fr 1fr;gap:8px}.g3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:6px}.g4{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:6px}.card{background:#f8fafc;border:1px solid #e2e8f0;border-radius:5px;padding:8px}.card.blue{background:linear-gradient(135deg,#eff6ff,#dbeafe);border-color:#93c5fd}.card.green{background:linear-gradient(135deg,#f0fdf4,#dcfce7);border-color:#86efac}.card.red{background:linear-gradient(135deg,#fef2f2,#fee2e2);border-color:#fca5a5}.card.purple{background:linear-gradient(135deg,#faf5ff,#f3e8ff);border-color:#c4b5fd}.card.amber{background:linear-gradient(135deg,#fffbeb,#fef3c7);border-color:#fcd34d}.kpi{text-align:center}.kv{font-size:15pt;font-weight:700;color:#1e3a8a}.kv.grn{color:#059669}.kv.rd{color:#dc2626}.kl{font-size:7pt;color:#64748b;text-transform:uppercase;margin-top:1px}.ks{font-size:7pt;color:#6b7280}table{width:100%;border-collapse:collapse;font-size:8pt}th,td{padding:3px 5px;text-align:left;border-bottom:1px solid #e5e7eb}th{background:#f1f5f9;font-weight:600;color:#475569;font-size:7pt}.r{text-align:right}.b{font-weight:700}.tr{background:#f1f5f9;font-weight:700;border-top:2px solid #3b82f6}.ftr{position:absolute;bottom:6px;left:12px;right:12px;text-align:center;font-size:7pt;color:#9ca3af;border-top:1px solid #e5e7eb;padding-top:3px}.ct{font-weight:600;color:#1e3a8a;margin-bottom:5px;font-size:8pt}",me=`<div class="hdr"><div><h1>${v.companyName}</h1><div class="sub">${Y?"Management Report":"Laporan Pengurusan"}  FY ${v.year}</div></div><div class="meta">${v.companyRegNo?v.companyRegNo+"<br>":""}${Y?"Generated":"Dijana"}: ${v.generated}<br>FS Automation ${mi}</div></div>`;let qe=`<!DOCTYPE html><html><head><meta charset="UTF-8"><title>${v.companyName} - Management Report</title><style>${Le}</style></head><body>`;qe+=`<div class="page">${me}
      <div class="sec"><div class="sec-title"> ${Y?"Key Performance Indicators":"Petunjuk Prestasi Utama"}</div>
        <div class="g4">
          <div class="card blue kpi"><div class="kv">RM ${J(b.rev)}</div><div class="kl">${Y?"Revenue":"Hasil"}</div></div>
          <div class="card ${b.gp>=0?"green":"red"} kpi"><div class="kv ${b.gp>=0?"grn":"rd"}">RM ${J(b.gp)}</div><div class="kl">${Y?"Gross Profit":"Untung Kasar"}</div><div class="ks">${Ce(T.gpMargin)}</div></div>
          <div class="card ${b.np>=0?"green":"red"} kpi"><div class="kv ${b.np>=0?"grn":"rd"}">RM ${J(b.np)}</div><div class="kl">${Y?"Net Profit":"Untung Bersih"}</div><div class="ks">${Ce(T.npMargin)}</div></div>
          <div class="card blue kpi"><div class="kv">RM ${J(S.cash)}</div><div class="kl">${Y?"Cash":"Tunai"}</div></div>
        </div>
      </div>
      <div class="sec"><div class="g2">
        <div class="card"><div class="ct"> ${Y?"Profit & Loss Summary":"Ringkasan Untung Rugi"}</div>
          <table><tr><td>${Y?"Revenue":"Hasil"}</td><td class="r b">${Fe(b.rev)}</td><td class="r">100%</td></tr>
          <tr><td>${Y?"Cost of Sales":"Kos Jualan"}</td><td class="r">(${Fe(b.cos)})</td><td class="r" style="color:#dc2626">${Ce(b.rev>0?b.cos/b.rev*100:0)}</td></tr>
          <tr class="tr"><td>${Y?"Gross Profit":"Untung Kasar"}</td><td class="r">${Fe(b.gp)}</td><td class="r" style="color:#059669">${Ce(T.gpMargin)}</td></tr>
          ${b.oi>0?`<tr><td>${Y?"Other Income":"Pendapatan Lain"}</td><td class="r">${Fe(b.oi)}</td><td class="r">${Ce(b.rev>0?b.oi/b.rev*100:0)}</td></tr>`:""}
          <tr><td>${Y?"Operating Expenses":"Perbelanjaan"}</td><td class="r">(${Fe(b.adm)})</td><td class="r">${Ce(b.rev>0?b.adm/b.rev*100:0)}</td></tr>
          ${b.fin>0?`<tr><td>${Y?"Finance Costs":"Kos Kewangan"}</td><td class="r">(${Fe(b.fin)})</td><td class="r">${Ce(b.rev>0?b.fin/b.rev*100:0)}</td></tr>`:""}
          <tr class="tr"><td>${Y?"Profit Before Tax":"Untung Sebelum Cukai"}</td><td class="r">${Fe(b.pbt)}</td><td></td></tr>
          <tr><td>${Y?"Taxation":"Cukai"}</td><td class="r">${b.tax>0?"("+Fe(b.tax)+")":"-"}</td><td></td></tr>
          <tr class="tr" style="background:#dcfce7"><td class="b">${Y?"Net Profit":"Untung Bersih"}</td><td class="r b" style="color:${b.np>=0?"#059669":"#dc2626"}">${Fe(b.np)}</td><td class="r b">${Ce(T.npMargin)}</td></tr></table>
        </div>
        <div class="card"><div class="ct"> ${Y?"Financial Ratios":"Nisbah Kewangan"}</div>
          <table><tr><td>${Y?"Current Ratio":"Nisbah Semasa"}</td><td class="r b" style="color:${T.currentRatio>=1?"#059669":"#dc2626"}">${T.currentRatio.toFixed(2)}</td><td style="width:80px">${ze(T.currentRatio/2*100,T.currentRatio>=1?"#10b981":"#ef4444")}</td></tr>
          <tr><td>${Y?"Quick Ratio":"Nisbah Cepat"}</td><td class="r b" style="color:${T.quickRatio>=1?"#059669":"#dc2626"}">${T.quickRatio.toFixed(2)}</td><td>${ze(T.quickRatio/2*100,T.quickRatio>=1?"#10b981":"#ef4444")}</td></tr>
          <tr><td>${Y?"Debt to Equity":"Hutang/Ekuiti"}</td><td class="r b" style="color:${T.debtToEquity<=1?"#059669":"#f59e0b"}">${T.debtToEquity.toFixed(2)}</td><td>${ze(T.debtToEquity/2*100,T.debtToEquity<=1?"#10b981":"#f59e0b")}</td></tr>
          <tr><td>${Y?"Return on Equity":"Pulangan Ekuiti"}</td><td class="r b">${Ce(T.roe)}</td><td>${ze(Math.abs(T.roe)/30*100,T.roe>=0?"#3b82f6":"#ef4444")}</td></tr>
          <tr><td>${Y?"Return on Assets":"Pulangan Aset"}</td><td class="r b">${Ce(T.roa)}</td><td>${ze(Math.abs(T.roa)/20*100,T.roa>=0?"#3b82f6":"#ef4444")}</td></tr>
          <tr class="tr"><td>${Y?"Working Capital":"Modal Kerja"}</td><td class="r b" style="color:${T.workingCapital>=0?"#059669":"#dc2626"}">RM ${Fe(T.workingCapital)}</td><td></td></tr></table>
        </div>
      </div></div>
      <div class="sec"><div class="g2">
        <div class="card"><div class="ct"> ${Y?"Balance Sheet":"Kedudukan Kewangan"}</div>
          <table><tr><th colspan="2">${Y?"ASSETS":"ASET"}</th></tr>
          ${S.ppe>0?`<tr><td style="padding-left:8px">PPE</td><td class="r">${Fe(S.ppe)}</td></tr>`:""}
          ${S.inv>0?`<tr><td style="padding-left:8px">${Y?"Inventory":"Inventori"}</td><td class="r">${Fe(S.inv)}</td></tr>`:""}
          <tr><td style="padding-left:8px">${Y?"Receivables":"Penghutang"}</td><td class="r">${Fe((S.tr||0)+(S.or||0))}</td></tr>
          <tr><td style="padding-left:8px">${Y?"Cash":"Tunai"}</td><td class="r">${Fe(S.cash)}</td></tr>
          <tr class="tr"><td>${Y?"Total Assets":"Jumlah Aset"}</td><td class="r">${Fe(S.totA)}</td></tr>
          <tr><th colspan="2">${Y?"LIABILITIES":"LIABILITI"}</th></tr>
          <tr class="tr"><td>${Y?"Total Liabilities":"Jumlah Liabiliti"}</td><td class="r">${Fe(S.totL)}</td></tr>
          <tr><th colspan="2">${Y?"EQUITY":"EKUITI"}</th></tr>
          <tr class="tr"><td>${Y?"Total Equity":"Jumlah Ekuiti"}</td><td class="r">${Fe(S.totE)}</td></tr></table>
        </div>
        <div class="card"><div class="ct"> ${Y?"Expense Breakdown":"Pecahan Perbelanjaan"}</div>
          ${Q.length>0?`<table>${Q.map(ot=>`<tr><td>${ot.label}</td><td class="r">${Fe(ot.amount)}</td><td style="width:80px">${ze(ot.pct,"#f59e0b")}</td><td class="r" style="width:35px">${Ce(ot.pct)}</td></tr>`).join("")}<tr class="tr"><td>${Y?"Total":"Jumlah"}</td><td class="r">${Fe(b.adm)}</td><td colspan="2"></td></tr></table>`:`<div style="color:#9ca3af;text-align:center;padding:15px">${Y?"No expense details":"Tiada butiran"}</div>`}
        </div>
      </div></div>
      <div class="ftr">${Y?"Page":"Muka Surat"} 1  ${v.companyName}</div>
    </div>`;const Ye=[];return T.gpMargin>=30?Ye.push({type:"good",text:Y?"Strong gross margin above 30% indicates healthy pricing and cost control":"Margin kasar kukuh melebihi 30% menunjukkan penetapan harga dan kawalan kos yang sihat"}):T.gpMargin<20&&Ye.push({type:"warn",text:Y?"Gross margin below 20% may indicate pricing pressure or high direct costs":"Margin kasar di bawah 20% mungkin menunjukkan tekanan harga atau kos langsung yang tinggi"}),T.currentRatio>=1.5?Ye.push({type:"good",text:Y?"Current ratio above 1.5 shows healthy short-term liquidity":"Nisbah semasa melebihi 1.5 menunjukkan kecairan jangka pendek yang sihat"}):T.currentRatio<1&&Ye.push({type:"warn",text:Y?"Current ratio below 1 indicates potential liquidity risk":"Nisbah semasa di bawah 1 menunjukkan risiko kecairan"}),j.over90>j.total*.2&&Ye.push({type:"warn",text:Y?`${Ce(j.over90/j.total*100)} of receivables overdue >90 days - review collection efforts`:`${Ce(j.over90/j.total*100)} penghutang tertunggak >90 hari - semak usaha kutipan`}),T.debtToEquity>2?Ye.push({type:"warn",text:Y?"High leverage with debt-to-equity above 2x":"Leveraj tinggi dengan hutang/ekuiti melebihi 2x"}):T.debtToEquity<=.5&&Ye.push({type:"good",text:Y?"Conservative capital structure with low debt":"Struktur modal konservatif dengan hutang rendah"}),b.np>0&&T.roe>=15&&Ye.push({type:"good",text:Y?`Strong ROE of ${Ce(T.roe)} indicates efficient use of equity`:`ROE kukuh ${Ce(T.roe)} menunjukkan penggunaan ekuiti yang cekap`}),T.workingCapital<0&&Ye.push({type:"warn",text:Y?"Negative working capital - may need to improve cash cycle":"Modal kerja negatif - mungkin perlu memperbaiki kitaran tunai"}),Ye.length>0&&(qe=qe.replace(`</div>
      <div class="ftr">`+(Y?"Page":"Muka Surat")+" 1",`
      <div class="sec"><div class="card amber"><div class="ct"> ${Y?"Management Insights & Recommendations":"Pandangan & Cadangan Pengurusan"}</div>
        <ul style="margin:0;padding-left:15px;font-size:8pt">
          ${Ye.map(ot=>`<li style="color:${ot.type==="good"?"#059669":"#dc2626"};margin:3px 0">${ot.type==="good"?"":""} ${ot.text}</li>`).join("")}
        </ul>
      </div></div>
      </div>
      <div class="ftr">${Y?"Page":"Muka Surat"} 1`)),qe+=`<div class="page">${me}
      <div class="sec"><div class="sec-title"> ${Y?"Receivables & Payables Analysis":"Analisis Penghutang & Pemiutang"}</div>
        <div class="g2">
          <div class="card ${j.over90>j.total*.2?"red":""}"><div class="ct"> ${Y?"Accounts Receivable Ageing":"Pengumuran Penghutang"}</div>
            <table><tr><th>${Y?"Ageing":"Umur"}</th><th class="r">${Y?"Amount":"Jumlah"}</th><th class="r">%</th><th style="width:70px"></th></tr>
            <tr><td>${Y?"Current":"Semasa"}</td><td class="r">${Fe(j.current)}</td><td class="r">${j.total>0?Ce(j.current/j.total*100):"-"}</td><td>${ze(j.total>0?j.current/j.total*100:0,"#10b981")}</td></tr>
            <tr><td>1-30 ${Y?"days":"hari"}</td><td class="r">${Fe(j.d30)}</td><td class="r">${j.total>0?Ce(j.d30/j.total*100):"-"}</td><td>${ze(j.total>0?j.d30/j.total*100:0,"#3b82f6")}</td></tr>
            <tr><td>31-60 ${Y?"days":"hari"}</td><td class="r">${Fe(j.d60)}</td><td class="r">${j.total>0?Ce(j.d60/j.total*100):"-"}</td><td>${ze(j.total>0?j.d60/j.total*100:0,"#f59e0b")}</td></tr>
            <tr><td>61-90 ${Y?"days":"hari"}</td><td class="r">${Fe(j.d90)}</td><td class="r">${j.total>0?Ce(j.d90/j.total*100):"-"}</td><td>${ze(j.total>0?j.d90/j.total*100:0,"#f97316")}</td></tr>
            <tr style="background:#fef2f2"><td class="b">> 90 ${Y?"days":"hari"}</td><td class="r b" style="color:#dc2626">${Fe(j.over90)}</td><td class="r b">${j.total>0?Ce(j.over90/j.total*100):"-"}</td><td>${ze(j.total>0?j.over90/j.total*100:0,"#ef4444")}</td></tr>
            <tr class="tr"><td>${Y?"Total":"Jumlah"}</td><td class="r">${Fe(j.total)}</td><td class="r">100%</td><td></td></tr></table>
          </div>
          <div class="card"><div class="ct"> ${Y?"Accounts Payable Ageing":"Pengumuran Pemiutang"}</div>
            <table><tr><th>${Y?"Ageing":"Umur"}</th><th class="r">${Y?"Amount":"Jumlah"}</th><th class="r">%</th><th style="width:70px"></th></tr>
            <tr><td>${Y?"Current":"Semasa"}</td><td class="r">${Fe(C.current)}</td><td class="r">${C.total>0?Ce(C.current/C.total*100):"-"}</td><td>${ze(C.total>0?C.current/C.total*100:0,"#10b981")}</td></tr>
            <tr><td>1-30 ${Y?"days":"hari"}</td><td class="r">${Fe(C.d30)}</td><td class="r">${C.total>0?Ce(C.d30/C.total*100):"-"}</td><td>${ze(C.total>0?C.d30/C.total*100:0,"#3b82f6")}</td></tr>
            <tr><td>31-60 ${Y?"days":"hari"}</td><td class="r">${Fe(C.d60)}</td><td class="r">${C.total>0?Ce(C.d60/C.total*100):"-"}</td><td>${ze(C.total>0?C.d60/C.total*100:0,"#f59e0b")}</td></tr>
            <tr><td>61-90 ${Y?"days":"hari"}</td><td class="r">${Fe(C.d90)}</td><td class="r">${C.total>0?Ce(C.d90/C.total*100):"-"}</td><td>${ze(C.total>0?C.d90/C.total*100:0,"#f97316")}</td></tr>
            <tr><td>> 90 ${Y?"days":"hari"}</td><td class="r">${Fe(C.over90)}</td><td class="r">${C.total>0?Ce(C.over90/C.total*100):"-"}</td><td>${ze(C.total>0?C.over90/C.total*100:0,"#ef4444")}</td></tr>
            <tr class="tr"><td>${Y?"Total":"Jumlah"}</td><td class="r">${Fe(C.total)}</td><td class="r">100%</td><td></td></tr></table>
          </div>
        </div>
      </div>
      ${X.length>0||ye.length>0?`<div class="sec"><div class="g2">
        ${X.length>0?`<div class="card"><div class="ct"> ${Y?"Top 5 Debtors":"Top 5 Penghutang"}</div>
          <table><tr><th>${Y?"Customer":"Pelanggan"}</th><th class="r">${Y?"Amount":"Jumlah"}</th></tr>
          ${X.map(ot=>`<tr><td>${ot.customer||ot.description||"N/A"}</td><td class="r">${Fe(parseFloat(ot.amount)||0)}</td></tr>`).join("")}</table></div>`:"<div></div>"}
        ${ye.length>0?`<div class="card"><div class="ct"> ${Y?"Top 5 Creditors":"Top 5 Pemiutang"}</div>
          <table><tr><th>${Y?"Supplier":"Pembekal"}</th><th class="r">${Y?"Amount":"Jumlah"}</th></tr>
          ${ye.map(ot=>`<tr><td>${ot.supplier||ot.description||"N/A"}</td><td class="r">${Fe(parseFloat(ot.amount)||0)}</td></tr>`).join("")}</table></div>`:"<div></div>"}
      </div></div>`:""}
      ${M.length>0?`<div class="sec"><div class="sec-title"> ${Y?"Property, Plant & Equipment":"Hartanah, Loji & Peralatan"}</div>
        <table><tr><th>${Y?"Description":"Keterangan"}</th><th class="r">${Y?"Cost":"Kos"}</th><th class="r">NBV</th></tr>
        ${M.map(ot=>`<tr><td>${ot.desc}</td><td class="r">${Fe(ot.cost)}</td><td class="r b">${Fe(ot.nbv)}</td></tr>`).join("")}
        <tr class="tr"><td>${Y?"Total":"Jumlah"}</td><td></td><td class="r">${Fe(S.ppe)}</td></tr></table>
      </div>`:""}
      <div class="sec"><div class="card" style="background:linear-gradient(135deg,#1e3a8a,#3b82f6);color:#fff;padding:15px">
        <div style="font-size:11pt;font-weight:700;margin-bottom:8px"> ${Y?"Financial Health Score":"Skor Kesihatan Kewangan"}</div>
        <div class="g4">
          <div style="text-align:center"><div style="font-size:20pt;font-weight:700">${T.gpMargin>=30?"A":T.gpMargin>=20?"B":T.gpMargin>=10?"C":"D"}</div><div style="font-size:7pt;opacity:.9">${Y?"Profitability":"Keuntungan"}</div></div>
          <div style="text-align:center"><div style="font-size:20pt;font-weight:700">${T.currentRatio>=2?"A":T.currentRatio>=1.5?"B":T.currentRatio>=1?"C":"D"}</div><div style="font-size:7pt;opacity:.9">${Y?"Liquidity":"Kecairan"}</div></div>
          <div style="text-align:center"><div style="font-size:20pt;font-weight:700">${T.debtToEquity<=.5?"A":T.debtToEquity<=1?"B":T.debtToEquity<=2?"C":"D"}</div><div style="font-size:7pt;opacity:.9">${Y?"Leverage":"Leveraj"}</div></div>
          <div style="text-align:center"><div style="font-size:20pt;font-weight:700">${j.over90<=j.total*.1?"A":j.over90<=j.total*.2?"B":j.over90<=j.total*.3?"C":"D"}</div><div style="font-size:7pt;opacity:.9">${Y?"Collections":"Kutipan"}</div></div>
        </div>
      </div></div>
      <div class="ftr">${Y?"Page":"Muka Surat"} 2  ${v.companyName}  ${Y?"Generated by":"Dijana oleh"} FS Automation ${mi}</div>
    </div>`,qe+"</body></html>"},Ho=u=>{if(!m){alert("Please generate financial statements first before exporting.");return}const v=s||"Company Name",b=sa?.fullStandard||"Malaysian Private Entities Reporting Standard",S=u==="EN",T=ze=>ze==null||ze===0?"-":Number(ze),Q=va.book_new(),j=(ze,Le)=>{const me=va.aoa_to_sheet(ze);return me["!cols"]=[{wch:45},{wch:15},{wch:15}],va.book_append_sheet(Q,me,Le),me},C=[[v.toUpperCase()],[S?"STATEMENT OF FINANCIAL POSITION":"PENYATA KEDUDUKAN KEWANGAN"],[(S?"AS AT ":"PADA ")+Lt.toUpperCase()],[],["",L,fe],["","RM","RM"],[],[S?"ASSETS":"ASET"],[S?"Non-Current Assets":"Aset Bukan Semasa"],[S?"  Property, plant and equipment":"  Hartanah, loji dan peralatan",T(m.bs.ppe),T(m.bs.py_ppe)],["",T(m.bs.totNCA),T(m.bs.py_totNCA)],[],[S?"Current Assets":"Aset Semasa"],[S?"  Inventories":"  Inventori",T(m.bs.inv),T(m.bs.py_inv)],[S?"  Trade receivables":"  Penghutang perdagangan",T(m.bs.tr),T(m.bs.py_tr)],[S?"  Other receivables":"  Penghutang lain",T(m.bs.or),T(m.bs.py_or)],[S?"  Cash and bank balances":"  Tunai dan baki bank",T(m.bs.cash),T(m.bs.py_cash)],["",T(m.bs.totCA),T(m.bs.py_totCA)],[],[S?"TOTAL ASSETS":"JUMLAH ASET",T(m.bs.totA),T(m.bs.py_totA)],[],[],[S?"EQUITY AND LIABILITIES":"EKUITI DAN LIABILITI"],[S?"Equity":"Ekuiti"],[S?"  Share capital / Capital":"  Modal saham / Modal",T(m.bs.cap),T(m.bs.py_cap)],[S?"  Retained profits":"  Keuntungan tertahan",T(m.bs.ret),T(m.bs.py_ret)],[S?"  Current year profit/(loss)":"  Untung/(Rugi) tahun semasa",T(m.bs.cyp),T(m.bs.py_cyp)],[S?"Total Equity":"Jumlah Ekuiti",T(m.bs.totE),T(m.bs.py_totE)],[],[S?"Non-Current Liabilities":"Liabiliti Bukan Semasa"],[S?"  Borrowings":"  Pinjaman",T(m.bs.ltBorr),T(m.bs.py_ltBorr)],["",T(m.bs.totNCL),T(m.bs.py_totNCL)],[],[S?"Current Liabilities":"Liabiliti Semasa"],[S?"  Trade payables":"  Pemiutang perdagangan",T(m.bs.tp),T(m.bs.py_tp)],[S?"  Other payables":"  Pemiutang lain",T(m.bs.op),T(m.bs.py_op)],[S?"  Short-term borrowings":"  Pinjaman jangka pendek",T(m.bs.stBorr),T(m.bs.py_stBorr)],[S?"  Tax payable":"  Cukai kena bayar",T(m.bs.taxPay),T(m.bs.py_taxPay)],["",T(m.bs.totCL),T(m.bs.py_totCL)],[],[S?"Total Liabilities":"Jumlah Liabiliti",T(m.bs.totL),T(m.bs.py_totL)],[],[S?"TOTAL EQUITY AND LIABILITIES":"JUMLAH EKUITI DAN LIABILITI",T(m.bs.totE+m.bs.totL),T((m.bs.py_totE||0)+(m.bs.py_totL||0))],[],[S?"The accompanying notes form an integral part of these financial statements.":"Nota-nota yang disertakan merupakan sebahagian daripada penyata kewangan ini."]];j(C,S?"Balance Sheet":"Kunci Kira-kira");const M=[[v.toUpperCase()],[S?"STATEMENT OF PROFIT OR LOSS AND OTHER COMPREHENSIVE INCOME":"PENYATA UNTUNG RUGI DAN PENDAPATAN KOMPREHENSIF LAIN"],[(S?"FOR THE FINANCIAL YEAR ENDED ":"BAGI TAHUN KEWANGAN BERAKHIR ")+Lt.toUpperCase()],[],["",L,fe],["","RM","RM"],[],[S?"Revenue":"Hasil",T(m.is.rev),T(m.is.py_rev)],[S?"Cost of sales":"Kos jualan",T(-Math.abs(m.is.cos)),T(-Math.abs(m.is.py_cos))],[S?"Gross profit":"Untung kasar",T(m.is.gp),T(m.is.py_gp)],[],[S?"Other income":"Pendapatan lain",T(m.is.oi),T(m.is.py_oi)],[S?"Administrative expenses":"Perbelanjaan pentadbiran",T(-Math.abs(m.is.adm)),T(-Math.abs(m.is.py_adm))],[S?"Operating profit":"Untung operasi",T(m.is.op),T(m.is.py_op)],[],[S?"Finance costs":"Kos kewangan",T(-Math.abs(m.is.fin)),T(-Math.abs(m.is.py_fin||0))],[S?"Profit before taxation":"Untung sebelum cukai",T(m.is.pbt),T(m.is.py_pbt)],[],[S?"Taxation":"Cukai",T(-Math.abs(m.is.tax)),T(-Math.abs(m.is.py_tax||0))],[S?"Profit for the year":"Untung bagi tahun",T(m.is.np),T(m.is.py_np)],[],[S?"Other comprehensive income":"Pendapatan komprehensif lain","-","-"],[S?"Total comprehensive income for the year":"Jumlah pendapatan komprehensif bagi tahun",T(m.is.np),T(m.is.py_np)],[],[S?"The accompanying notes form an integral part of these financial statements.":"Nota-nota yang disertakan merupakan sebahagian daripada penyata kewangan ini."]];j(M,S?"Income Statement":"Penyata Pendapatan");const X=[[v.toUpperCase()],[S?"STATEMENT OF CHANGES IN EQUITY":"PENYATA PERUBAHAN EKUITI"],[(S?"FOR THE FINANCIAL YEAR ENDED ":"BAGI TAHUN KEWANGAN BERAKHIR ")+Lt.toUpperCase()],[],["",S?"Share Capital":"Modal Saham",S?"Retained Earnings":"Pendapatan Tertahan",S?"Total":"Jumlah"],["","RM","RM","RM"],[],[(S?"Balance at 1 January ":"Baki pada 1 Januari ")+fe,T(m.bs.py_cap),T((m.bs.py_ret||0)-(m.is.py_np||0)),T((m.bs.py_totE||0)-(m.is.py_np||0))],[S?"  Profit for the year":"  Untung bagi tahun","-",T(m.is.py_np),T(m.is.py_np)],[(S?"Balance at 31 December ":"Baki pada 31 Disember ")+fe,T(m.bs.py_cap),T(m.bs.py_ret),T(m.bs.py_totE)],[],[(S?"Balance at 1 January ":"Baki pada 1 Januari ")+L,T(m.bs.py_cap),T(m.bs.py_ret+(m.bs.py_cyp||0)),T(m.bs.py_totE)],[S?"  Profit for the year":"  Untung bagi tahun","-",T(m.is.np),T(m.is.np)],[(S?"Balance at 31 December ":"Baki pada 31 Disember ")+L,T(m.bs.cap),T(m.bs.ret+m.bs.cyp),T(m.bs.totE)],[],[S?"The accompanying notes form an integral part of these financial statements.":"Nota-nota yang disertakan merupakan sebahagian daripada penyata kewangan ini."]],ye=va.aoa_to_sheet(X);ye["!cols"]=[{wch:35},{wch:18},{wch:18},{wch:18}],va.book_append_sheet(Q,ye,S?"Changes in Equity":"Perubahan Ekuiti");const Fe=[[v.toUpperCase()],[S?"STATEMENT OF CASH FLOWS":"PENYATA ALIRAN TUNAI"],[(S?"FOR THE FINANCIAL YEAR ENDED ":"BAGI TAHUN KEWANGAN BERAKHIR ")+Lt.toUpperCase()],[],["",L,fe],["","RM","RM"],[],[S?"CASH FLOWS FROM OPERATING ACTIVITIES":"ALIRAN TUNAI DARIPADA AKTIVITI OPERASI"],[S?"  Profit before taxation":"  Untung sebelum cukai",T(m.cf.pbt),T(m.is.py_pbt||0)],[S?"  Adjustments for:":"  Pelarasan untuk:"],[S?"    Depreciation":"    Susut nilai",T(m.cf.adjustments.depreciation),"-"],[S?"    Interest expense":"    Perbelanjaan faedah",T(m.cf.adjustments.interestExpense),"-"],[S?"    Interest income":"    Pendapatan faedah",T(-m.cf.adjustments.interestIncome),"-"],[S?"  Operating profit before working capital changes":"  Untung operasi sebelum perubahan modal kerja",T(m.cf.pbt+m.cf.totalAdjustments),"-"],[S?"  Changes in inventories":"  Perubahan dalam inventori",T(-m.cf.workingCapitalChanges.inventory),"-"],[S?"  Changes in receivables":"  Perubahan dalam penghutang",T(-(m.cf.workingCapitalChanges.tradeReceivables+m.cf.workingCapitalChanges.otherReceivables)),"-"],[S?"  Changes in payables":"  Perubahan dalam pemiutang",T(m.cf.workingCapitalChanges.tradePayables+m.cf.workingCapitalChanges.otherPayables),"-"],[S?"  Cash generated from operations":"  Tunai dijana daripada operasi",T(m.cf.cashFromOperations),"-"],[S?"  Tax paid":"  Cukai dibayar",T(-Math.abs(m.cf.taxPaid)),"-"],[S?"  Interest paid":"  Faedah dibayar",T(-Math.abs(m.cf.interestPaid)),"-"],[S?"Net cash from operating activities":"Tunai bersih daripada aktiviti operasi",T(m.cf.netOperating),"-"],[],[S?"CASH FLOWS FROM INVESTING ACTIVITIES":"ALIRAN TUNAI DARIPADA AKTIVITI PELABURAN"],[S?"  Purchase of PPE":"  Pembelian PPE",T(-Math.abs(m.cf.ppePurchases)),"-"],[S?"  Interest received":"  Faedah diterima",T(m.cf.interestReceived),"-"],[S?"Net cash from investing activities":"Tunai bersih daripada aktiviti pelaburan",T(m.cf.netInvesting),"-"],[],[S?"CASH FLOWS FROM FINANCING ACTIVITIES":"ALIRAN TUNAI DARIPADA AKTIVITI PEMBIAYAAN"],[S?"  Loan proceeds":"  Penerimaan pinjaman",T(m.cf.loanProceeds),"-"],[S?"  Loan repayments":"  Bayaran balik pinjaman",T(-Math.abs(m.cf.loanRepayments)),"-"],[S?"  Capital injection":"  Suntikan modal",T(m.cf.capitalInjection),"-"],[S?"  Dividends/Drawings":"  Dividen/Pengeluaran",T(-Math.abs(m.cf.dividendsPaid+m.cf.drawingsWithdrawals)),"-"],[S?"Net cash from financing activities":"Tunai bersih daripada aktiviti pembiayaan",T(m.cf.netFinancing),"-"],[],[S?"NET CHANGE IN CASH":"PERUBAHAN BERSIH DALAM TUNAI",T(m.cf.netChangeInCash),"-"],[S?"Cash at beginning of year":"Tunai pada awal tahun",T(m.cf.openingCash),T(m.bs.py_cash||0)],[S?"CASH AT END OF YEAR":"TUNAI PADA AKHIR TAHUN",T(m.cf.closingCash),T(m.cf.openingCash)],[],[S?"The accompanying notes form an integral part of these financial statements.":"Nota-nota yang disertakan merupakan sebahagian daripada penyata kewangan ini."]];j(Fe,S?"Cash Flow":"Aliran Tunai");const Ce=[[v.toUpperCase()],[S?"NOTES TO THE FINANCIAL STATEMENTS":"NOTA-NOTA KEPADA PENYATA KEWANGAN"],[(S?"FOR THE FINANCIAL YEAR ENDED ":"BAGI TAHUN KEWANGAN BERAKHIR ")+Lt.toUpperCase()],[],[S?"1. GENERAL INFORMATION":"1. MAKLUMAT AM"],[S?"The Company is incorporated and domiciled in Malaysia.":"Syarikat diperbadankan dan bermastautin di Malaysia."],[S?"Principal activities: General trading and services.":"Aktiviti utama: Perdagangan am dan perkhidmatan."],[],[S?"2. BASIS OF PREPARATION":"2. ASAS PENYEDIAAN"],[S?"These financial statements have been prepared in accordance with "+b+".":"Penyata kewangan ini telah disediakan mengikut "+b+"."],[],[S?"3. SIGNIFICANT ACCOUNTING POLICIES":"3. DASAR PERAKAUNAN PENTING"],[S?"(a) Property, plant and equipment":"(a) Hartanah, loji dan peralatan"],[S?"    Depreciation rates:":"    Kadar susut nilai:"],[S?"    - Buildings: 2%":"    - Bangunan: 2%"],[S?"    - Motor vehicles: 20%":"    - Kenderaan bermotor: 20%"],[S?"    - Office equipment: 10%":"    - Peralatan pejabat: 10%"],[S?"    - Computer equipment: 33.33%":"    - Peralatan komputer: 33.33%"],[S?"    - Furniture & fittings: 10%":"    - Perabot & kelengkapan: 10%"],[],[S?"(b) Inventories":"(b) Inventori"],[S?"    Stated at lower of cost and net realisable value using FIFO method.":"    Dinyatakan pada kos atau nilai boleh realis bersih yang lebih rendah menggunakan kaedah FIFO."],[],[S?"4. PROPERTY, PLANT AND EQUIPMENT":"4. HARTANAH, LOJI DAN PERALATAN"],["",S?"Cost":"Kos",S?"Acc. Dep.":"Susut Nilai Terkumpul","NBV"],["","RM","RM","RM"],[S?"Total":"Jumlah",T(m.bs.ppe+(rt?.ppe?.accDepCF||0)),T(rt?.ppe?.accDepCF||0),T(m.bs.ppe)],[],[S?"5. TRADE AND OTHER RECEIVABLES":"5. PENGHUTANG PERDAGANGAN DAN LAIN-LAIN"],[S?"Trade receivables":"Penghutang perdagangan",T(m.bs.tr)],[S?"Other receivables":"Penghutang lain",T(m.bs.or)],["Total",T(m.bs.tr+m.bs.or)],[],[S?"6. CASH AND BANK BALANCES":"6. TUNAI DAN BAKI BANK"],[S?"Cash and bank balances":"Tunai dan baki bank",T(m.bs.cash)],[],[S?"7. SHARE CAPITAL / CAPITAL":"7. MODAL SAHAM / MODAL"],[S?"Issued and fully paid":"Diterbitkan dan berbayar penuh",T(m.bs.cap)],[],[S?"8. TRADE AND OTHER PAYABLES":"8. PEMIUTANG PERDAGANGAN DAN LAIN-LAIN"],[S?"Trade payables":"Pemiutang perdagangan",T(m.bs.tp)],[S?"Other payables":"Pemiutang lain",T(m.bs.op)],["Total",T(m.bs.tp+m.bs.op)],[],[S?"9. REVENUE":"9. HASIL"],[S?"Sale of goods and services":"Jualan barangan dan perkhidmatan",T(m.is.rev)],[],[S?"10. TAXATION":"10. CUKAI"],[S?"Current tax expense":"Perbelanjaan cukai semasa",T(m.is.tax)]],J=va.aoa_to_sheet(Ce);J["!cols"]=[{wch:50},{wch:15},{wch:15},{wch:15}],va.book_append_sheet(Q,J,S?"Notes":"Nota");const Y=(s||"Financial_Statements").replace(/[^a-zA-Z0-9]/g,"_")+"_FS_"+L+"_"+u+".xlsx";el(Q,Y),he(!1),ke(ze=>[...ze,{t:"ok",m:` Excel file ${Y} downloaded`}])},$o=u=>{if(console.log("generatePDF called, lang:",u,"res:",m),!m){alert(`Please generate financial statements first!

Go to Review tab and click "Generate FS" button.`),he(!1);return}const v=Tf(u);if(console.log("generateFullFS returned:",v?"HTML content ("+v.length+" chars)":"null"),!v){alert("Failed to generate financial statements. Please try again."),he(!1);return}Ue(v),He("pdf"),he(!1),ke(b=>[...b,{t:"ok",m:' PDF preview ready. Click "Print to PDF" or use Ctrl+P.'}])},Vl=u=>{rl("html",u),he(!1),ke(v=>[...v,{t:"ok",m:` Full FS (HTML) downloaded - ${u}`}])},Go=()=>{he(!0)},_0=(u,v,b)=>{const S=[v.join(","),...u.map(Q=>Q.map(j=>{const C=String(j??"");return C.includes(",")||C.includes('"')||C.includes(`
`)?`"${C.replace(/"/g,'""')}"`:C}).join(","))].join(`
`),T=new Blob([S],{type:"text/csv;charset=utf-8;"});an(T,`${b}.csv`),ke(Q=>[...Q,{t:"ok",m:` Exported ${b}.csv`}])},C0=(u,v,b,S="Sheet1")=>{const T=[v,...u],Q=va.aoa_to_sheet(T),j=v.map((M,X)=>{const ye=Math.max(M.length,...u.map(Fe=>String(Fe[X]??"").length));return{wch:Math.min(ye+2,40)}});Q["!cols"]=j;const C=va.book_new();va.book_append_sheet(C,Q,S.substring(0,31)),el(C,`${b}.xlsx`)?ke(M=>[...M,{t:"ok",m:` Exported ${b}.xlsx`}]):ke(M=>[...M,{t:"error",m:` Failed to export ${b}.xlsx`}])},jn=(u,v,b,S,T="xlsx")=>{T==="csv"?_0(u,v,b):C0(u,v,b,S)},Yo=(u="xlsx")=>{const v=["GL Code","Asset ID","Description","Category","Acquisition Date","Cost (RM)","Useful Life (Yrs)","Dep Rate (%)","Acc Dep B/F (RM)","Current Dep (RM)","Acc Dep C/F (RM)","NBV (RM)"],b=De.map((T,Q)=>{const j=ge[T.category]||ge.OFFICE_EQUIPMENT,C=parseFloat(T.cost)||0,M=parseFloat(T.accDepBF)||0,X=Math.min(C*(j.rate/100),C-M),ye=M+X,Fe=C-ye;return["1000",`PPE-${String(Q+1).padStart(3,"0")}`,T.description,j.label,T.acquisitionDate,C,j.years,j.rate,M,X,ye,Fe]}),S=b.reduce((T,Q)=>(T.cost+=parseFloat(Q[5])||0,T.accDepBF+=parseFloat(Q[8])||0,T.currentDep+=parseFloat(Q[9])||0,T.accDepCF+=parseFloat(Q[10])||0,T.nbv+=parseFloat(Q[11])||0,T),{cost:0,accDepBF:0,currentDep:0,accDepCF:0,nbv:0});b.push(["","","TOTAL","","",S.cost,"","",S.accDepBF,S.currentDep,S.accDepCF,S.nbv]),jn(b,v,`PPE_Register_${s.replace(/\s+/g,"_")}_${L}`,"PPE Register",u)},Wo=(u="xlsx")=>{const v=["GL Code","Item Code","Description","Category","Quantity","Unit Cost (RM)","Total Value (RM)","Location"],b=Xe.map((T,Q)=>["1500",T.code||`INV-${String(Q+1).padStart(3,"0")}`,T.description,T.category||"General",parseFloat(T.qty)||0,parseFloat(T.unitCost)||0,parseFloat(T.totalValue)||0,T.location||"-"]),S=b.reduce((T,Q)=>T+(parseFloat(Q[6])||0),0);b.push(["","","TOTAL","","","",S,""]),jn(b,v,`Inventory_Ledger_${s.replace(/\s+/g,"_")}_${L}`,"Inventory",u)},Vo=(u="xlsx")=>{const v=["GL Code","Invoice No","Customer Name","Invoice Date","Due Date","Amount (RM)","Status","Aging (Days)"],b=new Date,S=We.map((Q,j)=>{const C=new Date(Q.dueDate),M=Math.floor((b-C)/(1e3*60*60*24));return["1600",Q.invoiceNo||`INV-${String(j+1).padStart(4,"0")}`,Q.customerName,Q.invoiceDate,Q.dueDate,parseFloat(Q.amount)||0,Q.status||"Outstanding",M>0?M:0]}),T=S.reduce((Q,j)=>Q+(parseFloat(j[5])||0),0);S.push(["","","TOTAL","","",T,"",""]),jn(S,v,`Trade_Receivables_${s.replace(/\s+/g,"_")}_${L}`,"AR",u)},Xo=(u="xlsx")=>{const v=["GL Code","Invoice No","Supplier Name","Invoice Date","Due Date","Amount (RM)","Status","Aging (Days)"],b=new Date,S=Nt.map((Q,j)=>{const C=new Date(Q.dueDate),M=Math.floor((b-C)/(1e3*60*60*24));return["2600",Q.invoiceNo||`BILL-${String(j+1).padStart(4,"0")}`,Q.supplierName,Q.invoiceDate,Q.dueDate,parseFloat(Q.amount)||0,Q.status||"Outstanding",M>0?M:0]}),T=S.reduce((Q,j)=>Q+(parseFloat(j[5])||0),0);S.push(["","","TOTAL","","",T,"",""]),jn(S,v,`Trade_Payables_${s.replace(/\s+/g,"_")}_${L}`,"AP",u)},qo=(u="xlsx")=>{const v=["GL Code","Reference","Description","Type","Amount (RM)"],b=Vt.map((T,Q)=>["1700",T.ref||`OD-${String(Q+1).padStart(3,"0")}`,T.description,T.type||"Deposit",parseFloat(T.amount)||0]),S=b.reduce((T,Q)=>T+(parseFloat(Q[4])||0),0);b.push(["","","TOTAL","",S]),jn(b,v,`Other_Debtors_${s.replace(/\s+/g,"_")}_${L}`,"Other Debtors",u)},Ar=(u="xlsx")=>{const v=["GL Code","Reference","Description","Type","Amount (RM)"],b=Or.map((T,Q)=>["2700",T.ref||`OC-${String(Q+1).padStart(3,"0")}`,T.description,T.type||"Accrual",parseFloat(T.amount)||0]),S=b.reduce((T,Q)=>T+(parseFloat(Q[4])||0),0);b.push(["","","TOTAL","",S]),jn(b,v,`Other_Creditors_${s.replace(/\s+/g,"_")}_${L}`,"Other Creditors",u)},Di=(u="xlsx")=>{const v=["GL Code","Bank Name","Account Number","Opening Balance (RM)","Closing Balance (RM)"],b=$a.map((Q,j)=>["1900",Q.bankName,Q.accountNo||"-",parseFloat(Q.openingBalance)||0,parseFloat(Q.closingBalance)||0]),S=b.reduce((Q,j)=>Q+(parseFloat(j[3])||0),0),T=b.reduce((Q,j)=>Q+(parseFloat(j[4])||0),0);b.push(["","TOTAL","",S,T]),jn(b,v,`Cash_Bank_Ledger_${s.replace(/\s+/g,"_")}_${L}`,"Cash & Bank",u)},k0=()=>{const u=va.book_new(),v=["GL Code","Asset ID","Description","Category","Acquisition Date","Cost (RM)","Useful Life","Dep Rate (%)","Acc Dep B/F","Current Dep","Acc Dep C/F","NBV"],b=De.map((nt,Aa)=>{const Wa=ge[nt.category]||ge.OFFICE_EQUIPMENT,gn=parseFloat(nt.cost)||0,Zn=parseFloat(nt.accDepBF)||0,Sa=Math.min(gn*(Wa.rate/100),gn-Zn);return["1000",`PPE-${String(Aa+1).padStart(3,"0")}`,nt.description,Wa.label,nt.acquisitionDate,gn,Wa.years,Wa.rate,Zn,Sa,Zn+Sa,gn-Zn-Sa]}),S=va.aoa_to_sheet([v,...b]);va.book_append_sheet(u,S,"PPE Register");const T=["GL Code","Item Code","Description","Category","Quantity","Unit Cost","Total Value","Location"],Q=Xe.map((nt,Aa)=>["1500",nt.code||`INV-${String(Aa+1).padStart(3,"0")}`,nt.description,nt.category||"General",parseFloat(nt.qty)||0,parseFloat(nt.unitCost)||0,parseFloat(nt.totalValue)||0,nt.location||"-"]),j=va.aoa_to_sheet([T,...Q]);va.book_append_sheet(u,j,"Inventory");const C=["GL Code","Invoice No","Customer","Invoice Date","Due Date","Amount","Status","Aging"],M=new Date,X=We.map((nt,Aa)=>{const Wa=Math.max(0,Math.floor((M-new Date(nt.dueDate))/864e5));return["1600",nt.invoiceNo||`INV-${String(Aa+1).padStart(4,"0")}`,nt.customerName,nt.invoiceDate,nt.dueDate,parseFloat(nt.amount)||0,nt.status||"Outstanding",Wa]}),ye=va.aoa_to_sheet([C,...X]);va.book_append_sheet(u,ye,"Trade Receivables");const Fe=["GL Code","Invoice No","Supplier","Invoice Date","Due Date","Amount","Status","Aging"],Ce=Nt.map((nt,Aa)=>{const Wa=Math.max(0,Math.floor((M-new Date(nt.dueDate))/864e5));return["2600",nt.invoiceNo||`BILL-${String(Aa+1).padStart(4,"0")}`,nt.supplierName,nt.invoiceDate,nt.dueDate,parseFloat(nt.amount)||0,nt.status||"Outstanding",Wa]}),J=va.aoa_to_sheet([Fe,...Ce]);va.book_append_sheet(u,J,"Trade Payables");const Y=["GL Code","Reference","Description","Type","Amount"],ze=Vt.map((nt,Aa)=>["1700",nt.ref||`OD-${String(Aa+1).padStart(3,"0")}`,nt.description,nt.type||"Deposit",parseFloat(nt.amount)||0]),Le=va.aoa_to_sheet([Y,...ze]);va.book_append_sheet(u,Le,"Other Debtors");const me=["GL Code","Reference","Description","Type","Amount"],qe=Or.map((nt,Aa)=>["2700",nt.ref||`OC-${String(Aa+1).padStart(3,"0")}`,nt.description,nt.type||"Accrual",parseFloat(nt.amount)||0]),Ye=va.aoa_to_sheet([me,...qe]);va.book_append_sheet(u,Ye,"Other Creditors");const ot=["GL Code","Bank Name","Account Number","Opening Balance","Closing Balance"],Xt=$a.map(nt=>["1900",nt.bankName,nt.accountNo||"-",parseFloat(nt.openingBalance)||0,parseFloat(nt.closingBalance)||0]),ct=va.aoa_to_sheet([ot,...Xt]);va.book_append_sheet(u,ct,"Cash & Bank");const ba=`Subledgers_${(s||"Company").replace(/[^a-zA-Z0-9]/g,"_")}_${L}.xlsx`;el(u,ba)?ke(nt=>[...nt,{t:"ok",m:" All subledgers exported to Excel (7 sheets)"}]):ke(nt=>[...nt,{t:"error",m:" Failed to export subledgers to Excel"}])},w0=()=>{Yo("csv"),Wo("csv"),Vo("csv"),Xo("csv"),qo("csv"),Ar("csv"),Di("csv")},Ko=(u="xlsx")=>{if(!m){ke(Q=>[...Q,{t:"error",m:" Generate FS first before exporting Trial Balance"}]);return}const v=["GL Code","Account Name","Debit (RM)","Credit (RM)"],b=m.tb.map(Q=>{let j="9999";const C=Q.acc.toUpperCase();for(const X of Object.values(Gt.income)){const ye=X.find(Fe=>Fe.id===C);if(ye?.glCode){j=ye.glCode;break}}for(const X of Object.values(Gt.balance)){const ye=X.find(Fe=>Fe.id===C);if(ye?.glCode){j=ye.glCode;break}}const M=Gt.other.find(X=>X.id===C);return M?.glCode&&(j=M.glCode),(Q.acc.startsWith("bank_")||Q.acc==="bank")&&(j="1900"),[j,Gm[j]?.name||Q.acc,Q.dr>0?Q.dr:"",Q.cr>0?Q.cr:""]}),S=m.tb.reduce((Q,j)=>Q+(j.dr||0),0),T=m.tb.reduce((Q,j)=>Q+(j.cr||0),0);b.push(["","TOTAL",S,T]),jn(b,v,`Trial_Balance_${s.replace(/\s+/g,"_")}_${L}`,"Trial Balance",u)},R0=(u="xlsx")=>{const v=["GL Code","Account Name","Type","FS Line Item","Group"],b=Object.entries(Gm).filter(([S,T])=>!T.subAccount).sort((S,T)=>S[0].localeCompare(T[0])).map(([S,T])=>[S,T.name,T.type,T.fsId||"-",T.group||"-"]);jn(b,v,`Chart_of_Accounts_${s.replace(/\s+/g,"_")}`,"COA",u)},Jo=()=>{const u={version:"1.2",savedAt:new Date().toISOString(),companyName:s,companyRegNo:f,companyType:t,accountingStandard:E,financialYearEnd:g,currentYear:L,priorFSYear:fe,priorISItems:G,priorBSItems:xe,banks:Ut,bankStatements:wn,txs:_,cashTxs:N,ob:le,ppeRegister:De,inventoryLedger:Xe,tradeReceivables:We,tradePayables:Nt,otherDebtors:Vt,otherCreditors:Or,cashBankLedger:$a,shortTermBorrowings:ya,longTermBorrowings:Ga,caScheduleItems:en,taxSettings:Et,fsSnapshots:gt,adjustmentLog:et,res:m},v=JSON.stringify(u,null,2);try{const b=new Blob([v],{type:"application/json"}),S=(s||"fs-session").replace(/[^a-zA-Z0-9]/g,"_")+"_FY"+L+"_session.json";an(b,S),ke(T=>[...T,{t:"ok",m:"Session saved: "+S}])}catch{Ue(v),He("json")}},N0=dt.useRef(null),us=u=>{const v=u.target.files[0];if(!v)return;const b=new FileReader;b.onload=S=>{try{const T=JSON.parse(S.target.result);T.companyName&&c(T.companyName),T.companyRegNo&&p(T.companyRegNo),T.companyType&&i(T.companyType),T.accountingStandard&&A(T.accountingStandard),T.financialYearEnd&&h(T.financialYearEnd),T.currentYear&&K(T.currentYear),T.priorFSYear&&Je(T.priorFSYear),T.priorISItems&&V(T.priorISItems),T.priorBSItems&&Re(T.priorBSItems),T.banks&&ns(T.banks),T.bankStatements&&Er(T.bankStatements),T.txs&&w(T.txs),T.cashTxs&&k(T.cashTxs),T.ob&&oe(T.ob),T.ppeRegister&&Ve(T.ppeRegister),T.inventoryLedger&&Ge(T.inventoryLedger),T.tradeReceivables&&it(T.tradeReceivables),T.tradePayables&&Wt(T.tradePayables),T.otherDebtors&&sr(T.otherDebtors),T.otherCreditors&&Vr(T.otherCreditors),T.cashBankLedger&&Nn(T.cashBankLedger),T.shortTermBorrowings&&di(T.shortTermBorrowings),T.longTermBorrowings&&xr(T.longTermBorrowings),T.caScheduleItems&&Tr(T.caScheduleItems),T.fsSnapshots&&Z(T.fsSnapshots),T.adjustmentLog&&ra(T.adjustmentLog),T.taxSettings&&ht(Q=>({...Q,...T.taxSettings,addBackExpenses:{...Q.addBackExpenses,...T.taxSettings.addBackExpenses||{}},taxRebates:{...Q.taxRebates,...T.taxSettings.taxRebates||{}}})),T.res&&Se(T.res),ke(Q=>[...Q,{t:"ok",m:`Session loaded: ${v.name} (saved ${T.savedAt?new Date(T.savedAt).toLocaleString():"unknown"})`}]),T.res?a("journal"):T.txs&&T.txs.length>0?a("review"):T.companyType&&a("priorfs")}catch(T){ke(Q=>[...Q,{t:"error",m:`Error loading session: ${T.message}`}]),alert("Error loading session file. Please check the file format.")}},b.readAsText(v),u.target.value=""},Qo=()=>{w([]),k([]),ns([]),Er({}),ke([]),Se(null),oe({}),O(!1),V(P()),Re(U()),i(""),c(""),p(""),A(""),Ve([]),Ge([]),it([]),Wt([]),sr([]),Vr([]),Nn([]),di([]),xr([]),Z([]),ra([]),a("setup")},Oi=(()=>{let u=0,v=0;return Ut.forEach(b=>{ni.forEach(S=>{u++,wn[b.id]?.[S]?.uploaded&&v++})}),{total:u,uploaded:v,percent:u>0?Math.round(v/u*100):0}})(),ft={padding:"8px 10px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:13,width:"100%"},Ot={...ft,textAlign:"right",fontFamily:"monospace"},Na=u=>({padding:"12px 10px",background:e===u?"rgba(99,102,241,0.15)":"transparent",borderBottom:e===u?"2px solid #818cf8":"2px solid transparent",color:e===u?"#a5b4fc":"#6b7280",fontSize:11,fontWeight:600,cursor:"pointer",border:"none",whiteSpace:"nowrap"}),xa={fontSize:11,fontWeight:700,color:"#9ca3af",marginBottom:8,textTransform:"uppercase",letterSpacing:1},lr={padding:"8px 16px",background:"rgba(75,85,99,0.3)",border:"1px solid rgba(75,85,99,0.4)",borderRadius:6,color:"#9ca3af",fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:6},ja={padding:"8px 16px",background:"linear-gradient(135deg, #6366f1, #4f46e5)",border:"none",borderRadius:6,color:"#fff",fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:6},ps=["setup","priorfs","banks","upload","review","classify","cashvoucher","subledger","balances","journal","trial","income","balance","cashflow","tax","snapshots","dashboard"],or=()=>{const u=ps.indexOf(e);u>0&&a(ps[u-1])},_r=()=>{const u=ps.indexOf(e);u<ps.length-1&&a(ps[u+1])};return o.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(145deg, #111827 0%, #1f2937 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',color:"#e5e7eb"},children:[o.jsx("input",{type:"file",ref:N0,onChange:us,accept:".json",style:{display:"none"}}),te&&o.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:100},children:o.jsxs("div",{style:{background:"linear-gradient(145deg, #1f2937, #111827)",borderRadius:16,border:"1px solid rgba(75,85,99,0.3)",padding:24,maxWidth:520,width:"90%",maxHeight:"90vh",overflowY:"auto"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:700},children:" Export Financial Statements"}),o.jsx("button",{onClick:()=>he(!1),style:{background:"none",border:"none",color:"#9ca3af",fontSize:20,cursor:"pointer"},children:""})]}),o.jsxs("p",{style:{fontSize:11,color:"#9ca3af",marginBottom:14},children:["Generate ",sa?.standard||"MPERS","-compliant financial statements. Choose format and language:"]}),o.jsxs("div",{style:{marginBottom:14},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#f87171",marginBottom:8},children:" PDF Document (.pdf) - Recommended"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[o.jsxs("button",{type:"button",onClick:()=>$o("EN"),style:{padding:12,background:"rgba(239,68,68,0.15)",border:"2px solid rgba(239,68,68,0.4)",borderRadius:10,cursor:"pointer"},children:[o.jsx("div",{style:{fontSize:18,marginBottom:2},children:""}),o.jsx("div",{style:{fontWeight:700,color:"#fca5a5",fontSize:11},children:"English (.pdf)"})]}),o.jsxs("button",{type:"button",onClick:()=>$o("BM"),style:{padding:12,background:"rgba(239,68,68,0.15)",border:"2px solid rgba(239,68,68,0.4)",borderRadius:10,cursor:"pointer"},children:[o.jsx("div",{style:{fontSize:18,marginBottom:2},children:""}),o.jsx("div",{style:{fontWeight:700,color:"#fca5a5",fontSize:11},children:"Bahasa Malaysia (.pdf)"})]})]})]}),o.jsxs("div",{style:{marginBottom:14},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#a5b4fc",marginBottom:8},children:" Word Document (.doc) - Professional Format"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[o.jsxs("button",{type:"button",onClick:()=>{if(console.log("Word EN clicked"),!m){console.error("No financial statements generated"),ke(u=>[...u,{t:"err",m:" Please generate financial statements first"}]);return}try{console.log("Starting Word generation..."),ke(b=>[...b,{t:"info",m:"Generating Word document..."}]);const u=S0("EN");if(!u){console.error("HTML is null"),ke(b=>[...b,{t:"err",m:" Failed to generate document"}]);return}const v=new Blob([u],{type:"application/msword"});an(v,`${(s||"Company").replace(/[^a-zA-Z0-9]/g,"_")}_FS_${L}_EN.doc`),ke(b=>[...b,{t:"ok",m:" Word document downloaded (EN)"}])}catch(u){console.error("Word export error:",u),ke(v=>[...v,{t:"err",m:` Word error: ${u.message}`}])}he(!1)},style:{padding:12,background:"rgba(59,130,246,0.15)",border:"2px solid rgba(59,130,246,0.4)",borderRadius:10,cursor:"pointer"},children:[o.jsx("div",{style:{fontSize:18,marginBottom:2},children:""}),o.jsx("div",{style:{fontWeight:600,color:"#93c5fd",fontSize:10},children:"English (.doc)"})]}),o.jsxs("button",{type:"button",onClick:()=>{if(console.log("Word BM clicked"),!m){console.error("No financial statements generated"),ke(u=>[...u,{t:"err",m:" Please generate financial statements first"}]);return}try{console.log("Starting Word generation..."),ke(b=>[...b,{t:"info",m:"Generating Word document..."}]);const u=S0("BM");if(!u){console.error("HTML is null"),ke(b=>[...b,{t:"err",m:" Failed to generate document"}]);return}const v=new Blob([u],{type:"application/msword"});an(v,`${(s||"Company").replace(/[^a-zA-Z0-9]/g,"_")}_FS_${L}_BM.doc`),ke(b=>[...b,{t:"ok",m:" Word document downloaded (BM)"}])}catch(u){console.error("Word export error:",u),ke(v=>[...v,{t:"err",m:` Word error: ${u.message}`}])}he(!1)},style:{padding:12,background:"rgba(59,130,246,0.15)",border:"2px solid rgba(59,130,246,0.4)",borderRadius:10,cursor:"pointer"},children:[o.jsx("div",{style:{fontSize:18,marginBottom:2},children:""}),o.jsx("div",{style:{fontWeight:600,color:"#93c5fd",fontSize:10},children:"Bahasa Malaysia (.doc)"})]})]}),o.jsx("div",{style:{fontSize:8,color:"#9ca3af",marginTop:4,textAlign:"center"},children:" Professional layout   Borders on amount columns only   Page breaks between sections"})]}),o.jsxs("div",{style:{marginBottom:14},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#4ade80",marginBottom:8},children:" Excel Spreadsheet (.xlsx) - RECOMMENDED"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[o.jsxs("button",{onClick:()=>Ho("EN"),style:{padding:12,background:"rgba(74,222,128,0.15)",border:"2px solid rgba(74,222,128,0.5)",borderRadius:10,cursor:"pointer"},children:[o.jsx("div",{style:{fontSize:18,marginBottom:2},children:""}),o.jsx("div",{style:{fontWeight:700,color:"#4ade80",fontSize:11},children:"English (.xlsx)"})]}),o.jsxs("button",{onClick:()=>Ho("BM"),style:{padding:12,background:"rgba(74,222,128,0.15)",border:"2px solid rgba(74,222,128,0.5)",borderRadius:10,cursor:"pointer"},children:[o.jsx("div",{style:{fontSize:18,marginBottom:2},children:""}),o.jsx("div",{style:{fontWeight:700,color:"#4ade80",fontSize:11},children:"Bahasa Malaysia (.xlsx)"})]})]}),o.jsx("div",{style:{fontSize:9,color:"#86efac",marginTop:6,textAlign:"center"},children:" Best for editing   Proper formatting   Works in Excel/Google Sheets"})]}),o.jsxs("div",{style:{marginBottom:14},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#34d399",marginBottom:8},children:" HTML (Browser View)"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[o.jsx("button",{onClick:()=>Vl("EN"),style:{padding:10,background:"rgba(52,211,153,0.1)",border:"1px solid rgba(52,211,153,0.3)",borderRadius:10,cursor:"pointer"},children:o.jsx("div",{style:{fontWeight:600,color:"#34d399",fontSize:10},children:" English (.html)"})}),o.jsx("button",{onClick:()=>Vl("BM"),style:{padding:10,background:"rgba(52,211,153,0.1)",border:"1px solid rgba(52,211,153,0.3)",borderRadius:10,cursor:"pointer"},children:o.jsx("div",{style:{fontWeight:600,color:"#34d399",fontSize:10},children:" Bahasa Malaysia (.html)"})})]})]}),o.jsxs("div",{style:{marginBottom:14,background:"rgba(139,92,246,0.1)",borderRadius:10,padding:12,border:"1px solid rgba(139,92,246,0.3)"},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#c084fc",marginBottom:8},children:" Management Pack (V8 New!)"}),o.jsx("div",{style:{fontSize:9,color:"#a5b4fc",marginBottom:8},children:"Dashboard  KPIs  P&L  Ratios  AR/AP Ageing  Insights & Recommendations"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10,marginBottom:8},children:[o.jsx("button",{type:"button",onClick:()=>{if(console.log("MgmtPack PDF EN clicked"),!m){alert("Please generate financial statements first.");return}try{const u=fs({lang:"EN"});if(!u){alert("Error building Management Pack.");return}const v=ji(u);Ue(v),He("pdf"),he(!1),ke(b=>[...b,{t:"ok",m:' Management Pack PDF ready (EN). Click "Print to PDF".'}])}catch(u){console.error(u),alert("Error: "+u.message)}},style:{padding:10,background:"rgba(139,92,246,0.2)",border:"2px solid rgba(139,92,246,0.5)",borderRadius:8,cursor:"pointer"},children:o.jsx("div",{style:{fontWeight:700,color:"#c084fc",fontSize:10},children:" PDF English"})}),o.jsx("button",{type:"button",onClick:()=>{if(console.log("MgmtPack PDF BM clicked"),!m){alert("Please generate financial statements first.");return}try{const u=fs({lang:"BM"});if(!u){alert("Error building Management Pack.");return}const v=ji(u);Ue(v),He("pdf"),he(!1),ke(b=>[...b,{t:"ok",m:' Management Pack PDF ready (BM). Click "Print to PDF".'}])}catch(u){console.error(u),alert("Error: "+u.message)}},style:{padding:10,background:"rgba(139,92,246,0.2)",border:"2px solid rgba(139,92,246,0.5)",borderRadius:8,cursor:"pointer"},children:o.jsx("div",{style:{fontWeight:700,color:"#c084fc",fontSize:10},children:" PDF Bahasa Malaysia"})})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10,marginBottom:8},children:[o.jsx("button",{type:"button",onClick:()=>{if(console.log("MgmtPack PPT EN clicked"),!m){alert("Please generate financial statements first.");return}try{const u=fs({lang:"EN"});if(!u){alert("Error building Management Pack.");return}const{meta:v,is:b,bs:S,ratios:T,arAgeing:Q,apAgeing:j}=u,{fmtNum:C,fmtPct:M,fmtK:X}=u.helpers,ye=`<!DOCTYPE html>
<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:p="urn:schemas-microsoft-com:office:powerpoint">
<head>
<meta charset="UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<xml>
  <o:DocumentProperties>
    <o:Author>FS Automation V8</o:Author>
    <o:Title>${v.companyName} - Management Report</o:Title>
  </o:DocumentProperties>
</xml>
<style>
  body { font-family: Arial, sans-serif; margin: 40px; }
  .slide { page-break-after: always; min-height: 500px; padding: 30px; border: 1px solid #ccc; margin-bottom: 20px; }
  .slide:last-child { page-break-after: avoid; }
  h1 { color: #1e3a8a; font-size: 28pt; text-align: center; margin-top: 150px; }
  h2 { color: #3b82f6; font-size: 20pt; text-align: center; }
  h3 { color: #1e3a8a; font-size: 18pt; border-bottom: 2px solid #3b82f6; padding-bottom: 5px; }
  .subtitle { color: #64748b; font-size: 14pt; text-align: center; }
  table { border-collapse: collapse; width: 80%; margin: 20px auto; }
  th, td { border: 1px solid #e5e7eb; padding: 10px 15px; text-align: left; }
  th { background: #f1f5f9; color: #1e3a8a; }
  .right { text-align: right; }
  .highlight { background: #dbeafe; }
</style>
</head>
<body>
<!-- Slide 1: Title -->
<div class="slide">
  <h1>${v.companyName}</h1>
  <h2>Management Report</h2>
  <p class="subtitle">Financial Year ${v.year}</p>
  <p class="subtitle">Generated: ${v.generated}</p>
</div>

<!-- Slide 2: KPIs -->
<div class="slide">
  <h3>Key Performance Indicators</h3>
  <table>
    <tr><th>Metric</th><th class="right">Value</th></tr>
    <tr><td>Revenue</td><td class="right">RM ${X(b.rev)}</td></tr>
    <tr class="highlight"><td>Gross Profit</td><td class="right">RM ${X(b.gp)} (${M(T.gpMargin)})</td></tr>
    <tr><td>Net Profit</td><td class="right">RM ${X(b.np)} (${M(T.npMargin)})</td></tr>
    <tr class="highlight"><td>Cash Balance</td><td class="right">RM ${X(S.cash)}</td></tr>
    <tr><td>Current Ratio</td><td class="right">${T.currentRatio.toFixed(2)}</td></tr>
    <tr class="highlight"><td>Debt to Equity</td><td class="right">${T.debtToEquity.toFixed(2)}</td></tr>
  </table>
</div>

<!-- Slide 3: P&L -->
<div class="slide">
  <h3>Profit & Loss Summary</h3>
  <table>
    <tr><th>Item</th><th class="right">Amount (RM)</th><th class="right">%</th></tr>
    <tr><td>Revenue</td><td class="right">${C(b.rev)}</td><td class="right">100%</td></tr>
    <tr><td>Cost of Sales</td><td class="right">(${C(b.cos)})</td><td class="right">${M(b.rev>0?b.cos/b.rev*100:0)}</td></tr>
    <tr class="highlight"><td><strong>Gross Profit</strong></td><td class="right"><strong>${C(b.gp)}</strong></td><td class="right"><strong>${M(T.gpMargin)}</strong></td></tr>
    <tr><td>Operating Expenses</td><td class="right">(${C(b.adm)})</td><td class="right">${M(b.rev>0?b.adm/b.rev*100:0)}</td></tr>
    <tr class="highlight"><td><strong>Net Profit</strong></td><td class="right"><strong>${C(b.np)}</strong></td><td class="right"><strong>${M(T.npMargin)}</strong></td></tr>
  </table>
</div>

<!-- Slide 4: Financial Ratios -->
<div class="slide">
  <h3>Financial Ratios</h3>
  <table>
    <tr><th>Ratio</th><th class="right">Value</th><th>Status</th></tr>
    <tr><td>Current Ratio</td><td class="right">${T.currentRatio.toFixed(2)}</td><td>${T.currentRatio>=1?" Good":" Low"}</td></tr>
    <tr><td>Quick Ratio</td><td class="right">${T.quickRatio.toFixed(2)}</td><td>${T.quickRatio>=1?" Good":" Low"}</td></tr>
    <tr><td>Debt to Equity</td><td class="right">${T.debtToEquity.toFixed(2)}</td><td>${T.debtToEquity<=1?" Good":" High"}</td></tr>
    <tr><td>Return on Equity</td><td class="right">${M(T.roe)}</td><td>${T.roe>=10?" Good":" Low"}</td></tr>
    <tr><td>Working Capital</td><td class="right">RM ${C(T.workingCapital)}</td><td>${T.workingCapital>=0?" Positive":" Negative"}</td></tr>
  </table>
</div>

<!-- Slide 5: AR/AP Ageing -->
<div class="slide">
  <h3>Receivables & Payables Ageing</h3>
  <table>
    <tr><th>Ageing</th><th class="right">Receivables (RM)</th><th class="right">Payables (RM)</th></tr>
    <tr><td>Current</td><td class="right">${C(Q.current)}</td><td class="right">${C(j.current)}</td></tr>
    <tr><td>1-30 days</td><td class="right">${C(Q.d30)}</td><td class="right">${C(j.d30)}</td></tr>
    <tr><td>31-60 days</td><td class="right">${C(Q.d60)}</td><td class="right">${C(j.d60)}</td></tr>
    <tr><td>61-90 days</td><td class="right">${C(Q.d90)}</td><td class="right">${C(j.d90)}</td></tr>
    <tr class="highlight"><td><strong>> 90 days</strong></td><td class="right"><strong>${C(Q.over90)}</strong></td><td class="right"><strong>${C(j.over90)}</strong></td></tr>
    <tr><td><strong>Total</strong></td><td class="right"><strong>${C(Q.total)}</strong></td><td class="right"><strong>${C(j.total)}</strong></td></tr>
  </table>
</div>
</body>
</html>`,Fe=new Blob([ye],{type:"application/vnd.ms-powerpoint;charset=utf-8"});an(Fe,`${(v.companyName||"Company").replace(/[^a-zA-Z0-9]/g,"_")}_MgmtPack_${v.year}_EN.ppt`),ke(Ce=>[...Ce,{t:"ok",m:" Management Pack PPT downloaded (EN)"}]),he(!1)}catch(u){console.error("PPT error:",u),alert("Error generating PowerPoint: "+u.message)}},style:{padding:10,background:"rgba(249,115,22,0.15)",border:"2px solid rgba(249,115,22,0.4)",borderRadius:8,cursor:"pointer"},children:o.jsx("div",{style:{fontWeight:700,color:"#fb923c",fontSize:10},children:" PowerPoint EN"})}),o.jsx("button",{type:"button",onClick:()=>{if(console.log("MgmtPack PPT BM clicked"),!m){alert("Please generate financial statements first.");return}try{const u=fs({lang:"BM"});if(!u){alert("Error building Management Pack.");return}const{meta:v,is:b,bs:S,ratios:T,arAgeing:Q,apAgeing:j}=u,{fmtNum:C,fmtPct:M,fmtK:X}=u.helpers,ye=`<!DOCTYPE html>
<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:p="urn:schemas-microsoft-com:office:powerpoint">
<head>
<meta charset="UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<xml>
  <o:DocumentProperties>
    <o:Author>FS Automation V8</o:Author>
    <o:Title>${v.companyName} - Laporan Pengurusan</o:Title>
  </o:DocumentProperties>
</xml>
<style>
  body { font-family: Arial, sans-serif; margin: 40px; }
  .slide { page-break-after: always; min-height: 500px; padding: 30px; border: 1px solid #ccc; margin-bottom: 20px; }
  .slide:last-child { page-break-after: avoid; }
  h1 { color: #1e3a8a; font-size: 28pt; text-align: center; margin-top: 150px; }
  h2 { color: #3b82f6; font-size: 20pt; text-align: center; }
  h3 { color: #1e3a8a; font-size: 18pt; border-bottom: 2px solid #3b82f6; padding-bottom: 5px; }
  .subtitle { color: #64748b; font-size: 14pt; text-align: center; }
  table { border-collapse: collapse; width: 80%; margin: 20px auto; }
  th, td { border: 1px solid #e5e7eb; padding: 10px 15px; text-align: left; }
  th { background: #f1f5f9; color: #1e3a8a; }
  .right { text-align: right; }
  .highlight { background: #dbeafe; }
</style>
</head>
<body>
<!-- Slide 1: Title -->
<div class="slide">
  <h1>${v.companyName}</h1>
  <h2>Laporan Pengurusan</h2>
  <p class="subtitle">Tahun Kewangan ${v.year}</p>
  <p class="subtitle">Dijana: ${v.generated}</p>
</div>

<!-- Slide 2: KPIs -->
<div class="slide">
  <h3>Petunjuk Prestasi Utama</h3>
  <table>
    <tr><th>Metrik</th><th class="right">Nilai</th></tr>
    <tr><td>Hasil</td><td class="right">RM ${X(b.rev)}</td></tr>
    <tr class="highlight"><td>Untung Kasar</td><td class="right">RM ${X(b.gp)} (${M(T.gpMargin)})</td></tr>
    <tr><td>Untung Bersih</td><td class="right">RM ${X(b.np)} (${M(T.npMargin)})</td></tr>
    <tr class="highlight"><td>Baki Tunai</td><td class="right">RM ${X(S.cash)}</td></tr>
    <tr><td>Nisbah Semasa</td><td class="right">${T.currentRatio.toFixed(2)}</td></tr>
    <tr class="highlight"><td>Hutang kepada Ekuiti</td><td class="right">${T.debtToEquity.toFixed(2)}</td></tr>
  </table>
</div>

<!-- Slide 3: P&L -->
<div class="slide">
  <h3>Ringkasan Untung Rugi</h3>
  <table>
    <tr><th>Perkara</th><th class="right">Jumlah (RM)</th><th class="right">%</th></tr>
    <tr><td>Hasil</td><td class="right">${C(b.rev)}</td><td class="right">100%</td></tr>
    <tr><td>Kos Jualan</td><td class="right">(${C(b.cos)})</td><td class="right">${M(b.rev>0?b.cos/b.rev*100:0)}</td></tr>
    <tr class="highlight"><td><strong>Untung Kasar</strong></td><td class="right"><strong>${C(b.gp)}</strong></td><td class="right"><strong>${M(T.gpMargin)}</strong></td></tr>
    <tr><td>Perbelanjaan Operasi</td><td class="right">(${C(b.adm)})</td><td class="right">${M(b.rev>0?b.adm/b.rev*100:0)}</td></tr>
    <tr class="highlight"><td><strong>Untung Bersih</strong></td><td class="right"><strong>${C(b.np)}</strong></td><td class="right"><strong>${M(T.npMargin)}</strong></td></tr>
  </table>
</div>

<!-- Slide 4: Financial Ratios -->
<div class="slide">
  <h3>Nisbah Kewangan</h3>
  <table>
    <tr><th>Nisbah</th><th class="right">Nilai</th><th>Status</th></tr>
    <tr><td>Nisbah Semasa</td><td class="right">${T.currentRatio.toFixed(2)}</td><td>${T.currentRatio>=1?" Baik":" Rendah"}</td></tr>
    <tr><td>Nisbah Cepat</td><td class="right">${T.quickRatio.toFixed(2)}</td><td>${T.quickRatio>=1?" Baik":" Rendah"}</td></tr>
    <tr><td>Hutang kepada Ekuiti</td><td class="right">${T.debtToEquity.toFixed(2)}</td><td>${T.debtToEquity<=1?" Baik":" Tinggi"}</td></tr>
    <tr><td>Pulangan atas Ekuiti</td><td class="right">${M(T.roe)}</td><td>${T.roe>=10?" Baik":" Rendah"}</td></tr>
    <tr><td>Modal Kerja</td><td class="right">RM ${C(T.workingCapital)}</td><td>${T.workingCapital>=0?" Positif":" Negatif"}</td></tr>
  </table>
</div>

<!-- Slide 5: AR/AP Ageing -->
<div class="slide">
  <h3>Pengumuran Penghutang & Pemiutang</h3>
  <table>
    <tr><th>Umur</th><th class="right">Penghutang (RM)</th><th class="right">Pemiutang (RM)</th></tr>
    <tr><td>Semasa</td><td class="right">${C(Q.current)}</td><td class="right">${C(j.current)}</td></tr>
    <tr><td>1-30 hari</td><td class="right">${C(Q.d30)}</td><td class="right">${C(j.d30)}</td></tr>
    <tr><td>31-60 hari</td><td class="right">${C(Q.d60)}</td><td class="right">${C(j.d60)}</td></tr>
    <tr><td>61-90 hari</td><td class="right">${C(Q.d90)}</td><td class="right">${C(j.d90)}</td></tr>
    <tr class="highlight"><td><strong>> 90 hari</strong></td><td class="right"><strong>${C(Q.over90)}</strong></td><td class="right"><strong>${C(j.over90)}</strong></td></tr>
    <tr><td><strong>Jumlah</strong></td><td class="right"><strong>${C(Q.total)}</strong></td><td class="right"><strong>${C(j.total)}</strong></td></tr>
  </table>
</div>
</body>
</html>`,Fe=new Blob([ye],{type:"application/vnd.ms-powerpoint;charset=utf-8"});an(Fe,`${(v.companyName||"Company").replace(/[^a-zA-Z0-9]/g,"_")}_MgmtPack_${v.year}_BM.ppt`),ke(Ce=>[...Ce,{t:"ok",m:" Management Pack PPT downloaded (BM)"}]),he(!1)}catch(u){console.error("PPT error:",u),alert("Error generating PowerPoint: "+u.message)}},style:{padding:10,background:"rgba(249,115,22,0.15)",border:"2px solid rgba(249,115,22,0.4)",borderRadius:8,cursor:"pointer"},children:o.jsx("div",{style:{fontWeight:700,color:"#fb923c",fontSize:10},children:" PowerPoint BM"})})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[o.jsx("button",{type:"button",onClick:()=>{if(console.log("MgmtPack HTML EN clicked"),!m){alert("Please generate financial statements first.");return}try{const u=fs({lang:"EN"});if(!u){alert("Error building Management Pack.");return}const v=ji(u),b=new Blob([v],{type:"text/html;charset=utf-8"});an(b,`${(s||"Company").replace(/[^a-zA-Z0-9]/g,"_")}_MgmtPack_${L}_EN.html`),ke(S=>[...S,{t:"ok",m:" Management Pack downloaded (EN)"}])}catch(u){console.error(u),alert("Error: "+u.message)}he(!1)},style:{padding:6,background:"rgba(139,92,246,0.08)",border:"1px solid rgba(139,92,246,0.2)",borderRadius:6,cursor:"pointer"},children:o.jsx("div",{style:{fontWeight:500,color:"#a78bfa",fontSize:8},children:"HTML English"})}),o.jsx("button",{type:"button",onClick:()=>{if(console.log("MgmtPack HTML BM clicked"),!m){alert("Please generate financial statements first.");return}try{const u=fs({lang:"BM"});if(!u){alert("Error building Management Pack.");return}const v=ji(u),b=new Blob([v],{type:"text/html;charset=utf-8"});an(b,`${(s||"Company").replace(/[^a-zA-Z0-9]/g,"_")}_MgmtPack_${L}_BM.html`),ke(S=>[...S,{t:"ok",m:" Management Pack downloaded (BM)"}])}catch(u){console.error(u),alert("Error: "+u.message)}he(!1)},style:{padding:6,background:"rgba(139,92,246,0.08)",border:"1px solid rgba(139,92,246,0.2)",borderRadius:6,cursor:"pointer"},children:o.jsx("div",{style:{fontWeight:500,color:"#a78bfa",fontSize:8},children:"HTML Bahasa Malaysia"})})]})]}),o.jsxs("div",{style:{padding:8,background:"rgba(99,102,241,0.1)",borderRadius:8},children:[o.jsxs("div",{style:{fontSize:9,color:"#a5b4fc"},children:[o.jsx("strong",{children:" Full FS Includes:"})," Cover Page  Balance Sheet  Income Statement  Notes"]}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280",marginTop:4},children:["FS Automation ",mi,"  Lines only on amount columns"]})]})]})}),Oe&&o.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.95)",display:"flex",flexDirection:"column",zIndex:100},children:[o.jsxs("div",{style:{padding:16,background:"#1f2937",borderBottom:"1px solid rgba(75,85,99,0.3)",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:10},children:[o.jsxs("div",{children:[o.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:700},children:Ie==="pdf"?" Financial Statements":Ie==="html"?" HTML Preview":" Session Data"}),o.jsx("p",{style:{margin:"4px 0 0 0",fontSize:11,color:"#9ca3af"},children:Ie==="pdf"?'Click "Print to PDF" or press Ctrl+P, then select "Save as PDF" as printer.':Ie==="html"?"Preview of generated content.":"Copy and save as .json file to restore later."})]}),o.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[(Ie==="pdf"||Ie==="html")&&o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>{alert(`To save as PDF:

1. Press Ctrl+P (Windows) or Cmd+P (Mac) NOW
2. In the print dialog, select "Save as PDF" as printer
3. Click Save

Alternatively, use "Download HTML" button, open the file in your browser, then print.`)},style:{padding:"8px 16px",background:"linear-gradient(135deg, #ef4444, #dc2626)",border:"none",borderRadius:6,color:"#fff",fontSize:12,fontWeight:600,cursor:"pointer"},children:" Print to PDF (Ctrl+P)"}),o.jsx("button",{onClick:()=>{const u=`${(s||"FS").replace(/[^a-zA-Z0-9]/g,"_")}_${L}.html`,v=new Blob([Oe],{type:"text/html;charset=utf-8"});an(v,u),ke(b=>[...b,{t:"ok",m:` Downloaded ${u}`}])},style:{padding:"8px 16px",background:"linear-gradient(135deg, #059669, #10b981)",border:"none",borderRadius:6,color:"#fff",fontSize:12,fontWeight:600,cursor:"pointer"},children:" Download HTML"})]}),o.jsx("button",{onClick:()=>{try{navigator.clipboard.writeText(Oe),alert(`Copied to clipboard!

To save as PDF:
1. Paste into text editor
2. Save as .html file
3. Open in browser
4. Ctrl+P  Save as PDF`)}catch{alert("Copy failed. Please select all text manually.")}},style:{padding:"8px 16px",background:"linear-gradient(135deg, #6366f1, #4f46e5)",border:"none",borderRadius:6,color:"#fff",fontSize:12,fontWeight:600,cursor:"pointer"},children:" Copy HTML"}),o.jsx("button",{onClick:()=>{Ue(null),He(null)},style:{padding:"8px 16px",background:"rgba(239,68,68,0.2)",border:"1px solid rgba(239,68,68,0.3)",borderRadius:6,color:"#fca5a5",fontSize:12,fontWeight:600,cursor:"pointer"},children:" Close"})]})]}),Ie==="html"||Ie==="pdf"?o.jsx("div",{style:{flex:1,overflow:"hidden",background:"#fff"},children:o.jsx("iframe",{id:"fs-preview-iframe",srcDoc:Oe,style:{width:"100%",height:"100%",border:"none"},title:"Financial Statements Preview"})}):o.jsx("div",{style:{flex:1,overflow:"auto",padding:16},children:o.jsx("pre",{style:{background:"rgba(17,24,39,0.8)",padding:16,borderRadius:8,fontSize:10,color:"#a5b4fc",whiteSpace:"pre-wrap",wordBreak:"break-all",maxHeight:"100%",overflow:"auto"},children:Oe})})]}),o.jsx("header",{style:{background:"rgba(17,24,39,0.95)",borderBottom:"1px solid rgba(75,85,99,0.3)",padding:"12px 20px",position:"sticky",top:0,zIndex:50},children:o.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:10},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[o.jsx("div",{style:{width:36,height:36,background:"linear-gradient(135deg, #6366f1, #8b5cf6)",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center",fontSize:16,fontWeight:800,color:"#fff"},children:"FS"}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:15,fontWeight:700},children:s||"Financial Statements Automation"}),o.jsxs("div",{style:{fontSize:10,color:"#9ca3af"},children:[s&&Lt?`FYE ${Lt}  `:"",sa?`${sa.name}  ${sa.standard}`:"Select company type to begin"]})]})]}),o.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[t&&s&&o.jsxs("span",{style:{fontSize:10,background:"rgba(52,211,153,0.15)",color:"#34d399",padding:"4px 10px",borderRadius:4},children:["FY",L]}),o.jsx("button",{onClick:()=>N0.current?.click(),style:{padding:"6px 12px",background:"rgba(139,92,246,0.15)",border:"1px solid rgba(139,92,246,0.3)",borderRadius:6,color:"#c4b5fd",fontSize:11,fontWeight:600,cursor:"pointer"},title:"Load a previously saved session",children:" Load"}),(s||_.length>0)&&o.jsx("button",{onClick:Jo,style:{padding:"6px 12px",background:"rgba(59,130,246,0.15)",border:"1px solid rgba(59,130,246,0.3)",borderRadius:6,color:"#93c5fd",fontSize:11,fontWeight:600,cursor:"pointer"},title:"Save current session to file",children:" Save"}),o.jsx("button",{onClick:hf,style:{padding:"6px 12px",background:"rgba(99,102,241,0.15)",border:"1px solid rgba(99,102,241,0.3)",borderRadius:6,color:"#a5b4fc",fontSize:11,fontWeight:600,cursor:"pointer"},children:"Sample"}),_.length>0&&o.jsx("button",{onClick:Qo,style:{padding:"6px 12px",background:"rgba(239,68,68,0.15)",border:"1px solid rgba(239,68,68,0.3)",borderRadius:6,color:"#fca5a5",fontSize:11,fontWeight:600,cursor:"pointer"},children:"Clear"}),m&&o.jsx("button",{onClick:Go,style:{padding:"6px 12px",background:"linear-gradient(135deg, #10b981, #059669)",border:"none",borderRadius:6,color:"#fff",fontSize:11,fontWeight:600,cursor:"pointer"},children:"Export"})]})]})}),o.jsx("nav",{style:{background:"rgba(31,41,55,0.5)",borderBottom:"1px solid rgba(75,85,99,0.2)",padding:"0 20px",overflowX:"auto"},children:o.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",display:"flex"},children:[o.jsx("button",{style:Na("setup"),onClick:()=>a("setup"),children:" Setup"}),o.jsx("button",{style:{...Na("priorfs"),opacity:t?1:.4},onClick:()=>t&&a("priorfs"),children:" Prior FS"}),o.jsx("button",{style:{...Na("banks"),opacity:t?1:.4},onClick:()=>t&&a("banks"),children:" Banks"}),o.jsx("button",{style:{...Na("upload"),opacity:t?1:.4},onClick:()=>t&&a("upload"),children:" Upload"}),o.jsxs("button",{style:{...Na("review"),opacity:t?1:.4},onClick:()=>t&&a("review"),children:[" Review (",_.length,")"]}),o.jsx("button",{style:{...Na("classify"),opacity:_.length>0?1:.4},onClick:()=>_.length>0&&a("classify"),children:" Classify"}),o.jsxs("button",{style:{...Na("cashvoucher"),opacity:t?1:.4},onClick:()=>t&&a("cashvoucher"),children:[" Cash (",N.length,")"]}),o.jsx("button",{style:{...Na("subledger"),opacity:t?1:.4},onClick:()=>t&&a("subledger"),children:" Subledger"}),o.jsx("button",{style:{...Na("balances"),opacity:t?1:.4},onClick:()=>t&&a("balances"),children:" Opening"}),o.jsx("button",{style:{...Na("journal"),opacity:m?1:.4},onClick:()=>m&&a("journal"),children:" JE"}),o.jsx("button",{style:{...Na("trial"),opacity:m?1:.4},onClick:()=>m&&a("trial"),children:" TB"}),o.jsx("button",{style:{...Na("income"),opacity:m?1:.4},onClick:()=>m&&a("income"),children:" P&L"}),o.jsx("button",{style:{...Na("balance"),opacity:m?1:.4},onClick:()=>m&&a("balance"),children:" BS"}),o.jsx("button",{style:{...Na("cashflow"),opacity:m?1:.4},onClick:()=>m&&a("cashflow"),children:" CF"}),o.jsx("button",{style:{...Na("tax"),opacity:m?1:.4},onClick:()=>m&&a("tax"),children:" Tax"}),o.jsxs("button",{style:{...Na("snapshots"),opacity:t?1:.4},onClick:()=>t&&a("snapshots"),children:[" Snaps (",gt.length,")"]}),o.jsx("button",{style:{...Na("dashboard"),opacity:m?1:.4},onClick:()=>m&&a("dashboard"),children:" Dashboard"})]})}),o.jsxs("main",{style:{maxWidth:1200,margin:"0 auto",padding:"20px"},children:[e==="setup"&&o.jsx("div",{style:{maxWidth:700,margin:"0 auto"},children:o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:12,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(99,102,241,0.1), rgba(139,92,246,0.1))"},children:[o.jsx("div",{style:{fontWeight:700,fontSize:16},children:" Company Setup"}),o.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginTop:4},children:"Enter your company details and select the applicable accounting standard"})]}),o.jsxs("div",{style:{padding:20},children:[o.jsxs("div",{style:{marginBottom:24},children:[o.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:12,color:"#a5b4fc"},children:"Company Details:"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Company Name *"}),o.jsx("input",{value:s,onChange:u=>c(u.target.value),placeholder:"e.g. ABC Trading Sdn Bhd",style:{...ft,width:"100%",padding:"10px 12px"}})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Registration No."}),o.jsx("input",{value:f,onChange:u=>p(u.target.value),placeholder:"e.g. 202301012345 (12345-X)",style:{...ft,width:"100%",padding:"10px 12px"}})]})]})]}),o.jsxs("div",{style:{marginBottom:24},children:[o.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:12,color:"#a5b4fc"},children:"Financial Year:"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12},children:[o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Year End Month"}),o.jsxs("select",{value:g,onChange:u=>h(u.target.value),style:{...ft,width:"100%",padding:"10px 12px",cursor:"pointer"},children:[o.jsx("option",{value:"1",children:"January"}),o.jsx("option",{value:"2",children:"February"}),o.jsx("option",{value:"3",children:"March"}),o.jsx("option",{value:"4",children:"April"}),o.jsx("option",{value:"5",children:"May"}),o.jsx("option",{value:"6",children:"June"}),o.jsx("option",{value:"7",children:"July"}),o.jsx("option",{value:"8",children:"August"}),o.jsx("option",{value:"9",children:"September"}),o.jsx("option",{value:"10",children:"October"}),o.jsx("option",{value:"11",children:"November"}),o.jsx("option",{value:"12",children:"December"})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Current FY Year"}),o.jsx("input",{type:"number",value:L,onChange:u=>{K(parseInt(u.target.value)||new Date().getFullYear()),Je((parseInt(u.target.value)||new Date().getFullYear())-1)},style:{...ft,width:"100%",padding:"10px 12px"}})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Prior FY Year"}),o.jsx("input",{type:"number",value:fe,onChange:u=>Je(parseInt(u.target.value)||new Date().getFullYear()-1),style:{...ft,width:"100%",padding:"10px 12px"}})]})]}),s&&g&&o.jsxs("div",{style:{marginTop:12,padding:10,background:"rgba(52,211,153,0.1)",borderRadius:6,fontSize:11,color:"#34d399"},children:[" Financial Year End: ",o.jsx("strong",{children:Lt})," (FY",L,")"]})]}),o.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:16,color:"#a5b4fc"},children:"Select Company Type:"}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:Object.entries($m).map(([u,v])=>o.jsx("div",{onClick:()=>{i(u),A(ia(u))},style:{padding:16,background:t===u?"rgba(99,102,241,0.2)":"rgba(17,24,39,0.4)",border:t===u?"2px solid #6366f1":"1px solid rgba(75,85,99,0.3)",borderRadius:10,cursor:"pointer",transition:"all 0.2s"},children:o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:700,fontSize:14,marginBottom:4,color:t===u?"#a5b4fc":"#e5e7eb"},children:v.name}),o.jsxs("div",{style:{fontSize:11,color:"#9ca3af",marginBottom:6},children:["Default: ",v.fullStandard]}),o.jsxs("div",{style:{display:"flex",gap:12},children:[o.jsx("span",{style:{fontSize:10,background:"rgba(52,211,153,0.2)",color:"#34d399",padding:"2px 8px",borderRadius:4},children:v.standard}),o.jsx("span",{style:{fontSize:10,background:"rgba(251,191,36,0.2)",color:"#fbbf24",padding:"2px 8px",borderRadius:4},children:v.taxInfo})]})]}),t===u&&o.jsx("div",{style:{width:24,height:24,background:"#6366f1",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:14},children:""})]})},u))}),t&&o.jsxs("div",{style:{marginTop:24},children:[o.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:12,color:"#a5b4fc"},children:"Select Accounting Standard:"}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:10},children:Object.entries(Zr).map(([u,v])=>o.jsxs("div",{onClick:()=>A(u),style:{padding:12,background:E===u?"rgba(52,211,153,0.2)":"rgba(17,24,39,0.4)",border:E===u?"2px solid #34d399":"1px solid rgba(75,85,99,0.3)",borderRadius:8,cursor:"pointer",transition:"all 0.2s",textAlign:"center"},children:[o.jsx("div",{style:{fontWeight:700,fontSize:12,color:E===u?"#34d399":"#e5e7eb"},children:v.name}),o.jsx("div",{style:{fontSize:9,color:"#6b7280",marginTop:4},children:v.desc})]},u))}),o.jsxs("div",{style:{marginTop:12,padding:10,background:"rgba(99,102,241,0.1)",borderRadius:6},children:[o.jsxs("div",{style:{fontSize:10,color:"#a5b4fc"},children:[o.jsx("strong",{children:"Selected:"})," ",Zr[E]?.fullName||"None"]}),o.jsxs("div",{style:{fontSize:9,color:"#6b7280",marginTop:4},children:[E==="MFRS"&&"Full IFRS-equivalent. Required for public listed companies.",E==="MPERS"&&"Simplified IFRS for SMEs. Suitable for most Sdn Bhd companies.",E==="MPERS-Micro"&&"Most simplified. For micro entities with revenue < RM3m."]})]})]}),t&&s&&o.jsx("button",{onClick:()=>a("priorfs"),style:{...ja,width:"100%",marginTop:20,padding:"14px",fontSize:14,justifyContent:"center"},children:"Continue to Prior Year FS "}),t&&!s&&o.jsx("div",{style:{marginTop:16,padding:10,background:"rgba(251,191,36,0.1)",borderRadius:6,fontSize:11,color:"#fbbf24",textAlign:"center"},children:" Please enter your company name to continue"})]})]})}),e==="banks"&&o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("button",{onClick:or,style:lr,children:" Prior FS"}),o.jsx("span",{style:{fontWeight:700,fontSize:14},children:" Bank Accounts"})]}),o.jsx("button",{onClick:_r,style:ja,children:"Next: Upload "})]}),o.jsxs("div",{style:{padding:16},children:[o.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[o.jsx("input",{placeholder:"Bank Name (e.g. Maybank)",value:kn.name,onChange:u=>is(v=>({...v,name:u.target.value})),style:{...ft,flex:1}}),o.jsx("input",{placeholder:"Account No",value:kn.accNo,onChange:u=>is(v=>({...v,accNo:u.target.value})),style:{...ft,width:120}}),o.jsx("button",{onClick:df,style:{padding:"8px 16px",background:"linear-gradient(135deg, #6366f1, #4f46e5)",border:"none",borderRadius:6,color:"#fff",fontWeight:700,cursor:"pointer"},children:"+"})]}),Ut.length===0?o.jsxs("div",{style:{padding:24,textAlign:"center",color:"#6b7280"},children:[o.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),o.jsx("div",{style:{fontSize:13},children:"Add your bank accounts first"}),o.jsx("div",{style:{fontSize:11,marginTop:4},children:"Each bank will have 12 months of statements"})]}):o.jsx("div",{children:Ut.map((u,v)=>{const b=wn[u.id]||{},S=ni.filter(T=>b[T]?.uploaded).length;return o.jsxs("div",{style:{padding:12,background:v%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:6,marginBottom:8},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:600},children:u.name}),o.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:u.accNo})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsxs("span",{style:{fontSize:11,color:S===12?"#34d399":"#fbbf24"},children:[S,"/12 months"]}),o.jsx("div",{style:{width:60,height:6,background:"rgba(75,85,99,0.3)",borderRadius:3},children:o.jsx("div",{style:{width:`${S/12*100}%`,height:"100%",background:S===12?"#34d399":"#6366f1",borderRadius:3}})})]})]}),o.jsx("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:ni.map(T=>o.jsx("div",{style:{padding:"2px 6px",borderRadius:4,fontSize:9,fontWeight:600,background:b[T]?.uploaded?"rgba(52,211,153,0.2)":"rgba(75,85,99,0.2)",color:b[T]?.uploaded?"#34d399":"#6b7280"},children:T},T))})]},u.id)})})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",fontWeight:700,fontSize:14},children:" Upload Progress"}),o.jsx("div",{style:{padding:16},children:Ut.length===0?o.jsx("div",{style:{padding:24,textAlign:"center",color:"#6b7280",fontSize:13},children:"Add bank accounts to start"}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{textAlign:"center",marginBottom:20},children:[o.jsxs("div",{style:{fontSize:48,fontWeight:700,color:Oi.percent===100?"#34d399":"#a5b4fc"},children:[Oi.percent,"%"]}),o.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[Oi.uploaded," of ",Oi.total," statements uploaded"]})]}),o.jsx("div",{style:{marginBottom:16},children:o.jsx("div",{style:{height:8,background:"rgba(75,85,99,0.3)",borderRadius:4},children:o.jsx("div",{style:{width:`${Oi.percent}%`,height:"100%",background:"linear-gradient(90deg, #6366f1, #8b5cf6)",borderRadius:4,transition:"width 0.3s"}})})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[o.jsxs("div",{style:{padding:12,background:"rgba(17,24,39,0.4)",borderRadius:6,textAlign:"center"},children:[o.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#a5b4fc"},children:Ut.length}),o.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"Bank Accounts"})]}),o.jsxs("div",{style:{padding:12,background:"rgba(17,24,39,0.4)",borderRadius:6,textAlign:"center"},children:[o.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#34d399"},children:_.length}),o.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"Transactions"})]})]}),Ut.length>0&&o.jsx("button",{onClick:()=>a("upload"),style:{width:"100%",marginTop:16,padding:"12px",background:"linear-gradient(135deg, #8b5cf6, #7c3aed)",border:"none",borderRadius:8,color:"#fff",fontSize:13,fontWeight:600,cursor:"pointer"},children:"Upload Bank Statements "})]})})]})]}),e==="upload"&&o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("button",{onClick:or,style:lr,children:" Back"}),o.jsx("span",{style:{fontWeight:700,fontSize:14},children:" Upload Bank Statement"})]}),o.jsx("button",{onClick:_r,style:ja,children:"Next "})]}),o.jsx("div",{style:{padding:16},children:Ut.length===0?o.jsxs("div",{style:{padding:24,textAlign:"center",color:"#6b7280"},children:[o.jsx("div",{style:{fontSize:13},children:"Please add bank accounts first"}),o.jsx("button",{onClick:()=>a("banks"),style:{marginTop:12,padding:"8px 16px",background:"rgba(99,102,241,0.15)",border:"1px solid rgba(99,102,241,0.3)",borderRadius:6,color:"#a5b4fc",fontSize:12,cursor:"pointer"},children:"Go to Banks Tab"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginBottom:16},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginBottom:4},children:"Select Bank"}),o.jsxs("select",{value:Yt,onChange:u=>wi(u.target.value),style:{...ft,cursor:"pointer"},children:[o.jsx("option",{value:"",children:"-- Select Bank --"}),Ut.map(u=>o.jsx("option",{value:u.id,children:u.name},u.id))]})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginBottom:4},children:"Select Month"}),o.jsx("select",{value:Ha,onChange:u=>Wr(u.target.value),style:{...ft,cursor:"pointer"},children:ni.map(u=>o.jsxs("option",{value:u,children:[u," ",L]},u))})]})]}),Yt&&(()=>{const u=wn[Yt]?.[Ha],v=Ut.find(b=>b.id===Yt);return u?.uploaded?o.jsx("div",{style:{background:"rgba(52,211,153,0.1)",border:"1px solid rgba(52,211,153,0.3)",borderRadius:8,padding:12,marginBottom:12},children:o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#34d399"},children:[" ",v?.name," - ",Ha]}),o.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginTop:2},children:[u.file,"  ",u.txCount," transactions"]})]}),o.jsx("button",{onClick:()=>Yl(Yt,Ha),style:{padding:"6px 12px",background:"rgba(239,68,68,0.2)",border:"1px solid rgba(239,68,68,0.3)",borderRadius:6,color:"#f87171",fontSize:11,fontWeight:600,cursor:"pointer"},children:" Remove & Re-upload"})]})}):null})(),o.jsxs("div",{style:{border:"2px dashed rgba(99,102,241,0.4)",borderRadius:8,padding:20,textAlign:"center",cursor:Yt?"pointer":"not-allowed",marginBottom:12,opacity:Yt?1:.5},onClick:()=>Yt&&Ze.current?.click(),children:[o.jsx("input",{ref:Ze,type:"file",accept:".csv,.txt,.tsv,.pdf,.xlsx,.xls",multiple:!0,onChange:ff,style:{display:"none"}}),o.jsx("div",{style:{fontSize:28,marginBottom:8},children:""}),o.jsx("div",{style:{fontWeight:600,fontSize:12},children:ue?"Processing...":"Click to upload CSV, Excel, TXT or PDF"}),o.jsx("div",{style:{fontSize:10,color:"#6b7280",marginTop:4},children:"Supports .csv, .xlsx, .xls, .txt, .pdf"})]}),o.jsxs("div",{style:{marginBottom:12},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,marginBottom:6,color:"#fbbf24"},children:" For PDF files - paste extracted text:"}),o.jsx("textarea",{value:ci,onChange:u=>Ys(u.target.value),placeholder:"If your bank only provides PDF statements, open the PDF, select all text (Ctrl+A), copy (Ctrl+C), and paste here...",style:{width:"100%",height:80,background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,padding:8,color:"#e5e7eb",fontSize:11,resize:"vertical"}}),o.jsx("button",{onClick:uf,disabled:!ci.trim()||!Yt,style:{marginTop:6,padding:"6px 14px",background:ci.trim()&&Yt?"linear-gradient(135deg, #f59e0b, #d97706)":"rgba(75,85,99,0.3)",border:"none",borderRadius:6,color:"#fff",fontSize:11,fontWeight:600,cursor:ci.trim()&&Yt?"pointer":"not-allowed"},children:"Parse PDF Text"})]}),tt.length>0&&o.jsx("div",{style:{background:"rgba(17,24,39,0.5)",borderRadius:6,padding:10,maxHeight:120,overflowY:"auto"},children:tt.slice(-10).map((u,v)=>o.jsx("div",{style:{fontSize:10,padding:"2px 0",color:u.t==="ok"?"#34d399":u.t==="err"?"#f87171":u.t==="warn"?"#fbbf24":"#9ca3af"},children:u.m},v))})]})})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",fontWeight:700,fontSize:14},children:" Upload Matrix"}),o.jsxs("div",{style:{padding:16,overflowX:"auto"},children:[Ut.length===0?o.jsx("div",{style:{padding:24,textAlign:"center",color:"#6b7280",fontSize:13},children:"No banks configured"}):o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:10},children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:{padding:6,textAlign:"left",borderBottom:"1px solid rgba(75,85,99,0.3)"},children:"Bank"}),ni.map(u=>o.jsx("th",{style:{padding:4,textAlign:"center",borderBottom:"1px solid rgba(75,85,99,0.3)",fontSize:9},children:u},u))]})}),o.jsx("tbody",{children:Ut.map(u=>o.jsxs("tr",{children:[o.jsx("td",{style:{padding:6,fontWeight:600},children:u.name}),ni.map(v=>{const b=wn[u.id]?.[v];return o.jsxs("td",{style:{padding:4,textAlign:"center"},children:[o.jsx("div",{style:{width:24,height:24,borderRadius:4,margin:"0 auto",background:b?.uploaded?"rgba(52,211,153,0.3)":"rgba(75,85,99,0.2)",display:"flex",alignItems:"center",justifyContent:"center",color:b?.uploaded?"#34d399":"#6b7280",fontSize:9,cursor:"pointer",position:"relative"},onClick:()=>{wi(u.id),Wr(v)},title:b?.uploaded?`${b.file} (${b.txCount} txns) - Click to select`:"Click to select",children:b?.uploaded?b.txCount:""}),b?.uploaded&&o.jsx("button",{onClick:S=>{S.stopPropagation(),Yl(u.id,v)},style:{fontSize:8,padding:"1px 4px",marginTop:2,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:3,color:"#f87171",cursor:"pointer"},title:"Remove transactions for this month",children:""})]},v)})]},u.id))})]}),_.length>0&&o.jsx("button",{onClick:()=>a("review"),style:{width:"100%",marginTop:16,padding:"10px",background:"linear-gradient(135deg, #8b5cf6, #7c3aed)",border:"none",borderRadius:8,color:"#fff",fontSize:12,fontWeight:600,cursor:"pointer"},children:"Next: Review Transactions "})]})]})]}),e==="priorfs"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("button",{onClick:or,style:lr,children:" Setup"}),o.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[o.jsx("span",{style:{fontSize:11,color:"#9ca3af"},children:"Prior Year:"}),o.jsx("input",{type:"number",value:fe,onChange:u=>Je(parseInt(u.target.value)),style:{...ft,width:70,padding:"4px 8px",fontSize:12}}),o.jsx("button",{onClick:_r,style:ja,children:"Next: Bank Setup "})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",marginBottom:16,padding:16},children:[o.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginBottom:12},children:[o.jsx("span",{style:{fontSize:12,fontWeight:600},children:"Input Mode:"}),o.jsx("button",{onClick:()=>Xn("manual"),style:{padding:"6px 16px",background:Rn==="manual"?"rgba(99,102,241,0.3)":"transparent",border:"1px solid rgba(99,102,241,0.3)",borderRadius:6,color:Rn==="manual"?"#a5b4fc":"#6b7280",fontSize:11,cursor:"pointer"},children:"Manual Entry"}),o.jsx("button",{onClick:()=>Xn("upload"),style:{padding:"6px 16px",background:Rn==="upload"?"rgba(99,102,241,0.3)":"transparent",border:"1px solid rgba(99,102,241,0.3)",borderRadius:6,color:Rn==="upload"?"#a5b4fc":"#6b7280",fontSize:11,cursor:"pointer"},children:"Upload Prior FS"})]}),Rn==="upload"&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginBottom:12},children:[o.jsx("input",{type:"file",accept:".csv,.txt,.xlsx,.xls,.pdf",onChange:zo,style:{fontSize:11}}),gr.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs("span",{style:{fontSize:11,color:"#34d399"},children:[" ",gr.length," items found"]}),o.jsx("button",{onClick:Gl,style:{padding:"6px 12px",background:"linear-gradient(135deg, #8b5cf6, #7c3aed)",border:"none",borderRadius:6,color:"#fff",fontSize:11,cursor:"pointer"},children:"Auto-Map"})]})]}),o.jsxs("div",{style:{marginBottom:12,padding:12,background:"rgba(251,191,36,0.05)",border:"1px solid rgba(251,191,36,0.2)",borderRadius:8},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,marginBottom:8,color:"#fbbf24"},children:" For PDF files - paste extracted text here:"}),o.jsx("textarea",{value:D,onChange:u=>W(u.target.value),placeholder:"Open the PDF in any viewer, select all text (Ctrl+A), copy (Ctrl+C), and paste here. The system will extract financial statement line items automatically.",style:{width:"100%",height:100,background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,padding:10,color:"#e5e7eb",fontSize:11,resize:"vertical",fontFamily:"monospace"}}),o.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[o.jsx("button",{onClick:()=>Qs(D),disabled:!D.trim(),style:{padding:"6px 14px",background:D.trim()?"linear-gradient(135deg, #f59e0b, #d97706)":"rgba(75,85,99,0.3)",border:"none",borderRadius:6,color:"#fff",fontSize:11,fontWeight:600,cursor:D.trim()?"pointer":"not-allowed"},children:"Parse PDF Text"}),D&&o.jsx("button",{onClick:()=>W(""),style:{padding:"6px 14px",background:"rgba(239,68,68,0.2)",border:"1px solid rgba(239,68,68,0.3)",borderRadius:6,color:"#f87171",fontSize:11,cursor:"pointer"},children:"Clear"})]})]}),o.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:8},children:[" ",o.jsx("strong",{children:"Tips:"})," Excel files with multiple sheets will be read from all tabs. PDF files can be uploaded or paste text directly above."]})]}),Rn==="upload"&&gr.length>0&&o.jsxs("div",{style:{marginTop:12,maxHeight:200,overflowY:"auto",background:"rgba(17,24,39,0.4)",borderRadius:6,padding:10},children:[o.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:6},children:["Parsed Items (",gr.length," total)",gr[0]?.sheet&&o.jsxs("span",{style:{marginLeft:8,color:"#a5b4fc"},children:["from sheets: ",[...new Set(gr.map(u=>u.sheet))].join(", ")]}),":"]}),o.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:[gr.slice(0,30).map((u,v)=>o.jsxs("span",{style:{fontSize:9,background:u.sheet?"rgba(139,92,246,0.2)":"rgba(99,102,241,0.2)",color:"#a5b4fc",padding:"3px 8px",borderRadius:4,border:u.value<0?"1px solid rgba(239,68,68,0.3)":"1px solid transparent"},title:u.sheet?`Sheet: ${u.sheet}`:"",children:[u.label.substring(0,25),u.label.length>25?"...":"",":",o.jsx("span",{style:{color:u.value>=0?"#34d399":"#f87171",marginLeft:4},children:u.value<0?`(${ae(Math.abs(u.value))})`:ae(u.value)})]},v)),gr.length>30&&o.jsxs("span",{style:{fontSize:9,color:"#6b7280",padding:"3px 8px"},children:["+",gr.length-30," more items"]})]})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:o.jsx("span",{style:{fontWeight:700,fontSize:14},children:" Prior Year Income Statement"})}),o.jsxs("div",{style:{padding:16,maxHeight:400,overflowY:"auto"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[o.jsx("span",{style:xa,children:"Revenue"}),o.jsx("button",{onClick:()=>Ya("revenue"),style:{padding:"2px 8px",background:"rgba(52,211,153,0.2)",border:"none",borderRadius:4,color:"#34d399",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),G.filter(u=>u.section==="revenue"||u.type==="revenue").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:v=>Ir(u.id,"label",v.target.value),style:{...ft,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:v=>Ir(u.id,"value",v.target.value),style:{...Ot,width:100,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>Jn(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""}),u.mapped&&o.jsx("span",{style:{fontSize:8,color:"#34d399"},children:""})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"6px 0",fontWeight:600,fontSize:11,borderTop:"1px solid rgba(75,85,99,0.2)",marginTop:4},children:[o.jsx("span",{children:"Total Revenue"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#34d399"},children:ae(at.revenue)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:12,marginBottom:6},children:[o.jsx("span",{style:xa,children:"Cost of Sales"}),o.jsx("button",{onClick:()=>Ya("cogs"),style:{padding:"2px 8px",background:"rgba(251,191,36,0.2)",border:"none",borderRadius:4,color:"#fbbf24",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),G.filter(u=>u.section==="cost_of_sales"||u.type==="cogs").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:v=>Ir(u.id,"label",v.target.value),style:{...ft,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:v=>Ir(u.id,"value",v.target.value),style:{...Ot,width:100,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>Jn(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"rgba(52,211,153,0.1)",borderRadius:6,fontWeight:700,fontSize:12,marginTop:4},children:[o.jsx("span",{children:"Gross Profit"}),o.jsx("span",{style:{fontFamily:"monospace",color:at.gp>=0?"#34d399":"#f87171"},children:ae(at.gp)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:12,marginBottom:6},children:[o.jsx("span",{style:xa,children:"Operating Expenses"}),o.jsx("button",{onClick:()=>Ya("expense"),style:{padding:"2px 8px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),G.filter(u=>u.section==="operating_expenses"||u.type==="expense").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:v=>Ir(u.id,"label",v.target.value),style:{...ft,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:v=>Ir(u.id,"value",v.target.value),style:{...Ot,width:100,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>Jn(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:12,marginBottom:6},children:[o.jsx("span",{style:xa,children:"Other Income"}),o.jsx("button",{onClick:()=>Ya("other_income"),style:{padding:"2px 8px",background:"rgba(52,211,153,0.2)",border:"none",borderRadius:4,color:"#34d399",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),G.filter(u=>u.section==="other_income"||u.type==="other_income").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:v=>Ir(u.id,"label",v.target.value),style:{...ft,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:v=>Ir(u.id,"value",v.target.value),style:{...Ot,width:100,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>Jn(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:12,marginBottom:6},children:[o.jsx("span",{style:xa,children:"Other Expenses"}),o.jsx("button",{onClick:()=>Ya("other_expense"),style:{padding:"2px 8px",background:"rgba(251,191,36,0.2)",border:"none",borderRadius:4,color:"#fbbf24",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),G.filter(u=>u.section==="other_expenses"||u.type==="other_expense").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:v=>Ir(u.id,"label",v.target.value),style:{...ft,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:v=>Ir(u.id,"value",v.target.value),style:{...Ot,width:100,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>Jn(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:12,marginBottom:6},children:[o.jsx("span",{style:xa,children:"Finance Costs"}),o.jsx("button",{onClick:()=>Ya("finance"),style:{padding:"2px 8px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),G.filter(u=>u.section==="finance_costs"||u.type==="finance").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:v=>Ir(u.id,"label",v.target.value),style:{...ft,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:v=>Ir(u.id,"value",v.target.value),style:{...Ot,width:100,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>Jn(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""})]},u.id)),o.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:12,marginBottom:6},children:o.jsx("span",{style:xa,children:"Taxation"})}),G.filter(u=>u.section==="tax"||u.type==="tax").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:v=>Ir(u.id,"label",v.target.value),style:{...ft,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:v=>Ir(u.id,"value",v.target.value),style:{...Ot,width:100,fontSize:11,padding:"4px 8px"}})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px",background:"linear-gradient(135deg, rgba(52,211,153,0.2), rgba(99,102,241,0.2))",borderRadius:6,marginTop:12},children:[o.jsx("span",{style:{fontWeight:700},children:"Net Profit / (Loss)"}),o.jsx("span",{style:{fontFamily:"monospace",fontWeight:700,color:at.np>=0?"#34d399":"#f87171"},children:ae(at.np)})]})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontWeight:700,fontSize:14},children:" Prior Year Balance Sheet"}),o.jsx("div",{style:{padding:"4px 10px",borderRadius:6,fontSize:10,fontWeight:600,background:at.balanced?"rgba(52,211,153,0.15)":"rgba(239,68,68,0.15)",color:at.balanced?"#34d399":"#f87171"},children:at.balanced?" Balanced":`Diff: ${ae(at.diff)}`})]}),o.jsxs("div",{style:{padding:16,maxHeight:400,overflowY:"auto"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[o.jsx("span",{style:xa,children:"Non-Current Assets"}),o.jsx("button",{onClick:()=>hn("nca"),style:{padding:"2px 8px",background:"rgba(99,102,241,0.2)",border:"none",borderRadius:4,color:"#a5b4fc",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),xe.filter(u=>u.type==="nca").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:v=>tn(u.id,"label",v.target.value),style:{...ft,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:v=>tn(u.id,"value",v.target.value),style:{...Ot,width:90,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>Qn(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",fontSize:10,color:"#9ca3af"},children:[o.jsx("span",{children:"Total NCA"}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(at.nca)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:10,marginBottom:6},children:[o.jsx("span",{style:xa,children:"Current Assets"}),o.jsx("button",{onClick:()=>hn("ca"),style:{padding:"2px 8px",background:"rgba(52,211,153,0.2)",border:"none",borderRadius:4,color:"#34d399",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),xe.filter(u=>u.type==="ca").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:v=>tn(u.id,"label",v.target.value),style:{...ft,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:v=>tn(u.id,"value",v.target.value),style:{...Ot,width:90,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>Qn(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",fontSize:10,color:"#9ca3af"},children:[o.jsx("span",{children:"Total CA"}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(at.ca)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"rgba(99,102,241,0.1)",borderRadius:6,fontWeight:600,fontSize:11,marginTop:8},children:[o.jsx("span",{children:"TOTAL ASSETS"}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(at.totA)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:12,marginBottom:6},children:[o.jsx("span",{style:xa,children:"Non-Current Liabilities"}),o.jsx("button",{onClick:()=>hn("ncl"),style:{padding:"2px 8px",background:"rgba(251,191,36,0.2)",border:"none",borderRadius:4,color:"#fbbf24",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),xe.filter(u=>u.type==="ncl").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:v=>tn(u.id,"label",v.target.value),style:{...ft,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:v=>tn(u.id,"value",v.target.value),style:{...Ot,width:90,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>Qn(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:10,marginBottom:6},children:[o.jsx("span",{style:xa,children:"Current Liabilities"}),o.jsx("button",{onClick:()=>hn("cl"),style:{padding:"2px 8px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),xe.filter(u=>u.type==="cl").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:v=>tn(u.id,"label",v.target.value),style:{...ft,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:v=>tn(u.id,"value",v.target.value),style:{...Ot,width:90,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>Qn(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",fontSize:10,color:"#9ca3af"},children:[o.jsx("span",{children:"Total Liabilities"}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(at.totL)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:10,marginBottom:6},children:[o.jsx("span",{style:xa,children:"Equity"}),o.jsx("button",{onClick:()=>hn("equity"),style:{padding:"2px 8px",background:"rgba(139,92,246,0.2)",border:"none",borderRadius:4,color:"#a78bfa",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),xe.filter(u=>u.type==="equity").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:v=>tn(u.id,"label",v.target.value),style:{...ft,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:v=>tn(u.id,"value",v.target.value),style:{...Ot,width:90,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>Qn(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",fontSize:10,color:"#9ca3af"},children:[o.jsx("span",{children:"Total Equity"}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(at.totE)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"rgba(239,68,68,0.1)",borderRadius:6,fontWeight:600,fontSize:11,marginTop:8},children:[o.jsx("span",{children:"TOTAL L + E"}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(at.totLE)})]}),o.jsxs("div",{style:{padding:10,background:at.balanced?"rgba(52,211,153,0.1)":"rgba(251,191,36,0.1)",borderRadius:6,marginTop:12,fontSize:11},children:[o.jsx("div",{style:{fontWeight:700,color:at.balanced?"#34d399":"#fbbf24",marginBottom:4},children:at.balanced?" Balance Sheet is Balanced":" Not Balanced - Check entries"}),o.jsxs("div",{children:["Difference: ",ae(Math.abs(at.totA-at.totLE))]})]})]})]})]})]}),o.jsx("div",{style:{marginTop:16,padding:"16px 0"},children:ee?o.jsxs("div",{style:{padding:"14px 20px",background:"rgba(52,211,153,0.15)",border:"2px solid rgba(52,211,153,0.4)",borderRadius:8,textAlign:"center"},children:[o.jsx("div",{style:{color:"#34d399",fontWeight:700,fontSize:14},children:" Prior Year Balances Applied Successfully"}),o.jsx("div",{style:{color:"#9ca3af",fontSize:12,marginTop:4},children:'Opening balances have been updated. Click "Banks " above to continue.'})]}):o.jsx("button",{onClick:()=>{pf(),O(!0)},disabled:at.totA===0&&at.totLE===0,style:{width:"100%",padding:"14px 20px",background:at.totA>0||at.totLE>0?"linear-gradient(135deg, #10b981, #059669)":"rgba(75,85,99,0.3)",border:"none",borderRadius:8,color:"#fff",fontSize:14,fontWeight:700,cursor:at.totA>0||at.totLE>0?"pointer":"not-allowed",boxShadow:at.totA>0||at.totLE>0?"0 4px 12px rgba(16,185,129,0.3)":"none"},children:" Apply Prior Year Balances to Opening Balances"})})]}),e==="review"&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:12,marginBottom:16},children:[(()=>{const u={};return _.forEach(v=>{const b=v.bankAccount||"Unknown";u[b]||(u[b]={count:0,credits:0,debits:0,net:0}),u[b].count++,v.amount>=0?u[b].credits+=v.amount:u[b].debits+=Math.abs(v.amount),u[b].net+=v.amount}),Object.entries(u).map(([v,b])=>o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",padding:12},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[o.jsxs("span",{style:{fontWeight:700,fontSize:12},children:[" ",v]}),o.jsxs("span",{style:{background:"rgba(99,102,241,0.2)",color:"#a5b4fc",padding:"2px 8px",borderRadius:10,fontSize:10},children:[b.count," txns"]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,fontSize:10},children:[o.jsxs("div",{style:{background:"rgba(52,211,153,0.1)",padding:"6px 8px",borderRadius:6},children:[o.jsx("div",{style:{color:"#9ca3af",fontSize:9},children:"Total Credits"}),o.jsx("div",{style:{fontFamily:"monospace",fontWeight:600,color:"#34d399"},children:ae(b.credits)})]}),o.jsxs("div",{style:{background:"rgba(239,68,68,0.1)",padding:"6px 8px",borderRadius:6},children:[o.jsx("div",{style:{color:"#9ca3af",fontSize:9},children:"Total Debits"}),o.jsx("div",{style:{fontFamily:"monospace",fontWeight:600,color:"#f87171"},children:ae(b.debits)})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:8,padding:"6px 8px",background:"rgba(99,102,241,0.1)",borderRadius:6},children:[o.jsx("span",{style:{fontSize:10,fontWeight:600},children:"Net Movement"}),o.jsx("span",{style:{fontFamily:"monospace",fontWeight:700,fontSize:11,color:b.net>=0?"#34d399":"#f87171"},children:ae(b.net)})]})]},v))})(),_.length>0&&o.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(99,102,241,0.2), rgba(139,92,246,0.2))",borderRadius:10,border:"1px solid rgba(99,102,241,0.3)",padding:12},children:[o.jsx("div",{style:{fontWeight:700,fontSize:12,marginBottom:8},children:" All Banks Total"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,fontSize:10},children:[o.jsxs("div",{children:[o.jsx("div",{style:{color:"#9ca3af",fontSize:9},children:"Total Credits"}),o.jsx("div",{style:{fontFamily:"monospace",fontWeight:600,color:"#34d399"},children:ae(_.filter(u=>u.amount>=0).reduce((u,v)=>u+v.amount,0))})]}),o.jsxs("div",{children:[o.jsx("div",{style:{color:"#9ca3af",fontSize:9},children:"Total Debits"}),o.jsx("div",{style:{fontFamily:"monospace",fontWeight:600,color:"#f87171"},children:ae(Math.abs(_.filter(u=>u.amount<0).reduce((u,v)=>u+v.amount,0)))})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:8,padding:"8px",background:"rgba(17,24,39,0.4)",borderRadius:6},children:[o.jsx("span",{style:{fontWeight:700},children:"Net Movement"}),o.jsx("span",{style:{fontFamily:"monospace",fontWeight:700,fontSize:12,color:_.reduce((u,v)=>u+v.amount,0)>=0?"#34d399":"#f87171"},children:ae(_.reduce((u,v)=>u+v.amount,0))})]})]})]}),_.length>0&&o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",marginBottom:16,overflow:"hidden"},children:[o.jsx("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",fontWeight:700,fontSize:12},children:" Monthly Breakdown by Bank"}),o.jsx("div",{style:{padding:12,overflowX:"auto"},children:o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:10},children:[o.jsx("thead",{children:o.jsxs("tr",{style:{background:"rgba(99,102,241,0.1)"},children:[o.jsx("th",{style:{padding:6,textAlign:"left",fontWeight:600},children:"Bank"}),ni.filter(u=>_.some(v=>v.month===u)).map(u=>o.jsx("th",{style:{padding:6,textAlign:"right",fontWeight:600},children:u},u)),o.jsx("th",{style:{padding:6,textAlign:"right",fontWeight:700,background:"rgba(139,92,246,0.1)"},children:"Total"})]})}),o.jsxs("tbody",{children:[(()=>{const u=[...new Set(_.map(b=>b.bankAccount||"Unknown"))],v=ni.filter(b=>_.some(S=>S.month===b));return u.map((b,S)=>{const T=_.filter(j=>(j.bankAccount||"Unknown")===b),Q=T.reduce((j,C)=>j+C.amount,0);return o.jsxs("tr",{style:{background:S%2?"transparent":"rgba(17,24,39,0.3)"},children:[o.jsx("td",{style:{padding:6,fontWeight:600},children:b}),v.map(j=>{const C=T.filter(ye=>ye.month===j),M=C.reduce((ye,Fe)=>ye+Fe.amount,0),X=C.length;return o.jsx("td",{style:{padding:6,textAlign:"right"},children:X>0?o.jsxs("div",{children:[o.jsx("div",{style:{fontFamily:"monospace",color:M>=0?"#34d399":"#f87171"},children:ae(M)}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280"},children:[X," txns"]})]}):"-"},j)}),o.jsx("td",{style:{padding:6,textAlign:"right",fontWeight:700,fontFamily:"monospace",background:"rgba(139,92,246,0.1)",color:Q>=0?"#34d399":"#f87171"},children:ae(Q)})]},b)})})(),o.jsxs("tr",{style:{background:"rgba(99,102,241,0.15)",fontWeight:700},children:[o.jsx("td",{style:{padding:6},children:"TOTAL"}),ni.filter(u=>_.some(v=>v.month===u)).map(u=>{const b=_.filter(S=>S.month===u).reduce((S,T)=>S+T.amount,0);return o.jsx("td",{style:{padding:6,textAlign:"right",fontFamily:"monospace",color:b>=0?"#34d399":"#f87171"},children:ae(b)},u)}),o.jsx("td",{style:{padding:6,textAlign:"right",fontFamily:"monospace",background:"rgba(139,92,246,0.2)",color:_.reduce((u,v)=>u+v.amount,0)>=0?"#34d399":"#f87171"},children:ae(_.reduce((u,v)=>u+v.amount,0))})]})]})]})})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("button",{onClick:or,style:lr,children:" Upload"}),o.jsxs("span",{style:{fontWeight:700,fontSize:14},children:["Review Transactions (",_.length,")"]})]}),o.jsx("button",{onClick:_r,style:ja,children:"Next: Classify "})]}),o.jsxs("div",{style:{padding:12,maxHeight:350,overflowY:"auto"},children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"70px 60px 1fr 60px 80px 50px 50px 20px",gap:4,padding:"6px 8px",background:"rgba(99,102,241,0.1)",borderRadius:4,fontSize:9,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Date"}),o.jsx("span",{children:"Bank"}),o.jsx("span",{children:"Description"}),o.jsx("span",{children:"Ref"}),o.jsx("span",{style:{textAlign:"right"},children:"Amount"}),o.jsx("span",{children:"Month"}),o.jsx("span",{children:"Class"}),o.jsx("span",{})]}),_.map((u,v)=>{const b=cn.classify(u.description);return o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"70px 60px 1fr 60px 80px 50px 50px 20px",gap:4,padding:"4px 8px",background:v%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:10},children:[o.jsx("input",{type:"date",value:u.date,onChange:S=>Zs(v,"date",S.target.value),style:{...ft,padding:"2px 4px",fontSize:9}}),o.jsx("span",{style:{fontSize:9,color:"#9ca3af"},children:u.bankAccount?.substring(0,6)}),o.jsx("input",{value:u.description,onChange:S=>Zs(v,"description",S.target.value),style:{...ft,padding:"2px 4px",fontSize:9}}),o.jsx("span",{style:{fontSize:9,color:"#6b7280"},children:u.reference?.substring(0,8)}),o.jsx("input",{type:"number",value:u.amount,onChange:S=>Zs(v,"amount",S.target.value),style:{...Ot,padding:"2px 4px",fontSize:9,color:u.amount>=0?"#34d399":"#f87171"}}),o.jsx("span",{style:{fontSize:9,color:"#6b7280"},children:u.month}),o.jsx("span",{style:{background:b.code==="SUSPENSE"?"rgba(251,191,36,0.2)":"rgba(139,92,246,0.2)",color:b.code==="SUSPENSE"?"#fbbf24":"#c4b5fd",padding:"1px 3px",borderRadius:2,fontSize:7,textAlign:"center"},children:b.code.substring(0,5)}),o.jsx("button",{onClick:()=>v0(v),style:{width:16,height:16,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:9},children:""})]},v)})]})]})]}),e==="classify"&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("button",{onClick:or,style:lr,children:" Review"}),o.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[o.jsx("span",{style:{fontSize:11,color:"#9ca3af"},children:"Review auto-classifications and correct if needed"}),o.jsx("button",{onClick:_r,style:ja,children:"Next: Subledger "})]})]}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:12,marginBottom:16},children:(()=>{const u={};_.forEach(b=>{const S=b.classification||cn.classify(b.description).code;u[S]||(u[S]={count:0,total:0}),u[S].count++,u[S].total+=b.amount});const v={SALES:"#34d399",PURCHASE:"#f87171",SALARY:"#fbbf24",RENT:"#a78bfa",UTILITIES:"#60a5fa",BANK_CHARGES:"#f472b6",TRANSFER:"#94a3b8",SUSPENSE:"#fbbf24",LOAN:"#c084fc",FIXED_ASSET:"#2dd4bf",INTEREST_INC:"#4ade80",INTEREST_EXP:"#fb7185",PAY_SUPPLIER:"#f97316",PAY_CREDITOR:"#fb923c",LOAN_REPAY_ST:"#a855f7",LOAN_REPAY_LT:"#8b5cf6",TAX_PAYMENT:"#ef4444",GST_SST:"#f43f5e",RECEIPT_DEBTOR:"#22c55e",DEPOSIT_RECEIVED:"#14b8a6",LOAN_DRAWDOWN:"#06b6d4",DUITNOW_OUT:"#64748b",DRAWINGS:"#ec4899",CAPITAL:"#10b981"};return Object.entries(u).sort((b,S)=>S[1].count-b[1].count).map(([b,S])=>o.jsxs("div",{onClick:()=>z(F===b?"ALL":b),style:{background:F===b?"rgba(99,102,241,0.3)":"rgba(31,41,55,0.6)",borderRadius:8,border:F===b?"2px solid rgba(99,102,241,0.6)":"1px solid rgba(75,85,99,0.3)",padding:10,cursor:"pointer",transition:"all 0.2s"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[o.jsx("span",{style:{fontSize:10,fontWeight:700,color:v[b]||"#9ca3af"},children:b}),o.jsx("span",{style:{background:"rgba(99,102,241,0.2)",color:"#a5b4fc",padding:"1px 6px",borderRadius:8,fontSize:9},children:S.count})]}),o.jsx("div",{style:{fontFamily:"monospace",fontSize:11,fontWeight:600,color:S.total>=0?"#34d399":"#f87171"},children:ae(S.total)})]},b))})()}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:10},children:[o.jsx("span",{style:{fontWeight:700,fontSize:14},children:" Transaction Classifications"}),o.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[o.jsx("input",{type:"text",placeholder:" Search description...",value:q,onChange:u=>B(u.target.value),style:{padding:"5px 10px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.4)",borderRadius:6,color:"#e5e7eb",fontSize:10,width:150}}),o.jsxs("select",{value:F,onChange:u=>z(u.target.value),style:{padding:"5px 10px",background:"rgba(99,102,241,0.15)",border:"1px solid rgba(99,102,241,0.3)",borderRadius:6,color:"#a5b4fc",fontSize:10,cursor:"pointer"},children:[o.jsx("option",{value:"ALL",children:"All Classifications"}),o.jsx("option",{value:"SUSPENSE",children:" Unclassified Only"}),o.jsx("optgroup",{label:" Revenue",children:Gt.income.revenue.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsx("optgroup",{label:" Cost of Sales",children:Gt.income.cost_of_sales.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsx("optgroup",{label:" Operating Expenses",children:Gt.income.operating_expenses.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsx("optgroup",{label:" Other Income",children:Gt.income.other_income.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsx("optgroup",{label:" Other Expenses",children:Gt.income.other_expenses.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsx("optgroup",{label:" Finance Costs",children:Gt.income.finance_costs.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsxs("optgroup",{label:" Balance Sheet",children:[o.jsx("option",{value:"FIXED_ASSET",children:"Fixed Asset Purchase"}),o.jsx("option",{value:"LOAN",children:"Loan/Borrowing (Legacy)"}),o.jsx("option",{value:"CAPITAL",children:"Capital Injection"}),o.jsx("option",{value:"DRAWINGS",children:"Drawings"}),o.jsx("option",{value:"GST_SST",children:"GST/SST"})]}),o.jsxs("optgroup",{label:" Payments (Reduce Liabilities)",children:[o.jsx("option",{value:"PAY_SUPPLIER",children:"Payment to Supplier ( AP)"}),o.jsx("option",{value:"PAY_CREDITOR",children:"Payment to Creditor ( Other Pay)"}),o.jsx("option",{value:"LOAN_REPAY_ST",children:"Loan Repayment - ST ( ST Borr)"}),o.jsx("option",{value:"LOAN_REPAY_LT",children:"Loan Repayment - LT ( LT Borr)"}),o.jsx("option",{value:"TAX_PAYMENT",children:"Tax Payment ( Tax Pay)"})]}),o.jsxs("optgroup",{label:" Receipts (Reduce Assets/Increase Liab)",children:[o.jsx("option",{value:"RECEIPT_DEBTOR",children:"Receipt from Debtor ( AR)"}),o.jsx("option",{value:"DEPOSIT_RECEIVED",children:"Deposit Received ( Other Pay)"}),o.jsx("option",{value:"LOAN_DRAWDOWN",children:"Loan Drawdown ( Borrowings)"})]}),o.jsxs("optgroup",{label:" Other",children:[o.jsx("option",{value:"TRANSFER",children:"Transfer (Internal)"}),o.jsx("option",{value:"DUITNOW_OUT",children:"DuitNow"})]})]}),(F!=="ALL"||q)&&o.jsx("button",{onClick:()=>{z("ALL"),B("")},style:{padding:"5px 10px",background:"rgba(239,68,68,0.15)",border:"1px solid rgba(239,68,68,0.3)",borderRadius:6,color:"#fca5a5",fontSize:10,cursor:"pointer"},children:" Clear"}),o.jsxs("span",{style:{fontSize:10,color:"#fbbf24",background:"rgba(251,191,36,0.1)",padding:"4px 8px",borderRadius:4},children:[" ",_.filter(u=>(u.classification||cn.classify(u.description).code)==="SUSPENSE").length," unclassified"]})]})]}),o.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"rgba(99,102,241,0.05)",display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("input",{type:"checkbox",checked:(()=>{const u=_.map((v,b)=>({tx:v,i:b})).filter(({tx:v})=>{const b=v.classification||cn.classify(v.description).code,S=F==="ALL"||b===F,T=!q||v.description.toLowerCase().includes(q.toLowerCase());return S&&T}).map(({i:v})=>v);return u.length>0&&u.every(v=>ie.has(v))})(),onChange:u=>{const v=_.map((b,S)=>({tx:b,i:S})).filter(({tx:b})=>{const S=b.classification||cn.classify(b.description).code,T=F==="ALL"||S===F,Q=!q||b.description.toLowerCase().includes(q.toLowerCase());return T&&Q}).map(({i:b})=>b);if(u.target.checked)se(new Set([...ie,...v]));else{const b=new Set(ie);v.forEach(S=>b.delete(S)),se(b)}},style:{width:16,height:16,cursor:"pointer"}}),o.jsx("span",{style:{fontSize:11,color:"#a5b4fc",fontWeight:600},children:ie.size>0?`${ie.size} selected`:"Select All"})]}),ie.size>0&&o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{height:20,width:1,background:"rgba(75,85,99,0.5)"}}),o.jsx("span",{style:{fontSize:10,color:"#9ca3af"},children:"Bulk classify to:"}),o.jsxs("select",{value:ne,onChange:u=>H(u.target.value),style:{padding:"5px 10px",background:"rgba(52,211,153,0.15)",border:"1px solid rgba(52,211,153,0.3)",borderRadius:6,color:"#34d399",fontSize:10,cursor:"pointer",minWidth:150},children:[o.jsx("option",{value:"",children:"-- Select Classification --"}),o.jsx("optgroup",{label:" Revenue",children:Gt.income.revenue.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsx("optgroup",{label:" Cost of Sales",children:Gt.income.cost_of_sales.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsx("optgroup",{label:" Other Income",children:Gt.income.other_income.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsx("optgroup",{label:" Operating Expenses",children:Gt.income.operating_expenses.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsx("optgroup",{label:" Other Expenses",children:Gt.income.other_expenses.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsx("optgroup",{label:" Finance Costs",children:Gt.income.finance_costs.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsxs("optgroup",{label:" Balance Sheet",children:[o.jsx("option",{value:"FIXED_ASSET",children:"Fixed Asset Purchase"}),o.jsx("option",{value:"LOAN",children:"Loan/Borrowing (Legacy)"}),o.jsx("option",{value:"CAPITAL",children:"Capital Injection"}),o.jsx("option",{value:"DRAWINGS",children:"Drawings"})]}),o.jsxs("optgroup",{label:" Payments ( Liabilities)",children:[o.jsx("option",{value:"PAY_SUPPLIER",children:"Payment to Supplier ( AP)"}),o.jsx("option",{value:"PAY_CREDITOR",children:"Payment to Creditor ( Other Pay)"}),o.jsx("option",{value:"LOAN_REPAY_ST",children:"Loan Repayment - ST"}),o.jsx("option",{value:"LOAN_REPAY_LT",children:"Loan Repayment - LT"}),o.jsx("option",{value:"TAX_PAYMENT",children:"Tax Payment"}),o.jsx("option",{value:"GST_SST",children:"GST/SST Payment"})]}),o.jsxs("optgroup",{label:" Receipts",children:[o.jsx("option",{value:"RECEIPT_DEBTOR",children:"Receipt from Debtor ( AR)"}),o.jsx("option",{value:"DEPOSIT_RECEIVED",children:"Deposit Received"}),o.jsx("option",{value:"LOAN_DRAWDOWN",children:"Loan Drawdown"})]}),o.jsxs("optgroup",{label:" Others",children:[o.jsx("option",{value:"TRANSFER",children:"Transfer (Internal)"}),o.jsx("option",{value:"DUITNOW_OUT",children:"DuitNow"}),o.jsx("option",{value:"SUSPENSE",children:"Suspense"})]})]}),o.jsxs("button",{onClick:()=>{ne&&(w(u=>u.map((v,b)=>ie.has(b)?{...v,classification:ne}:v)),se(new Set),H(""))},disabled:!ne,style:{padding:"6px 14px",background:ne?"linear-gradient(135deg, #10b981, #059669)":"rgba(75,85,99,0.3)",border:"none",borderRadius:6,color:"#fff",fontSize:10,fontWeight:600,cursor:ne?"pointer":"not-allowed"},children:[" Apply to ",ie.size," items"]}),o.jsx("button",{onClick:()=>{w(u=>u.filter((v,b)=>!ie.has(b))),se(new Set)},style:{padding:"6px 14px",background:"rgba(239,68,68,0.2)",border:"1px solid rgba(239,68,68,0.3)",borderRadius:6,color:"#f87171",fontSize:10,fontWeight:600,cursor:"pointer"},children:" Delete Selected"}),o.jsx("button",{onClick:()=>se(new Set),style:{padding:"6px 10px",background:"transparent",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#9ca3af",fontSize:10,cursor:"pointer"},children:"Clear Selection"})]})]}),o.jsxs("div",{style:{padding:12,maxHeight:400,overflowY:"auto"},children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"30px 70px 1fr 100px 120px 30px",gap:4,padding:"6px 8px",background:"rgba(99,102,241,0.1)",borderRadius:4,fontSize:9,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{}),o.jsx("span",{children:"Date"}),o.jsx("span",{children:"Description"}),o.jsx("span",{style:{textAlign:"right"},children:"Amount"}),o.jsx("span",{children:"Classification"}),o.jsx("span",{})]}),(()=>{const u=_.map((v,b)=>({...v,originalIndex:b})).filter(v=>{const b=v.classification||cn.classify(v.description).code,S=F==="ALL"||b===F,T=!q||v.description.toLowerCase().includes(q.toLowerCase());return S&&T});return u.length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#9ca3af",fontSize:12},children:"No transactions match the current filter."}):u.map((v,b)=>{const S=v.originalIndex,T=cn.classify(v.description),Q=v.classification||T.code,j=ie.has(S);return o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"30px 70px 1fr 100px 120px 30px",gap:4,padding:"6px 8px",background:j?"rgba(99,102,241,0.2)":b%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:10,borderLeft:Q==="SUSPENSE"?"3px solid #fbbf24":j?"3px solid #6366f1":"3px solid transparent"},children:[o.jsx("input",{type:"checkbox",checked:j,onChange:C=>{const M=new Set(ie);C.target.checked?M.add(S):M.delete(S),se(M)},style:{width:14,height:14,cursor:"pointer"}}),o.jsx("span",{style:{color:"#9ca3af"},children:v.date}),o.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:v.description,children:v.description}),o.jsx("input",{type:"number",value:v.amount,onChange:C=>Zs(S,"amount",C.target.value),style:{...Ot,padding:"3px 6px",fontSize:10,textAlign:"right",color:v.amount>=0?"#34d399":"#f87171",background:"rgba(17,24,39,0.5)"}}),o.jsxs("select",{value:Q,onChange:C=>Zs(S,"classification",C.target.value),style:{background:Q==="SUSPENSE"?"rgba(251,191,36,0.2)":"rgba(99,102,241,0.1)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:4,padding:"3px 6px",color:Q==="SUSPENSE"?"#fbbf24":"#e5e7eb",fontSize:9,cursor:"pointer"},children:[o.jsxs("optgroup",{label:" Revenue & Income",children:[o.jsx("option",{value:"SALES",children:"SALES (Revenue)"}),o.jsx("option",{value:"INTEREST_INC",children:"INTEREST INCOME"}),o.jsx("option",{value:"DIVIDEND_INC",children:"DIVIDEND INCOME"}),o.jsx("option",{value:"RENTAL_INC",children:"RENTAL INCOME"}),o.jsx("option",{value:"OTHER_INCOME",children:"OTHER INCOME"})]}),o.jsxs("optgroup",{label:" Cost of Sales",children:[o.jsx("option",{value:"PURCHASE",children:"PURCHASE (COGS)"}),o.jsx("option",{value:"FREIGHT_IN",children:"FREIGHT IN"})]}),o.jsxs("optgroup",{label:" Staff Costs",children:[o.jsx("option",{value:"SALARY",children:"SALARY & WAGES"}),o.jsx("option",{value:"EPF",children:"EPF/KWSP"}),o.jsx("option",{value:"SOCSO",children:"SOCSO/EIS"}),o.jsx("option",{value:"HRDF",children:"HRDF"})]}),o.jsxs("optgroup",{label:" Premises",children:[o.jsx("option",{value:"RENT",children:"RENT & LEASE"}),o.jsx("option",{value:"UTILITIES",children:"UTILITIES (TNB/Water)"}),o.jsx("option",{value:"TELEPHONE",children:"TELEPHONE & INTERNET"})]}),o.jsxs("optgroup",{label:" Marketing & Sales",children:[o.jsx("option",{value:"ADVERTISING",children:"ADVERTISING & MARKETING"}),o.jsx("option",{value:"ENTERTAINMENT",children:"ENTERTAINMENT"}),o.jsx("option",{value:"TRAVEL",children:"TRAVEL & TRANSPORT"})]}),o.jsxs("optgroup",{label:" Professional",children:[o.jsx("option",{value:"PROFESSIONAL_FEE",children:"PROFESSIONAL FEES"}),o.jsx("option",{value:"LICENSE_FEE",children:"LICENSE & SUBSCRIPTION"}),o.jsx("option",{value:"INSURANCE",children:"INSURANCE"})]}),o.jsxs("optgroup",{label:" Office & General",children:[o.jsx("option",{value:"OFFICE_SUPPLIES",children:"OFFICE SUPPLIES"}),o.jsx("option",{value:"REPAIR_MAINTENANCE",children:"REPAIR & MAINTENANCE"}),o.jsx("option",{value:"CLEANING",children:"CLEANING"}),o.jsx("option",{value:"DEPRECIATION",children:"DEPRECIATION"}),o.jsx("option",{value:"BAD_DEBT",children:"BAD DEBT"}),o.jsx("option",{value:"OTHER_EXPENSE",children:"OTHER EXPENSE"})]}),o.jsxs("optgroup",{label:" Finance",children:[o.jsx("option",{value:"BANK_CHARGES",children:"BANK CHARGES"}),o.jsx("option",{value:"INTEREST_EXP",children:"INTEREST EXPENSE"})]}),o.jsxs("optgroup",{label:" Balance Sheet",children:[o.jsx("option",{value:"FIXED_ASSET",children:"FIXED ASSET"}),o.jsx("option",{value:"LOAN",children:"LOAN (Legacy)"}),o.jsx("option",{value:"CAPITAL",children:"CAPITAL/DIRECTOR LOAN"}),o.jsx("option",{value:"DRAWINGS",children:"DRAWINGS"})]}),o.jsxs("optgroup",{label:" Payments ( Liabilities)",children:[o.jsx("option",{value:"PAY_SUPPLIER",children:"PAY SUPPLIER ( AP)"}),o.jsx("option",{value:"PAY_CREDITOR",children:"PAY CREDITOR ( Other Pay)"}),o.jsx("option",{value:"LOAN_REPAY_ST",children:"LOAN REPAY - ST"}),o.jsx("option",{value:"LOAN_REPAY_LT",children:"LOAN REPAY - LT"}),o.jsx("option",{value:"TAX_PAYMENT",children:"TAX PAYMENT"}),o.jsx("option",{value:"GST_SST",children:"GST/SST PAYMENT"})]}),o.jsxs("optgroup",{label:" Receipts",children:[o.jsx("option",{value:"RECEIPT_DEBTOR",children:"RECEIPT FROM DEBTOR ( AR)"}),o.jsx("option",{value:"DEPOSIT_RECEIVED",children:"DEPOSIT RECEIVED"}),o.jsx("option",{value:"LOAN_DRAWDOWN",children:"LOAN DRAWDOWN"})]}),o.jsxs("optgroup",{label:" Others",children:[o.jsx("option",{value:"TRANSFER",children:"TRANSFER (Internal)"}),o.jsx("option",{value:"DUITNOW_OUT",children:"DUITNOW"}),o.jsx("option",{value:"SUSPENSE",children:" SUSPENSE (Unclassified)"})]})]}),o.jsx("button",{onClick:()=>w(C=>C.filter((M,X)=>X!==S)),style:{width:20,height:20,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:3,color:"#f87171",cursor:"pointer",fontSize:10},title:"Delete transaction",children:""})]},S)})})()]}),(F!=="ALL"||q)&&o.jsxs("div",{style:{padding:"8px 16px",borderTop:"1px solid rgba(75,85,99,0.2)",background:"rgba(99,102,241,0.1)",fontSize:10,color:"#a5b4fc"},children:["Showing ",_.filter(u=>{const v=u.classification||cn.classify(u.description).code,b=F==="ALL"||v===F,S=!q||u.description.toLowerCase().includes(q.toLowerCase());return b&&S}).length," of ",_.length," transactions",F!=="ALL"&&o.jsxs("span",{children:["  Filter: ",o.jsx("strong",{children:F})]}),q&&o.jsxs("span",{children:["  Search: ",o.jsxs("strong",{children:['"',q,'"']})]})]})]}),o.jsx("div",{style:{marginTop:16,padding:12,background:"rgba(99,102,241,0.1)",borderRadius:8,border:"1px solid rgba(99,102,241,0.2)"},children:o.jsxs("div",{style:{fontSize:11,color:"#a5b4fc"},children:[" ",o.jsx("strong",{children:"Tip:"})," Click on a category card above to filter by that classification. Use the search box to find specific transactions. Review transactions marked as SUSPENSE (yellow) and assign the correct classification. You can also ",o.jsx("strong",{children:"edit amounts"})," if the sign is wrong (positive = credit/inflow, negative = debit/outflow)."]})})]}),e==="cashvoucher"&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("button",{onClick:or,style:lr,children:" Classify"}),o.jsx("button",{onClick:_r,style:ja,children:"Subledger "})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:12,marginBottom:16},children:[o.jsxs("div",{style:{background:"rgba(52,211,153,0.1)",border:"1px solid rgba(52,211,153,0.3)",borderRadius:8,padding:12,textAlign:"center"},children:[o.jsx("div",{style:{fontSize:10,color:"#34d399",marginBottom:4},children:"Cash In"}),o.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#34d399"},children:ae(N.filter(u=>u.amount>0).reduce((u,v)=>u+v.amount,0))})]}),o.jsxs("div",{style:{background:"rgba(239,68,68,0.1)",border:"1px solid rgba(239,68,68,0.3)",borderRadius:8,padding:12,textAlign:"center"},children:[o.jsx("div",{style:{fontSize:10,color:"#f87171",marginBottom:4},children:"Cash Out"}),o.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#f87171"},children:ae(Math.abs(N.filter(u=>u.amount<0).reduce((u,v)=>u+v.amount,0)))})]}),o.jsxs("div",{style:{background:"rgba(99,102,241,0.1)",border:"1px solid rgba(99,102,241,0.3)",borderRadius:8,padding:12,textAlign:"center"},children:[o.jsx("div",{style:{fontSize:10,color:"#a5b4fc",marginBottom:4},children:"Net Cash"}),o.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#a5b4fc"},children:ae(N.reduce((u,v)=>u+v.amount,0))})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:12,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(251,191,36,0.1), rgba(245,158,11,0.1))"},children:o.jsx("div",{style:{fontWeight:700,fontSize:14},children:" Add Cash Voucher"})}),o.jsxs("div",{style:{padding:16,display:"flex",flexDirection:"column",gap:10},children:[o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Date"}),o.jsx("input",{type:"date",value:Rt.date,onChange:u=>Yr(v=>({...v,date:u.target.value})),style:{width:"100%",padding:"8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:12,boxSizing:"border-box"}})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Type"}),o.jsxs("select",{value:Rt.type,onChange:u=>Yr(v=>({...v,type:u.target.value})),style:{width:"100%",padding:"8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:12},children:[o.jsx("option",{value:"in",children:" Cash Received"}),o.jsx("option",{value:"out",children:" Cash Paid"}),o.jsx("option",{value:"bank_to_cash",children:" Bank to Cash"}),o.jsx("option",{value:"cash_to_bank",children:" Cash to Bank"})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Description"}),o.jsx("input",{type:"text",value:Rt.description,onChange:u=>Yr(v=>({...v,description:u.target.value})),placeholder:"e.g. Office supplies",style:{width:"100%",padding:"8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:12,boxSizing:"border-box"}})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Reference"}),o.jsx("input",{type:"text",value:Rt.reference,onChange:u=>Yr(v=>({...v,reference:u.target.value})),style:{width:"100%",padding:"8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:12,boxSizing:"border-box"}})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Amount (RM)"}),o.jsx("input",{type:"number",value:Rt.amount,onChange:u=>Yr(v=>({...v,amount:u.target.value})),placeholder:"0.00",step:"0.01",style:{width:"100%",padding:"8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:12,textAlign:"right",boxSizing:"border-box"}})]})]}),!Rt.type.includes("bank")&&o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Classification"}),o.jsxs("select",{value:Rt.classification,onChange:u=>Yr(v=>({...v,classification:u.target.value})),style:{width:"100%",padding:"8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select --"}),o.jsx("option",{value:"SALES",children:"Sales Revenue"}),o.jsx("option",{value:"OTHER_INCOME",children:"Other Income"}),o.jsx("option",{value:"PURCHASE",children:"Purchases / COGS"}),o.jsx("option",{value:"OFFICE_SUPPLIES",children:"Office Supplies"}),o.jsx("option",{value:"TRAVEL",children:"Travel"}),o.jsx("option",{value:"ENTERTAINMENT",children:"Entertainment"}),o.jsx("option",{value:"UTILITIES",children:"Utilities"}),o.jsx("option",{value:"MISCELLANEOUS",children:"Misc Expense"}),o.jsx("option",{value:"DRAWINGS",children:"Drawings"}),o.jsx("option",{value:"SUSPENSE",children:"Suspense"})]})]}),(()=>{const u=y0();return u?o.jsxs("div",{style:{marginTop:8,padding:8,background:"rgba(99,102,241,0.1)",border:"1px solid rgba(99,102,241,0.2)",borderRadius:6},children:[o.jsx("div",{style:{fontSize:9,color:"#a5b4fc",fontWeight:600,marginBottom:6},children:" Suggested Double Entry:"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:4,fontSize:10},children:[o.jsxs("span",{children:["Dr: ",u.drAcc]}),o.jsx("span",{style:{fontFamily:"monospace",color:"#34d399"},children:ae(u.amt)}),o.jsxs("span",{style:{paddingLeft:12},children:["Cr: ",u.crAcc]}),o.jsx("span",{style:{fontFamily:"monospace",color:"#f87171"},children:ae(u.amt)})]})]}):null})(),o.jsx("button",{onClick:Ef,style:{width:"100%",padding:"10px",background:"linear-gradient(135deg, #fbbf24, #f59e0b)",border:"none",borderRadius:6,color:"#1f2937",fontSize:12,fontWeight:700,cursor:"pointer",marginTop:8},children:"+ Add Cash Voucher"})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:12,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:o.jsxs("div",{children:[o.jsx("span",{style:{fontWeight:700,fontSize:14},children:" Cash Vouchers"}),o.jsx("span",{style:{marginLeft:8,background:"rgba(251,191,36,0.2)",color:"#fbbf24",padding:"2px 8px",borderRadius:8,fontSize:10},children:N.length})]})}),o.jsx("div",{style:{maxHeight:400,overflowY:"auto"},children:N.length>0?o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:11},children:[o.jsx("thead",{children:o.jsxs("tr",{style:{background:"rgba(99,102,241,0.1)"},children:[o.jsx("th",{style:{padding:8,textAlign:"left",borderBottom:"1px solid rgba(75,85,99,0.3)"},children:"Date"}),o.jsx("th",{style:{padding:8,textAlign:"left",borderBottom:"1px solid rgba(75,85,99,0.3)"},children:"Ref"}),o.jsx("th",{style:{padding:8,textAlign:"left",borderBottom:"1px solid rgba(75,85,99,0.3)"},children:"Description"}),o.jsx("th",{style:{padding:8,textAlign:"left",borderBottom:"1px solid rgba(75,85,99,0.3)"},children:"Class"}),o.jsx("th",{style:{padding:8,textAlign:"right",borderBottom:"1px solid rgba(75,85,99,0.3)"},children:"In"}),o.jsx("th",{style:{padding:8,textAlign:"right",borderBottom:"1px solid rgba(75,85,99,0.3)"},children:"Out"}),o.jsx("th",{style:{padding:8,borderBottom:"1px solid rgba(75,85,99,0.3)"}})]})}),o.jsx("tbody",{children:N.map((u,v)=>o.jsxs("tr",{style:{borderBottom:"1px solid rgba(75,85,99,0.2)"},children:[o.jsx("td",{style:{padding:8},children:u.date}),o.jsx("td",{style:{padding:8,color:"#a5b4fc"},children:u.reference}),o.jsx("td",{style:{padding:8},children:u.description}),o.jsx("td",{style:{padding:8},children:o.jsxs("select",{value:u.classification||"",onChange:b=>k(S=>S.map((T,Q)=>Q===v?{...T,classification:b.target.value}:T)),style:{padding:"4px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:4,color:"#e5e7eb",fontSize:10},children:[o.jsx("option",{value:"",children:"--"}),o.jsx("option",{value:"SALES",children:"Sales"}),o.jsx("option",{value:"OTHER_INCOME",children:"Other Income"}),o.jsx("option",{value:"PURCHASE",children:"Purchases"}),o.jsx("option",{value:"OFFICE_SUPPLIES",children:"Office Supplies"}),o.jsx("option",{value:"TRAVEL",children:"Travel"}),o.jsx("option",{value:"UTILITIES",children:"Utilities"}),o.jsx("option",{value:"MISCELLANEOUS",children:"Misc Expense"}),o.jsx("option",{value:"DRAWINGS",children:"Drawings"}),o.jsx("option",{value:"CASH_TRANSFER",children:"Transfer"}),o.jsx("option",{value:"SUSPENSE",children:"Suspense"})]})}),o.jsx("td",{style:{padding:8,textAlign:"right",color:"#34d399",fontFamily:"monospace"},children:u.amount>0?ae(u.amount):"-"}),o.jsx("td",{style:{padding:8,textAlign:"right",color:"#f87171",fontFamily:"monospace"},children:u.amount<0?ae(Math.abs(u.amount)):"-"}),o.jsx("td",{style:{padding:8},children:o.jsx("button",{onClick:()=>k(b=>b.filter((S,T)=>T!==v)),style:{padding:"2px 6px",background:"rgba(239,68,68,0.15)",border:"none",borderRadius:4,color:"#fca5a5",fontSize:10,cursor:"pointer"},children:""})})]},v))}),o.jsx("tfoot",{children:o.jsxs("tr",{style:{background:"rgba(99,102,241,0.1)",fontWeight:600},children:[o.jsx("td",{colSpan:4,style:{padding:8},children:"TOTAL"}),o.jsx("td",{style:{padding:8,textAlign:"right",color:"#34d399"},children:ae(N.filter(u=>u.amount>0).reduce((u,v)=>u+v.amount,0))}),o.jsx("td",{style:{padding:8,textAlign:"right",color:"#f87171"},children:ae(Math.abs(N.filter(u=>u.amount<0).reduce((u,v)=>u+v.amount,0)))}),o.jsx("td",{})]})})]}):o.jsxs("div",{style:{padding:40,textAlign:"center",color:"#6b7280"},children:[o.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),o.jsx("div",{style:{fontSize:12},children:"No cash vouchers yet"}),o.jsx("div",{style:{fontSize:10},children:"Add petty cash transactions"})]})})]})]}),o.jsxs("div",{style:{marginTop:16,padding:12,background:"rgba(251,191,36,0.1)",border:"1px solid rgba(251,191,36,0.3)",borderRadius:8,fontSize:11,color:"#fbbf24"},children:[o.jsx("strong",{children:" Cash Vouchers"})," are for petty cash transactions that don't go through the bank."]})]}),e==="subledger"&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("button",{onClick:or,style:lr,children:" Cash"}),o.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[o.jsx("button",{onClick:k0,style:{padding:"6px 12px",background:"linear-gradient(135deg, #059669, #10b981)",border:"none",borderRadius:6,color:"#fff",fontSize:11,cursor:"pointer",fontWeight:600},children:" Export All (Excel)"}),o.jsx("button",{onClick:w0,style:{padding:"6px 12px",background:"rgba(5,150,105,0.3)",border:"1px solid rgba(16,185,129,0.5)",borderRadius:6,color:"#34d399",fontSize:11,cursor:"pointer",fontWeight:600},children:" Export All (CSV)"}),o.jsx("button",{onClick:()=>R0("xlsx"),style:{padding:"6px 12px",background:"linear-gradient(135deg, #0891b2, #06b6d4)",border:"none",borderRadius:6,color:"#fff",fontSize:11,cursor:"pointer",fontWeight:600},children:" Export COA"}),o.jsx("button",{onClick:_r,style:ja,children:"Next: Opening Balances "})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:10,marginBottom:16},children:[o.jsxs("div",{style:{background:"rgba(99,102,241,0.1)",borderRadius:10,border:"1px solid rgba(99,102,241,0.3)",padding:10,position:"relative"},children:[o.jsxs("div",{style:{position:"absolute",top:6,right:6,display:"flex",gap:2},children:[o.jsx("button",{onClick:()=>Yo("xlsx"),title:"Export Excel",style:{padding:"2px 4px",background:"rgba(99,102,241,0.4)",border:"none",borderRadius:3,color:"#a5b4fc",fontSize:8,cursor:"pointer"},children:"XLS"}),o.jsx("button",{onClick:()=>Yo("csv"),title:"Export CSV",style:{padding:"2px 4px",background:"rgba(99,102,241,0.2)",border:"none",borderRadius:3,color:"#a5b4fc",fontSize:8,cursor:"pointer"},children:"CSV"})]}),o.jsx("div",{style:{fontSize:9,color:"#9ca3af"},children:"PPE (NBV) - GL 1000"}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#a5b4fc",fontFamily:"monospace"},children:ae(rt.ppe.nbv).replace("MYR ","")}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280"},children:[De.length," assets"]})]}),o.jsxs("div",{style:{background:"rgba(52,211,153,0.1)",borderRadius:10,border:"1px solid rgba(52,211,153,0.3)",padding:10,position:"relative"},children:[o.jsxs("div",{style:{position:"absolute",top:6,right:6,display:"flex",gap:2},children:[o.jsx("button",{onClick:()=>Wo("xlsx"),title:"Export Excel",style:{padding:"2px 4px",background:"rgba(52,211,153,0.4)",border:"none",borderRadius:3,color:"#34d399",fontSize:8,cursor:"pointer"},children:"XLS"}),o.jsx("button",{onClick:()=>Wo("csv"),title:"Export CSV",style:{padding:"2px 4px",background:"rgba(52,211,153,0.2)",border:"none",borderRadius:3,color:"#34d399",fontSize:8,cursor:"pointer"},children:"CSV"})]}),o.jsx("div",{style:{fontSize:9,color:"#9ca3af"},children:"Inventory - GL 1500"}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#34d399",fontFamily:"monospace"},children:ae(rt.inventory).replace("MYR ","")}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280"},children:[Xe.length," items"]})]}),o.jsxs("div",{style:{background:"rgba(251,191,36,0.1)",borderRadius:10,border:"1px solid rgba(251,191,36,0.3)",padding:10,position:"relative"},children:[o.jsxs("div",{style:{position:"absolute",top:6,right:6,display:"flex",gap:2},children:[o.jsx("button",{onClick:()=>Vo("xlsx"),title:"Export Excel",style:{padding:"2px 4px",background:"rgba(251,191,36,0.4)",border:"none",borderRadius:3,color:"#fbbf24",fontSize:8,cursor:"pointer"},children:"XLS"}),o.jsx("button",{onClick:()=>Vo("csv"),title:"Export CSV",style:{padding:"2px 4px",background:"rgba(251,191,36,0.2)",border:"none",borderRadius:3,color:"#fbbf24",fontSize:8,cursor:"pointer"},children:"CSV"})]}),o.jsx("div",{style:{fontSize:9,color:"#9ca3af"},children:"Trade Receivables - GL 1600"}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#fbbf24",fontFamily:"monospace"},children:ae(rt.receivables).replace("MYR ","")}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280"},children:[We.length," customers"]})]}),o.jsxs("div",{style:{background:"rgba(139,92,246,0.1)",borderRadius:10,border:"1px solid rgba(139,92,246,0.3)",padding:10,position:"relative"},children:[o.jsxs("div",{style:{position:"absolute",top:6,right:6,display:"flex",gap:2},children:[o.jsx("button",{onClick:()=>qo("xlsx"),title:"Export Excel",style:{padding:"2px 4px",background:"rgba(139,92,246,0.4)",border:"none",borderRadius:3,color:"#c084fc",fontSize:8,cursor:"pointer"},children:"XLS"}),o.jsx("button",{onClick:()=>qo("csv"),title:"Export CSV",style:{padding:"2px 4px",background:"rgba(139,92,246,0.2)",border:"none",borderRadius:3,color:"#c084fc",fontSize:8,cursor:"pointer"},children:"CSV"})]}),o.jsx("div",{style:{fontSize:9,color:"#9ca3af"},children:"Other Debtors - GL 1700"}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#c084fc",fontFamily:"monospace"},children:ae(rt.otherDebtors).replace("MYR ","")}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280"},children:[Vt.length," items"]})]}),o.jsxs("div",{style:{background:"rgba(239,68,68,0.1)",borderRadius:10,border:"1px solid rgba(239,68,68,0.3)",padding:10,position:"relative"},children:[o.jsxs("div",{style:{position:"absolute",top:6,right:6,display:"flex",gap:2},children:[o.jsx("button",{onClick:()=>Xo("xlsx"),title:"Export Excel",style:{padding:"2px 4px",background:"rgba(239,68,68,0.4)",border:"none",borderRadius:3,color:"#f87171",fontSize:8,cursor:"pointer"},children:"XLS"}),o.jsx("button",{onClick:()=>Xo("csv"),title:"Export CSV",style:{padding:"2px 4px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:3,color:"#f87171",fontSize:8,cursor:"pointer"},children:"CSV"})]}),o.jsx("div",{style:{fontSize:9,color:"#9ca3af"},children:"Trade Payables - GL 2600"}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#f87171",fontFamily:"monospace"},children:ae(rt.payables).replace("MYR ","")}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280"},children:[Nt.length," suppliers"]})]}),o.jsxs("div",{style:{background:"rgba(244,114,182,0.1)",borderRadius:10,border:"1px solid rgba(244,114,182,0.3)",padding:10,position:"relative"},children:[o.jsxs("div",{style:{position:"absolute",top:6,right:6,display:"flex",gap:2},children:[o.jsx("button",{onClick:()=>Ar("xlsx"),title:"Export Excel",style:{padding:"2px 4px",background:"rgba(244,114,182,0.4)",border:"none",borderRadius:3,color:"#f472b6",fontSize:8,cursor:"pointer"},children:"XLS"}),o.jsx("button",{onClick:()=>Ar("csv"),title:"Export CSV",style:{padding:"2px 4px",background:"rgba(244,114,182,0.2)",border:"none",borderRadius:3,color:"#f472b6",fontSize:8,cursor:"pointer"},children:"CSV"})]}),o.jsx("div",{style:{fontSize:9,color:"#9ca3af"},children:"Other Creditors - GL 2700"}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#f472b6",fontFamily:"monospace"},children:ae(rt.otherCreditors).replace("MYR ","")}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280"},children:[Or.length," items"]})]}),o.jsxs("div",{style:{background:"rgba(59,130,246,0.1)",borderRadius:10,border:"1px solid rgba(59,130,246,0.3)",padding:10,position:"relative"},children:[o.jsxs("div",{style:{position:"absolute",top:6,right:6,display:"flex",gap:2},children:[o.jsx("button",{onClick:()=>Di("xlsx"),title:"Export Excel",style:{padding:"2px 4px",background:"rgba(59,130,246,0.4)",border:"none",borderRadius:3,color:"#60a5fa",fontSize:8,cursor:"pointer"},children:"XLS"}),o.jsx("button",{onClick:()=>Di("csv"),title:"Export CSV",style:{padding:"2px 4px",background:"rgba(59,130,246,0.2)",border:"none",borderRadius:3,color:"#60a5fa",fontSize:8,cursor:"pointer"},children:"CSV"})]}),o.jsx("div",{style:{fontSize:9,color:"#9ca3af"},children:"Cash & Bank - GL 1900"}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#60a5fa",fontFamily:"monospace"},children:ae(rt.cashBank).replace("MYR ","")}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280"},children:[$a.length," accounts"]})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden",gridColumn:"span 2"},children:[o.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("span",{style:{fontWeight:700,fontSize:13},children:" PPE Register (Fixed Assets)"}),o.jsx("span",{style:{fontSize:9,color:"#9ca3af",background:"rgba(99,102,241,0.1)",padding:"2px 8px",borderRadius:4},children:"MFRS 116 Straight-Line Method"})]}),o.jsx("button",{onClick:h0,style:{padding:"4px 10px",background:"rgba(99,102,241,0.2)",border:"none",borderRadius:4,color:"#a5b4fc",fontSize:10,cursor:"pointer"},children:"+ Add Asset"})]}),o.jsx("div",{style:{padding:12,overflowX:"auto"},children:De.length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280",fontSize:11},children:'No assets registered. Click "+ Add Asset" to add.'}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 130px 70px 40px 60px 60px 60px 60px 20px",gap:4,padding:"6px 8px",background:"rgba(99,102,241,0.1)",borderRadius:4,fontSize:8,fontWeight:600,color:"#9ca3af",marginBottom:4,minWidth:700},children:[o.jsx("span",{children:"Description"}),o.jsx("span",{children:"Category"}),o.jsx("span",{style:{textAlign:"right"},children:"Cost"}),o.jsx("span",{style:{textAlign:"center"},children:"Life"}),o.jsx("span",{style:{textAlign:"right"},children:"Acc Dep B/F"}),o.jsx("span",{style:{textAlign:"right"},children:"Current Dep"}),o.jsx("span",{style:{textAlign:"right"},children:"Acc Dep C/F"}),o.jsx("span",{style:{textAlign:"right"},children:"NBV"}),o.jsx("span",{})]}),De.map((u,v)=>{const b=Ws(u),S=ge[u.category]||ge.OFFICE_EQUIPMENT;return o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 130px 70px 40px 60px 60px 60px 60px 20px",gap:4,padding:"4px 8px",background:v%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:9,minWidth:700},children:[o.jsx("input",{value:u.description,onChange:T=>Bl(u.id,"description",T.target.value),placeholder:"Asset name",style:{...ft,padding:"3px 6px",fontSize:9}}),o.jsx("select",{value:u.category,onChange:T=>Bl(u.id,"category",T.target.value),style:{...ft,padding:"3px 4px",fontSize:8,cursor:"pointer"},children:Object.entries(ge).map(([T,Q])=>o.jsxs("option",{value:T,children:[Q.label," (",Q.years>0?`${Q.years}yr`:"N/A",")"]},T))}),o.jsx("input",{type:"number",value:u.cost,onChange:T=>Bl(u.id,"cost",T.target.value),style:{...Ot,padding:"3px 4px",fontSize:9}}),o.jsx("span",{style:{textAlign:"center",fontSize:8,color:"#9ca3af"},children:S.years>0?`${S.years}yr`:"-"}),o.jsx("input",{type:"number",value:u.accDepBF,onChange:T=>Bl(u.id,"accDepBF",T.target.value),placeholder:"0",style:{...Ot,padding:"3px 4px",fontSize:9}}),o.jsx("span",{style:{fontFamily:"monospace",fontSize:9,color:"#fbbf24",textAlign:"right"},children:b.currentDep>0?ae(b.currentDep).replace("MYR ",""):"-"}),o.jsx("span",{style:{fontFamily:"monospace",fontSize:9,color:"#f87171",textAlign:"right"},children:ae(b.accDepCF).replace("MYR ","")}),o.jsx("span",{style:{fontFamily:"monospace",fontSize:9,color:"#34d399",textAlign:"right",fontWeight:600},children:ae(b.nbv).replace("MYR ","")}),o.jsx("button",{onClick:()=>Oo(u.id),style:{width:16,height:16,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:9},children:""})]},u.id)}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 130px 70px 40px 60px 60px 60px 60px 20px",gap:4,padding:"8px",background:"rgba(99,102,241,0.15)",borderRadius:4,marginTop:8,fontSize:9,fontWeight:700,minWidth:700},children:[o.jsx("span",{children:"TOTAL"}),o.jsx("span",{}),o.jsx("span",{style:{fontFamily:"monospace",textAlign:"right"},children:ae(rt.ppe.cost).replace("MYR ","")}),o.jsx("span",{}),o.jsx("span",{style:{fontFamily:"monospace",textAlign:"right"},children:ae(rt.ppe.accDepBF).replace("MYR ","")}),o.jsx("span",{style:{fontFamily:"monospace",color:"#fbbf24",textAlign:"right"},children:ae(rt.ppe.currentDep).replace("MYR ","")}),o.jsx("span",{style:{fontFamily:"monospace",color:"#f87171",textAlign:"right"},children:ae(rt.ppe.accDepCF).replace("MYR ","")}),o.jsx("span",{style:{fontFamily:"monospace",color:"#34d399",textAlign:"right"},children:ae(rt.ppe.nbv).replace("MYR ","")}),o.jsx("span",{})]}),o.jsxs("div",{style:{marginTop:12,padding:10,background:"rgba(17,24,39,0.4)",borderRadius:6},children:[o.jsx("div",{style:{fontSize:10,fontWeight:600,marginBottom:8,color:"#a5b4fc"},children:" Depreciation Summary by Category"}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:8},children:(()=>{const u={};return De.forEach(v=>{const b=v.category||"OFFICE_EQUIPMENT",S=Ws(v);u[b]||(u[b]={cost:0,currentDep:0,nbv:0,count:0}),u[b].cost+=parseFloat(v.cost)||0,u[b].currentDep+=S.currentDep,u[b].nbv+=S.nbv,u[b].count++}),Object.entries(u).map(([v,b])=>o.jsxs("div",{style:{background:"rgba(99,102,241,0.1)",padding:8,borderRadius:4},children:[o.jsx("div",{style:{fontSize:9,fontWeight:600,color:"#e5e7eb"},children:ge[v]?.label||v}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280"},children:[b.count," asset(s)  ",ge[v]?.years||0,"yr life"]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:4,fontSize:9},children:[o.jsx("span",{style:{color:"#9ca3af"},children:"Dep:"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#fbbf24"},children:ae(b.currentDep).replace("MYR ","")})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:9},children:[o.jsx("span",{style:{color:"#9ca3af"},children:"NBV:"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#34d399"},children:ae(b.nbv).replace("MYR ","")})]})]},v))})()})]})]})})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontWeight:700,fontSize:13},children:" Inventory Ledger"}),o.jsx("button",{onClick:g0,style:{padding:"4px 10px",background:"rgba(52,211,153,0.2)",border:"none",borderRadius:4,color:"#34d399",fontSize:10,cursor:"pointer"},children:"+ Add Item"})]}),o.jsx("div",{style:{padding:12,maxHeight:280,overflowY:"auto"},children:Xe.length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280",fontSize:11},children:'No inventory items. Click "+ Add Item" to add.'}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px 1fr 50px 60px 70px 20px",gap:4,padding:"4px 6px",background:"rgba(52,211,153,0.1)",borderRadius:4,fontSize:8,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Code"}),o.jsx("span",{children:"Description"}),o.jsx("span",{children:"Qty"}),o.jsx("span",{children:"Unit Cost"}),o.jsx("span",{children:"Total"}),o.jsx("span",{})]}),Xe.map((u,v)=>{const b=(parseFloat(u.qty)||0)*(parseFloat(u.unitCost)||0);return o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px 1fr 50px 60px 70px 20px",gap:4,padding:"4px 6px",background:v%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:9},children:[o.jsx("input",{value:u.itemCode,onChange:S=>Xs(u.id,"itemCode",S.target.value),placeholder:"SKU",style:{...ft,padding:"3px 6px",fontSize:9}}),o.jsx("input",{value:u.description,onChange:S=>Xs(u.id,"description",S.target.value),placeholder:"Item name",style:{...ft,padding:"3px 6px",fontSize:9}}),o.jsx("input",{type:"number",value:u.qty,onChange:S=>Xs(u.id,"qty",S.target.value),style:{...Ot,padding:"3px 4px",fontSize:9}}),o.jsx("input",{type:"number",value:u.unitCost,onChange:S=>Xs(u.id,"unitCost",S.target.value),style:{...Ot,padding:"3px 4px",fontSize:9}}),o.jsx("span",{style:{fontFamily:"monospace",fontSize:9,color:"#34d399"},children:ae(b).replace("MYR","")}),o.jsx("button",{onClick:()=>Mo(u.id),style:{width:16,height:16,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:9},children:""})]},u.id)}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px 1fr 50px 60px 70px 20px",gap:4,padding:"6px",background:"rgba(52,211,153,0.15)",borderRadius:4,marginTop:6,fontSize:9,fontWeight:700},children:[o.jsx("span",{}),o.jsx("span",{children:"TOTAL"}),o.jsx("span",{}),o.jsx("span",{}),o.jsx("span",{style:{fontFamily:"monospace",color:"#34d399"},children:ae(rt.inventory).replace("MYR","")}),o.jsx("span",{})]})]})})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontWeight:700,fontSize:13},children:" Trade Receivables (Debtors)"}),o.jsx("button",{onClick:cf,style:{padding:"4px 10px",background:"rgba(251,191,36,0.2)",border:"none",borderRadius:4,color:"#fbbf24",fontSize:10,cursor:"pointer"},children:"+ Add Customer"})]}),o.jsx("div",{style:{padding:12,maxHeight:280,overflowY:"auto"},children:We.length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280",fontSize:11},children:'No receivables. Click "+ Add Customer" to add.'}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 60px 70px 60px 60px 20px",gap:4,padding:"4px 6px",background:"rgba(251,191,36,0.1)",borderRadius:4,fontSize:8,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Customer"}),o.jsx("span",{children:"Invoice"}),o.jsx("span",{children:"Amount"}),o.jsx("span",{children:"Paid"}),o.jsx("span",{children:"Balance"}),o.jsx("span",{})]}),We.map((u,v)=>{const b=(parseFloat(u.amount)||0)-(parseFloat(u.paid)||0);return o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 60px 70px 60px 60px 20px",gap:4,padding:"4px 6px",background:v%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:9},children:[o.jsx("input",{value:u.customerName,onChange:S=>Pl(u.id,"customerName",S.target.value),placeholder:"Customer",style:{...ft,padding:"3px 6px",fontSize:9}}),o.jsx("input",{value:u.invoiceNo,onChange:S=>Pl(u.id,"invoiceNo",S.target.value),placeholder:"INV#",style:{...ft,padding:"3px 6px",fontSize:9}}),o.jsx("input",{type:"number",value:u.amount,onChange:S=>Pl(u.id,"amount",S.target.value),style:{...Ot,padding:"3px 4px",fontSize:9}}),o.jsx("input",{type:"number",value:u.paid,onChange:S=>Pl(u.id,"paid",S.target.value),style:{...Ot,padding:"3px 4px",fontSize:9}}),o.jsx("span",{style:{fontFamily:"monospace",fontSize:9,color:b>0?"#fbbf24":"#34d399"},children:ae(b).replace("MYR","")}),o.jsx("button",{onClick:()=>zl(u.id),style:{width:16,height:16,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:9},children:""})]},u.id)}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 60px 70px 60px 60px 20px",gap:4,padding:"6px",background:"rgba(251,191,36,0.15)",borderRadius:4,marginTop:6,fontSize:9,fontWeight:700},children:[o.jsx("span",{children:"TOTAL"}),o.jsx("span",{}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(We.reduce((u,v)=>u+(parseFloat(v.amount)||0),0)).replace("MYR","")}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(We.reduce((u,v)=>u+(parseFloat(v.paid)||0),0)).replace("MYR","")}),o.jsx("span",{style:{fontFamily:"monospace",color:"#fbbf24"},children:ae(rt.receivables).replace("MYR","")}),o.jsx("span",{})]})]})})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontWeight:700,fontSize:13},children:" Trade Payables (Creditors)"}),o.jsx("button",{onClick:qn,style:{padding:"4px 10px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:"+ Add Supplier"})]}),o.jsx("div",{style:{padding:12,maxHeight:280,overflowY:"auto"},children:Nt.length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280",fontSize:11},children:'No payables. Click "+ Add Supplier" to add.'}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 60px 70px 60px 60px 20px",gap:4,padding:"4px 6px",background:"rgba(239,68,68,0.1)",borderRadius:4,fontSize:8,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Supplier"}),o.jsx("span",{children:"Invoice"}),o.jsx("span",{children:"Amount"}),o.jsx("span",{children:"Paid"}),o.jsx("span",{children:"Balance"}),o.jsx("span",{})]}),Nt.map((u,v)=>{const b=(parseFloat(u.amount)||0)-(parseFloat(u.paid)||0);return o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 60px 70px 60px 60px 20px",gap:4,padding:"4px 6px",background:v%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:9},children:[o.jsx("input",{value:u.supplierName,onChange:S=>ls(u.id,"supplierName",S.target.value),placeholder:"Supplier",style:{...ft,padding:"3px 6px",fontSize:9}}),o.jsx("input",{value:u.invoiceNo,onChange:S=>ls(u.id,"invoiceNo",S.target.value),placeholder:"INV#",style:{...ft,padding:"3px 6px",fontSize:9}}),o.jsx("input",{type:"number",value:u.amount,onChange:S=>ls(u.id,"amount",S.target.value),style:{...Ot,padding:"3px 4px",fontSize:9}}),o.jsx("input",{type:"number",value:u.paid,onChange:S=>ls(u.id,"paid",S.target.value),style:{...Ot,padding:"3px 4px",fontSize:9}}),o.jsx("span",{style:{fontFamily:"monospace",fontSize:9,color:b>0?"#f87171":"#34d399"},children:ae(b).replace("MYR","")}),o.jsx("button",{onClick:()=>Lo(u.id),style:{width:16,height:16,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:9},children:""})]},u.id)}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 60px 70px 60px 60px 20px",gap:4,padding:"6px",background:"rgba(239,68,68,0.15)",borderRadius:4,marginTop:6,fontSize:9,fontWeight:700},children:[o.jsx("span",{children:"TOTAL"}),o.jsx("span",{}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(Nt.reduce((u,v)=>u+(parseFloat(v.amount)||0),0)).replace("MYR","")}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(Nt.reduce((u,v)=>u+(parseFloat(v.paid)||0),0)).replace("MYR","")}),o.jsx("span",{style:{fontFamily:"monospace",color:"#f87171"},children:ae(rt.payables).replace("MYR","")}),o.jsx("span",{})]})]})})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:16,marginTop:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontWeight:700,fontSize:13},children:" Other Debtors"}),o.jsx("button",{onClick:os,style:{padding:"4px 10px",background:"rgba(139,92,246,0.2)",border:"none",borderRadius:4,color:"#c084fc",fontSize:10,cursor:"pointer"},children:"+ Add"})]}),o.jsx("div",{style:{padding:12,maxHeight:250,overflowY:"auto"},children:Vt.length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280",fontSize:11},children:'No items. Click "+ Add" to add deposits, prepayments, etc.'}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 70px 20px",gap:4,padding:"4px 6px",background:"rgba(139,92,246,0.1)",borderRadius:4,fontSize:8,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Description"}),o.jsx("span",{children:"Type"}),o.jsx("span",{style:{textAlign:"right"},children:"Amount"}),o.jsx("span",{})]}),Vt.map((u,v)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 70px 20px",gap:4,padding:"4px 6px",background:v%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:9},children:[o.jsx("input",{value:u.description,onChange:b=>pi(u.id,"description",b.target.value),placeholder:"Description",style:{...ft,padding:"3px 6px",fontSize:9}}),o.jsxs("select",{value:u.type,onChange:b=>pi(u.id,"type",b.target.value),style:{...ft,padding:"3px 4px",fontSize:8,cursor:"pointer"},children:[o.jsx("option",{value:"DEPOSIT",children:"Deposit"}),o.jsx("option",{value:"PREPAID",children:"Prepaid"}),o.jsx("option",{value:"ADVANCE",children:"Advance"}),o.jsx("option",{value:"OTHER",children:"Other"})]}),o.jsx("input",{type:"number",value:u.amount,onChange:b=>pi(u.id,"amount",b.target.value),style:{...Ot,padding:"3px 4px",fontSize:9}}),o.jsx("button",{onClick:()=>x0(u.id),style:{width:16,height:16,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:9},children:""})]},u.id)),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 70px 20px",gap:4,padding:"6px",background:"rgba(139,92,246,0.15)",borderRadius:4,marginTop:6,fontSize:9,fontWeight:700},children:[o.jsx("span",{children:"TOTAL"}),o.jsx("span",{}),o.jsx("span",{style:{fontFamily:"monospace",color:"#c084fc",textAlign:"right"},children:ae(rt.otherDebtors).replace("MYR","")}),o.jsx("span",{})]})]})})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontWeight:700,fontSize:13},children:" Other Creditors"}),o.jsx("button",{onClick:Po,style:{padding:"4px 10px",background:"rgba(244,114,182,0.2)",border:"none",borderRadius:4,color:"#f472b6",fontSize:10,cursor:"pointer"},children:"+ Add"})]}),o.jsx("div",{style:{padding:12,maxHeight:250,overflowY:"auto"},children:Or.length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280",fontSize:11},children:'No items. Click "+ Add" to add accruals, deposits received, etc.'}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 70px 20px",gap:4,padding:"4px 6px",background:"rgba(244,114,182,0.1)",borderRadius:4,fontSize:8,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Description"}),o.jsx("span",{children:"Type"}),o.jsx("span",{style:{textAlign:"right"},children:"Amount"}),o.jsx("span",{})]}),Or.map((u,v)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 70px 20px",gap:4,padding:"4px 6px",background:v%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:9},children:[o.jsx("input",{value:u.description,onChange:b=>Ul(u.id,"description",b.target.value),placeholder:"Description",style:{...ft,padding:"3px 6px",fontSize:9}}),o.jsxs("select",{value:u.type,onChange:b=>Ul(u.id,"type",b.target.value),style:{...ft,padding:"3px 4px",fontSize:8,cursor:"pointer"},children:[o.jsx("option",{value:"ACCRUAL",children:"Accrual"}),o.jsx("option",{value:"DEPOSIT_RECEIVED",children:"Deposit Received"}),o.jsx("option",{value:"ADVANCE_RECEIVED",children:"Advance Received"}),o.jsx("option",{value:"OTHER",children:"Other"})]}),o.jsx("input",{type:"number",value:u.amount,onChange:b=>Ul(u.id,"amount",b.target.value),style:{...Ot,padding:"3px 4px",fontSize:9}}),o.jsx("button",{onClick:()=>qs(u.id),style:{width:16,height:16,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:9},children:""})]},u.id)),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 70px 20px",gap:4,padding:"6px",background:"rgba(244,114,182,0.15)",borderRadius:4,marginTop:6,fontSize:9,fontWeight:700},children:[o.jsx("span",{children:"TOTAL"}),o.jsx("span",{}),o.jsx("span",{style:{fontFamily:"monospace",color:"#f472b6",textAlign:"right"},children:ae(rt.otherCreditors).replace("MYR","")}),o.jsx("span",{})]})]})})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontWeight:700,fontSize:13},children:" Cash & Bank"}),o.jsx("button",{onClick:Kn,style:{padding:"4px 10px",background:"rgba(59,130,246,0.2)",border:"none",borderRadius:4,color:"#60a5fa",fontSize:10,cursor:"pointer"},children:"+ Add Account"})]}),o.jsx("div",{style:{padding:12,maxHeight:250,overflowY:"auto"},children:$a.length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280",fontSize:11},children:'No accounts. Click "+ Add Account" to add bank accounts.'}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 70px 70px 20px",gap:4,padding:"4px 6px",background:"rgba(59,130,246,0.1)",borderRadius:4,fontSize:8,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Account Name"}),o.jsx("span",{style:{textAlign:"right"},children:"Opening"}),o.jsx("span",{style:{textAlign:"right"},children:"Closing"}),o.jsx("span",{})]}),$a.map((u,v)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 70px 70px 20px",gap:4,padding:"4px 6px",background:v%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:9},children:[o.jsx("input",{value:u.accountName,onChange:b=>Ks(u.id,"accountName",b.target.value),placeholder:"Account name",style:{...ft,padding:"3px 6px",fontSize:9}}),o.jsx("input",{type:"number",value:u.openingBalance,onChange:b=>Ks(u.id,"openingBalance",b.target.value),style:{...Ot,padding:"3px 4px",fontSize:9}}),o.jsx("input",{type:"number",value:u.closingBalance,onChange:b=>Ks(u.id,"closingBalance",b.target.value),style:{...Ot,padding:"3px 4px",fontSize:9}}),o.jsx("button",{onClick:()=>Js(u.id),style:{width:16,height:16,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:9},children:""})]},u.id)),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 70px 70px 20px",gap:4,padding:"6px",background:"rgba(59,130,246,0.15)",borderRadius:4,marginTop:6,fontSize:9,fontWeight:700},children:[o.jsx("span",{children:"TOTAL"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#9ca3af",textAlign:"right"},children:ae($a.reduce((u,v)=>u+(parseFloat(v.openingBalance)||0),0)).replace("MYR","")}),o.jsx("span",{style:{fontFamily:"monospace",color:"#60a5fa",textAlign:"right"},children:ae(rt.cashBank).replace("MYR","")}),o.jsx("span",{})]})]})})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginTop:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontWeight:700,fontSize:13},children:" Short-Term Borrowings"}),o.jsx("button",{onClick:hi,style:{padding:"4px 10px",background:"rgba(251,146,60,0.2)",border:"none",borderRadius:4,color:"#fb923c",fontSize:10,cursor:"pointer"},children:"+ Add Loan"})]}),o.jsx("div",{style:{padding:12,maxHeight:280,overflowY:"auto"},children:ya.length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280",fontSize:11},children:'No short-term borrowings. Click "+ Add Loan" to add overdraft, short-term loans, etc.'}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 65px 65px 65px 20px",gap:4,padding:"4px 6px",background:"rgba(251,146,60,0.1)",borderRadius:4,fontSize:8,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Lender"}),o.jsx("span",{children:"Type"}),o.jsx("span",{style:{textAlign:"right"},children:"Opening"}),o.jsx("span",{style:{textAlign:"right"},children:"Drawdown"}),o.jsx("span",{style:{textAlign:"right"},children:"Repaid"}),o.jsx("span",{})]}),ya.map((u,v)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 65px 65px 65px 20px",gap:4,padding:"4px 6px",background:v%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:9},children:[o.jsx("input",{value:u.lender,onChange:b=>Ni(u.id,"lender",b.target.value),placeholder:"Lender name",style:{...ft,padding:"3px 6px",fontSize:9}}),o.jsxs("select",{value:u.loanType,onChange:b=>Ni(u.id,"loanType",b.target.value),style:{...ft,padding:"3px 4px",fontSize:8,cursor:"pointer"},children:[o.jsx("option",{value:"BANK_OVERDRAFT",children:"Overdraft"}),o.jsx("option",{value:"SHORT_TERM_LOAN",children:"ST Loan"}),o.jsx("option",{value:"HP_CURRENT",children:"HP (Current)"}),o.jsx("option",{value:"TRADE_FINANCING",children:"Trade Finance"}),o.jsx("option",{value:"OTHER",children:"Other"})]}),o.jsx("input",{type:"number",value:u.openingBalance,onChange:b=>Ni(u.id,"openingBalance",b.target.value),placeholder:"0",style:{...Ot,padding:"3px 4px",fontSize:9}}),o.jsx("input",{type:"number",value:u.drawdown,onChange:b=>Ni(u.id,"drawdown",b.target.value),placeholder:"0",style:{...Ot,padding:"3px 4px",fontSize:9,background:"rgba(74,222,128,0.1)"}}),o.jsx("input",{type:"number",value:u.repayment,onChange:b=>Ni(u.id,"repayment",b.target.value),placeholder:"0",style:{...Ot,padding:"3px 4px",fontSize:9,background:"rgba(248,113,113,0.1)"}}),o.jsx("button",{onClick:()=>Hl(u.id),style:{width:16,height:16,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:9},children:""})]},u.id)),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 65px 65px 65px 20px",gap:4,padding:"6px",background:"rgba(251,146,60,0.15)",borderRadius:4,marginTop:6,fontSize:9,fontWeight:700},children:[o.jsx("span",{children:"TOTAL"}),o.jsx("span",{}),o.jsx("span",{style:{fontFamily:"monospace",color:"#9ca3af",textAlign:"right"},children:ae(rt.stBorrOpening||0).replace("MYR","")}),o.jsx("span",{style:{fontFamily:"monospace",color:"#4ade80",textAlign:"right"},children:ae(ya.reduce((u,v)=>u+(parseFloat(v.drawdown)||0),0)).replace("MYR","")}),o.jsx("span",{style:{fontFamily:"monospace",color:"#f87171",textAlign:"right"},children:ae(ya.reduce((u,v)=>u+(parseFloat(v.repayment)||0),0)).replace("MYR","")}),o.jsx("span",{})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 6px",background:"rgba(251,146,60,0.25)",borderRadius:4,marginTop:4,fontSize:10,fontWeight:700},children:[o.jsx("span",{children:"Closing Balance:"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#fb923c"},children:ae(rt.shortTermBorrowings||0)})]})]})})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontWeight:700,fontSize:13},children:" Long-Term Borrowings"}),o.jsx("button",{onClick:m0,style:{padding:"4px 10px",background:"rgba(168,85,247,0.2)",border:"none",borderRadius:4,color:"#a855f7",fontSize:10,cursor:"pointer"},children:"+ Add Loan"})]}),o.jsx("div",{style:{padding:12,maxHeight:280,overflowY:"auto"},children:Ga.length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280",fontSize:11},children:'No long-term borrowings. Click "+ Add Loan" to add term loans, HP, mortgages, etc.'}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 65px 65px 65px 20px",gap:4,padding:"4px 6px",background:"rgba(168,85,247,0.1)",borderRadius:4,fontSize:8,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Lender"}),o.jsx("span",{children:"Type"}),o.jsx("span",{style:{textAlign:"right"},children:"Opening"}),o.jsx("span",{style:{textAlign:"right"},children:"Drawdown"}),o.jsx("span",{style:{textAlign:"right"},children:"Repaid"}),o.jsx("span",{})]}),Ga.map((u,v)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 65px 65px 65px 20px",gap:4,padding:"4px 6px",background:v%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:9},children:[o.jsx("input",{value:u.lender,onChange:b=>gi(u.id,"lender",b.target.value),placeholder:"Lender name",style:{...ft,padding:"3px 6px",fontSize:9}}),o.jsxs("select",{value:u.loanType,onChange:b=>gi(u.id,"loanType",b.target.value),style:{...ft,padding:"3px 4px",fontSize:8,cursor:"pointer"},children:[o.jsx("option",{value:"TERM_LOAN",children:"Term Loan"}),o.jsx("option",{value:"HIRE_PURCHASE",children:"Hire Purchase"}),o.jsx("option",{value:"MORTGAGE",children:"Mortgage"}),o.jsx("option",{value:"DIRECTORS_LOAN",children:"Directors Loan"}),o.jsx("option",{value:"RELATED_PARTY_LOAN",children:"Related Party"}),o.jsx("option",{value:"OTHER",children:"Other"})]}),o.jsx("input",{type:"number",value:u.openingBalance,onChange:b=>gi(u.id,"openingBalance",b.target.value),placeholder:"0",style:{...Ot,padding:"3px 4px",fontSize:9}}),o.jsx("input",{type:"number",value:u.drawdown,onChange:b=>gi(u.id,"drawdown",b.target.value),placeholder:"0",style:{...Ot,padding:"3px 4px",fontSize:9,background:"rgba(74,222,128,0.1)"}}),o.jsx("input",{type:"number",value:u.repayment,onChange:b=>gi(u.id,"repayment",b.target.value),placeholder:"0",style:{...Ot,padding:"3px 4px",fontSize:9,background:"rgba(248,113,113,0.1)"}}),o.jsx("button",{onClick:()=>$l(u.id),style:{width:16,height:16,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:9},children:""})]},u.id)),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 65px 65px 65px 20px",gap:4,padding:"6px",background:"rgba(168,85,247,0.15)",borderRadius:4,marginTop:6,fontSize:9,fontWeight:700},children:[o.jsx("span",{children:"TOTAL"}),o.jsx("span",{}),o.jsx("span",{style:{fontFamily:"monospace",color:"#9ca3af",textAlign:"right"},children:ae(rt.ltBorrOpening||0).replace("MYR","")}),o.jsx("span",{style:{fontFamily:"monospace",color:"#4ade80",textAlign:"right"},children:ae(Ga.reduce((u,v)=>u+(parseFloat(v.drawdown)||0),0)).replace("MYR","")}),o.jsx("span",{style:{fontFamily:"monospace",color:"#f87171",textAlign:"right"},children:ae(Ga.reduce((u,v)=>u+(parseFloat(v.repayment)||0),0)).replace("MYR","")}),o.jsx("span",{})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 6px",background:"rgba(168,85,247,0.25)",borderRadius:4,marginTop:4,fontSize:10,fontWeight:700},children:[o.jsx("span",{children:"Closing Balance:"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#a855f7"},children:ae(rt.longTermBorrowings||0)})]})]})})]})]}),o.jsxs("div",{style:{marginTop:16,padding:16,background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)"},children:[o.jsx("div",{style:{fontWeight:700,fontSize:13,marginBottom:12},children:" Subledger to GL Reconciliation"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:4},children:"PPE (NBV)"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"Subledger:"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#a5b4fc"},children:ae(rt.ppe.nbv)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"GL (Opening):"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#9ca3af"},children:ae((parseFloat(le.fixed_asset)||0)-Math.abs(parseFloat(le.accumulated_depreciation)||0))})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11,fontWeight:700,marginTop:4,paddingTop:4,borderTop:"1px solid rgba(75,85,99,0.3)"},children:[o.jsx("span",{children:"Diff:"}),(()=>{const u=(parseFloat(le.fixed_asset)||0)-Math.abs(parseFloat(le.accumulated_depreciation)||0),v=rt.ppe.nbv-u;return o.jsx("span",{style:{fontFamily:"monospace",color:Math.abs(v)<1?"#34d399":"#fbbf24"},children:ae(v)})})()]})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:4},children:"Inventory"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"Subledger:"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#34d399"},children:ae(rt.inventory)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"GL (Opening):"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#9ca3af"},children:ae(parseFloat(le.inventory)||0)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11,fontWeight:700,marginTop:4,paddingTop:4,borderTop:"1px solid rgba(75,85,99,0.3)"},children:[o.jsx("span",{children:"Diff:"}),o.jsx("span",{style:{fontFamily:"monospace",color:Math.abs(rt.inventory-(parseFloat(le.inventory)||0))<1?"#34d399":"#fbbf24"},children:ae(rt.inventory-(parseFloat(le.inventory)||0))})]})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:4},children:"Trade Receivables"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"Subledger:"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#fbbf24"},children:ae(rt.receivables)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"GL (Opening):"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#9ca3af"},children:ae(parseFloat(le.trade_receivables)||0)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11,fontWeight:700,marginTop:4,paddingTop:4,borderTop:"1px solid rgba(75,85,99,0.3)"},children:[o.jsx("span",{children:"Diff:"}),o.jsx("span",{style:{fontFamily:"monospace",color:Math.abs(rt.receivables-(parseFloat(le.trade_receivables)||0))<1?"#34d399":"#fbbf24"},children:ae(rt.receivables-(parseFloat(le.trade_receivables)||0))})]})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:4},children:"Trade Payables"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"Subledger:"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#f87171"},children:ae(rt.payables)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"GL (Opening):"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#9ca3af"},children:ae(Math.abs(parseFloat(le.trade_payables)||0))})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11,fontWeight:700,marginTop:4,paddingTop:4,borderTop:"1px solid rgba(75,85,99,0.3)"},children:[o.jsx("span",{children:"Diff:"}),o.jsx("span",{style:{fontFamily:"monospace",color:Math.abs(rt.payables-Math.abs(parseFloat(le.trade_payables)||0))<1?"#34d399":"#fbbf24"},children:ae(rt.payables-Math.abs(parseFloat(le.trade_payables)||0))})]})]})]})]}),o.jsxs("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:16},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:4},children:"Short-Term Borrowings"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"Subledger (Closing):"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#fb923c"},children:ae(rt.shortTermBorrowings||0)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"Opening Balance:"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#9ca3af"},children:ae(rt.stBorrOpening||0)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11,fontWeight:700,marginTop:4,paddingTop:4,borderTop:"1px solid rgba(75,85,99,0.3)"},children:[o.jsx("span",{children:"Net Movement:"}),(()=>{const u=(rt.shortTermBorrowings||0)-(rt.stBorrOpening||0);return o.jsx("span",{style:{fontFamily:"monospace",color:Math.abs(u)<1?"#34d399":"#fbbf24"},children:ae(u)})})()]})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:4},children:"Long-Term Borrowings"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"Subledger (Closing):"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#a855f7"},children:ae(rt.longTermBorrowings||0)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"Opening Balance:"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#9ca3af"},children:ae(rt.ltBorrOpening||0)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11,fontWeight:700,marginTop:4,paddingTop:4,borderTop:"1px solid rgba(75,85,99,0.3)"},children:[o.jsx("span",{children:"Net Movement:"}),(()=>{const u=(rt.longTermBorrowings||0)-(rt.ltBorrOpening||0);return o.jsx("span",{style:{fontFamily:"monospace",color:Math.abs(u)<1?"#34d399":"#fbbf24"},children:ae(u)})})()]})]})]}),o.jsx("div",{style:{marginTop:16,padding:12,background:"rgba(99,102,241,0.1)",borderRadius:8,border:"1px solid rgba(99,102,241,0.2)"},children:o.jsxs("div",{style:{fontSize:11,color:"#a5b4fc"},children:[" ",o.jsx("strong",{children:"Subledger Reconciliation"}),": Compares subledger totals (CY closing) with GL opening balances (PY closing). The difference represents ",o.jsx("strong",{children:"movement during the year"}),". Green = no movement or matched, Yellow = movement exists (verify against transactions). For PPE, difference includes depreciation impact."]})})]}),e==="balances"&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("button",{onClick:or,style:lr,children:" Subledger"}),o.jsx("span",{style:{fontSize:12,color:"#9ca3af"},children:"Set opening balances, then generate FS"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",fontWeight:700,fontSize:14},children:"Opening Balances"}),o.jsxs("div",{style:{padding:16},children:[o.jsxs("div",{style:{display:"flex",gap:6,marginBottom:10},children:[o.jsx("input",{placeholder:"Account",value:de.acc,onChange:u=>_e(v=>({...v,acc:u.target.value})),style:{...ft,flex:1}}),o.jsx("input",{type:"number",placeholder:"Amount",value:de.amt,onChange:u=>_e(v=>({...v,amt:u.target.value})),style:{...ft,width:100}}),o.jsx("button",{onClick:gf,style:{padding:"6px 12px",background:"linear-gradient(135deg, #6366f1, #4f46e5)",border:"none",borderRadius:6,color:"#fff",fontWeight:700,cursor:"pointer"},children:"+"})]}),Object.keys(le).length===0?o.jsx("div",{style:{padding:16,textAlign:"center",color:"#6b7280",fontSize:12},children:'No balances. Use "Prior FS" tab.'}):o.jsx("div",{style:{maxHeight:200,overflowY:"auto"},children:Object.entries(le).map(([u,v],b)=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"6px 8px",background:b%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,fontSize:11},children:[o.jsx("span",{style:{textTransform:"capitalize"},children:u.replace(/_/g," ")}),o.jsx("span",{style:{fontFamily:"monospace",fontWeight:600,color:v>=0?"#34d399":"#f87171"},children:ae(v)})]},u))})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",fontWeight:700,fontSize:14},children:"Generate"}),o.jsxs("div",{style:{padding:16},children:[[["Banks",Ut.length],["Transactions",_.length],["Opening Balances",Object.keys(le).length],["Suspense",_.filter(u=>cn.classify(u.description).code==="SUSPENSE").length]].map(([u,v],b)=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid rgba(75,85,99,0.15)",fontSize:12},children:[o.jsx("span",{children:u}),o.jsx("span",{style:{fontWeight:600},children:v})]},b)),o.jsx("button",{onClick:b0,disabled:!_.length||ue,style:{width:"100%",marginTop:16,padding:"12px",background:_.length?"linear-gradient(135deg, #8b5cf6, #7c3aed)":"rgba(75,85,99,0.3)",border:"none",borderRadius:8,color:"#fff",fontSize:14,fontWeight:700,cursor:_.length?"pointer":"not-allowed"},children:ue?" Processing...":" Generate FS"})]})]})]})]}),e==="journal"&&m&&o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("button",{onClick:or,style:lr,children:" Back"}),o.jsx("span",{style:{fontWeight:700,fontSize:14},children:"Journal Entries"}),o.jsx("span",{style:{background:"rgba(52,211,153,0.2)",color:"#34d399",padding:"2px 8px",borderRadius:8,fontSize:10,fontWeight:600},children:m.jes.length}),o.jsxs("span",{style:{fontSize:9,color:"#6b7280"},children:["(Bank: ",m.jes.filter(u=>u.source!=="Cash").length," | Cash: ",m.jes.filter(u=>u.source==="Cash").length,")"]})]}),o.jsx("button",{onClick:_r,style:ja,children:"Trial Balance "})]}),o.jsx("div",{style:{padding:12,maxHeight:450,overflowY:"auto"},children:m.jes.map((u,v)=>o.jsxs("div",{style:{marginBottom:8,background:"rgba(17,24,39,0.4)",borderRadius:6,border:u.source==="Cash"?"1px solid rgba(251,191,36,0.3)":"1px solid rgba(75,85,99,0.2)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"6px 10px",borderBottom:"1px solid rgba(75,85,99,0.15)",display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:10},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[o.jsxs("span",{style:{background:"rgba(99,102,241,0.2)",color:"#a5b4fc",padding:"1px 5px",borderRadius:3,fontSize:8,fontFamily:"monospace"},children:["JE-",String(v+1).padStart(3,"0")]}),u.ref&&o.jsx("span",{style:{background:"rgba(251,191,36,0.2)",color:"#fbbf24",padding:"1px 5px",borderRadius:3,fontSize:8},children:u.ref}),o.jsx("span",{style:{color:"#9ca3af",fontSize:9},children:u.date}),o.jsx("span",{style:{background:u.source==="Cash"?"rgba(251,191,36,0.2)":"rgba(99,102,241,0.1)",color:u.source==="Cash"?"#fbbf24":"#6b7280",padding:"1px 4px",borderRadius:3,fontSize:8},children:u.source==="Cash"?" Cash":` ${u.bank}`}),o.jsx("span",{children:u.desc.substring(0,35)})]}),o.jsx("span",{style:{background:"rgba(139,92,246,0.2)",color:"#c4b5fd",padding:"1px 6px",borderRadius:3,fontSize:8,fontWeight:600},children:u.cls})]}),o.jsx("div",{style:{padding:"4px 10px"},children:u.entries.map((b,S)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"130px 1fr 1fr",padding:"2px 0",fontSize:10},children:[o.jsx("span",{style:{paddingLeft:b.dr>0?0:12,textTransform:"capitalize"},children:b.acc.replace(/_/g," ")}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:b.dr>0?"#e5e7eb":"#6b7280"},children:b.dr>0?ae(b.dr):"-"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:b.cr>0?"#e5e7eb":"#6b7280"},children:b.cr>0?ae(b.cr):"-"})]},S))})]},v))})]}),e==="trial"&&m&&o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("button",{onClick:or,style:lr,children:" Back"}),o.jsx("span",{style:{fontWeight:700,fontSize:14},children:"Trial Balance"})]}),o.jsxs("div",{style:{display:"flex",gap:8},children:[o.jsx("button",{onClick:()=>Ko("xlsx"),style:{padding:"6px 12px",background:"linear-gradient(135deg, #7c3aed, #8b5cf6)",border:"none",borderRadius:6,color:"#fff",fontSize:11,cursor:"pointer",fontWeight:600},children:" Export TB (Excel)"}),o.jsx("button",{onClick:()=>Ko("csv"),style:{padding:"6px 12px",background:"rgba(124,58,237,0.3)",border:"1px solid rgba(139,92,246,0.5)",borderRadius:6,color:"#c4b5fd",fontSize:11,cursor:"pointer",fontWeight:600},children:" Export TB (CSV)"}),o.jsx("button",{onClick:_r,style:ja,children:"Income Statement "})]})]}),o.jsxs("div",{style:{padding:12},children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px repeat(5, 1fr)",padding:"6px 10px",background:"rgba(99,102,241,0.1)",borderRadius:4,fontSize:9,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Account"}),o.jsx("span",{style:{textAlign:"right"},children:"Opening"}),o.jsx("span",{style:{textAlign:"right"},children:"Debit"}),o.jsx("span",{style:{textAlign:"right"},children:"Credit"}),o.jsx("span",{style:{textAlign:"right"},children:"Closing"}),o.jsx("span",{style:{textAlign:"right"},children:"Dr/Cr"})]}),m.tb.map((u,v)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px repeat(5, 1fr)",padding:"5px 10px",background:v%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,fontSize:10},children:[o.jsx("span",{style:{textTransform:"capitalize"},children:u.acc.replace(/_/g," ")}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:ae(u.op)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(u.dr)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(u.cr)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",fontWeight:600,color:u.cl>=0?"#34d399":"#f87171"},children:ae(Math.abs(u.cl))}),o.jsx("span",{style:{textAlign:"right",fontSize:8,fontWeight:600,color:u.cl>=0?"#a5b4fc":"#f9a8d4"},children:u.cl>=0?"DR":"CR"})]},u.acc))]})]}),e==="income"&&m&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("button",{onClick:or,style:lr,children:" Trial Balance"}),o.jsx("button",{onClick:_r,style:ja,children:"Balance Sheet "})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 320px",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(52,211,153,0.1), rgba(99,102,241,0.1))"},children:[o.jsx("div",{style:{fontWeight:700,fontSize:14},children:s||"Company Name"}),o.jsx("div",{style:{fontWeight:600,fontSize:12,color:"#a5b4fc",marginTop:2},children:"Statement of Profit or Loss"}),o.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginTop:4},children:["For the financial year ended ",Lt,"  ",sa?.standard]})]}),o.jsxs("div",{style:{padding:16},children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 110px 110px",padding:"8px 12px",background:"rgba(99,102,241,0.1)",borderRadius:6,marginBottom:8},children:[o.jsx("span",{style:{fontSize:10,fontWeight:600}}),o.jsx("span",{style:{fontSize:10,fontWeight:600,textAlign:"right"},children:L}),o.jsx("span",{style:{fontSize:10,fontWeight:600,textAlign:"right",color:"#9ca3af"},children:fe})]}),(()=>{const u=[],v=m.is.details||{},b=(me,qe)=>me!==0&&me!==null||qe!==0&&qe!==null,S=G.filter(me=>me.section==="revenue"||me.type==="revenue");let T=!1;S.forEach(me=>{const qe=parseFloat(me.value)||0,Ye=v[me.id]||0;b(Ye,qe)&&(u.push({l:me.label,cy:Ye,py:qe}),T=!0)}),(T||b(m.is.rev,at.revenue))&&(!T&&b(m.is.rev,at.revenue)?u.push({l:"Revenue",cy:m.is.rev,py:at.revenue}):T&&u.push({l:"Total Revenue",cy:m.is.rev,py:at.revenue,b:!0}));const Q=G.filter(me=>me.section==="cost_of_sales"||me.type==="cogs");let j=!1;Q.forEach(me=>{const qe=parseFloat(me.value)||0,Ye=v[me.id]||0;b(Ye,qe)&&(u.push({l:me.label,cy:-Ye,py:-qe}),j=!0)}),(j||b(m.is.cos,at.cos))&&(!j&&b(m.is.cos,at.cos)?u.push({l:"Cost of Sales",cy:-m.is.cos,py:-at.cos}):j&&u.push({l:"Total Cost of Sales",cy:-m.is.cos,py:-at.cos,b:!0})),(b(m.is.rev,at.revenue)||b(m.is.cos,at.cos))&&u.push({l:"Gross Profit",cy:m.is.gp,py:at.gp,b:!0,h:!0});const C=G.filter(me=>me.section==="operating_expenses"||me.type==="expense");let M=!1,X=0;const ye=[];C.forEach(me=>{const qe=parseFloat(me.value)||0;X+=qe;const Ye=v[me.id]||0;if(b(Ye,qe)){const ot=me.id==="DEPRECIATION";ye.push({l:`  - ${me.label}`,cy:ot?-(m.is.dep||Ye):-Ye,py:-qe,indent:!0,dep:ot}),M=!0}}),(M||b(m.is.adm,X))&&(u.push({l:"Operating Expenses:",cy:null,py:null,sub:!0}),u.push(...ye),u.push({l:"Total Operating Expenses",cy:-m.is.adm,py:-X,b:!0})),b(m.is.op,at.op)&&u.push({l:"Operating Profit",cy:m.is.op,py:at.op||0,b:!0,h:!0});const Fe=G.filter(me=>me.section==="other_income"||me.type==="other_income");let Ce=!1;Fe.forEach(me=>{const qe=parseFloat(me.value)||0,Ye=v[me.id]||0;b(Ye,qe)&&(u.push({l:me.label,cy:Ye,py:qe}),Ce=!0)}),Ce?u.push({l:"Total Other Income",cy:m.is.oi,py:at.oi,b:!0}):b(m.is.oi,at.oi)&&u.push({l:"Other Income",cy:m.is.oi,py:at.oi});const J=G.filter(me=>me.section==="other_expenses"||me.type==="other_expense");let Y=!1;J.forEach(me=>{const qe=parseFloat(me.value)||0,Ye=v[me.id]||0;b(Ye,qe)&&(u.push({l:me.label,cy:-Ye,py:-qe}),Y=!0)}),Y?u.push({l:"Total Other Expenses",cy:-m.is.oe,py:-at.oe,b:!0}):b(m.is.oe,at.oe)&&u.push({l:"Other Expenses",cy:-m.is.oe,py:-at.oe});const ze=G.filter(me=>me.section==="finance_costs"||me.type==="finance");let Le=!1;return ze.forEach(me=>{const qe=parseFloat(me.value)||0,Ye=v[me.id]||0;b(Ye,qe)&&(u.push({l:me.label,cy:-Ye,py:-qe}),Le=!0)}),Le?u.push({l:"Total Finance Costs",cy:-m.is.fin,py:-at.fin,b:!0}):b(m.is.fin,at.fin)&&u.push({l:"Finance Costs",cy:-m.is.fin,py:-at.fin}),u.push({l:"Profit Before Tax",cy:m.is.pbt,py:at.pbt||0,b:!0,h:!0}),b(m.is.tax,at.tax)&&u.push({l:`Tax (${sa?.taxInfo||"24%"})`,cy:-m.is.tax,py:-at.tax}),u.push({l:"Net Profit/(Loss)",cy:m.is.np,py:at.np||0,b:!0,p:!0}),u.map((me,qe)=>me.sub?o.jsx("div",{style:{padding:"6px 12px",fontSize:10,fontWeight:600,color:"#9ca3af"},children:me.l},qe):o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 110px 110px",padding:me.h||me.p?"8px 12px":"5px 12px",background:me.p?"linear-gradient(135deg, rgba(52,211,153,0.2), rgba(99,102,241,0.2))":me.h?"rgba(99,102,241,0.08)":"transparent",borderRadius:me.h||me.p?6:0,marginTop:me.h||me.p?4:0},children:[o.jsx("span",{style:{fontWeight:me.b?700:500,fontSize:me.p?12:11,color:me.indent?"#9ca3af":me.dep?"#fbbf24":"#e5e7eb"},children:me.l}),o.jsx("span",{style:{fontWeight:me.b?700:500,fontFamily:"monospace",fontSize:me.p?12:me.indent?10:11,textAlign:"right",color:me.cy===null?"transparent":me.cy>=0?me.p?"#34d399":me.dep?"#fbbf24":"#e5e7eb":"#f87171"},children:me.cy===null?"-":me.cy<0?`(${ae(Math.abs(me.cy))})`:ae(me.cy)}),o.jsx("span",{style:{fontFamily:"monospace",fontSize:10,textAlign:"right",color:me.dep?"#fbbf24":"#9ca3af"},children:me.py!==void 0&&me.py!==null?me.py<0?`(${ae(Math.abs(me.py))})`:ae(me.py):"-"})]},qe))})(),(m.is.dep||0)>0&&o.jsxs("div",{style:{marginTop:12,padding:8,background:"rgba(251,191,36,0.1)",borderRadius:6,fontSize:9,color:"#fbbf24"},children:[" Current year depreciation of ",ae(m.is.dep)," sourced from PPE Register (Subledger)"]})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"rgba(251,191,36,0.1)"},children:o.jsx("div",{style:{fontWeight:700,fontSize:13,color:"#fbbf24"},children:" Issues & Suggestions"})}),o.jsx("div",{style:{padding:12,maxHeight:500,overflowY:"auto"},children:(()=>{const u=[],v=[];if(m.susp&&m.susp.length>0&&u.push({type:"error",title:`${m.susp.length} Unclassified Transaction(s)`,desc:"Some transactions are in Suspense and not included in the financial statements.",fix:"Go to the Classify tab and assign appropriate classifications to all suspense items."}),m.is.rev>0){const b=m.is.gp/m.is.rev*100;b<10?v.push({type:"warning",title:`Low Gross Profit Margin (${b.toFixed(1)}%)`,desc:"Gross profit margin is below 10%, which may indicate pricing or cost issues.",fix:"Review pricing strategy and supplier costs. Consider if all COGS items are correctly classified."}):b>80&&v.push({type:"info",title:`High Gross Profit Margin (${b.toFixed(1)}%)`,desc:"Very high margin - typical for services but unusual for trading.",fix:"Verify that all direct costs are captured in Cost of Sales. Service businesses typically show high margins."})}if(m.is.rev>0&&m.is.adm===0&&v.push({type:"warning",title:"No Operating Expenses Recorded",desc:"Revenue exists but no operating expenses. This is unusual for most businesses.",fix:"Check if expense transactions are correctly classified. Most businesses have staff costs, utilities, etc."}),m.is.pbt<0&&v.push({type:"info",title:`Loss Before Tax: ${ae(Math.abs(m.is.pbt))}`,desc:"The business is reporting a loss for this period.",fix:"This may be normal for startups or seasonal businesses. Review if all revenue is captured and expenses are reasonable."}),m.is.rev>0){const b=m.is.adm/m.is.rev*100;b>50&&v.push({type:"info",title:`High Operating Expenses (${b.toFixed(1)}% of Revenue)`,desc:"Operating expenses exceed 50% of revenue.",fix:"Review expense classifications. Some items classified as expenses might be COGS or capital expenditure."})}return u.length===0&&v.length===0?o.jsxs("div",{style:{padding:20,textAlign:"center"},children:[o.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),o.jsx("div",{style:{fontSize:12,color:"#34d399",fontWeight:600},children:"All Clear!"}),o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginTop:4},children:"No issues detected with income statement"})]}):[...u,...v].map((b,S)=>o.jsxs("div",{style:{padding:12,marginBottom:8,background:b.type==="error"?"rgba(239,68,68,0.1)":b.type==="warning"?"rgba(251,191,36,0.1)":"rgba(99,102,241,0.1)",border:`1px solid ${b.type==="error"?"rgba(239,68,68,0.3)":b.type==="warning"?"rgba(251,191,36,0.3)":"rgba(99,102,241,0.3)"}`,borderRadius:8},children:[o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:b.type==="error"?"#f87171":b.type==="warning"?"#fbbf24":"#a5b4fc",marginBottom:4},children:[b.type==="error"?"":b.type==="warning"?"":""," ",b.title]}),o.jsx("div",{style:{fontSize:10,color:"#d1d5db",marginBottom:6},children:b.desc}),o.jsxs("div",{style:{fontSize:9,color:"#9ca3af",padding:8,background:"rgba(0,0,0,0.2)",borderRadius:4},children:[" ",o.jsx("strong",{children:"Suggestion:"})," ",b.fix]})]},S))})()})]})]})]}),e==="balance"&&m&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("button",{onClick:or,style:lr,children:" Income Statement"}),o.jsx("button",{onClick:_r,style:ja,children:"Cash Flow "})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",padding:"12px 16px",marginBottom:16,textAlign:"center"},children:[o.jsx("div",{style:{fontWeight:700,fontSize:14},children:s||"Company Name"}),o.jsx("div",{style:{fontWeight:600,fontSize:12,color:"#a5b4fc",marginTop:2},children:"Statement of Financial Position"}),o.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginTop:4},children:["As at ",Lt,"  ",sa?.standard]}),(()=>{const u=m.bs.totA||0,v=(m.bs.totL||0)+(m.bs.totE||0),b=u-v,S=Math.abs(b)<1;return o.jsx("div",{style:{marginTop:8,padding:"6px 12px",borderRadius:6,display:"inline-block",background:S?"rgba(52,211,153,0.15)":"rgba(239,68,68,0.15)",border:S?"1px solid rgba(52,211,153,0.3)":"1px solid rgba(239,68,68,0.3)"},children:o.jsx("span",{style:{fontSize:10,fontWeight:600,color:S?"#34d399":"#f87171"},children:S?" Balanced":` Difference: ${ae(b)}`})})})()]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(99,102,241,0.1), rgba(139,92,246,0.1))",fontWeight:700,fontSize:14},children:"Assets"}),o.jsxs("div",{style:{padding:16},children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",marginBottom:8,fontSize:10,fontWeight:600,color:"#9ca3af"},children:[o.jsx("span",{}),o.jsx("span",{style:{textAlign:"right"},children:L}),o.jsx("span",{style:{textAlign:"right"},children:fe})]}),(()=>{const u=xe.filter(b=>b.type==="nca");return!u.some(b=>{const S=parseFloat(b.value)||0;let T=0;return b.id==="PPE"?T=m.bs.ppe:b.id==="INTANGIBLES"?T=m.bs.intangibles||0:b.id==="INVESTMENTS"&&(T=m.bs.investments||0),T!==0||S!==0})&&m.bs.totNCA===0?null:o.jsxs(o.Fragment,{children:[o.jsx("div",{style:xa,children:"Non-Current Assets"}),u.map((b,S)=>{const T=parseFloat(b.value)||0;let Q=0;if(b.id==="PPE"){if(rt.ppe.cost>0||rt.ppe.accDepCF>0)return o.jsxs("div",{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"5px 10px",fontSize:11},children:[o.jsx("span",{children:b.label}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"}}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:T>0?ae(T):"-"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"3px 10px 3px 20px",fontSize:10,color:"#9ca3af"},children:[o.jsx("span",{children:"Cost"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(rt.ppe.cost)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"}})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"3px 10px 3px 20px",fontSize:10,color:"#f87171"},children:[o.jsx("span",{children:"Less: Acc Depreciation"}),o.jsxs("span",{style:{textAlign:"right",fontFamily:"monospace"},children:["(",ae(rt.ppe.accDepCF),")"]}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"}})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"5px 10px",fontSize:11,fontWeight:600},children:[o.jsx("span",{children:"Net Book Value"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#a5b4fc"},children:ae(rt.ppe.nbv)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"}})]})]},b.id);Q=m.bs.ppe}else b.id==="INTANGIBLES"?Q=m.bs.intangibles||0:b.id==="INVESTMENTS"&&(Q=m.bs.investments||0);return Q===0&&T===0?null:o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"5px 10px",fontSize:11},children:[o.jsx("span",{children:b.label}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:Q!==0?ae(Q):"-"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:T!==0?ae(T):"-"})]},b.id)}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"4px 10px",fontSize:10,color:"#9ca3af",marginTop:4},children:[o.jsx("span",{children:"Total Non-Current Assets"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(m.bs.totNCA)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:m.bs.py_totNCA?ae(m.bs.py_totNCA):"-"})]})]})})(),o.jsx("div",{style:{...xa,marginTop:10},children:"Current Assets"}),xe.filter(v=>v.type==="ca").map(v=>{const b=parseFloat(v.value)||0;let S=0;return v.id==="INVENTORY"?S=m.bs.inv:v.id==="TRADE_RECEIVABLES"?S=m.bs.tr:v.id==="OTHER_RECEIVABLES"?S=m.bs.or||0:v.id==="TAX_PREPAID"?S=m.bs.taxPrepaid||0:v.id==="CASH_BANK"&&(S=m.bs.cash),S===0&&b===0&&v.id!=="CASH_BANK"?null:o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"5px 10px",fontSize:11},children:[o.jsx("span",{children:v.label}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(S)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:b!==0?ae(b):"-"})]},v.id)}),(m.bs.taxPrepaid||0)>0&&o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"5px 10px",fontSize:11},children:[o.jsx("span",{children:"Tax Prepaid"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(m.bs.taxPrepaid)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:"-"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"4px 10px",fontSize:10,color:"#9ca3af",marginTop:4},children:[o.jsx("span",{children:"Total Current Assets"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(m.bs.totCA)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:m.bs.py_totCA?ae(m.bs.py_totCA):"-"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"10px",background:"linear-gradient(135deg, rgba(99,102,241,0.2), rgba(139,92,246,0.2))",borderRadius:6,marginTop:10,fontWeight:700,fontSize:12},children:[o.jsx("span",{children:"TOTAL ASSETS"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(m.bs.totA)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:m.bs.py_totA?ae(m.bs.py_totA):"-"})]})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(239,68,68,0.1), rgba(251,191,36,0.1))",fontWeight:700,fontSize:14},children:"Liabilities & Equity"}),o.jsxs("div",{style:{padding:16},children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",marginBottom:8,fontSize:10,fontWeight:600,color:"#9ca3af"},children:[o.jsx("span",{}),o.jsx("span",{style:{textAlign:"right"},children:L}),o.jsx("span",{style:{textAlign:"right"},children:fe})]}),(()=>{const u=xe.filter(b=>b.type==="ncl");return u.some(b=>{const S=parseFloat(b.value)||0;let T=0;return b.id==="LONG_TERM_LOAN"?T=m.bs.ltBorr||0:b.id==="DEFERRED_TAX"&&(T=m.bs.defTax||0),T!==0||S!==0})?o.jsxs(o.Fragment,{children:[o.jsx("div",{style:xa,children:"Non-Current Liabilities"}),u.map(b=>{const S=parseFloat(b.value)||0;let T=0;return b.id==="LONG_TERM_LOAN"?T=m.bs.ltBorr||0:b.id==="DEFERRED_TAX"&&(T=m.bs.defTax||0),T===0&&S===0?null:o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"5px 10px",fontSize:11},children:[o.jsx("span",{children:b.label}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:T!==0?ae(T):"-"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:S!==0?ae(S):"-"})]},b.id)})]}):null})(),o.jsx("div",{style:xa,children:"Current Liabilities"}),xe.filter(v=>v.type==="cl").map(v=>{const b=parseFloat(v.value)||0;let S=0;return v.id==="SHORT_TERM_LOAN"?S=m.bs.stBorr||m.bs.borr||0:v.id==="TRADE_PAYABLES"?S=m.bs.tp:v.id==="OTHER_PAYABLES"?S=m.bs.op||0:v.id==="TAX_PAYABLE"?S=m.bs.taxPay||0:v.id==="GST_SST_PAYABLE"&&(S=m.bs.gstSst||0),S===0&&b===0?null:o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"5px 10px",fontSize:11},children:[o.jsx("span",{children:v.label}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(S)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:b!==0?ae(b):"-"})]},v.id)}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"4px 10px",fontSize:10,color:"#9ca3af",marginTop:4},children:[o.jsx("span",{children:"Total Liabilities"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(m.bs.totL)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:m.bs.py_totL?ae(m.bs.py_totL):"-"})]}),o.jsx("div",{style:{...xa,marginTop:10},children:"Equity"}),xe.filter(v=>v.type==="equity").map(v=>{const b=parseFloat(v.value)||0;let S=0;return v.id==="SHARE_CAPITAL"?S=m.bs.cap:v.id==="RETAINED_PROFITS"&&(S=m.bs.ret),S===0&&b===0&&v.id!=="SHARE_CAPITAL"?null:o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"5px 10px",fontSize:11},children:[o.jsx("span",{children:v.label}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(S)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:b!==0?ae(b):"-"})]},v.id)}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"5px 10px",fontSize:11},children:[o.jsx("span",{children:"Current Year Profit"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:m.bs.cyp>=0?"#34d399":"#f87171"},children:ae(m.bs.cyp)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:"-"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"4px 10px",fontSize:10,color:"#9ca3af",marginTop:4},children:[o.jsx("span",{children:"Total Equity"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(m.bs.totE)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:m.bs.py_totE?ae(m.bs.py_totE):"-"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"10px",background:"linear-gradient(135deg, rgba(239,68,68,0.2), rgba(251,191,36,0.2))",borderRadius:6,marginTop:10,fontWeight:700,fontSize:12},children:[o.jsx("span",{children:"TOTAL L + E"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(m.bs.totL+m.bs.totE)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:m.bs.py_totL!==void 0&&m.bs.py_totE!==void 0?ae(m.bs.py_totL+m.bs.py_totE):"-"})]}),(()=>{const u=(m.bs.totA||0)-((m.bs.totL||0)+(m.bs.totE||0)),v=m.bs.py_totA?m.bs.py_totA-(m.bs.py_totL||0)-(m.bs.py_totE||0):0,b=Math.abs(u)>=1,S=m.bs.py_totA&&Math.abs(v)>=1;return!b&&!S?null:o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"8px 10px",marginTop:8,background:"rgba(239,68,68,0.1)",borderRadius:6,border:"1px solid rgba(239,68,68,0.3)"},children:[o.jsx("span",{style:{fontSize:10,color:"#f87171",fontWeight:600},children:"Difference (A - L&E)"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:b?"#f87171":"#34d399",fontWeight:700},children:b?ae(u):""}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:S?"#fbbf24":"#34d399",fontWeight:700},children:m.bs.py_totA?S?ae(v):"":"-"})]})})()]})]})]}),o.jsx("div",{style:{gridColumn:"1 / -1",marginTop:16},children:o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"rgba(251,191,36,0.1)"},children:o.jsx("div",{style:{fontWeight:700,fontSize:13,color:"#fbbf24"},children:" Balance Sheet Issues & Suggestions"})}),o.jsx("div",{style:{padding:12,display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:12},children:(()=>{const u=[],v=(m.bs.totA||0)-((m.bs.totL||0)+(m.bs.totE||0));if(Math.abs(v)>=1){const b=[];b.push(`Assets: NCA ${ae(m.bs.totNCA)} + CA ${ae(m.bs.totCA)} = ${ae(m.bs.totA)}`),b.push(`Liabilities: NCL ${ae(m.bs.totNCL||0)} + CL ${ae(m.bs.totCL)} = ${ae(m.bs.totL)}`),b.push(`Equity: Capital ${ae(m.bs.cap)} + Retained ${ae(m.bs.ret)} + CY Profit ${ae(m.bs.cyp)} = ${ae(m.bs.totE)}`),u.push({type:"error",title:"CY Balance Sheet Does Not Balance",desc:`Assets (${ae(m.bs.totA)})  L+E (${ae(m.bs.totL+m.bs.totE)}). Difference: ${ae(v)}`,fix:b.join(" | ")})}if(m.bs.py_totA&&m.bs.py_totA>0){const b=(m.bs.py_totA||0)-((m.bs.py_totL||0)+(m.bs.py_totE||0));if(Math.abs(b)>=1){const S=[];S.push(`PY Assets: NCA ${ae(m.bs.py_totNCA||0)} + CA ${ae(m.bs.py_totCA||0)} = ${ae(m.bs.py_totA)}`),S.push(`PY Liabilities: NCL ${ae(m.bs.py_totNCL||0)} + CL ${ae(m.bs.py_totCL||0)} = ${ae(m.bs.py_totL)}`),S.push(`PY Equity: Capital ${ae(m.bs.py_cap||0)} + Retained ${ae(m.bs.py_ret||0)} = ${ae(m.bs.py_totE)}`),u.push({type:"warning",title:"PY Balance Sheet Does Not Balance",desc:`PY Assets (${ae(m.bs.py_totA)})  PY L+E (${ae((m.bs.py_totL||0)+(m.bs.py_totE||0))}). Difference: ${ae(b)}`,fix:S.join(" | ")})}}if(m.bs.cash<0&&u.push({type:"warning",title:"Negative Cash Balance",desc:`Cash shows ${ae(m.bs.cash)}. Banks typically don't allow negative balances.`,fix:"This may indicate an overdraft (should be classified as liability) or missing deposits. Review bank reconciliation."}),m.bs.inv<0&&u.push({type:"error",title:"Negative Inventory",desc:`Inventory is ${ae(m.bs.inv)}. This is not possible in reality.`,fix:"Review inventory movements. You may have recorded more sales than available stock, or opening balance is wrong."}),m.bs.totA>0&&m.bs.totL>m.bs.totA&&u.push({type:"warning",title:"Negative Net Assets",desc:"Total liabilities exceed total assets, indicating negative equity.",fix:"This may indicate the business is insolvent. Verify if this is correct or if assets/liabilities are misclassified."}),(!m.bs.py_totA||m.bs.py_totA===0)&&u.push({type:"info",title:"No Prior Year Comparatives",desc:"Prior year Balance Sheet values are not entered.",fix:"Enter prior year figures in the Prior FS tab for meaningful year-on-year comparison."}),m.bs.totCL>0){const b=m.bs.totCA/m.bs.totCL;b<1&&u.push({type:"warning",title:`Low Current Ratio (${b.toFixed(2)})`,desc:"Current assets are less than current liabilities, indicating potential liquidity issues.",fix:"The business may have difficulty meeting short-term obligations. Review cash flow and consider restructuring debt."})}return u.length===0?o.jsxs("div",{style:{padding:20,textAlign:"center",gridColumn:"1 / -1"},children:[o.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),o.jsx("div",{style:{fontSize:12,color:"#34d399",fontWeight:600},children:"All Clear!"}),o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginTop:4},children:"Balance Sheet is balanced and no issues detected"})]}):u.map((b,S)=>o.jsxs("div",{style:{padding:12,background:b.type==="error"?"rgba(239,68,68,0.1)":b.type==="warning"?"rgba(251,191,36,0.1)":"rgba(99,102,241,0.1)",border:`1px solid ${b.type==="error"?"rgba(239,68,68,0.3)":b.type==="warning"?"rgba(251,191,36,0.3)":"rgba(99,102,241,0.3)"}`,borderRadius:8},children:[o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:b.type==="error"?"#f87171":b.type==="warning"?"#fbbf24":"#a5b4fc",marginBottom:4},children:[b.type==="error"?"":b.type==="warning"?"":""," ",b.title]}),o.jsx("div",{style:{fontSize:10,color:"#d1d5db",marginBottom:6},children:b.desc}),o.jsxs("div",{style:{fontSize:9,color:"#9ca3af",padding:8,background:"rgba(0,0,0,0.2)",borderRadius:4},children:[" ",o.jsx("strong",{children:"Suggestion:"})," ",b.fix]})]},S))})()})]})})]}),e==="cashflow"&&m&&m.cf&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("button",{onClick:or,style:lr,children:" Balance Sheet"}),o.jsx("button",{onClick:_r,style:ja,children:"Tax Computation "})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 350px",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(52,211,153,0.1), rgba(34,197,94,0.1))"},children:[o.jsx("div",{style:{fontWeight:700,fontSize:14},children:s||"Company Name"}),o.jsx("div",{style:{fontWeight:600,fontSize:12,color:"#34d399",marginTop:2},children:"Statement of Cash Flows"}),o.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginTop:4},children:["For the financial year ended ",Lt,"  Indirect Method (IAS 7 / IFRS 18)"]}),o.jsx("div",{style:{fontSize:9,color:"#6b7280",marginTop:2,fontStyle:"italic"},children:" Derived from Balance Sheet movements. May require adjustment for disposals/non-cash items."})]}),o.jsxs("div",{style:{padding:16},children:[o.jsxs("div",{style:{marginBottom:16},children:[o.jsx("div",{style:{fontSize:12,fontWeight:700,color:"#34d399",marginBottom:8,padding:"6px 10px",background:"rgba(52,211,153,0.1)",borderRadius:6},children:" Cash Flows from Operating Activities"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"6px 10px",fontSize:11},children:[o.jsx("span",{children:"Profit before taxation"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",fontWeight:600},children:ae(m.cf.pbt)})]}),o.jsx("div",{style:{fontSize:10,color:"#9ca3af",padding:"4px 10px",marginTop:6},children:"Adjustments for:"}),[{label:"Depreciation",value:m.cf.adjustments.depreciation},{label:"Interest expense",value:m.cf.adjustments.interestExpense},{label:"Interest income",value:m.cf.adjustments.interestIncome}].filter(u=>u.value!==0).map((u,v)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"4px 10px 4px 20px",fontSize:10,color:"#d1d5db"},children:[o.jsx("span",{children:u.label}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:u.value>=0?ae(u.value):`(${ae(Math.abs(u.value))})`})]},v)),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"6px 10px",fontSize:11,background:"rgba(75,85,99,0.2)",borderRadius:4,marginTop:4},children:[o.jsx("span",{style:{fontWeight:600},children:"Operating profit before working capital changes"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",fontWeight:600},children:ae(m.cf.pbt+m.cf.totalAdjustments)})]}),o.jsx("div",{style:{fontSize:10,color:"#9ca3af",padding:"4px 10px",marginTop:8},children:"Changes in working capital:"}),[{label:"(Increase)/Decrease in inventories",value:m.cf.workingCapitalChanges.inventory},{label:"(Increase)/Decrease in trade receivables",value:m.cf.workingCapitalChanges.tradeReceivables},{label:"(Increase)/Decrease in other receivables",value:m.cf.workingCapitalChanges.otherReceivables},{label:"Increase/(Decrease) in trade payables",value:m.cf.workingCapitalChanges.tradePayables},{label:"Increase/(Decrease) in other payables",value:m.cf.workingCapitalChanges.otherPayables}].filter(u=>u.value!==0).map((u,v)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"4px 10px 4px 20px",fontSize:10,color:"#d1d5db"},children:[o.jsx("span",{children:u.label}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:u.value>=0?"#34d399":"#f87171"},children:u.value>=0?ae(u.value):`(${ae(Math.abs(u.value))})`})]},v)),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"6px 10px",fontSize:11,background:"rgba(52,211,153,0.15)",borderRadius:4,marginTop:4},children:[o.jsx("span",{style:{fontWeight:600},children:"Cash generated from operations"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",fontWeight:600},children:ae(m.cf.cashFromOperations)})]}),(m.cf.taxPaid!==0||m.cf.interestPaid!==0)&&o.jsxs(o.Fragment,{children:[m.cf.taxPaid!==0&&o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"4px 10px",fontSize:10,color:"#d1d5db"},children:[o.jsx("span",{children:"Tax paid"}),o.jsxs("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#f87171"},children:["(",ae(Math.abs(m.cf.taxPaid)),")"]})]}),m.cf.interestPaid!==0&&o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"4px 10px",fontSize:10,color:"#d1d5db"},children:[o.jsx("span",{children:"Interest paid"}),o.jsxs("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#f87171"},children:["(",ae(Math.abs(m.cf.interestPaid)),")"]})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"8px 10px",fontSize:12,background:"rgba(52,211,153,0.2)",borderRadius:6,marginTop:6,fontWeight:700},children:[o.jsx("span",{children:"Net cash from operating activities"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:m.cf.netOperating>=0?"#34d399":"#f87171"},children:m.cf.netOperating>=0?ae(m.cf.netOperating):`(${ae(Math.abs(m.cf.netOperating))})`})]})]}),o.jsxs("div",{style:{marginBottom:16},children:[o.jsx("div",{style:{fontSize:12,fontWeight:700,color:"#a5b4fc",marginBottom:8,padding:"6px 10px",background:"rgba(99,102,241,0.1)",borderRadius:6},children:" Cash Flows from Investing Activities"}),[{label:"Purchase of property, plant & equipment",value:m.cf.ppePurchases},{label:"Proceeds from disposal of PPE",value:m.cf.ppeDisposals},{label:"Purchase of investments",value:m.cf.investmentPurchases},{label:"Proceeds from disposal of investments",value:m.cf.investmentDisposals},{label:"Interest received",value:m.cf.interestReceived}].filter(u=>u.value!==0).map((u,v)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"4px 10px",fontSize:10,color:"#d1d5db"},children:[o.jsx("span",{children:u.label}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:u.value>=0?"#34d399":"#f87171"},children:u.value>=0?ae(u.value):`(${ae(Math.abs(u.value))})`})]},v)),m.cf.netInvesting===0&&o.jsx("div",{style:{padding:"4px 10px",fontSize:10,color:"#6b7280",fontStyle:"italic"},children:"No investing activities"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"8px 10px",fontSize:12,background:"rgba(99,102,241,0.2)",borderRadius:6,marginTop:6,fontWeight:700},children:[o.jsx("span",{children:"Net cash from investing activities"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:m.cf.netInvesting>=0?"#34d399":"#f87171"},children:m.cf.netInvesting>=0?ae(m.cf.netInvesting):`(${ae(Math.abs(m.cf.netInvesting))})`})]})]}),o.jsxs("div",{style:{marginBottom:16},children:[o.jsx("div",{style:{fontSize:12,fontWeight:700,color:"#fbbf24",marginBottom:8,padding:"6px 10px",background:"rgba(251,191,36,0.1)",borderRadius:6},children:" Cash Flows from Financing Activities"}),[{label:"Proceeds from borrowings",value:m.cf.loanProceeds},{label:"Repayment of borrowings",value:m.cf.loanRepayments},{label:"Capital injection / Share issuance",value:m.cf.capitalInjection},{label:"Dividends paid",value:m.cf.dividendsPaid},{label:"Drawings / Withdrawals",value:m.cf.drawingsWithdrawals}].filter(u=>u.value!==0).map((u,v)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"4px 10px",fontSize:10,color:"#d1d5db"},children:[o.jsx("span",{children:u.label}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:u.value>=0?"#34d399":"#f87171"},children:u.value>=0?ae(u.value):`(${ae(Math.abs(u.value))})`})]},v)),m.cf.netFinancing===0&&o.jsx("div",{style:{padding:"4px 10px",fontSize:10,color:"#6b7280",fontStyle:"italic"},children:"No financing activities"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"8px 10px",fontSize:12,background:"rgba(251,191,36,0.2)",borderRadius:6,marginTop:6,fontWeight:700},children:[o.jsx("span",{children:"Net cash from financing activities"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:m.cf.netFinancing>=0?"#34d399":"#f87171"},children:m.cf.netFinancing>=0?ae(m.cf.netFinancing):`(${ae(Math.abs(m.cf.netFinancing))})`})]})]}),o.jsxs("div",{style:{borderTop:"2px solid rgba(75,85,99,0.3)",paddingTop:12},children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"6px 10px",fontSize:11,fontWeight:600},children:[o.jsx("span",{children:"Net increase/(decrease) in cash"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:m.cf.netChangeInCash>=0?"#34d399":"#f87171"},children:m.cf.netChangeInCash>=0?ae(m.cf.netChangeInCash):`(${ae(Math.abs(m.cf.netChangeInCash))})`})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"6px 10px",fontSize:11},children:[o.jsx("span",{children:"Cash at beginning of year"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(m.cf.openingCash)})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"10px",fontSize:13,background:"linear-gradient(135deg, rgba(52,211,153,0.2), rgba(99,102,241,0.2))",borderRadius:6,marginTop:4,fontWeight:700},children:[o.jsx("span",{children:"Cash at end of year (per CF)"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#34d399"},children:ae(m.cf.closingCash)})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"6px 10px",fontSize:11,marginTop:4},children:[o.jsx("span",{style:{color:"#9ca3af"},children:"Cash per Balance Sheet"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:ae(m.cf.cashPerBS)})]}),Math.abs(m.cf.difference)>=1&&o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"6px 10px",fontSize:11,background:"rgba(239,68,68,0.1)",borderRadius:4,marginTop:4,border:"1px solid rgba(239,68,68,0.3)"},children:[o.jsx("span",{style:{color:"#f87171",fontWeight:600},children:" Difference"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#f87171",fontWeight:600},children:ae(m.cf.difference)})]})]})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"rgba(251,191,36,0.1)"},children:o.jsx("div",{style:{fontWeight:700,fontSize:13,color:"#fbbf24"},children:" Issues & Suggestions"})}),o.jsx("div",{style:{padding:12,maxHeight:500,overflowY:"auto"},children:(()=>{const u=[],v=[];Math.abs(m.cf.difference)>=1&&u.push({type:"error",title:"Cash Flow vs Balance Sheet Difference",desc:`Calculated closing cash (${ae(m.cf.closingCash)}) differs from BS cash (${ae(m.cf.cashPerBS)}) by ${ae(Math.abs(m.cf.difference))}`,fix:"Common causes: (1) Subledger values override TB for AR/AP/Inventory but transactions flow to cash differently, (2) Missing transactions like tax payments, dividends, or drawings, (3) Timing differences. The indirect method derives cash from BS changes - ensure all BS items are consistent."}),m.cf.openingCash===0&&m.bs.py_cash===0&&v.push({type:"warning",title:"No Opening Cash Balance",desc:"Opening cash is zero. This is normal for a new company but check if prior year BS was entered.",fix:"Enter prior year Balance Sheet in the Prior FS tab to enable proper cash flow calculation."}),m.cf.netOperating<0&&m.is.np>0&&v.push({type:"info",title:"Negative Operating Cash Despite Profit",desc:`Operating cash flow is negative (${ae(m.cf.netOperating)}) despite net profit of ${ae(m.is.np)}`,fix:"This commonly occurs due to working capital increases (growing receivables/inventory). Review if collections are delayed or stock is building up."});const b=Math.abs(m.cf.totalWCChanges);return b>Math.abs(m.cf.pbt)*.5&&b>1e4&&v.push({type:"info",title:"Significant Working Capital Movement",desc:`Working capital changed by ${ae(b)}, which is significant relative to profit.`,fix:"Large swings may indicate seasonality, growth, or collection issues. Verify receivables aging and inventory levels."}),u.length===0&&v.length===0?o.jsxs("div",{style:{padding:20,textAlign:"center"},children:[o.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),o.jsx("div",{style:{fontSize:12,color:"#34d399",fontWeight:600},children:"All Clear!"}),o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginTop:4},children:"No issues detected with cash flow statement"})]}):[...u,...v].map((S,T)=>o.jsxs("div",{style:{padding:12,marginBottom:8,background:S.type==="error"?"rgba(239,68,68,0.1)":S.type==="warning"?"rgba(251,191,36,0.1)":"rgba(99,102,241,0.1)",border:`1px solid ${S.type==="error"?"rgba(239,68,68,0.3)":S.type==="warning"?"rgba(251,191,36,0.3)":"rgba(99,102,241,0.3)"}`,borderRadius:8},children:[o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:S.type==="error"?"#f87171":S.type==="warning"?"#fbbf24":"#a5b4fc",marginBottom:4},children:[S.type==="error"?"":S.type==="warning"?"":""," ",S.title]}),o.jsx("div",{style:{fontSize:10,color:"#d1d5db",marginBottom:6},children:S.desc}),o.jsxs("div",{style:{fontSize:9,color:"#9ca3af",padding:8,background:"rgba(0,0,0,0.2)",borderRadius:4},children:[" ",o.jsx("strong",{children:"Suggestion:"})," ",S.fix]})]},T))})()})]})]})]}),e==="tax"&&m&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("button",{onClick:or,style:lr,children:" Cash Flow"}),o.jsx("button",{onClick:_r,style:ja,children:"Snapshots "})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(251,191,36,0.1), rgba(245,158,11,0.1))"},children:[o.jsx("div",{style:{fontWeight:700,fontSize:14},children:s||"Company Name"}),o.jsx("div",{style:{fontWeight:600,fontSize:12,color:"#fbbf24",marginTop:2},children:" Tax Computation"}),o.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginTop:2},children:["Year of Assessment ",L,"  ",sa?.taxInfo]})]}),o.jsxs("div",{style:{padding:16,maxHeight:600,overflowY:"auto"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",fontSize:12,borderBottom:"1px solid rgba(75,85,99,0.2)"},children:[o.jsx("span",{children:"Profit Before Tax"}),o.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:ae(m.is.pbt)})]}),o.jsxs("div",{style:{...xa,marginTop:12,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{color:"#f87171"},children:" Add Back: Non-Deductible Expenses"}),o.jsx("span",{style:{fontSize:9,color:"#6b7280",fontWeight:400},children:"Section 39 ITA 1967"})]}),o.jsxs("div",{style:{background:"rgba(248,113,113,0.05)",borderRadius:8,border:"1px solid rgba(248,113,113,0.2)",padding:8,marginBottom:8},children:[o.jsxs("div",{style:{fontSize:9,color:"#9ca3af",marginBottom:8,display:"flex",alignItems:"center",gap:4},children:[o.jsx("span",{children:""})," Expenses not wholly & exclusively for business must be added back to profit"]}),Ea.map((u,v)=>o.jsxs("div",{style:{marginBottom:8},children:[o.jsx("div",{style:{fontSize:9,color:"#f87171",fontWeight:600,marginBottom:4,textTransform:"uppercase",letterSpacing:.5},children:u.category}),u.items.map(b=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"3px 8px",fontSize:10},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,flex:1},children:[o.jsx("span",{children:b.label}),o.jsx("div",{style:{position:"relative",display:"inline-block"},children:o.jsx("span",{style:{cursor:"help",fontSize:10,color:"#6b7280",background:"rgba(107,114,128,0.2)",borderRadius:"50%",width:14,height:14,display:"inline-flex",alignItems:"center",justifyContent:"center"},title:b.tooltip,children:"?"})})]}),o.jsx("input",{type:"number",placeholder:"0",value:Et.addBackExpenses&&Et.addBackExpenses[b.key]||"",onChange:S=>ht(T=>({...T,addBackExpenses:{...T.addBackExpenses||{},[b.key]:S.target.value}})),style:{...ft,width:90,padding:"3px 6px",fontSize:10,fontFamily:"monospace",textAlign:"right"}})]},b.key))]},v)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",fontSize:11,background:"rgba(248,113,113,0.1)",borderRadius:6,marginTop:8,fontWeight:600},children:[o.jsx("span",{children:"Total Add Back"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#f87171"},children:ae(Ta())})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",fontSize:12,background:"rgba(99,102,241,0.1)",borderRadius:6,marginBottom:8},children:[o.jsx("span",{style:{fontWeight:600},children:"Adjusted Profit"}),o.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:ae(m.is.pbt+Ta())})]}),o.jsx("div",{style:{...xa,marginTop:12},children:t==="ENTERPRISE"?" Business Deductions & Personal Reliefs":" Tax Deductions & Allowances"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",fontSize:11,background:"rgba(52,211,153,0.1)",borderRadius:6,marginBottom:8},children:[o.jsxs("div",{children:[o.jsx("span",{style:{fontWeight:600},children:"Capital Allowance"}),o.jsxs("div",{style:{fontSize:9,color:"#6b7280",marginTop:2},children:["From CA Schedule (",en.length," assets)",!Ll()&&o.jsx("span",{style:{color:"#f87171",marginLeft:8},children:" Not reconciled with PPE"})]})]}),o.jsxs("span",{style:{fontFamily:"monospace",color:"#34d399",fontWeight:600},children:["(",ae(ss()),")"]})]}),t==="ENTERPRISE"?o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:8,padding:"4px 8px",background:"rgba(99,102,241,0.1)",borderRadius:4},children:"Personal reliefs reduce chargeable income for sole proprietors/partners"}),[{key:"selfRelief",label:"Self Relief",max:9e3},{key:"spouseRelief",label:"Spouse Relief",max:4e3},{key:"childRelief",label:"Child Relief",max:null},{key:"parentsMedical",label:"Parents Medical",max:8e3},{key:"epfContribution",label:"EPF Contribution",max:4e3},{key:"lifeInsurance",label:"Life Insurance / Takaful",max:3e3},{key:"educationFees",label:"Education & Medical Insurance",max:3e3},{key:"medicalExpenses",label:"Medical Expenses",max:1e4},{key:"lifestyleRelief",label:"Lifestyle Relief",max:2500},{key:"socsoContribution",label:"SOCSO Contribution",max:350},{key:"privateRetirement",label:"Private Retirement Scheme",max:3e3},{key:"sspnDeposit",label:"SSPN Deposit",max:8e3}].map(u=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 12px",fontSize:11},children:[o.jsxs("span",{children:[u.label," ",u.max&&o.jsxs("span",{style:{color:"#6b7280"},children:["(max ",ae(u.max),")"]})]}),o.jsx("input",{type:"number",placeholder:"0",value:Et.personalDeductions[u.key],onChange:v=>ht(b=>({...b,personalDeductions:{...b.personalDeductions,[u.key]:v.target.value}})),style:{...ft,width:100,padding:"4px 8px",fontSize:11,fontFamily:"monospace",textAlign:"right"}})]},u.key))]}):o.jsx(o.Fragment,{children:[{key:"reinvestmentAllowance",label:"Reinvestment Allowance"},{key:"pioneerStatus",label:"Pioneer Status Exemption"},{key:"investmentTaxAllowance",label:"Investment Tax Allowance"},{key:"exportIncentive",label:"Export Incentive"},{key:"rdDeduction",label:"R&D Double Deduction"},{key:"lossCarryForward",label:"Loss Carry Forward"}].map(u=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 12px",fontSize:11},children:[o.jsx("span",{children:u.label}),o.jsx("input",{type:"number",placeholder:"0",value:Et.corporateDeductions[u.key],onChange:v=>ht(b=>({...b,corporateDeductions:{...b.corporateDeductions,[u.key]:v.target.value}})),style:{...ft,width:100,padding:"4px 8px",fontSize:11,fontFamily:"monospace",textAlign:"right"}})]},u.key))}),(()=>{const u=hr(m.is.pbt);return o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",fontSize:12,borderTop:"1px solid rgba(75,85,99,0.2)",marginTop:8},children:[o.jsx("span",{children:"Total Deductions"}),o.jsxs("span",{style:{fontFamily:"monospace",color:"#34d399"},children:["(",ae(u.totalDeductions),")"]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 12px",background:"rgba(251,191,36,0.1)",borderRadius:6,marginTop:8,fontSize:12,fontWeight:600},children:[o.jsx("span",{children:"Chargeable Income"}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(u.taxableIncome)})]}),u.taxableIncome>0?o.jsxs("div",{style:{marginTop:12,padding:8,background:"rgba(99,102,241,0.05)",borderRadius:6,border:"1px solid rgba(99,102,241,0.2)"},children:[o.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a5b4fc",marginBottom:8},children:" Tax Calculation Breakdown"}),u.brackets.length>0?u.brackets.map((v,b)=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 8px",fontSize:10,borderBottom:b<u.brackets.length-1?"1px solid rgba(75,85,99,0.2)":"none"},children:[o.jsx("span",{children:v.range}),o.jsxs("span",{style:{color:"#9ca3af"},children:[ae(v.amount),"  ",v.rate,"% = ",o.jsx("span",{style:{color:"#fbbf24",fontWeight:600},children:ae(v.tax)})]})]},b)):o.jsx("div",{style:{fontSize:10,color:"#9ca3af",padding:8},children:"No tax brackets calculated"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 8px 4px",fontSize:11,fontWeight:600,borderTop:"1px solid rgba(75,85,99,0.3)",marginTop:4},children:[o.jsx("span",{children:"Gross Tax"}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(u.grossTax)})]})]}):o.jsx("div",{style:{marginTop:12,padding:12,background:"rgba(52,211,153,0.1)",borderRadius:6,border:"1px solid rgba(52,211,153,0.2)",fontSize:11,color:"#34d399"},children:" No tax payable - Chargeable income is zero or negative after deductions"}),t==="ENTERPRISE"&&u.grossTax>0&&o.jsxs("div",{style:{marginTop:12},children:[o.jsx("div",{style:{...xa,color:"#34d399"},children:" Tax Rebates"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",fontSize:11,background:"rgba(52,211,153,0.05)",borderRadius:6},children:[o.jsxs("div",{children:[o.jsx("span",{style:{fontWeight:600},children:"Zakat Paid"}),o.jsx("div",{style:{fontSize:9,color:"#6b7280",marginTop:2},children:"Rebate limited to tax payable amount"})]}),o.jsx("input",{type:"number",placeholder:"0",value:Et.taxRebates&&Et.taxRebates.zakat||"",onChange:v=>ht(b=>({...b,taxRebates:{...b.taxRebates||{},zakat:v.target.value}})),style:{...ft,width:100,padding:"4px 8px",fontSize:11,fontFamily:"monospace",textAlign:"right"}})]}),u.zakat>0&&o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 12px",fontSize:11,color:"#34d399"},children:[o.jsx("span",{children:"Less: Zakat Rebate"}),o.jsxs("span",{style:{fontFamily:"monospace"},children:["(",ae(u.zakat),")"]})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"12px",background:"linear-gradient(135deg, rgba(251,191,36,0.2), rgba(245,158,11,0.2))",borderRadius:6,marginTop:12,fontSize:14,fontWeight:700},children:[o.jsx("span",{children:"Tax Payable"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#fbbf24"},children:ae(u.netTax)})]})]})})(),na(m.is.pbt)!==m.is.tax&&o.jsxs("div",{style:{marginTop:12,padding:12,background:"rgba(251,191,36,0.1)",borderRadius:8,border:"1px solid rgba(251,191,36,0.3)"},children:[o.jsxs("div",{style:{fontSize:11,color:"#fbbf24",marginBottom:8},children:[" Tax has changed from ",ae(m.is.tax)," to ",ae(na(m.is.pbt)),". Click below to update the financial statements."]}),o.jsx("button",{onClick:b0,style:{width:"100%",padding:"10px 16px",background:"linear-gradient(135deg, #fbbf24, #f59e0b)",border:"none",borderRadius:8,color:"#1f2937",fontWeight:700,fontSize:12,cursor:"pointer"},children:" Update Financial Statements"})]})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(99,102,241,0.1), rgba(139,92,246,0.1))"},children:[o.jsx("div",{style:{fontWeight:700,fontSize:14},children:" Tax Rate Settings"}),o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginTop:2},children:"Adjust rates if different from default"})]}),o.jsxs("div",{style:{padding:16},children:[t==="SDN_BHD"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{style:xa,children:"SME Tax Rates"}),o.jsxs("div",{style:{marginBottom:12},children:[o.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginBottom:4},children:"Tier 1 Limit (RM)"}),o.jsx("input",{type:"number",value:Et.sdnBhd.tier1Limit,onChange:u=>ht(v=>({...v,sdnBhd:{...v.sdnBhd,tier1Limit:parseInt(u.target.value)||0}})),style:{...ft,fontFamily:"monospace"}})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginBottom:4},children:"Tier 1 Rate (%)"}),o.jsx("input",{type:"number",value:Et.sdnBhd.tier1Rate,onChange:u=>ht(v=>({...v,sdnBhd:{...v.sdnBhd,tier1Rate:parseFloat(u.target.value)||0}})),style:{...ft,fontFamily:"monospace"}})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginBottom:4},children:"Tier 2 Rate (%)"}),o.jsx("input",{type:"number",value:Et.sdnBhd.tier2Rate,onChange:u=>ht(v=>({...v,sdnBhd:{...v.sdnBhd,tier2Rate:parseFloat(u.target.value)||0}})),style:{...ft,fontFamily:"monospace"}})]})]}),o.jsxs("div",{style:{padding:12,background:"rgba(99,102,241,0.1)",borderRadius:8,marginTop:12,fontSize:11},children:[o.jsx("div",{style:{fontWeight:600,marginBottom:4},children:"Current Tax Structure:"}),o.jsxs("div",{children:[" First RM",Et.sdnBhd.tier1Limit.toLocaleString(),": ",Et.sdnBhd.tier1Rate,"%"]}),o.jsxs("div",{children:[" Above RM",Et.sdnBhd.tier1Limit.toLocaleString(),": ",Et.sdnBhd.tier2Rate,"%"]})]})]}),t==="ENTERPRISE"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{style:xa,children:"Personal Tax Brackets (YA2024)"}),o.jsxs("div",{style:{maxHeight:300,overflowY:"auto"},children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px",gap:4,marginBottom:4,fontSize:9,color:"#6b7280"},children:[o.jsx("span",{children:"Bracket Amount (RM)"}),o.jsx("span",{children:"Rate"})]}),Et.enterprise.brackets.map((u,v)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px",gap:8,marginBottom:6},children:[o.jsx("input",{type:"number",value:u.limit===1/0?"":u.limit,placeholder:"",onChange:b=>{const S=[...Et.enterprise.brackets];S[v]={...S[v],limit:b.target.value===""?1/0:parseInt(b.target.value)||0},ht(T=>({...T,enterprise:{brackets:S}}))},style:{...ft,fontFamily:"monospace",fontSize:11,padding:"4px 8px"},disabled:v===Et.enterprise.brackets.length-1}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[o.jsx("input",{type:"number",value:u.rate,onChange:b=>{const S=[...Et.enterprise.brackets];S[v]={...S[v],rate:parseFloat(b.target.value)||0},ht(T=>({...T,enterprise:{brackets:S}}))},style:{...ft,fontFamily:"monospace",fontSize:11,width:50,padding:"4px 8px"}}),o.jsx("span",{style:{fontSize:11,color:"#9ca3af"},children:"%"})]})]},v))]})]}),t==="BERHAD"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{style:xa,children:"Corporate Tax Rate"}),o.jsxs("div",{style:{marginBottom:12},children:[o.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginBottom:4},children:"Flat Tax Rate (%)"}),o.jsx("input",{type:"number",value:Et.berhad.rate,onChange:u=>ht(v=>({...v,berhad:{rate:parseFloat(u.target.value)||0}})),style:{...ft,fontFamily:"monospace"}})]}),o.jsx("div",{style:{padding:12,background:"rgba(99,102,241,0.1)",borderRadius:8,fontSize:11},children:o.jsxs("div",{style:{fontWeight:600},children:["All chargeable income taxed at ",Et.berhad.rate,"%"]})})]}),o.jsxs("div",{style:{padding:12,background:"rgba(52,211,153,0.1)",borderRadius:8,marginTop:16},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,marginBottom:8},children:"Effective Tax Rate"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:20,fontWeight:700},children:[o.jsx("span",{style:{color:"#9ca3af"},children:"ETR:"}),o.jsxs("span",{style:{color:"#34d399"},children:[m.is.pbt>0?(na(m.is.pbt)/m.is.pbt*100).toFixed(2):0,"%"]})]})]})]})]})]}),o.jsxs("div",{style:{marginTop:16,background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(52,211,153,0.1), rgba(16,185,129,0.1))",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:700,fontSize:14},children:" Capital Allowance Schedule"}),o.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginTop:2},children:["YA ",L,"  IA claimed on assets acquired in ",L,", AA on all qualifying assets"]}),t==="ENTERPRISE"&&o.jsx("div",{style:{fontSize:9,color:"#fbbf24",marginTop:2},children:" Sole proprietors & partnerships can also claim CA on business assets"})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[o.jsx("div",{style:{padding:"6px 12px",borderRadius:6,background:Ll()?"rgba(52,211,153,0.2)":"rgba(248,113,113,0.2)",border:`1px solid ${Ll()?"rgba(52,211,153,0.5)":"rgba(248,113,113,0.5)"}`,fontSize:9},children:Ll()?o.jsxs("span",{style:{color:"#34d399"},children:[" Reconciled with PPE: RM ",ae(ui())]}):o.jsxs("span",{style:{color:"#f87171"},children:[" CA: ",ae(Ml()),"  PPE: ",ae(ui())]})}),o.jsxs("div",{style:{textAlign:"right"},children:[o.jsxs("div",{style:{fontSize:10,color:"#9ca3af"},children:["Total CA (YA ",L,")"]}),o.jsxs("div",{style:{fontSize:18,fontWeight:700,color:"#34d399",fontFamily:"monospace"},children:["RM ",ae(ss())]})]})]})]}),o.jsxs("div",{style:{padding:12},children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"100px 180px 140px 90px 60px 60px 80px 30px",padding:"8px 10px",background:"rgba(99,102,241,0.1)",borderRadius:4,fontSize:9,fontWeight:600,color:"#9ca3af",marginBottom:4,gap:8},children:[o.jsx("span",{children:"Acquisition Date"}),o.jsx("span",{children:"Asset Description"}),o.jsx("span",{children:"Category"}),o.jsx("span",{style:{textAlign:"right"},children:"Cost (RM)"}),o.jsx("span",{style:{textAlign:"center"},children:"IA %"}),o.jsx("span",{style:{textAlign:"center"},children:"AA %"}),o.jsx("span",{style:{textAlign:"right"},children:"CA Amount"}),o.jsx("span",{})]}),en.map((u,v)=>{const b=Fn(u),S=fi[u.category]||fi.OFFICE_EQUIPMENT;return o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"100px 180px 140px 90px 60px 60px 80px 30px",padding:"6px 10px",background:v%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,fontSize:10,alignItems:"center",gap:8},children:[o.jsx("input",{type:"date",value:u.acquisitionDate,onChange:T=>Vs(u.id,"acquisitionDate",T.target.value),style:{padding:"4px",background:"rgba(17,24,39,0.5)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:4,color:"#e5e7eb",fontSize:9}}),o.jsx("input",{type:"text",value:u.description,onChange:T=>Vs(u.id,"description",T.target.value),placeholder:"Asset description...",style:{padding:"4px 8px",background:"rgba(17,24,39,0.5)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:4,color:"#e5e7eb",fontSize:10}}),o.jsx("select",{value:u.category,onChange:T=>Vs(u.id,"category",T.target.value),style:{padding:"4px",background:"rgba(17,24,39,0.5)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:4,color:"#e5e7eb",fontSize:9},children:Object.entries(fi).map(([T,Q])=>o.jsx("option",{value:T,children:Q.label},T))}),o.jsx("input",{type:"number",value:u.cost||"",onChange:T=>Vs(u.id,"cost",parseFloat(T.target.value)||0),placeholder:"0",style:{padding:"4px 8px",background:"rgba(17,24,39,0.5)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:4,color:"#e5e7eb",fontSize:10,fontFamily:"monospace",textAlign:"right"}}),o.jsx("span",{style:{textAlign:"center",fontFamily:"monospace",color:b.isCurrentYear?"#34d399":"#6b7280",fontSize:9},children:b.isCurrentYear?S.ia:"-"}),o.jsx("span",{style:{textAlign:"center",fontFamily:"monospace",color:"#34d399",fontSize:9},children:S.aa}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#34d399",fontWeight:600},children:ae(b.totalCA)}),o.jsx("button",{onClick:()=>Bo(u.id),style:{padding:"2px 6px",background:"rgba(248,113,113,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:12,cursor:"pointer"},children:""})]},u.id)}),o.jsxs("button",{onClick:Io,style:{width:"100%",padding:"8px",marginTop:8,background:"rgba(52,211,153,0.1)",border:"1px dashed rgba(52,211,153,0.5)",borderRadius:4,color:"#34d399",fontSize:11,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[o.jsx("span",{style:{fontSize:14},children:"+"})," Add Asset"]}),en.length>0&&o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"100px 180px 140px 90px 60px 60px 80px 30px",padding:"10px",background:"rgba(52,211,153,0.1)",borderRadius:4,fontSize:11,fontWeight:600,marginTop:8,borderTop:"2px solid rgba(75,85,99,0.3)",gap:8},children:[o.jsxs("span",{style:{gridColumn:"span 3"},children:["TOTAL (",en.length," assets)"]}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(Ml())}),o.jsx("span",{}),o.jsx("span",{}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#34d399"},children:ae(ss())}),o.jsx("span",{})]}),en.length>0&&o.jsxs("div",{style:{marginTop:12,padding:12,background:"rgba(17,24,39,0.3)",borderRadius:8,fontSize:10},children:[o.jsxs("div",{style:{fontWeight:600,color:"#a5b4fc",marginBottom:8},children:[" CA Breakdown for YA ",L]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:12},children:[o.jsxs("div",{style:{padding:10,background:"rgba(52,211,153,0.1)",borderRadius:6,borderLeft:"3px solid #34d399"},children:[o.jsx("div",{style:{fontSize:9,color:"#9ca3af"},children:"Initial Allowance (New Assets)"}),o.jsxs("div",{style:{fontSize:14,fontWeight:700,color:"#34d399",fontFamily:"monospace"},children:["RM ",ae(en.reduce((u,v)=>u+Fn(v).ia,0))]}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280",marginTop:2},children:[en.filter(u=>Fn(u).isCurrentYear).length," assets acquired in ",L]})]}),o.jsxs("div",{style:{padding:10,background:"rgba(96,165,250,0.1)",borderRadius:6,borderLeft:"3px solid #60a5fa"},children:[o.jsx("div",{style:{fontSize:9,color:"#9ca3af"},children:"Annual Allowance (All Assets)"}),o.jsxs("div",{style:{fontSize:14,fontWeight:700,color:"#60a5fa",fontFamily:"monospace"},children:["RM ",ae(en.reduce((u,v)=>u+Fn(v).aa,0))]}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280",marginTop:2},children:[en.length," qualifying assets"]})]}),o.jsxs("div",{style:{padding:10,background:"rgba(167,139,250,0.1)",borderRadius:6,borderLeft:"3px solid #a78bfa"},children:[o.jsx("div",{style:{fontSize:9,color:"#9ca3af"},children:"Total CA Claimed"}),o.jsxs("div",{style:{fontSize:14,fontWeight:700,color:"#a78bfa",fontFamily:"monospace"},children:["RM ",ae(ss())]}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280",marginTop:2},children:["IA + AA for YA ",L]})]})]})]}),o.jsxs("div",{style:{marginTop:12,padding:12,background:"rgba(99,102,241,0.1)",borderRadius:8,fontSize:10,color:"#9ca3af"},children:[o.jsx("div",{style:{fontWeight:600,color:"#a5b4fc",marginBottom:6},children:" Capital Allowance Rates (LHDN Schedule 3)"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:8,fontSize:9},children:[o.jsxs("div",{children:[o.jsx("span",{style:{color:"#6b7280"},children:"Plant & Machinery:"})," IA 20%, AA 14%"]}),o.jsxs("div",{children:[o.jsx("span",{style:{color:"#6b7280"},children:"Motor Vehicles:"})," IA 20%, AA 20%"]}),o.jsxs("div",{children:[o.jsx("span",{style:{color:"#6b7280"},children:"Computer/ICT:"})," IA 20%, AA 40%"]}),o.jsxs("div",{children:[o.jsx("span",{style:{color:"#6b7280"},children:"Office Equipment:"})," IA 20%, AA 10%"]}),o.jsxs("div",{children:[o.jsx("span",{style:{color:"#6b7280"},children:"Industrial Building:"})," IA 10%, AA 3%"]}),o.jsxs("div",{children:[o.jsx("span",{style:{color:"#6b7280"},children:"Environmental:"})," IA 40%, AA 20%"]}),o.jsxs("div",{children:[o.jsx("span",{style:{color:"#6b7280"},children:"Small Value (<RM2k):"})," AA 100%"]}),o.jsxs("div",{children:[o.jsx("span",{style:{color:"#6b7280"},children:"Heavy Machinery:"})," IA 20%, AA 10%"]})]}),o.jsxs("div",{style:{marginTop:8,fontSize:9,color:"#6b7280",borderTop:"1px solid rgba(75,85,99,0.2)",paddingTop:8},children:[o.jsx("strong",{children:"Note:"})," IA (Initial Allowance) is claimed in the year of acquisition only. AA (Annual Allowance) is claimed every year until the qualifying expenditure is fully absorbed. The total cost in CA Schedule should match PPE Subledger for reconciliation."]})]})]})]})]}),e==="snapshots"&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("button",{onClick:or,style:lr,children:" Tax"}),o.jsx("button",{onClick:_r,style:ja,children:"Dashboard "})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:12,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"16px 20px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(99,102,241,0.1), rgba(139,92,246,0.1))"},children:o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:700,fontSize:16},children:" FS Snapshots"}),o.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginTop:4},children:"Delivered financial statement packs"})]}),m&&o.jsx("button",{onClick:()=>{yt({periodType:"Monthly",periodLabel:`${L}-${String(new Date().getMonth()+1).padStart(2,"0")}`,note:"",createdBy:"Accountant"}),St(!0)},style:{padding:"8px 16px",background:"linear-gradient(135deg, #10b981, #059669)",border:"none",borderRadius:6,color:"#fff",fontSize:11,fontWeight:600,cursor:"pointer"},children:" Save Snapshot"})]})}),o.jsx("div",{style:{padding:16,maxHeight:400,overflowY:"auto"},children:gt.length>0?gt.map(u=>o.jsxs("div",{style:{background:"rgba(17,24,39,0.4)",borderRadius:8,border:"1px solid rgba(75,85,99,0.3)",marginBottom:8,padding:12},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("span",{style:{background:u.periodType==="Yearly"?"rgba(251,191,36,0.2)":"rgba(99,102,241,0.2)",color:u.periodType==="Yearly"?"#fbbf24":"#a5b4fc",padding:"2px 6px",borderRadius:4,fontSize:9},children:u.periodType}),o.jsx("span",{style:{fontWeight:700,fontSize:13},children:u.periodLabel}),o.jsxs("span",{style:{background:"rgba(52,211,153,0.2)",color:"#34d399",padding:"2px 6px",borderRadius:4,fontSize:9},children:["v",u.version]})]}),o.jsx("span",{style:{fontSize:9,color:"#6b7280"},children:new Date(u.createdAt).toLocaleDateString()})]}),u.note&&o.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:8,fontStyle:"italic"},children:['"',u.note,'"']}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{style:{fontSize:9,color:"#6b7280"},children:["Txs: ",(u.snapshotMeta?.counts?.bankTxs||0)+(u.snapshotMeta?.counts?.cashTxs||0)," | JEs: ",u.snapshotMeta?.counts?.jes||0]}),o.jsxs("div",{style:{display:"flex",gap:6},children:[o.jsx("button",{onClick:()=>Uo(u),style:{padding:"4px 8px",background:"rgba(99,102,241,0.2)",border:"none",borderRadius:4,color:"#a5b4fc",fontSize:9,cursor:"pointer"},children:"View"}),o.jsx("button",{onClick:()=>yf(u.id),style:{padding:"4px 8px",background:"rgba(239,68,68,0.15)",border:"none",borderRadius:4,color:"#fca5a5",fontSize:9,cursor:"pointer"},children:"Delete"})]})]})]},u.id)):o.jsxs("div",{style:{textAlign:"center",padding:30,color:"#6b7280"},children:[o.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),o.jsx("div",{style:{fontSize:12},children:"No snapshots yet"}),o.jsx("div",{style:{fontSize:10},children:"Generate FS and save a snapshot"})]})})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:12,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(251,191,36,0.1), rgba(245,158,11,0.1))",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:700,fontSize:16},children:" Adjustment Log"}),o.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginTop:4},children:"Track changes between versions"})]}),et.length>0&&o.jsxs("span",{style:{background:"rgba(251,191,36,0.2)",color:"#fbbf24",padding:"4px 10px",borderRadius:8,fontSize:11,fontWeight:600},children:[et.length," entries"]})]}),o.jsxs("div",{style:{padding:16},children:[o.jsxs("div",{style:{background:"rgba(17,24,39,0.4)",borderRadius:8,padding:12,marginBottom:12},children:[o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:8},children:" Add Manual Adjustment"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginBottom:8},children:[o.jsx("input",{type:"text",value:Ba.periodLabel,onChange:u=>Qa(v=>({...v,periodLabel:u.target.value})),placeholder:"Period (e.g. 2025-01)",style:{padding:"6px 8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:4,color:"#e5e7eb",fontSize:11}}),o.jsxs("select",{value:Ba.type,onChange:u=>Qa(v=>({...v,type:u.target.value})),style:{padding:"6px 8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:4,color:"#e5e7eb",fontSize:11},children:[o.jsx("option",{value:"Correction",children:"Correction"}),o.jsx("option",{value:"Reclass",children:"Reclass"}),o.jsx("option",{value:"Accrual",children:"Accrual"}),o.jsx("option",{value:"TaxAdj",children:"Tax Adjustment"}),o.jsx("option",{value:"Depreciation",children:"Depreciation"}),o.jsx("option",{value:"Other",children:"Other"})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr auto",gap:8},children:[o.jsx("input",{type:"number",value:Ba.amount,onChange:u=>Qa(v=>({...v,amount:u.target.value})),placeholder:"Amount",style:{padding:"6px 8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:4,color:"#e5e7eb",fontSize:11,textAlign:"right"}}),o.jsx("input",{type:"text",value:Ba.description,onChange:u=>Qa(v=>({...v,description:u.target.value})),placeholder:"Description",style:{padding:"6px 8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:4,color:"#e5e7eb",fontSize:11}}),o.jsx("button",{onClick:bf,style:{padding:"6px 12px",background:"linear-gradient(135deg, #fbbf24, #f59e0b)",border:"none",borderRadius:4,color:"#1f2937",fontSize:11,fontWeight:600,cursor:"pointer"},children:"+"})]})]}),o.jsx("div",{style:{maxHeight:350,overflowY:"auto"},children:et.length>0?et.map(u=>o.jsxs("div",{style:{padding:"10px 12px",borderBottom:"1px solid rgba(75,85,99,0.2)",fontSize:10,background:u.isAuto?"rgba(99,102,241,0.05)":"transparent"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,flexWrap:"wrap",marginBottom:4},children:[o.jsx("span",{style:{color:"#a5b4fc",fontWeight:700,fontSize:11},children:u.periodLabel}),u.category&&o.jsx("span",{style:{background:u.category.startsWith("IS")?"rgba(52,211,153,0.15)":u.category.startsWith("BS")?"rgba(59,130,246,0.15)":"rgba(107,114,128,0.15)",color:u.category.startsWith("IS")?"#34d399":u.category.startsWith("BS")?"#60a5fa":"#9ca3af",padding:"1px 5px",borderRadius:3,fontSize:8,fontWeight:600},children:u.category}),o.jsx("span",{style:{background:u.type==="TaxAdj"?"rgba(251,191,36,0.2)":u.type==="Depreciation"?"rgba(139,92,246,0.2)":u.type==="Reclass"?"rgba(236,72,153,0.2)":u.type==="Other"?"rgba(107,114,128,0.2)":"rgba(99,102,241,0.2)",color:u.type==="TaxAdj"?"#fbbf24":u.type==="Depreciation"?"#c4b5fd":u.type==="Reclass"?"#f472b6":u.type==="Other"?"#9ca3af":"#a5b4fc",padding:"1px 5px",borderRadius:3,fontSize:8,fontWeight:600},children:u.type}),u.isAuto&&o.jsx("span",{style:{background:"rgba(52,211,153,0.2)",color:"#34d399",padding:"1px 5px",borderRadius:3,fontSize:8,fontWeight:600},children:"AUTO"}),o.jsx("span",{style:{marginLeft:"auto",color:"#6b7280",fontSize:8},children:u.date})]}),u.field&&o.jsxs("div",{style:{color:"#e5e7eb",fontWeight:600,fontSize:11,marginBottom:2},children:[u.field,u.glCode&&o.jsxs("span",{style:{color:"#6b7280",fontWeight:400,marginLeft:4},children:["(",u.glCode,")"]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("div",{style:{color:"#9ca3af",fontSize:10},children:u.oldValue!==void 0&&u.newValue!==void 0?o.jsxs("span",{children:[o.jsx("span",{style:{color:"#f87171"},children:ae(u.oldValue)}),o.jsx("span",{style:{margin:"0 4px"},children:""}),o.jsx("span",{style:{color:"#34d399"},children:ae(u.newValue)})]}):u.description}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[u.amount!==0&&o.jsxs("span",{style:{fontFamily:"monospace",fontSize:11,padding:"2px 6px",borderRadius:4,background:u.amount>0?"rgba(52,211,153,0.15)":"rgba(248,113,113,0.15)",color:u.amount>0?"#34d399":"#f87171",fontWeight:700},children:[u.amount>0?"+":"",ae(u.amount)]}),o.jsx("button",{onClick:()=>Sf(u.id),style:{padding:"2px 5px",background:"rgba(239,68,68,0.15)",border:"none",borderRadius:3,color:"#fca5a5",fontSize:9,cursor:"pointer"},children:""})]})]})]},u.id)):o.jsx("div",{style:{textAlign:"center",padding:20,color:"#6b7280",fontSize:11},children:"No adjustments recorded"})})]})]})]})]}),aa&&o.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:100},children:o.jsxs("div",{style:{background:"#1f2937",borderRadius:12,padding:20,maxWidth:400,width:"90%"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},children:[o.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:700},children:" Save Snapshot"}),o.jsx("button",{onClick:()=>St(!1),style:{background:"none",border:"none",color:"#9ca3af",fontSize:18,cursor:"pointer"},children:""})]}),o.jsxs("div",{style:{display:"grid",gap:12},children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Period Type"}),o.jsxs("select",{value:Mt.periodType,onChange:u=>yt(v=>({...v,periodType:u.target.value})),style:{width:"100%",padding:"8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:12},children:[o.jsx("option",{value:"Monthly",children:"Monthly"}),o.jsx("option",{value:"Yearly",children:"Yearly"})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Period Label"}),o.jsx("input",{type:"text",value:Mt.periodLabel,onChange:u=>yt(v=>({...v,periodLabel:u.target.value})),placeholder:"2025-01",style:{width:"100%",padding:"8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:12,boxSizing:"border-box"}})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Created By"}),o.jsx("input",{type:"text",value:Mt.createdBy,onChange:u=>yt(v=>({...v,createdBy:u.target.value})),style:{width:"100%",padding:"8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:12,boxSizing:"border-box"}})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Note"}),o.jsx("textarea",{value:Mt.note,onChange:u=>yt(v=>({...v,note:u.target.value})),rows:2,placeholder:"Optional note...",style:{width:"100%",padding:"8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:12,resize:"none",boxSizing:"border-box"}})]}),o.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[o.jsx("button",{onClick:()=>St(!1),style:{padding:"8px 16px",background:"rgba(75,85,99,0.3)",border:"none",borderRadius:6,color:"#9ca3af",fontSize:12,cursor:"pointer"},children:"Cancel"}),o.jsx("button",{onClick:vf,style:{padding:"8px 16px",background:"linear-gradient(135deg, #10b981, #059669)",border:"none",borderRadius:6,color:"#fff",fontSize:12,fontWeight:600,cursor:"pointer"},children:"Save"})]})]})]})}),e==="dashboard"&&m&&(()=>{const u=pn();if(!u)return o.jsx("div",{style:{padding:20,textAlign:"center",color:"#9ca3af"},children:"Generate financial statements first to view dashboard."});const{kpis:v,ratios:b,comparatives:S,insights:T}=u,Q=({cy:ye,py:Fe,total:Ce,pyTotal:J,label:Y,color:ze,size:Le=70})=>{const me=Ce>0?ye/Ce*100:0,qe=J>0?Fe/J*100:0,Ye=2*Math.PI*28,ot=Ye-me/100*Ye,Xt=Ye-qe/100*Ye,ct=Fe>0?(ye-Fe)/Fe*100:ye>0?100:0;return o.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[o.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[o.jsxs("div",{style:{position:"relative"},children:[o.jsxs("svg",{width:Le,height:Le,viewBox:"0 0 64 64",children:[o.jsx("circle",{cx:"32",cy:"32",r:"28",fill:"none",stroke:"rgba(75,85,99,0.3)",strokeWidth:"6"}),o.jsx("circle",{cx:"32",cy:"32",r:"28",fill:"none",stroke:ze,strokeWidth:"6",strokeLinecap:"round",strokeDasharray:Ye,strokeDashoffset:ot,transform:"rotate(-90 32 32)"}),o.jsxs("text",{x:"32",y:"32",textAnchor:"middle",dominantBaseline:"middle",fill:"#e5e7eb",fontSize:"10",fontWeight:"700",fontFamily:"monospace",children:[me.toFixed(0),"%"]})]}),o.jsx("div",{style:{position:"absolute",bottom:-2,left:"50%",transform:"translateX(-50%)",fontSize:7,color:"#9ca3af",background:"rgba(17,24,39,0.8)",padding:"1px 4px",borderRadius:2},children:"CY"})]}),o.jsxs("div",{style:{position:"relative"},children:[o.jsxs("svg",{width:Le*.85,height:Le*.85,viewBox:"0 0 64 64",children:[o.jsx("circle",{cx:"32",cy:"32",r:"28",fill:"none",stroke:"rgba(75,85,99,0.2)",strokeWidth:"5"}),o.jsx("circle",{cx:"32",cy:"32",r:"28",fill:"none",stroke:`${ze}80`,strokeWidth:"5",strokeLinecap:"round",strokeDasharray:Ye,strokeDashoffset:Xt,transform:"rotate(-90 32 32)"}),o.jsxs("text",{x:"32",y:"32",textAnchor:"middle",dominantBaseline:"middle",fill:"#9ca3af",fontSize:"9",fontWeight:"600",fontFamily:"monospace",children:[qe.toFixed(0),"%"]})]}),o.jsx("div",{style:{position:"absolute",bottom:-2,left:"50%",transform:"translateX(-50%)",fontSize:7,color:"#6b7280",background:"rgba(17,24,39,0.8)",padding:"1px 4px",borderRadius:2},children:"PY"})]})]}),o.jsx("div",{style:{fontSize:9,color:"#9ca3af",marginTop:8,textAlign:"center"},children:Y}),o.jsxs("div",{style:{fontSize:8,padding:"2px 6px",borderRadius:3,marginTop:2,background:ct>=0?"rgba(52,211,153,0.2)":"rgba(248,113,113,0.2)",color:ct>=0?"#34d399":"#f87171"},children:[ct>=0?"":""," ",Math.abs(ct).toFixed(1),"%"]})]})},j=({cy:ye,py:Fe,label:Ce,color:J,maxVal:Y})=>{const ze=Fe>0?(ye-Fe)/Fe*100:ye>0?100:0,Le=Y>0?Math.abs(ye)/Y*100:0,me=Y>0?Math.abs(Fe)/Y*100:0;return o.jsxs("div",{style:{marginBottom:12},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[o.jsx("span",{style:{fontSize:10,color:"#e5e7eb",fontWeight:500},children:Ce}),o.jsxs("div",{style:{fontSize:9,padding:"2px 6px",borderRadius:4,background:ze>=0?"rgba(52,211,153,0.2)":"rgba(248,113,113,0.2)",color:ze>=0?"#34d399":"#f87171"},children:[ze>=0?"":""," ",Math.abs(ze).toFixed(1),"%"]})]}),o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:3},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("div",{style:{width:24,fontSize:8,color:"#9ca3af"},children:"CY"}),o.jsx("div",{style:{flex:1,height:18,background:"rgba(17,24,39,0.5)",borderRadius:4,overflow:"hidden"},children:o.jsx("div",{style:{height:"100%",width:`${Le}%`,background:`linear-gradient(90deg, ${J}, ${J}aa)`,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:6},children:o.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"#fff",fontWeight:600,textShadow:"0 1px 2px rgba(0,0,0,0.5)"},children:ae(ye)})})})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("div",{style:{width:24,fontSize:8,color:"#6b7280"},children:"PY"}),o.jsx("div",{style:{flex:1,height:14,background:"rgba(17,24,39,0.5)",borderRadius:3,overflow:"hidden"},children:o.jsx("div",{style:{height:"100%",width:`${me}%`,background:`${J}50`,borderRadius:3,border:`1px solid ${J}`,display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:6},children:o.jsx("span",{style:{fontSize:8,fontFamily:"monospace",color:"#9ca3af"},children:ae(Fe)})})})]})]})]})},C=({title:ye,value:Fe,min:Ce,max:J,target:Y,unit:ze=""})=>{const Le=Math.min(100,Math.max(0,(Fe-Ce)/(J-Ce)*100)),me=(Y-Ce)/(J-Ce)*100,qe=Fe>=Y;return o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:8,padding:10},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[o.jsx("span",{style:{fontSize:9,color:"#9ca3af",textTransform:"uppercase"},children:ye}),o.jsxs("span",{style:{fontSize:14,fontWeight:700,color:qe?"#34d399":"#fbbf24",fontFamily:"monospace"},children:[typeof Fe=="number"?Fe.toFixed(ze==="%"?1:2):Fe,ze]})]}),o.jsxs("div",{style:{height:5,background:"rgba(17,24,39,0.5)",borderRadius:3,overflow:"hidden",position:"relative"},children:[o.jsx("div",{style:{height:"100%",width:`${Le}%`,background:qe?"#34d399":"#fbbf24",borderRadius:3}}),o.jsx("div",{style:{position:"absolute",left:`${me}%`,top:-1,width:2,height:7,background:"#e5e7eb",borderRadius:1}})]}),o.jsxs("div",{style:{fontSize:7,color:"#6b7280",marginTop:3},children:["Target: ",Y,ze]})]})},M=Math.max(v.revenue,S.pyRevenue,v.grossProfit,S.pyGp,Math.abs(v.pat),Math.abs(S.pyPat),1),X=Math.max(v.totalAssets,S.pyTotalAssets,v.totalEquity,S.pyTotalEquity,v.totalLiabilities,m.bs.py_totL||0,1);return o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("button",{onClick:or,style:lr,children:" Tax Computation"}),o.jsx("span",{style:{fontWeight:700,fontSize:16},children:" Financial Dashboard"})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,fontSize:10},children:[o.jsx("span",{style:{width:12,height:12,background:"#60a5fa",borderRadius:2}}),o.jsxs("span",{style:{color:"#9ca3af"},children:["CY ",L]})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,fontSize:10},children:[o.jsx("span",{style:{width:12,height:12,background:"rgba(96,165,250,0.3)",border:"1px solid #60a5fa",borderRadius:2}}),o.jsxs("span",{style:{color:"#6b7280"},children:["PY ",fe]})]})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:12,border:"1px solid rgba(75,85,99,0.3)",padding:16},children:[o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:"#60a5fa",marginBottom:16,textTransform:"uppercase",letterSpacing:.5,display:"flex",alignItems:"center",gap:8},children:[o.jsx("span",{children:""})," Income Statement"]}),o.jsx(j,{cy:v.revenue,py:S.pyRevenue,label:"Revenue",color:"#60a5fa",maxVal:M}),o.jsx(j,{cy:v.grossProfit,py:S.pyGp,label:"Gross Profit",color:"#34d399",maxVal:M}),o.jsx(j,{cy:v.pat,py:S.pyPat,label:"Net Profit",color:v.pat>=0?"#a78bfa":"#f87171",maxVal:M})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:12,border:"1px solid rgba(75,85,99,0.3)",padding:16},children:[o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:"#34d399",marginBottom:16,textTransform:"uppercase",letterSpacing:.5,display:"flex",alignItems:"center",gap:8},children:[o.jsx("span",{children:""})," Balance Sheet"]}),o.jsx(j,{cy:v.totalAssets,py:S.pyTotalAssets,label:"Total Assets",color:"#60a5fa",maxVal:X}),o.jsx(j,{cy:v.totalEquity,py:S.pyTotalEquity,label:"Total Equity",color:"#34d399",maxVal:X}),o.jsx(j,{cy:v.totalLiabilities,py:m.bs.py_totL||0,label:"Total Liabilities",color:"#f87171",maxVal:X})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:16,marginBottom:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:12,border:"1px solid rgba(75,85,99,0.3)",padding:16},children:[o.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#9ca3af",marginBottom:12,textTransform:"uppercase",letterSpacing:.5},children:"Capital Structure (% of Assets)"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-around"},children:[o.jsx(Q,{cy:v.totalEquity,py:S.pyTotalEquity,total:v.totalAssets,pyTotal:S.pyTotalAssets,label:"Equity",color:"#34d399"}),o.jsx(Q,{cy:v.totalLiabilities,py:m.bs.py_totL||0,total:v.totalAssets,pyTotal:S.pyTotalAssets,label:"Liabilities",color:"#f87171"})]}),o.jsxs("div",{style:{marginTop:12,padding:8,background:"rgba(17,24,39,0.3)",borderRadius:6,fontSize:9,color:"#6b7280",textAlign:"center"},children:["Total Assets: CY ",o.jsx("span",{style:{color:"#e5e7eb",fontFamily:"monospace"},children:ae(v.totalAssets)})," vs PY ",o.jsx("span",{style:{color:"#9ca3af",fontFamily:"monospace"},children:ae(S.pyTotalAssets)})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:12,border:"1px solid rgba(75,85,99,0.3)",padding:16},children:[o.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#9ca3af",marginBottom:12,textTransform:"uppercase",letterSpacing:.5},children:"Key Financial Ratios"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:10},children:[o.jsx(C,{title:"Gross Margin",value:b.grossMargin,min:0,max:60,target:30,unit:"%"}),o.jsx(C,{title:"Operating Margin",value:b.operatingMargin,min:0,max:40,target:15,unit:"%"}),o.jsx(C,{title:"Return on Equity",value:b.roe,min:0,max:40,target:15,unit:"%"}),o.jsx(C,{title:"Current Ratio",value:b.currentRatio,min:0,max:4,target:1.5}),o.jsx(C,{title:"Cash Ratio",value:b.cashRatio,min:0,max:2,target:.5}),o.jsx(C,{title:"Debt to Equity",value:b.debtToEquity,min:0,max:3,target:1})]})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:12,border:"1px solid rgba(75,85,99,0.3)",padding:16},children:[o.jsxs("div",{style:{fontSize:12,fontWeight:700,color:"#f472b6",marginBottom:12,display:"flex",alignItems:"center",gap:8},children:[o.jsx("span",{children:""})," Financial Analysis & Insights"]}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:12,maxHeight:300,overflowY:"auto"},children:T.length>0?T.map((ye,Fe)=>o.jsxs("div",{style:{padding:12,background:ye.type==="success"?"rgba(52,211,153,0.1)":ye.type==="danger"?"rgba(248,113,113,0.1)":"rgba(251,191,36,0.1)",borderRadius:8,borderLeft:`3px solid ${ye.type==="success"?"#34d399":ye.type==="danger"?"#f87171":"#fbbf24"}`},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("span",{style:{fontSize:14},children:ye.icon}),o.jsx("span",{style:{fontSize:9,color:"#9ca3af",textTransform:"uppercase",letterSpacing:.5},children:ye.category})]}),o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#e5e7eb",marginBottom:4},children:ye.title}),o.jsx("div",{style:{fontSize:10,color:"#d1d5db",marginBottom:6},children:ye.text}),ye.detail&&o.jsxs("div",{style:{fontSize:9,color:"#9ca3af",padding:"8px",background:"rgba(17,24,39,0.3)",borderRadius:4},children:[" ",ye.detail]})]},Fe)):o.jsx("div",{style:{gridColumn:"span 2",color:"#6b7280",fontSize:11,fontStyle:"italic",textAlign:"center",padding:20},children:"No significant insights to report. The company appears to be in stable financial condition."})})]})]})})()]}),o.jsx("footer",{style:{padding:"12px 20px",borderTop:"1px solid rgba(75,85,99,0.2)",textAlign:"center",color:"#6b7280",fontSize:10},children:"Financial Statements Automation  Multi-Bank  12-Month  MFRS / IFRS / MPERS"})]})}R2.createRoot(document.getElementById("root")).render(o.jsx(dt.StrictMode,{children:o.jsx(N8,{})}));
