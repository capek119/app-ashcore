(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const f of c.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function t(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(s){if(s.ep)return;s.ep=!0;const c=t(s);fetch(s.href,c)}})();function v2(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var dp={exports:{}},Dc={};var _x;function b2(){if(_x)return Dc;_x=1;var e=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function t(i,s,c){var f=null;if(c!==void 0&&(f=""+c),s.key!==void 0&&(f=""+s.key),"key"in s){c={};for(var p in s)p!=="key"&&(c[p]=s[p])}else c=s;return s=c.ref,{$$typeof:e,type:i,key:f,ref:s!==void 0?s:null,props:c}}return Dc.Fragment=a,Dc.jsx=t,Dc.jsxs=t,Dc}var Cx;function S2(){return Cx||(Cx=1,dp.exports=b2()),dp.exports}var o=S2(),fp={exports:{}},_t={};var kx;function E2(){if(kx)return _t;kx=1;var e=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),f=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),_=Symbol.iterator;function w(ee){return ee===null||typeof ee!="object"?null:(ee=_&&ee[_]||ee["@@iterator"],typeof ee=="function"?ee:null)}var N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,F={};function z(ee,I,L){this.props=ee,this.context=I,this.refs=F,this.updater=L||N}z.prototype.isReactComponent={},z.prototype.setState=function(ee,I){if(typeof ee!="object"&&typeof ee!="function"&&ee!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ee,I,"setState")},z.prototype.forceUpdate=function(ee){this.updater.enqueueForceUpdate(this,ee,"forceUpdate")};function K(){}K.prototype=z.prototype;function M(ee,I,L){this.props=ee,this.context=I,this.refs=F,this.updater=L||N}var ie=M.prototype=new K;ie.constructor=M,k(ie,z.prototype),ie.isPureReactComponent=!0;var se=Array.isArray;function ne(){}var H={H:null,A:null,T:null,S:null},le=Object.prototype.hasOwnProperty;function oe(ee,I,L){var Q=L.ref;return{$$typeof:e,type:ee,key:I,ref:Q!==void 0?Q:null,props:L}}function m(ee,I){return oe(ee.type,I,ee.props)}function Se(ee){return typeof ee=="object"&&ee!==null&&ee.$$typeof===e}function ue(ee){var I={"=":"=0",":":"=2"};return"$"+ee.replace(/[=:]/g,function(L){return I[L]})}var Pe=/\/+/g;function et(ee,I){return typeof ee=="object"&&ee!==null&&ee.key!=null?ue(""+ee.key):I.toString(36)}function ke(ee){switch(ee.status){case"fulfilled":return ee.value;case"rejected":throw ee.reason;default:switch(typeof ee.status=="string"?ee.then(ne,ne):(ee.status="pending",ee.then(function(I){ee.status==="pending"&&(ee.status="fulfilled",ee.value=I)},function(I){ee.status==="pending"&&(ee.status="rejected",ee.reason=I)})),ee.status){case"fulfilled":return ee.value;case"rejected":throw ee.reason}}throw ee}function de(ee,I,L,Q,te){var ge=typeof ee;(ge==="undefined"||ge==="boolean")&&(ee=null);var je=!1;if(ee===null)je=!0;else switch(ge){case"bigint":case"string":case"number":je=!0;break;case"object":switch(ee.$$typeof){case e:case a:je=!0;break;case E:return je=ee._init,de(je(ee._payload),I,L,Q,te)}}if(je)return te=te(ee),je=Q===""?"."+et(ee,0):Q,se(te)?(L="",je!=null&&(L=je.replace(Pe,"$&/")+"/"),de(te,I,L,"",function(Ue){return Ue})):te!=null&&(Se(te)&&(te=m(te,L+(te.key==null||ee&&ee.key===te.key?"":(""+te.key).replace(Pe,"$&/")+"/")+je)),I.push(te)),1;je=0;var ze=Q===""?".":Q+":";if(se(ee))for(var Oe=0;Oe<ee.length;Oe++)Q=ee[Oe],ge=ze+et(Q,Oe),je+=de(Q,I,L,ge,te);else if(Oe=w(ee),typeof Oe=="function")for(ee=Oe.call(ee),Oe=0;!(Q=ee.next()).done;)Q=Q.value,ge=ze+et(Q,Oe++),je+=de(Q,I,L,ge,te);else if(ge==="object"){if(typeof ee.then=="function")return de(ke(ee),I,L,Q,te);throw I=String(ee),Error("Objects are not valid as a React child (found: "+(I==="[object Object]"?"object with keys {"+Object.keys(ee).join(", ")+"}":I)+"). If you meant to render a collection of children, use an array instead.")}return je}function Ce(ee,I,L){if(ee==null)return ee;var Q=[],te=0;return de(ee,Q,"","",function(ge){return I.call(L,ge,te++)}),Q}function Je(ee){if(ee._status===-1){var I=ee._result;I=I(),I.then(function(L){(ee._status===0||ee._status===-1)&&(ee._status=1,ee._result=L)},function(L){(ee._status===0||ee._status===-1)&&(ee._status=2,ee._result=L)}),ee._status===-1&&(ee._status=0,ee._result=I)}if(ee._status===1)return ee._result.default;throw ee._result}var fe=typeof reportError=="function"?reportError:function(ee){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var I=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ee=="object"&&ee!==null&&typeof ee.message=="string"?String(ee.message):String(ee),error:ee});if(!window.dispatchEvent(I))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ee);return}console.error(ee)},Ke={map:Ce,forEach:function(ee,I,L){Ce(ee,function(){I.apply(this,arguments)},L)},count:function(ee){var I=0;return Ce(ee,function(){I++}),I},toArray:function(ee){return Ce(ee,function(I){return I})||[]},only:function(ee){if(!Se(ee))throw Error("React.Children.only expected to receive a single React element child.");return ee}};return _t.Activity=A,_t.Children=Ke,_t.Component=z,_t.Fragment=t,_t.Profiler=s,_t.PureComponent=M,_t.StrictMode=i,_t.Suspense=g,_t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=H,_t.__COMPILER_RUNTIME={__proto__:null,c:function(ee){return H.H.useMemoCache(ee)}},_t.cache=function(ee){return function(){return ee.apply(null,arguments)}},_t.cacheSignal=function(){return null},_t.cloneElement=function(ee,I,L){if(ee==null)throw Error("The argument must be a React element, but you passed "+ee+".");var Q=k({},ee.props),te=ee.key;if(I!=null)for(ge in I.key!==void 0&&(te=""+I.key),I)!le.call(I,ge)||ge==="key"||ge==="__self"||ge==="__source"||ge==="ref"&&I.ref===void 0||(Q[ge]=I[ge]);var ge=arguments.length-2;if(ge===1)Q.children=L;else if(1<ge){for(var je=Array(ge),ze=0;ze<ge;ze++)je[ze]=arguments[ze+2];Q.children=je}return oe(ee.type,te,Q)},_t.createContext=function(ee){return ee={$$typeof:f,_currentValue:ee,_currentValue2:ee,_threadCount:0,Provider:null,Consumer:null},ee.Provider=ee,ee.Consumer={$$typeof:c,_context:ee},ee},_t.createElement=function(ee,I,L){var Q,te={},ge=null;if(I!=null)for(Q in I.key!==void 0&&(ge=""+I.key),I)le.call(I,Q)&&Q!=="key"&&Q!=="__self"&&Q!=="__source"&&(te[Q]=I[Q]);var je=arguments.length-2;if(je===1)te.children=L;else if(1<je){for(var ze=Array(je),Oe=0;Oe<je;Oe++)ze[Oe]=arguments[Oe+2];te.children=ze}if(ee&&ee.defaultProps)for(Q in je=ee.defaultProps,je)te[Q]===void 0&&(te[Q]=je[Q]);return oe(ee,ge,te)},_t.createRef=function(){return{current:null}},_t.forwardRef=function(ee){return{$$typeof:p,render:ee}},_t.isValidElement=Se,_t.lazy=function(ee){return{$$typeof:E,_payload:{_status:-1,_result:ee},_init:Je}},_t.memo=function(ee,I){return{$$typeof:h,type:ee,compare:I===void 0?null:I}},_t.startTransition=function(ee){var I=H.T,L={};H.T=L;try{var Q=ee(),te=H.S;te!==null&&te(L,Q),typeof Q=="object"&&Q!==null&&typeof Q.then=="function"&&Q.then(ne,fe)}catch(ge){fe(ge)}finally{I!==null&&L.types!==null&&(I.types=L.types),H.T=I}},_t.unstable_useCacheRefresh=function(){return H.H.useCacheRefresh()},_t.use=function(ee){return H.H.use(ee)},_t.useActionState=function(ee,I,L){return H.H.useActionState(ee,I,L)},_t.useCallback=function(ee,I){return H.H.useCallback(ee,I)},_t.useContext=function(ee){return H.H.useContext(ee)},_t.useDebugValue=function(){},_t.useDeferredValue=function(ee,I){return H.H.useDeferredValue(ee,I)},_t.useEffect=function(ee,I){return H.H.useEffect(ee,I)},_t.useEffectEvent=function(ee){return H.H.useEffectEvent(ee)},_t.useId=function(){return H.H.useId()},_t.useImperativeHandle=function(ee,I,L){return H.H.useImperativeHandle(ee,I,L)},_t.useInsertionEffect=function(ee,I){return H.H.useInsertionEffect(ee,I)},_t.useLayoutEffect=function(ee,I){return H.H.useLayoutEffect(ee,I)},_t.useMemo=function(ee,I){return H.H.useMemo(ee,I)},_t.useOptimistic=function(ee,I){return H.H.useOptimistic(ee,I)},_t.useReducer=function(ee,I,L){return H.H.useReducer(ee,I,L)},_t.useRef=function(ee){return H.H.useRef(ee)},_t.useState=function(ee){return H.H.useState(ee)},_t.useSyncExternalStore=function(ee,I,L){return H.H.useSyncExternalStore(ee,I,L)},_t.useTransition=function(){return H.H.useTransition()},_t.version="19.2.3",_t}var wx;function $p(){return wx||(wx=1,fp.exports=E2()),fp.exports}var dt=$p();const up=v2(dt);var pp={exports:{}},jc={},hp={exports:{}},gp={};var Rx;function T2(){return Rx||(Rx=1,(function(e){function a(de,Ce){var Je=de.length;de.push(Ce);e:for(;0<Je;){var fe=Je-1>>>1,Ke=de[fe];if(0<s(Ke,Ce))de[fe]=Ce,de[Je]=Ke,Je=fe;else break e}}function t(de){return de.length===0?null:de[0]}function i(de){if(de.length===0)return null;var Ce=de[0],Je=de.pop();if(Je!==Ce){de[0]=Je;e:for(var fe=0,Ke=de.length,ee=Ke>>>1;fe<ee;){var I=2*(fe+1)-1,L=de[I],Q=I+1,te=de[Q];if(0>s(L,Je))Q<Ke&&0>s(te,L)?(de[fe]=te,de[Q]=Je,fe=Q):(de[fe]=L,de[I]=Je,fe=I);else if(Q<Ke&&0>s(te,Je))de[fe]=te,de[Q]=Je,fe=Q;else break e}}return Ce}function s(de,Ce){var Je=de.sortIndex-Ce.sortIndex;return Je!==0?Je:de.id-Ce.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var f=Date,p=f.now();e.unstable_now=function(){return f.now()-p}}var g=[],h=[],E=1,A=null,_=3,w=!1,N=!1,k=!1,F=!1,z=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function ie(de){for(var Ce=t(h);Ce!==null;){if(Ce.callback===null)i(h);else if(Ce.startTime<=de)i(h),Ce.sortIndex=Ce.expirationTime,a(g,Ce);else break;Ce=t(h)}}function se(de){if(k=!1,ie(de),!N)if(t(g)!==null)N=!0,ne||(ne=!0,ue());else{var Ce=t(h);Ce!==null&&ke(se,Ce.startTime-de)}}var ne=!1,H=-1,le=5,oe=-1;function m(){return F?!0:!(e.unstable_now()-oe<le)}function Se(){if(F=!1,ne){var de=e.unstable_now();oe=de;var Ce=!0;try{e:{N=!1,k&&(k=!1,K(H),H=-1),w=!0;var Je=_;try{t:{for(ie(de),A=t(g);A!==null&&!(A.expirationTime>de&&m());){var fe=A.callback;if(typeof fe=="function"){A.callback=null,_=A.priorityLevel;var Ke=fe(A.expirationTime<=de);if(de=e.unstable_now(),typeof Ke=="function"){A.callback=Ke,ie(de),Ce=!0;break t}A===t(g)&&i(g),ie(de)}else i(g);A=t(g)}if(A!==null)Ce=!0;else{var ee=t(h);ee!==null&&ke(se,ee.startTime-de),Ce=!1}}break e}finally{A=null,_=Je,w=!1}Ce=void 0}}finally{Ce?ue():ne=!1}}}var ue;if(typeof M=="function")ue=function(){M(Se)};else if(typeof MessageChannel<"u"){var Pe=new MessageChannel,et=Pe.port2;Pe.port1.onmessage=Se,ue=function(){et.postMessage(null)}}else ue=function(){z(Se,0)};function ke(de,Ce){H=z(function(){de(e.unstable_now())},Ce)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(de){de.callback=null},e.unstable_forceFrameRate=function(de){0>de||125<de?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):le=0<de?Math.floor(1e3/de):5},e.unstable_getCurrentPriorityLevel=function(){return _},e.unstable_next=function(de){switch(_){case 1:case 2:case 3:var Ce=3;break;default:Ce=_}var Je=_;_=Ce;try{return de()}finally{_=Je}},e.unstable_requestPaint=function(){F=!0},e.unstable_runWithPriority=function(de,Ce){switch(de){case 1:case 2:case 3:case 4:case 5:break;default:de=3}var Je=_;_=de;try{return Ce()}finally{_=Je}},e.unstable_scheduleCallback=function(de,Ce,Je){var fe=e.unstable_now();switch(typeof Je=="object"&&Je!==null?(Je=Je.delay,Je=typeof Je=="number"&&0<Je?fe+Je:fe):Je=fe,de){case 1:var Ke=-1;break;case 2:Ke=250;break;case 5:Ke=1073741823;break;case 4:Ke=1e4;break;default:Ke=5e3}return Ke=Je+Ke,de={id:E++,callback:Ce,priorityLevel:de,startTime:Je,expirationTime:Ke,sortIndex:-1},Je>fe?(de.sortIndex=Je,a(h,de),t(g)===null&&de===t(h)&&(k?(K(H),H=-1):k=!0,ke(se,Je-fe))):(de.sortIndex=Ke,a(g,de),N||w||(N=!0,ne||(ne=!0,ue()))),de},e.unstable_shouldYield=m,e.unstable_wrapCallback=function(de){var Ce=_;return function(){var Je=_;_=Ce;try{return de.apply(this,arguments)}finally{_=Je}}}})(gp)),gp}var Nx;function A2(){return Nx||(Nx=1,hp.exports=T2()),hp.exports}var xp={exports:{}},Ir={};var Fx;function _2(){if(Fx)return Ir;Fx=1;var e=$p();function a(g){var h="https://react.dev/errors/"+g;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var E=2;E<arguments.length;E++)h+="&args[]="+encodeURIComponent(arguments[E])}return"Minified React error #"+g+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(a(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function c(g,h,E){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:A==null?null:""+A,children:g,containerInfo:h,implementation:E}}var f=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(g,h){if(g==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Ir.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Ir.createPortal=function(g,h){var E=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(a(299));return c(g,h,null,E)},Ir.flushSync=function(g){var h=f.T,E=i.p;try{if(f.T=null,i.p=2,g)return g()}finally{f.T=h,i.p=E,i.d.f()}},Ir.preconnect=function(g,h){typeof g=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,i.d.C(g,h))},Ir.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},Ir.preinit=function(g,h){if(typeof g=="string"&&h&&typeof h.as=="string"){var E=h.as,A=p(E,h.crossOrigin),_=typeof h.integrity=="string"?h.integrity:void 0,w=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;E==="style"?i.d.S(g,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:A,integrity:_,fetchPriority:w}):E==="script"&&i.d.X(g,{crossOrigin:A,integrity:_,fetchPriority:w,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Ir.preinitModule=function(g,h){if(typeof g=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var E=p(h.as,h.crossOrigin);i.d.M(g,{crossOrigin:E,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&i.d.M(g)},Ir.preload=function(g,h){if(typeof g=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var E=h.as,A=p(E,h.crossOrigin);i.d.L(g,E,{crossOrigin:A,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Ir.preloadModule=function(g,h){if(typeof g=="string")if(h){var E=p(h.as,h.crossOrigin);i.d.m(g,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:E,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else i.d.m(g)},Ir.requestFormReset=function(g){i.d.r(g)},Ir.unstable_batchedUpdates=function(g,h){return g(h)},Ir.useFormState=function(g,h,E){return f.H.useFormState(g,h,E)},Ir.useFormStatus=function(){return f.H.useHostTransitionStatus()},Ir.version="19.2.3",Ir}var Dx;function C2(){if(Dx)return xp.exports;Dx=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(a){console.error(a)}}return e(),xp.exports=_2(),xp.exports}var jx;function k2(){if(jx)return jc;jx=1;var e=A2(),a=$p(),t=C2();function i(r){var n="https://react.dev/errors/"+r;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)n+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+r+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function c(r){var n=r,l=r;if(r.alternate)for(;n.return;)n=n.return;else{r=n;do n=r,(n.flags&4098)!==0&&(l=n.return),r=n.return;while(r)}return n.tag===3?l:null}function f(r){if(r.tag===13){var n=r.memoizedState;if(n===null&&(r=r.alternate,r!==null&&(n=r.memoizedState)),n!==null)return n.dehydrated}return null}function p(r){if(r.tag===31){var n=r.memoizedState;if(n===null&&(r=r.alternate,r!==null&&(n=r.memoizedState)),n!==null)return n.dehydrated}return null}function g(r){if(c(r)!==r)throw Error(i(188))}function h(r){var n=r.alternate;if(!n){if(n=c(r),n===null)throw Error(i(188));return n!==r?null:r}for(var l=r,d=n;;){var x=l.return;if(x===null)break;var b=x.alternate;if(b===null){if(d=x.return,d!==null){l=d;continue}break}if(x.child===b.child){for(b=x.child;b;){if(b===l)return g(x),r;if(b===d)return g(x),n;b=b.sibling}throw Error(i(188))}if(l.return!==d.return)l=x,d=b;else{for(var R=!1,B=x.child;B;){if(B===l){R=!0,l=x,d=b;break}if(B===d){R=!0,d=x,l=b;break}B=B.sibling}if(!R){for(B=b.child;B;){if(B===l){R=!0,l=b,d=x;break}if(B===d){R=!0,d=b,l=x;break}B=B.sibling}if(!R)throw Error(i(189))}}if(l.alternate!==d)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?r:n}function E(r){var n=r.tag;if(n===5||n===26||n===27||n===6)return r;for(r=r.child;r!==null;){if(n=E(r),n!==null)return n;r=r.sibling}return null}var A=Object.assign,_=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),N=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),K=Symbol.for("react.consumer"),M=Symbol.for("react.context"),ie=Symbol.for("react.forward_ref"),se=Symbol.for("react.suspense"),ne=Symbol.for("react.suspense_list"),H=Symbol.for("react.memo"),le=Symbol.for("react.lazy"),oe=Symbol.for("react.activity"),m=Symbol.for("react.memo_cache_sentinel"),Se=Symbol.iterator;function ue(r){return r===null||typeof r!="object"?null:(r=Se&&r[Se]||r["@@iterator"],typeof r=="function"?r:null)}var Pe=Symbol.for("react.client.reference");function et(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===Pe?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case k:return"Fragment";case z:return"Profiler";case F:return"StrictMode";case se:return"Suspense";case ne:return"SuspenseList";case oe:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case N:return"Portal";case M:return r.displayName||"Context";case K:return(r._context.displayName||"Context")+".Consumer";case ie:var n=r.render;return r=r.displayName,r||(r=n.displayName||n.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case H:return n=r.displayName||null,n!==null?n:et(r.type)||"Memo";case le:n=r._payload,r=r._init;try{return et(r(n))}catch{}}return null}var ke=Array.isArray,de=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ce=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Je={pending:!1,data:null,method:null,action:null},fe=[],Ke=-1;function ee(r){return{current:r}}function I(r){0>Ke||(r.current=fe[Ke],fe[Ke]=null,Ke--)}function L(r,n){Ke++,fe[Ke]=r.current,r.current=n}var Q=ee(null),te=ee(null),ge=ee(null),je=ee(null);function ze(r,n){switch(L(ge,n),L(te,r),L(Q,null),n.nodeType){case 9:case 11:r=(r=n.documentElement)&&(r=r.namespaceURI)?X1(r):0;break;default:if(r=n.tagName,n=n.namespaceURI)n=X1(n),r=q1(n,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}I(Q),L(Q,r)}function Oe(){I(Q),I(te),I(ge)}function Ue(r){r.memoizedState!==null&&L(je,r);var n=Q.current,l=q1(n,r.type);n!==l&&(L(te,r),L(Q,l))}function St(r){te.current===r&&(I(Q),I(te)),je.current===r&&(I(je),wc._currentValue=Je)}var Z,Jt;function At(r){if(Z===void 0)try{throw Error()}catch(l){var n=l.stack.trim().match(/\n( *(at )?)/);Z=n&&n[1]||"",Jt=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Z+r+Jt}var Gt=!1;function Ct(r,n){if(!r||Gt)return"";Gt=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(n){var Le=function(){throw Error()};if(Object.defineProperty(Le.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Le,[])}catch(we){var _e=we}Reflect.construct(r,[],Le)}else{try{Le.call()}catch(we){_e=we}r.call(Le.prototype)}}else{try{throw Error()}catch(we){_e=we}(Le=r())&&typeof Le.catch=="function"&&Le.catch(function(){})}}catch(we){if(we&&_e&&typeof we.stack=="string")return[we.stack,_e.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=d.DetermineComponentFrameRoot(),R=b[0],B=b[1];if(R&&B){var re=R.split(`
`),be=B.split(`
`);for(x=d=0;d<re.length&&!re[d].includes("DetermineComponentFrameRoot");)d++;for(;x<be.length&&!be[x].includes("DetermineComponentFrameRoot");)x++;if(d===re.length||x===be.length)for(d=re.length-1,x=be.length-1;1<=d&&0<=x&&re[d]!==be[x];)x--;for(;1<=d&&0<=x;d--,x--)if(re[d]!==be[x]){if(d!==1||x!==1)do if(d--,x--,0>x||re[d]!==be[x]){var Fe=`
`+re[d].replace(" at new "," at ");return r.displayName&&Fe.includes("<anonymous>")&&(Fe=Fe.replace("<anonymous>",r.displayName)),Fe}while(1<=d&&0<=x);break}}}finally{Gt=!1,Error.prepareStackTrace=l}return(l=r?r.displayName||r.name:"")?At(l):""}function at(r,n){switch(r.tag){case 26:case 27:case 5:return At(r.type);case 16:return At("Lazy");case 13:return r.child!==n&&n!==null?At("Suspense Fallback"):At("Suspense");case 19:return At("SuspenseList");case 0:case 15:return Ct(r.type,!1);case 11:return Ct(r.type.render,!1);case 1:return Ct(r.type,!0);case 31:return At("Activity");default:return""}}function Ta(r){try{var n="",l=null;do n+=at(r,l),l=r,r=r.return;while(r);return n}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var Ia=Object.prototype.hasOwnProperty,nr=e.unstable_scheduleCallback,Yr=e.unstable_cancelCallback,Rn=e.unstable_shouldYield,Rr=e.unstable_requestPaint,Wt=e.unstable_now,br=e.unstable_getCurrentPriorityLevel,Sr=e.unstable_ImmediatePriority,Qr=e.unstable_UserBlockingPriority,Ea=e.unstable_NormalPriority,Dt=e.unstable_LowPriority,yt=e.unstable_IdlePriority,ma=e.log,Nr=e.unstable_setDisableYieldValue,ia=null,Ot=null;function Nn(r){if(typeof ma=="function"&&Nr(r),Ot&&typeof Ot.setStrictMode=="function")try{Ot.setStrictMode(ia,r)}catch{}}var Zt=Math.clz32?Math.clz32:Kl,Mt=Math.log,Fr=Math.LN2;function Kl(r){return r>>>=0,r===0?32:31-(Mt(r)/Fr|0)|0}var Qn=256,Jn=262144,yi=4194304;function Jr(r){var n=r&42;if(n!==0)return n;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function ya(r,n,l){var d=r.pendingLanes;if(d===0)return 0;var x=0,b=r.suspendedLanes,R=r.pingedLanes;r=r.warmLanes;var B=d&134217727;return B!==0?(d=B&~b,d!==0?x=Jr(d):(R&=B,R!==0?x=Jr(R):l||(l=B&~r,l!==0&&(x=Jr(l))))):(B=d&~b,B!==0?x=Jr(B):R!==0?x=Jr(R):l||(l=d&~r,l!==0&&(x=Jr(l)))),x===0?0:n!==0&&n!==x&&(n&b)===0&&(b=x&-x,l=n&-n,b>=l||b===32&&(l&4194048)!==0)?n:x}function Fn(r,n){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&n)===0}function Zn(r,n){switch(r){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cs(){var r=yi;return yi<<=1,(yi&62914560)===0&&(yi=4194304),r}function Xt(r){for(var n=[],l=0;31>l;l++)n.push(r);return n}function vi(r,n){r.pendingLanes|=n,n!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function ur(r,n,l,d,x,b){var R=r.pendingLanes;r.pendingLanes=l,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=l,r.entangledLanes&=l,r.errorRecoveryDisabledLanes&=l,r.shellSuspendCounter=0;var B=r.entanglements,re=r.expirationTimes,be=r.hiddenUpdates;for(l=R&~l;0<l;){var Fe=31-Zt(l),Le=1<<Fe;B[Fe]=0,re[Fe]=-1;var _e=be[Fe];if(_e!==null)for(be[Fe]=null,Fe=0;Fe<_e.length;Fe++){var we=_e[Fe];we!==null&&(we.lane&=-536870913)}l&=~Le}d!==0&&rl(r,d,0),b!==0&&x===0&&r.tag!==0&&(r.suspendedLanes|=b&~(R&~n))}function rl(r,n,l){r.pendingLanes|=n,r.suspendedLanes&=~n;var d=31-Zt(n);r.entangledLanes|=n,r.entanglements[d]=r.entanglements[d]|1073741824|l&261930}function Dn(r,n){var l=r.entangledLanes|=n;for(r=r.entanglements;l;){var d=31-Zt(l),x=1<<d;x&n|r[d]&n&&(r[d]|=n),l&=~x}}function Zr(r,n){var l=n&-n;return l=(l&42)!==0?1:jn(l),(l&(r.suspendedLanes|n))!==0?0:l}function jn(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function ds(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function j(){var r=Ce.p;return r!==0?r:(r=window.event,r===void 0?32:yx(r.type))}function q(r,n){var l=Ce.p;try{return Ce.p=r,n()}finally{Ce.p=l}}var P=Math.random().toString(36).slice(2),U="__reactFiber$"+P,Y="__reactProps$"+P,J="__reactContainer$"+P,Ee="__reactEvents$"+P,De="__reactListeners$"+P,me="__reactHandles$"+P,Te="__reactResources$"+P,Ae="__reactMarker$"+P;function Ge(r){delete r[U],delete r[Y],delete r[Ee],delete r[De],delete r[me]}function Ye(r){var n=r[U];if(n)return n;for(var l=r.parentNode;l;){if(n=l[J]||l[U]){if(l=n.alternate,n.child!==null||l!==null&&l.child!==null)for(r=ax(r);r!==null;){if(l=r[U])return l;r=ax(r)}return n}r=l,l=r.parentNode}return null}function Ze(r){if(r=r[U]||r[J]){var n=r.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return r}return null}function He(r){var n=r.tag;if(n===5||n===26||n===27||n===6)return r.stateNode;throw Error(i(33))}function Xe(r){var n=r[Te];return n||(n=r[Te]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function ct(r){r[Ae]=!0}var va=new Set,xt={};function ft(r,n){Ha(r,n),Ha(r+"Capture",n)}function Ha(r,n){for(xt[r]=n,r=0;r<n.length;r++)va.add(n[r])}var pr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Gr={},Aa={};function On(r){return Ia.call(Aa,r)?!0:Ia.call(Gr,r)?!1:pr.test(r)?Aa[r]=!0:(Gr[r]=!0,!1)}function sa(r,n,l){if(On(n))if(l===null)r.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":r.removeAttribute(n);return;case"boolean":var d=n.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){r.removeAttribute(n);return}}r.setAttribute(n,""+l)}}function ei(r,n,l){if(l===null)r.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(n);return}r.setAttribute(n,""+l)}}function hr(r,n,l,d){if(d===null)r.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(l);return}r.setAttributeNS(n,l,""+d)}}function ir(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function ti(r){var n=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function fs(r,n,l){var d=Object.getOwnPropertyDescriptor(r.constructor.prototype,n);if(!r.hasOwnProperty(n)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var x=d.get,b=d.set;return Object.defineProperty(r,n,{configurable:!0,get:function(){return x.call(this)},set:function(R){l=""+R,b.call(this,R)}}),Object.defineProperty(r,n,{enumerable:d.enumerable}),{getValue:function(){return l},setValue:function(R){l=""+R},stopTracking:function(){r._valueTracker=null,delete r[n]}}}}function en(r){if(!r._valueTracker){var n=ti(r)?"checked":"value";r._valueTracker=fs(r,n,""+r[n])}}function ji(r){if(!r)return!1;var n=r._valueTracker;if(!n)return!0;var l=n.getValue(),d="";return r&&(d=ti(r)?r.checked?"true":"false":r.value),r=d,r!==l?(n.setValue(r),!0):!1}function Dr(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var nl=/[\n"\\]/g;function Ra(r){return r.replace(nl,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function Oi(r,n,l,d,x,b,R,B){r.name="",R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?r.type=R:r.removeAttribute("type"),n!=null?R==="number"?(n===0&&r.value===""||r.value!=n)&&(r.value=""+ir(n)):r.value!==""+ir(n)&&(r.value=""+ir(n)):R!=="submit"&&R!=="reset"||r.removeAttribute("value"),n!=null?In(r,R,ir(n)):l!=null?In(r,R,ir(l)):d!=null&&r.removeAttribute("value"),x==null&&b!=null&&(r.defaultChecked=!!b),x!=null&&(r.checked=x&&typeof x!="function"&&typeof x!="symbol"),B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?r.name=""+ir(B):r.removeAttribute("name")}function h0(r,n,l,d,x,b,R,B){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(r.type=b),n!=null||l!=null){if(!(b!=="submit"&&b!=="reset"||n!=null)){en(r);return}l=l!=null?""+ir(l):"",n=n!=null?""+ir(n):l,B||n===r.value||(r.value=n),r.defaultValue=n}d=d??x,d=typeof d!="function"&&typeof d!="symbol"&&!!d,r.checked=B?r.checked:!!d,r.defaultChecked=!!d,R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(r.name=R),en(r)}function In(r,n,l){n==="number"&&Dr(r.ownerDocument)===r||r.defaultValue===""+l||(r.defaultValue=""+l)}function us(r,n,l,d){if(r=r.options,n){n={};for(var x=0;x<l.length;x++)n["$"+l[x]]=!0;for(l=0;l<r.length;l++)x=n.hasOwnProperty("$"+r[l].value),r[l].selected!==x&&(r[l].selected=x),x&&d&&(r[l].defaultSelected=!0)}else{for(l=""+ir(l),n=null,x=0;x<r.length;x++){if(r[x].value===l){r[x].selected=!0,d&&(r[x].defaultSelected=!0);return}n!==null||r[x].disabled||(n=r[x])}n!==null&&(n.selected=!0)}}function g0(r,n,l){if(n!=null&&(n=""+ir(n),n!==r.value&&(r.value=n),l==null)){r.defaultValue!==n&&(r.defaultValue=n);return}r.defaultValue=l!=null?""+ir(l):""}function x0(r,n,l,d){if(n==null){if(d!=null){if(l!=null)throw Error(i(92));if(ke(d)){if(1<d.length)throw Error(i(93));d=d[0]}l=d}l==null&&(l=""),n=l}l=ir(n),r.defaultValue=l,d=r.textContent,d===l&&d!==""&&d!==null&&(r.value=d),en(r)}function Ii(r,n){if(n){var l=r.firstChild;if(l&&l===r.lastChild&&l.nodeType===3){l.nodeValue=n;return}}r.textContent=n}var Ql=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Bi(r,n,l){var d=n.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?d?r.setProperty(n,""):n==="float"?r.cssFloat="":r[n]="":d?r.setProperty(n,l):typeof l!="number"||l===0||Ql.has(n)?n==="float"?r.cssFloat=l:r[n]=(""+l).trim():r[n]=l+"px"}function m0(r,n,l){if(n!=null&&typeof n!="object")throw Error(i(62));if(r=r.style,l!=null){for(var d in l)!l.hasOwnProperty(d)||n!=null&&n.hasOwnProperty(d)||(d.indexOf("--")===0?r.setProperty(d,""):d==="float"?r.cssFloat="":r[d]="");for(var x in n)d=n[x],n.hasOwnProperty(x)&&l[x]!==d&&Bi(r,x,d)}else for(var b in n)n.hasOwnProperty(b)&&Bi(r,b,n[b])}function Yo(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var y0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),xf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function il(r){return xf.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function pn(){}var ps=null;function hs(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var gs=null,ai=null;function v0(r){var n=Ze(r);if(n&&(r=n.stateNode)){var l=r[Y]||null;e:switch(r=n.stateNode,n.type){case"input":if(Oi(r,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),n=l.name,l.type==="radio"&&n!=null){for(l=r;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Ra(""+n)+'"][type="radio"]'),n=0;n<l.length;n++){var d=l[n];if(d!==r&&d.form===r.form){var x=d[Y]||null;if(!x)throw Error(i(90));Oi(d,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(n=0;n<l.length;n++)d=l[n],d.form===r.form&&ji(d)}break e;case"textarea":g0(r,l.value,l.defaultValue);break e;case"select":n=l.value,n!=null&&us(r,!!l.multiple,n,!1)}}}var Mi=!1;function xs(r,n,l){if(Mi)return r(n,l);Mi=!0;try{var d=r(n);return d}finally{if(Mi=!1,(gs!==null||ai!==null)&&(pd(),gs&&(n=gs,r=ai,ai=gs=null,v0(n),r)))for(n=0;n<r.length;n++)v0(r[n])}}function Li(r,n){var l=r.stateNode;if(l===null)return null;var d=l[Y]||null;if(d===null)return null;l=d[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(r=r.type,d=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!d;break e;default:r=!1}if(r)return null;if(l&&typeof l!="function")throw Error(i(231,n,typeof l));return l}var hn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ms=!1;if(hn)try{var sl={};Object.defineProperty(sl,"passive",{get:function(){ms=!0}}),window.addEventListener("test",sl,sl),window.removeEventListener("test",sl,sl)}catch{ms=!1}var gn=null,Go=null,Jl=null;function ll(){if(Jl)return Jl;var r,n=Go,l=n.length,d,x="value"in gn?gn.value:gn.textContent,b=x.length;for(r=0;r<l&&n[r]===x[r];r++);var R=l-r;for(d=1;d<=R&&n[l-d]===x[b-d];d++);return Jl=x.slice(r,1<d?1-d:void 0)}function Zl(r){var n=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&n===13&&(r=13)):r=n,r===10&&(r=13),32<=r||r===13?r:0}function eo(){return!0}function ol(){return!1}function jr(r){function n(l,d,x,b,R){this._reactName=l,this._targetInst=x,this.type=d,this.nativeEvent=b,this.target=R,this.currentTarget=null;for(var B in r)r.hasOwnProperty(B)&&(l=r[B],this[B]=l?l(b):b[B]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?eo:ol,this.isPropagationStopped=ol,this}return A(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=eo)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=eo)},persist:function(){},isPersistent:eo}),n}var Pi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ys=jr(Pi),cl=A({},Pi,{view:0,detail:0}),mf=jr(cl),dl,Wo,fl,vs=A({},cl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xo,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==fl&&(fl&&r.type==="mousemove"?(dl=r.screenX-fl.screenX,Wo=r.screenY-fl.screenY):Wo=dl=0,fl=r),dl)},movementY:function(r){return"movementY"in r?r.movementY:Wo}}),b0=jr(vs),yf=A({},vs,{dataTransfer:0}),ul=jr(yf),vf=A({},cl,{relatedTarget:0}),Vo=jr(vf),pl=A({},Pi,{animationName:0,elapsedTime:0,pseudoElement:0}),bf=jr(pl),rt=A({},Pi,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),bs=jr(rt),hl=A({},Pi,{data:0}),zi=jr(hl),gl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Or={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Bn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sf(r){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(r):(r=Bn[r])?!!n[r]:!1}function Xo(){return Sf}var Ef=A({},cl,{key:function(r){if(r.key){var n=gl[r.key]||r.key;if(n!=="Unidentified")return n}return r.type==="keypress"?(r=Zl(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Or[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xo,charCode:function(r){return r.type==="keypress"?Zl(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Zl(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),tt=jr(Ef),Ss=A({},vs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Tt=jr(Ss),Tf=A({},cl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xo}),S0=jr(Tf),Af=A({},Pi,{propertyName:0,elapsedTime:0,pseudoElement:0}),_f=jr(Af),Cf=A({},vs,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),kf=jr(Cf),wf=A({},Pi,{newState:0,oldState:0}),Rf=jr(wf),xl=[9,13,27,32],qo=hn&&"CompositionEvent"in window,ml=null;hn&&"documentMode"in document&&(ml=document.documentMode);var Nf=hn&&"TextEvent"in window&&!ml,E0=hn&&(!qo||ml&&8<ml&&11>=ml),T0=" ",A0=!1;function _0(r,n){switch(r){case"keyup":return xl.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function C0(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Es=!1;function k0(r,n){switch(r){case"compositionend":return C0(n);case"keypress":return n.which!==32?null:(A0=!0,T0);case"textInput":return r=n.data,r===T0&&A0?null:r;default:return null}}function Ff(r,n){if(Es)return r==="compositionend"||!qo&&_0(r,n)?(r=ll(),Jl=Go=gn=null,Es=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return E0&&n.locale!=="ko"?null:n.data;default:return null}}var bi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function w0(r){var n=r&&r.nodeName&&r.nodeName.toLowerCase();return n==="input"?!!bi[r.type]:n==="textarea"}function R0(r,n,l,d){gs?ai?ai.push(d):ai=[d]:gs=d,n=bd(n,"onChange"),0<n.length&&(l=new ys("onChange","change",null,l,d),r.push({event:l,listeners:n}))}var Ts=null,gr=null;function N0(r){H1(r,0)}function As(r){var n=He(r);if(ji(n))return r}function yl(r,n){if(r==="change")return n}var ea=!1;if(hn){var Ko;if(hn){var _s="oninput"in document;if(!_s){var Rt=document.createElement("div");Rt.setAttribute("oninput","return;"),_s=typeof Rt.oninput=="function"}Ko=_s}else Ko=!1;ea=Ko&&(!document.documentMode||9<document.documentMode)}function Na(){Ts&&(Ts.detachEvent("onpropertychange",Cs),gr=Ts=null)}function Cs(r){if(r.propertyName==="value"&&As(gr)){var n=[];R0(n,gr,r,hs(r)),xs(N0,n)}}function F0(r,n,l){r==="focusin"?(Na(),Ts=n,gr=l,Ts.attachEvent("onpropertychange",Cs)):r==="focusout"&&Na()}function D0(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return As(gr)}function Df(r,n){if(r==="click")return As(n)}function jf(r,n){if(r==="input"||r==="change")return As(n)}function to(r,n){return r===n&&(r!==0||1/r===1/n)||r!==r&&n!==n}var tn=typeof Object.is=="function"?Object.is:to;function ao(r,n){if(tn(r,n))return!0;if(typeof r!="object"||r===null||typeof n!="object"||n===null)return!1;var l=Object.keys(r),d=Object.keys(n);if(l.length!==d.length)return!1;for(d=0;d<l.length;d++){var x=l[d];if(!Ia.call(n,x)||!tn(r[x],n[x]))return!1}return!0}function j0(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Ui(r,n){var l=j0(r);r=0;for(var d;l;){if(l.nodeType===3){if(d=r+l.textContent.length,r<=n&&d>=n)return{node:l,offset:n-r};r=d}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=j0(l)}}function vl(r,n){return r&&n?r===n?!0:r&&r.nodeType===3?!1:n&&n.nodeType===3?vl(r,n.parentNode):"contains"in r?r.contains(n):r.compareDocumentPosition?!!(r.compareDocumentPosition(n)&16):!1:!1}function Qo(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var n=Dr(r.document);n instanceof r.HTMLIFrameElement;){try{var l=typeof n.contentWindow.location.href=="string"}catch{l=!1}if(l)r=n.contentWindow;else break;n=Dr(r.document)}return n}function ro(r){var n=r&&r.nodeName&&r.nodeName.toLowerCase();return n&&(n==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||n==="textarea"||r.contentEditable==="true")}var O0=hn&&"documentMode"in document&&11>=document.documentMode,ks=null,Jo=null,bl=null,xn=!1;function no(r,n,l){var d=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;xn||ks==null||ks!==Dr(d)||(d=ks,"selectionStart"in d&&ro(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),bl&&ao(bl,d)||(bl=d,d=bd(Jo,"onSelect"),0<d.length&&(n=new ys("onSelect","select",null,n,l),r.push({event:n,listeners:d}),n.target=ks)))}function ri(r,n){var l={};return l[r.toLowerCase()]=n.toLowerCase(),l["Webkit"+r]="webkit"+n,l["Moz"+r]="moz"+n,l}var Si={animationend:ri("Animation","AnimationEnd"),animationiteration:ri("Animation","AnimationIteration"),animationstart:ri("Animation","AnimationStart"),transitionrun:ri("Transition","TransitionRun"),transitionstart:ri("Transition","TransitionStart"),transitioncancel:ri("Transition","TransitionCancel"),transitionend:ri("Transition","TransitionEnd")},Sl={},io={};hn&&(io=document.createElement("div").style,"AnimationEvent"in window||(delete Si.animationend.animation,delete Si.animationiteration.animation,delete Si.animationstart.animation),"TransitionEvent"in window||delete Si.transitionend.transition);function ni(r){if(Sl[r])return Sl[r];if(!Si[r])return r;var n=Si[r],l;for(l in n)if(n.hasOwnProperty(l)&&l in io)return Sl[r]=n[l];return r}var so=ni("animationend"),I0=ni("animationiteration"),B0=ni("animationstart"),M0=ni("transitionrun"),Of=ni("transitionstart"),If=ni("transitioncancel"),Zo=ni("transitionend"),L0=new Map,ec="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ec.push("scrollEnd");function Mn(r,n){L0.set(r,n),ft(n,[r])}var Ei=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},nt=[],jt=0,$a=0;function ua(){for(var r=jt,n=$a=jt=0;n<r;){var l=nt[n];nt[n++]=null;var d=nt[n];nt[n++]=null;var x=nt[n];nt[n++]=null;var b=nt[n];if(nt[n++]=null,d!==null&&x!==null){var R=d.pending;R===null?x.next=x:(x.next=R.next,R.next=x),d.pending=x}b!==0&&lr(l,x,b)}}function Ya(r,n,l,d){nt[jt++]=r,nt[jt++]=n,nt[jt++]=l,nt[jt++]=d,$a|=d,r.lanes|=d,r=r.alternate,r!==null&&(r.lanes|=d)}function sr(r,n,l,d){return Ya(r,n,l,d),or(r)}function mn(r,n){return Ya(r,null,null,n),or(r)}function lr(r,n,l){r.lanes|=l;var d=r.alternate;d!==null&&(d.lanes|=l);for(var x=!1,b=r.return;b!==null;)b.childLanes|=l,d=b.alternate,d!==null&&(d.childLanes|=l),b.tag===22&&(r=b.stateNode,r===null||r._visibility&1||(x=!0)),r=b,b=b.return;return r.tag===3?(b=r.stateNode,x&&n!==null&&(x=31-Zt(l),r=b.hiddenUpdates,d=r[x],d===null?r[x]=[n]:d.push(n),n.lane=l|536870912),b):null}function or(r){if(50<Sc)throw Sc=0,Ou=null,Error(i(185));for(var n=r.return;n!==null;)r=n,n=r.return;return r.tag===3?r.stateNode:null}var u={};function y(r,n,l,d){this.tag=r,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function v(r,n,l,d){return new y(r,n,l,d)}function S(r){return r=r.prototype,!(!r||!r.isReactComponent)}function T(r,n){var l=r.alternate;return l===null?(l=v(r.tag,n,r.key,r.mode),l.elementType=r.elementType,l.type=r.type,l.stateNode=r.stateNode,l.alternate=r,r.alternate=l):(l.pendingProps=n,l.type=r.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=r.flags&65011712,l.childLanes=r.childLanes,l.lanes=r.lanes,l.child=r.child,l.memoizedProps=r.memoizedProps,l.memoizedState=r.memoizedState,l.updateQueue=r.updateQueue,n=r.dependencies,l.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},l.sibling=r.sibling,l.index=r.index,l.ref=r.ref,l.refCleanup=r.refCleanup,l}function W(r,n){r.flags&=65011714;var l=r.alternate;return l===null?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=l.childLanes,r.lanes=l.lanes,r.child=l.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,r.type=l.type,n=l.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),r}function D(r,n,l,d,x,b){var R=0;if(d=r,typeof r=="function")S(r)&&(R=1);else if(typeof r=="string")R=l2(r,l,Q.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case oe:return r=v(31,l,n,x),r.elementType=oe,r.lanes=b,r;case k:return C(l.children,x,b,n);case F:R=8,x|=24;break;case z:return r=v(12,l,n,x|2),r.elementType=z,r.lanes=b,r;case se:return r=v(13,l,n,x),r.elementType=se,r.lanes=b,r;case ne:return r=v(19,l,n,x),r.elementType=ne,r.lanes=b,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case M:R=10;break e;case K:R=9;break e;case ie:R=11;break e;case H:R=14;break e;case le:R=16,d=null;break e}R=29,l=Error(i(130,r===null?"null":typeof r,"")),d=null}return n=v(R,l,n,x),n.elementType=r,n.type=d,n.lanes=b,n}function C(r,n,l,d){return r=v(7,r,d,n),r.lanes=l,r}function O(r,n,l){return r=v(6,r,null,n),r.lanes=l,r}function G(r){var n=v(18,null,null,0);return n.stateNode=r,n}function xe(r,n,l){return n=v(4,r.children!==null?r.children:[],r.key,n),n.lanes=l,n.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},n}var Re=new WeakMap;function ye(r,n){if(typeof r=="object"&&r!==null){var l=Re.get(r);return l!==void 0?l:(n={value:r,source:n,stack:Ta(n)},Re.set(r,n),n)}return{value:r,source:n,stack:Ta(n)}}var X=[],V=0,Me=null,Be=0,pe=[],We=0,Ve=null,it=1,Vt="";function lt(r,n){X[V++]=Be,X[V++]=Me,Me=r,Be=n}function Fa(r,n,l){pe[We++]=it,pe[We++]=Vt,pe[We++]=Ve,Ve=r;var d=it;r=Vt;var x=32-Zt(d)-1;d&=~(1<<x),l+=1;var b=32-Zt(n)+x;if(30<b){var R=x-x%5;b=(d&(1<<R)-1).toString(32),d>>=R,x-=R,it=1<<32-Zt(n)+x|l<<x|d,Vt=b+r}else it=1<<b|l<<x|d,Vt=r}function Ka(r){r.return!==null&&(lt(r,1),Fa(r,1,0))}function Wr(r){for(;r===Me;)Me=X[--V],X[V]=null,Be=X[--V],X[V]=null;for(;r===Ve;)Ve=pe[--We],pe[We]=null,Vt=pe[--We],pe[We]=null,it=pe[--We],pe[We]=null}function st(r,n){pe[We++]=it,pe[We++]=Vt,pe[We++]=Ve,it=n.id,Vt=n.overflow,Ve=r}var zt=null,Ut=null,vt=!1,an=null,qt=!1,ii=Error(i(519));function Ln(r){var n=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw El(ye(n,r)),ii}function ws(r){var n=r.stateNode,l=r.type,d=r.memoizedProps;switch(n[U]=r,n[Y]=d,l){case"dialog":Pt("cancel",n),Pt("close",n);break;case"iframe":case"object":case"embed":Pt("load",n);break;case"video":case"audio":for(l=0;l<Tc.length;l++)Pt(Tc[l],n);break;case"source":Pt("error",n);break;case"img":case"image":case"link":Pt("error",n),Pt("load",n);break;case"details":Pt("toggle",n);break;case"input":Pt("invalid",n),h0(n,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":Pt("invalid",n);break;case"textarea":Pt("invalid",n),x0(n,d.value,d.defaultValue,d.children)}l=d.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||n.textContent===""+l||d.suppressHydrationWarning===!0||W1(n.textContent,l)?(d.popover!=null&&(Pt("beforetoggle",n),Pt("toggle",n)),d.onScroll!=null&&Pt("scroll",n),d.onScrollEnd!=null&&Pt("scrollend",n),d.onClick!=null&&(n.onclick=pn),n=!0):n=!1,n||Ln(r,!0)}function tc(r){for(zt=r.return;zt;)switch(zt.tag){case 5:case 31:case 13:qt=!1;return;case 27:case 3:qt=!0;return;default:zt=zt.return}}function si(r){if(r!==zt)return!1;if(!vt)return tc(r),vt=!0,!1;var n=r.tag,l;if((l=n!==3&&n!==27)&&((l=n===5)&&(l=r.type,l=!(l!=="form"&&l!=="button")||qu(r.type,r.memoizedProps)),l=!l),l&&Ut&&Ln(r),tc(r),n===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));Ut=tx(r)}else if(n===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));Ut=tx(r)}else n===27?(n=Ut,Us(r.type)?(r=ep,ep=null,Ut=r):Ut=n):Ut=zt?zn(r.stateNode.nextSibling):null;return!0}function Hi(){Ut=zt=null,vt=!1}function Ti(){var r=an;return r!==null&&(ln===null?ln=r:ln.push.apply(ln,r),an=null),r}function El(r){an===null?an=[r]:an.push(r)}var $i=ee(null),yn=null,li=null;function Ai(r,n,l){L($i,n._currentValue),n._currentValue=l}function oi(r){r._currentValue=$i.current,I($i)}function Ba(r,n,l){for(;r!==null;){var d=r.alternate;if((r.childLanes&n)!==n?(r.childLanes|=n,d!==null&&(d.childLanes|=n)):d!==null&&(d.childLanes&n)!==n&&(d.childLanes|=n),r===l)break;r=r.return}}function ci(r,n,l,d){var x=r.child;for(x!==null&&(x.return=r);x!==null;){var b=x.dependencies;if(b!==null){var R=x.child;b=b.firstContext;e:for(;b!==null;){var B=b;b=x;for(var re=0;re<n.length;re++)if(B.context===n[re]){b.lanes|=l,B=b.alternate,B!==null&&(B.lanes|=l),Ba(b.return,l,r),d||(R=null);break e}b=B.next}}else if(x.tag===18){if(R=x.return,R===null)throw Error(i(341));R.lanes|=l,b=R.alternate,b!==null&&(b.lanes|=l),Ba(R,l,r),R=null}else R=x.child;if(R!==null)R.return=x;else for(R=x;R!==null;){if(R===r){R=null;break}if(x=R.sibling,x!==null){x.return=R.return,R=x;break}R=R.return}x=R}}function Er(r,n,l,d){r=null;for(var x=n,b=!1;x!==null;){if(!b){if((x.flags&524288)!==0)b=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var R=x.alternate;if(R===null)throw Error(i(387));if(R=R.memoizedProps,R!==null){var B=x.type;tn(x.pendingProps.value,R.value)||(r!==null?r.push(B):r=[B])}}else if(x===je.current){if(R=x.alternate,R===null)throw Error(i(387));R.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(r!==null?r.push(wc):r=[wc])}x=x.return}r!==null&&ci(n,r,l,d),n.flags|=262144}function P0(r){for(r=r.firstContext;r!==null;){if(!tn(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Tl(r){yn=r,li=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Tr(r){return Fh(yn,r)}function z0(r,n){return yn===null&&Tl(r),Fh(r,n)}function Fh(r,n){var l=n._currentValue;if(n={context:n,memoizedValue:l,next:null},li===null){if(r===null)throw Error(i(308));li=n,r.dependencies={lanes:0,firstContext:n},r.flags|=524288}else li=li.next=n;return l}var rb=typeof AbortController<"u"?AbortController:function(){var r=[],n=this.signal={aborted:!1,addEventListener:function(l,d){r.push(d)}};this.abort=function(){n.aborted=!0,r.forEach(function(l){return l()})}},nb=e.unstable_scheduleCallback,ib=e.unstable_NormalPriority,Qa={$$typeof:M,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Bf(){return{controller:new rb,data:new Map,refCount:0}}function ac(r){r.refCount--,r.refCount===0&&nb(ib,function(){r.controller.abort()})}var rc=null,Mf=0,lo=0,oo=null;function sb(r,n){if(rc===null){var l=rc=[];Mf=0,lo=zu(),oo={status:"pending",value:void 0,then:function(d){l.push(d)}}}return Mf++,n.then(Dh,Dh),n}function Dh(){if(--Mf===0&&rc!==null){oo!==null&&(oo.status="fulfilled");var r=rc;rc=null,lo=0,oo=null;for(var n=0;n<r.length;n++)(0,r[n])()}}function lb(r,n){var l=[],d={status:"pending",value:null,reason:null,then:function(x){l.push(x)}};return r.then(function(){d.status="fulfilled",d.value=n;for(var x=0;x<l.length;x++)(0,l[x])(n)},function(x){for(d.status="rejected",d.reason=x,x=0;x<l.length;x++)(0,l[x])(void 0)}),d}var jh=de.S;de.S=function(r,n){x1=Wt(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&sb(r,n),jh!==null&&jh(r,n)};var Al=ee(null);function Lf(){var r=Al.current;return r!==null?r:ba.pooledCache}function U0(r,n){n===null?L(Al,Al.current):L(Al,n.pool)}function Oh(){var r=Lf();return r===null?null:{parent:Qa._currentValue,pool:r}}var co=Error(i(460)),Pf=Error(i(474)),H0=Error(i(542)),$0={then:function(){}};function Ih(r){return r=r.status,r==="fulfilled"||r==="rejected"}function Bh(r,n,l){switch(l=r[l],l===void 0?r.push(n):l!==n&&(n.then(pn,pn),n=l),n.status){case"fulfilled":return n.value;case"rejected":throw r=n.reason,Lh(r),r;default:if(typeof n.status=="string")n.then(pn,pn);else{if(r=ba,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=n,r.status="pending",r.then(function(d){if(n.status==="pending"){var x=n;x.status="fulfilled",x.value=d}},function(d){if(n.status==="pending"){var x=n;x.status="rejected",x.reason=d}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw r=n.reason,Lh(r),r}throw Cl=n,co}}function _l(r){try{var n=r._init;return n(r._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(Cl=l,co):l}}var Cl=null;function Mh(){if(Cl===null)throw Error(i(459));var r=Cl;return Cl=null,r}function Lh(r){if(r===co||r===H0)throw Error(i(483))}var fo=null,nc=0;function Y0(r){var n=nc;return nc+=1,fo===null&&(fo=[]),Bh(fo,r,n)}function ic(r,n){n=n.props.ref,r.ref=n!==void 0?n:null}function G0(r,n){throw n.$$typeof===_?Error(i(525)):(r=Object.prototype.toString.call(n),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":r)))}function Ph(r){function n(he,ce){if(r){var ve=he.deletions;ve===null?(he.deletions=[ce],he.flags|=16):ve.push(ce)}}function l(he,ce){if(!r)return null;for(;ce!==null;)n(he,ce),ce=ce.sibling;return null}function d(he){for(var ce=new Map;he!==null;)he.key!==null?ce.set(he.key,he):ce.set(he.index,he),he=he.sibling;return ce}function x(he,ce){return he=T(he,ce),he.index=0,he.sibling=null,he}function b(he,ce,ve){return he.index=ve,r?(ve=he.alternate,ve!==null?(ve=ve.index,ve<ce?(he.flags|=67108866,ce):ve):(he.flags|=67108866,ce)):(he.flags|=1048576,ce)}function R(he){return r&&he.alternate===null&&(he.flags|=67108866),he}function B(he,ce,ve,Ie){return ce===null||ce.tag!==6?(ce=O(ve,he.mode,Ie),ce.return=he,ce):(ce=x(ce,ve),ce.return=he,ce)}function re(he,ce,ve,Ie){var pt=ve.type;return pt===k?Fe(he,ce,ve.props.children,Ie,ve.key):ce!==null&&(ce.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===le&&_l(pt)===ce.type)?(ce=x(ce,ve.props),ic(ce,ve),ce.return=he,ce):(ce=D(ve.type,ve.key,ve.props,null,he.mode,Ie),ic(ce,ve),ce.return=he,ce)}function be(he,ce,ve,Ie){return ce===null||ce.tag!==4||ce.stateNode.containerInfo!==ve.containerInfo||ce.stateNode.implementation!==ve.implementation?(ce=xe(ve,he.mode,Ie),ce.return=he,ce):(ce=x(ce,ve.children||[]),ce.return=he,ce)}function Fe(he,ce,ve,Ie,pt){return ce===null||ce.tag!==7?(ce=C(ve,he.mode,Ie,pt),ce.return=he,ce):(ce=x(ce,ve),ce.return=he,ce)}function Le(he,ce,ve){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return ce=O(""+ce,he.mode,ve),ce.return=he,ce;if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case w:return ve=D(ce.type,ce.key,ce.props,null,he.mode,ve),ic(ve,ce),ve.return=he,ve;case N:return ce=xe(ce,he.mode,ve),ce.return=he,ce;case le:return ce=_l(ce),Le(he,ce,ve)}if(ke(ce)||ue(ce))return ce=C(ce,he.mode,ve,null),ce.return=he,ce;if(typeof ce.then=="function")return Le(he,Y0(ce),ve);if(ce.$$typeof===M)return Le(he,z0(he,ce),ve);G0(he,ce)}return null}function _e(he,ce,ve,Ie){var pt=ce!==null?ce.key:null;if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return pt!==null?null:B(he,ce,""+ve,Ie);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case w:return ve.key===pt?re(he,ce,ve,Ie):null;case N:return ve.key===pt?be(he,ce,ve,Ie):null;case le:return ve=_l(ve),_e(he,ce,ve,Ie)}if(ke(ve)||ue(ve))return pt!==null?null:Fe(he,ce,ve,Ie,null);if(typeof ve.then=="function")return _e(he,ce,Y0(ve),Ie);if(ve.$$typeof===M)return _e(he,ce,z0(he,ve),Ie);G0(he,ve)}return null}function we(he,ce,ve,Ie,pt){if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number"||typeof Ie=="bigint")return he=he.get(ve)||null,B(ce,he,""+Ie,pt);if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case w:return he=he.get(Ie.key===null?ve:Ie.key)||null,re(ce,he,Ie,pt);case N:return he=he.get(Ie.key===null?ve:Ie.key)||null,be(ce,he,Ie,pt);case le:return Ie=_l(Ie),we(he,ce,ve,Ie,pt)}if(ke(Ie)||ue(Ie))return he=he.get(ve)||null,Fe(ce,he,Ie,pt,null);if(typeof Ie.then=="function")return we(he,ce,ve,Y0(Ie),pt);if(Ie.$$typeof===M)return we(he,ce,ve,z0(ce,Ie),pt);G0(ce,Ie)}return null}function ot(he,ce,ve,Ie){for(var pt=null,ta=null,ut=ce,Nt=ce=0,$t=null;ut!==null&&Nt<ve.length;Nt++){ut.index>Nt?($t=ut,ut=null):$t=ut.sibling;var aa=_e(he,ut,ve[Nt],Ie);if(aa===null){ut===null&&(ut=$t);break}r&&ut&&aa.alternate===null&&n(he,ut),ce=b(aa,ce,Nt),ta===null?pt=aa:ta.sibling=aa,ta=aa,ut=$t}if(Nt===ve.length)return l(he,ut),vt&&lt(he,Nt),pt;if(ut===null){for(;Nt<ve.length;Nt++)ut=Le(he,ve[Nt],Ie),ut!==null&&(ce=b(ut,ce,Nt),ta===null?pt=ut:ta.sibling=ut,ta=ut);return vt&&lt(he,Nt),pt}for(ut=d(ut);Nt<ve.length;Nt++)$t=we(ut,he,Nt,ve[Nt],Ie),$t!==null&&(r&&$t.alternate!==null&&ut.delete($t.key===null?Nt:$t.key),ce=b($t,ce,Nt),ta===null?pt=$t:ta.sibling=$t,ta=$t);return r&&ut.forEach(function(Ws){return n(he,Ws)}),vt&&lt(he,Nt),pt}function gt(he,ce,ve,Ie){if(ve==null)throw Error(i(151));for(var pt=null,ta=null,ut=ce,Nt=ce=0,$t=null,aa=ve.next();ut!==null&&!aa.done;Nt++,aa=ve.next()){ut.index>Nt?($t=ut,ut=null):$t=ut.sibling;var Ws=_e(he,ut,aa.value,Ie);if(Ws===null){ut===null&&(ut=$t);break}r&&ut&&Ws.alternate===null&&n(he,ut),ce=b(Ws,ce,Nt),ta===null?pt=Ws:ta.sibling=Ws,ta=Ws,ut=$t}if(aa.done)return l(he,ut),vt&&lt(he,Nt),pt;if(ut===null){for(;!aa.done;Nt++,aa=ve.next())aa=Le(he,aa.value,Ie),aa!==null&&(ce=b(aa,ce,Nt),ta===null?pt=aa:ta.sibling=aa,ta=aa);return vt&&lt(he,Nt),pt}for(ut=d(ut);!aa.done;Nt++,aa=ve.next())aa=we(ut,he,Nt,aa.value,Ie),aa!==null&&(r&&aa.alternate!==null&&ut.delete(aa.key===null?Nt:aa.key),ce=b(aa,ce,Nt),ta===null?pt=aa:ta.sibling=aa,ta=aa);return r&&ut.forEach(function(y2){return n(he,y2)}),vt&&lt(he,Nt),pt}function ga(he,ce,ve,Ie){if(typeof ve=="object"&&ve!==null&&ve.type===k&&ve.key===null&&(ve=ve.props.children),typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case w:e:{for(var pt=ve.key;ce!==null;){if(ce.key===pt){if(pt=ve.type,pt===k){if(ce.tag===7){l(he,ce.sibling),Ie=x(ce,ve.props.children),Ie.return=he,he=Ie;break e}}else if(ce.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===le&&_l(pt)===ce.type){l(he,ce.sibling),Ie=x(ce,ve.props),ic(Ie,ve),Ie.return=he,he=Ie;break e}l(he,ce);break}else n(he,ce);ce=ce.sibling}ve.type===k?(Ie=C(ve.props.children,he.mode,Ie,ve.key),Ie.return=he,he=Ie):(Ie=D(ve.type,ve.key,ve.props,null,he.mode,Ie),ic(Ie,ve),Ie.return=he,he=Ie)}return R(he);case N:e:{for(pt=ve.key;ce!==null;){if(ce.key===pt)if(ce.tag===4&&ce.stateNode.containerInfo===ve.containerInfo&&ce.stateNode.implementation===ve.implementation){l(he,ce.sibling),Ie=x(ce,ve.children||[]),Ie.return=he,he=Ie;break e}else{l(he,ce);break}else n(he,ce);ce=ce.sibling}Ie=xe(ve,he.mode,Ie),Ie.return=he,he=Ie}return R(he);case le:return ve=_l(ve),ga(he,ce,ve,Ie)}if(ke(ve))return ot(he,ce,ve,Ie);if(ue(ve)){if(pt=ue(ve),typeof pt!="function")throw Error(i(150));return ve=pt.call(ve),gt(he,ce,ve,Ie)}if(typeof ve.then=="function")return ga(he,ce,Y0(ve),Ie);if(ve.$$typeof===M)return ga(he,ce,z0(he,ve),Ie);G0(he,ve)}return typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint"?(ve=""+ve,ce!==null&&ce.tag===6?(l(he,ce.sibling),Ie=x(ce,ve),Ie.return=he,he=Ie):(l(he,ce),Ie=O(ve,he.mode,Ie),Ie.return=he,he=Ie),R(he)):l(he,ce)}return function(he,ce,ve,Ie){try{nc=0;var pt=ga(he,ce,ve,Ie);return fo=null,pt}catch(ut){if(ut===co||ut===H0)throw ut;var ta=v(29,ut,null,he.mode);return ta.lanes=Ie,ta.return=he,ta}}}var kl=Ph(!0),zh=Ph(!1),Rs=!1;function zf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Uf(r,n){r=r.updateQueue,n.updateQueue===r&&(n.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Ns(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Fs(r,n,l){var d=r.updateQueue;if(d===null)return null;if(d=d.shared,(na&2)!==0){var x=d.pending;return x===null?n.next=n:(n.next=x.next,x.next=n),d.pending=n,n=or(r),lr(r,null,l),n}return Ya(r,d,n,l),or(r)}function sc(r,n,l){if(n=n.updateQueue,n!==null&&(n=n.shared,(l&4194048)!==0)){var d=n.lanes;d&=r.pendingLanes,l|=d,n.lanes=l,Dn(r,l)}}function Hf(r,n){var l=r.updateQueue,d=r.alternate;if(d!==null&&(d=d.updateQueue,l===d)){var x=null,b=null;if(l=l.firstBaseUpdate,l!==null){do{var R={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};b===null?x=b=R:b=b.next=R,l=l.next}while(l!==null);b===null?x=b=n:b=b.next=n}else x=b=n;l={baseState:d.baseState,firstBaseUpdate:x,lastBaseUpdate:b,shared:d.shared,callbacks:d.callbacks},r.updateQueue=l;return}r=l.lastBaseUpdate,r===null?l.firstBaseUpdate=n:r.next=n,l.lastBaseUpdate=n}var $f=!1;function lc(){if($f){var r=oo;if(r!==null)throw r}}function oc(r,n,l,d){$f=!1;var x=r.updateQueue;Rs=!1;var b=x.firstBaseUpdate,R=x.lastBaseUpdate,B=x.shared.pending;if(B!==null){x.shared.pending=null;var re=B,be=re.next;re.next=null,R===null?b=be:R.next=be,R=re;var Fe=r.alternate;Fe!==null&&(Fe=Fe.updateQueue,B=Fe.lastBaseUpdate,B!==R&&(B===null?Fe.firstBaseUpdate=be:B.next=be,Fe.lastBaseUpdate=re))}if(b!==null){var Le=x.baseState;R=0,Fe=be=re=null,B=b;do{var _e=B.lane&-536870913,we=_e!==B.lane;if(we?(Ht&_e)===_e:(d&_e)===_e){_e!==0&&_e===lo&&($f=!0),Fe!==null&&(Fe=Fe.next={lane:0,tag:B.tag,payload:B.payload,callback:null,next:null});e:{var ot=r,gt=B;_e=n;var ga=l;switch(gt.tag){case 1:if(ot=gt.payload,typeof ot=="function"){Le=ot.call(ga,Le,_e);break e}Le=ot;break e;case 3:ot.flags=ot.flags&-65537|128;case 0:if(ot=gt.payload,_e=typeof ot=="function"?ot.call(ga,Le,_e):ot,_e==null)break e;Le=A({},Le,_e);break e;case 2:Rs=!0}}_e=B.callback,_e!==null&&(r.flags|=64,we&&(r.flags|=8192),we=x.callbacks,we===null?x.callbacks=[_e]:we.push(_e))}else we={lane:_e,tag:B.tag,payload:B.payload,callback:B.callback,next:null},Fe===null?(be=Fe=we,re=Le):Fe=Fe.next=we,R|=_e;if(B=B.next,B===null){if(B=x.shared.pending,B===null)break;we=B,B=we.next,we.next=null,x.lastBaseUpdate=we,x.shared.pending=null}}while(!0);Fe===null&&(re=Le),x.baseState=re,x.firstBaseUpdate=be,x.lastBaseUpdate=Fe,b===null&&(x.shared.lanes=0),Bs|=R,r.lanes=R,r.memoizedState=Le}}function Uh(r,n){if(typeof r!="function")throw Error(i(191,r));r.call(n)}function Hh(r,n){var l=r.callbacks;if(l!==null)for(r.callbacks=null,r=0;r<l.length;r++)Uh(l[r],n)}var uo=ee(null),W0=ee(0);function $h(r,n){r=Ji,L(W0,r),L(uo,n),Ji=r|n.baseLanes}function Yf(){L(W0,Ji),L(uo,uo.current)}function Gf(){Ji=W0.current,I(uo),I(W0)}var vn=ee(null),Pn=null;function Ds(r){var n=r.alternate;L(Ga,Ga.current&1),L(vn,r),Pn===null&&(n===null||uo.current!==null||n.memoizedState!==null)&&(Pn=r)}function Wf(r){L(Ga,Ga.current),L(vn,r),Pn===null&&(Pn=r)}function Yh(r){r.tag===22?(L(Ga,Ga.current),L(vn,r),Pn===null&&(Pn=r)):js()}function js(){L(Ga,Ga.current),L(vn,vn.current)}function bn(r){I(vn),Pn===r&&(Pn=null),I(Ga)}var Ga=ee(0);function V0(r){for(var n=r;n!==null;){if(n.tag===13){var l=n.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Ju(l)||Zu(l)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break;for(;n.sibling===null;){if(n.return===null||n.return===r)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Yi=0,kt=null,pa=null,Ja=null,X0=!1,po=!1,wl=!1,q0=0,cc=0,ho=null,ob=0;function Ma(){throw Error(i(321))}function Vf(r,n){if(n===null)return!1;for(var l=0;l<n.length&&l<r.length;l++)if(!tn(r[l],n[l]))return!1;return!0}function Xf(r,n,l,d,x,b){return Yi=b,kt=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,de.H=r===null||r.memoizedState===null?kg:cu,wl=!1,b=l(d,x),wl=!1,po&&(b=Wh(n,l,d,x)),Gh(r),b}function Gh(r){de.H=uc;var n=pa!==null&&pa.next!==null;if(Yi=0,Ja=pa=kt=null,X0=!1,cc=0,ho=null,n)throw Error(i(300));r===null||Za||(r=r.dependencies,r!==null&&P0(r)&&(Za=!0))}function Wh(r,n,l,d){kt=r;var x=0;do{if(po&&(ho=null),cc=0,po=!1,25<=x)throw Error(i(301));if(x+=1,Ja=pa=null,r.updateQueue!=null){var b=r.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}de.H=wg,b=n(l,d)}while(po);return b}function cb(){var r=de.H,n=r.useState()[0];return n=typeof n.then=="function"?dc(n):n,r=r.useState()[0],(pa!==null?pa.memoizedState:null)!==r&&(kt.flags|=1024),n}function qf(){var r=q0!==0;return q0=0,r}function Kf(r,n,l){n.updateQueue=r.updateQueue,n.flags&=-2053,r.lanes&=~l}function Qf(r){if(X0){for(r=r.memoizedState;r!==null;){var n=r.queue;n!==null&&(n.pending=null),r=r.next}X0=!1}Yi=0,Ja=pa=kt=null,po=!1,cc=q0=0,ho=null}function Vr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ja===null?kt.memoizedState=Ja=r:Ja=Ja.next=r,Ja}function Wa(){if(pa===null){var r=kt.alternate;r=r!==null?r.memoizedState:null}else r=pa.next;var n=Ja===null?kt.memoizedState:Ja.next;if(n!==null)Ja=n,pa=r;else{if(r===null)throw kt.alternate===null?Error(i(467)):Error(i(310));pa=r,r={memoizedState:pa.memoizedState,baseState:pa.baseState,baseQueue:pa.baseQueue,queue:pa.queue,next:null},Ja===null?kt.memoizedState=Ja=r:Ja=Ja.next=r}return Ja}function K0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function dc(r){var n=cc;return cc+=1,ho===null&&(ho=[]),r=Bh(ho,r,n),n=kt,(Ja===null?n.memoizedState:Ja.next)===null&&(n=n.alternate,de.H=n===null||n.memoizedState===null?kg:cu),r}function Q0(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return dc(r);if(r.$$typeof===M)return Tr(r)}throw Error(i(438,String(r)))}function Jf(r){var n=null,l=kt.updateQueue;if(l!==null&&(n=l.memoCache),n==null){var d=kt.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(n={data:d.data.map(function(x){return x.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),l===null&&(l=K0(),kt.updateQueue=l),l.memoCache=n,l=n.data[n.index],l===void 0)for(l=n.data[n.index]=Array(r),d=0;d<r;d++)l[d]=m;return n.index++,l}function Gi(r,n){return typeof n=="function"?n(r):n}function J0(r){var n=Wa();return Zf(n,pa,r)}function Zf(r,n,l){var d=r.queue;if(d===null)throw Error(i(311));d.lastRenderedReducer=l;var x=r.baseQueue,b=d.pending;if(b!==null){if(x!==null){var R=x.next;x.next=b.next,b.next=R}n.baseQueue=x=b,d.pending=null}if(b=r.baseState,x===null)r.memoizedState=b;else{n=x.next;var B=R=null,re=null,be=n,Fe=!1;do{var Le=be.lane&-536870913;if(Le!==be.lane?(Ht&Le)===Le:(Yi&Le)===Le){var _e=be.revertLane;if(_e===0)re!==null&&(re=re.next={lane:0,revertLane:0,gesture:null,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null}),Le===lo&&(Fe=!0);else if((Yi&_e)===_e){be=be.next,_e===lo&&(Fe=!0);continue}else Le={lane:0,revertLane:be.revertLane,gesture:null,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null},re===null?(B=re=Le,R=b):re=re.next=Le,kt.lanes|=_e,Bs|=_e;Le=be.action,wl&&l(b,Le),b=be.hasEagerState?be.eagerState:l(b,Le)}else _e={lane:Le,revertLane:be.revertLane,gesture:be.gesture,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null},re===null?(B=re=_e,R=b):re=re.next=_e,kt.lanes|=Le,Bs|=Le;be=be.next}while(be!==null&&be!==n);if(re===null?R=b:re.next=B,!tn(b,r.memoizedState)&&(Za=!0,Fe&&(l=oo,l!==null)))throw l;r.memoizedState=b,r.baseState=R,r.baseQueue=re,d.lastRenderedState=b}return x===null&&(d.lanes=0),[r.memoizedState,d.dispatch]}function eu(r){var n=Wa(),l=n.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=r;var d=l.dispatch,x=l.pending,b=n.memoizedState;if(x!==null){l.pending=null;var R=x=x.next;do b=r(b,R.action),R=R.next;while(R!==x);tn(b,n.memoizedState)||(Za=!0),n.memoizedState=b,n.baseQueue===null&&(n.baseState=b),l.lastRenderedState=b}return[b,d]}function Vh(r,n,l){var d=kt,x=Wa(),b=vt;if(b){if(l===void 0)throw Error(i(407));l=l()}else l=n();var R=!tn((pa||x).memoizedState,l);if(R&&(x.memoizedState=l,Za=!0),x=x.queue,ru(Kh.bind(null,d,x,r),[r]),x.getSnapshot!==n||R||Ja!==null&&Ja.memoizedState.tag&1){if(d.flags|=2048,go(9,{destroy:void 0},qh.bind(null,d,x,l,n),null),ba===null)throw Error(i(349));b||(Yi&127)!==0||Xh(d,n,l)}return l}function Xh(r,n,l){r.flags|=16384,r={getSnapshot:n,value:l},n=kt.updateQueue,n===null?(n=K0(),kt.updateQueue=n,n.stores=[r]):(l=n.stores,l===null?n.stores=[r]:l.push(r))}function qh(r,n,l,d){n.value=l,n.getSnapshot=d,Qh(n)&&Jh(r)}function Kh(r,n,l){return l(function(){Qh(n)&&Jh(r)})}function Qh(r){var n=r.getSnapshot;r=r.value;try{var l=n();return!tn(r,l)}catch{return!0}}function Jh(r){var n=mn(r,2);n!==null&&on(n,r,2)}function tu(r){var n=Vr();if(typeof r=="function"){var l=r;if(r=l(),wl){Nn(!0);try{l()}finally{Nn(!1)}}}return n.memoizedState=n.baseState=r,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gi,lastRenderedState:r},n}function Zh(r,n,l,d){return r.baseState=l,Zf(r,pa,typeof d=="function"?d:Gi)}function db(r,n,l,d,x){if(td(r))throw Error(i(485));if(r=n.action,r!==null){var b={payload:x,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(R){b.listeners.push(R)}};de.T!==null?l(!0):b.isTransition=!1,d(b),l=n.pending,l===null?(b.next=n.pending=b,eg(n,b)):(b.next=l.next,n.pending=l.next=b)}}function eg(r,n){var l=n.action,d=n.payload,x=r.state;if(n.isTransition){var b=de.T,R={};de.T=R;try{var B=l(x,d),re=de.S;re!==null&&re(R,B),tg(r,n,B)}catch(be){au(r,n,be)}finally{b!==null&&R.types!==null&&(b.types=R.types),de.T=b}}else try{b=l(x,d),tg(r,n,b)}catch(be){au(r,n,be)}}function tg(r,n,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(d){ag(r,n,d)},function(d){return au(r,n,d)}):ag(r,n,l)}function ag(r,n,l){n.status="fulfilled",n.value=l,rg(n),r.state=l,n=r.pending,n!==null&&(l=n.next,l===n?r.pending=null:(l=l.next,n.next=l,eg(r,l)))}function au(r,n,l){var d=r.pending;if(r.pending=null,d!==null){d=d.next;do n.status="rejected",n.reason=l,rg(n),n=n.next;while(n!==d)}r.action=null}function rg(r){r=r.listeners;for(var n=0;n<r.length;n++)(0,r[n])()}function ng(r,n){return n}function ig(r,n){if(vt){var l=ba.formState;if(l!==null){e:{var d=kt;if(vt){if(Ut){t:{for(var x=Ut,b=qt;x.nodeType!==8;){if(!b){x=null;break t}if(x=zn(x.nextSibling),x===null){x=null;break t}}b=x.data,x=b==="F!"||b==="F"?x:null}if(x){Ut=zn(x.nextSibling),d=x.data==="F!";break e}}Ln(d)}d=!1}d&&(n=l[0])}}return l=Vr(),l.memoizedState=l.baseState=n,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ng,lastRenderedState:n},l.queue=d,l=Ag.bind(null,kt,d),d.dispatch=l,d=tu(!1),b=ou.bind(null,kt,!1,d.queue),d=Vr(),x={state:n,dispatch:null,action:r,pending:null},d.queue=x,l=db.bind(null,kt,x,b,l),x.dispatch=l,d.memoizedState=r,[n,l,!1]}function sg(r){var n=Wa();return lg(n,pa,r)}function lg(r,n,l){if(n=Zf(r,n,ng)[0],r=J0(Gi)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var d=dc(n)}catch(R){throw R===co?H0:R}else d=n;n=Wa();var x=n.queue,b=x.dispatch;return l!==n.memoizedState&&(kt.flags|=2048,go(9,{destroy:void 0},fb.bind(null,x,l),null)),[d,b,r]}function fb(r,n){r.action=n}function og(r){var n=Wa(),l=pa;if(l!==null)return lg(n,l,r);Wa(),n=n.memoizedState,l=Wa();var d=l.queue.dispatch;return l.memoizedState=r,[n,d,!1]}function go(r,n,l,d){return r={tag:r,create:l,deps:d,inst:n,next:null},n=kt.updateQueue,n===null&&(n=K0(),kt.updateQueue=n),l=n.lastEffect,l===null?n.lastEffect=r.next=r:(d=l.next,l.next=r,r.next=d,n.lastEffect=r),r}function cg(){return Wa().memoizedState}function Z0(r,n,l,d){var x=Vr();kt.flags|=r,x.memoizedState=go(1|n,{destroy:void 0},l,d===void 0?null:d)}function ed(r,n,l,d){var x=Wa();d=d===void 0?null:d;var b=x.memoizedState.inst;pa!==null&&d!==null&&Vf(d,pa.memoizedState.deps)?x.memoizedState=go(n,b,l,d):(kt.flags|=r,x.memoizedState=go(1|n,b,l,d))}function dg(r,n){Z0(8390656,8,r,n)}function ru(r,n){ed(2048,8,r,n)}function ub(r){kt.flags|=4;var n=kt.updateQueue;if(n===null)n=K0(),kt.updateQueue=n,n.events=[r];else{var l=n.events;l===null?n.events=[r]:l.push(r)}}function fg(r){var n=Wa().memoizedState;return ub({ref:n,nextImpl:r}),function(){if((na&2)!==0)throw Error(i(440));return n.impl.apply(void 0,arguments)}}function ug(r,n){return ed(4,2,r,n)}function pg(r,n){return ed(4,4,r,n)}function hg(r,n){if(typeof n=="function"){r=r();var l=n(r);return function(){typeof l=="function"?l():n(null)}}if(n!=null)return r=r(),n.current=r,function(){n.current=null}}function gg(r,n,l){l=l!=null?l.concat([r]):null,ed(4,4,hg.bind(null,n,r),l)}function nu(){}function xg(r,n){var l=Wa();n=n===void 0?null:n;var d=l.memoizedState;return n!==null&&Vf(n,d[1])?d[0]:(l.memoizedState=[r,n],r)}function mg(r,n){var l=Wa();n=n===void 0?null:n;var d=l.memoizedState;if(n!==null&&Vf(n,d[1]))return d[0];if(d=r(),wl){Nn(!0);try{r()}finally{Nn(!1)}}return l.memoizedState=[d,n],d}function iu(r,n,l){return l===void 0||(Yi&1073741824)!==0&&(Ht&261930)===0?r.memoizedState=n:(r.memoizedState=l,r=y1(),kt.lanes|=r,Bs|=r,l)}function yg(r,n,l,d){return tn(l,n)?l:uo.current!==null?(r=iu(r,l,d),tn(r,n)||(Za=!0),r):(Yi&42)===0||(Yi&1073741824)!==0&&(Ht&261930)===0?(Za=!0,r.memoizedState=l):(r=y1(),kt.lanes|=r,Bs|=r,n)}function vg(r,n,l,d,x){var b=Ce.p;Ce.p=b!==0&&8>b?b:8;var R=de.T,B={};de.T=B,ou(r,!1,n,l);try{var re=x(),be=de.S;if(be!==null&&be(B,re),re!==null&&typeof re=="object"&&typeof re.then=="function"){var Fe=lb(re,d);fc(r,n,Fe,Tn(r))}else fc(r,n,d,Tn(r))}catch(Le){fc(r,n,{then:function(){},status:"rejected",reason:Le},Tn())}finally{Ce.p=b,R!==null&&B.types!==null&&(R.types=B.types),de.T=R}}function pb(){}function su(r,n,l,d){if(r.tag!==5)throw Error(i(476));var x=bg(r).queue;vg(r,x,n,Je,l===null?pb:function(){return Sg(r),l(d)})}function bg(r){var n=r.memoizedState;if(n!==null)return n;n={memoizedState:Je,baseState:Je,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gi,lastRenderedState:Je},next:null};var l={};return n.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gi,lastRenderedState:l},next:null},r.memoizedState=n,r=r.alternate,r!==null&&(r.memoizedState=n),n}function Sg(r){var n=bg(r);n.next===null&&(n=r.alternate.memoizedState),fc(r,n.next.queue,{},Tn())}function lu(){return Tr(wc)}function Eg(){return Wa().memoizedState}function Tg(){return Wa().memoizedState}function hb(r){for(var n=r.return;n!==null;){switch(n.tag){case 24:case 3:var l=Tn();r=Ns(l);var d=Fs(n,r,l);d!==null&&(on(d,n,l),sc(d,n,l)),n={cache:Bf()},r.payload=n;return}n=n.return}}function gb(r,n,l){var d=Tn();l={lane:d,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},td(r)?_g(n,l):(l=sr(r,n,l,d),l!==null&&(on(l,r,d),Cg(l,n,d)))}function Ag(r,n,l){var d=Tn();fc(r,n,l,d)}function fc(r,n,l,d){var x={lane:d,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(td(r))_g(n,x);else{var b=r.alternate;if(r.lanes===0&&(b===null||b.lanes===0)&&(b=n.lastRenderedReducer,b!==null))try{var R=n.lastRenderedState,B=b(R,l);if(x.hasEagerState=!0,x.eagerState=B,tn(B,R))return Ya(r,n,x,0),ba===null&&ua(),!1}catch{}if(l=sr(r,n,x,d),l!==null)return on(l,r,d),Cg(l,n,d),!0}return!1}function ou(r,n,l,d){if(d={lane:2,revertLane:zu(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},td(r)){if(n)throw Error(i(479))}else n=sr(r,l,d,2),n!==null&&on(n,r,2)}function td(r){var n=r.alternate;return r===kt||n!==null&&n===kt}function _g(r,n){po=X0=!0;var l=r.pending;l===null?n.next=n:(n.next=l.next,l.next=n),r.pending=n}function Cg(r,n,l){if((l&4194048)!==0){var d=n.lanes;d&=r.pendingLanes,l|=d,n.lanes=l,Dn(r,l)}}var uc={readContext:Tr,use:Q0,useCallback:Ma,useContext:Ma,useEffect:Ma,useImperativeHandle:Ma,useLayoutEffect:Ma,useInsertionEffect:Ma,useMemo:Ma,useReducer:Ma,useRef:Ma,useState:Ma,useDebugValue:Ma,useDeferredValue:Ma,useTransition:Ma,useSyncExternalStore:Ma,useId:Ma,useHostTransitionStatus:Ma,useFormState:Ma,useActionState:Ma,useOptimistic:Ma,useMemoCache:Ma,useCacheRefresh:Ma};uc.useEffectEvent=Ma;var kg={readContext:Tr,use:Q0,useCallback:function(r,n){return Vr().memoizedState=[r,n===void 0?null:n],r},useContext:Tr,useEffect:dg,useImperativeHandle:function(r,n,l){l=l!=null?l.concat([r]):null,Z0(4194308,4,hg.bind(null,n,r),l)},useLayoutEffect:function(r,n){return Z0(4194308,4,r,n)},useInsertionEffect:function(r,n){Z0(4,2,r,n)},useMemo:function(r,n){var l=Vr();n=n===void 0?null:n;var d=r();if(wl){Nn(!0);try{r()}finally{Nn(!1)}}return l.memoizedState=[d,n],d},useReducer:function(r,n,l){var d=Vr();if(l!==void 0){var x=l(n);if(wl){Nn(!0);try{l(n)}finally{Nn(!1)}}}else x=n;return d.memoizedState=d.baseState=x,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:x},d.queue=r,r=r.dispatch=gb.bind(null,kt,r),[d.memoizedState,r]},useRef:function(r){var n=Vr();return r={current:r},n.memoizedState=r},useState:function(r){r=tu(r);var n=r.queue,l=Ag.bind(null,kt,n);return n.dispatch=l,[r.memoizedState,l]},useDebugValue:nu,useDeferredValue:function(r,n){var l=Vr();return iu(l,r,n)},useTransition:function(){var r=tu(!1);return r=vg.bind(null,kt,r.queue,!0,!1),Vr().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,n,l){var d=kt,x=Vr();if(vt){if(l===void 0)throw Error(i(407));l=l()}else{if(l=n(),ba===null)throw Error(i(349));(Ht&127)!==0||Xh(d,n,l)}x.memoizedState=l;var b={value:l,getSnapshot:n};return x.queue=b,dg(Kh.bind(null,d,b,r),[r]),d.flags|=2048,go(9,{destroy:void 0},qh.bind(null,d,b,l,n),null),l},useId:function(){var r=Vr(),n=ba.identifierPrefix;if(vt){var l=Vt,d=it;l=(d&~(1<<32-Zt(d)-1)).toString(32)+l,n="_"+n+"R_"+l,l=q0++,0<l&&(n+="H"+l.toString(32)),n+="_"}else l=ob++,n="_"+n+"r_"+l.toString(32)+"_";return r.memoizedState=n},useHostTransitionStatus:lu,useFormState:ig,useActionState:ig,useOptimistic:function(r){var n=Vr();n.memoizedState=n.baseState=r;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=l,n=ou.bind(null,kt,!0,l),l.dispatch=n,[r,n]},useMemoCache:Jf,useCacheRefresh:function(){return Vr().memoizedState=hb.bind(null,kt)},useEffectEvent:function(r){var n=Vr(),l={impl:r};return n.memoizedState=l,function(){if((na&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},cu={readContext:Tr,use:Q0,useCallback:xg,useContext:Tr,useEffect:ru,useImperativeHandle:gg,useInsertionEffect:ug,useLayoutEffect:pg,useMemo:mg,useReducer:J0,useRef:cg,useState:function(){return J0(Gi)},useDebugValue:nu,useDeferredValue:function(r,n){var l=Wa();return yg(l,pa.memoizedState,r,n)},useTransition:function(){var r=J0(Gi)[0],n=Wa().memoizedState;return[typeof r=="boolean"?r:dc(r),n]},useSyncExternalStore:Vh,useId:Eg,useHostTransitionStatus:lu,useFormState:sg,useActionState:sg,useOptimistic:function(r,n){var l=Wa();return Zh(l,pa,r,n)},useMemoCache:Jf,useCacheRefresh:Tg};cu.useEffectEvent=fg;var wg={readContext:Tr,use:Q0,useCallback:xg,useContext:Tr,useEffect:ru,useImperativeHandle:gg,useInsertionEffect:ug,useLayoutEffect:pg,useMemo:mg,useReducer:eu,useRef:cg,useState:function(){return eu(Gi)},useDebugValue:nu,useDeferredValue:function(r,n){var l=Wa();return pa===null?iu(l,r,n):yg(l,pa.memoizedState,r,n)},useTransition:function(){var r=eu(Gi)[0],n=Wa().memoizedState;return[typeof r=="boolean"?r:dc(r),n]},useSyncExternalStore:Vh,useId:Eg,useHostTransitionStatus:lu,useFormState:og,useActionState:og,useOptimistic:function(r,n){var l=Wa();return pa!==null?Zh(l,pa,r,n):(l.baseState=r,[r,l.queue.dispatch])},useMemoCache:Jf,useCacheRefresh:Tg};wg.useEffectEvent=fg;function du(r,n,l,d){n=r.memoizedState,l=l(d,n),l=l==null?n:A({},n,l),r.memoizedState=l,r.lanes===0&&(r.updateQueue.baseState=l)}var fu={enqueueSetState:function(r,n,l){r=r._reactInternals;var d=Tn(),x=Ns(d);x.payload=n,l!=null&&(x.callback=l),n=Fs(r,x,d),n!==null&&(on(n,r,d),sc(n,r,d))},enqueueReplaceState:function(r,n,l){r=r._reactInternals;var d=Tn(),x=Ns(d);x.tag=1,x.payload=n,l!=null&&(x.callback=l),n=Fs(r,x,d),n!==null&&(on(n,r,d),sc(n,r,d))},enqueueForceUpdate:function(r,n){r=r._reactInternals;var l=Tn(),d=Ns(l);d.tag=2,n!=null&&(d.callback=n),n=Fs(r,d,l),n!==null&&(on(n,r,l),sc(n,r,l))}};function Rg(r,n,l,d,x,b,R){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(d,b,R):n.prototype&&n.prototype.isPureReactComponent?!ao(l,d)||!ao(x,b):!0}function Ng(r,n,l,d){r=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(l,d),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(l,d),n.state!==r&&fu.enqueueReplaceState(n,n.state,null)}function Rl(r,n){var l=n;if("ref"in n){l={};for(var d in n)d!=="ref"&&(l[d]=n[d])}if(r=r.defaultProps){l===n&&(l=A({},l));for(var x in r)l[x]===void 0&&(l[x]=r[x])}return l}function Fg(r){Ei(r)}function Dg(r){console.error(r)}function jg(r){Ei(r)}function ad(r,n){try{var l=r.onUncaughtError;l(n.value,{componentStack:n.stack})}catch(d){setTimeout(function(){throw d})}}function Og(r,n,l){try{var d=r.onCaughtError;d(l.value,{componentStack:l.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function uu(r,n,l){return l=Ns(l),l.tag=3,l.payload={element:null},l.callback=function(){ad(r,n)},l}function Ig(r){return r=Ns(r),r.tag=3,r}function Bg(r,n,l,d){var x=l.type.getDerivedStateFromError;if(typeof x=="function"){var b=d.value;r.payload=function(){return x(b)},r.callback=function(){Og(n,l,d)}}var R=l.stateNode;R!==null&&typeof R.componentDidCatch=="function"&&(r.callback=function(){Og(n,l,d),typeof x!="function"&&(Ms===null?Ms=new Set([this]):Ms.add(this));var B=d.stack;this.componentDidCatch(d.value,{componentStack:B!==null?B:""})})}function xb(r,n,l,d,x){if(l.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(n=l.alternate,n!==null&&Er(n,l,x,!0),l=vn.current,l!==null){switch(l.tag){case 31:case 13:return Pn===null?hd():l.alternate===null&&La===0&&(La=3),l.flags&=-257,l.flags|=65536,l.lanes=x,d===$0?l.flags|=16384:(n=l.updateQueue,n===null?l.updateQueue=new Set([d]):n.add(d),Mu(r,d,x)),!1;case 22:return l.flags|=65536,d===$0?l.flags|=16384:(n=l.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([d])},l.updateQueue=n):(l=n.retryQueue,l===null?n.retryQueue=new Set([d]):l.add(d)),Mu(r,d,x)),!1}throw Error(i(435,l.tag))}return Mu(r,d,x),hd(),!1}if(vt)return n=vn.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=x,d!==ii&&(r=Error(i(422),{cause:d}),El(ye(r,l)))):(d!==ii&&(n=Error(i(423),{cause:d}),El(ye(n,l))),r=r.current.alternate,r.flags|=65536,x&=-x,r.lanes|=x,d=ye(d,l),x=uu(r.stateNode,d,x),Hf(r,x),La!==4&&(La=2)),!1;var b=Error(i(520),{cause:d});if(b=ye(b,l),bc===null?bc=[b]:bc.push(b),La!==4&&(La=2),n===null)return!0;d=ye(d,l),l=n;do{switch(l.tag){case 3:return l.flags|=65536,r=x&-x,l.lanes|=r,r=uu(l.stateNode,d,r),Hf(l,r),!1;case 1:if(n=l.type,b=l.stateNode,(l.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Ms===null||!Ms.has(b))))return l.flags|=65536,x&=-x,l.lanes|=x,x=Ig(x),Bg(x,r,l,d),Hf(l,x),!1}l=l.return}while(l!==null);return!1}var pu=Error(i(461)),Za=!1;function Ar(r,n,l,d){n.child=r===null?zh(n,null,l,d):kl(n,r.child,l,d)}function Mg(r,n,l,d,x){l=l.render;var b=n.ref;if("ref"in d){var R={};for(var B in d)B!=="ref"&&(R[B]=d[B])}else R=d;return Tl(n),d=Xf(r,n,l,R,b,x),B=qf(),r!==null&&!Za?(Kf(r,n,x),Wi(r,n,x)):(vt&&B&&Ka(n),n.flags|=1,Ar(r,n,d,x),n.child)}function Lg(r,n,l,d,x){if(r===null){var b=l.type;return typeof b=="function"&&!S(b)&&b.defaultProps===void 0&&l.compare===null?(n.tag=15,n.type=b,Pg(r,n,b,d,x)):(r=D(l.type,null,d,n,n.mode,x),r.ref=n.ref,r.return=n,n.child=r)}if(b=r.child,!Su(r,x)){var R=b.memoizedProps;if(l=l.compare,l=l!==null?l:ao,l(R,d)&&r.ref===n.ref)return Wi(r,n,x)}return n.flags|=1,r=T(b,d),r.ref=n.ref,r.return=n,n.child=r}function Pg(r,n,l,d,x){if(r!==null){var b=r.memoizedProps;if(ao(b,d)&&r.ref===n.ref)if(Za=!1,n.pendingProps=d=b,Su(r,x))(r.flags&131072)!==0&&(Za=!0);else return n.lanes=r.lanes,Wi(r,n,x)}return hu(r,n,l,d,x)}function zg(r,n,l,d){var x=d.children,b=r!==null?r.memoizedState:null;if(r===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((n.flags&128)!==0){if(b=b!==null?b.baseLanes|l:l,r!==null){for(d=n.child=r.child,x=0;d!==null;)x=x|d.lanes|d.childLanes,d=d.sibling;d=x&~b}else d=0,n.child=null;return Ug(r,n,b,l,d)}if((l&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},r!==null&&U0(n,b!==null?b.cachePool:null),b!==null?$h(n,b):Yf(),Yh(n);else return d=n.lanes=536870912,Ug(r,n,b!==null?b.baseLanes|l:l,l,d)}else b!==null?(U0(n,b.cachePool),$h(n,b),js(),n.memoizedState=null):(r!==null&&U0(n,null),Yf(),js());return Ar(r,n,x,l),n.child}function pc(r,n){return r!==null&&r.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function Ug(r,n,l,d,x){var b=Lf();return b=b===null?null:{parent:Qa._currentValue,pool:b},n.memoizedState={baseLanes:l,cachePool:b},r!==null&&U0(n,null),Yf(),Yh(n),r!==null&&Er(r,n,d,!0),n.childLanes=x,null}function rd(r,n){return n=id({mode:n.mode,children:n.children},r.mode),n.ref=r.ref,r.child=n,n.return=r,n}function Hg(r,n,l){return kl(n,r.child,null,l),r=rd(n,n.pendingProps),r.flags|=2,bn(n),n.memoizedState=null,r}function mb(r,n,l){var d=n.pendingProps,x=(n.flags&128)!==0;if(n.flags&=-129,r===null){if(vt){if(d.mode==="hidden")return r=rd(n,d),n.lanes=536870912,pc(null,r);if(Wf(n),(r=Ut)?(r=ex(r,qt),r=r!==null&&r.data==="&"?r:null,r!==null&&(n.memoizedState={dehydrated:r,treeContext:Ve!==null?{id:it,overflow:Vt}:null,retryLane:536870912,hydrationErrors:null},l=G(r),l.return=n,n.child=l,zt=n,Ut=null)):r=null,r===null)throw Ln(n);return n.lanes=536870912,null}return rd(n,d)}var b=r.memoizedState;if(b!==null){var R=b.dehydrated;if(Wf(n),x)if(n.flags&256)n.flags&=-257,n=Hg(r,n,l);else if(n.memoizedState!==null)n.child=r.child,n.flags|=128,n=null;else throw Error(i(558));else if(Za||Er(r,n,l,!1),x=(l&r.childLanes)!==0,Za||x){if(d=ba,d!==null&&(R=Zr(d,l),R!==0&&R!==b.retryLane))throw b.retryLane=R,mn(r,R),on(d,r,R),pu;hd(),n=Hg(r,n,l)}else r=b.treeContext,Ut=zn(R.nextSibling),zt=n,vt=!0,an=null,qt=!1,r!==null&&st(n,r),n=rd(n,d),n.flags|=4096;return n}return r=T(r.child,{mode:d.mode,children:d.children}),r.ref=n.ref,n.child=r,r.return=n,r}function nd(r,n){var l=n.ref;if(l===null)r!==null&&r.ref!==null&&(n.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(r===null||r.ref!==l)&&(n.flags|=4194816)}}function hu(r,n,l,d,x){return Tl(n),l=Xf(r,n,l,d,void 0,x),d=qf(),r!==null&&!Za?(Kf(r,n,x),Wi(r,n,x)):(vt&&d&&Ka(n),n.flags|=1,Ar(r,n,l,x),n.child)}function $g(r,n,l,d,x,b){return Tl(n),n.updateQueue=null,l=Wh(n,d,l,x),Gh(r),d=qf(),r!==null&&!Za?(Kf(r,n,b),Wi(r,n,b)):(vt&&d&&Ka(n),n.flags|=1,Ar(r,n,l,b),n.child)}function Yg(r,n,l,d,x){if(Tl(n),n.stateNode===null){var b=u,R=l.contextType;typeof R=="object"&&R!==null&&(b=Tr(R)),b=new l(d,b),n.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=fu,n.stateNode=b,b._reactInternals=n,b=n.stateNode,b.props=d,b.state=n.memoizedState,b.refs={},zf(n),R=l.contextType,b.context=typeof R=="object"&&R!==null?Tr(R):u,b.state=n.memoizedState,R=l.getDerivedStateFromProps,typeof R=="function"&&(du(n,l,R,d),b.state=n.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(R=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),R!==b.state&&fu.enqueueReplaceState(b,b.state,null),oc(n,d,b,x),lc(),b.state=n.memoizedState),typeof b.componentDidMount=="function"&&(n.flags|=4194308),d=!0}else if(r===null){b=n.stateNode;var B=n.memoizedProps,re=Rl(l,B);b.props=re;var be=b.context,Fe=l.contextType;R=u,typeof Fe=="object"&&Fe!==null&&(R=Tr(Fe));var Le=l.getDerivedStateFromProps;Fe=typeof Le=="function"||typeof b.getSnapshotBeforeUpdate=="function",B=n.pendingProps!==B,Fe||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(B||be!==R)&&Ng(n,b,d,R),Rs=!1;var _e=n.memoizedState;b.state=_e,oc(n,d,b,x),lc(),be=n.memoizedState,B||_e!==be||Rs?(typeof Le=="function"&&(du(n,l,Le,d),be=n.memoizedState),(re=Rs||Rg(n,l,re,d,_e,be,R))?(Fe||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(n.flags|=4194308)):(typeof b.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=d,n.memoizedState=be),b.props=d,b.state=be,b.context=R,d=re):(typeof b.componentDidMount=="function"&&(n.flags|=4194308),d=!1)}else{b=n.stateNode,Uf(r,n),R=n.memoizedProps,Fe=Rl(l,R),b.props=Fe,Le=n.pendingProps,_e=b.context,be=l.contextType,re=u,typeof be=="object"&&be!==null&&(re=Tr(be)),B=l.getDerivedStateFromProps,(be=typeof B=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(R!==Le||_e!==re)&&Ng(n,b,d,re),Rs=!1,_e=n.memoizedState,b.state=_e,oc(n,d,b,x),lc();var we=n.memoizedState;R!==Le||_e!==we||Rs||r!==null&&r.dependencies!==null&&P0(r.dependencies)?(typeof B=="function"&&(du(n,l,B,d),we=n.memoizedState),(Fe=Rs||Rg(n,l,Fe,d,_e,we,re)||r!==null&&r.dependencies!==null&&P0(r.dependencies))?(be||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(d,we,re),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(d,we,re)),typeof b.componentDidUpdate=="function"&&(n.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof b.componentDidUpdate!="function"||R===r.memoizedProps&&_e===r.memoizedState||(n.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||R===r.memoizedProps&&_e===r.memoizedState||(n.flags|=1024),n.memoizedProps=d,n.memoizedState=we),b.props=d,b.state=we,b.context=re,d=Fe):(typeof b.componentDidUpdate!="function"||R===r.memoizedProps&&_e===r.memoizedState||(n.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||R===r.memoizedProps&&_e===r.memoizedState||(n.flags|=1024),d=!1)}return b=d,nd(r,n),d=(n.flags&128)!==0,b||d?(b=n.stateNode,l=d&&typeof l.getDerivedStateFromError!="function"?null:b.render(),n.flags|=1,r!==null&&d?(n.child=kl(n,r.child,null,x),n.child=kl(n,null,l,x)):Ar(r,n,l,x),n.memoizedState=b.state,r=n.child):r=Wi(r,n,x),r}function Gg(r,n,l,d){return Hi(),n.flags|=256,Ar(r,n,l,d),n.child}var gu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function xu(r){return{baseLanes:r,cachePool:Oh()}}function mu(r,n,l){return r=r!==null?r.childLanes&~l:0,n&&(r|=En),r}function Wg(r,n,l){var d=n.pendingProps,x=!1,b=(n.flags&128)!==0,R;if((R=b)||(R=r!==null&&r.memoizedState===null?!1:(Ga.current&2)!==0),R&&(x=!0,n.flags&=-129),R=(n.flags&32)!==0,n.flags&=-33,r===null){if(vt){if(x?Ds(n):js(),(r=Ut)?(r=ex(r,qt),r=r!==null&&r.data!=="&"?r:null,r!==null&&(n.memoizedState={dehydrated:r,treeContext:Ve!==null?{id:it,overflow:Vt}:null,retryLane:536870912,hydrationErrors:null},l=G(r),l.return=n,n.child=l,zt=n,Ut=null)):r=null,r===null)throw Ln(n);return Zu(r)?n.lanes=32:n.lanes=536870912,null}var B=d.children;return d=d.fallback,x?(js(),x=n.mode,B=id({mode:"hidden",children:B},x),d=C(d,x,l,null),B.return=n,d.return=n,B.sibling=d,n.child=B,d=n.child,d.memoizedState=xu(l),d.childLanes=mu(r,R,l),n.memoizedState=gu,pc(null,d)):(Ds(n),yu(n,B))}var re=r.memoizedState;if(re!==null&&(B=re.dehydrated,B!==null)){if(b)n.flags&256?(Ds(n),n.flags&=-257,n=vu(r,n,l)):n.memoizedState!==null?(js(),n.child=r.child,n.flags|=128,n=null):(js(),B=d.fallback,x=n.mode,d=id({mode:"visible",children:d.children},x),B=C(B,x,l,null),B.flags|=2,d.return=n,B.return=n,d.sibling=B,n.child=d,kl(n,r.child,null,l),d=n.child,d.memoizedState=xu(l),d.childLanes=mu(r,R,l),n.memoizedState=gu,n=pc(null,d));else if(Ds(n),Zu(B)){if(R=B.nextSibling&&B.nextSibling.dataset,R)var be=R.dgst;R=be,d=Error(i(419)),d.stack="",d.digest=R,El({value:d,source:null,stack:null}),n=vu(r,n,l)}else if(Za||Er(r,n,l,!1),R=(l&r.childLanes)!==0,Za||R){if(R=ba,R!==null&&(d=Zr(R,l),d!==0&&d!==re.retryLane))throw re.retryLane=d,mn(r,d),on(R,r,d),pu;Ju(B)||hd(),n=vu(r,n,l)}else Ju(B)?(n.flags|=192,n.child=r.child,n=null):(r=re.treeContext,Ut=zn(B.nextSibling),zt=n,vt=!0,an=null,qt=!1,r!==null&&st(n,r),n=yu(n,d.children),n.flags|=4096);return n}return x?(js(),B=d.fallback,x=n.mode,re=r.child,be=re.sibling,d=T(re,{mode:"hidden",children:d.children}),d.subtreeFlags=re.subtreeFlags&65011712,be!==null?B=T(be,B):(B=C(B,x,l,null),B.flags|=2),B.return=n,d.return=n,d.sibling=B,n.child=d,pc(null,d),d=n.child,B=r.child.memoizedState,B===null?B=xu(l):(x=B.cachePool,x!==null?(re=Qa._currentValue,x=x.parent!==re?{parent:re,pool:re}:x):x=Oh(),B={baseLanes:B.baseLanes|l,cachePool:x}),d.memoizedState=B,d.childLanes=mu(r,R,l),n.memoizedState=gu,pc(r.child,d)):(Ds(n),l=r.child,r=l.sibling,l=T(l,{mode:"visible",children:d.children}),l.return=n,l.sibling=null,r!==null&&(R=n.deletions,R===null?(n.deletions=[r],n.flags|=16):R.push(r)),n.child=l,n.memoizedState=null,l)}function yu(r,n){return n=id({mode:"visible",children:n},r.mode),n.return=r,r.child=n}function id(r,n){return r=v(22,r,null,n),r.lanes=0,r}function vu(r,n,l){return kl(n,r.child,null,l),r=yu(n,n.pendingProps.children),r.flags|=2,n.memoizedState=null,r}function Vg(r,n,l){r.lanes|=n;var d=r.alternate;d!==null&&(d.lanes|=n),Ba(r.return,n,l)}function bu(r,n,l,d,x,b){var R=r.memoizedState;R===null?r.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:d,tail:l,tailMode:x,treeForkCount:b}:(R.isBackwards=n,R.rendering=null,R.renderingStartTime=0,R.last=d,R.tail=l,R.tailMode=x,R.treeForkCount=b)}function Xg(r,n,l){var d=n.pendingProps,x=d.revealOrder,b=d.tail;d=d.children;var R=Ga.current,B=(R&2)!==0;if(B?(R=R&1|2,n.flags|=128):R&=1,L(Ga,R),Ar(r,n,d,l),d=vt?Be:0,!B&&r!==null&&(r.flags&128)!==0)e:for(r=n.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Vg(r,l,n);else if(r.tag===19)Vg(r,l,n);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(x){case"forwards":for(l=n.child,x=null;l!==null;)r=l.alternate,r!==null&&V0(r)===null&&(x=l),l=l.sibling;l=x,l===null?(x=n.child,n.child=null):(x=l.sibling,l.sibling=null),bu(n,!1,x,l,b,d);break;case"backwards":case"unstable_legacy-backwards":for(l=null,x=n.child,n.child=null;x!==null;){if(r=x.alternate,r!==null&&V0(r)===null){n.child=x;break}r=x.sibling,x.sibling=l,l=x,x=r}bu(n,!0,l,null,b,d);break;case"together":bu(n,!1,null,null,void 0,d);break;default:n.memoizedState=null}return n.child}function Wi(r,n,l){if(r!==null&&(n.dependencies=r.dependencies),Bs|=n.lanes,(l&n.childLanes)===0)if(r!==null){if(Er(r,n,l,!1),(l&n.childLanes)===0)return null}else return null;if(r!==null&&n.child!==r.child)throw Error(i(153));if(n.child!==null){for(r=n.child,l=T(r,r.pendingProps),n.child=l,l.return=n;r.sibling!==null;)r=r.sibling,l=l.sibling=T(r,r.pendingProps),l.return=n;l.sibling=null}return n.child}function Su(r,n){return(r.lanes&n)!==0?!0:(r=r.dependencies,!!(r!==null&&P0(r)))}function yb(r,n,l){switch(n.tag){case 3:ze(n,n.stateNode.containerInfo),Ai(n,Qa,r.memoizedState.cache),Hi();break;case 27:case 5:Ue(n);break;case 4:ze(n,n.stateNode.containerInfo);break;case 10:Ai(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,Wf(n),null;break;case 13:var d=n.memoizedState;if(d!==null)return d.dehydrated!==null?(Ds(n),n.flags|=128,null):(l&n.child.childLanes)!==0?Wg(r,n,l):(Ds(n),r=Wi(r,n,l),r!==null?r.sibling:null);Ds(n);break;case 19:var x=(r.flags&128)!==0;if(d=(l&n.childLanes)!==0,d||(Er(r,n,l,!1),d=(l&n.childLanes)!==0),x){if(d)return Xg(r,n,l);n.flags|=128}if(x=n.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),L(Ga,Ga.current),d)break;return null;case 22:return n.lanes=0,zg(r,n,l,n.pendingProps);case 24:Ai(n,Qa,r.memoizedState.cache)}return Wi(r,n,l)}function qg(r,n,l){if(r!==null)if(r.memoizedProps!==n.pendingProps)Za=!0;else{if(!Su(r,l)&&(n.flags&128)===0)return Za=!1,yb(r,n,l);Za=(r.flags&131072)!==0}else Za=!1,vt&&(n.flags&1048576)!==0&&Fa(n,Be,n.index);switch(n.lanes=0,n.tag){case 16:e:{var d=n.pendingProps;if(r=_l(n.elementType),n.type=r,typeof r=="function")S(r)?(d=Rl(r,d),n.tag=1,n=Yg(null,n,r,d,l)):(n.tag=0,n=hu(null,n,r,d,l));else{if(r!=null){var x=r.$$typeof;if(x===ie){n.tag=11,n=Mg(null,n,r,d,l);break e}else if(x===H){n.tag=14,n=Lg(null,n,r,d,l);break e}}throw n=et(r)||r,Error(i(306,n,""))}}return n;case 0:return hu(r,n,n.type,n.pendingProps,l);case 1:return d=n.type,x=Rl(d,n.pendingProps),Yg(r,n,d,x,l);case 3:e:{if(ze(n,n.stateNode.containerInfo),r===null)throw Error(i(387));d=n.pendingProps;var b=n.memoizedState;x=b.element,Uf(r,n),oc(n,d,null,l);var R=n.memoizedState;if(d=R.cache,Ai(n,Qa,d),d!==b.cache&&ci(n,[Qa],l,!0),lc(),d=R.element,b.isDehydrated)if(b={element:d,isDehydrated:!1,cache:R.cache},n.updateQueue.baseState=b,n.memoizedState=b,n.flags&256){n=Gg(r,n,d,l);break e}else if(d!==x){x=ye(Error(i(424)),n),El(x),n=Gg(r,n,d,l);break e}else for(r=n.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,Ut=zn(r.firstChild),zt=n,vt=!0,an=null,qt=!0,l=zh(n,null,d,l),n.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Hi(),d===x){n=Wi(r,n,l);break e}Ar(r,n,d,l)}n=n.child}return n;case 26:return nd(r,n),r===null?(l=sx(n.type,null,n.pendingProps,null))?n.memoizedState=l:vt||(l=n.type,r=n.pendingProps,d=Sd(ge.current).createElement(l),d[U]=n,d[Y]=r,_r(d,l,r),ct(d),n.stateNode=d):n.memoizedState=sx(n.type,r.memoizedProps,n.pendingProps,r.memoizedState),null;case 27:return Ue(n),r===null&&vt&&(d=n.stateNode=rx(n.type,n.pendingProps,ge.current),zt=n,qt=!0,x=Ut,Us(n.type)?(ep=x,Ut=zn(d.firstChild)):Ut=x),Ar(r,n,n.pendingProps.children,l),nd(r,n),r===null&&(n.flags|=4194304),n.child;case 5:return r===null&&vt&&((x=d=Ut)&&(d=Xb(d,n.type,n.pendingProps,qt),d!==null?(n.stateNode=d,zt=n,Ut=zn(d.firstChild),qt=!1,x=!0):x=!1),x||Ln(n)),Ue(n),x=n.type,b=n.pendingProps,R=r!==null?r.memoizedProps:null,d=b.children,qu(x,b)?d=null:R!==null&&qu(x,R)&&(n.flags|=32),n.memoizedState!==null&&(x=Xf(r,n,cb,null,null,l),wc._currentValue=x),nd(r,n),Ar(r,n,d,l),n.child;case 6:return r===null&&vt&&((r=l=Ut)&&(l=qb(l,n.pendingProps,qt),l!==null?(n.stateNode=l,zt=n,Ut=null,r=!0):r=!1),r||Ln(n)),null;case 13:return Wg(r,n,l);case 4:return ze(n,n.stateNode.containerInfo),d=n.pendingProps,r===null?n.child=kl(n,null,d,l):Ar(r,n,d,l),n.child;case 11:return Mg(r,n,n.type,n.pendingProps,l);case 7:return Ar(r,n,n.pendingProps,l),n.child;case 8:return Ar(r,n,n.pendingProps.children,l),n.child;case 12:return Ar(r,n,n.pendingProps.children,l),n.child;case 10:return d=n.pendingProps,Ai(n,n.type,d.value),Ar(r,n,d.children,l),n.child;case 9:return x=n.type._context,d=n.pendingProps.children,Tl(n),x=Tr(x),d=d(x),n.flags|=1,Ar(r,n,d,l),n.child;case 14:return Lg(r,n,n.type,n.pendingProps,l);case 15:return Pg(r,n,n.type,n.pendingProps,l);case 19:return Xg(r,n,l);case 31:return mb(r,n,l);case 22:return zg(r,n,l,n.pendingProps);case 24:return Tl(n),d=Tr(Qa),r===null?(x=Lf(),x===null&&(x=ba,b=Bf(),x.pooledCache=b,b.refCount++,b!==null&&(x.pooledCacheLanes|=l),x=b),n.memoizedState={parent:d,cache:x},zf(n),Ai(n,Qa,x)):((r.lanes&l)!==0&&(Uf(r,n),oc(n,null,null,l),lc()),x=r.memoizedState,b=n.memoizedState,x.parent!==d?(x={parent:d,cache:d},n.memoizedState=x,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=x),Ai(n,Qa,d)):(d=b.cache,Ai(n,Qa,d),d!==x.cache&&ci(n,[Qa],l,!0))),Ar(r,n,n.pendingProps.children,l),n.child;case 29:throw n.pendingProps}throw Error(i(156,n.tag))}function Vi(r){r.flags|=4}function Eu(r,n,l,d,x){if((n=(r.mode&32)!==0)&&(n=!1),n){if(r.flags|=16777216,(x&335544128)===x)if(r.stateNode.complete)r.flags|=8192;else if(E1())r.flags|=8192;else throw Cl=$0,Pf}else r.flags&=-16777217}function Kg(r,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!fx(n))if(E1())r.flags|=8192;else throw Cl=$0,Pf}function sd(r,n){n!==null&&(r.flags|=4),r.flags&16384&&(n=r.tag!==22?cs():536870912,r.lanes|=n,vo|=n)}function hc(r,n){if(!vt)switch(r.tailMode){case"hidden":n=r.tail;for(var l=null;n!==null;)n.alternate!==null&&(l=n),n=n.sibling;l===null?r.tail=null:l.sibling=null;break;case"collapsed":l=r.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?n||r.tail===null?r.tail=null:r.tail.sibling=null:d.sibling=null}}function _a(r){var n=r.alternate!==null&&r.alternate.child===r.child,l=0,d=0;if(n)for(var x=r.child;x!==null;)l|=x.lanes|x.childLanes,d|=x.subtreeFlags&65011712,d|=x.flags&65011712,x.return=r,x=x.sibling;else for(x=r.child;x!==null;)l|=x.lanes|x.childLanes,d|=x.subtreeFlags,d|=x.flags,x.return=r,x=x.sibling;return r.subtreeFlags|=d,r.childLanes=l,n}function vb(r,n,l){var d=n.pendingProps;switch(Wr(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _a(n),null;case 1:return _a(n),null;case 3:return l=n.stateNode,d=null,r!==null&&(d=r.memoizedState.cache),n.memoizedState.cache!==d&&(n.flags|=2048),oi(Qa),Oe(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(r===null||r.child===null)&&(si(n)?Vi(n):r===null||r.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Ti())),_a(n),null;case 26:var x=n.type,b=n.memoizedState;return r===null?(Vi(n),b!==null?(_a(n),Kg(n,b)):(_a(n),Eu(n,x,null,d,l))):b?b!==r.memoizedState?(Vi(n),_a(n),Kg(n,b)):(_a(n),n.flags&=-16777217):(r=r.memoizedProps,r!==d&&Vi(n),_a(n),Eu(n,x,r,d,l)),null;case 27:if(St(n),l=ge.current,x=n.type,r!==null&&n.stateNode!=null)r.memoizedProps!==d&&Vi(n);else{if(!d){if(n.stateNode===null)throw Error(i(166));return _a(n),null}r=Q.current,si(n)?ws(n):(r=rx(x,d,l),n.stateNode=r,Vi(n))}return _a(n),null;case 5:if(St(n),x=n.type,r!==null&&n.stateNode!=null)r.memoizedProps!==d&&Vi(n);else{if(!d){if(n.stateNode===null)throw Error(i(166));return _a(n),null}if(b=Q.current,si(n))ws(n);else{var R=Sd(ge.current);switch(b){case 1:b=R.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:b=R.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":b=R.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":b=R.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":b=R.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild);break;case"select":b=typeof d.is=="string"?R.createElement("select",{is:d.is}):R.createElement("select"),d.multiple?b.multiple=!0:d.size&&(b.size=d.size);break;default:b=typeof d.is=="string"?R.createElement(x,{is:d.is}):R.createElement(x)}}b[U]=n,b[Y]=d;e:for(R=n.child;R!==null;){if(R.tag===5||R.tag===6)b.appendChild(R.stateNode);else if(R.tag!==4&&R.tag!==27&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===n)break e;for(;R.sibling===null;){if(R.return===null||R.return===n)break e;R=R.return}R.sibling.return=R.return,R=R.sibling}n.stateNode=b;e:switch(_r(b,x,d),x){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&Vi(n)}}return _a(n),Eu(n,n.type,r===null?null:r.memoizedProps,n.pendingProps,l),null;case 6:if(r&&n.stateNode!=null)r.memoizedProps!==d&&Vi(n);else{if(typeof d!="string"&&n.stateNode===null)throw Error(i(166));if(r=ge.current,si(n)){if(r=n.stateNode,l=n.memoizedProps,d=null,x=zt,x!==null)switch(x.tag){case 27:case 5:d=x.memoizedProps}r[U]=n,r=!!(r.nodeValue===l||d!==null&&d.suppressHydrationWarning===!0||W1(r.nodeValue,l)),r||Ln(n,!0)}else r=Sd(r).createTextNode(d),r[U]=n,n.stateNode=r}return _a(n),null;case 31:if(l=n.memoizedState,r===null||r.memoizedState!==null){if(d=si(n),l!==null){if(r===null){if(!d)throw Error(i(318));if(r=n.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[U]=n}else Hi(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;_a(n),r=!1}else l=Ti(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=l),r=!0;if(!r)return n.flags&256?(bn(n),n):(bn(n),null);if((n.flags&128)!==0)throw Error(i(558))}return _a(n),null;case 13:if(d=n.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(x=si(n),d!==null&&d.dehydrated!==null){if(r===null){if(!x)throw Error(i(318));if(x=n.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(i(317));x[U]=n}else Hi(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;_a(n),x=!1}else x=Ti(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=x),x=!0;if(!x)return n.flags&256?(bn(n),n):(bn(n),null)}return bn(n),(n.flags&128)!==0?(n.lanes=l,n):(l=d!==null,r=r!==null&&r.memoizedState!==null,l&&(d=n.child,x=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(x=d.alternate.memoizedState.cachePool.pool),b=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(b=d.memoizedState.cachePool.pool),b!==x&&(d.flags|=2048)),l!==r&&l&&(n.child.flags|=8192),sd(n,n.updateQueue),_a(n),null);case 4:return Oe(),r===null&&Yu(n.stateNode.containerInfo),_a(n),null;case 10:return oi(n.type),_a(n),null;case 19:if(I(Ga),d=n.memoizedState,d===null)return _a(n),null;if(x=(n.flags&128)!==0,b=d.rendering,b===null)if(x)hc(d,!1);else{if(La!==0||r!==null&&(r.flags&128)!==0)for(r=n.child;r!==null;){if(b=V0(r),b!==null){for(n.flags|=128,hc(d,!1),r=b.updateQueue,n.updateQueue=r,sd(n,r),n.subtreeFlags=0,r=l,l=n.child;l!==null;)W(l,r),l=l.sibling;return L(Ga,Ga.current&1|2),vt&&lt(n,d.treeForkCount),n.child}r=r.sibling}d.tail!==null&&Wt()>fd&&(n.flags|=128,x=!0,hc(d,!1),n.lanes=4194304)}else{if(!x)if(r=V0(b),r!==null){if(n.flags|=128,x=!0,r=r.updateQueue,n.updateQueue=r,sd(n,r),hc(d,!0),d.tail===null&&d.tailMode==="hidden"&&!b.alternate&&!vt)return _a(n),null}else 2*Wt()-d.renderingStartTime>fd&&l!==536870912&&(n.flags|=128,x=!0,hc(d,!1),n.lanes=4194304);d.isBackwards?(b.sibling=n.child,n.child=b):(r=d.last,r!==null?r.sibling=b:n.child=b,d.last=b)}return d.tail!==null?(r=d.tail,d.rendering=r,d.tail=r.sibling,d.renderingStartTime=Wt(),r.sibling=null,l=Ga.current,L(Ga,x?l&1|2:l&1),vt&&lt(n,d.treeForkCount),r):(_a(n),null);case 22:case 23:return bn(n),Gf(),d=n.memoizedState!==null,r!==null?r.memoizedState!==null!==d&&(n.flags|=8192):d&&(n.flags|=8192),d?(l&536870912)!==0&&(n.flags&128)===0&&(_a(n),n.subtreeFlags&6&&(n.flags|=8192)):_a(n),l=n.updateQueue,l!==null&&sd(n,l.retryQueue),l=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),d=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(d=n.memoizedState.cachePool.pool),d!==l&&(n.flags|=2048),r!==null&&I(Al),null;case 24:return l=null,r!==null&&(l=r.memoizedState.cache),n.memoizedState.cache!==l&&(n.flags|=2048),oi(Qa),_a(n),null;case 25:return null;case 30:return null}throw Error(i(156,n.tag))}function bb(r,n){switch(Wr(n),n.tag){case 1:return r=n.flags,r&65536?(n.flags=r&-65537|128,n):null;case 3:return oi(Qa),Oe(),r=n.flags,(r&65536)!==0&&(r&128)===0?(n.flags=r&-65537|128,n):null;case 26:case 27:case 5:return St(n),null;case 31:if(n.memoizedState!==null){if(bn(n),n.alternate===null)throw Error(i(340));Hi()}return r=n.flags,r&65536?(n.flags=r&-65537|128,n):null;case 13:if(bn(n),r=n.memoizedState,r!==null&&r.dehydrated!==null){if(n.alternate===null)throw Error(i(340));Hi()}return r=n.flags,r&65536?(n.flags=r&-65537|128,n):null;case 19:return I(Ga),null;case 4:return Oe(),null;case 10:return oi(n.type),null;case 22:case 23:return bn(n),Gf(),r!==null&&I(Al),r=n.flags,r&65536?(n.flags=r&-65537|128,n):null;case 24:return oi(Qa),null;case 25:return null;default:return null}}function Qg(r,n){switch(Wr(n),n.tag){case 3:oi(Qa),Oe();break;case 26:case 27:case 5:St(n);break;case 4:Oe();break;case 31:n.memoizedState!==null&&bn(n);break;case 13:bn(n);break;case 19:I(Ga);break;case 10:oi(n.type);break;case 22:case 23:bn(n),Gf(),r!==null&&I(Al);break;case 24:oi(Qa)}}function gc(r,n){try{var l=n.updateQueue,d=l!==null?l.lastEffect:null;if(d!==null){var x=d.next;l=x;do{if((l.tag&r)===r){d=void 0;var b=l.create,R=l.inst;d=b(),R.destroy=d}l=l.next}while(l!==x)}}catch(B){oa(n,n.return,B)}}function Os(r,n,l){try{var d=n.updateQueue,x=d!==null?d.lastEffect:null;if(x!==null){var b=x.next;d=b;do{if((d.tag&r)===r){var R=d.inst,B=R.destroy;if(B!==void 0){R.destroy=void 0,x=n;var re=l,be=B;try{be()}catch(Fe){oa(x,re,Fe)}}}d=d.next}while(d!==b)}}catch(Fe){oa(n,n.return,Fe)}}function Jg(r){var n=r.updateQueue;if(n!==null){var l=r.stateNode;try{Hh(n,l)}catch(d){oa(r,r.return,d)}}}function Zg(r,n,l){l.props=Rl(r.type,r.memoizedProps),l.state=r.memoizedState;try{l.componentWillUnmount()}catch(d){oa(r,n,d)}}function xc(r,n){try{var l=r.ref;if(l!==null){switch(r.tag){case 26:case 27:case 5:var d=r.stateNode;break;case 30:d=r.stateNode;break;default:d=r.stateNode}typeof l=="function"?r.refCleanup=l(d):l.current=d}}catch(x){oa(r,n,x)}}function _i(r,n){var l=r.ref,d=r.refCleanup;if(l!==null)if(typeof d=="function")try{d()}catch(x){oa(r,n,x)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(x){oa(r,n,x)}else l.current=null}function e1(r){var n=r.type,l=r.memoizedProps,d=r.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":l.autoFocus&&d.focus();break e;case"img":l.src?d.src=l.src:l.srcSet&&(d.srcset=l.srcSet)}}catch(x){oa(r,r.return,x)}}function Tu(r,n,l){try{var d=r.stateNode;Hb(d,r.type,l,n),d[Y]=n}catch(x){oa(r,r.return,x)}}function t1(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Us(r.type)||r.tag===4}function Au(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||t1(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Us(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function _u(r,n,l){var d=r.tag;if(d===5||d===6)r=r.stateNode,n?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(r,n):(n=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,n.appendChild(r),l=l._reactRootContainer,l!=null||n.onclick!==null||(n.onclick=pn));else if(d!==4&&(d===27&&Us(r.type)&&(l=r.stateNode,n=null),r=r.child,r!==null))for(_u(r,n,l),r=r.sibling;r!==null;)_u(r,n,l),r=r.sibling}function ld(r,n,l){var d=r.tag;if(d===5||d===6)r=r.stateNode,n?l.insertBefore(r,n):l.appendChild(r);else if(d!==4&&(d===27&&Us(r.type)&&(l=r.stateNode),r=r.child,r!==null))for(ld(r,n,l),r=r.sibling;r!==null;)ld(r,n,l),r=r.sibling}function a1(r){var n=r.stateNode,l=r.memoizedProps;try{for(var d=r.type,x=n.attributes;x.length;)n.removeAttributeNode(x[0]);_r(n,d,l),n[U]=r,n[Y]=l}catch(b){oa(r,r.return,b)}}var Xi=!1,er=!1,Cu=!1,r1=typeof WeakSet=="function"?WeakSet:Set,xr=null;function Sb(r,n){if(r=r.containerInfo,Vu=wd,r=Qo(r),ro(r)){if("selectionStart"in r)var l={start:r.selectionStart,end:r.selectionEnd};else e:{l=(l=r.ownerDocument)&&l.defaultView||window;var d=l.getSelection&&l.getSelection();if(d&&d.rangeCount!==0){l=d.anchorNode;var x=d.anchorOffset,b=d.focusNode;d=d.focusOffset;try{l.nodeType,b.nodeType}catch{l=null;break e}var R=0,B=-1,re=-1,be=0,Fe=0,Le=r,_e=null;t:for(;;){for(var we;Le!==l||x!==0&&Le.nodeType!==3||(B=R+x),Le!==b||d!==0&&Le.nodeType!==3||(re=R+d),Le.nodeType===3&&(R+=Le.nodeValue.length),(we=Le.firstChild)!==null;)_e=Le,Le=we;for(;;){if(Le===r)break t;if(_e===l&&++be===x&&(B=R),_e===b&&++Fe===d&&(re=R),(we=Le.nextSibling)!==null)break;Le=_e,_e=Le.parentNode}Le=we}l=B===-1||re===-1?null:{start:B,end:re}}else l=null}l=l||{start:0,end:0}}else l=null;for(Xu={focusedElem:r,selectionRange:l},wd=!1,xr=n;xr!==null;)if(n=xr,r=n.child,(n.subtreeFlags&1028)!==0&&r!==null)r.return=n,xr=r;else for(;xr!==null;){switch(n=xr,b=n.alternate,r=n.flags,n.tag){case 0:if((r&4)!==0&&(r=n.updateQueue,r=r!==null?r.events:null,r!==null))for(l=0;l<r.length;l++)x=r[l],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&b!==null){r=void 0,l=n,x=b.memoizedProps,b=b.memoizedState,d=l.stateNode;try{var ot=Rl(l.type,x);r=d.getSnapshotBeforeUpdate(ot,b),d.__reactInternalSnapshotBeforeUpdate=r}catch(gt){oa(l,l.return,gt)}}break;case 3:if((r&1024)!==0){if(r=n.stateNode.containerInfo,l=r.nodeType,l===9)Qu(r);else if(l===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Qu(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=n.sibling,r!==null){r.return=n.return,xr=r;break}xr=n.return}}function n1(r,n,l){var d=l.flags;switch(l.tag){case 0:case 11:case 15:Ki(r,l),d&4&&gc(5,l);break;case 1:if(Ki(r,l),d&4)if(r=l.stateNode,n===null)try{r.componentDidMount()}catch(R){oa(l,l.return,R)}else{var x=Rl(l.type,n.memoizedProps);n=n.memoizedState;try{r.componentDidUpdate(x,n,r.__reactInternalSnapshotBeforeUpdate)}catch(R){oa(l,l.return,R)}}d&64&&Jg(l),d&512&&xc(l,l.return);break;case 3:if(Ki(r,l),d&64&&(r=l.updateQueue,r!==null)){if(n=null,l.child!==null)switch(l.child.tag){case 27:case 5:n=l.child.stateNode;break;case 1:n=l.child.stateNode}try{Hh(r,n)}catch(R){oa(l,l.return,R)}}break;case 27:n===null&&d&4&&a1(l);case 26:case 5:Ki(r,l),n===null&&d&4&&e1(l),d&512&&xc(l,l.return);break;case 12:Ki(r,l);break;case 31:Ki(r,l),d&4&&l1(r,l);break;case 13:Ki(r,l),d&4&&o1(r,l),d&64&&(r=l.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(l=Nb.bind(null,l),Kb(r,l))));break;case 22:if(d=l.memoizedState!==null||Xi,!d){n=n!==null&&n.memoizedState!==null||er,x=Xi;var b=er;Xi=d,(er=n)&&!b?Qi(r,l,(l.subtreeFlags&8772)!==0):Ki(r,l),Xi=x,er=b}break;case 30:break;default:Ki(r,l)}}function i1(r){var n=r.alternate;n!==null&&(r.alternate=null,i1(n)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(n=r.stateNode,n!==null&&Ge(n)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Da=null,rn=!1;function qi(r,n,l){for(l=l.child;l!==null;)s1(r,n,l),l=l.sibling}function s1(r,n,l){if(Ot&&typeof Ot.onCommitFiberUnmount=="function")try{Ot.onCommitFiberUnmount(ia,l)}catch{}switch(l.tag){case 26:er||_i(l,n),qi(r,n,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:er||_i(l,n);var d=Da,x=rn;Us(l.type)&&(Da=l.stateNode,rn=!1),qi(r,n,l),_c(l.stateNode),Da=d,rn=x;break;case 5:er||_i(l,n);case 6:if(d=Da,x=rn,Da=null,qi(r,n,l),Da=d,rn=x,Da!==null)if(rn)try{(Da.nodeType===9?Da.body:Da.nodeName==="HTML"?Da.ownerDocument.body:Da).removeChild(l.stateNode)}catch(b){oa(l,n,b)}else try{Da.removeChild(l.stateNode)}catch(b){oa(l,n,b)}break;case 18:Da!==null&&(rn?(r=Da,J1(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,l.stateNode),ko(r)):J1(Da,l.stateNode));break;case 4:d=Da,x=rn,Da=l.stateNode.containerInfo,rn=!0,qi(r,n,l),Da=d,rn=x;break;case 0:case 11:case 14:case 15:Os(2,l,n),er||Os(4,l,n),qi(r,n,l);break;case 1:er||(_i(l,n),d=l.stateNode,typeof d.componentWillUnmount=="function"&&Zg(l,n,d)),qi(r,n,l);break;case 21:qi(r,n,l);break;case 22:er=(d=er)||l.memoizedState!==null,qi(r,n,l),er=d;break;default:qi(r,n,l)}}function l1(r,n){if(n.memoizedState===null&&(r=n.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{ko(r)}catch(l){oa(n,n.return,l)}}}function o1(r,n){if(n.memoizedState===null&&(r=n.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{ko(r)}catch(l){oa(n,n.return,l)}}function Eb(r){switch(r.tag){case 31:case 13:case 19:var n=r.stateNode;return n===null&&(n=r.stateNode=new r1),n;case 22:return r=r.stateNode,n=r._retryCache,n===null&&(n=r._retryCache=new r1),n;default:throw Error(i(435,r.tag))}}function od(r,n){var l=Eb(r);n.forEach(function(d){if(!l.has(d)){l.add(d);var x=Fb.bind(null,r,d);d.then(x,x)}})}function nn(r,n){var l=n.deletions;if(l!==null)for(var d=0;d<l.length;d++){var x=l[d],b=r,R=n,B=R;e:for(;B!==null;){switch(B.tag){case 27:if(Us(B.type)){Da=B.stateNode,rn=!1;break e}break;case 5:Da=B.stateNode,rn=!1;break e;case 3:case 4:Da=B.stateNode.containerInfo,rn=!0;break e}B=B.return}if(Da===null)throw Error(i(160));s1(b,R,x),Da=null,rn=!1,b=x.alternate,b!==null&&(b.return=null),x.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)c1(n,r),n=n.sibling}var di=null;function c1(r,n){var l=r.alternate,d=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:nn(n,r),sn(r),d&4&&(Os(3,r,r.return),gc(3,r),Os(5,r,r.return));break;case 1:nn(n,r),sn(r),d&512&&(er||l===null||_i(l,l.return)),d&64&&Xi&&(r=r.updateQueue,r!==null&&(d=r.callbacks,d!==null&&(l=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=l===null?d:l.concat(d))));break;case 26:var x=di;if(nn(n,r),sn(r),d&512&&(er||l===null||_i(l,l.return)),d&4){var b=l!==null?l.memoizedState:null;if(d=r.memoizedState,l===null)if(d===null)if(r.stateNode===null){e:{d=r.type,l=r.memoizedProps,x=x.ownerDocument||x;t:switch(d){case"title":b=x.getElementsByTagName("title")[0],(!b||b[Ae]||b[U]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=x.createElement(d),x.head.insertBefore(b,x.querySelector("head > title"))),_r(b,d,l),b[U]=r,ct(b),d=b;break e;case"link":var R=cx("link","href",x).get(d+(l.href||""));if(R){for(var B=0;B<R.length;B++)if(b=R[B],b.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&b.getAttribute("rel")===(l.rel==null?null:l.rel)&&b.getAttribute("title")===(l.title==null?null:l.title)&&b.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){R.splice(B,1);break t}}b=x.createElement(d),_r(b,d,l),x.head.appendChild(b);break;case"meta":if(R=cx("meta","content",x).get(d+(l.content||""))){for(B=0;B<R.length;B++)if(b=R[B],b.getAttribute("content")===(l.content==null?null:""+l.content)&&b.getAttribute("name")===(l.name==null?null:l.name)&&b.getAttribute("property")===(l.property==null?null:l.property)&&b.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&b.getAttribute("charset")===(l.charSet==null?null:l.charSet)){R.splice(B,1);break t}}b=x.createElement(d),_r(b,d,l),x.head.appendChild(b);break;default:throw Error(i(468,d))}b[U]=r,ct(b),d=b}r.stateNode=d}else dx(x,r.type,r.stateNode);else r.stateNode=ox(x,d,r.memoizedProps);else b!==d?(b===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):b.count--,d===null?dx(x,r.type,r.stateNode):ox(x,d,r.memoizedProps)):d===null&&r.stateNode!==null&&Tu(r,r.memoizedProps,l.memoizedProps)}break;case 27:nn(n,r),sn(r),d&512&&(er||l===null||_i(l,l.return)),l!==null&&d&4&&Tu(r,r.memoizedProps,l.memoizedProps);break;case 5:if(nn(n,r),sn(r),d&512&&(er||l===null||_i(l,l.return)),r.flags&32){x=r.stateNode;try{Ii(x,"")}catch(ot){oa(r,r.return,ot)}}d&4&&r.stateNode!=null&&(x=r.memoizedProps,Tu(r,x,l!==null?l.memoizedProps:x)),d&1024&&(Cu=!0);break;case 6:if(nn(n,r),sn(r),d&4){if(r.stateNode===null)throw Error(i(162));d=r.memoizedProps,l=r.stateNode;try{l.nodeValue=d}catch(ot){oa(r,r.return,ot)}}break;case 3:if(Ad=null,x=di,di=Ed(n.containerInfo),nn(n,r),di=x,sn(r),d&4&&l!==null&&l.memoizedState.isDehydrated)try{ko(n.containerInfo)}catch(ot){oa(r,r.return,ot)}Cu&&(Cu=!1,d1(r));break;case 4:d=di,di=Ed(r.stateNode.containerInfo),nn(n,r),sn(r),di=d;break;case 12:nn(n,r),sn(r);break;case 31:nn(n,r),sn(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,od(r,d)));break;case 13:nn(n,r),sn(r),r.child.flags&8192&&r.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(dd=Wt()),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,od(r,d)));break;case 22:x=r.memoizedState!==null;var re=l!==null&&l.memoizedState!==null,be=Xi,Fe=er;if(Xi=be||x,er=Fe||re,nn(n,r),er=Fe,Xi=be,sn(r),d&8192)e:for(n=r.stateNode,n._visibility=x?n._visibility&-2:n._visibility|1,x&&(l===null||re||Xi||er||Nl(r)),l=null,n=r;;){if(n.tag===5||n.tag===26){if(l===null){re=l=n;try{if(b=re.stateNode,x)R=b.style,typeof R.setProperty=="function"?R.setProperty("display","none","important"):R.display="none";else{B=re.stateNode;var Le=re.memoizedProps.style,_e=Le!=null&&Le.hasOwnProperty("display")?Le.display:null;B.style.display=_e==null||typeof _e=="boolean"?"":(""+_e).trim()}}catch(ot){oa(re,re.return,ot)}}}else if(n.tag===6){if(l===null){re=n;try{re.stateNode.nodeValue=x?"":re.memoizedProps}catch(ot){oa(re,re.return,ot)}}}else if(n.tag===18){if(l===null){re=n;try{var we=re.stateNode;x?Z1(we,!0):Z1(re.stateNode,!1)}catch(ot){oa(re,re.return,ot)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===r)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;l===n&&(l=null),n=n.return}l===n&&(l=null),n.sibling.return=n.return,n=n.sibling}d&4&&(d=r.updateQueue,d!==null&&(l=d.retryQueue,l!==null&&(d.retryQueue=null,od(r,l))));break;case 19:nn(n,r),sn(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,od(r,d)));break;case 30:break;case 21:break;default:nn(n,r),sn(r)}}function sn(r){var n=r.flags;if(n&2){try{for(var l,d=r.return;d!==null;){if(t1(d)){l=d;break}d=d.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var x=l.stateNode,b=Au(r);ld(r,b,x);break;case 5:var R=l.stateNode;l.flags&32&&(Ii(R,""),l.flags&=-33);var B=Au(r);ld(r,B,R);break;case 3:case 4:var re=l.stateNode.containerInfo,be=Au(r);_u(r,be,re);break;default:throw Error(i(161))}}catch(Fe){oa(r,r.return,Fe)}r.flags&=-3}n&4096&&(r.flags&=-4097)}function d1(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var n=r;d1(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),r=r.sibling}}function Ki(r,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)n1(r,n.alternate,n),n=n.sibling}function Nl(r){for(r=r.child;r!==null;){var n=r;switch(n.tag){case 0:case 11:case 14:case 15:Os(4,n,n.return),Nl(n);break;case 1:_i(n,n.return);var l=n.stateNode;typeof l.componentWillUnmount=="function"&&Zg(n,n.return,l),Nl(n);break;case 27:_c(n.stateNode);case 26:case 5:_i(n,n.return),Nl(n);break;case 22:n.memoizedState===null&&Nl(n);break;case 30:Nl(n);break;default:Nl(n)}r=r.sibling}}function Qi(r,n,l){for(l=l&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var d=n.alternate,x=r,b=n,R=b.flags;switch(b.tag){case 0:case 11:case 15:Qi(x,b,l),gc(4,b);break;case 1:if(Qi(x,b,l),d=b,x=d.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(be){oa(d,d.return,be)}if(d=b,x=d.updateQueue,x!==null){var B=d.stateNode;try{var re=x.shared.hiddenCallbacks;if(re!==null)for(x.shared.hiddenCallbacks=null,x=0;x<re.length;x++)Uh(re[x],B)}catch(be){oa(d,d.return,be)}}l&&R&64&&Jg(b),xc(b,b.return);break;case 27:a1(b);case 26:case 5:Qi(x,b,l),l&&d===null&&R&4&&e1(b),xc(b,b.return);break;case 12:Qi(x,b,l);break;case 31:Qi(x,b,l),l&&R&4&&l1(x,b);break;case 13:Qi(x,b,l),l&&R&4&&o1(x,b);break;case 22:b.memoizedState===null&&Qi(x,b,l),xc(b,b.return);break;case 30:break;default:Qi(x,b,l)}n=n.sibling}}function ku(r,n){var l=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),r=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(r=n.memoizedState.cachePool.pool),r!==l&&(r!=null&&r.refCount++,l!=null&&ac(l))}function wu(r,n){r=null,n.alternate!==null&&(r=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==r&&(n.refCount++,r!=null&&ac(r))}function fi(r,n,l,d){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)f1(r,n,l,d),n=n.sibling}function f1(r,n,l,d){var x=n.flags;switch(n.tag){case 0:case 11:case 15:fi(r,n,l,d),x&2048&&gc(9,n);break;case 1:fi(r,n,l,d);break;case 3:fi(r,n,l,d),x&2048&&(r=null,n.alternate!==null&&(r=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==r&&(n.refCount++,r!=null&&ac(r)));break;case 12:if(x&2048){fi(r,n,l,d),r=n.stateNode;try{var b=n.memoizedProps,R=b.id,B=b.onPostCommit;typeof B=="function"&&B(R,n.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(re){oa(n,n.return,re)}}else fi(r,n,l,d);break;case 31:fi(r,n,l,d);break;case 13:fi(r,n,l,d);break;case 23:break;case 22:b=n.stateNode,R=n.alternate,n.memoizedState!==null?b._visibility&2?fi(r,n,l,d):mc(r,n):b._visibility&2?fi(r,n,l,d):(b._visibility|=2,xo(r,n,l,d,(n.subtreeFlags&10256)!==0||!1)),x&2048&&ku(R,n);break;case 24:fi(r,n,l,d),x&2048&&wu(n.alternate,n);break;default:fi(r,n,l,d)}}function xo(r,n,l,d,x){for(x=x&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var b=r,R=n,B=l,re=d,be=R.flags;switch(R.tag){case 0:case 11:case 15:xo(b,R,B,re,x),gc(8,R);break;case 23:break;case 22:var Fe=R.stateNode;R.memoizedState!==null?Fe._visibility&2?xo(b,R,B,re,x):mc(b,R):(Fe._visibility|=2,xo(b,R,B,re,x)),x&&be&2048&&ku(R.alternate,R);break;case 24:xo(b,R,B,re,x),x&&be&2048&&wu(R.alternate,R);break;default:xo(b,R,B,re,x)}n=n.sibling}}function mc(r,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var l=r,d=n,x=d.flags;switch(d.tag){case 22:mc(l,d),x&2048&&ku(d.alternate,d);break;case 24:mc(l,d),x&2048&&wu(d.alternate,d);break;default:mc(l,d)}n=n.sibling}}var yc=8192;function mo(r,n,l){if(r.subtreeFlags&yc)for(r=r.child;r!==null;)u1(r,n,l),r=r.sibling}function u1(r,n,l){switch(r.tag){case 26:mo(r,n,l),r.flags&yc&&r.memoizedState!==null&&o2(l,di,r.memoizedState,r.memoizedProps);break;case 5:mo(r,n,l);break;case 3:case 4:var d=di;di=Ed(r.stateNode.containerInfo),mo(r,n,l),di=d;break;case 22:r.memoizedState===null&&(d=r.alternate,d!==null&&d.memoizedState!==null?(d=yc,yc=16777216,mo(r,n,l),yc=d):mo(r,n,l));break;default:mo(r,n,l)}}function p1(r){var n=r.alternate;if(n!==null&&(r=n.child,r!==null)){n.child=null;do n=r.sibling,r.sibling=null,r=n;while(r!==null)}}function vc(r){var n=r.deletions;if((r.flags&16)!==0){if(n!==null)for(var l=0;l<n.length;l++){var d=n[l];xr=d,g1(d,r)}p1(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)h1(r),r=r.sibling}function h1(r){switch(r.tag){case 0:case 11:case 15:vc(r),r.flags&2048&&Os(9,r,r.return);break;case 3:vc(r);break;case 12:vc(r);break;case 22:var n=r.stateNode;r.memoizedState!==null&&n._visibility&2&&(r.return===null||r.return.tag!==13)?(n._visibility&=-3,cd(r)):vc(r);break;default:vc(r)}}function cd(r){var n=r.deletions;if((r.flags&16)!==0){if(n!==null)for(var l=0;l<n.length;l++){var d=n[l];xr=d,g1(d,r)}p1(r)}for(r=r.child;r!==null;){switch(n=r,n.tag){case 0:case 11:case 15:Os(8,n,n.return),cd(n);break;case 22:l=n.stateNode,l._visibility&2&&(l._visibility&=-3,cd(n));break;default:cd(n)}r=r.sibling}}function g1(r,n){for(;xr!==null;){var l=xr;switch(l.tag){case 0:case 11:case 15:Os(8,l,n);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var d=l.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:ac(l.memoizedState.cache)}if(d=l.child,d!==null)d.return=l,xr=d;else e:for(l=r;xr!==null;){d=xr;var x=d.sibling,b=d.return;if(i1(d),d===l){xr=null;break e}if(x!==null){x.return=b,xr=x;break e}xr=b}}}var Tb={getCacheForType:function(r){var n=Tr(Qa),l=n.data.get(r);return l===void 0&&(l=r(),n.data.set(r,l)),l},cacheSignal:function(){return Tr(Qa).controller.signal}},Ab=typeof WeakMap=="function"?WeakMap:Map,na=0,ba=null,Lt=null,Ht=0,la=0,Sn=null,Is=!1,yo=!1,Ru=!1,Ji=0,La=0,Bs=0,Fl=0,Nu=0,En=0,vo=0,bc=null,ln=null,Fu=!1,dd=0,x1=0,fd=1/0,ud=null,Ms=null,cr=0,Ls=null,bo=null,Zi=0,Du=0,ju=null,m1=null,Sc=0,Ou=null;function Tn(){return(na&2)!==0&&Ht!==0?Ht&-Ht:de.T!==null?zu():j()}function y1(){if(En===0)if((Ht&536870912)===0||vt){var r=Jn;Jn<<=1,(Jn&3932160)===0&&(Jn=262144),En=r}else En=536870912;return r=vn.current,r!==null&&(r.flags|=32),En}function on(r,n,l){(r===ba&&(la===2||la===9)||r.cancelPendingCommit!==null)&&(So(r,0),Ps(r,Ht,En,!1)),vi(r,l),((na&2)===0||r!==ba)&&(r===ba&&((na&2)===0&&(Fl|=l),La===4&&Ps(r,Ht,En,!1)),Ci(r))}function v1(r,n,l){if((na&6)!==0)throw Error(i(327));var d=!l&&(n&127)===0&&(n&r.expiredLanes)===0||Fn(r,n),x=d?kb(r,n):Bu(r,n,!0),b=d;do{if(x===0){yo&&!d&&Ps(r,n,0,!1);break}else{if(l=r.current.alternate,b&&!_b(l)){x=Bu(r,n,!1),b=!1;continue}if(x===2){if(b=n,r.errorRecoveryDisabledLanes&b)var R=0;else R=r.pendingLanes&-536870913,R=R!==0?R:R&536870912?536870912:0;if(R!==0){n=R;e:{var B=r;x=bc;var re=B.current.memoizedState.isDehydrated;if(re&&(So(B,R).flags|=256),R=Bu(B,R,!1),R!==2){if(Ru&&!re){B.errorRecoveryDisabledLanes|=b,Fl|=b,x=4;break e}b=ln,ln=x,b!==null&&(ln===null?ln=b:ln.push.apply(ln,b))}x=R}if(b=!1,x!==2)continue}}if(x===1){So(r,0),Ps(r,n,0,!0);break}e:{switch(d=r,b=x,b){case 0:case 1:throw Error(i(345));case 4:if((n&4194048)!==n)break;case 6:Ps(d,n,En,!Is);break e;case 2:ln=null;break;case 3:case 5:break;default:throw Error(i(329))}if((n&62914560)===n&&(x=dd+300-Wt(),10<x)){if(Ps(d,n,En,!Is),ya(d,0,!0)!==0)break e;Zi=n,d.timeoutHandle=K1(b1.bind(null,d,l,ln,ud,Fu,n,En,Fl,vo,Is,b,"Throttled",-0,0),x);break e}b1(d,l,ln,ud,Fu,n,En,Fl,vo,Is,b,null,-0,0)}}break}while(!0);Ci(r)}function b1(r,n,l,d,x,b,R,B,re,be,Fe,Le,_e,we){if(r.timeoutHandle=-1,Le=n.subtreeFlags,Le&8192||(Le&16785408)===16785408){Le={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:pn},u1(n,b,Le);var ot=(b&62914560)===b?dd-Wt():(b&4194048)===b?x1-Wt():0;if(ot=c2(Le,ot),ot!==null){Zi=b,r.cancelPendingCommit=ot(w1.bind(null,r,n,b,l,d,x,R,B,re,Fe,Le,null,_e,we)),Ps(r,b,R,!be);return}}w1(r,n,b,l,d,x,R,B,re)}function _b(r){for(var n=r;;){var l=n.tag;if((l===0||l===11||l===15)&&n.flags&16384&&(l=n.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var d=0;d<l.length;d++){var x=l[d],b=x.getSnapshot;x=x.value;try{if(!tn(b(),x))return!1}catch{return!1}}if(l=n.child,n.subtreeFlags&16384&&l!==null)l.return=n,n=l;else{if(n===r)break;for(;n.sibling===null;){if(n.return===null||n.return===r)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Ps(r,n,l,d){n&=~Nu,n&=~Fl,r.suspendedLanes|=n,r.pingedLanes&=~n,d&&(r.warmLanes|=n),d=r.expirationTimes;for(var x=n;0<x;){var b=31-Zt(x),R=1<<b;d[b]=-1,x&=~R}l!==0&&rl(r,l,n)}function pd(){return(na&6)===0?(Ec(0),!1):!0}function Iu(){if(Lt!==null){if(la===0)var r=Lt.return;else r=Lt,li=yn=null,Qf(r),fo=null,nc=0,r=Lt;for(;r!==null;)Qg(r.alternate,r),r=r.return;Lt=null}}function So(r,n){var l=r.timeoutHandle;l!==-1&&(r.timeoutHandle=-1,Gb(l)),l=r.cancelPendingCommit,l!==null&&(r.cancelPendingCommit=null,l()),Zi=0,Iu(),ba=r,Lt=l=T(r.current,null),Ht=n,la=0,Sn=null,Is=!1,yo=Fn(r,n),Ru=!1,vo=En=Nu=Fl=Bs=La=0,ln=bc=null,Fu=!1,(n&8)!==0&&(n|=n&32);var d=r.entangledLanes;if(d!==0)for(r=r.entanglements,d&=n;0<d;){var x=31-Zt(d),b=1<<x;n|=r[x],d&=~b}return Ji=n,ua(),l}function S1(r,n){kt=null,de.H=uc,n===co||n===H0?(n=Mh(),la=3):n===Pf?(n=Mh(),la=4):la=n===pu?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,Sn=n,Lt===null&&(La=1,ad(r,ye(n,r.current)))}function E1(){var r=vn.current;return r===null?!0:(Ht&4194048)===Ht?Pn===null:(Ht&62914560)===Ht||(Ht&536870912)!==0?r===Pn:!1}function T1(){var r=de.H;return de.H=uc,r===null?uc:r}function A1(){var r=de.A;return de.A=Tb,r}function hd(){La=4,Is||(Ht&4194048)!==Ht&&vn.current!==null||(yo=!0),(Bs&134217727)===0&&(Fl&134217727)===0||ba===null||Ps(ba,Ht,En,!1)}function Bu(r,n,l){var d=na;na|=2;var x=T1(),b=A1();(ba!==r||Ht!==n)&&(ud=null,So(r,n)),n=!1;var R=La;e:do try{if(la!==0&&Lt!==null){var B=Lt,re=Sn;switch(la){case 8:Iu(),R=6;break e;case 3:case 2:case 9:case 6:vn.current===null&&(n=!0);var be=la;if(la=0,Sn=null,Eo(r,B,re,be),l&&yo){R=0;break e}break;default:be=la,la=0,Sn=null,Eo(r,B,re,be)}}Cb(),R=La;break}catch(Fe){S1(r,Fe)}while(!0);return n&&r.shellSuspendCounter++,li=yn=null,na=d,de.H=x,de.A=b,Lt===null&&(ba=null,Ht=0,ua()),R}function Cb(){for(;Lt!==null;)_1(Lt)}function kb(r,n){var l=na;na|=2;var d=T1(),x=A1();ba!==r||Ht!==n?(ud=null,fd=Wt()+500,So(r,n)):yo=Fn(r,n);e:do try{if(la!==0&&Lt!==null){n=Lt;var b=Sn;t:switch(la){case 1:la=0,Sn=null,Eo(r,n,b,1);break;case 2:case 9:if(Ih(b)){la=0,Sn=null,C1(n);break}n=function(){la!==2&&la!==9||ba!==r||(la=7),Ci(r)},b.then(n,n);break e;case 3:la=7;break e;case 4:la=5;break e;case 7:Ih(b)?(la=0,Sn=null,C1(n)):(la=0,Sn=null,Eo(r,n,b,7));break;case 5:var R=null;switch(Lt.tag){case 26:R=Lt.memoizedState;case 5:case 27:var B=Lt;if(R?fx(R):B.stateNode.complete){la=0,Sn=null;var re=B.sibling;if(re!==null)Lt=re;else{var be=B.return;be!==null?(Lt=be,gd(be)):Lt=null}break t}}la=0,Sn=null,Eo(r,n,b,5);break;case 6:la=0,Sn=null,Eo(r,n,b,6);break;case 8:Iu(),La=6;break e;default:throw Error(i(462))}}wb();break}catch(Fe){S1(r,Fe)}while(!0);return li=yn=null,de.H=d,de.A=x,na=l,Lt!==null?0:(ba=null,Ht=0,ua(),La)}function wb(){for(;Lt!==null&&!Rn();)_1(Lt)}function _1(r){var n=qg(r.alternate,r,Ji);r.memoizedProps=r.pendingProps,n===null?gd(r):Lt=n}function C1(r){var n=r,l=n.alternate;switch(n.tag){case 15:case 0:n=$g(l,n,n.pendingProps,n.type,void 0,Ht);break;case 11:n=$g(l,n,n.pendingProps,n.type.render,n.ref,Ht);break;case 5:Qf(n);default:Qg(l,n),n=Lt=W(n,Ji),n=qg(l,n,Ji)}r.memoizedProps=r.pendingProps,n===null?gd(r):Lt=n}function Eo(r,n,l,d){li=yn=null,Qf(n),fo=null,nc=0;var x=n.return;try{if(xb(r,x,n,l,Ht)){La=1,ad(r,ye(l,r.current)),Lt=null;return}}catch(b){if(x!==null)throw Lt=x,b;La=1,ad(r,ye(l,r.current)),Lt=null;return}n.flags&32768?(vt||d===1?r=!0:yo||(Ht&536870912)!==0?r=!1:(Is=r=!0,(d===2||d===9||d===3||d===6)&&(d=vn.current,d!==null&&d.tag===13&&(d.flags|=16384))),k1(n,r)):gd(n)}function gd(r){var n=r;do{if((n.flags&32768)!==0){k1(n,Is);return}r=n.return;var l=vb(n.alternate,n,Ji);if(l!==null){Lt=l;return}if(n=n.sibling,n!==null){Lt=n;return}Lt=n=r}while(n!==null);La===0&&(La=5)}function k1(r,n){do{var l=bb(r.alternate,r);if(l!==null){l.flags&=32767,Lt=l;return}if(l=r.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!n&&(r=r.sibling,r!==null)){Lt=r;return}Lt=r=l}while(r!==null);La=6,Lt=null}function w1(r,n,l,d,x,b,R,B,re){r.cancelPendingCommit=null;do xd();while(cr!==0);if((na&6)!==0)throw Error(i(327));if(n!==null){if(n===r.current)throw Error(i(177));if(b=n.lanes|n.childLanes,b|=$a,ur(r,l,b,R,B,re),r===ba&&(Lt=ba=null,Ht=0),bo=n,Ls=r,Zi=l,Du=b,ju=x,m1=d,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,Db(Ea,function(){return j1(),null})):(r.callbackNode=null,r.callbackPriority=0),d=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||d){d=de.T,de.T=null,x=Ce.p,Ce.p=2,R=na,na|=4;try{Sb(r,n,l)}finally{na=R,Ce.p=x,de.T=d}}cr=1,R1(),N1(),F1()}}function R1(){if(cr===1){cr=0;var r=Ls,n=bo,l=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||l){l=de.T,de.T=null;var d=Ce.p;Ce.p=2;var x=na;na|=4;try{c1(n,r);var b=Xu,R=Qo(r.containerInfo),B=b.focusedElem,re=b.selectionRange;if(R!==B&&B&&B.ownerDocument&&vl(B.ownerDocument.documentElement,B)){if(re!==null&&ro(B)){var be=re.start,Fe=re.end;if(Fe===void 0&&(Fe=be),"selectionStart"in B)B.selectionStart=be,B.selectionEnd=Math.min(Fe,B.value.length);else{var Le=B.ownerDocument||document,_e=Le&&Le.defaultView||window;if(_e.getSelection){var we=_e.getSelection(),ot=B.textContent.length,gt=Math.min(re.start,ot),ga=re.end===void 0?gt:Math.min(re.end,ot);!we.extend&&gt>ga&&(R=ga,ga=gt,gt=R);var he=Ui(B,gt),ce=Ui(B,ga);if(he&&ce&&(we.rangeCount!==1||we.anchorNode!==he.node||we.anchorOffset!==he.offset||we.focusNode!==ce.node||we.focusOffset!==ce.offset)){var ve=Le.createRange();ve.setStart(he.node,he.offset),we.removeAllRanges(),gt>ga?(we.addRange(ve),we.extend(ce.node,ce.offset)):(ve.setEnd(ce.node,ce.offset),we.addRange(ve))}}}}for(Le=[],we=B;we=we.parentNode;)we.nodeType===1&&Le.push({element:we,left:we.scrollLeft,top:we.scrollTop});for(typeof B.focus=="function"&&B.focus(),B=0;B<Le.length;B++){var Ie=Le[B];Ie.element.scrollLeft=Ie.left,Ie.element.scrollTop=Ie.top}}wd=!!Vu,Xu=Vu=null}finally{na=x,Ce.p=d,de.T=l}}r.current=n,cr=2}}function N1(){if(cr===2){cr=0;var r=Ls,n=bo,l=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||l){l=de.T,de.T=null;var d=Ce.p;Ce.p=2;var x=na;na|=4;try{n1(r,n.alternate,n)}finally{na=x,Ce.p=d,de.T=l}}cr=3}}function F1(){if(cr===4||cr===3){cr=0,Rr();var r=Ls,n=bo,l=Zi,d=m1;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?cr=5:(cr=0,bo=Ls=null,D1(r,r.pendingLanes));var x=r.pendingLanes;if(x===0&&(Ms=null),ds(l),n=n.stateNode,Ot&&typeof Ot.onCommitFiberRoot=="function")try{Ot.onCommitFiberRoot(ia,n,void 0,(n.current.flags&128)===128)}catch{}if(d!==null){n=de.T,x=Ce.p,Ce.p=2,de.T=null;try{for(var b=r.onRecoverableError,R=0;R<d.length;R++){var B=d[R];b(B.value,{componentStack:B.stack})}}finally{de.T=n,Ce.p=x}}(Zi&3)!==0&&xd(),Ci(r),x=r.pendingLanes,(l&261930)!==0&&(x&42)!==0?r===Ou?Sc++:(Sc=0,Ou=r):Sc=0,Ec(0)}}function D1(r,n){(r.pooledCacheLanes&=n)===0&&(n=r.pooledCache,n!=null&&(r.pooledCache=null,ac(n)))}function xd(){return R1(),N1(),F1(),j1()}function j1(){if(cr!==5)return!1;var r=Ls,n=Du;Du=0;var l=ds(Zi),d=de.T,x=Ce.p;try{Ce.p=32>l?32:l,de.T=null,l=ju,ju=null;var b=Ls,R=Zi;if(cr=0,bo=Ls=null,Zi=0,(na&6)!==0)throw Error(i(331));var B=na;if(na|=4,h1(b.current),f1(b,b.current,R,l),na=B,Ec(0,!1),Ot&&typeof Ot.onPostCommitFiberRoot=="function")try{Ot.onPostCommitFiberRoot(ia,b)}catch{}return!0}finally{Ce.p=x,de.T=d,D1(r,n)}}function O1(r,n,l){n=ye(l,n),n=uu(r.stateNode,n,2),r=Fs(r,n,2),r!==null&&(vi(r,2),Ci(r))}function oa(r,n,l){if(r.tag===3)O1(r,r,l);else for(;n!==null;){if(n.tag===3){O1(n,r,l);break}else if(n.tag===1){var d=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Ms===null||!Ms.has(d))){r=ye(l,r),l=Ig(2),d=Fs(n,l,2),d!==null&&(Bg(l,d,n,r),vi(d,2),Ci(d));break}}n=n.return}}function Mu(r,n,l){var d=r.pingCache;if(d===null){d=r.pingCache=new Ab;var x=new Set;d.set(n,x)}else x=d.get(n),x===void 0&&(x=new Set,d.set(n,x));x.has(l)||(Ru=!0,x.add(l),r=Rb.bind(null,r,n,l),n.then(r,r))}function Rb(r,n,l){var d=r.pingCache;d!==null&&d.delete(n),r.pingedLanes|=r.suspendedLanes&l,r.warmLanes&=~l,ba===r&&(Ht&l)===l&&(La===4||La===3&&(Ht&62914560)===Ht&&300>Wt()-dd?(na&2)===0&&So(r,0):Nu|=l,vo===Ht&&(vo=0)),Ci(r)}function I1(r,n){n===0&&(n=cs()),r=mn(r,n),r!==null&&(vi(r,n),Ci(r))}function Nb(r){var n=r.memoizedState,l=0;n!==null&&(l=n.retryLane),I1(r,l)}function Fb(r,n){var l=0;switch(r.tag){case 31:case 13:var d=r.stateNode,x=r.memoizedState;x!==null&&(l=x.retryLane);break;case 19:d=r.stateNode;break;case 22:d=r.stateNode._retryCache;break;default:throw Error(i(314))}d!==null&&d.delete(n),I1(r,l)}function Db(r,n){return nr(r,n)}var md=null,To=null,Lu=!1,yd=!1,Pu=!1,zs=0;function Ci(r){r!==To&&r.next===null&&(To===null?md=To=r:To=To.next=r),yd=!0,Lu||(Lu=!0,Ob())}function Ec(r,n){if(!Pu&&yd){Pu=!0;do for(var l=!1,d=md;d!==null;){if(r!==0){var x=d.pendingLanes;if(x===0)var b=0;else{var R=d.suspendedLanes,B=d.pingedLanes;b=(1<<31-Zt(42|r)+1)-1,b&=x&~(R&~B),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(l=!0,P1(d,b))}else b=Ht,b=ya(d,d===ba?b:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(b&3)===0||Fn(d,b)||(l=!0,P1(d,b));d=d.next}while(l);Pu=!1}}function jb(){B1()}function B1(){yd=Lu=!1;var r=0;zs!==0&&Yb()&&(r=zs);for(var n=Wt(),l=null,d=md;d!==null;){var x=d.next,b=M1(d,n);b===0?(d.next=null,l===null?md=x:l.next=x,x===null&&(To=l)):(l=d,(r!==0||(b&3)!==0)&&(yd=!0)),d=x}cr!==0&&cr!==5||Ec(r),zs!==0&&(zs=0)}function M1(r,n){for(var l=r.suspendedLanes,d=r.pingedLanes,x=r.expirationTimes,b=r.pendingLanes&-62914561;0<b;){var R=31-Zt(b),B=1<<R,re=x[R];re===-1?((B&l)===0||(B&d)!==0)&&(x[R]=Zn(B,n)):re<=n&&(r.expiredLanes|=B),b&=~B}if(n=ba,l=Ht,l=ya(r,r===n?l:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d=r.callbackNode,l===0||r===n&&(la===2||la===9)||r.cancelPendingCommit!==null)return d!==null&&d!==null&&Yr(d),r.callbackNode=null,r.callbackPriority=0;if((l&3)===0||Fn(r,l)){if(n=l&-l,n===r.callbackPriority)return n;switch(d!==null&&Yr(d),ds(l)){case 2:case 8:l=Qr;break;case 32:l=Ea;break;case 268435456:l=yt;break;default:l=Ea}return d=L1.bind(null,r),l=nr(l,d),r.callbackPriority=n,r.callbackNode=l,n}return d!==null&&d!==null&&Yr(d),r.callbackPriority=2,r.callbackNode=null,2}function L1(r,n){if(cr!==0&&cr!==5)return r.callbackNode=null,r.callbackPriority=0,null;var l=r.callbackNode;if(xd()&&r.callbackNode!==l)return null;var d=Ht;return d=ya(r,r===ba?d:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d===0?null:(v1(r,d,n),M1(r,Wt()),r.callbackNode!=null&&r.callbackNode===l?L1.bind(null,r):null)}function P1(r,n){if(xd())return null;v1(r,n,!0)}function Ob(){Wb(function(){(na&6)!==0?nr(Sr,jb):B1()})}function zu(){if(zs===0){var r=lo;r===0&&(r=Qn,Qn<<=1,(Qn&261888)===0&&(Qn=256)),zs=r}return zs}function z1(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:il(""+r)}function U1(r,n){var l=n.ownerDocument.createElement("input");return l.name=n.name,l.value=n.value,r.id&&l.setAttribute("form",r.id),n.parentNode.insertBefore(l,n),r=new FormData(r),l.parentNode.removeChild(l),r}function Ib(r,n,l,d,x){if(n==="submit"&&l&&l.stateNode===x){var b=z1((x[Y]||null).action),R=d.submitter;R&&(n=(n=R[Y]||null)?z1(n.formAction):R.getAttribute("formAction"),n!==null&&(b=n,R=null));var B=new ys("action","action",null,d,x);r.push({event:B,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(zs!==0){var re=R?U1(x,R):new FormData(x);su(l,{pending:!0,data:re,method:x.method,action:b},null,re)}}else typeof b=="function"&&(B.preventDefault(),re=R?U1(x,R):new FormData(x),su(l,{pending:!0,data:re,method:x.method,action:b},b,re))},currentTarget:x}]})}}for(var Uu=0;Uu<ec.length;Uu++){var Hu=ec[Uu],Bb=Hu.toLowerCase(),Mb=Hu[0].toUpperCase()+Hu.slice(1);Mn(Bb,"on"+Mb)}Mn(so,"onAnimationEnd"),Mn(I0,"onAnimationIteration"),Mn(B0,"onAnimationStart"),Mn("dblclick","onDoubleClick"),Mn("focusin","onFocus"),Mn("focusout","onBlur"),Mn(M0,"onTransitionRun"),Mn(Of,"onTransitionStart"),Mn(If,"onTransitionCancel"),Mn(Zo,"onTransitionEnd"),Ha("onMouseEnter",["mouseout","mouseover"]),Ha("onMouseLeave",["mouseout","mouseover"]),Ha("onPointerEnter",["pointerout","pointerover"]),Ha("onPointerLeave",["pointerout","pointerover"]),ft("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ft("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ft("onBeforeInput",["compositionend","keypress","textInput","paste"]),ft("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ft("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ft("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Tc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lb=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Tc));function H1(r,n){n=(n&4)!==0;for(var l=0;l<r.length;l++){var d=r[l],x=d.event;d=d.listeners;e:{var b=void 0;if(n)for(var R=d.length-1;0<=R;R--){var B=d[R],re=B.instance,be=B.currentTarget;if(B=B.listener,re!==b&&x.isPropagationStopped())break e;b=B,x.currentTarget=be;try{b(x)}catch(Fe){Ei(Fe)}x.currentTarget=null,b=re}else for(R=0;R<d.length;R++){if(B=d[R],re=B.instance,be=B.currentTarget,B=B.listener,re!==b&&x.isPropagationStopped())break e;b=B,x.currentTarget=be;try{b(x)}catch(Fe){Ei(Fe)}x.currentTarget=null,b=re}}}}function Pt(r,n){var l=n[Ee];l===void 0&&(l=n[Ee]=new Set);var d=r+"__bubble";l.has(d)||($1(n,r,2,!1),l.add(d))}function $u(r,n,l){var d=0;n&&(d|=4),$1(l,r,d,n)}var vd="_reactListening"+Math.random().toString(36).slice(2);function Yu(r){if(!r[vd]){r[vd]=!0,va.forEach(function(l){l!=="selectionchange"&&(Lb.has(l)||$u(l,!1,r),$u(l,!0,r))});var n=r.nodeType===9?r:r.ownerDocument;n===null||n[vd]||(n[vd]=!0,$u("selectionchange",!1,n))}}function $1(r,n,l,d){switch(yx(n)){case 2:var x=u2;break;case 8:x=p2;break;default:x=ip}l=x.bind(null,n,l,r),x=void 0,!ms||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(x=!0),d?x!==void 0?r.addEventListener(n,l,{capture:!0,passive:x}):r.addEventListener(n,l,!0):x!==void 0?r.addEventListener(n,l,{passive:x}):r.addEventListener(n,l,!1)}function Gu(r,n,l,d,x){var b=d;if((n&1)===0&&(n&2)===0&&d!==null)e:for(;;){if(d===null)return;var R=d.tag;if(R===3||R===4){var B=d.stateNode.containerInfo;if(B===x)break;if(R===4)for(R=d.return;R!==null;){var re=R.tag;if((re===3||re===4)&&R.stateNode.containerInfo===x)return;R=R.return}for(;B!==null;){if(R=Ye(B),R===null)return;if(re=R.tag,re===5||re===6||re===26||re===27){d=b=R;continue e}B=B.parentNode}}d=d.return}xs(function(){var be=b,Fe=hs(l),Le=[];e:{var _e=L0.get(r);if(_e!==void 0){var we=ys,ot=r;switch(r){case"keypress":if(Zl(l)===0)break e;case"keydown":case"keyup":we=tt;break;case"focusin":ot="focus",we=Vo;break;case"focusout":ot="blur",we=Vo;break;case"beforeblur":case"afterblur":we=Vo;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":we=b0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":we=ul;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":we=S0;break;case so:case I0:case B0:we=bf;break;case Zo:we=_f;break;case"scroll":case"scrollend":we=mf;break;case"wheel":we=kf;break;case"copy":case"cut":case"paste":we=bs;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":we=Tt;break;case"toggle":case"beforetoggle":we=Rf}var gt=(n&4)!==0,ga=!gt&&(r==="scroll"||r==="scrollend"),he=gt?_e!==null?_e+"Capture":null:_e;gt=[];for(var ce=be,ve;ce!==null;){var Ie=ce;if(ve=Ie.stateNode,Ie=Ie.tag,Ie!==5&&Ie!==26&&Ie!==27||ve===null||he===null||(Ie=Li(ce,he),Ie!=null&&gt.push(Ac(ce,Ie,ve))),ga)break;ce=ce.return}0<gt.length&&(_e=new we(_e,ot,null,l,Fe),Le.push({event:_e,listeners:gt}))}}if((n&7)===0){e:{if(_e=r==="mouseover"||r==="pointerover",we=r==="mouseout"||r==="pointerout",_e&&l!==ps&&(ot=l.relatedTarget||l.fromElement)&&(Ye(ot)||ot[J]))break e;if((we||_e)&&(_e=Fe.window===Fe?Fe:(_e=Fe.ownerDocument)?_e.defaultView||_e.parentWindow:window,we?(ot=l.relatedTarget||l.toElement,we=be,ot=ot?Ye(ot):null,ot!==null&&(ga=c(ot),gt=ot.tag,ot!==ga||gt!==5&&gt!==27&&gt!==6)&&(ot=null)):(we=null,ot=be),we!==ot)){if(gt=b0,Ie="onMouseLeave",he="onMouseEnter",ce="mouse",(r==="pointerout"||r==="pointerover")&&(gt=Tt,Ie="onPointerLeave",he="onPointerEnter",ce="pointer"),ga=we==null?_e:He(we),ve=ot==null?_e:He(ot),_e=new gt(Ie,ce+"leave",we,l,Fe),_e.target=ga,_e.relatedTarget=ve,Ie=null,Ye(Fe)===be&&(gt=new gt(he,ce+"enter",ot,l,Fe),gt.target=ve,gt.relatedTarget=ga,Ie=gt),ga=Ie,we&&ot)t:{for(gt=Pb,he=we,ce=ot,ve=0,Ie=he;Ie;Ie=gt(Ie))ve++;Ie=0;for(var pt=ce;pt;pt=gt(pt))Ie++;for(;0<ve-Ie;)he=gt(he),ve--;for(;0<Ie-ve;)ce=gt(ce),Ie--;for(;ve--;){if(he===ce||ce!==null&&he===ce.alternate){gt=he;break t}he=gt(he),ce=gt(ce)}gt=null}else gt=null;we!==null&&Y1(Le,_e,we,gt,!1),ot!==null&&ga!==null&&Y1(Le,ga,ot,gt,!0)}}e:{if(_e=be?He(be):window,we=_e.nodeName&&_e.nodeName.toLowerCase(),we==="select"||we==="input"&&_e.type==="file")var ta=yl;else if(w0(_e))if(ea)ta=jf;else{ta=D0;var ut=F0}else we=_e.nodeName,!we||we.toLowerCase()!=="input"||_e.type!=="checkbox"&&_e.type!=="radio"?be&&Yo(be.elementType)&&(ta=yl):ta=Df;if(ta&&(ta=ta(r,be))){R0(Le,ta,l,Fe);break e}ut&&ut(r,_e,be),r==="focusout"&&be&&_e.type==="number"&&be.memoizedProps.value!=null&&In(_e,"number",_e.value)}switch(ut=be?He(be):window,r){case"focusin":(w0(ut)||ut.contentEditable==="true")&&(ks=ut,Jo=be,bl=null);break;case"focusout":bl=Jo=ks=null;break;case"mousedown":xn=!0;break;case"contextmenu":case"mouseup":case"dragend":xn=!1,no(Le,l,Fe);break;case"selectionchange":if(O0)break;case"keydown":case"keyup":no(Le,l,Fe)}var Nt;if(qo)e:{switch(r){case"compositionstart":var $t="onCompositionStart";break e;case"compositionend":$t="onCompositionEnd";break e;case"compositionupdate":$t="onCompositionUpdate";break e}$t=void 0}else Es?_0(r,l)&&($t="onCompositionEnd"):r==="keydown"&&l.keyCode===229&&($t="onCompositionStart");$t&&(E0&&l.locale!=="ko"&&(Es||$t!=="onCompositionStart"?$t==="onCompositionEnd"&&Es&&(Nt=ll()):(gn=Fe,Go="value"in gn?gn.value:gn.textContent,Es=!0)),ut=bd(be,$t),0<ut.length&&($t=new zi($t,r,null,l,Fe),Le.push({event:$t,listeners:ut}),Nt?$t.data=Nt:(Nt=C0(l),Nt!==null&&($t.data=Nt)))),(Nt=Nf?k0(r,l):Ff(r,l))&&($t=bd(be,"onBeforeInput"),0<$t.length&&(ut=new zi("onBeforeInput","beforeinput",null,l,Fe),Le.push({event:ut,listeners:$t}),ut.data=Nt)),Ib(Le,r,be,l,Fe)}H1(Le,n)})}function Ac(r,n,l){return{instance:r,listener:n,currentTarget:l}}function bd(r,n){for(var l=n+"Capture",d=[];r!==null;){var x=r,b=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||b===null||(x=Li(r,l),x!=null&&d.unshift(Ac(r,x,b)),x=Li(r,n),x!=null&&d.push(Ac(r,x,b))),r.tag===3)return d;r=r.return}return[]}function Pb(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Y1(r,n,l,d,x){for(var b=n._reactName,R=[];l!==null&&l!==d;){var B=l,re=B.alternate,be=B.stateNode;if(B=B.tag,re!==null&&re===d)break;B!==5&&B!==26&&B!==27||be===null||(re=be,x?(be=Li(l,b),be!=null&&R.unshift(Ac(l,be,re))):x||(be=Li(l,b),be!=null&&R.push(Ac(l,be,re)))),l=l.return}R.length!==0&&r.push({event:n,listeners:R})}var zb=/\r\n?/g,Ub=/\u0000|\uFFFD/g;function G1(r){return(typeof r=="string"?r:""+r).replace(zb,`
`).replace(Ub,"")}function W1(r,n){return n=G1(n),G1(r)===n}function ha(r,n,l,d,x,b){switch(l){case"children":typeof d=="string"?n==="body"||n==="textarea"&&d===""||Ii(r,d):(typeof d=="number"||typeof d=="bigint")&&n!=="body"&&Ii(r,""+d);break;case"className":ei(r,"class",d);break;case"tabIndex":ei(r,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":ei(r,l,d);break;case"style":m0(r,d,b);break;case"data":if(n!=="object"){ei(r,"data",d);break}case"src":case"href":if(d===""&&(n!=="a"||l!=="href")){r.removeAttribute(l);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(l);break}d=il(""+d),r.setAttribute(l,d);break;case"action":case"formAction":if(typeof d=="function"){r.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(l==="formAction"?(n!=="input"&&ha(r,n,"name",x.name,x,null),ha(r,n,"formEncType",x.formEncType,x,null),ha(r,n,"formMethod",x.formMethod,x,null),ha(r,n,"formTarget",x.formTarget,x,null)):(ha(r,n,"encType",x.encType,x,null),ha(r,n,"method",x.method,x,null),ha(r,n,"target",x.target,x,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(l);break}d=il(""+d),r.setAttribute(l,d);break;case"onClick":d!=null&&(r.onclick=pn);break;case"onScroll":d!=null&&Pt("scroll",r);break;case"onScrollEnd":d!=null&&Pt("scrollend",r);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(l=d.__html,l!=null){if(x.children!=null)throw Error(i(60));r.innerHTML=l}}break;case"multiple":r.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":r.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){r.removeAttribute("xlink:href");break}l=il(""+d),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(l,""+d):r.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(l,""):r.removeAttribute(l);break;case"capture":case"download":d===!0?r.setAttribute(l,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(l,d):r.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?r.setAttribute(l,d):r.removeAttribute(l);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?r.removeAttribute(l):r.setAttribute(l,d);break;case"popover":Pt("beforetoggle",r),Pt("toggle",r),sa(r,"popover",d);break;case"xlinkActuate":hr(r,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":hr(r,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":hr(r,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":hr(r,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":hr(r,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":hr(r,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":hr(r,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":hr(r,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":hr(r,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":sa(r,"is",d);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=y0.get(l)||l,sa(r,l,d))}}function Wu(r,n,l,d,x,b){switch(l){case"style":m0(r,d,b);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(l=d.__html,l!=null){if(x.children!=null)throw Error(i(60));r.innerHTML=l}}break;case"children":typeof d=="string"?Ii(r,d):(typeof d=="number"||typeof d=="bigint")&&Ii(r,""+d);break;case"onScroll":d!=null&&Pt("scroll",r);break;case"onScrollEnd":d!=null&&Pt("scrollend",r);break;case"onClick":d!=null&&(r.onclick=pn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!xt.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(x=l.endsWith("Capture"),n=l.slice(2,x?l.length-7:void 0),b=r[Y]||null,b=b!=null?b[l]:null,typeof b=="function"&&r.removeEventListener(n,b,x),typeof d=="function")){typeof b!="function"&&b!==null&&(l in r?r[l]=null:r.hasAttribute(l)&&r.removeAttribute(l)),r.addEventListener(n,d,x);break e}l in r?r[l]=d:d===!0?r.setAttribute(l,""):sa(r,l,d)}}}function _r(r,n,l){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Pt("error",r),Pt("load",r);var d=!1,x=!1,b;for(b in l)if(l.hasOwnProperty(b)){var R=l[b];if(R!=null)switch(b){case"src":d=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,n));default:ha(r,n,b,R,l,null)}}x&&ha(r,n,"srcSet",l.srcSet,l,null),d&&ha(r,n,"src",l.src,l,null);return;case"input":Pt("invalid",r);var B=b=R=x=null,re=null,be=null;for(d in l)if(l.hasOwnProperty(d)){var Fe=l[d];if(Fe!=null)switch(d){case"name":x=Fe;break;case"type":R=Fe;break;case"checked":re=Fe;break;case"defaultChecked":be=Fe;break;case"value":b=Fe;break;case"defaultValue":B=Fe;break;case"children":case"dangerouslySetInnerHTML":if(Fe!=null)throw Error(i(137,n));break;default:ha(r,n,d,Fe,l,null)}}h0(r,b,B,re,be,R,x,!1);return;case"select":Pt("invalid",r),d=R=b=null;for(x in l)if(l.hasOwnProperty(x)&&(B=l[x],B!=null))switch(x){case"value":b=B;break;case"defaultValue":R=B;break;case"multiple":d=B;default:ha(r,n,x,B,l,null)}n=b,l=R,r.multiple=!!d,n!=null?us(r,!!d,n,!1):l!=null&&us(r,!!d,l,!0);return;case"textarea":Pt("invalid",r),b=x=d=null;for(R in l)if(l.hasOwnProperty(R)&&(B=l[R],B!=null))switch(R){case"value":d=B;break;case"defaultValue":x=B;break;case"children":b=B;break;case"dangerouslySetInnerHTML":if(B!=null)throw Error(i(91));break;default:ha(r,n,R,B,l,null)}x0(r,d,x,b);return;case"option":for(re in l)l.hasOwnProperty(re)&&(d=l[re],d!=null)&&(re==="selected"?r.selected=d&&typeof d!="function"&&typeof d!="symbol":ha(r,n,re,d,l,null));return;case"dialog":Pt("beforetoggle",r),Pt("toggle",r),Pt("cancel",r),Pt("close",r);break;case"iframe":case"object":Pt("load",r);break;case"video":case"audio":for(d=0;d<Tc.length;d++)Pt(Tc[d],r);break;case"image":Pt("error",r),Pt("load",r);break;case"details":Pt("toggle",r);break;case"embed":case"source":case"link":Pt("error",r),Pt("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(be in l)if(l.hasOwnProperty(be)&&(d=l[be],d!=null))switch(be){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,n));default:ha(r,n,be,d,l,null)}return;default:if(Yo(n)){for(Fe in l)l.hasOwnProperty(Fe)&&(d=l[Fe],d!==void 0&&Wu(r,n,Fe,d,l,void 0));return}}for(B in l)l.hasOwnProperty(B)&&(d=l[B],d!=null&&ha(r,n,B,d,l,null))}function Hb(r,n,l,d){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,b=null,R=null,B=null,re=null,be=null,Fe=null;for(we in l){var Le=l[we];if(l.hasOwnProperty(we)&&Le!=null)switch(we){case"checked":break;case"value":break;case"defaultValue":re=Le;default:d.hasOwnProperty(we)||ha(r,n,we,null,d,Le)}}for(var _e in d){var we=d[_e];if(Le=l[_e],d.hasOwnProperty(_e)&&(we!=null||Le!=null))switch(_e){case"type":b=we;break;case"name":x=we;break;case"checked":be=we;break;case"defaultChecked":Fe=we;break;case"value":R=we;break;case"defaultValue":B=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(i(137,n));break;default:we!==Le&&ha(r,n,_e,we,d,Le)}}Oi(r,R,B,re,be,Fe,b,x);return;case"select":we=R=B=_e=null;for(b in l)if(re=l[b],l.hasOwnProperty(b)&&re!=null)switch(b){case"value":break;case"multiple":we=re;default:d.hasOwnProperty(b)||ha(r,n,b,null,d,re)}for(x in d)if(b=d[x],re=l[x],d.hasOwnProperty(x)&&(b!=null||re!=null))switch(x){case"value":_e=b;break;case"defaultValue":B=b;break;case"multiple":R=b;default:b!==re&&ha(r,n,x,b,d,re)}n=B,l=R,d=we,_e!=null?us(r,!!l,_e,!1):!!d!=!!l&&(n!=null?us(r,!!l,n,!0):us(r,!!l,l?[]:"",!1));return;case"textarea":we=_e=null;for(B in l)if(x=l[B],l.hasOwnProperty(B)&&x!=null&&!d.hasOwnProperty(B))switch(B){case"value":break;case"children":break;default:ha(r,n,B,null,d,x)}for(R in d)if(x=d[R],b=l[R],d.hasOwnProperty(R)&&(x!=null||b!=null))switch(R){case"value":_e=x;break;case"defaultValue":we=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(i(91));break;default:x!==b&&ha(r,n,R,x,d,b)}g0(r,_e,we);return;case"option":for(var ot in l)_e=l[ot],l.hasOwnProperty(ot)&&_e!=null&&!d.hasOwnProperty(ot)&&(ot==="selected"?r.selected=!1:ha(r,n,ot,null,d,_e));for(re in d)_e=d[re],we=l[re],d.hasOwnProperty(re)&&_e!==we&&(_e!=null||we!=null)&&(re==="selected"?r.selected=_e&&typeof _e!="function"&&typeof _e!="symbol":ha(r,n,re,_e,d,we));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var gt in l)_e=l[gt],l.hasOwnProperty(gt)&&_e!=null&&!d.hasOwnProperty(gt)&&ha(r,n,gt,null,d,_e);for(be in d)if(_e=d[be],we=l[be],d.hasOwnProperty(be)&&_e!==we&&(_e!=null||we!=null))switch(be){case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(i(137,n));break;default:ha(r,n,be,_e,d,we)}return;default:if(Yo(n)){for(var ga in l)_e=l[ga],l.hasOwnProperty(ga)&&_e!==void 0&&!d.hasOwnProperty(ga)&&Wu(r,n,ga,void 0,d,_e);for(Fe in d)_e=d[Fe],we=l[Fe],!d.hasOwnProperty(Fe)||_e===we||_e===void 0&&we===void 0||Wu(r,n,Fe,_e,d,we);return}}for(var he in l)_e=l[he],l.hasOwnProperty(he)&&_e!=null&&!d.hasOwnProperty(he)&&ha(r,n,he,null,d,_e);for(Le in d)_e=d[Le],we=l[Le],!d.hasOwnProperty(Le)||_e===we||_e==null&&we==null||ha(r,n,Le,_e,d,we)}function V1(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function $b(){if(typeof performance.getEntriesByType=="function"){for(var r=0,n=0,l=performance.getEntriesByType("resource"),d=0;d<l.length;d++){var x=l[d],b=x.transferSize,R=x.initiatorType,B=x.duration;if(b&&B&&V1(R)){for(R=0,B=x.responseEnd,d+=1;d<l.length;d++){var re=l[d],be=re.startTime;if(be>B)break;var Fe=re.transferSize,Le=re.initiatorType;Fe&&V1(Le)&&(re=re.responseEnd,R+=Fe*(re<B?1:(B-be)/(re-be)))}if(--d,n+=8*(b+R)/(x.duration/1e3),r++,10<r)break}}if(0<r)return n/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Vu=null,Xu=null;function Sd(r){return r.nodeType===9?r:r.ownerDocument}function X1(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function q1(r,n){if(r===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&n==="foreignObject"?0:r}function qu(r,n){return r==="textarea"||r==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Ku=null;function Yb(){var r=window.event;return r&&r.type==="popstate"?r===Ku?!1:(Ku=r,!0):(Ku=null,!1)}var K1=typeof setTimeout=="function"?setTimeout:void 0,Gb=typeof clearTimeout=="function"?clearTimeout:void 0,Q1=typeof Promise=="function"?Promise:void 0,Wb=typeof queueMicrotask=="function"?queueMicrotask:typeof Q1<"u"?function(r){return Q1.resolve(null).then(r).catch(Vb)}:K1;function Vb(r){setTimeout(function(){throw r})}function Us(r){return r==="head"}function J1(r,n){var l=n,d=0;do{var x=l.nextSibling;if(r.removeChild(l),x&&x.nodeType===8)if(l=x.data,l==="/$"||l==="/&"){if(d===0){r.removeChild(x),ko(n);return}d--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")d++;else if(l==="html")_c(r.ownerDocument.documentElement);else if(l==="head"){l=r.ownerDocument.head,_c(l);for(var b=l.firstChild;b;){var R=b.nextSibling,B=b.nodeName;b[Ae]||B==="SCRIPT"||B==="STYLE"||B==="LINK"&&b.rel.toLowerCase()==="stylesheet"||l.removeChild(b),b=R}}else l==="body"&&_c(r.ownerDocument.body);l=x}while(l);ko(n)}function Z1(r,n){var l=r;r=0;do{var d=l.nextSibling;if(l.nodeType===1?n?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(n?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),d&&d.nodeType===8)if(l=d.data,l==="/$"){if(r===0)break;r--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||r++;l=d}while(l)}function Qu(r){var n=r.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var l=n;switch(n=n.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Qu(l),Ge(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}r.removeChild(l)}}function Xb(r,n,l,d){for(;r.nodeType===1;){var x=l;if(r.nodeName.toLowerCase()!==n.toLowerCase()){if(!d&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(d){if(!r[Ae])switch(n){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(b=r.getAttribute("rel"),b==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(b!==x.rel||r.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||r.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||r.getAttribute("title")!==(x.title==null?null:x.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(b=r.getAttribute("src"),(b!==(x.src==null?null:x.src)||r.getAttribute("type")!==(x.type==null?null:x.type)||r.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&b&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(n==="input"&&r.type==="hidden"){var b=x.name==null?null:""+x.name;if(x.type==="hidden"&&r.getAttribute("name")===b)return r}else return r;if(r=zn(r.nextSibling),r===null)break}return null}function qb(r,n,l){if(n==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!l||(r=zn(r.nextSibling),r===null))return null;return r}function ex(r,n){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!n||(r=zn(r.nextSibling),r===null))return null;return r}function Ju(r){return r.data==="$?"||r.data==="$~"}function Zu(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function Kb(r,n){var l=r.ownerDocument;if(r.data==="$~")r._reactRetry=n;else if(r.data!=="$?"||l.readyState!=="loading")n();else{var d=function(){n(),l.removeEventListener("DOMContentLoaded",d)};l.addEventListener("DOMContentLoaded",d),r._reactRetry=d}}function zn(r){for(;r!=null;r=r.nextSibling){var n=r.nodeType;if(n===1||n===3)break;if(n===8){if(n=r.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return r}var ep=null;function tx(r){r=r.nextSibling;for(var n=0;r;){if(r.nodeType===8){var l=r.data;if(l==="/$"||l==="/&"){if(n===0)return zn(r.nextSibling);n--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||n++}r=r.nextSibling}return null}function ax(r){r=r.previousSibling;for(var n=0;r;){if(r.nodeType===8){var l=r.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(n===0)return r;n--}else l!=="/$"&&l!=="/&"||n++}r=r.previousSibling}return null}function rx(r,n,l){switch(n=Sd(l),r){case"html":if(r=n.documentElement,!r)throw Error(i(452));return r;case"head":if(r=n.head,!r)throw Error(i(453));return r;case"body":if(r=n.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function _c(r){for(var n=r.attributes;n.length;)r.removeAttributeNode(n[0]);Ge(r)}var Un=new Map,nx=new Set;function Ed(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var es=Ce.d;Ce.d={f:Qb,r:Jb,D:Zb,C:e2,L:t2,m:a2,X:n2,S:r2,M:i2};function Qb(){var r=es.f(),n=pd();return r||n}function Jb(r){var n=Ze(r);n!==null&&n.tag===5&&n.type==="form"?Sg(n):es.r(r)}var Ao=typeof document>"u"?null:document;function ix(r,n,l){var d=Ao;if(d&&typeof n=="string"&&n){var x=Ra(n);x='link[rel="'+r+'"][href="'+x+'"]',typeof l=="string"&&(x+='[crossorigin="'+l+'"]'),nx.has(x)||(nx.add(x),r={rel:r,crossOrigin:l,href:n},d.querySelector(x)===null&&(n=d.createElement("link"),_r(n,"link",r),ct(n),d.head.appendChild(n)))}}function Zb(r){es.D(r),ix("dns-prefetch",r,null)}function e2(r,n){es.C(r,n),ix("preconnect",r,n)}function t2(r,n,l){es.L(r,n,l);var d=Ao;if(d&&r&&n){var x='link[rel="preload"][as="'+Ra(n)+'"]';n==="image"&&l&&l.imageSrcSet?(x+='[imagesrcset="'+Ra(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(x+='[imagesizes="'+Ra(l.imageSizes)+'"]')):x+='[href="'+Ra(r)+'"]';var b=x;switch(n){case"style":b=_o(r);break;case"script":b=Co(r)}Un.has(b)||(r=A({rel:"preload",href:n==="image"&&l&&l.imageSrcSet?void 0:r,as:n},l),Un.set(b,r),d.querySelector(x)!==null||n==="style"&&d.querySelector(Cc(b))||n==="script"&&d.querySelector(kc(b))||(n=d.createElement("link"),_r(n,"link",r),ct(n),d.head.appendChild(n)))}}function a2(r,n){es.m(r,n);var l=Ao;if(l&&r){var d=n&&typeof n.as=="string"?n.as:"script",x='link[rel="modulepreload"][as="'+Ra(d)+'"][href="'+Ra(r)+'"]',b=x;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=Co(r)}if(!Un.has(b)&&(r=A({rel:"modulepreload",href:r},n),Un.set(b,r),l.querySelector(x)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(kc(b)))return}d=l.createElement("link"),_r(d,"link",r),ct(d),l.head.appendChild(d)}}}function r2(r,n,l){es.S(r,n,l);var d=Ao;if(d&&r){var x=Xe(d).hoistableStyles,b=_o(r);n=n||"default";var R=x.get(b);if(!R){var B={loading:0,preload:null};if(R=d.querySelector(Cc(b)))B.loading=5;else{r=A({rel:"stylesheet",href:r,"data-precedence":n},l),(l=Un.get(b))&&tp(r,l);var re=R=d.createElement("link");ct(re),_r(re,"link",r),re._p=new Promise(function(be,Fe){re.onload=be,re.onerror=Fe}),re.addEventListener("load",function(){B.loading|=1}),re.addEventListener("error",function(){B.loading|=2}),B.loading|=4,Td(R,n,d)}R={type:"stylesheet",instance:R,count:1,state:B},x.set(b,R)}}}function n2(r,n){es.X(r,n);var l=Ao;if(l&&r){var d=Xe(l).hoistableScripts,x=Co(r),b=d.get(x);b||(b=l.querySelector(kc(x)),b||(r=A({src:r,async:!0},n),(n=Un.get(x))&&ap(r,n),b=l.createElement("script"),ct(b),_r(b,"link",r),l.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},d.set(x,b))}}function i2(r,n){es.M(r,n);var l=Ao;if(l&&r){var d=Xe(l).hoistableScripts,x=Co(r),b=d.get(x);b||(b=l.querySelector(kc(x)),b||(r=A({src:r,async:!0,type:"module"},n),(n=Un.get(x))&&ap(r,n),b=l.createElement("script"),ct(b),_r(b,"link",r),l.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},d.set(x,b))}}function sx(r,n,l,d){var x=(x=ge.current)?Ed(x):null;if(!x)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(n=_o(l.href),l=Xe(x).hoistableStyles,d=l.get(n),d||(d={type:"style",instance:null,count:0,state:null},l.set(n,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){r=_o(l.href);var b=Xe(x).hoistableStyles,R=b.get(r);if(R||(x=x.ownerDocument||x,R={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(r,R),(b=x.querySelector(Cc(r)))&&!b._p&&(R.instance=b,R.state.loading=5),Un.has(r)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Un.set(r,l),b||s2(x,r,l,R.state))),n&&d===null)throw Error(i(528,""));return R}if(n&&d!==null)throw Error(i(529,""));return null;case"script":return n=l.async,l=l.src,typeof l=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=Co(l),l=Xe(x).hoistableScripts,d=l.get(n),d||(d={type:"script",instance:null,count:0,state:null},l.set(n,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function _o(r){return'href="'+Ra(r)+'"'}function Cc(r){return'link[rel="stylesheet"]['+r+"]"}function lx(r){return A({},r,{"data-precedence":r.precedence,precedence:null})}function s2(r,n,l,d){r.querySelector('link[rel="preload"][as="style"]['+n+"]")?d.loading=1:(n=r.createElement("link"),d.preload=n,n.addEventListener("load",function(){return d.loading|=1}),n.addEventListener("error",function(){return d.loading|=2}),_r(n,"link",l),ct(n),r.head.appendChild(n))}function Co(r){return'[src="'+Ra(r)+'"]'}function kc(r){return"script[async]"+r}function ox(r,n,l){if(n.count++,n.instance===null)switch(n.type){case"style":var d=r.querySelector('style[data-href~="'+Ra(l.href)+'"]');if(d)return n.instance=d,ct(d),d;var x=A({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return d=(r.ownerDocument||r).createElement("style"),ct(d),_r(d,"style",x),Td(d,l.precedence,r),n.instance=d;case"stylesheet":x=_o(l.href);var b=r.querySelector(Cc(x));if(b)return n.state.loading|=4,n.instance=b,ct(b),b;d=lx(l),(x=Un.get(x))&&tp(d,x),b=(r.ownerDocument||r).createElement("link"),ct(b);var R=b;return R._p=new Promise(function(B,re){R.onload=B,R.onerror=re}),_r(b,"link",d),n.state.loading|=4,Td(b,l.precedence,r),n.instance=b;case"script":return b=Co(l.src),(x=r.querySelector(kc(b)))?(n.instance=x,ct(x),x):(d=l,(x=Un.get(b))&&(d=A({},l),ap(d,x)),r=r.ownerDocument||r,x=r.createElement("script"),ct(x),_r(x,"link",d),r.head.appendChild(x),n.instance=x);case"void":return null;default:throw Error(i(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(d=n.instance,n.state.loading|=4,Td(d,l.precedence,r));return n.instance}function Td(r,n,l){for(var d=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=d.length?d[d.length-1]:null,b=x,R=0;R<d.length;R++){var B=d[R];if(B.dataset.precedence===n)b=B;else if(b!==x)break}b?b.parentNode.insertBefore(r,b.nextSibling):(n=l.nodeType===9?l.head:l,n.insertBefore(r,n.firstChild))}function tp(r,n){r.crossOrigin==null&&(r.crossOrigin=n.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=n.referrerPolicy),r.title==null&&(r.title=n.title)}function ap(r,n){r.crossOrigin==null&&(r.crossOrigin=n.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=n.referrerPolicy),r.integrity==null&&(r.integrity=n.integrity)}var Ad=null;function cx(r,n,l){if(Ad===null){var d=new Map,x=Ad=new Map;x.set(l,d)}else x=Ad,d=x.get(l),d||(d=new Map,x.set(l,d));if(d.has(r))return d;for(d.set(r,null),l=l.getElementsByTagName(r),x=0;x<l.length;x++){var b=l[x];if(!(b[Ae]||b[U]||r==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var R=b.getAttribute(n)||"";R=r+R;var B=d.get(R);B?B.push(b):d.set(R,[b])}}return d}function dx(r,n,l){r=r.ownerDocument||r,r.head.insertBefore(l,n==="title"?r.querySelector("head > title"):null)}function l2(r,n,l){if(l===1||n.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;return n.rel==="stylesheet"?(r=n.disabled,typeof n.precedence=="string"&&r==null):!0;case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function fx(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function o2(r,n,l,d){if(l.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var x=_o(d.href),b=n.querySelector(Cc(x));if(b){n=b._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(r.count++,r=_d.bind(r),n.then(r,r)),l.state.loading|=4,l.instance=b,ct(b);return}b=n.ownerDocument||n,d=lx(d),(x=Un.get(x))&&tp(d,x),b=b.createElement("link"),ct(b);var R=b;R._p=new Promise(function(B,re){R.onload=B,R.onerror=re}),_r(b,"link",d),l.instance=b}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(l,n),(n=l.state.preload)&&(l.state.loading&3)===0&&(r.count++,l=_d.bind(r),n.addEventListener("load",l),n.addEventListener("error",l))}}var rp=0;function c2(r,n){return r.stylesheets&&r.count===0&&kd(r,r.stylesheets),0<r.count||0<r.imgCount?function(l){var d=setTimeout(function(){if(r.stylesheets&&kd(r,r.stylesheets),r.unsuspend){var b=r.unsuspend;r.unsuspend=null,b()}},6e4+n);0<r.imgBytes&&rp===0&&(rp=62500*$b());var x=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&kd(r,r.stylesheets),r.unsuspend)){var b=r.unsuspend;r.unsuspend=null,b()}},(r.imgBytes>rp?50:800)+n);return r.unsuspend=l,function(){r.unsuspend=null,clearTimeout(d),clearTimeout(x)}}:null}function _d(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)kd(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Cd=null;function kd(r,n){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Cd=new Map,n.forEach(d2,r),Cd=null,_d.call(r))}function d2(r,n){if(!(n.state.loading&4)){var l=Cd.get(r);if(l)var d=l.get(null);else{l=new Map,Cd.set(r,l);for(var x=r.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<x.length;b++){var R=x[b];(R.nodeName==="LINK"||R.getAttribute("media")!=="not all")&&(l.set(R.dataset.precedence,R),d=R)}d&&l.set(null,d)}x=n.instance,R=x.getAttribute("data-precedence"),b=l.get(R)||d,b===d&&l.set(null,x),l.set(R,x),this.count++,d=_d.bind(this),x.addEventListener("load",d),x.addEventListener("error",d),b?b.parentNode.insertBefore(x,b.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(x,r.firstChild)),n.state.loading|=4}}var wc={$$typeof:M,Provider:null,Consumer:null,_currentValue:Je,_currentValue2:Je,_threadCount:0};function f2(r,n,l,d,x,b,R,B,re){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Xt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xt(0),this.hiddenUpdates=Xt(null),this.identifierPrefix=d,this.onUncaughtError=x,this.onCaughtError=b,this.onRecoverableError=R,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=re,this.incompleteTransitions=new Map}function ux(r,n,l,d,x,b,R,B,re,be,Fe,Le){return r=new f2(r,n,l,R,re,be,Fe,Le,B),n=1,b===!0&&(n|=24),b=v(3,null,null,n),r.current=b,b.stateNode=r,n=Bf(),n.refCount++,r.pooledCache=n,n.refCount++,b.memoizedState={element:d,isDehydrated:l,cache:n},zf(b),r}function px(r){return r?(r=u,r):u}function hx(r,n,l,d,x,b){x=px(x),d.context===null?d.context=x:d.pendingContext=x,d=Ns(n),d.payload={element:l},b=b===void 0?null:b,b!==null&&(d.callback=b),l=Fs(r,d,n),l!==null&&(on(l,r,n),sc(l,r,n))}function gx(r,n){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var l=r.retryLane;r.retryLane=l!==0&&l<n?l:n}}function np(r,n){gx(r,n),(r=r.alternate)&&gx(r,n)}function xx(r){if(r.tag===13||r.tag===31){var n=mn(r,67108864);n!==null&&on(n,r,67108864),np(r,67108864)}}function mx(r){if(r.tag===13||r.tag===31){var n=Tn();n=jn(n);var l=mn(r,n);l!==null&&on(l,r,n),np(r,n)}}var wd=!0;function u2(r,n,l,d){var x=de.T;de.T=null;var b=Ce.p;try{Ce.p=2,ip(r,n,l,d)}finally{Ce.p=b,de.T=x}}function p2(r,n,l,d){var x=de.T;de.T=null;var b=Ce.p;try{Ce.p=8,ip(r,n,l,d)}finally{Ce.p=b,de.T=x}}function ip(r,n,l,d){if(wd){var x=sp(d);if(x===null)Gu(r,n,d,Rd,l),vx(r,d);else if(g2(x,r,n,l,d))d.stopPropagation();else if(vx(r,d),n&4&&-1<h2.indexOf(r)){for(;x!==null;){var b=Ze(x);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var R=Jr(b.pendingLanes);if(R!==0){var B=b;for(B.pendingLanes|=2,B.entangledLanes|=2;R;){var re=1<<31-Zt(R);B.entanglements[1]|=re,R&=~re}Ci(b),(na&6)===0&&(fd=Wt()+500,Ec(0))}}break;case 31:case 13:B=mn(b,2),B!==null&&on(B,b,2),pd(),np(b,2)}if(b=sp(d),b===null&&Gu(r,n,d,Rd,l),b===x)break;x=b}x!==null&&d.stopPropagation()}else Gu(r,n,d,null,l)}}function sp(r){return r=hs(r),lp(r)}var Rd=null;function lp(r){if(Rd=null,r=Ye(r),r!==null){var n=c(r);if(n===null)r=null;else{var l=n.tag;if(l===13){if(r=f(n),r!==null)return r;r=null}else if(l===31){if(r=p(n),r!==null)return r;r=null}else if(l===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;r=null}else n!==r&&(r=null)}}return Rd=r,null}function yx(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(br()){case Sr:return 2;case Qr:return 8;case Ea:case Dt:return 32;case yt:return 268435456;default:return 32}default:return 32}}var op=!1,Hs=null,$s=null,Ys=null,Rc=new Map,Nc=new Map,Gs=[],h2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vx(r,n){switch(r){case"focusin":case"focusout":Hs=null;break;case"dragenter":case"dragleave":$s=null;break;case"mouseover":case"mouseout":Ys=null;break;case"pointerover":case"pointerout":Rc.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nc.delete(n.pointerId)}}function Fc(r,n,l,d,x,b){return r===null||r.nativeEvent!==b?(r={blockedOn:n,domEventName:l,eventSystemFlags:d,nativeEvent:b,targetContainers:[x]},n!==null&&(n=Ze(n),n!==null&&xx(n)),r):(r.eventSystemFlags|=d,n=r.targetContainers,x!==null&&n.indexOf(x)===-1&&n.push(x),r)}function g2(r,n,l,d,x){switch(n){case"focusin":return Hs=Fc(Hs,r,n,l,d,x),!0;case"dragenter":return $s=Fc($s,r,n,l,d,x),!0;case"mouseover":return Ys=Fc(Ys,r,n,l,d,x),!0;case"pointerover":var b=x.pointerId;return Rc.set(b,Fc(Rc.get(b)||null,r,n,l,d,x)),!0;case"gotpointercapture":return b=x.pointerId,Nc.set(b,Fc(Nc.get(b)||null,r,n,l,d,x)),!0}return!1}function bx(r){var n=Ye(r.target);if(n!==null){var l=c(n);if(l!==null){if(n=l.tag,n===13){if(n=f(l),n!==null){r.blockedOn=n,q(r.priority,function(){mx(l)});return}}else if(n===31){if(n=p(l),n!==null){r.blockedOn=n,q(r.priority,function(){mx(l)});return}}else if(n===3&&l.stateNode.current.memoizedState.isDehydrated){r.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Nd(r){if(r.blockedOn!==null)return!1;for(var n=r.targetContainers;0<n.length;){var l=sp(r.nativeEvent);if(l===null){l=r.nativeEvent;var d=new l.constructor(l.type,l);ps=d,l.target.dispatchEvent(d),ps=null}else return n=Ze(l),n!==null&&xx(n),r.blockedOn=l,!1;n.shift()}return!0}function Sx(r,n,l){Nd(r)&&l.delete(n)}function x2(){op=!1,Hs!==null&&Nd(Hs)&&(Hs=null),$s!==null&&Nd($s)&&($s=null),Ys!==null&&Nd(Ys)&&(Ys=null),Rc.forEach(Sx),Nc.forEach(Sx)}function Fd(r,n){r.blockedOn===n&&(r.blockedOn=null,op||(op=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,x2)))}var Dd=null;function Ex(r){Dd!==r&&(Dd=r,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Dd===r&&(Dd=null);for(var n=0;n<r.length;n+=3){var l=r[n],d=r[n+1],x=r[n+2];if(typeof d!="function"){if(lp(d||l)===null)continue;break}var b=Ze(l);b!==null&&(r.splice(n,3),n-=3,su(b,{pending:!0,data:x,method:l.method,action:d},d,x))}}))}function ko(r){function n(re){return Fd(re,r)}Hs!==null&&Fd(Hs,r),$s!==null&&Fd($s,r),Ys!==null&&Fd(Ys,r),Rc.forEach(n),Nc.forEach(n);for(var l=0;l<Gs.length;l++){var d=Gs[l];d.blockedOn===r&&(d.blockedOn=null)}for(;0<Gs.length&&(l=Gs[0],l.blockedOn===null);)bx(l),l.blockedOn===null&&Gs.shift();if(l=(r.ownerDocument||r).$$reactFormReplay,l!=null)for(d=0;d<l.length;d+=3){var x=l[d],b=l[d+1],R=x[Y]||null;if(typeof b=="function")R||Ex(l);else if(R){var B=null;if(b&&b.hasAttribute("formAction")){if(x=b,R=b[Y]||null)B=R.formAction;else if(lp(x)!==null)continue}else B=R.action;typeof B=="function"?l[d+1]=B:(l.splice(d,3),d-=3),Ex(l)}}}function Tx(){function r(b){b.canIntercept&&b.info==="react-transition"&&b.intercept({handler:function(){return new Promise(function(R){return x=R})},focusReset:"manual",scroll:"manual"})}function n(){x!==null&&(x(),x=null),d||setTimeout(l,20)}function l(){if(!d&&!navigation.transition){var b=navigation.currentEntry;b&&b.url!=null&&navigation.navigate(b.url,{state:b.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,x=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(l,100),function(){d=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),x!==null&&(x(),x=null)}}}function cp(r){this._internalRoot=r}jd.prototype.render=cp.prototype.render=function(r){var n=this._internalRoot;if(n===null)throw Error(i(409));var l=n.current,d=Tn();hx(l,d,r,n,null,null)},jd.prototype.unmount=cp.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var n=r.containerInfo;hx(r.current,2,null,r,null,null),pd(),n[J]=null}};function jd(r){this._internalRoot=r}jd.prototype.unstable_scheduleHydration=function(r){if(r){var n=j();r={blockedOn:null,target:r,priority:n};for(var l=0;l<Gs.length&&n!==0&&n<Gs[l].priority;l++);Gs.splice(l,0,r),l===0&&bx(r)}};var Ax=a.version;if(Ax!=="19.2.3")throw Error(i(527,Ax,"19.2.3"));Ce.findDOMNode=function(r){var n=r._reactInternals;if(n===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=h(n),r=r!==null?E(r):null,r=r===null?null:r.stateNode,r};var m2={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:de,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Od=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Od.isDisabled&&Od.supportsFiber)try{ia=Od.inject(m2),Ot=Od}catch{}}return jc.createRoot=function(r,n){if(!s(r))throw Error(i(299));var l=!1,d="",x=Fg,b=Dg,R=jg;return n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(d=n.identifierPrefix),n.onUncaughtError!==void 0&&(x=n.onUncaughtError),n.onCaughtError!==void 0&&(b=n.onCaughtError),n.onRecoverableError!==void 0&&(R=n.onRecoverableError)),n=ux(r,1,!1,null,null,l,d,null,x,b,R,Tx),r[J]=n.current,Yu(r),new cp(n)},jc.hydrateRoot=function(r,n,l){if(!s(r))throw Error(i(299));var d=!1,x="",b=Fg,R=Dg,B=jg,re=null;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(x=l.identifierPrefix),l.onUncaughtError!==void 0&&(b=l.onUncaughtError),l.onCaughtError!==void 0&&(R=l.onCaughtError),l.onRecoverableError!==void 0&&(B=l.onRecoverableError),l.formState!==void 0&&(re=l.formState)),n=ux(r,1,!0,n,l??null,d,x,re,b,R,B,Tx),n.context=px(null),l=n.current,d=Tn(),d=jn(d),x=Ns(d),x.callback=null,Fs(l,x,d),l=d,n.current.lanes=l,vi(n,l),Ci(n),r[J]=n.current,Yu(r),new jd(n)},jc.version="19.2.3",jc}var Ox;function w2(){if(Ox)return pp.exports;Ox=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(a){console.error(a)}}return e(),pp.exports=k2(),pp.exports}var R2=w2();var Wd={};Wd.version="0.18.5";var Vm=1252,N2=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Yp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Gp=function(e){N2.indexOf(e)!=-1&&(Vm=Yp[0]=e)};function F2(){Gp(1252)}var hi=function(e){Gp(e)};function Wp(){hi(1200),F2()}function Ix(e){for(var a=[],t=0,i=e.length;t<i;++t)a[t]=e.charCodeAt(t);return a}function D2(e){for(var a=[],t=0;t<e.length>>1;++t)a[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return a.join("")}function Xm(e){for(var a=[],t=0;t<e.length>>1;++t)a[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return a.join("")}var Ic=function(e){var a=e.charCodeAt(0),t=e.charCodeAt(1);return a==255&&t==254?D2(e.slice(2)):a==254&&t==255?Xm(e.slice(2)):a==65279?e.slice(1):e},Id=function(a){return String.fromCharCode(a)},Bx=function(a){return String.fromCharCode(a)},Wc,Xs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Vc(e){for(var a="",t=0,i=0,s=0,c=0,f=0,p=0,g=0,h=0;h<e.length;)t=e.charCodeAt(h++),c=t>>2,i=e.charCodeAt(h++),f=(t&3)<<4|i>>4,s=e.charCodeAt(h++),p=(i&15)<<2|s>>6,g=s&63,isNaN(i)?p=g=64:isNaN(s)&&(g=64),a+=Xs.charAt(c)+Xs.charAt(f)+Xs.charAt(p)+Xs.charAt(g);return a}function wn(e){var a="",t=0,i=0,s=0,c=0,f=0,p=0,g=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)c=Xs.indexOf(e.charAt(h++)),f=Xs.indexOf(e.charAt(h++)),t=c<<2|f>>4,a+=String.fromCharCode(t),p=Xs.indexOf(e.charAt(h++)),i=(f&15)<<4|p>>2,p!==64&&(a+=String.fromCharCode(i)),g=Xs.indexOf(e.charAt(h++)),s=(p&3)<<6|g,g!==64&&(a+=String.fromCharCode(s));return a}var It=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ss=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(a,t){return t?new Buffer(a,t):new Buffer(a)}:Buffer.from.bind(Buffer)}return function(){}})();function Ks(e){return It?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Mx(e){return It?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Cn=function(a){return It?ss(a,"binary"):a.split("").map(function(t){return t.charCodeAt(0)&255})};function lf(e){if(typeof ArrayBuffer>"u")return Cn(e);for(var a=new ArrayBuffer(e.length),t=new Uint8Array(a),i=0;i!=e.length;++i)t[i]=e.charCodeAt(i)&255;return a}function el(e){if(Array.isArray(e))return e.map(function(i){return String.fromCharCode(i)}).join("");for(var a=[],t=0;t<e.length;++t)a[t]=String.fromCharCode(e[t]);return a.join("")}function j2(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Vp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Vp(new Uint8Array(e));for(var a=new Array(e.length),t=0;t<e.length;++t)a[t]=e[t];return a}var yr=It?function(e){return Buffer.concat(e.map(function(a){return Buffer.isBuffer(a)?a:ss(a)}))}:function(e){if(typeof Uint8Array<"u"){var a=0,t=0;for(a=0;a<e.length;++a)t+=e[a].length;var i=new Uint8Array(t),s=0;for(a=0,t=0;a<e.length;t+=s,++a)if(s=e[a].length,e[a]instanceof Uint8Array)i.set(e[a],t);else{if(typeof e[a]=="string")throw"wtf";i.set(new Uint8Array(e[a]),t)}return i}return[].concat.apply([],e.map(function(c){return Array.isArray(c)?c:[].slice.call(c)}))};function O2(e){for(var a=[],t=0,i=e.length+250,s=Ks(e.length+255),c=0;c<e.length;++c){var f=e.charCodeAt(c);if(f<128)s[t++]=f;else if(f<2048)s[t++]=192|f>>6&31,s[t++]=128|f&63;else if(f>=55296&&f<57344){f=(f&1023)+64;var p=e.charCodeAt(++c)&1023;s[t++]=240|f>>8&7,s[t++]=128|f>>2&63,s[t++]=128|p>>6&15|(f&3)<<4,s[t++]=128|p&63}else s[t++]=224|f>>12&15,s[t++]=128|f>>6&63,s[t++]=128|f&63;t>i&&(a.push(s.slice(0,t)),t=0,s=Ks(65535),i=65530)}return a.push(s.slice(0,t)),yr(a)}var Kr=/\u0000/g,Bc=/[\u0001-\u0006]/g;function jo(e){for(var a="",t=e.length-1;t>=0;)a+=e.charAt(t--);return a}function gi(e,a){var t=""+e;return t.length>=a?t:Pa("0",a-t.length)+t}function Xp(e,a){var t=""+e;return t.length>=a?t:Pa(" ",a-t.length)+t}function Vd(e,a){var t=""+e;return t.length>=a?t:t+Pa(" ",a-t.length)}function I2(e,a){var t=""+Math.round(e);return t.length>=a?t:Pa("0",a-t.length)+t}function B2(e,a){var t=""+e;return t.length>=a?t:Pa("0",a-t.length)+t}var Lx=Math.pow(2,32);function wo(e,a){if(e>Lx||e<-Lx)return I2(e,a);var t=Math.round(e);return B2(t,a)}function Xd(e,a){return a=a||0,e.length>=7+a&&(e.charCodeAt(a)|32)===103&&(e.charCodeAt(a+1)|32)===101&&(e.charCodeAt(a+2)|32)===110&&(e.charCodeAt(a+3)|32)===101&&(e.charCodeAt(a+4)|32)===114&&(e.charCodeAt(a+5)|32)===97&&(e.charCodeAt(a+6)|32)===108}var Px=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],mp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function M2(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var mt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},zx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},L2={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function qd(e,a,t){for(var i=e<0?-1:1,s=e*i,c=0,f=1,p=0,g=1,h=0,E=0,A=Math.floor(s);h<a&&(A=Math.floor(s),p=A*f+c,E=A*h+g,!(s-A<5e-8));)s=1/(s-A),c=f,f=p,g=h,h=E;if(E>a&&(h>a?(E=g,p=c):(E=h,p=f)),!t)return[0,i*p,E];var _=Math.floor(i*p/E);return[_,i*p-_*E,E]}function jl(e,a,t){if(e>2958465||e<0)return null;var i=e|0,s=Math.floor(86400*(e-i)),c=0,f=[],p={D:i,T:s,u:86400*(e-i)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(p.u)<1e-6&&(p.u=0),a&&a.date1904&&(i+=1462),p.u>.9999&&(p.u=0,++s==86400&&(p.T=s=0,++i,++p.D)),i===60)f=t?[1317,10,29]:[1900,2,29],c=3;else if(i===0)f=t?[1317,8,29]:[1900,1,0],c=6;else{i>60&&--i;var g=new Date(1900,0,1);g.setDate(g.getDate()+i-1),f=[g.getFullYear(),g.getMonth()+1,g.getDate()],c=g.getDay(),i<60&&(c=(c+6)%7),t&&(c=Y2(g,f))}return p.y=f[0],p.m=f[1],p.d=f[2],p.S=s%60,s=Math.floor(s/60),p.M=s%60,s=Math.floor(s/60),p.H=s,p.q=c,p}var qm=new Date(1899,11,31,0,0,0),P2=qm.getTime(),z2=new Date(1900,2,1,0,0,0);function Km(e,a){var t=e.getTime();return a?t-=1461*24*60*60*1e3:e>=z2&&(t+=1440*60*1e3),(t-(P2+(e.getTimezoneOffset()-qm.getTimezoneOffset())*6e4))/(1440*60*1e3)}function qp(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function U2(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function H2(e){var a=e<0?12:11,t=qp(e.toFixed(12));return t.length<=a||(t=e.toPrecision(10),t.length<=a)?t:e.toExponential(5)}function $2(e){var a=qp(e.toFixed(11));return a.length>(e<0?12:11)||a==="0"||a==="-0"?e.toPrecision(6):a}function Xc(e){var a=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return a>=-4&&a<=-1?t=e.toPrecision(10+a):Math.abs(a)<=9?t=H2(e):a===10?t=e.toFixed(10).substr(0,12):t=$2(e),qp(U2(t.toUpperCase()))}function Ll(e,a){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Xc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return qn(14,Km(e,a&&a.date1904),a)}throw new Error("unsupported value in General format: "+e)}function Y2(e,a){a[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function G2(e,a,t,i){var s="",c=0,f=0,p=t.y,g,h=0;switch(e){case 98:p=t.y+543;case 121:switch(a.length){case 1:case 2:g=p%100,h=2;break;default:g=p%1e4,h=4;break}break;case 109:switch(a.length){case 1:case 2:g=t.m,h=a.length;break;case 3:return mp[t.m-1][1];case 5:return mp[t.m-1][0];default:return mp[t.m-1][2]}break;case 100:switch(a.length){case 1:case 2:g=t.d,h=a.length;break;case 3:return Px[t.q][0];default:return Px[t.q][1]}break;case 104:switch(a.length){case 1:case 2:g=1+(t.H+11)%12,h=a.length;break;default:throw"bad hour format: "+a}break;case 72:switch(a.length){case 1:case 2:g=t.H,h=a.length;break;default:throw"bad hour format: "+a}break;case 77:switch(a.length){case 1:case 2:g=t.M,h=a.length;break;default:throw"bad minute format: "+a}break;case 115:if(a!="s"&&a!="ss"&&a!=".0"&&a!=".00"&&a!=".000")throw"bad second format: "+a;return t.u===0&&(a=="s"||a=="ss")?gi(t.S,a.length):(i>=2?f=i===3?1e3:100:f=i===1?10:1,c=Math.round(f*(t.S+t.u)),c>=60*f&&(c=0),a==="s"?c===0?"0":""+c/f:(s=gi(c,2+i),a==="ss"?s.substr(0,2):"."+s.substr(2,a.length-1)));case 90:switch(a){case"[h]":case"[hh]":g=t.D*24+t.H;break;case"[m]":case"[mm]":g=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":g=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+a}h=a.length===3?1:2;break;case 101:g=p,h=1;break}var E=h>0?gi(g,h):"";return E}function qs(e){var a=3;if(e.length<=a)return e;for(var t=e.length%a,i=e.substr(0,t);t!=e.length;t+=a)i+=(i.length>0?",":"")+e.substr(t,a);return i}var Qm=/%/g;function W2(e,a,t){var i=a.replace(Qm,""),s=a.length-i.length;return as(e,i,t*Math.pow(10,2*s))+Pa("%",s)}function V2(e,a,t){for(var i=a.length-1;a.charCodeAt(i-1)===44;)--i;return as(e,a.substr(0,i),t/Math.pow(10,3*(a.length-i)))}function Jm(e,a){var t,i=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(a==0)return"0.0E+0";if(a<0)return"-"+Jm(e,-a);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var c=Math.floor(Math.log(a)*Math.LOG10E)%s;if(c<0&&(c+=s),t=(a/Math.pow(10,c)).toPrecision(i+1+(s+c)%s),t.indexOf("e")===-1){var f=Math.floor(Math.log(a)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(f-t.length+c):t+="E+"+(f-c);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,s)+"."+t.substr(2+s),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(p,g,h,E){return g+h+E.substr(0,(s+c)%s)+"."+E.substr(c)+"E"})}else t=a.toExponential(i);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Zm=/# (\?+)( ?)\/( ?)(\d+)/;function X2(e,a,t){var i=parseInt(e[4],10),s=Math.round(a*i),c=Math.floor(s/i),f=s-c*i,p=i;return t+(c===0?"":""+c)+" "+(f===0?Pa(" ",e[1].length+1+e[4].length):Xp(f,e[1].length)+e[2]+"/"+e[3]+gi(p,e[4].length))}function q2(e,a,t){return t+(a===0?"":""+a)+Pa(" ",e[1].length+2+e[4].length)}var ey=/^#*0*\.([0#]+)/,ty=/\).*[0#]/,ay=/\(###\) ###\\?-####/;function Xr(e){for(var a="",t,i=0;i!=e.length;++i)switch(t=e.charCodeAt(i)){case 35:break;case 63:a+=" ";break;case 48:a+="0";break;default:a+=String.fromCharCode(t)}return a}function Ux(e,a){var t=Math.pow(10,a);return""+Math.round(e*t)/t}function Hx(e,a){var t=e-Math.floor(e),i=Math.pow(10,a);return a<(""+Math.round(t*i)).length?0:Math.round(t*i)}function K2(e,a){return a<(""+Math.round((e-Math.floor(e))*Math.pow(10,a))).length?1:0}function Q2(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function $n(e,a,t){if(e.charCodeAt(0)===40&&!a.match(ty)){var i=a.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?$n("n",i,t):"("+$n("n",i,-t)+")"}if(a.charCodeAt(a.length-1)===44)return V2(e,a,t);if(a.indexOf("%")!==-1)return W2(e,a,t);if(a.indexOf("E")!==-1)return Jm(a,t);if(a.charCodeAt(0)===36)return"$"+$n(e,a.substr(a.charAt(1)==" "?2:1),t);var s,c,f,p,g=Math.abs(t),h=t<0?"-":"";if(a.match(/^00+$/))return h+wo(g,a.length);if(a.match(/^[#?]+$/))return s=wo(t,0),s==="0"&&(s=""),s.length>a.length?s:Xr(a.substr(0,a.length-s.length))+s;if(c=a.match(Zm))return X2(c,g,h);if(a.match(/^#+0+$/))return h+wo(g,a.length-a.indexOf("0"));if(c=a.match(ey))return s=Ux(t,c[1].length).replace(/^([^\.]+)$/,"$1."+Xr(c[1])).replace(/\.$/,"."+Xr(c[1])).replace(/\.(\d*)$/,function(N,k){return"."+k+Pa("0",Xr(c[1]).length-k.length)}),a.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(a=a.replace(/^#+([0.])/,"$1"),c=a.match(/^(0*)\.(#*)$/))return h+Ux(g,c[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=a.match(/^#{1,3},##0(\.?)$/))return h+qs(wo(g,0));if(c=a.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+$n(e,a,-t):qs(""+(Math.floor(t)+K2(t,c[1].length)))+"."+gi(Hx(t,c[1].length),c[1].length);if(c=a.match(/^#,#*,#0/))return $n(e,a.replace(/^#,#*,/,""),t);if(c=a.match(/^([0#]+)(\\?-([0#]+))+$/))return s=jo($n(e,a.replace(/[\\-]/g,""),t)),f=0,jo(jo(a.replace(/\\/g,"")).replace(/[0#]/g,function(N){return f<s.length?s.charAt(f++):N==="0"?"0":""}));if(a.match(ay))return s=$n(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var E="";if(c=a.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(c[4].length,7),p=qd(g,Math.pow(10,f)-1,!1),s=""+h,E=as("n",c[1],p[1]),E.charAt(E.length-1)==" "&&(E=E.substr(0,E.length-1)+"0"),s+=E+c[2]+"/"+c[3],E=Vd(p[2],f),E.length<c[4].length&&(E=Xr(c[4].substr(c[4].length-E.length))+E),s+=E,s;if(c=a.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(Math.max(c[1].length,c[4].length),7),p=qd(g,Math.pow(10,f)-1,!0),h+(p[0]||(p[1]?"":"0"))+" "+(p[1]?Xp(p[1],f)+c[2]+"/"+c[3]+Vd(p[2],f):Pa(" ",2*f+1+c[2].length+c[3].length));if(c=a.match(/^[#0?]+$/))return s=wo(t,0),a.length<=s.length?s:Xr(a.substr(0,a.length-s.length))+s;if(c=a.match(/^([#0?]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),f=s.indexOf(".");var A=a.indexOf(".")-f,_=a.length-s.length-A;return Xr(a.substr(0,A)+s+a.substr(a.length-_))}if(c=a.match(/^00,000\.([#0]*0)$/))return f=Hx(t,c[1].length),t<0?"-"+$n(e,a,-t):qs(Q2(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(N){return"00,"+(N.length<3?gi(0,3-N.length):"")+N})+"."+gi(f,c[1].length);switch(a){case"###,##0.00":return $n(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var w=qs(wo(g,0));return w!=="0"?h+w:"";case"###,###.00":return $n(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return $n(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+a+"|")}function J2(e,a,t){for(var i=a.length-1;a.charCodeAt(i-1)===44;)--i;return as(e,a.substr(0,i),t/Math.pow(10,3*(a.length-i)))}function Z2(e,a,t){var i=a.replace(Qm,""),s=a.length-i.length;return as(e,i,t*Math.pow(10,2*s))+Pa("%",s)}function ry(e,a){var t,i=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(a==0)return"0.0E+0";if(a<0)return"-"+ry(e,-a);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var c=Math.floor(Math.log(a)*Math.LOG10E)%s;if(c<0&&(c+=s),t=(a/Math.pow(10,c)).toPrecision(i+1+(s+c)%s),!t.match(/[Ee]/)){var f=Math.floor(Math.log(a)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(f-t.length+c):t+="E+"+(f-c),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(p,g,h,E){return g+h+E.substr(0,(s+c)%s)+"."+E.substr(c)+"E"})}else t=a.toExponential(i);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function wi(e,a,t){if(e.charCodeAt(0)===40&&!a.match(ty)){var i=a.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?wi("n",i,t):"("+wi("n",i,-t)+")"}if(a.charCodeAt(a.length-1)===44)return J2(e,a,t);if(a.indexOf("%")!==-1)return Z2(e,a,t);if(a.indexOf("E")!==-1)return ry(a,t);if(a.charCodeAt(0)===36)return"$"+wi(e,a.substr(a.charAt(1)==" "?2:1),t);var s,c,f,p,g=Math.abs(t),h=t<0?"-":"";if(a.match(/^00+$/))return h+gi(g,a.length);if(a.match(/^[#?]+$/))return s=""+t,t===0&&(s=""),s.length>a.length?s:Xr(a.substr(0,a.length-s.length))+s;if(c=a.match(Zm))return q2(c,g,h);if(a.match(/^#+0+$/))return h+gi(g,a.length-a.indexOf("0"));if(c=a.match(ey))return s=(""+t).replace(/^([^\.]+)$/,"$1."+Xr(c[1])).replace(/\.$/,"."+Xr(c[1])),s=s.replace(/\.(\d*)$/,function(N,k){return"."+k+Pa("0",Xr(c[1]).length-k.length)}),a.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(a=a.replace(/^#+([0.])/,"$1"),c=a.match(/^(0*)\.(#*)$/))return h+(""+g).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=a.match(/^#{1,3},##0(\.?)$/))return h+qs(""+g);if(c=a.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+wi(e,a,-t):qs(""+t)+"."+Pa("0",c[1].length);if(c=a.match(/^#,#*,#0/))return wi(e,a.replace(/^#,#*,/,""),t);if(c=a.match(/^([0#]+)(\\?-([0#]+))+$/))return s=jo(wi(e,a.replace(/[\\-]/g,""),t)),f=0,jo(jo(a.replace(/\\/g,"")).replace(/[0#]/g,function(N){return f<s.length?s.charAt(f++):N==="0"?"0":""}));if(a.match(ay))return s=wi(e,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var E="";if(c=a.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(c[4].length,7),p=qd(g,Math.pow(10,f)-1,!1),s=""+h,E=as("n",c[1],p[1]),E.charAt(E.length-1)==" "&&(E=E.substr(0,E.length-1)+"0"),s+=E+c[2]+"/"+c[3],E=Vd(p[2],f),E.length<c[4].length&&(E=Xr(c[4].substr(c[4].length-E.length))+E),s+=E,s;if(c=a.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return f=Math.min(Math.max(c[1].length,c[4].length),7),p=qd(g,Math.pow(10,f)-1,!0),h+(p[0]||(p[1]?"":"0"))+" "+(p[1]?Xp(p[1],f)+c[2]+"/"+c[3]+Vd(p[2],f):Pa(" ",2*f+1+c[2].length+c[3].length));if(c=a.match(/^[#0?]+$/))return s=""+t,a.length<=s.length?s:Xr(a.substr(0,a.length-s.length))+s;if(c=a.match(/^([#0]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),f=s.indexOf(".");var A=a.indexOf(".")-f,_=a.length-s.length-A;return Xr(a.substr(0,A)+s+a.substr(a.length-_))}if(c=a.match(/^00,000\.([#0]*0)$/))return t<0?"-"+wi(e,a,-t):qs(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(N){return"00,"+(N.length<3?gi(0,3-N.length):"")+N})+"."+gi(0,c[1].length);switch(a){case"###,###":case"##,###":case"#,###":var w=qs(""+g);return w!=="0"?h+w:"";default:if(a.match(/\.[0#?]*$/))return wi(e,a.slice(0,a.lastIndexOf(".")),t)+Xr(a.slice(a.lastIndexOf(".")))}throw new Error("unsupported format |"+a+"|")}function as(e,a,t){return(t|0)===t?wi(e,a,t):$n(e,a,t)}function eS(e){for(var a=[],t=!1,i=0,s=0;i<e.length;++i)switch(e.charCodeAt(i)){case 34:t=!t;break;case 95:case 42:case 92:++i;break;case 59:a[a.length]=e.substr(s,i-s),s=i+1}if(a[a.length]=e.substr(s),t===!0)throw new Error("Format |"+e+"| unterminated string ");return a}var ny=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function zo(e){for(var a=0,t="",i="";a<e.length;)switch(t=e.charAt(a)){case"G":Xd(e,a)&&(a+=6),a++;break;case'"':for(;e.charCodeAt(++a)!==34&&a<e.length;);++a;break;case"\\":a+=2;break;case"_":a+=2;break;case"@":++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(a,3).toUpperCase()==="A/P"||e.substr(a,5).toUpperCase()==="AM/PM"||e.substr(a,5).toUpperCase()==="/")return!0;++a;break;case"[":for(i=t;e.charAt(a++)!=="]"&&a<e.length;)i+=e.charAt(a);if(i.match(ny))return!0;break;case".":case"0":case"#":for(;a<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++a))>-1||t=="\\"&&e.charAt(a+1)=="-"&&"0#".indexOf(e.charAt(a+2))>-1););break;case"?":for(;e.charAt(++a)===t;);break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;);break;case" ":++a;break;default:++a;break}return!1}function tS(e,a,t,i){for(var s=[],c="",f=0,p="",g="t",h,E,A,_="H";f<e.length;)switch(p=e.charAt(f)){case"G":if(!Xd(e,f))throw new Error("unrecognized character "+p+" in "+e);s[s.length]={t:"G",v:"General"},f+=7;break;case'"':for(c="";(A=e.charCodeAt(++f))!==34&&f<e.length;)c+=String.fromCharCode(A);s[s.length]={t:"t",v:c},++f;break;case"\\":var w=e.charAt(++f),N=w==="("||w===")"?w:"t";s[s.length]={t:N,v:w},++f;break;case"_":s[s.length]={t:"t",v:" "},f+=2;break;case"@":s[s.length]={t:"T",v:a},++f;break;case"B":case"b":if(e.charAt(f+1)==="1"||e.charAt(f+1)==="2"){if(h==null&&(h=jl(a,t,e.charAt(f+1)==="2"),h==null))return"";s[s.length]={t:"X",v:e.substr(f,2)},g=p,f+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":p=p.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(a<0||h==null&&(h=jl(a,t),h==null))return"";for(c=p;++f<e.length&&e.charAt(f).toLowerCase()===p;)c+=p;p==="m"&&g.toLowerCase()==="h"&&(p="M"),p==="h"&&(p=_),s[s.length]={t:p,v:c},g=p;break;case"A":case"a":case"":var k={t:p,v:p};if(h==null&&(h=jl(a,t)),e.substr(f,3).toUpperCase()==="A/P"?(h!=null&&(k.v=h.H>=12?"P":"A"),k.t="T",_="h",f+=3):e.substr(f,5).toUpperCase()==="AM/PM"?(h!=null&&(k.v=h.H>=12?"PM":"AM"),k.t="T",f+=5,_="h"):e.substr(f,5).toUpperCase()==="/"?(h!=null&&(k.v=h.H>=12?"":""),k.t="T",f+=5,_="h"):(k.t="t",++f),h==null&&k.t==="T")return"";s[s.length]=k,g=p;break;case"[":for(c=p;e.charAt(f++)!=="]"&&f<e.length;)c+=e.charAt(f);if(c.slice(-1)!=="]")throw'unterminated "[" block: |'+c+"|";if(c.match(ny)){if(h==null&&(h=jl(a,t),h==null))return"";s[s.length]={t:"Z",v:c.toLowerCase()},g=c.charAt(1)}else c.indexOf("$")>-1&&(c=(c.match(/\$([^-\[\]]*)/)||[])[1]||"$",zo(e)||(s[s.length]={t:"t",v:c}));break;case".":if(h!=null){for(c=p;++f<e.length&&(p=e.charAt(f))==="0";)c+=p;s[s.length]={t:"s",v:c};break}case"0":case"#":for(c=p;++f<e.length&&"0#?.,E+-%".indexOf(p=e.charAt(f))>-1;)c+=p;s[s.length]={t:"n",v:c};break;case"?":for(c=p;e.charAt(++f)===p;)c+=p;s[s.length]={t:p,v:c},g=p;break;case"*":++f,(e.charAt(f)==" "||e.charAt(f)=="*")&&++f;break;case"(":case")":s[s.length]={t:i===1?"t":p,v:p},++f;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(c=p;f<e.length&&"0123456789".indexOf(e.charAt(++f))>-1;)c+=e.charAt(f);s[s.length]={t:"D",v:c};break;case" ":s[s.length]={t:p,v:p},++f;break;case"$":s[s.length]={t:"t",v:"$"},++f;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(p)===-1)throw new Error("unrecognized character "+p+" in "+e);s[s.length]={t:"t",v:p},++f;break}var F=0,z=0,K;for(f=s.length-1,g="t";f>=0;--f)switch(s[f].t){case"h":case"H":s[f].t=_,g="h",F<1&&(F=1);break;case"s":(K=s[f].v.match(/\.0+$/))&&(z=Math.max(z,K[0].length-1)),F<3&&(F=3);case"d":case"y":case"M":case"e":g=s[f].t;break;case"m":g==="s"&&(s[f].t="M",F<2&&(F=2));break;case"X":break;case"Z":F<1&&s[f].v.match(/[Hh]/)&&(F=1),F<2&&s[f].v.match(/[Mm]/)&&(F=2),F<3&&s[f].v.match(/[Ss]/)&&(F=3)}switch(F){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var M="",ie;for(f=0;f<s.length;++f)switch(s[f].t){case"t":case"T":case" ":case"D":break;case"X":s[f].v="",s[f].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[f].v=G2(s[f].t.charCodeAt(0),s[f].v,h,z),s[f].t="t";break;case"n":case"?":for(ie=f+1;s[ie]!=null&&((p=s[ie].t)==="?"||p==="D"||(p===" "||p==="t")&&s[ie+1]!=null&&(s[ie+1].t==="?"||s[ie+1].t==="t"&&s[ie+1].v==="/")||s[f].t==="("&&(p===" "||p==="n"||p===")")||p==="t"&&(s[ie].v==="/"||s[ie].v===" "&&s[ie+1]!=null&&s[ie+1].t=="?"));)s[f].v+=s[ie].v,s[ie]={v:"",t:";"},++ie;M+=s[f].v,f=ie-1;break;case"G":s[f].t="t",s[f].v=Ll(a,t);break}var se="",ne,H;if(M.length>0){M.charCodeAt(0)==40?(ne=a<0&&M.charCodeAt(0)===45?-a:a,H=as("n",M,ne)):(ne=a<0&&i>1?-a:a,H=as("n",M,ne),ne<0&&s[0]&&s[0].t=="t"&&(H=H.substr(1),s[0].v="-"+s[0].v)),ie=H.length-1;var le=s.length;for(f=0;f<s.length;++f)if(s[f]!=null&&s[f].t!="t"&&s[f].v.indexOf(".")>-1){le=f;break}var oe=s.length;if(le===s.length&&H.indexOf("E")===-1){for(f=s.length-1;f>=0;--f)s[f]==null||"n?".indexOf(s[f].t)===-1||(ie>=s[f].v.length-1?(ie-=s[f].v.length,s[f].v=H.substr(ie+1,s[f].v.length)):ie<0?s[f].v="":(s[f].v=H.substr(0,ie+1),ie=-1),s[f].t="t",oe=f);ie>=0&&oe<s.length&&(s[oe].v=H.substr(0,ie+1)+s[oe].v)}else if(le!==s.length&&H.indexOf("E")===-1){for(ie=H.indexOf(".")-1,f=le;f>=0;--f)if(!(s[f]==null||"n?".indexOf(s[f].t)===-1)){for(E=s[f].v.indexOf(".")>-1&&f===le?s[f].v.indexOf(".")-1:s[f].v.length-1,se=s[f].v.substr(E+1);E>=0;--E)ie>=0&&(s[f].v.charAt(E)==="0"||s[f].v.charAt(E)==="#")&&(se=H.charAt(ie--)+se);s[f].v=se,s[f].t="t",oe=f}for(ie>=0&&oe<s.length&&(s[oe].v=H.substr(0,ie+1)+s[oe].v),ie=H.indexOf(".")+1,f=le;f<s.length;++f)if(!(s[f]==null||"n?(".indexOf(s[f].t)===-1&&f!==le)){for(E=s[f].v.indexOf(".")>-1&&f===le?s[f].v.indexOf(".")+1:0,se=s[f].v.substr(0,E);E<s[f].v.length;++E)ie<H.length&&(se+=H.charAt(ie++));s[f].v=se,s[f].t="t",oe=f}}}for(f=0;f<s.length;++f)s[f]!=null&&"n?".indexOf(s[f].t)>-1&&(ne=i>1&&a<0&&f>0&&s[f-1].v==="-"?-a:a,s[f].v=as(s[f].t,s[f].v,ne),s[f].t="t");var m="";for(f=0;f!==s.length;++f)s[f]!=null&&(m+=s[f].v);return m}var $x=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Yx(e,a){if(a==null)return!1;var t=parseFloat(a[2]);switch(a[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function aS(e,a){var t=eS(e),i=t.length,s=t[i-1].indexOf("@");if(i<4&&s>-1&&--i,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof a!="number")return[4,t.length===4||s>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=s>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=s>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=s>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var c=a>0?t[0]:a<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[i,c];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var f=t[0].match($x),p=t[1].match($x);return Yx(a,f)?[i,t[0]]:Yx(a,p)?[i,t[1]]:[i,t[f!=null&&p!=null?2:1]]}return[i,c]}function qn(e,a,t){t==null&&(t={});var i="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?i=t.dateNF:i=e;break;case"number":e==14&&t.dateNF?i=t.dateNF:i=(t.table!=null?t.table:mt)[e],i==null&&(i=t.table&&t.table[zx[e]]||mt[zx[e]]),i==null&&(i=L2[e]||"General");break}if(Xd(i,0))return Ll(a,t);a instanceof Date&&(a=Km(a,t.date1904));var s=aS(i,a);if(Xd(s[1]))return Ll(a,t);if(a===!0)a="TRUE";else if(a===!1)a="FALSE";else if(a===""||a==null)return"";return tS(s[1],a,t,s[0])}function rs(e,a){if(typeof a!="number"){a=+a||-1;for(var t=0;t<392;++t){if(mt[t]==null){a<0&&(a=t);continue}if(mt[t]==e){a=t;break}}a<0&&(a=391)}return mt[a]=e,a}function of(e){for(var a=0;a!=392;++a)e[a]!==void 0&&rs(e[a],a)}function Uo(){mt=M2()}var rS={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},iy=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function nS(e){var a=typeof e=="number"?mt[e]:e;return a=a.replace(iy,"(\\d+)"),new RegExp("^"+a+"$")}function iS(e,a,t){var i=-1,s=-1,c=-1,f=-1,p=-1,g=-1;(a.match(iy)||[]).forEach(function(A,_){var w=parseInt(t[_+1],10);switch(A.toLowerCase().charAt(0)){case"y":i=w;break;case"d":c=w;break;case"h":f=w;break;case"s":g=w;break;case"m":f>=0?p=w:s=w;break}}),g>=0&&p==-1&&s>=0&&(p=s,s=-1);var h=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(c>=1?c:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var E=("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(p>=0?p:0)).slice(-2)+":"+("00"+(g>=0?g:0)).slice(-2);return f==-1&&p==-1&&g==-1?h:i==-1&&s==-1&&c==-1?E:h+"T"+E}var sS=(function(){var e={};e.version="1.2.0";function a(){for(var H=0,le=new Array(256),oe=0;oe!=256;++oe)H=oe,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,le[oe]=H;return typeof Int32Array<"u"?new Int32Array(le):le}var t=a();function i(H){var le=0,oe=0,m=0,Se=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(m=0;m!=256;++m)Se[m]=H[m];for(m=0;m!=256;++m)for(oe=H[m],le=256+m;le<4096;le+=256)oe=Se[le]=oe>>>8^H[oe&255];var ue=[];for(m=1;m!=16;++m)ue[m-1]=typeof Int32Array<"u"?Se.subarray(m*256,m*256+256):Se.slice(m*256,m*256+256);return ue}var s=i(t),c=s[0],f=s[1],p=s[2],g=s[3],h=s[4],E=s[5],A=s[6],_=s[7],w=s[8],N=s[9],k=s[10],F=s[11],z=s[12],K=s[13],M=s[14];function ie(H,le){for(var oe=le^-1,m=0,Se=H.length;m<Se;)oe=oe>>>8^t[(oe^H.charCodeAt(m++))&255];return~oe}function se(H,le){for(var oe=le^-1,m=H.length-15,Se=0;Se<m;)oe=M[H[Se++]^oe&255]^K[H[Se++]^oe>>8&255]^z[H[Se++]^oe>>16&255]^F[H[Se++]^oe>>>24]^k[H[Se++]]^N[H[Se++]]^w[H[Se++]]^_[H[Se++]]^A[H[Se++]]^E[H[Se++]]^h[H[Se++]]^g[H[Se++]]^p[H[Se++]]^f[H[Se++]]^c[H[Se++]]^t[H[Se++]];for(m+=15;Se<m;)oe=oe>>>8^t[(oe^H[Se++])&255];return~oe}function ne(H,le){for(var oe=le^-1,m=0,Se=H.length,ue=0,Pe=0;m<Se;)ue=H.charCodeAt(m++),ue<128?oe=oe>>>8^t[(oe^ue)&255]:ue<2048?(oe=oe>>>8^t[(oe^(192|ue>>6&31))&255],oe=oe>>>8^t[(oe^(128|ue&63))&255]):ue>=55296&&ue<57344?(ue=(ue&1023)+64,Pe=H.charCodeAt(m++)&1023,oe=oe>>>8^t[(oe^(240|ue>>8&7))&255],oe=oe>>>8^t[(oe^(128|ue>>2&63))&255],oe=oe>>>8^t[(oe^(128|Pe>>6&15|(ue&3)<<4))&255],oe=oe>>>8^t[(oe^(128|Pe&63))&255]):(oe=oe>>>8^t[(oe^(224|ue>>12&15))&255],oe=oe>>>8^t[(oe^(128|ue>>6&63))&255],oe=oe>>>8^t[(oe^(128|ue&63))&255]);return~oe}return e.table=t,e.bstr=ie,e.buf=se,e.str=ne,e})(),ht=(function(){var a={};a.version="1.2.1";function t(j,q){for(var P=j.split("/"),U=q.split("/"),Y=0,J=0,Ee=Math.min(P.length,U.length);Y<Ee;++Y){if(J=P[Y].length-U[Y].length)return J;if(P[Y]!=U[Y])return P[Y]<U[Y]?-1:1}return P.length-U.length}function i(j){if(j.charAt(j.length-1)=="/")return j.slice(0,-1).indexOf("/")===-1?j:i(j.slice(0,-1));var q=j.lastIndexOf("/");return q===-1?j:j.slice(0,q+1)}function s(j){if(j.charAt(j.length-1)=="/")return s(j.slice(0,-1));var q=j.lastIndexOf("/");return q===-1?j:j.slice(q+1)}function c(j,q){typeof q=="string"&&(q=new Date(q));var P=q.getHours();P=P<<6|q.getMinutes(),P=P<<5|q.getSeconds()>>>1,j.write_shift(2,P);var U=q.getFullYear()-1980;U=U<<4|q.getMonth()+1,U=U<<5|q.getDate(),j.write_shift(2,U)}function f(j){var q=j.read_shift(2)&65535,P=j.read_shift(2)&65535,U=new Date,Y=P&31;P>>>=5;var J=P&15;P>>>=4,U.setMilliseconds(0),U.setFullYear(P+1980),U.setMonth(J-1),U.setDate(Y);var Ee=q&31;q>>>=5;var De=q&63;return q>>>=6,U.setHours(q),U.setMinutes(De),U.setSeconds(Ee<<1),U}function p(j){kr(j,0);for(var q={},P=0;j.l<=j.length-4;){var U=j.read_shift(2),Y=j.read_shift(2),J=j.l+Y,Ee={};U===21589&&(P=j.read_shift(1),P&1&&(Ee.mtime=j.read_shift(4)),Y>5&&(P&2&&(Ee.atime=j.read_shift(4)),P&4&&(Ee.ctime=j.read_shift(4))),Ee.mtime&&(Ee.mt=new Date(Ee.mtime*1e3))),j.l=J,q[U]=Ee}return q}var g;function h(){return g||(g={})}function E(j,q){if(j[0]==80&&j[1]==75)return Qn(j,q);if((j[0]|32)==109&&(j[1]|32)==105)return vi(j,q);if(j.length<512)throw new Error("CFB file size "+j.length+" < 512");var P=3,U=512,Y=0,J=0,Ee=0,De=0,me=0,Te=[],Ae=j.slice(0,512);kr(Ae,0);var Ge=A(Ae);switch(P=Ge[0],P){case 3:U=512;break;case 4:U=4096;break;case 0:if(Ge[1]==0)return Qn(j,q);default:throw new Error("Major Version: Expected 3 or 4 saw "+P)}U!==512&&(Ae=j.slice(0,U),kr(Ae,28));var Ye=j.slice(0,U);_(Ae,P);var Ze=Ae.read_shift(4,"i");if(P===3&&Ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ze);Ae.l+=4,Ee=Ae.read_shift(4,"i"),Ae.l+=4,Ae.chk("00100000","Mini Stream Cutoff Size: "),De=Ae.read_shift(4,"i"),Y=Ae.read_shift(4,"i"),me=Ae.read_shift(4,"i"),J=Ae.read_shift(4,"i");for(var He=-1,Xe=0;Xe<109&&(He=Ae.read_shift(4,"i"),!(He<0));++Xe)Te[Xe]=He;var ct=w(j,U);F(me,J,ct,U,Te);var va=K(ct,Ee,Te,U);va[Ee].name="!Directory",Y>0&&De!==Pe&&(va[De].name="!MiniFAT"),va[Te[0]].name="!FAT",va.fat_addrs=Te,va.ssz=U;var xt={},ft=[],Ha=[],pr=[];M(Ee,va,ct,ft,Y,xt,Ha,De),N(Ha,pr,ft),ft.shift();var Gr={FileIndex:Ha,FullPaths:pr};return q&&q.raw&&(Gr.raw={header:Ye,sectors:ct}),Gr}function A(j){if(j[j.l]==80&&j[j.l+1]==75)return[0,0];j.chk(et,"Header Signature: "),j.l+=16;var q=j.read_shift(2,"u");return[j.read_shift(2,"u"),q]}function _(j,q){var P=9;switch(j.l+=2,P=j.read_shift(2)){case 9:if(q!=3)throw new Error("Sector Shift: Expected 9 saw "+P);break;case 12:if(q!=4)throw new Error("Sector Shift: Expected 12 saw "+P);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+P)}j.chk("0600","Mini Sector Shift: "),j.chk("000000000000","Reserved: ")}function w(j,q){for(var P=Math.ceil(j.length/q)-1,U=[],Y=1;Y<P;++Y)U[Y-1]=j.slice(Y*q,(Y+1)*q);return U[P-1]=j.slice(P*q),U}function N(j,q,P){for(var U=0,Y=0,J=0,Ee=0,De=0,me=P.length,Te=[],Ae=[];U<me;++U)Te[U]=Ae[U]=U,q[U]=P[U];for(;De<Ae.length;++De)U=Ae[De],Y=j[U].L,J=j[U].R,Ee=j[U].C,Te[U]===U&&(Y!==-1&&Te[Y]!==Y&&(Te[U]=Te[Y]),J!==-1&&Te[J]!==J&&(Te[U]=Te[J])),Ee!==-1&&(Te[Ee]=U),Y!==-1&&U!=Te[U]&&(Te[Y]=Te[U],Ae.lastIndexOf(Y)<De&&Ae.push(Y)),J!==-1&&U!=Te[U]&&(Te[J]=Te[U],Ae.lastIndexOf(J)<De&&Ae.push(J));for(U=1;U<me;++U)Te[U]===U&&(J!==-1&&Te[J]!==J?Te[U]=Te[J]:Y!==-1&&Te[Y]!==Y&&(Te[U]=Te[Y]));for(U=1;U<me;++U)if(j[U].type!==0){if(De=U,De!=Te[De])do De=Te[De],q[U]=q[De]+"/"+q[U];while(De!==0&&Te[De]!==-1&&De!=Te[De]);Te[U]=-1}for(q[0]+="/",U=1;U<me;++U)j[U].type!==2&&(q[U]+="/")}function k(j,q,P){for(var U=j.start,Y=j.size,J=[],Ee=U;P&&Y>0&&Ee>=0;)J.push(q.slice(Ee*ue,Ee*ue+ue)),Y-=ue,Ee=Dl(P,Ee*4);return J.length===0?Ne(0):yr(J).slice(0,j.size)}function F(j,q,P,U,Y){var J=Pe;if(j===Pe){if(q!==0)throw new Error("DIFAT chain shorter than expected")}else if(j!==-1){var Ee=P[j],De=(U>>>2)-1;if(!Ee)return;for(var me=0;me<De&&(J=Dl(Ee,me*4))!==Pe;++me)Y.push(J);F(Dl(Ee,U-4),q-1,P,U,Y)}}function z(j,q,P,U,Y){var J=[],Ee=[];Y||(Y=[]);var De=U-1,me=0,Te=0;for(me=q;me>=0;){Y[me]=!0,J[J.length]=me,Ee.push(j[me]);var Ae=P[Math.floor(me*4/U)];if(Te=me*4&De,U<4+Te)throw new Error("FAT boundary crossed: "+me+" 4 "+U);if(!j[Ae])break;me=Dl(j[Ae],Te)}return{nodes:J,data:am([Ee])}}function K(j,q,P,U){var Y=j.length,J=[],Ee=[],De=[],me=[],Te=U-1,Ae=0,Ge=0,Ye=0,Ze=0;for(Ae=0;Ae<Y;++Ae)if(De=[],Ye=Ae+q,Ye>=Y&&(Ye-=Y),!Ee[Ye]){me=[];var He=[];for(Ge=Ye;Ge>=0;){He[Ge]=!0,Ee[Ge]=!0,De[De.length]=Ge,me.push(j[Ge]);var Xe=P[Math.floor(Ge*4/U)];if(Ze=Ge*4&Te,U<4+Ze)throw new Error("FAT boundary crossed: "+Ge+" 4 "+U);if(!j[Xe]||(Ge=Dl(j[Xe],Ze),He[Ge]))break}J[Ye]={nodes:De,data:am([me])}}return J}function M(j,q,P,U,Y,J,Ee,De){for(var me=0,Te=U.length?2:0,Ae=q[j].data,Ge=0,Ye=0,Ze;Ge<Ae.length;Ge+=128){var He=Ae.slice(Ge,Ge+128);kr(He,64),Ye=He.read_shift(2),Ze=ah(He,0,Ye-Te),U.push(Ze);var Xe={name:Ze,type:He.read_shift(1),color:He.read_shift(1),L:He.read_shift(4,"i"),R:He.read_shift(4,"i"),C:He.read_shift(4,"i"),clsid:He.read_shift(16),state:He.read_shift(4,"i"),start:0,size:0},ct=He.read_shift(2)+He.read_shift(2)+He.read_shift(2)+He.read_shift(2);ct!==0&&(Xe.ct=ie(He,He.l-8));var va=He.read_shift(2)+He.read_shift(2)+He.read_shift(2)+He.read_shift(2);va!==0&&(Xe.mt=ie(He,He.l-8)),Xe.start=He.read_shift(4,"i"),Xe.size=He.read_shift(4,"i"),Xe.size<0&&Xe.start<0&&(Xe.size=Xe.type=0,Xe.start=Pe,Xe.name=""),Xe.type===5?(me=Xe.start,Y>0&&me!==Pe&&(q[me].name="!StreamData")):Xe.size>=4096?(Xe.storage="fat",q[Xe.start]===void 0&&(q[Xe.start]=z(P,Xe.start,q.fat_addrs,q.ssz)),q[Xe.start].name=Xe.name,Xe.content=q[Xe.start].data.slice(0,Xe.size)):(Xe.storage="minifat",Xe.size<0?Xe.size=0:me!==Pe&&Xe.start!==Pe&&q[me]&&(Xe.content=k(Xe,q[me].data,(q[De]||{}).data))),Xe.content&&kr(Xe.content,0),J[Ze]=Xe,Ee.push(Xe)}}function ie(j,q){return new Date((_n(j,q+4)/1e7*Math.pow(2,32)+_n(j,q)/1e7-11644473600)*1e3)}function se(j,q){return h(),E(g.readFileSync(j),q)}function ne(j,q){var P=q&&q.type;switch(P||It&&Buffer.isBuffer(j)&&(P="buffer"),P||"base64"){case"file":return se(j,q);case"base64":return E(Cn(wn(j)),q);case"binary":return E(Cn(j),q)}return E(j,q)}function H(j,q){var P=q||{},U=P.root||"Root Entry";if(j.FullPaths||(j.FullPaths=[]),j.FileIndex||(j.FileIndex=[]),j.FullPaths.length!==j.FileIndex.length)throw new Error("inconsistent CFB structure");j.FullPaths.length===0&&(j.FullPaths[0]=U+"/",j.FileIndex[0]={name:U,type:5}),P.CLSID&&(j.FileIndex[0].clsid=P.CLSID),le(j)}function le(j){var q="Sh33tJ5";if(!ht.find(j,"/"+q)){var P=Ne(4);P[0]=55,P[1]=P[3]=50,P[2]=54,j.FileIndex.push({name:q,type:2,content:P,size:4,L:69,R:69,C:69}),j.FullPaths.push(j.FullPaths[0]+q),oe(j)}}function oe(j,q){H(j);for(var P=!1,U=!1,Y=j.FullPaths.length-1;Y>=0;--Y){var J=j.FileIndex[Y];switch(J.type){case 0:U?P=!0:(j.FileIndex.pop(),j.FullPaths.pop());break;case 1:case 2:case 5:U=!0,isNaN(J.R*J.L*J.C)&&(P=!0),J.R>-1&&J.L>-1&&J.R==J.L&&(P=!0);break;default:P=!0;break}}if(!(!P&&!q)){var Ee=new Date(1987,1,19),De=0,me=Object.create?Object.create(null):{},Te=[];for(Y=0;Y<j.FullPaths.length;++Y)me[j.FullPaths[Y]]=!0,j.FileIndex[Y].type!==0&&Te.push([j.FullPaths[Y],j.FileIndex[Y]]);for(Y=0;Y<Te.length;++Y){var Ae=i(Te[Y][0]);U=me[Ae],U||(Te.push([Ae,{name:s(Ae).replace("/",""),type:1,clsid:de,ct:Ee,mt:Ee,content:null}]),me[Ae]=!0)}for(Te.sort(function(Ze,He){return t(Ze[0],He[0])}),j.FullPaths=[],j.FileIndex=[],Y=0;Y<Te.length;++Y)j.FullPaths[Y]=Te[Y][0],j.FileIndex[Y]=Te[Y][1];for(Y=0;Y<Te.length;++Y){var Ge=j.FileIndex[Y],Ye=j.FullPaths[Y];if(Ge.name=s(Ye).replace("/",""),Ge.L=Ge.R=Ge.C=-(Ge.color=1),Ge.size=Ge.content?Ge.content.length:0,Ge.start=0,Ge.clsid=Ge.clsid||de,Y===0)Ge.C=Te.length>1?1:-1,Ge.size=0,Ge.type=5;else if(Ye.slice(-1)=="/"){for(De=Y+1;De<Te.length&&i(j.FullPaths[De])!=Ye;++De);for(Ge.C=De>=Te.length?-1:De,De=Y+1;De<Te.length&&i(j.FullPaths[De])!=i(Ye);++De);Ge.R=De>=Te.length?-1:De,Ge.type=1}else i(j.FullPaths[Y+1]||"")==i(Ye)&&(Ge.R=Y+1),Ge.type=2}}}function m(j,q){var P=q||{};if(P.fileType=="mad")return ur(j,P);if(oe(j),P.fileType==="zip")return yi(j,P);var U=(function(Ze){for(var He=0,Xe=0,ct=0;ct<Ze.FileIndex.length;++ct){var va=Ze.FileIndex[ct];if(va.content){var xt=va.content.length;xt>0&&(xt<4096?He+=xt+63>>6:Xe+=xt+511>>9)}}for(var ft=Ze.FullPaths.length+3>>2,Ha=He+7>>3,pr=He+127>>7,Gr=Ha+Xe+ft+pr,Aa=Gr+127>>7,On=Aa<=109?0:Math.ceil((Aa-109)/127);Gr+Aa+On+127>>7>Aa;)On=++Aa<=109?0:Math.ceil((Aa-109)/127);var sa=[1,On,Aa,pr,ft,Xe,He,0];return Ze.FileIndex[0].size=He<<6,sa[7]=(Ze.FileIndex[0].start=sa[0]+sa[1]+sa[2]+sa[3]+sa[4]+sa[5])+(sa[6]+7>>3),sa})(j),Y=Ne(U[7]<<9),J=0,Ee=0;{for(J=0;J<8;++J)Y.write_shift(1,ke[J]);for(J=0;J<8;++J)Y.write_shift(2,0);for(Y.write_shift(2,62),Y.write_shift(2,3),Y.write_shift(2,65534),Y.write_shift(2,9),Y.write_shift(2,6),J=0;J<3;++J)Y.write_shift(2,0);for(Y.write_shift(4,0),Y.write_shift(4,U[2]),Y.write_shift(4,U[0]+U[1]+U[2]+U[3]-1),Y.write_shift(4,0),Y.write_shift(4,4096),Y.write_shift(4,U[3]?U[0]+U[1]+U[2]-1:Pe),Y.write_shift(4,U[3]),Y.write_shift(-4,U[1]?U[0]-1:Pe),Y.write_shift(4,U[1]),J=0;J<109;++J)Y.write_shift(-4,J<U[2]?U[1]+J:-1)}if(U[1])for(Ee=0;Ee<U[1];++Ee){for(;J<236+Ee*127;++J)Y.write_shift(-4,J<U[2]?U[1]+J:-1);Y.write_shift(-4,Ee===U[1]-1?Pe:Ee+1)}var De=function(Ze){for(Ee+=Ze;J<Ee-1;++J)Y.write_shift(-4,J+1);Ze&&(++J,Y.write_shift(-4,Pe))};for(Ee=J=0,Ee+=U[1];J<Ee;++J)Y.write_shift(-4,Ce.DIFSECT);for(Ee+=U[2];J<Ee;++J)Y.write_shift(-4,Ce.FATSECT);De(U[3]),De(U[4]);for(var me=0,Te=0,Ae=j.FileIndex[0];me<j.FileIndex.length;++me)Ae=j.FileIndex[me],Ae.content&&(Te=Ae.content.length,!(Te<4096)&&(Ae.start=Ee,De(Te+511>>9)));for(De(U[6]+7>>3);Y.l&511;)Y.write_shift(-4,Ce.ENDOFCHAIN);for(Ee=J=0,me=0;me<j.FileIndex.length;++me)Ae=j.FileIndex[me],Ae.content&&(Te=Ae.content.length,!(!Te||Te>=4096)&&(Ae.start=Ee,De(Te+63>>6)));for(;Y.l&511;)Y.write_shift(-4,Ce.ENDOFCHAIN);for(J=0;J<U[4]<<2;++J){var Ge=j.FullPaths[J];if(!Ge||Ge.length===0){for(me=0;me<17;++me)Y.write_shift(4,0);for(me=0;me<3;++me)Y.write_shift(4,-1);for(me=0;me<12;++me)Y.write_shift(4,0);continue}Ae=j.FileIndex[J],J===0&&(Ae.start=Ae.size?Ae.start-1:Pe);var Ye=J===0&&P.root||Ae.name;if(Te=2*(Ye.length+1),Y.write_shift(64,Ye,"utf16le"),Y.write_shift(2,Te),Y.write_shift(1,Ae.type),Y.write_shift(1,Ae.color),Y.write_shift(-4,Ae.L),Y.write_shift(-4,Ae.R),Y.write_shift(-4,Ae.C),Ae.clsid)Y.write_shift(16,Ae.clsid,"hex");else for(me=0;me<4;++me)Y.write_shift(4,0);Y.write_shift(4,Ae.state||0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,Ae.start),Y.write_shift(4,Ae.size),Y.write_shift(4,0)}for(J=1;J<j.FileIndex.length;++J)if(Ae=j.FileIndex[J],Ae.size>=4096)if(Y.l=Ae.start+1<<9,It&&Buffer.isBuffer(Ae.content))Ae.content.copy(Y,Y.l,0,Ae.size),Y.l+=Ae.size+511&-512;else{for(me=0;me<Ae.size;++me)Y.write_shift(1,Ae.content[me]);for(;me&511;++me)Y.write_shift(1,0)}for(J=1;J<j.FileIndex.length;++J)if(Ae=j.FileIndex[J],Ae.size>0&&Ae.size<4096)if(It&&Buffer.isBuffer(Ae.content))Ae.content.copy(Y,Y.l,0,Ae.size),Y.l+=Ae.size+63&-64;else{for(me=0;me<Ae.size;++me)Y.write_shift(1,Ae.content[me]);for(;me&63;++me)Y.write_shift(1,0)}if(It)Y.l=Y.length;else for(;Y.l<Y.length;)Y.write_shift(1,0);return Y}function Se(j,q){var P=j.FullPaths.map(function(me){return me.toUpperCase()}),U=P.map(function(me){var Te=me.split("/");return Te[Te.length-(me.slice(-1)=="/"?2:1)]}),Y=!1;q.charCodeAt(0)===47?(Y=!0,q=P[0].slice(0,-1)+q):Y=q.indexOf("/")!==-1;var J=q.toUpperCase(),Ee=Y===!0?P.indexOf(J):U.indexOf(J);if(Ee!==-1)return j.FileIndex[Ee];var De=!J.match(Bc);for(J=J.replace(Kr,""),De&&(J=J.replace(Bc,"!")),Ee=0;Ee<P.length;++Ee)if((De?P[Ee].replace(Bc,"!"):P[Ee]).replace(Kr,"")==J||(De?U[Ee].replace(Bc,"!"):U[Ee]).replace(Kr,"")==J)return j.FileIndex[Ee];return null}var ue=64,Pe=-2,et="d0cf11e0a1b11ae1",ke=[208,207,17,224,161,177,26,225],de="00000000000000000000000000000000",Ce={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Pe,FREESECT:-1,HEADER_SIGNATURE:et,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:de,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Je(j,q,P){h();var U=m(j,P);g.writeFileSync(q,U)}function fe(j){for(var q=new Array(j.length),P=0;P<j.length;++P)q[P]=String.fromCharCode(j[P]);return q.join("")}function Ke(j,q){var P=m(j,q);switch(q&&q.type||"buffer"){case"file":return h(),g.writeFileSync(q.filename,P),P;case"binary":return typeof P=="string"?P:fe(P);case"base64":return Vc(typeof P=="string"?P:fe(P));case"buffer":if(It)return Buffer.isBuffer(P)?P:ss(P);case"array":return typeof P=="string"?Cn(P):P}return P}var ee;function I(j){try{var q=j.InflateRaw,P=new q;if(P._processChunk(new Uint8Array([3,0]),P._finishFlushFlag),P.bytesRead)ee=j;else throw new Error("zlib does not expose bytesRead")}catch(U){console.error("cannot use native zlib: "+(U.message||U))}}function L(j,q){if(!ee)return Fr(j,q);var P=ee.InflateRaw,U=new P,Y=U._processChunk(j.slice(j.l),U._finishFlushFlag);return j.l+=U.bytesRead,Y}function Q(j){return ee?ee.deflateRawSync(j):yt(j)}var te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ge=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],je=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ze(j){var q=(j<<1|j<<11)&139536|(j<<5|j<<15)&558144;return(q>>16|q>>8|q)&255}for(var Oe=typeof Uint8Array<"u",Ue=Oe?new Uint8Array(256):[],St=0;St<256;++St)Ue[St]=ze(St);function Z(j,q){var P=Ue[j&255];return q<=8?P>>>8-q:(P=P<<8|Ue[j>>8&255],q<=16?P>>>16-q:(P=P<<8|Ue[j>>16&255],P>>>24-q))}function Jt(j,q){var P=q&7,U=q>>>3;return(j[U]|(P<=6?0:j[U+1]<<8))>>>P&3}function At(j,q){var P=q&7,U=q>>>3;return(j[U]|(P<=5?0:j[U+1]<<8))>>>P&7}function Gt(j,q){var P=q&7,U=q>>>3;return(j[U]|(P<=4?0:j[U+1]<<8))>>>P&15}function Ct(j,q){var P=q&7,U=q>>>3;return(j[U]|(P<=3?0:j[U+1]<<8))>>>P&31}function at(j,q){var P=q&7,U=q>>>3;return(j[U]|(P<=1?0:j[U+1]<<8))>>>P&127}function Ta(j,q,P){var U=q&7,Y=q>>>3,J=(1<<P)-1,Ee=j[Y]>>>U;return P<8-U||(Ee|=j[Y+1]<<8-U,P<16-U)||(Ee|=j[Y+2]<<16-U,P<24-U)||(Ee|=j[Y+3]<<24-U),Ee&J}function Ia(j,q,P){var U=q&7,Y=q>>>3;return U<=5?j[Y]|=(P&7)<<U:(j[Y]|=P<<U&255,j[Y+1]=(P&7)>>8-U),q+3}function nr(j,q,P){var U=q&7,Y=q>>>3;return P=(P&1)<<U,j[Y]|=P,q+1}function Yr(j,q,P){var U=q&7,Y=q>>>3;return P<<=U,j[Y]|=P&255,P>>>=8,j[Y+1]=P,q+8}function Rn(j,q,P){var U=q&7,Y=q>>>3;return P<<=U,j[Y]|=P&255,P>>>=8,j[Y+1]=P&255,j[Y+2]=P>>>8,q+16}function Rr(j,q){var P=j.length,U=2*P>q?2*P:q+5,Y=0;if(P>=q)return j;if(It){var J=Mx(U);if(j.copy)j.copy(J);else for(;Y<j.length;++Y)J[Y]=j[Y];return J}else if(Oe){var Ee=new Uint8Array(U);if(Ee.set)Ee.set(j);else for(;Y<P;++Y)Ee[Y]=j[Y];return Ee}return j.length=U,j}function Wt(j){for(var q=new Array(j),P=0;P<j;++P)q[P]=0;return q}function br(j,q,P){var U=1,Y=0,J=0,Ee=0,De=0,me=j.length,Te=Oe?new Uint16Array(32):Wt(32);for(J=0;J<32;++J)Te[J]=0;for(J=me;J<P;++J)j[J]=0;me=j.length;var Ae=Oe?new Uint16Array(me):Wt(me);for(J=0;J<me;++J)Te[Y=j[J]]++,U<Y&&(U=Y),Ae[J]=0;for(Te[0]=0,J=1;J<=U;++J)Te[J+16]=De=De+Te[J-1]<<1;for(J=0;J<me;++J)De=j[J],De!=0&&(Ae[J]=Te[De+16]++);var Ge=0;for(J=0;J<me;++J)if(Ge=j[J],Ge!=0)for(De=Z(Ae[J],U)>>U-Ge,Ee=(1<<U+4-Ge)-1;Ee>=0;--Ee)q[De|Ee<<Ge]=Ge&15|J<<4;return U}var Sr=Oe?new Uint16Array(512):Wt(512),Qr=Oe?new Uint16Array(32):Wt(32);if(!Oe){for(var Ea=0;Ea<512;++Ea)Sr[Ea]=0;for(Ea=0;Ea<32;++Ea)Qr[Ea]=0}(function(){for(var j=[],q=0;q<32;q++)j.push(5);br(j,Qr,32);var P=[];for(q=0;q<=143;q++)P.push(8);for(;q<=255;q++)P.push(9);for(;q<=279;q++)P.push(7);for(;q<=287;q++)P.push(8);br(P,Sr,288)})();var Dt=(function(){for(var q=Oe?new Uint8Array(32768):[],P=0,U=0;P<je.length-1;++P)for(;U<je[P+1];++U)q[U]=P;for(;U<32768;++U)q[U]=29;var Y=Oe?new Uint8Array(259):[];for(P=0,U=0;P<ge.length-1;++P)for(;U<ge[P+1];++U)Y[U]=P;function J(De,me){for(var Te=0;Te<De.length;){var Ae=Math.min(65535,De.length-Te),Ge=Te+Ae==De.length;for(me.write_shift(1,+Ge),me.write_shift(2,Ae),me.write_shift(2,~Ae&65535);Ae-- >0;)me[me.l++]=De[Te++]}return me.l}function Ee(De,me){for(var Te=0,Ae=0,Ge=Oe?new Uint16Array(32768):[];Ae<De.length;){var Ye=Math.min(65535,De.length-Ae);if(Ye<10){for(Te=Ia(me,Te,+(Ae+Ye==De.length)),Te&7&&(Te+=8-(Te&7)),me.l=Te/8|0,me.write_shift(2,Ye),me.write_shift(2,~Ye&65535);Ye-- >0;)me[me.l++]=De[Ae++];Te=me.l*8;continue}Te=Ia(me,Te,+(Ae+Ye==De.length)+2);for(var Ze=0;Ye-- >0;){var He=De[Ae];Ze=(Ze<<5^He)&32767;var Xe=-1,ct=0;if((Xe=Ge[Ze])&&(Xe|=Ae&-32768,Xe>Ae&&(Xe-=32768),Xe<Ae))for(;De[Xe+ct]==De[Ae+ct]&&ct<250;)++ct;if(ct>2){He=Y[ct],He<=22?Te=Yr(me,Te,Ue[He+1]>>1)-1:(Yr(me,Te,3),Te+=5,Yr(me,Te,Ue[He-23]>>5),Te+=3);var va=He<8?0:He-4>>2;va>0&&(Rn(me,Te,ct-ge[He]),Te+=va),He=q[Ae-Xe],Te=Yr(me,Te,Ue[He]>>3),Te-=3;var xt=He<4?0:He-2>>1;xt>0&&(Rn(me,Te,Ae-Xe-je[He]),Te+=xt);for(var ft=0;ft<ct;++ft)Ge[Ze]=Ae&32767,Ze=(Ze<<5^De[Ae])&32767,++Ae;Ye-=ct-1}else He<=143?He=He+48:Te=nr(me,Te,1),Te=Yr(me,Te,Ue[He]),Ge[Ze]=Ae&32767,++Ae}Te=Yr(me,Te,0)-1}return me.l=(Te+7)/8|0,me.l}return function(me,Te){return me.length<8?J(me,Te):Ee(me,Te)}})();function yt(j){var q=Ne(50+Math.floor(j.length*1.1)),P=Dt(j,q);return q.slice(0,P)}var ma=Oe?new Uint16Array(32768):Wt(32768),Nr=Oe?new Uint16Array(32768):Wt(32768),ia=Oe?new Uint16Array(128):Wt(128),Ot=1,Nn=1;function Zt(j,q){var P=Ct(j,q)+257;q+=5;var U=Ct(j,q)+1;q+=5;var Y=Gt(j,q)+4;q+=4;for(var J=0,Ee=Oe?new Uint8Array(19):Wt(19),De=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],me=1,Te=Oe?new Uint8Array(8):Wt(8),Ae=Oe?new Uint8Array(8):Wt(8),Ge=Ee.length,Ye=0;Ye<Y;++Ye)Ee[te[Ye]]=J=At(j,q),me<J&&(me=J),Te[J]++,q+=3;var Ze=0;for(Te[0]=0,Ye=1;Ye<=me;++Ye)Ae[Ye]=Ze=Ze+Te[Ye-1]<<1;for(Ye=0;Ye<Ge;++Ye)(Ze=Ee[Ye])!=0&&(De[Ye]=Ae[Ze]++);var He=0;for(Ye=0;Ye<Ge;++Ye)if(He=Ee[Ye],He!=0){Ze=Ue[De[Ye]]>>8-He;for(var Xe=(1<<7-He)-1;Xe>=0;--Xe)ia[Ze|Xe<<He]=He&7|Ye<<3}var ct=[];for(me=1;ct.length<P+U;)switch(Ze=ia[at(j,q)],q+=Ze&7,Ze>>>=3){case 16:for(J=3+Jt(j,q),q+=2,Ze=ct[ct.length-1];J-- >0;)ct.push(Ze);break;case 17:for(J=3+At(j,q),q+=3;J-- >0;)ct.push(0);break;case 18:for(J=11+at(j,q),q+=7;J-- >0;)ct.push(0);break;default:ct.push(Ze),me<Ze&&(me=Ze);break}var va=ct.slice(0,P),xt=ct.slice(P);for(Ye=P;Ye<286;++Ye)va[Ye]=0;for(Ye=U;Ye<30;++Ye)xt[Ye]=0;return Ot=br(va,ma,286),Nn=br(xt,Nr,30),q}function Mt(j,q){if(j[0]==3&&!(j[1]&3))return[Ks(q),2];for(var P=0,U=0,Y=Mx(q||1<<18),J=0,Ee=Y.length>>>0,De=0,me=0;(U&1)==0;){if(U=At(j,P),P+=3,U>>>1)U>>1==1?(De=9,me=5):(P=Zt(j,P),De=Ot,me=Nn);else{P&7&&(P+=8-(P&7));var Te=j[P>>>3]|j[(P>>>3)+1]<<8;if(P+=32,Te>0)for(!q&&Ee<J+Te&&(Y=Rr(Y,J+Te),Ee=Y.length);Te-- >0;)Y[J++]=j[P>>>3],P+=8;continue}for(;;){!q&&Ee<J+32767&&(Y=Rr(Y,J+32767),Ee=Y.length);var Ae=Ta(j,P,De),Ge=U>>>1==1?Sr[Ae]:ma[Ae];if(P+=Ge&15,Ge>>>=4,(Ge>>>8&255)===0)Y[J++]=Ge;else{if(Ge==256)break;Ge-=257;var Ye=Ge<8?0:Ge-4>>2;Ye>5&&(Ye=0);var Ze=J+ge[Ge];Ye>0&&(Ze+=Ta(j,P,Ye),P+=Ye),Ae=Ta(j,P,me),Ge=U>>>1==1?Qr[Ae]:Nr[Ae],P+=Ge&15,Ge>>>=4;var He=Ge<4?0:Ge-2>>1,Xe=je[Ge];for(He>0&&(Xe+=Ta(j,P,He),P+=He),!q&&Ee<Ze&&(Y=Rr(Y,Ze+100),Ee=Y.length);J<Ze;)Y[J]=Y[J-Xe],++J}}}return q?[Y,P+7>>>3]:[Y.slice(0,J),P+7>>>3]}function Fr(j,q){var P=j.slice(j.l||0),U=Mt(P,q);return j.l+=U[1],U[0]}function Kl(j,q){if(j)typeof console<"u"&&console.error(q);else throw new Error(q)}function Qn(j,q){var P=j;kr(P,0);var U=[],Y=[],J={FileIndex:U,FullPaths:Y};H(J,{root:q.root});for(var Ee=P.length-4;(P[Ee]!=80||P[Ee+1]!=75||P[Ee+2]!=5||P[Ee+3]!=6)&&Ee>=0;)--Ee;P.l=Ee+4,P.l+=4;var De=P.read_shift(2);P.l+=6;var me=P.read_shift(4);for(P.l=me,Ee=0;Ee<De;++Ee){P.l+=20;var Te=P.read_shift(4),Ae=P.read_shift(4),Ge=P.read_shift(2),Ye=P.read_shift(2),Ze=P.read_shift(2);P.l+=8;var He=P.read_shift(4),Xe=p(P.slice(P.l+Ge,P.l+Ge+Ye));P.l+=Ge+Ye+Ze;var ct=P.l;P.l=He+4,Jn(P,Te,Ae,J,Xe),P.l=ct}return J}function Jn(j,q,P,U,Y){j.l+=2;var J=j.read_shift(2),Ee=j.read_shift(2),De=f(j);if(J&8257)throw new Error("Unsupported ZIP encryption");for(var me=j.read_shift(4),Te=j.read_shift(4),Ae=j.read_shift(4),Ge=j.read_shift(2),Ye=j.read_shift(2),Ze="",He=0;He<Ge;++He)Ze+=String.fromCharCode(j[j.l++]);if(Ye){var Xe=p(j.slice(j.l,j.l+Ye));(Xe[21589]||{}).mt&&(De=Xe[21589].mt),((Y||{})[21589]||{}).mt&&(De=Y[21589].mt)}j.l+=Ye;var ct=j.slice(j.l,j.l+Te);switch(Ee){case 8:ct=L(j,Ae);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ee)}var va=!1;J&8&&(me=j.read_shift(4),me==134695760&&(me=j.read_shift(4),va=!0),Te=j.read_shift(4),Ae=j.read_shift(4)),Te!=q&&Kl(va,"Bad compressed size: "+q+" != "+Te),Ae!=P&&Kl(va,"Bad uncompressed size: "+P+" != "+Ae),Dn(U,Ze,ct,{unsafe:!0,mt:De})}function yi(j,q){var P=q||{},U=[],Y=[],J=Ne(1),Ee=P.compression?8:0,De=0,me=0,Te=0,Ae=0,Ge=0,Ye=j.FullPaths[0],Ze=Ye,He=j.FileIndex[0],Xe=[],ct=0;for(me=1;me<j.FullPaths.length;++me)if(Ze=j.FullPaths[me].slice(Ye.length),He=j.FileIndex[me],!(!He.size||!He.content||Ze=="Sh33tJ5")){var va=Ae,xt=Ne(Ze.length);for(Te=0;Te<Ze.length;++Te)xt.write_shift(1,Ze.charCodeAt(Te)&127);xt=xt.slice(0,xt.l),Xe[Ge]=sS.buf(He.content,0);var ft=He.content;Ee==8&&(ft=Q(ft)),J=Ne(30),J.write_shift(4,67324752),J.write_shift(2,20),J.write_shift(2,De),J.write_shift(2,Ee),He.mt?c(J,He.mt):J.write_shift(4,0),J.write_shift(-4,Xe[Ge]),J.write_shift(4,ft.length),J.write_shift(4,He.content.length),J.write_shift(2,xt.length),J.write_shift(2,0),Ae+=J.length,U.push(J),Ae+=xt.length,U.push(xt),Ae+=ft.length,U.push(ft),J=Ne(46),J.write_shift(4,33639248),J.write_shift(2,0),J.write_shift(2,20),J.write_shift(2,De),J.write_shift(2,Ee),J.write_shift(4,0),J.write_shift(-4,Xe[Ge]),J.write_shift(4,ft.length),J.write_shift(4,He.content.length),J.write_shift(2,xt.length),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(4,0),J.write_shift(4,va),ct+=J.l,Y.push(J),ct+=xt.length,Y.push(xt),++Ge}return J=Ne(22),J.write_shift(4,101010256),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,Ge),J.write_shift(2,Ge),J.write_shift(4,ct),J.write_shift(4,Ae),J.write_shift(2,0),yr([yr(U),yr(Y),J])}var Jr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ya(j,q){if(j.ctype)return j.ctype;var P=j.name||"",U=P.match(/\.([^\.]+)$/);return U&&Jr[U[1]]||q&&(U=(P=q).match(/[\.\\]([^\.\\])+$/),U&&Jr[U[1]])?Jr[U[1]]:"application/octet-stream"}function Fn(j){for(var q=Vc(j),P=[],U=0;U<q.length;U+=76)P.push(q.slice(U,U+76));return P.join(`\r
`)+`\r
`}function Zn(j){var q=j.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Te){var Ae=Te.charCodeAt(0).toString(16).toUpperCase();return"="+(Ae.length==1?"0"+Ae:Ae)});q=q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),q.charAt(0)==`
`&&(q="=0D"+q.slice(1)),q=q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var P=[],U=q.split(`\r
`),Y=0;Y<U.length;++Y){var J=U[Y];if(J.length==0){P.push("");continue}for(var Ee=0;Ee<J.length;){var De=76,me=J.slice(Ee,Ee+De);me.charAt(De-1)=="="?De--:me.charAt(De-2)=="="?De-=2:me.charAt(De-3)=="="&&(De-=3),me=J.slice(Ee,Ee+De),Ee+=De,Ee<J.length&&(me+="="),P.push(me)}}return P.join(`\r
`)}function cs(j){for(var q=[],P=0;P<j.length;++P){for(var U=j[P];P<=j.length&&U.charAt(U.length-1)=="=";)U=U.slice(0,U.length-1)+j[++P];q.push(U)}for(var Y=0;Y<q.length;++Y)q[Y]=q[Y].replace(/[=][0-9A-Fa-f]{2}/g,function(J){return String.fromCharCode(parseInt(J.slice(1),16))});return Cn(q.join(`\r
`))}function Xt(j,q,P){for(var U="",Y="",J="",Ee,De=0;De<10;++De){var me=q[De];if(!me||me.match(/^\s*$/))break;var Te=me.match(/^(.*?):\s*([^\s].*)$/);if(Te)switch(Te[1].toLowerCase()){case"content-location":U=Te[2].trim();break;case"content-type":J=Te[2].trim();break;case"content-transfer-encoding":Y=Te[2].trim();break}}switch(++De,Y.toLowerCase()){case"base64":Ee=Cn(wn(q.slice(De).join("")));break;case"quoted-printable":Ee=cs(q.slice(De));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Y)}var Ae=Dn(j,U.slice(P.length),Ee,{unsafe:!0});J&&(Ae.ctype=J)}function vi(j,q){if(fe(j.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var P=q&&q.root||"",U=(It&&Buffer.isBuffer(j)?j.toString("binary"):fe(j)).split(`\r
`),Y=0,J="";for(Y=0;Y<U.length;++Y)if(J=U[Y],!!/^Content-Location:/i.test(J)&&(J=J.slice(J.indexOf("file")),P||(P=J.slice(0,J.lastIndexOf("/")+1)),J.slice(0,P.length)!=P))for(;P.length>0&&(P=P.slice(0,P.length-1),P=P.slice(0,P.lastIndexOf("/")+1),J.slice(0,P.length)!=P););var Ee=(U[1]||"").match(/boundary="(.*?)"/);if(!Ee)throw new Error("MAD cannot find boundary");var De="--"+(Ee[1]||""),me=[],Te=[],Ae={FileIndex:me,FullPaths:Te};H(Ae);var Ge,Ye=0;for(Y=0;Y<U.length;++Y){var Ze=U[Y];Ze!==De&&Ze!==De+"--"||(Ye++&&Xt(Ae,U.slice(Ge,Y),P),Ge=Y)}return Ae}function ur(j,q){var P=q||{},U=P.boundary||"SheetJS";U="------="+U;for(var Y=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+U.slice(2)+'"',"","",""],J=j.FullPaths[0],Ee=J,De=j.FileIndex[0],me=1;me<j.FullPaths.length;++me)if(Ee=j.FullPaths[me].slice(J.length),De=j.FileIndex[me],!(!De.size||!De.content||Ee=="Sh33tJ5")){Ee=Ee.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ct){return"_x"+ct.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ct){return"_u"+ct.charCodeAt(0).toString(16)+"_"});for(var Te=De.content,Ae=It&&Buffer.isBuffer(Te)?Te.toString("binary"):fe(Te),Ge=0,Ye=Math.min(1024,Ae.length),Ze=0,He=0;He<=Ye;++He)(Ze=Ae.charCodeAt(He))>=32&&Ze<128&&++Ge;var Xe=Ge>=Ye*4/5;Y.push(U),Y.push("Content-Location: "+(P.root||"file:///C:/SheetJS/")+Ee),Y.push("Content-Transfer-Encoding: "+(Xe?"quoted-printable":"base64")),Y.push("Content-Type: "+ya(De,Ee)),Y.push(""),Y.push(Xe?Zn(Ae):Fn(Ae))}return Y.push(U+`--\r
`),Y.join(`\r
`)}function rl(j){var q={};return H(q,j),q}function Dn(j,q,P,U){var Y=U&&U.unsafe;Y||H(j);var J=!Y&&ht.find(j,q);if(!J){var Ee=j.FullPaths[0];q.slice(0,Ee.length)==Ee?Ee=q:(Ee.slice(-1)!="/"&&(Ee+="/"),Ee=(Ee+q).replace("//","/")),J={name:s(q),type:2},j.FileIndex.push(J),j.FullPaths.push(Ee),Y||ht.utils.cfb_gc(j)}return J.content=P,J.size=P?P.length:0,U&&(U.CLSID&&(J.clsid=U.CLSID),U.mt&&(J.mt=U.mt),U.ct&&(J.ct=U.ct)),J}function Zr(j,q){H(j);var P=ht.find(j,q);if(P){for(var U=0;U<j.FileIndex.length;++U)if(j.FileIndex[U]==P)return j.FileIndex.splice(U,1),j.FullPaths.splice(U,1),!0}return!1}function jn(j,q,P){H(j);var U=ht.find(j,q);if(U){for(var Y=0;Y<j.FileIndex.length;++Y)if(j.FileIndex[Y]==U)return j.FileIndex[Y].name=s(P),j.FullPaths[Y]=P,!0}return!1}function ds(j){oe(j,!0)}return a.find=Se,a.read=ne,a.parse=E,a.write=Ke,a.writeFile=Je,a.utils={cfb_new:rl,cfb_add:Dn,cfb_del:Zr,cfb_mov:jn,cfb_gc:ds,ReadShift:Lc,CheckField:ky,prep_blob:kr,bconcat:yr,use_zlib:I,_deflateRaw:yt,_inflateRaw:Fr,consts:Ce},a})();function lS(e){return typeof e=="string"?lf(e):Array.isArray(e)?j2(e):e}function s0(e,a,t){if(typeof Deno<"u"){if(t&&typeof a=="string")switch(t){case"utf8":a=new TextEncoder(t).encode(a);break;case"binary":a=lf(a);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,a)}var i=t=="utf8"?Ni(a):a;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,e);if(typeof Blob<"u"){var s=new Blob([lS(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var c=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),chrome.downloads.download({url:c,filename:e,saveAs:!0});var f=document.createElement("a");if(f.download!=null)return f.download=e,f.href=c,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),c}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var p=File(e);return p.open("w"),p.encoding="binary",Array.isArray(a)&&(a=el(a)),p.write(a),p.close(),a}catch(g){if(!g.message||!g.message.match(/onstruct/))throw g}throw new Error("cannot save file "+e)}function oS(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(e);a.open("r"),a.encoding="binary";var t=a.read();return a.close(),t}catch(i){if(!i.message||!i.message.match(/onstruct/))throw i}throw new Error("Cannot access file "+e)}function Ua(e){for(var a=Object.keys(e),t=[],i=0;i<a.length;++i)Object.prototype.hasOwnProperty.call(e,a[i])&&t.push(a[i]);return t}function Gx(e,a){for(var t=[],i=Ua(e),s=0;s!==i.length;++s)t[e[i[s]][a]]==null&&(t[e[i[s]][a]]=i[s]);return t}function cf(e){for(var a=[],t=Ua(e),i=0;i!==t.length;++i)a[e[t[i]]]=t[i];return a}function df(e){for(var a=[],t=Ua(e),i=0;i!==t.length;++i)a[e[t[i]]]=parseInt(t[i],10);return a}function cS(e){for(var a=[],t=Ua(e),i=0;i!==t.length;++i)a[e[t[i]]]==null&&(a[e[t[i]]]=[]),a[e[t[i]]].push(t[i]);return a}var Kd=new Date(1899,11,30,0,0,0);function fr(e,a){var t=e.getTime(),i=Kd.getTime()+(e.getTimezoneOffset()-Kd.getTimezoneOffset())*6e4;return(t-i)/(1440*60*1e3)}var sy=new Date,dS=Kd.getTime()+(sy.getTimezoneOffset()-Kd.getTimezoneOffset())*6e4,Wx=sy.getTimezoneOffset();function ff(e){var a=new Date;return a.setTime(e*24*60*60*1e3+dS),a.getTimezoneOffset()!==Wx&&a.setTime(a.getTime()+(a.getTimezoneOffset()-Wx)*6e4),a}function fS(e){var a=0,t=0,i=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var c=1;c!=s.length;++c)if(s[c]){switch(t=1,c>3&&(i=!0),s[c].slice(s[c].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[c].slice(s[c].length-1));case"D":t*=24;case"H":t*=60;case"M":if(i)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}a+=t*parseInt(s[c],10)}return a}var Vx=new Date("2017-02-19T19:06:09.000Z"),ly=isNaN(Vx.getFullYear())?new Date("2/19/17"):Vx,uS=ly.getFullYear()==2017;function ka(e,a){var t=new Date(e);if(uS)return a>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):a<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(ly.getFullYear()==1917&&!isNaN(t.getFullYear())){var i=t.getFullYear();return e.indexOf(""+i)>-1||t.setFullYear(t.getFullYear()+100),t}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],c=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(c=new Date(c.getTime()-c.getTimezoneOffset()*60*1e3)),c}function Pl(e,a){if(It&&Buffer.isBuffer(e)){if(a){if(e[0]==255&&e[1]==254)return Ni(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ni(Xm(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(a){if(e[0]==255&&e[1]==254)return Ni(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ni(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(c){return t[c]||c})}catch{}for(var i=[],s=0;s!=e.length;++s)i.push(String.fromCharCode(e[s]));return i.join("")}function wa(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var a={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(a[t]=wa(e[t]));return a}function Pa(e,a){for(var t="";t.length<a;)t+=e;return t}function xi(e){var a=Number(e);if(!isNaN(a))return isFinite(a)?a:NaN;if(!/\d/.test(e))return a;var t=1,i=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(a=Number(i))||(i=i.replace(/[(](.*)[)]/,function(s,c){return t=-t,c}),!isNaN(a=Number(i)))?a/t:a}var pS=["january","february","march","april","may","june","july","august","september","october","november","december"];function Mo(e){var a=new Date(e),t=new Date(NaN),i=a.getYear(),s=a.getMonth(),c=a.getDate();if(isNaN(c))return t;var f=e.toLowerCase();if(f.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(f=f.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),f.length>3&&pS.indexOf(f)==-1)return t}else if(f.match(/[a-z]/))return t;return i<0||i>8099?t:(s>0||c>1)&&i!=101?a:e.match(/[^-0-9:,\/\\]/)?t:a}var hS=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,i,s){if(e||typeof i=="string")return t.split(i);for(var c=t.split(i),f=[c[0]],p=1;p<c.length;++p)f.push(s),f.push(c[p]);return f}})();function oy(e){return e?e.content&&e.type?Pl(e.content,!0):e.data?Ic(e.data):e.asNodeBuffer&&It?Ic(e.asNodeBuffer().toString("binary")):e.asBinary?Ic(e.asBinary()):e._data&&e._data.getContent?Ic(Pl(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function cy(e){if(!e)return null;if(e.data)return Ix(e.data);if(e.asNodeBuffer&&It)return e.asNodeBuffer();if(e._data&&e._data.getContent){var a=e._data.getContent();return typeof a=="string"?Ix(a):Array.prototype.slice.call(a)}return e.content&&e.type?e.content:null}function gS(e){return e&&e.name.slice(-4)===".bin"?cy(e):oy(e)}function Wn(e,a){for(var t=e.FullPaths||Ua(e.files),i=a.toLowerCase().replace(/[\/]/g,"\\"),s=i.replace(/\\/g,"/"),c=0;c<t.length;++c){var f=t[c].replace(/^Root Entry[\/]/,"").toLowerCase();if(i==f||s==f)return e.files?e.files[t[c]]:e.FileIndex[c]}return null}function Kp(e,a){var t=Wn(e,a);if(t==null)throw new Error("Cannot find file "+a+" in zip");return t}function ar(e,a,t){if(!t)return gS(Kp(e,a));if(!a)return null;try{return ar(e,a)}catch{return null}}function kn(e,a,t){if(!t)return oy(Kp(e,a));if(!a)return null;try{return kn(e,a)}catch{return null}}function xS(e,a,t){return cy(Kp(e,a))}function Xx(e){for(var a=e.FullPaths||Ua(e.files),t=[],i=0;i<a.length;++i)a[i].slice(-1)!="/"&&t.push(a[i].replace(/^Root Entry[\/]/,""));return t.sort()}function Ft(e,a,t){if(e.FullPaths){if(typeof t=="string"){var i;return It?i=ss(t):i=O2(t),ht.utils.cfb_add(e,a,i)}ht.utils.cfb_add(e,a,t)}else e.file(a,t)}function Qp(){return ht.utils.cfb_new()}function dy(e,a){switch(a.type){case"base64":return ht.read(e,{type:"base64"});case"binary":return ht.read(e,{type:"binary"});case"buffer":case"array":return ht.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+a.type)}function Mc(e,a){if(e.charAt(0)=="/")return e.slice(1);var t=a.split("/");a.slice(-1)!="/"&&t.pop();for(var i=e.split("/");i.length!==0;){var s=i.shift();s===".."?t.pop():s!=="."&&t.push(s)}return t.join("/")}var qa=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,mS=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,qx=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,yS=/<[^>]*>/g,$r=qa.match(qx)?qx:yS,vS=/<\w*:/,bS=/<(\/?)\w+:/;function Et(e,a,t){for(var i={},s=0,c=0;s!==e.length&&!((c=e.charCodeAt(s))===32||c===10||c===13);++s);if(a||(i[0]=e.slice(0,s)),s===e.length)return i;var f=e.match(mS),p=0,g="",h=0,E="",A="",_=1;if(f)for(h=0;h!=f.length;++h){for(A=f[h],c=0;c!=A.length&&A.charCodeAt(c)!==61;++c);for(E=A.slice(0,c).trim();A.charCodeAt(c+1)==32;)++c;for(_=(s=A.charCodeAt(c+1))==34||s==39?1:0,g=A.slice(c+1+_,A.length-_),p=0;p!=E.length&&E.charCodeAt(p)!==58;++p);if(p===E.length)E.indexOf("_")>0&&(E=E.slice(0,E.indexOf("_"))),i[E]=g,i[E.toLowerCase()]=g;else{var w=(p===5&&E.slice(0,5)==="xmlns"?"xmlns":"")+E.slice(p+1);if(i[w]&&E.slice(p-3,p)=="ext")continue;i[w]=g,i[w.toLowerCase()]=g}}return i}function Fi(e){return e.replace(bS,"<$1")}var fy={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Jp=cf(fy),Kt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,a=/_x([\da-fA-F]{4})_/ig;return function t(i){var s=i+"",c=s.indexOf("<![CDATA[");if(c==-1)return s.replace(e,function(p,g){return fy[p]||String.fromCharCode(parseInt(g,p.indexOf("x")>-1?16:10))||p}).replace(a,function(p,g){return String.fromCharCode(parseInt(g,16))});var f=s.indexOf("]]>");return t(s.slice(0,c))+s.slice(c+9,f)+t(s.slice(f+3))}})(),Zp=/[&<>'"]/g,SS=/[\u0000-\u0008\u000b-\u001f]/g;function fa(e){var a=e+"";return a.replace(Zp,function(t){return Jp[t]}).replace(SS,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Kx(e){return fa(e).replace(/ /g,"_x0020_")}var uy=/[\u0000-\u001f]/g;function eh(e){var a=e+"";return a.replace(Zp,function(t){return Jp[t]}).replace(/\n/g,"<br/>").replace(uy,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function ES(e){var a=e+"";return a.replace(Zp,function(t){return Jp[t]}).replace(uy,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var Qx=(function(){var e=/&#(\d+);/g;function a(t,i){return String.fromCharCode(parseInt(i,10))}return function(i){return i.replace(e,a)}})();function TS(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ca(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function yp(e){for(var a="",t=0,i=0,s=0,c=0,f=0,p=0;t<e.length;){if(i=e.charCodeAt(t++),i<128){a+=String.fromCharCode(i);continue}if(s=e.charCodeAt(t++),i>191&&i<224){f=(i&31)<<6,f|=s&63,a+=String.fromCharCode(f);continue}if(c=e.charCodeAt(t++),i<240){a+=String.fromCharCode((i&15)<<12|(s&63)<<6|c&63);continue}f=e.charCodeAt(t++),p=((i&7)<<18|(s&63)<<12|(c&63)<<6|f&63)-65536,a+=String.fromCharCode(55296+(p>>>10&1023)),a+=String.fromCharCode(56320+(p&1023))}return a}function Jx(e){var a=Ks(2*e.length),t,i,s=1,c=0,f=0,p;for(i=0;i<e.length;i+=s)s=1,(p=e.charCodeAt(i))<128?t=p:p<224?(t=(p&31)*64+(e.charCodeAt(i+1)&63),s=2):p<240?(t=(p&15)*4096+(e.charCodeAt(i+1)&63)*64+(e.charCodeAt(i+2)&63),s=3):(s=4,t=(p&7)*262144+(e.charCodeAt(i+1)&63)*4096+(e.charCodeAt(i+2)&63)*64+(e.charCodeAt(i+3)&63),t-=65536,f=55296+(t>>>10&1023),t=56320+(t&1023)),f!==0&&(a[c++]=f&255,a[c++]=f>>>8,f=0),a[c++]=t%256,a[c++]=t>>>8;return a.slice(0,c).toString("ucs2")}function Zx(e){return ss(e,"binary").toString("utf8")}var Bd="foo bar baz",xa=It&&(Zx(Bd)==yp(Bd)&&Zx||Jx(Bd)==yp(Bd)&&Jx)||yp,Ni=It?function(e){return ss(e,"utf8").toString("binary")}:function(e){for(var a=[],t=0,i=0,s=0;t<e.length;)switch(i=e.charCodeAt(t++),!0){case i<128:a.push(String.fromCharCode(i));break;case i<2048:a.push(String.fromCharCode(192+(i>>6))),a.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,s=e.charCodeAt(t++)-56320+(i<<10),a.push(String.fromCharCode(240+(s>>18&7))),a.push(String.fromCharCode(144+(s>>12&63))),a.push(String.fromCharCode(128+(s>>6&63))),a.push(String.fromCharCode(128+(s&63)));break;default:a.push(String.fromCharCode(224+(i>>12))),a.push(String.fromCharCode(128+(i>>6&63))),a.push(String.fromCharCode(128+(i&63)))}return a.join("")},qc=(function(){var e={};return function(t,i){var s=t+"|"+(i||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",i||"")}})(),py=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(a){return[new RegExp("&"+a[0]+";","ig"),a[1]]});return function(t){for(var i=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)i=i.replace(e[s][0],e[s][1]);return i}})(),AS=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),_S=/<\/?(?:vt:)?variant>/g,CS=/<(?:vt:)([^>]*)>([\s\S]*)</;function em(e,a){var t=Et(e),i=e.match(AS(t.baseType))||[],s=[];if(i.length!=t.size){if(a.WTF)throw new Error("unexpected vector length "+i.length+" != "+t.size);return s}return i.forEach(function(c){var f=c.replace(_S,"").match(CS);f&&s.push({v:xa(f[2]),t:f[1]})}),s}var hy=/(^\s|\s$|\n)/;function wr(e,a){return"<"+e+(a.match(hy)?' xml:space="preserve"':"")+">"+a+"</"+e+">"}function Kc(e){return Ua(e).map(function(a){return" "+a+'="'+e[a]+'"'}).join("")}function qe(e,a,t){return"<"+e+(t!=null?Kc(t):"")+(a!=null?(a.match(hy)?' xml:space="preserve"':"")+">"+a+"</"+e:"/")+">"}function Dp(e,a){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(a)throw t}return""}function kS(e,a){switch(typeof e){case"string":var t=qe("vt:lpwstr",fa(e));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return qe((e|0)==e?"vt:i4":"vt:r8",fa(String(e)));case"boolean":return qe("vt:bool",e?"true":"false")}if(e instanceof Date)return qe("vt:filetime",Dp(e));throw new Error("Unable to serialize "+e)}function th(e){if(It&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return xa(el(Vp(e)));throw new Error("Bad input format: expected Buffer or string")}var Qc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,dr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Yl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],An={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function wS(e,a){for(var t=1-2*(e[a+7]>>>7),i=((e[a+7]&127)<<4)+(e[a+6]>>>4&15),s=e[a+6]&15,c=5;c>=0;--c)s=s*256+e[a+c];return i==2047?s==0?t*(1/0):NaN:(i==0?i=-1022:(i-=1023,s+=Math.pow(2,52)),t*Math.pow(2,i-52)*s)}function RS(e,a,t){var i=(a<0||1/a==-1/0?1:0)<<7,s=0,c=0,f=i?-a:a;isFinite(f)?f==0?s=c=0:(s=Math.floor(Math.log(f)/Math.LN2),c=f*Math.pow(2,52-s),s<=-1023&&(!isFinite(c)||c<Math.pow(2,52))?s=-1022:(c-=Math.pow(2,52),s+=1023)):(s=2047,c=isNaN(a)?26985:0);for(var p=0;p<=5;++p,c/=256)e[t+p]=c&255;e[t+6]=(s&15)<<4|c&15,e[t+7]=s>>4|i}var tm=function(e){for(var a=[],t=10240,i=0;i<e[0].length;++i)if(e[0][i])for(var s=0,c=e[0][i].length;s<c;s+=t)a.push.apply(a,e[0][i].slice(s,s+t));return a},am=It?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(a){return Buffer.isBuffer(a)?a:ss(a)})):tm(e)}:tm,rm=function(e,a,t){for(var i=[],s=a;s<t;s+=2)i.push(String.fromCharCode(ts(e,s)));return i.join("").replace(Kr,"")},ah=It?function(e,a,t){return Buffer.isBuffer(e)?e.toString("utf16le",a,t).replace(Kr,""):rm(e,a,t)}:rm,nm=function(e,a,t){for(var i=[],s=a;s<a+t;++s)i.push(("0"+e[s].toString(16)).slice(-2));return i.join("")},gy=It?function(e,a,t){return Buffer.isBuffer(e)?e.toString("hex",a,a+t):nm(e,a,t)}:nm,im=function(e,a,t){for(var i=[],s=a;s<t;s++)i.push(String.fromCharCode(Fo(e,s)));return i.join("")},l0=It?function(a,t,i){return Buffer.isBuffer(a)?a.toString("utf8",t,i):im(a,t,i)}:im,xy=function(e,a){var t=_n(e,a);return t>0?l0(e,a+4,a+4+t-1):""},my=xy,yy=function(e,a){var t=_n(e,a);return t>0?l0(e,a+4,a+4+t-1):""},vy=yy,by=function(e,a){var t=2*_n(e,a);return t>0?l0(e,a+4,a+4+t-1):""},Sy=by,Ey=function(a,t){var i=_n(a,t);return i>0?ah(a,t+4,t+4+i):""},Ty=Ey,Ay=function(e,a){var t=_n(e,a);return t>0?l0(e,a+4,a+4+t):""},_y=Ay,Cy=function(e,a){return wS(e,a)},Qd=Cy,rh=function(a){return Array.isArray(a)||typeof Uint8Array<"u"&&a instanceof Uint8Array};It&&(my=function(a,t){if(!Buffer.isBuffer(a))return xy(a,t);var i=a.readUInt32LE(t);return i>0?a.toString("utf8",t+4,t+4+i-1):""},vy=function(a,t){if(!Buffer.isBuffer(a))return yy(a,t);var i=a.readUInt32LE(t);return i>0?a.toString("utf8",t+4,t+4+i-1):""},Sy=function(a,t){if(!Buffer.isBuffer(a))return by(a,t);var i=2*a.readUInt32LE(t);return a.toString("utf16le",t+4,t+4+i-1)},Ty=function(a,t){if(!Buffer.isBuffer(a))return Ey(a,t);var i=a.readUInt32LE(t);return a.toString("utf16le",t+4,t+4+i)},_y=function(a,t){if(!Buffer.isBuffer(a))return Ay(a,t);var i=a.readUInt32LE(t);return a.toString("utf8",t+4,t+4+i)},Qd=function(a,t){return Buffer.isBuffer(a)?a.readDoubleLE(t):Cy(a,t)},rh=function(a){return Buffer.isBuffer(a)||Array.isArray(a)||typeof Uint8Array<"u"&&a instanceof Uint8Array});var Fo=function(e,a){return e[a]},ts=function(e,a){return e[a+1]*256+e[a]},NS=function(e,a){var t=e[a+1]*256+e[a];return t<32768?t:(65535-t+1)*-1},_n=function(e,a){return e[a+3]*(1<<24)+(e[a+2]<<16)+(e[a+1]<<8)+e[a]},Dl=function(e,a){return e[a+3]<<24|e[a+2]<<16|e[a+1]<<8|e[a]},FS=function(e,a){return e[a]<<24|e[a+1]<<16|e[a+2]<<8|e[a+3]};function Lc(e,a){var t="",i,s,c=[],f,p,g,h;switch(a){case"dbcs":if(h=this.l,It&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(g=0;g<e;++g)t+=String.fromCharCode(ts(this,h)),h+=2;e*=2;break;case"utf8":t=l0(this,this.l,this.l+e);break;case"utf16le":e*=2,t=ah(this,this.l,this.l+e);break;case"wstr":return Lc.call(this,e,"dbcs");case"lpstr-ansi":t=my(this,this.l),e=4+_n(this,this.l);break;case"lpstr-cp":t=vy(this,this.l),e=4+_n(this,this.l);break;case"lpwstr":t=Sy(this,this.l),e=4+2*_n(this,this.l);break;case"lpp4":e=4+_n(this,this.l),t=Ty(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+_n(this,this.l),t=_y(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(f=Fo(this,this.l+e++))!==0;)c.push(Id(f));t=c.join("");break;case"_wstr":for(e=0,t="";(f=ts(this,this.l+e))!==0;)c.push(Id(f)),e+=2;e+=2,t=c.join("");break;case"dbcs-cont":for(t="",h=this.l,g=0;g<e;++g){if(this.lens&&this.lens.indexOf(h)!==-1)return f=Fo(this,h),this.l=h+1,p=Lc.call(this,e-g,f?"dbcs-cont":"sbcs-cont"),c.join("")+p;c.push(Id(ts(this,h))),h+=2}t=c.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",h=this.l,g=0;g!=e;++g){if(this.lens&&this.lens.indexOf(h)!==-1)return f=Fo(this,h),this.l=h+1,p=Lc.call(this,e-g,f?"dbcs-cont":"sbcs-cont"),c.join("")+p;c.push(Id(Fo(this,h))),h+=1}t=c.join("");break;default:switch(e){case 1:return i=Fo(this,this.l),this.l++,i;case 2:return i=(a==="i"?NS:ts)(this,this.l),this.l+=2,i;case 4:case-4:return a==="i"||(this[this.l+3]&128)===0?(i=(e>0?Dl:FS)(this,this.l),this.l+=4,i):(s=_n(this,this.l),this.l+=4,s);case 8:case-8:if(a==="f")return e==8?s=Qd(this,this.l):s=Qd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:t=gy(this,this.l,e);break}}return this.l+=e,t}var DS=function(e,a,t){e[t]=a&255,e[t+1]=a>>>8&255,e[t+2]=a>>>16&255,e[t+3]=a>>>24&255},jS=function(e,a,t){e[t]=a&255,e[t+1]=a>>8&255,e[t+2]=a>>16&255,e[t+3]=a>>24&255},OS=function(e,a,t){e[t]=a&255,e[t+1]=a>>>8&255};function IS(e,a,t){var i=0,s=0;if(t==="dbcs"){for(s=0;s!=a.length;++s)OS(this,a.charCodeAt(s),this.l+2*s);i=2*a.length}else if(t==="sbcs"){for(a=a.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=a.length;++s)this[this.l+s]=a.charCodeAt(s)&255;i=a.length}else if(t==="hex"){for(;s<e;++s)this[this.l++]=parseInt(a.slice(2*s,2*s+2),16)||0;return this}else if(t==="utf16le"){var c=Math.min(this.l+e,this.length);for(s=0;s<Math.min(a.length,e);++s){var f=a.charCodeAt(s);this[this.l++]=f&255,this[this.l++]=f>>8}for(;this.l<c;)this[this.l++]=0;return this}else switch(e){case 1:i=1,this[this.l]=a&255;break;case 2:i=2,this[this.l]=a&255,a>>>=8,this[this.l+1]=a&255;break;case 3:i=3,this[this.l]=a&255,a>>>=8,this[this.l+1]=a&255,a>>>=8,this[this.l+2]=a&255;break;case 4:i=4,DS(this,a,this.l);break;case 8:if(i=8,t==="f"){RS(this,a,this.l);break}case 16:break;case-4:i=4,jS(this,a,this.l);break}return this.l+=i,this}function ky(e,a){var t=gy(this,this.l,e.length>>1);if(t!==e)throw new Error(a+"Expected "+e+" saw "+t);this.l+=e.length>>1}function kr(e,a){e.l=a,e.read_shift=Lc,e.chk=ky,e.write_shift=IS}function Hr(e,a){e.l+=a}function Ne(e){var a=Ks(e);return kr(a,0),a}function ls(e,a,t){if(e){var i,s,c;kr(e,e.l||0);for(var f=e.length,p=0,g=0;e.l<f;){p=e.read_shift(1),p&128&&(p=(p&127)+((e.read_shift(1)&127)<<7));var h=r0[p]||r0[65535];for(i=e.read_shift(1),c=i&127,s=1;s<4&&i&128;++s)c+=((i=e.read_shift(1))&127)<<7*s;g=e.l+c;var E=h.f&&h.f(e,c,t);if(e.l=g,a(E,h,p))return}}}function fn(){var e=[],a=It?256:2048,t=function(h){var E=Ne(h);return kr(E,0),E},i=t(a),s=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&e.push(i),i=null)},c=function(h){return i&&h<i.length-i.l?i:(s(),i=t(Math.max(h+1,a)))},f=function(){return s(),yr(e)},p=function(h){s(),i=h,i.l==null&&(i.l=i.length),c(a)};return{next:c,push:p,end:f,_bufs:e}}function $e(e,a,t,i){var s=+a,c;if(!isNaN(s)){i||(i=r0[s].p||(t||[]).length||0),c=1+(s>=128?1:0)+1,i>=128&&++c,i>=16384&&++c,i>=2097152&&++c;var f=e.next(c);s<=127?f.write_shift(1,s):(f.write_shift(1,(s&127)+128),f.write_shift(1,s>>7));for(var p=0;p!=4;++p)if(i>=128)f.write_shift(1,(i&127)+128),i>>=7;else{f.write_shift(1,i);break}i>0&&rh(t)&&e.push(t)}}function Pc(e,a,t){var i=wa(e);if(a.s?(i.cRel&&(i.c+=a.s.c),i.rRel&&(i.r+=a.s.r)):(i.cRel&&(i.c+=a.c),i.rRel&&(i.r+=a.r)),!t||t.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function sm(e,a,t){var i=wa(e);return i.s=Pc(i.s,a.s,t),i.e=Pc(i.e,a.s,t),i}function zc(e,a){if(e.cRel&&e.c<0)for(e=wa(e);e.c<0;)e.c+=a>8?16384:256;if(e.rRel&&e.r<0)for(e=wa(e);e.r<0;)e.r+=a>8?1048576:a>5?65536:16384;var t=bt(e);return!e.cRel&&e.cRel!=null&&(t=LS(t)),!e.rRel&&e.rRel!=null&&(t=BS(t)),t}function vp(e,a){return e.s.r==0&&!e.s.rRel&&e.e.r==(a.biff>=12?1048575:a.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ja(e.s.c)+":"+(e.e.cRel?"":"$")+ja(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(a.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Xa(e.s.r)+":"+(e.e.rRel?"":"$")+Xa(e.e.r):zc(e.s,a.biff)+":"+zc(e.e,a.biff)}function nh(e){return parseInt(MS(e),10)-1}function Xa(e){return""+(e+1)}function BS(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function MS(e){return e.replace(/\$(\d+)$/,"$1")}function ih(e){for(var a=PS(e),t=0,i=0;i!==a.length;++i)t=26*t+a.charCodeAt(i)-64;return t-1}function ja(e){if(e<0)throw new Error("invalid column "+e);var a="";for(++e;e;e=Math.floor((e-1)/26))a=String.fromCharCode((e-1)%26+65)+a;return a}function LS(e){return e.replace(/^([A-Z])/,"$$$1")}function PS(e){return e.replace(/^\$([A-Z])/,"$1")}function zS(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Oa(e){for(var a=0,t=0,i=0;i<e.length;++i){var s=e.charCodeAt(i);s>=48&&s<=57?a=10*a+(s-48):s>=65&&s<=90&&(t=26*t+(s-64))}return{c:t-1,r:a-1}}function bt(e){for(var a=e.c+1,t="";a;a=(a-1)/26|0)t=String.fromCharCode((a-1)%26+65)+t;return t+(e.r+1)}function un(e){var a=e.indexOf(":");return a==-1?{s:Oa(e),e:Oa(e)}:{s:Oa(e.slice(0,a)),e:Oa(e.slice(a+1))}}function wt(e,a){return typeof a>"u"||typeof a=="number"?wt(e.s,e.e):(typeof e!="string"&&(e=bt(e)),typeof a!="string"&&(a=bt(a)),e==a?e:e+":"+a)}function Qt(e){var a={s:{c:0,r:0},e:{c:0,r:0}},t=0,i=0,s=0,c=e.length;for(t=0;i<c&&!((s=e.charCodeAt(i)-64)<1||s>26);++i)t=26*t+s;for(a.s.c=--t,t=0;i<c&&!((s=e.charCodeAt(i)-48)<0||s>9);++i)t=10*t+s;if(a.s.r=--t,i===c||s!=10)return a.e.c=a.s.c,a.e.r=a.s.r,a;for(++i,t=0;i!=c&&!((s=e.charCodeAt(i)-64)<1||s>26);++i)t=26*t+s;for(a.e.c=--t,t=0;i!=c&&!((s=e.charCodeAt(i)-48)<0||s>9);++i)t=10*t+s;return a.e.r=--t,a}function lm(e,a){var t=e.t=="d"&&a instanceof Date;if(e.z!=null)try{return e.w=qn(e.z,t?fr(a):a)}catch{}try{return e.w=qn((e.XF||{}).numFmtId||(t?14:0),t?fr(a):a)}catch{return""+a}}function is(e,a,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?os[e.v]||e.v:a==null?lm(e,e.v):lm(e,a))}function tl(e,a){var t=a&&a.sheet?a.sheet:"Sheet1",i={};return i[t]=e,{SheetNames:[t],Sheets:i}}function wy(e,a,t){var i=t||{},s=e?Array.isArray(e):i.dense,c=e||(s?[]:{}),f=0,p=0;if(c&&i.origin!=null){if(typeof i.origin=="number")f=i.origin;else{var g=typeof i.origin=="string"?Oa(i.origin):i.origin;f=g.r,p=g.c}c["!ref"]||(c["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(c["!ref"]){var E=Qt(c["!ref"]);h.s.c=E.s.c,h.s.r=E.s.r,h.e.c=Math.max(h.e.c,E.e.c),h.e.r=Math.max(h.e.r,E.e.r),f==-1&&(h.e.r=f=E.e.r+1)}for(var A=0;A!=a.length;++A)if(a[A]){if(!Array.isArray(a[A]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=a[A].length;++_)if(!(typeof a[A][_]>"u")){var w={v:a[A][_]},N=f+A,k=p+_;if(h.s.r>N&&(h.s.r=N),h.s.c>k&&(h.s.c=k),h.e.r<N&&(h.e.r=N),h.e.c<k&&(h.e.c=k),a[A][_]&&typeof a[A][_]=="object"&&!Array.isArray(a[A][_])&&!(a[A][_]instanceof Date))w=a[A][_];else if(Array.isArray(w.v)&&(w.f=a[A][_][1],w.v=w.v[0]),w.v===null)if(w.f)w.t="n";else if(i.nullError)w.t="e",w.v=0;else if(i.sheetStubs)w.t="z";else continue;else typeof w.v=="number"?w.t="n":typeof w.v=="boolean"?w.t="b":w.v instanceof Date?(w.z=i.dateNF||mt[14],i.cellDates?(w.t="d",w.w=qn(w.z,fr(w.v))):(w.t="n",w.v=fr(w.v),w.w=qn(w.z,w.v))):w.t="s";if(s)c[N]||(c[N]=[]),c[N][k]&&c[N][k].z&&(w.z=c[N][k].z),c[N][k]=w;else{var F=bt({c:k,r:N});c[F]&&c[F].z&&(w.z=c[F].z),c[F]=w}}}return h.s.c<1e7&&(c["!ref"]=wt(h)),c}function Ho(e,a){return wy(null,e,a)}function US(e){return e.read_shift(4,"i")}function mi(e,a){return a||(a=Ne(4)),a.write_shift(4,e),a}function Ur(e){var a=e.read_shift(4);return a===0?"":e.read_shift(a,"dbcs")}function vr(e,a){var t=!1;return a==null&&(t=!0,a=Ne(4+2*e.length)),a.write_shift(4,e.length),e.length>0&&a.write_shift(0,e,"dbcs"),t?a.slice(0,a.l):a}function HS(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function $S(e,a){return a||(a=Ne(4)),a.write_shift(2,0),a.write_shift(2,0),a}function sh(e,a){var t=e.l,i=e.read_shift(1),s=Ur(e),c=[],f={t:s,h:s};if((i&1)!==0){for(var p=e.read_shift(4),g=0;g!=p;++g)c.push(HS(e));f.r=c}else f.r=[{ich:0,ifnt:0}];return e.l=t+a,f}function YS(e,a){var t=!1;return a==null&&(t=!0,a=Ne(15+4*e.t.length)),a.write_shift(1,0),vr(e.t,a),t?a.slice(0,a.l):a}var GS=sh;function WS(e,a){var t=!1;return a==null&&(t=!0,a=Ne(23+4*e.t.length)),a.write_shift(1,1),vr(e.t,a),a.write_shift(4,1),$S({},a),t?a.slice(0,a.l):a}function Kn(e){var a=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:a,iStyleRef:t}}function Gl(e,a){return a==null&&(a=Ne(8)),a.write_shift(-4,e.c),a.write_shift(3,e.iStyleRef||e.s),a.write_shift(1,0),a}function Wl(e){var a=e.read_shift(2);return a+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:a}}function Vl(e,a){return a==null&&(a=Ne(4)),a.write_shift(3,e.iStyleRef||e.s),a.write_shift(1,0),a}var VS=Ur,Ry=vr;function lh(e){var a=e.read_shift(4);return a===0||a===4294967295?"":e.read_shift(a,"dbcs")}function Jd(e,a){var t=!1;return a==null&&(t=!0,a=Ne(127)),a.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&a.write_shift(0,e,"dbcs"),t?a.slice(0,a.l):a}var XS=Ur,jp=lh,oh=Jd;function ch(e){var a=e.slice(e.l,e.l+4),t=a[0]&1,i=a[0]&2;e.l+=4;var s=i===0?Qd([0,0,0,0,a[0]&252,a[1],a[2],a[3]],0):Dl(a,0)>>2;return t?s/100:s}function Ny(e,a){a==null&&(a=Ne(4));var t=0,i=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?i=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(i=1,t=1),i)a.write_shift(-4,((t?s:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function Fy(e){var a={s:{},e:{}};return a.s.r=e.read_shift(4),a.e.r=e.read_shift(4),a.s.c=e.read_shift(4),a.e.c=e.read_shift(4),a}function qS(e,a){return a||(a=Ne(16)),a.write_shift(4,e.s.r),a.write_shift(4,e.e.r),a.write_shift(4,e.s.c),a.write_shift(4,e.e.c),a}var Xl=Fy,$o=qS;function zr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function zl(e,a){return(a||Ne(8)).write_shift(8,e,"f")}function KS(e){var a={},t=e.read_shift(1),i=t>>>1,s=e.read_shift(1),c=e.read_shift(2,"i"),f=e.read_shift(1),p=e.read_shift(1),g=e.read_shift(1);switch(e.l++,i){case 0:a.auto=1;break;case 1:a.index=s;var h=Ol[s];h&&(a.rgb=Zc(h));break;case 2:a.rgb=Zc([f,p,g]);break;case 3:a.theme=s;break}return c!=0&&(a.tint=c>0?c/32767:c/32768),a}function Zd(e,a){if(a||(a=Ne(8)),!e||e.auto)return a.write_shift(4,0),a.write_shift(4,0),a;e.index!=null?(a.write_shift(1,2),a.write_shift(1,e.index)):e.theme!=null?(a.write_shift(1,6),a.write_shift(1,e.theme)):(a.write_shift(1,5),a.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),a.write_shift(2,t),!e.rgb||e.theme!=null)a.write_shift(2,0),a.write_shift(1,0),a.write_shift(1,0);else{var i=e.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),a.write_shift(1,parseInt(i.slice(0,2),16)),a.write_shift(1,parseInt(i.slice(2,4),16)),a.write_shift(1,parseInt(i.slice(4,6),16)),a.write_shift(1,255)}return a}function QS(e){var a=e.read_shift(1);e.l++;var t={fBold:a&1,fItalic:a&2,fUnderline:a&4,fStrikeout:a&8,fOutline:a&16,fShadow:a&32,fCondense:a&64,fExtend:a&128};return t}function JS(e,a){a||(a=Ne(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return a.write_shift(1,t),a.write_shift(1,0),a}function Dy(e,a){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},i=e.read_shift(4);switch(i){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(i>400)throw new Error("Unsupported Clipboard: "+i.toString(16));return e.l-=4,e.read_shift(0,a==1?"lpstr":"lpwstr")}function ZS(e){return Dy(e,1)}function eE(e){return Dy(e,2)}var dh=2,dn=3,Md=11,om=12,ef=19,Ld=64,tE=65,aE=71,rE=4108,nE=4126,mr=80,jy=81,iE=[mr,jy],Op={1:{n:"CodePage",t:dh},2:{n:"Category",t:mr},3:{n:"PresentationFormat",t:mr},4:{n:"ByteCount",t:dn},5:{n:"LineCount",t:dn},6:{n:"ParagraphCount",t:dn},7:{n:"SlideCount",t:dn},8:{n:"NoteCount",t:dn},9:{n:"HiddenCount",t:dn},10:{n:"MultimediaClipCount",t:dn},11:{n:"ScaleCrop",t:Md},12:{n:"HeadingPairs",t:rE},13:{n:"TitlesOfParts",t:nE},14:{n:"Manager",t:mr},15:{n:"Company",t:mr},16:{n:"LinksUpToDate",t:Md},17:{n:"CharacterCount",t:dn},19:{n:"SharedDoc",t:Md},22:{n:"HyperlinksChanged",t:Md},23:{n:"AppVersion",t:dn,p:"version"},24:{n:"DigSig",t:tE},26:{n:"ContentType",t:mr},27:{n:"ContentStatus",t:mr},28:{n:"Language",t:mr},29:{n:"Version",t:mr},255:{},2147483648:{n:"Locale",t:ef},2147483651:{n:"Behavior",t:ef},1919054434:{}},Ip={1:{n:"CodePage",t:dh},2:{n:"Title",t:mr},3:{n:"Subject",t:mr},4:{n:"Author",t:mr},5:{n:"Keywords",t:mr},6:{n:"Comments",t:mr},7:{n:"Template",t:mr},8:{n:"LastAuthor",t:mr},9:{n:"RevNumber",t:mr},10:{n:"EditTime",t:Ld},11:{n:"LastPrinted",t:Ld},12:{n:"CreatedDate",t:Ld},13:{n:"ModifiedDate",t:Ld},14:{n:"PageCount",t:dn},15:{n:"WordCount",t:dn},16:{n:"CharCount",t:dn},17:{n:"Thumbnail",t:aE},18:{n:"Application",t:mr},19:{n:"DocSecurity",t:dn},255:{},2147483648:{n:"Locale",t:ef},2147483651:{n:"Behavior",t:ef},1919054434:{}},cm={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},sE=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function lE(e){return e.map(function(a){return[a>>16&255,a>>8&255,a&255]})}var oE=lE([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ol=wa(oE),os={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Oy={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Bp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Pd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function fh(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function cE(e){var a=fh();if(!e||!e.match)return a;var t={};if((e.match($r)||[]).forEach(function(i){var s=Et(i);switch(s[0].replace(vS,"<")){case"<?xml":break;case"<Types":a.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[s.Extension]=s.ContentType;break;case"<Override":a[Bp[s.ContentType]]!==void 0&&a[Bp[s.ContentType]].push(s.PartName);break}}),a.xmlns!==dr.CT)throw new Error("Unknown Namespace: "+a.xmlns);return a.calcchain=a.calcchains.length>0?a.calcchains[0]:"",a.sst=a.strs.length>0?a.strs[0]:"",a.style=a.styles.length>0?a.styles[0]:"",a.defaults=t,delete a.calcchains,a}function Iy(e,a){var t=cS(Bp),i=[],s;i[i.length]=qa,i[i.length]=qe("Types",null,{xmlns:dr.CT,"xmlns:xsd":dr.xsd,"xmlns:xsi":dr.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(g){return qe("Default",null,{Extension:g[0],ContentType:g[1]})}));var c=function(g){e[g]&&e[g].length>0&&(s=e[g][0],i[i.length]=qe("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Pd[g][a.bookType]||Pd[g].xlsx}))},f=function(g){(e[g]||[]).forEach(function(h){i[i.length]=qe("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:Pd[g][a.bookType]||Pd[g].xlsx})})},p=function(g){(e[g]||[]).forEach(function(h){i[i.length]=qe("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:t[g][0]})})};return c("workbooks"),f("sheets"),f("charts"),p("themes"),["strs","styles"].forEach(c),["coreprops","extprops","custprops"].forEach(p),p("vba"),p("comments"),p("threadedcomments"),p("drawings"),f("metadata"),p("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var Bt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Jc(e){var a=e.lastIndexOf("/");return e.slice(0,a+1)+"_rels/"+e.slice(a+1)+".rels"}function Uc(e,a){var t={"!id":{}};if(!e)return t;a.charAt(0)!=="/"&&(a="/"+a);var i={};return(e.match($r)||[]).forEach(function(s){var c=Et(s);if(c[0]==="<Relationship"){var f={};f.Type=c.Type,f.Target=c.Target,f.Id=c.Id,c.TargetMode&&(f.TargetMode=c.TargetMode);var p=c.TargetMode==="External"?c.Target:Mc(c.Target,a);t[p]=f,i[c.Id]=f}}),t["!id"]=i,t}function Oo(e){var a=[qa,qe("Relationships",null,{xmlns:dr.RELS})];return Ua(e["!id"]).forEach(function(t){a[a.length]=qe("Relationship",null,e["!id"][t])}),a.length>2&&(a[a.length]="</Relationships>",a[1]=a[1].replace("/>",">")),a.join("")}function da(e,a,t,i,s,c){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),a<0)for(a=e["!idx"];e["!id"]["rId"+a];++a);if(e["!idx"]=a+1,s.Id="rId"+a,s.Type=i,s.Target=t,[Bt.HLINK,Bt.XPATH,Bt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+a);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,a}var dE="application/vnd.oasis.opendocument.spreadsheet";function fE(e,a){for(var t=th(e),i,s;i=Qc.exec(t);)switch(i[3]){case"manifest":break;case"file-entry":if(s=Et(i[0],!1),s.path=="/"&&s.type!==dE)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(a&&a.WTF)throw i}}function uE(e){var a=[qa];a.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),a.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)a.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return a.push("</manifest:manifest>"),a.join("")}function dm(e,a,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+a+`"/>
`,`  </rdf:Description>
`].join("")}function pE(e,a){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+a+`"/>
`,`  </rdf:Description>
`].join("")}function hE(e){var a=[qa];a.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)a.push(dm(e[t][0],e[t][1])),a.push(pE("",e[t][0]));return a.push(dm("","Document","pkg")),a.push("</rdf:RDF>"),a.join("")}function By(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Wd.version+"</meta:generator></office:meta></office:document-meta>"}var Xn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],gE=(function(){for(var e=new Array(Xn.length),a=0;a<Xn.length;++a){var t=Xn[a],i="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[a]=new RegExp("<"+i+"[^>]*>([\\s\\S]*?)</"+i+">")}return e})();function My(e){var a={};e=xa(e);for(var t=0;t<Xn.length;++t){var i=Xn[t],s=e.match(gE[t]);s!=null&&s.length>0&&(a[i[1]]=Kt(s[1])),i[2]==="date"&&a[i[1]]&&(a[i[1]]=ka(a[i[1]]))}return a}function bp(e,a,t,i,s){s[e]!=null||a==null||a===""||(s[e]=a,a=fa(a),i[i.length]=t?qe(e,a,t):wr(e,a))}function Ly(e,a){var t=a||{},i=[qa,qe("cp:coreProperties",null,{"xmlns:cp":dr.CORE_PROPS,"xmlns:dc":dr.dc,"xmlns:dcterms":dr.dcterms,"xmlns:dcmitype":dr.dcmitype,"xmlns:xsi":dr.xsi})],s={};if(!e&&!t.Props)return i.join("");e&&(e.CreatedDate!=null&&bp("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Dp(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,s),e.ModifiedDate!=null&&bp("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Dp(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},i,s));for(var c=0;c!=Xn.length;++c){var f=Xn[c],p=t.Props&&t.Props[f[1]]!=null?t.Props[f[1]]:e?e[f[1]]:null;p===!0?p="1":p===!1?p="0":typeof p=="number"&&(p=String(p)),p!=null&&bp(f[0],p,null,i,s)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var Il=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Py=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function zy(e,a,t,i){var s=[];if(typeof e=="string")s=em(e,i);else for(var c=0;c<e.length;++c)s=s.concat(e[c].map(function(E){return{v:E}}));var f=typeof a=="string"?em(a,i).map(function(E){return E.v}):a,p=0,g=0;if(f.length>0)for(var h=0;h!==s.length;h+=2){switch(g=+s[h+1].v,s[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=g,t.SheetNames=f.slice(p,p+g);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=g,t.DefinedNames=f.slice(p,p+g);break;case"Charts":case"Diagramme":t.Chartsheets=g,t.ChartNames=f.slice(p,p+g);break}p+=g}}function xE(e,a,t){var i={};return a||(a={}),e=xa(e),Il.forEach(function(s){var c=(e.match(qc(s[0]))||[])[1];switch(s[2]){case"string":c&&(a[s[1]]=Kt(c));break;case"bool":a[s[1]]=c==="true";break;case"raw":var f=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));f&&f.length>0&&(i[s[1]]=f[1]);break}}),i.HeadingPairs&&i.TitlesOfParts&&zy(i.HeadingPairs,i.TitlesOfParts,a,t),a}function Uy(e){var a=[],t=qe;return e||(e={}),e.Application="SheetJS",a[a.length]=qa,a[a.length]=qe("Properties",null,{xmlns:dr.EXT_PROPS,"xmlns:vt":dr.vt}),Il.forEach(function(i){if(e[i[1]]!==void 0){var s;switch(i[2]){case"string":s=fa(String(e[i[1]]));break;case"bool":s=e[i[1]]?"true":"false";break}s!==void 0&&(a[a.length]=t(i[0],s))}}),a[a.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),a[a.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(i){return"<vt:lpstr>"+fa(i)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),a.length>2&&(a[a.length]="</Properties>",a[1]=a[1].replace("/>",">")),a.join("")}var mE=/<[^>]+>[^<]*/g;function yE(e,a){var t={},i="",s=e.match(mE);if(s)for(var c=0;c!=s.length;++c){var f=s[c],p=Et(f);switch(p[0]){case"<?xml":break;case"<Properties":break;case"<property":i=Kt(p.name);break;case"</property>":i=null;break;default:if(f.indexOf("<vt:")===0){var g=f.split(">"),h=g[0].slice(4),E=g[1];switch(h){case"lpstr":case"bstr":case"lpwstr":t[i]=Kt(E);break;case"bool":t[i]=Ca(E);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[i]=parseInt(E,10);break;case"r4":case"r8":case"decimal":t[i]=parseFloat(E);break;case"filetime":case"date":t[i]=ka(E);break;case"cy":case"error":t[i]=Kt(E);break;default:if(h.slice(-1)=="/")break;a.WTF&&typeof console<"u"&&console.warn("Unexpected",f,h,g)}}else if(f.slice(0,2)!=="</"){if(a.WTF)throw new Error(f)}}}return t}function Hy(e){var a=[qa,qe("Properties",null,{xmlns:dr.CUST_PROPS,"xmlns:vt":dr.vt})];if(!e)return a.join("");var t=1;return Ua(e).forEach(function(s){++t,a[a.length]=qe("property",kS(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:fa(s)})}),a.length>2&&(a[a.length]="</Properties>",a[1]=a[1].replace("/>",">")),a.join("")}var Mp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Sp;function vE(e,a,t){Sp||(Sp=cf(Mp)),a=Sp[a]||a,e[a]=t}function bE(e,a){var t=[];return Ua(Mp).map(function(i){for(var s=0;s<Xn.length;++s)if(Xn[s][1]==i)return Xn[s];for(s=0;s<Il.length;++s)if(Il[s][1]==i)return Il[s];throw i}).forEach(function(i){if(e[i[1]]!=null){var s=a&&a.Props&&a.Props[i[1]]!=null?a.Props[i[1]]:e[i[1]];i[2]==="date"&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"Z")),typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),t.push(wr(Mp[i[1]]||i[1],s))}}),qe("DocumentProperties",t.join(""),{xmlns:An.o})}function SE(e,a){var t=["Worksheets","SheetNames"],i="CustomDocumentProperties",s=[];return e&&Ua(e).forEach(function(c){if(Object.prototype.hasOwnProperty.call(e,c)){for(var f=0;f<Xn.length;++f)if(c==Xn[f][1])return;for(f=0;f<Il.length;++f)if(c==Il[f][1])return;for(f=0;f<t.length;++f)if(c==t[f])return;var p=e[c],g="string";typeof p=="number"?(g="float",p=String(p)):p===!0||p===!1?(g="boolean",p=p?"1":"0"):p=String(p),s.push(qe(Kx(c),p,{"dt:dt":g}))}}),a&&Ua(a).forEach(function(c){if(Object.prototype.hasOwnProperty.call(a,c)&&!(e&&Object.prototype.hasOwnProperty.call(e,c))){var f=a[c],p="string";typeof f=="number"?(p="float",f=String(f)):f===!0||f===!1?(p="boolean",f=f?"1":"0"):f instanceof Date?(p="dateTime.tz",f=f.toISOString()):f=String(f),s.push(qe(Kx(c),f,{"dt:dt":p}))}}),"<"+i+' xmlns="'+An.o+'">'+s.join("")+"</"+i+">"}function uh(e){var a=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+a/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function EE(e){var a=typeof e=="string"?new Date(Date.parse(e)):e,t=a.getTime()/1e3+11644473600,i=t%Math.pow(2,32),s=(t-i)/Math.pow(2,32);i*=1e7,s*=1e7;var c=i/Math.pow(2,32)|0;c>0&&(i=i%Math.pow(2,32),s+=c);var f=Ne(8);return f.write_shift(4,i),f.write_shift(4,s),f}function $y(e,a,t){var i=e.l,s=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-i&3;)++e.l;return s}function Yy(e,a,t){var i=e.read_shift(0,"lpwstr");return i}function Gy(e,a,t){return a===31?Yy(e):$y(e,a,t)}function Lp(e,a,t){return Gy(e,a,t===!1?0:4)}function TE(e,a){if(!a)throw new Error("VtUnalignedString must have positive length");return Gy(e,a,0)}function AE(e){for(var a=e.read_shift(4),t=[],i=0;i!=a;++i){var s=e.l;t[i]=e.read_shift(0,"lpwstr").replace(Kr,""),e.l-s&2&&(e.l+=2)}return t}function _E(e){for(var a=e.read_shift(4),t=[],i=0;i!=a;++i)t[i]=e.read_shift(0,"lpstr-cp").replace(Kr,"");return t}function CE(e){var a=e.l,t=tf(e,jy);e[e.l]==0&&e[e.l+1]==0&&e.l-a&2&&(e.l+=2);var i=tf(e,dn);return[t,i]}function kE(e){for(var a=e.read_shift(4),t=[],i=0;i<a/2;++i)t.push(CE(e));return t}function fm(e,a){for(var t=e.read_shift(4),i={},s=0;s!=t;++s){var c=e.read_shift(4),f=e.read_shift(4);i[c]=e.read_shift(f,a===1200?"utf16le":"utf8").replace(Kr,"").replace(Bc,"!"),a===1200&&f%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),i}function Wy(e){var a=e.read_shift(4),t=e.slice(e.l,e.l+a);return e.l+=a,(a&3)>0&&(e.l+=4-(a&3)&3),t}function wE(e){var a={};return a.Size=e.read_shift(4),e.l+=a.Size+3-(a.Size-1)%4,a}function tf(e,a,t){var i=e.read_shift(2),s,c=t||{};if(e.l+=2,a!==om&&i!==a&&iE.indexOf(a)===-1&&!((a&65534)==4126&&(i&65534)==4126))throw new Error("Expected type "+a+" saw "+i);switch(a===om?i:a){case 2:return s=e.read_shift(2,"i"),c.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return $y(e,i,4).replace(Kr,"");case 31:return Yy(e);case 64:return uh(e);case 65:return Wy(e);case 71:return wE(e);case 80:return Lp(e,i,!c.raw).replace(Kr,"");case 81:return TE(e,i).replace(Kr,"");case 4108:return kE(e);case 4126:case 4127:return i==4127?AE(e):_E(e);default:throw new Error("TypedPropertyValue unrecognized type "+a+" "+i)}}function um(e,a){var t=Ne(4),i=Ne(4);switch(t.write_shift(4,e==80?31:e),e){case 3:i.write_shift(-4,a);break;case 5:i=Ne(8),i.write_shift(8,a,"f");break;case 11:i.write_shift(4,a?1:0);break;case 64:i=EE(a);break;case 31:case 80:for(i=Ne(4+2*(a.length+1)+(a.length%2?0:2)),i.write_shift(4,a.length+1),i.write_shift(0,a,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+a)}return yr([t,i])}function pm(e,a){var t=e.l,i=e.read_shift(4),s=e.read_shift(4),c=[],f=0,p=0,g=-1,h={};for(f=0;f!=s;++f){var E=e.read_shift(4),A=e.read_shift(4);c[f]=[E,A+t]}c.sort(function(K,M){return K[1]-M[1]});var _={};for(f=0;f!=s;++f){if(e.l!==c[f][1]){var w=!0;if(f>0&&a)switch(a[c[f-1][0]].t){case 2:e.l+2===c[f][1]&&(e.l+=2,w=!1);break;case 80:e.l<=c[f][1]&&(e.l=c[f][1],w=!1);break;case 4108:e.l<=c[f][1]&&(e.l=c[f][1],w=!1);break}if((!a||f==0)&&e.l<=c[f][1]&&(w=!1,e.l=c[f][1]),w)throw new Error("Read Error: Expected address "+c[f][1]+" at "+e.l+" :"+f)}if(a){var N=a[c[f][0]];if(_[N.n]=tf(e,N.t,{raw:!0}),N.p==="version"&&(_[N.n]=String(_[N.n]>>16)+"."+("0000"+String(_[N.n]&65535)).slice(-4)),N.n=="CodePage")switch(_[N.n]){case 0:_[N.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:hi(p=_[N.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[N.n])}}else if(c[f][0]===1){if(p=_.CodePage=tf(e,dh),hi(p),g!==-1){var k=e.l;e.l=c[g][1],h=fm(e,p),e.l=k}}else if(c[f][0]===0){if(p===0){g=f,e.l=c[f+1][1];continue}h=fm(e,p)}else{var F=h[c[f][0]],z;switch(e[e.l]){case 65:e.l+=4,z=Wy(e);break;case 30:e.l+=4,z=Lp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,z=Lp(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,z=e.read_shift(4,"i");break;case 19:e.l+=4,z=e.read_shift(4);break;case 5:e.l+=4,z=e.read_shift(8,"f");break;case 11:e.l+=4,z=Va(e,4);break;case 64:e.l+=4,z=ka(uh(e));break;default:throw new Error("unparsed value: "+e[e.l])}_[F]=z}}return e.l=t+i,_}var Vy=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function RE(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function hm(e,a,t){var i=Ne(8),s=[],c=[],f=8,p=0,g=Ne(8),h=Ne(8);if(g.write_shift(4,2),g.write_shift(4,1200),h.write_shift(4,1),c.push(g),s.push(h),f+=8+g.length,!a){h=Ne(8),h.write_shift(4,0),s.unshift(h);var E=[Ne(4)];for(E[0].write_shift(4,e.length),p=0;p<e.length;++p){var A=e[p][0];for(g=Ne(8+2*(A.length+1)+(A.length%2?0:2)),g.write_shift(4,p+2),g.write_shift(4,A.length+1),g.write_shift(0,A,"dbcs");g.l!=g.length;)g.write_shift(1,0);E.push(g)}g=yr(E),c.unshift(g),f+=8+g.length}for(p=0;p<e.length;++p)if(!(a&&!a[e[p][0]])&&!(Vy.indexOf(e[p][0])>-1||Py.indexOf(e[p][0])>-1)&&e[p][1]!=null){var _=e[p][1],w=0;if(a){w=+a[e[p][0]];var N=t[w];if(N.p=="version"&&typeof _=="string"){var k=_.split(".");_=(+k[0]<<16)+(+k[1]||0)}g=um(N.t,_)}else{var F=RE(_);F==-1&&(F=31,_=String(_)),g=um(F,_)}c.push(g),h=Ne(8),h.write_shift(4,a?w:2+p),s.push(h),f+=8+g.length}var z=8*(c.length+1);for(p=0;p<c.length;++p)s[p].write_shift(4,z),z+=c[p].length;return i.write_shift(4,f),i.write_shift(4,c.length),yr([i].concat(s).concat(c))}function gm(e,a,t){var i=e.content;if(!i)return{};kr(i,0);var s,c,f,p,g=0;i.chk("feff","Byte Order: "),i.read_shift(2);var h=i.read_shift(4),E=i.read_shift(16);if(E!==ht.utils.consts.HEADER_CLSID&&E!==t)throw new Error("Bad PropertySet CLSID "+E);if(s=i.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(c=i.read_shift(16),p=i.read_shift(4),s===1&&p!==i.l)throw new Error("Length mismatch: "+p+" !== "+i.l);s===2&&(f=i.read_shift(16),g=i.read_shift(4));var A=pm(i,a),_={SystemIdentifier:h};for(var w in A)_[w]=A[w];if(_.FMTID=c,s===1)return _;if(g-i.l==2&&(i.l+=2),i.l!==g)throw new Error("Length mismatch 2: "+i.l+" !== "+g);var N;try{N=pm(i,null)}catch{}for(w in N)_[w]=N[w];return _.FMTID=[c,f],_}function xm(e,a,t,i,s,c){var f=Ne(s?68:48),p=[f];f.write_shift(2,65534),f.write_shift(2,0),f.write_shift(4,842412599),f.write_shift(16,ht.utils.consts.HEADER_CLSID,"hex"),f.write_shift(4,s?2:1),f.write_shift(16,a,"hex"),f.write_shift(4,s?68:48);var g=hm(e,t,i);if(p.push(g),s){var h=hm(s,null,null);f.write_shift(16,c,"hex"),f.write_shift(4,68+g.length),p.push(h)}return yr(p)}function Vs(e,a){return e.read_shift(a),null}function NE(e,a){a||(a=Ne(e));for(var t=0;t<e;++t)a.write_shift(1,0);return a}function FE(e,a,t){for(var i=[],s=e.l+a;e.l<s;)i.push(t(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return i}function Va(e,a){return e.read_shift(a)===1}function qr(e,a){return a||(a=Ne(2)),a.write_shift(2,+!!e),a}function rr(e){return e.read_shift(2,"u")}function Vn(e,a){return a||(a=Ne(2)),a.write_shift(2,e),a}function Xy(e,a){return FE(e,a,rr)}function DE(e){var a=e.read_shift(1),t=e.read_shift(1);return t===1?a:a===1}function qy(e,a,t){return t||(t=Ne(2)),t.write_shift(1,a=="e"?+e:+!!e),t.write_shift(1,a=="e"?1:0),t}function o0(e,a,t){var i=e.read_shift(t&&t.biff>=12?2:1),s="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var c=e.read_shift(1);c&&(s="dbcs-cont")}else t.biff==12&&(s="wstr");t.biff>=2&&t.biff<=5&&(s="cpstr");var f=i?e.read_shift(i,s):"";return f}function jE(e){var a=e.read_shift(2),t=e.read_shift(1),i=t&4,s=t&8,c=1+(t&1),f=0,p,g={};s&&(f=e.read_shift(2)),i&&(p=e.read_shift(4));var h=c==2?"dbcs-cont":"sbcs-cont",E=a===0?"":e.read_shift(a,h);return s&&(e.l+=4*f),i&&(e.l+=p),g.t=E,s||(g.raw="<t>"+g.t+"</t>",g.r=g.t),g}function OE(e){var a=e.t||"",t=Ne(3);t.write_shift(2,a.length),t.write_shift(1,1);var i=Ne(2*a.length);i.write_shift(2*a.length,a,"utf16le");var s=[t,i];return yr(s)}function Ul(e,a,t){var i;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(a,"cpstr");if(t.biff>=12)return e.read_shift(a,"dbcs-cont")}var s=e.read_shift(1);return s===0?i=e.read_shift(a,"sbcs-cont"):i=e.read_shift(a,"dbcs-cont"),i}function c0(e,a,t){var i=e.read_shift(t&&t.biff==2?1:2);return i===0?(e.l++,""):Ul(e,i,t)}function ql(e,a,t){if(t.biff>5)return c0(e,a,t);var i=e.read_shift(1);return i===0?(e.l++,""):e.read_shift(i,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Ky(e,a,t){return t||(t=Ne(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function IE(e){var a=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[a,t]}function BE(e){var a=e.read_shift(4),t=e.l,i=!1;a>24&&(e.l+=a-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(i=!0),e.l=t);var s=e.read_shift((i?a-24:a)>>1,"utf16le").replace(Kr,"");return i&&(e.l+=24),s}function ME(e){for(var a=e.read_shift(2),t="";a-- >0;)t+="../";var i=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return t+i.replace(/\\/g,"/");var c=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var f=e.read_shift(c>>1,"utf16le").replace(Kr,"");return t+f}function LE(e,a){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return BE(e);case"0303000000000000c000000000000046":return ME(e);default:throw new Error("Unsupported Moniker "+t)}}function zd(e){var a=e.read_shift(4),t=a>0?e.read_shift(a,"utf16le").replace(Kr,""):"";return t}function mm(e,a){a||(a=Ne(6+e.length*2)),a.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)a.write_shift(2,e.charCodeAt(t));return a.write_shift(2,0),a}function PE(e,a){var t=e.l+a,i=e.read_shift(4);if(i!==2)throw new Error("Unrecognized streamVersion: "+i);var s=e.read_shift(2);e.l+=2;var c,f,p,g,h="",E,A;s&16&&(c=zd(e,t-e.l)),s&128&&(f=zd(e,t-e.l)),(s&257)===257&&(p=zd(e,t-e.l)),(s&257)===1&&(g=LE(e,t-e.l)),s&8&&(h=zd(e,t-e.l)),s&32&&(E=e.read_shift(16)),s&64&&(A=uh(e)),e.l=t;var _=f||p||g||"";_&&h&&(_+="#"+h),_||(_="#"+h),s&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var w={Target:_};return E&&(w.guid=E),A&&(w.time=A),c&&(w.Tooltip=c),w}function zE(e){var a=Ne(512),t=0,i=e.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var s=i.indexOf("#"),c=s>-1?31:23;switch(i.charAt(0)){case"#":c=28;break;case".":c&=-3;break}a.write_shift(4,2),a.write_shift(4,c);var f=[8,6815827,6619237,4849780,83];for(t=0;t<f.length;++t)a.write_shift(4,f[t]);if(c==28)i=i.slice(1),mm(i,a);else if(c&2){for(f="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<f.length;++t)a.write_shift(1,parseInt(f[t],16));var p=s>-1?i.slice(0,s):i;for(a.write_shift(4,2*(p.length+1)),t=0;t<p.length;++t)a.write_shift(2,p.charCodeAt(t));a.write_shift(2,0),c&8&&mm(s>-1?i.slice(s+1):"",a)}else{for(f="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<f.length;++t)a.write_shift(1,parseInt(f[t],16));for(var g=0;i.slice(g*3,g*3+3)=="../"||i.slice(g*3,g*3+3)=="..\\";)++g;for(a.write_shift(2,g),a.write_shift(4,i.length-3*g+1),t=0;t<i.length-3*g;++t)a.write_shift(1,i.charCodeAt(t+3*g)&255);for(a.write_shift(1,0),a.write_shift(2,65535),a.write_shift(2,57005),t=0;t<6;++t)a.write_shift(4,0)}return a.slice(0,a.l)}function Qy(e){var a=e.read_shift(1),t=e.read_shift(1),i=e.read_shift(1),s=e.read_shift(1);return[a,t,i,s]}function Jy(e,a){var t=Qy(e);return t[3]=0,t}function Di(e){var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(2);return{r:a,c:t,ixfe:i}}function Hl(e,a,t,i){return i||(i=Ne(6)),i.write_shift(2,e),i.write_shift(2,a),i.write_shift(2,t||0),i}function UE(e){var a=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:a,flags:t}}function HE(e,a,t){return a===0?"":ql(e,a,t)}function $E(e,a,t){var i=t.biff>8?4:2,s=e.read_shift(i),c=e.read_shift(i,"i"),f=e.read_shift(i,"i");return[s,c,f]}function Zy(e){var a=e.read_shift(2),t=ch(e);return[a,t]}function YE(e,a,t){e.l+=4,a-=4;var i=e.l+a,s=o0(e,a,t),c=e.read_shift(2);if(i-=e.l,c!==i)throw new Error("Malformed AddinUdf: padding = "+i+" != "+c);return e.l+=c,s}function uf(e){var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);return{s:{c:i,r:a},e:{c:s,r:t}}}function ev(e,a){return a||(a=Ne(8)),a.write_shift(2,e.s.r),a.write_shift(2,e.e.r),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c),a}function tv(e){var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1);return{s:{c:i,r:a},e:{c:s,r:t}}}var GE=tv;function av(e){e.l+=4;var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(2);return e.l+=12,[t,a,i]}function WE(e){var a={};return e.l+=4,e.l+=16,a.fSharedNote=e.read_shift(2),e.l+=4,a}function VE(e){var a={};return e.l+=4,e.cf=e.read_shift(2),a}function Br(e){e.l+=2,e.l+=e.read_shift(2)}var XE={0:Br,4:Br,5:Br,6:Br,7:VE,8:Br,9:Br,10:Br,11:Br,12:Br,13:WE,14:Br,15:Br,16:Br,17:Br,18:Br,19:Br,20:Br,21:av};function qE(e,a){for(var t=e.l+a,i=[];e.l<t;){var s=e.read_shift(2);e.l-=2;try{i.push(XE[s](e,t-e.l))}catch{return e.l=t,i}}return e.l!=t&&(e.l=t),i}function Ud(e,a){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),a-=2,a>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(a>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(a),t}function ph(e,a,t){var i=1536,s=16;switch(t.bookType){case"biff8":break;case"biff5":i=1280,s=8;break;case"biff4":i=4,s=6;break;case"biff3":i=3,s=6;break;case"biff2":i=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var c=Ne(s);return c.write_shift(2,i),c.write_shift(2,a),s>4&&c.write_shift(2,29282),s>6&&c.write_shift(2,1997),s>8&&(c.write_shift(2,49161),c.write_shift(2,1),c.write_shift(2,1798),c.write_shift(2,0)),c}function KE(e,a){return a===0||e.read_shift(2),1200}function QE(e,a,t){if(t.enc)return e.l+=a,"";var i=e.l,s=ql(e,0,t);return e.read_shift(a+i-e.l),s}function JE(e,a){var t=!a||a.biff==8,i=Ne(t?112:54);for(i.write_shift(a.biff==8?2:1,7),t&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(t?0:536870912));i.l<i.length;)i.write_shift(1,t?0:32);return i}function ZE(e,a,t){var i=t&&t.biff==8||a==2?e.read_shift(2):(e.l+=a,0);return{fDialog:i&16,fBelow:i&64,fRight:i&128}}function eT(e,a,t){var i=e.read_shift(4),s=e.read_shift(1)&3,c=e.read_shift(1);switch(c){case 0:c="Worksheet";break;case 1:c="Macrosheet";break;case 2:c="Chartsheet";break;case 6:c="VBAModule";break}var f=o0(e,0,t);return f.length===0&&(f="Sheet1"),{pos:i,hs:s,dt:c,name:f}}function tT(e,a){var t=!a||a.biff>=8?2:1,i=Ne(8+t*e.name.length);i.write_shift(4,e.pos),i.write_shift(1,e.hs||0),i.write_shift(1,e.dt),i.write_shift(1,e.name.length),a.biff>=8&&i.write_shift(1,1),i.write_shift(t*e.name.length,e.name,a.biff<8?"sbcs":"utf16le");var s=i.slice(0,i.l);return s.l=i.l,s}function aT(e,a){for(var t=e.l+a,i=e.read_shift(4),s=e.read_shift(4),c=[],f=0;f!=s&&e.l<t;++f)c.push(jE(e));return c.Count=i,c.Unique=s,c}function rT(e,a){var t=Ne(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var i=[],s=0;s<e.length;++s)i[s]=OE(e[s]);var c=yr([t].concat(i));return c.parts=[t.length].concat(i.map(function(f){return f.length})),c}function nT(e,a){var t={};return t.dsst=e.read_shift(2),e.l+=a-2,t}function iT(e){var a={};a.r=e.read_shift(2),a.c=e.read_shift(2),a.cnt=e.read_shift(2)-a.c;var t=e.read_shift(2);e.l+=4;var i=e.read_shift(1);return e.l+=3,i&7&&(a.level=i&7),i&32&&(a.hidden=!0),i&64&&(a.hpt=t/20),a}function sT(e){var a=UE(e);if(a.type!=2211)throw new Error("Invalid Future Record "+a.type);var t=e.read_shift(4);return t!==0}function lT(e){return e.read_shift(2),e.read_shift(4)}function ym(e,a,t){var i=0;t&&t.biff==2||(i=e.read_shift(2));var s=e.read_shift(2);t&&t.biff==2&&(i=1-(s>>15),s&=32767);var c={Unsynced:i&1,DyZero:(i&2)>>1,ExAsc:(i&4)>>2,ExDsc:(i&8)>>3};return[c,s]}function oT(e){var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),p=e.read_shift(2),g=e.read_shift(2),h=e.read_shift(2);return{Pos:[a,t],Dim:[i,s],Flags:c,CurTab:f,FirstTab:p,Selected:g,TabRatio:h}}function cT(){var e=Ne(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function dT(e,a,t){if(t&&t.biff>=2&&t.biff<5)return{};var i=e.read_shift(2);return{RTL:i&64}}function fT(e){var a=Ne(18),t=1718;return e&&e.RTL&&(t|=64),a.write_shift(2,t),a.write_shift(4,0),a.write_shift(4,64),a.write_shift(4,0),a.write_shift(4,0),a}function uT(){}function pT(e,a,t){var i={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return i.name=o0(e,0,t),i}function hT(e,a){var t=e.name||"Arial",i=a&&a.biff==5,s=i?15+t.length:16+2*t.length,c=Ne(s);return c.write_shift(2,e.sz*20),c.write_shift(4,0),c.write_shift(2,400),c.write_shift(4,0),c.write_shift(2,0),c.write_shift(1,t.length),i||c.write_shift(1,1),c.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le"),c}function gT(e){var a=Di(e);return a.isst=e.read_shift(4),a}function xT(e,a,t,i){var s=Ne(10);return Hl(e,a,i,s),s.write_shift(4,t),s}function mT(e,a,t){t.biffguess&&t.biff==2&&(t.biff=5);var i=e.l+a,s=Di(e);t.biff==2&&e.l++;var c=c0(e,i-e.l,t);return s.val=c,s}function yT(e,a,t,i,s){var c=!s||s.biff==8,f=Ne(8+ +c+(1+c)*t.length);return Hl(e,a,i,f),f.write_shift(2,t.length),c&&f.write_shift(1,1),f.write_shift((1+c)*t.length,t,c?"utf16le":"sbcs"),f}function vT(e,a,t){var i=e.read_shift(2),s=ql(e,0,t);return[i,s]}function bT(e,a,t,i){var s=t&&t.biff==5;i||(i=Ne(s?3+a.length:5+2*a.length)),i.write_shift(2,e),i.write_shift(s?1:2,a.length),s||i.write_shift(1,1),i.write_shift((s?1:2)*a.length,a,s?"sbcs":"utf16le");var c=i.length>i.l?i.slice(0,i.l):i;return c.l==null&&(c.l=c.length),c}var ST=ql;function vm(e,a,t){var i=e.l+a,s=t.biff==8||!t.biff?4:2,c=e.read_shift(s),f=e.read_shift(s),p=e.read_shift(2),g=e.read_shift(2);return e.l=i,{s:{r:c,c:p},e:{r:f,c:g}}}function ET(e,a){var t=a.biff==8||!a.biff?4:2,i=Ne(2*t+6);return i.write_shift(t,e.s.r),i.write_shift(t,e.e.r+1),i.write_shift(2,e.s.c),i.write_shift(2,e.e.c+1),i.write_shift(2,0),i}function TT(e){var a=e.read_shift(2),t=e.read_shift(2),i=Zy(e);return{r:a,c:t,ixfe:i[0],rknum:i[1]}}function AT(e,a){for(var t=e.l+a-2,i=e.read_shift(2),s=e.read_shift(2),c=[];e.l<t;)c.push(Zy(e));if(e.l!==t)throw new Error("MulRK read error");var f=e.read_shift(2);if(c.length!=f-s+1)throw new Error("MulRK length mismatch");return{r:i,c:s,C:f,rkrec:c}}function _T(e,a){for(var t=e.l+a-2,i=e.read_shift(2),s=e.read_shift(2),c=[];e.l<t;)c.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var f=e.read_shift(2);if(c.length!=f-s+1)throw new Error("MulBlank length mismatch");return{r:i,c:s,C:f,ixfe:c}}function CT(e,a,t,i){var s={},c=e.read_shift(4),f=e.read_shift(4),p=e.read_shift(4),g=e.read_shift(2);return s.patternType=sE[p>>26],i.cellStyles&&(s.alc=c&7,s.fWrap=c>>3&1,s.alcV=c>>4&7,s.fJustLast=c>>7&1,s.trot=c>>8&255,s.cIndent=c>>16&15,s.fShrinkToFit=c>>20&1,s.iReadOrder=c>>22&2,s.fAtrNum=c>>26&1,s.fAtrFnt=c>>27&1,s.fAtrAlc=c>>28&1,s.fAtrBdr=c>>29&1,s.fAtrPat=c>>30&1,s.fAtrProt=c>>31&1,s.dgLeft=f&15,s.dgRight=f>>4&15,s.dgTop=f>>8&15,s.dgBottom=f>>12&15,s.icvLeft=f>>16&127,s.icvRight=f>>23&127,s.grbitDiag=f>>30&3,s.icvTop=p&127,s.icvBottom=p>>7&127,s.icvDiag=p>>14&127,s.dgDiag=p>>21&15,s.icvFore=g&127,s.icvBack=g>>7&127,s.fsxButton=g>>14&1),s}function kT(e,a,t){var i={};return i.ifnt=e.read_shift(2),i.numFmtId=e.read_shift(2),i.flags=e.read_shift(2),i.fStyle=i.flags>>2&1,a-=6,i.data=CT(e,a,i.fStyle,t),i}function bm(e,a,t,i){var s=t&&t.biff==5;i||(i=Ne(s?16:20)),i.write_shift(2,0),e.style?(i.write_shift(2,e.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,e.numFmtId||0),i.write_shift(2,a<<4));var c=0;return e.numFmtId>0&&s&&(c|=1024),i.write_shift(4,c),i.write_shift(4,0),s||i.write_shift(4,0),i.write_shift(2,0),i}function wT(e){e.l+=4;var a=[e.read_shift(2),e.read_shift(2)];if(a[0]!==0&&a[0]--,a[1]!==0&&a[1]--,a[0]>7||a[1]>7)throw new Error("Bad Gutters: "+a.join("|"));return a}function RT(e){var a=Ne(8);return a.write_shift(4,0),a.write_shift(2,0),a.write_shift(2,0),a}function Sm(e,a,t){var i=Di(e);(t.biff==2||a==9)&&++e.l;var s=DE(e);return i.val=s,i.t=s===!0||s===!1?"b":"e",i}function NT(e,a,t,i,s,c){var f=Ne(8);return Hl(e,a,i,f),qy(t,c,f),f}function FT(e,a,t){t.biffguess&&t.biff==2&&(t.biff=5);var i=Di(e),s=zr(e);return i.val=s,i}function DT(e,a,t,i){var s=Ne(14);return Hl(e,a,i,s),zl(t,s),s}var Em=HE;function jT(e,a,t){var i=e.l+a,s=e.read_shift(2),c=e.read_shift(2);if(t.sbcch=c,c==1025||c==14849)return[c,s];if(c<1||c>255)throw new Error("Unexpected SupBook type: "+c);for(var f=Ul(e,c),p=[];i>e.l;)p.push(c0(e));return[c,s,f,p]}function Tm(e,a,t){var i=e.read_shift(2),s,c={fBuiltIn:i&1,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return t.sbcch===14849&&(s=YE(e,a-2,t)),c.body=s||e.read_shift(a-2),typeof s=="string"&&(c.Name=s),c}var OT=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Am(e,a,t){var i=e.l+a,s=e.read_shift(2),c=e.read_shift(1),f=e.read_shift(1),p=e.read_shift(t&&t.biff==2?1:2),g=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),g=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var h=Ul(e,f,t);s&32&&(h=OT[h.charCodeAt(0)]);var E=i-e.l;t&&t.biff==2&&--E;var A=i==e.l||p===0||!(E>0)?[]:q3(e,E,t,p);return{chKey:c,Name:h,itab:g,rgce:A}}function rv(e,a,t){if(t.biff<8)return IT(e,a,t);for(var i=[],s=e.l+a,c=e.read_shift(t.biff>8?4:2);c--!==0;)i.push($E(e,t.biff>8?12:6,t));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return i}function IT(e,a,t){e[e.l+1]==3&&e[e.l]++;var i=o0(e,a,t);return i.charCodeAt(0)==3?i.slice(1):i}function BT(e,a,t){if(t.biff<8){e.l+=a;return}var i=e.read_shift(2),s=e.read_shift(2),c=Ul(e,i,t),f=Ul(e,s,t);return[c,f]}function MT(e,a,t){var i=tv(e);e.l++;var s=e.read_shift(1);return a-=8,[K3(e,a,t),s,i]}function _m(e,a,t){var i=GE(e);switch(t.biff){case 2:e.l++,a-=7;break;case 3:case 4:e.l+=2,a-=8;break;default:e.l+=6,a-=12}return[i,V3(e,a,t)]}function LT(e){var a=e.read_shift(4)!==0,t=e.read_shift(4)!==0,i=e.read_shift(4);return[a,t,i]}function PT(e,a,t){if(!(t.biff<8)){var i=e.read_shift(2),s=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),p=ql(e,0,t);return t.biff<8&&e.read_shift(1),[{r:i,c:s},p,f,c]}}function zT(e,a,t){return PT(e,a,t)}function UT(e,a){for(var t=[],i=e.read_shift(2);i--;)t.push(uf(e));return t}function HT(e){var a=Ne(2+e.length*8);a.write_shift(2,e.length);for(var t=0;t<e.length;++t)ev(e[t],a);return a}function $T(e,a,t){if(t&&t.biff<8)return GT(e,a,t);var i=av(e),s=qE(e,a-22,i[1]);return{cmo:i,ft:s}}var YT={8:function(e,a){var t=e.l+a;e.l+=10;var i=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=t,{fmt:i}}};function GT(e,a,t){e.l+=4;var i=e.read_shift(2),s=e.read_shift(2),c=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,a-=36;var f=[];return f.push((YT[i]||Hr)(e,a,t)),{cmo:[s,i,c],ft:f}}function WT(e,a,t){var i=e.l,s="";try{e.l+=4;var c=(t.lastobj||{cmo:[0,0]}).cmo[1],f;[0,5,7,11,12,14].indexOf(c)==-1?e.l+=6:f=IE(e,6,t);var p=e.read_shift(2);e.read_shift(2),rr(e,2);var g=e.read_shift(2);e.l+=g;for(var h=1;h<e.lens.length-1;++h){if(e.l-i!=e.lens[h])throw new Error("TxO: bad continue record");var E=e[e.l],A=Ul(e,e.lens[h+1]-e.lens[h]-1);if(s+=A,s.length>=(E?p:2*p))break}if(s.length!==p&&s.length!==p*2)throw new Error("cchText: "+p+" != "+s.length);return e.l=i+a,{t:s}}catch{return e.l=i+a,{t:s}}}function VT(e,a){var t=uf(e);e.l+=16;var i=PE(e,a-24);return[t,i]}function XT(e){var a=Ne(24),t=Oa(e[0]);a.write_shift(2,t.r),a.write_shift(2,t.r),a.write_shift(2,t.c),a.write_shift(2,t.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)a.write_shift(1,parseInt(i[s],16));return yr([a,zE(e[1])])}function qT(e,a){e.read_shift(2);var t=uf(e),i=e.read_shift((a-10)/2,"dbcs-cont");return i=i.replace(Kr,""),[t,i]}function KT(e){var a=e[1].Tooltip,t=Ne(10+2*(a.length+1));t.write_shift(2,2048);var i=Oa(e[0]);t.write_shift(2,i.r),t.write_shift(2,i.r),t.write_shift(2,i.c),t.write_shift(2,i.c);for(var s=0;s<a.length;++s)t.write_shift(2,a.charCodeAt(s));return t.write_shift(2,0),t}function QT(e){var a=[0,0],t;return t=e.read_shift(2),a[0]=cm[t]||t,t=e.read_shift(2),a[1]=cm[t]||t,a}function JT(e){return e||(e=Ne(4)),e.write_shift(2,1),e.write_shift(2,1),e}function ZT(e){for(var a=e.read_shift(2),t=[];a-- >0;)t.push(Jy(e));return t}function eA(e){for(var a=e.read_shift(2),t=[];a-- >0;)t.push(Jy(e));return t}function tA(e){e.l+=2;var a={cxfs:0,crc:0};return a.cxfs=e.read_shift(2),a.crc=e.read_shift(4),a}function nv(e,a,t){if(!t.cellStyles)return Hr(e,a);var i=t&&t.biff>=12?4:2,s=e.read_shift(i),c=e.read_shift(i),f=e.read_shift(i),p=e.read_shift(i),g=e.read_shift(2);i==2&&(e.l+=2);var h={s,e:c,w:f,ixfe:p,flags:g};return(t.biff>=5||!t.biff)&&(h.level=g>>8&7),h}function aA(e,a){var t=Ne(12);t.write_shift(2,a),t.write_shift(2,a),t.write_shift(2,e.width*256),t.write_shift(2,0);var i=0;return e.hidden&&(i|=1),t.write_shift(1,i),i=e.level||0,t.write_shift(1,i),t.write_shift(2,0),t}function rA(e,a){var t={};return a<32||(e.l+=16,t.header=zr(e),t.footer=zr(e),e.l+=2),t}function nA(e,a,t){var i={area:!1};if(t.biff!=5)return e.l+=a,i;var s=e.read_shift(1);return e.l+=3,s&16&&(i.area=!0),i}function iA(e){for(var a=Ne(2*e),t=0;t<e;++t)a.write_shift(2,t+1);return a}var sA=Di,lA=Xy,oA=c0;function cA(e){var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(4),s={fmt:a,env:t,len:i,data:e.slice(e.l,e.l+i)};return e.l+=i,s}function dA(e,a,t){t.biffguess&&t.biff==5&&(t.biff=2);var i=Di(e);++e.l;var s=ql(e,a-7,t);return i.t="str",i.val=s,i}function fA(e){var a=Di(e);++e.l;var t=zr(e);return a.t="n",a.val=t,a}function uA(e,a,t){var i=Ne(15);return p0(i,e,a),i.write_shift(8,t,"f"),i}function pA(e){var a=Di(e);++e.l;var t=e.read_shift(2);return a.t="n",a.val=t,a}function hA(e,a,t){var i=Ne(9);return p0(i,e,a),i.write_shift(2,t),i}function gA(e){var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,"sbcs-cont")}function xA(e,a){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=a-13}function mA(e,a,t){var i=e.l+a,s=Di(e),c=e.read_shift(2),f=Ul(e,c,t);return e.l=i,s.t="str",s.val=f,s}var yA=[2,3,48,49,131,139,140,245],Pp=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},a=cf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(p,g){var h=[],E=Ks(1);switch(g.type){case"base64":E=Cn(wn(p));break;case"binary":E=Cn(p);break;case"buffer":case"array":E=p;break}kr(E,0);var A=E.read_shift(1),_=!!(A&136),w=!1,N=!1;switch(A){case 2:break;case 3:break;case 48:w=!0,_=!0;break;case 49:w=!0,_=!0;break;case 131:break;case 139:break;case 140:N=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+A.toString(16))}var k=0,F=521;A==2&&(k=E.read_shift(2)),E.l+=3,A!=2&&(k=E.read_shift(4)),k>1048576&&(k=1e6),A!=2&&(F=E.read_shift(2));var z=E.read_shift(2),K=g.codepage||1252;A!=2&&(E.l+=16,E.read_shift(1),E[E.l]!==0&&(K=e[E[E.l]]),E.l+=1,E.l+=2),N&&(E.l+=36);for(var M=[],ie={},se=Math.min(E.length,A==2?521:F-10-(w?264:0)),ne=N?32:11;E.l<se&&E[E.l]!=13;)switch(ie={},ie.name=Wc.utils.decode(K,E.slice(E.l,E.l+ne)).replace(/[\u0000\r\n].*$/g,""),E.l+=ne,ie.type=String.fromCharCode(E.read_shift(1)),A!=2&&!N&&(ie.offset=E.read_shift(4)),ie.len=E.read_shift(1),A==2&&(ie.offset=E.read_shift(2)),ie.dec=E.read_shift(1),ie.name.length&&M.push(ie),A!=2&&(E.l+=N?13:14),ie.type){case"B":(!w||ie.len!=8)&&g.WTF&&console.log("Skipping "+ie.name+":"+ie.type);break;case"G":case"P":g.WTF&&console.log("Skipping "+ie.name+":"+ie.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+ie.type)}if(E[E.l]!==13&&(E.l=F-1),E.read_shift(1)!==13)throw new Error("DBF Terminator not found "+E.l+" "+E[E.l]);E.l=F;var H=0,le=0;for(h[0]=[],le=0;le!=M.length;++le)h[0][le]=M[le].name;for(;k-- >0;){if(E[E.l]===42){E.l+=z;continue}for(++E.l,h[++H]=[],le=0,le=0;le!=M.length;++le){var oe=E.slice(E.l,E.l+M[le].len);E.l+=M[le].len,kr(oe,0);var m=Wc.utils.decode(K,oe);switch(M[le].type){case"C":m.trim().length&&(h[H][le]=m.replace(/\s+$/,""));break;case"D":m.length===8?h[H][le]=new Date(+m.slice(0,4),+m.slice(4,6)-1,+m.slice(6,8)):h[H][le]=m;break;case"F":h[H][le]=parseFloat(m.trim());break;case"+":case"I":h[H][le]=N?oe.read_shift(-4,"i")^2147483648:oe.read_shift(4,"i");break;case"L":switch(m.trim().toUpperCase()){case"Y":case"T":h[H][le]=!0;break;case"N":case"F":h[H][le]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+m+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+A.toString(16));h[H][le]="##MEMO##"+(N?parseInt(m.trim(),10):oe.read_shift(4));break;case"N":m=m.replace(/\u0000/g,"").trim(),m&&m!="."&&(h[H][le]=+m||0);break;case"@":h[H][le]=new Date(oe.read_shift(-8,"f")-621356832e5);break;case"T":h[H][le]=new Date((oe.read_shift(4)-2440588)*864e5+oe.read_shift(4));break;case"Y":h[H][le]=oe.read_shift(4,"i")/1e4+oe.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[H][le]=-oe.read_shift(-8,"f");break;case"B":if(w&&M[le].len==8){h[H][le]=oe.read_shift(8,"f");break}case"G":case"P":oe.l+=M[le].len;break;case"0":if(M[le].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+M[le].type)}}}if(A!=2&&E.l<E.length&&E[E.l++]!=26)throw new Error("DBF EOF Marker missing "+(E.l-1)+" of "+E.length+" "+E[E.l-1].toString(16));return g&&g.sheetRows&&(h=h.slice(0,g.sheetRows)),g.DBF=M,h}function i(p,g){var h=g||{};h.dateNF||(h.dateNF="yyyymmdd");var E=Ho(t(p,h),h);return E["!cols"]=h.DBF.map(function(A){return{wch:A.len,DBF:A}}),delete h.DBF,E}function s(p,g){try{return tl(i(p,g),g)}catch(h){if(g&&g.WTF)throw h}return{SheetNames:[],Sheets:{}}}var c={B:8,C:250,L:1,D:8,"?":0,"":0};function f(p,g){var h=g||{};if(+h.codepage>=0&&hi(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var E=fn(),A=sf(p,{header:1,raw:!0,cellDates:!0}),_=A[0],w=A.slice(1),N=p["!cols"]||[],k=0,F=0,z=0,K=1;for(k=0;k<_.length;++k){if(((N[k]||{}).DBF||{}).name){_[k]=N[k].DBF.name,++z;continue}if(_[k]!=null){if(++z,typeof _[k]=="number"&&(_[k]=_[k].toString(10)),typeof _[k]!="string")throw new Error("DBF Invalid column name "+_[k]+" |"+typeof _[k]+"|");if(_.indexOf(_[k])!==k){for(F=0;F<1024;++F)if(_.indexOf(_[k]+"_"+F)==-1){_[k]+="_"+F;break}}}}var M=Qt(p["!ref"]),ie=[],se=[],ne=[];for(k=0;k<=M.e.c-M.s.c;++k){var H="",le="",oe=0,m=[];for(F=0;F<w.length;++F)w[F][k]!=null&&m.push(w[F][k]);if(m.length==0||_[k]==null){ie[k]="?";continue}for(F=0;F<m.length;++F){switch(typeof m[F]){case"number":le="B";break;case"string":le="C";break;case"boolean":le="L";break;case"object":le=m[F]instanceof Date?"D":"C";break;default:le="C"}oe=Math.max(oe,String(m[F]).length),H=H&&H!=le?"C":le}oe>250&&(oe=250),le=((N[k]||{}).DBF||{}).type,le=="C"&&N[k].DBF.len>oe&&(oe=N[k].DBF.len),H=="B"&&le=="N"&&(H="N",ne[k]=N[k].DBF.dec,oe=N[k].DBF.len),se[k]=H=="C"||le=="N"?oe:c[H]||0,K+=se[k],ie[k]=H}var Se=E.next(32);for(Se.write_shift(4,318902576),Se.write_shift(4,w.length),Se.write_shift(2,296+32*z),Se.write_shift(2,K),k=0;k<4;++k)Se.write_shift(4,0);for(Se.write_shift(4,0|(+a[Vm]||3)<<8),k=0,F=0;k<_.length;++k)if(_[k]!=null){var ue=E.next(32),Pe=(_[k].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ue.write_shift(1,Pe,"sbcs"),ue.write_shift(1,ie[k]=="?"?"C":ie[k],"sbcs"),ue.write_shift(4,F),ue.write_shift(1,se[k]||c[ie[k]]||0),ue.write_shift(1,ne[k]||0),ue.write_shift(1,2),ue.write_shift(4,0),ue.write_shift(1,0),ue.write_shift(4,0),ue.write_shift(4,0),F+=se[k]||c[ie[k]]||0}var et=E.next(264);for(et.write_shift(4,13),k=0;k<65;++k)et.write_shift(4,0);for(k=0;k<w.length;++k){var ke=E.next(K);for(ke.write_shift(1,0),F=0;F<_.length;++F)if(_[F]!=null)switch(ie[F]){case"L":ke.write_shift(1,w[k][F]==null?63:w[k][F]?84:70);break;case"B":ke.write_shift(8,w[k][F]||0,"f");break;case"N":var de="0";for(typeof w[k][F]=="number"&&(de=w[k][F].toFixed(ne[F]||0)),z=0;z<se[F]-de.length;++z)ke.write_shift(1,32);ke.write_shift(1,de,"sbcs");break;case"D":w[k][F]?(ke.write_shift(4,("0000"+w[k][F].getFullYear()).slice(-4),"sbcs"),ke.write_shift(2,("00"+(w[k][F].getMonth()+1)).slice(-2),"sbcs"),ke.write_shift(2,("00"+w[k][F].getDate()).slice(-2),"sbcs")):ke.write_shift(8,"00000000","sbcs");break;case"C":var Ce=String(w[k][F]!=null?w[k][F]:"").slice(0,se[F]);for(ke.write_shift(1,Ce,"sbcs"),z=0;z<se[F]-Ce.length;++z)ke.write_shift(1,32);break}}return E.next(1).write_shift(1,26),E.end()}return{to_workbook:s,to_sheet:i,from_sheet:f}})(),iv=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},a=new RegExp("\x1BN("+Ua(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(_,w){var N=e[w];return typeof N=="number"?Bx(N):N},i=function(_,w,N){var k=w.charCodeAt(0)-32<<4|N.charCodeAt(0)-48;return k==59?_:Bx(k)};e["|"]=254;function s(_,w){switch(w.type){case"base64":return c(wn(_),w);case"binary":return c(_,w);case"buffer":return c(It&&Buffer.isBuffer(_)?_.toString("binary"):el(_),w);case"array":return c(Pl(_),w)}throw new Error("Unrecognized type "+w.type)}function c(_,w){var N=_.split(/[\n\r]+/),k=-1,F=-1,z=0,K=0,M=[],ie=[],se=null,ne={},H=[],le=[],oe=[],m=0,Se;for(+w.codepage>=0&&hi(+w.codepage);z!==N.length;++z){m=0;var ue=N[z].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(a,t),Pe=ue.replace(/;;/g,"\0").split(";").map(function(te){return te.replace(/\u0000/g,";")}),et=Pe[0],ke;if(ue.length>0)switch(et){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Pe[1].charAt(0)=="P"&&ie.push(ue.slice(3).replace(/;;/g,";"));break;case"C":var de=!1,Ce=!1,Je=!1,fe=!1,Ke=-1,ee=-1;for(K=1;K<Pe.length;++K)switch(Pe[K].charAt(0)){case"A":break;case"X":F=parseInt(Pe[K].slice(1))-1,Ce=!0;break;case"Y":for(k=parseInt(Pe[K].slice(1))-1,Ce||(F=0),Se=M.length;Se<=k;++Se)M[Se]=[];break;case"K":ke=Pe[K].slice(1),ke.charAt(0)==='"'?ke=ke.slice(1,ke.length-1):ke==="TRUE"?ke=!0:ke==="FALSE"?ke=!1:isNaN(xi(ke))?isNaN(Mo(ke).getDate())||(ke=ka(ke)):(ke=xi(ke),se!==null&&zo(se)&&(ke=ff(ke))),de=!0;break;case"E":fe=!0;var I=Io(Pe[K].slice(1),{r:k,c:F});M[k][F]=[M[k][F],I];break;case"S":Je=!0,M[k][F]=[M[k][F],"S5S"];break;case"G":break;case"R":Ke=parseInt(Pe[K].slice(1))-1;break;case"C":ee=parseInt(Pe[K].slice(1))-1;break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+ue)}if(de&&(M[k][F]&&M[k][F].length==2?M[k][F][0]=ke:M[k][F]=ke,se=null),Je){if(fe)throw new Error("SYLK shared formula cannot have own formula");var L=Ke>-1&&M[Ke][ee];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");M[k][F][1]=Tv(L[1],{r:k-Ke,c:F-ee})}break;case"F":var Q=0;for(K=1;K<Pe.length;++K)switch(Pe[K].charAt(0)){case"X":F=parseInt(Pe[K].slice(1))-1,++Q;break;case"Y":for(k=parseInt(Pe[K].slice(1))-1,Se=M.length;Se<=k;++Se)M[Se]=[];break;case"M":m=parseInt(Pe[K].slice(1))/20;break;case"F":break;case"G":break;case"P":se=ie[parseInt(Pe[K].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(oe=Pe[K].slice(1).split(" "),Se=parseInt(oe[0],10);Se<=parseInt(oe[1],10);++Se)m=parseInt(oe[2],10),le[Se-1]=m===0?{hidden:!0}:{wch:m},Qs(le[Se-1]);break;case"C":F=parseInt(Pe[K].slice(1))-1,le[F]||(le[F]={});break;case"R":k=parseInt(Pe[K].slice(1))-1,H[k]||(H[k]={}),m>0?(H[k].hpt=m,H[k].hpx=Po(m)):m===0&&(H[k].hidden=!0);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+ue)}Q<1&&(se=null);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+ue)}}return H.length>0&&(ne["!rows"]=H),le.length>0&&(ne["!cols"]=le),w&&w.sheetRows&&(M=M.slice(0,w.sheetRows)),[M,ne]}function f(_,w){var N=s(_,w),k=N[0],F=N[1],z=Ho(k,w);return Ua(F).forEach(function(K){z[K]=F[K]}),z}function p(_,w){return tl(f(_,w),w)}function g(_,w,N,k){var F="C;Y"+(N+1)+";X"+(k+1)+";K";switch(_.t){case"n":F+=_.v||0,_.f&&!_.F&&(F+=";E"+vh(_.f,{r:N,c:k}));break;case"b":F+=_.v?"TRUE":"FALSE";break;case"e":F+=_.w||_.v;break;case"d":F+='"'+(_.w||_.v)+'"';break;case"s":F+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return F}function h(_,w){w.forEach(function(N,k){var F="F;W"+(k+1)+" "+(k+1)+" ";N.hidden?F+="0":(typeof N.width=="number"&&!N.wpx&&(N.wpx=e0(N.width)),typeof N.wpx=="number"&&!N.wch&&(N.wch=t0(N.wpx)),typeof N.wch=="number"&&(F+=Math.round(N.wch))),F.charAt(F.length-1)!=" "&&_.push(F)})}function E(_,w){w.forEach(function(N,k){var F="F;";N.hidden?F+="M0;":N.hpt?F+="M"+20*N.hpt+";":N.hpx&&(F+="M"+20*a0(N.hpx)+";"),F.length>2&&_.push(F+"R"+(k+1))})}function A(_,w){var N=["ID;PWXL;N;E"],k=[],F=Qt(_["!ref"]),z,K=Array.isArray(_),M=`\r
`;N.push("P;PGeneral"),N.push("F;P0;DG0G8;M255"),_["!cols"]&&h(N,_["!cols"]),_["!rows"]&&E(N,_["!rows"]),N.push("B;Y"+(F.e.r-F.s.r+1)+";X"+(F.e.c-F.s.c+1)+";D"+[F.s.c,F.s.r,F.e.c,F.e.r].join(" "));for(var ie=F.s.r;ie<=F.e.r;++ie)for(var se=F.s.c;se<=F.e.c;++se){var ne=bt({r:ie,c:se});z=K?(_[ie]||[])[se]:_[ne],!(!z||z.v==null&&(!z.f||z.F))&&k.push(g(z,_,ie,se))}return N.join(M)+M+k.join(M)+M+"E"+M}return{to_workbook:p,to_sheet:f,from_sheet:A}})(),sv=(function(){function e(c,f){switch(f.type){case"base64":return a(wn(c),f);case"binary":return a(c,f);case"buffer":return a(It&&Buffer.isBuffer(c)?c.toString("binary"):el(c),f);case"array":return a(Pl(c),f)}throw new Error("Unrecognized type "+f.type)}function a(c,f){for(var p=c.split(`
`),g=-1,h=-1,E=0,A=[];E!==p.length;++E){if(p[E].trim()==="BOT"){A[++g]=[],h=0;continue}if(!(g<0)){var _=p[E].trim().split(","),w=_[0],N=_[1];++E;for(var k=p[E]||"";(k.match(/["]/g)||[]).length&1&&E<p.length-1;)k+=`
`+p[++E];switch(k=k.trim(),+w){case-1:if(k==="BOT"){A[++g]=[],h=0;continue}else if(k!=="EOD")throw new Error("Unrecognized DIF special command "+k);break;case 0:k==="TRUE"?A[g][h]=!0:k==="FALSE"?A[g][h]=!1:isNaN(xi(N))?isNaN(Mo(N).getDate())?A[g][h]=N:A[g][h]=ka(N):A[g][h]=xi(N),++h;break;case 1:k=k.slice(1,k.length-1),k=k.replace(/""/g,'"'),k&&k.match(/^=".*"$/)&&(k=k.slice(2,-1)),A[g][h++]=k!==""?k:null;break}if(k==="EOD")break}}return f&&f.sheetRows&&(A=A.slice(0,f.sheetRows)),A}function t(c,f){return Ho(e(c,f),f)}function i(c,f){return tl(t(c,f),f)}var s=(function(){var c=function(g,h,E,A,_){g.push(h),g.push(E+","+A),g.push('"'+_.replace(/"/g,'""')+'"')},f=function(g,h,E,A){g.push(h+","+E),g.push(h==1?'"'+A.replace(/"/g,'""')+'"':A)};return function(g){var h=[],E=Qt(g["!ref"]),A,_=Array.isArray(g);c(h,"TABLE",0,1,"sheetjs"),c(h,"VECTORS",0,E.e.r-E.s.r+1,""),c(h,"TUPLES",0,E.e.c-E.s.c+1,""),c(h,"DATA",0,0,"");for(var w=E.s.r;w<=E.e.r;++w){f(h,-1,0,"BOT");for(var N=E.s.c;N<=E.e.c;++N){var k=bt({r:w,c:N});if(A=_?(g[w]||[])[N]:g[k],!A){f(h,1,0,"");continue}switch(A.t){case"n":var F=A.w;!F&&A.v!=null&&(F=A.v),F==null?A.f&&!A.F?f(h,1,0,"="+A.f):f(h,1,0,""):f(h,0,F,"V");break;case"b":f(h,0,A.v?1:0,A.v?"TRUE":"FALSE");break;case"s":f(h,1,0,isNaN(A.v)?A.v:'="'+A.v+'"');break;case"d":A.w||(A.w=qn(A.z||mt[14],fr(ka(A.v)))),f(h,0,A.w,"V");break;default:f(h,1,0,"")}}}f(h,-1,0,"EOD");var z=`\r
`,K=h.join(z);return K}})();return{to_workbook:i,to_sheet:t,from_sheet:s}})(),lv=(function(){function e(A){return A.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function a(A){return A.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(A,_){for(var w=A.split(`
`),N=-1,k=-1,F=0,z=[];F!==w.length;++F){var K=w[F].trim().split(":");if(K[0]==="cell"){var M=Oa(K[1]);if(z.length<=M.r)for(N=z.length;N<=M.r;++N)z[N]||(z[N]=[]);switch(N=M.r,k=M.c,K[2]){case"t":z[N][k]=e(K[3]);break;case"v":z[N][k]=+K[3];break;case"vtf":var ie=K[K.length-1];case"vtc":K[3]==="nl"?z[N][k]=!!+K[4]:z[N][k]=+K[4],K[2]=="vtf"&&(z[N][k]=[z[N][k],ie])}}}return _&&_.sheetRows&&(z=z.slice(0,_.sheetRows)),z}function i(A,_){return Ho(t(A,_),_)}function s(A,_){return tl(i(A,_),_)}var c=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),f=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,p=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),g="--SocialCalcSpreadsheetControlSave--";function h(A){if(!A||!A["!ref"])return"";for(var _=[],w=[],N,k="",F=un(A["!ref"]),z=Array.isArray(A),K=F.s.r;K<=F.e.r;++K)for(var M=F.s.c;M<=F.e.c;++M)if(k=bt({r:K,c:M}),N=z?(A[K]||[])[M]:A[k],!(!N||N.v==null||N.t==="z")){switch(w=["cell",k,"t"],N.t){case"s":case"str":w.push(a(N.v));break;case"n":N.f?(w[2]="vtf",w[3]="n",w[4]=N.v,w[5]=a(N.f)):(w[2]="v",w[3]=N.v);break;case"b":w[2]="vt"+(N.f?"f":"c"),w[3]="nl",w[4]=N.v?"1":"0",w[5]=a(N.f||(N.v?"TRUE":"FALSE"));break;case"d":var ie=fr(ka(N.v));w[2]="vtc",w[3]="nd",w[4]=""+ie,w[5]=N.w||qn(N.z||mt[14],ie);break;case"e":continue}_.push(w.join(":"))}return _.push("sheet:c:"+(F.e.c-F.s.c+1)+":r:"+(F.e.r-F.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function E(A){return[c,f,p,f,h(A),g].join(`
`)}return{to_workbook:s,to_sheet:i,from_sheet:E}})(),Lo=(function(){function e(E,A,_,w,N){N.raw?A[_][w]=E:E===""||(E==="TRUE"?A[_][w]=!0:E==="FALSE"?A[_][w]=!1:isNaN(xi(E))?isNaN(Mo(E).getDate())?A[_][w]=E:A[_][w]=ka(E):A[_][w]=xi(E))}function a(E,A){var _=A||{},w=[];if(!E||E.length===0)return w;for(var N=E.split(/[\r\n]/),k=N.length-1;k>=0&&N[k].length===0;)--k;for(var F=10,z=0,K=0;K<=k;++K)z=N[K].indexOf(" "),z==-1?z=N[K].length:z++,F=Math.max(F,z);for(K=0;K<=k;++K){w[K]=[];var M=0;for(e(N[K].slice(0,F).trim(),w,K,M,_),M=1;M<=(N[K].length-F)/10+1;++M)e(N[K].slice(F+(M-1)*10,F+M*10).trim(),w,K,M,_)}return _.sheetRows&&(w=w.slice(0,_.sheetRows)),w}var t={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function s(E){for(var A={},_=!1,w=0,N=0;w<E.length;++w)(N=E.charCodeAt(w))==34?_=!_:!_&&N in t&&(A[N]=(A[N]||0)+1);N=[];for(w in A)Object.prototype.hasOwnProperty.call(A,w)&&N.push([A[w],w]);if(!N.length){A=i;for(w in A)Object.prototype.hasOwnProperty.call(A,w)&&N.push([A[w],w])}return N.sort(function(k,F){return k[0]-F[0]||i[k[1]]-i[F[1]]}),t[N.pop()[1]]||44}function c(E,A){var _=A||{},w="",N=_.dense?[]:{},k={s:{c:0,r:0},e:{c:0,r:0}};E.slice(0,4)=="sep="?E.charCodeAt(5)==13&&E.charCodeAt(6)==10?(w=E.charAt(4),E=E.slice(7)):E.charCodeAt(5)==13||E.charCodeAt(5)==10?(w=E.charAt(4),E=E.slice(6)):w=s(E.slice(0,1024)):_&&_.FS?w=_.FS:w=s(E.slice(0,1024));var F=0,z=0,K=0,M=0,ie=0,se=w.charCodeAt(0),ne=!1,H=0,le=E.charCodeAt(0);E=E.replace(/\r\n/mg,`
`);var oe=_.dateNF!=null?nS(_.dateNF):null;function m(){var Se=E.slice(M,ie),ue={};if(Se.charAt(0)=='"'&&Se.charAt(Se.length-1)=='"'&&(Se=Se.slice(1,-1).replace(/""/g,'"')),Se.length===0)ue.t="z";else if(_.raw)ue.t="s",ue.v=Se;else if(Se.trim().length===0)ue.t="s",ue.v=Se;else if(Se.charCodeAt(0)==61)Se.charCodeAt(1)==34&&Se.charCodeAt(Se.length-1)==34?(ue.t="s",ue.v=Se.slice(2,-1).replace(/""/g,'"')):j4(Se)?(ue.t="n",ue.f=Se.slice(1)):(ue.t="s",ue.v=Se);else if(Se=="TRUE")ue.t="b",ue.v=!0;else if(Se=="FALSE")ue.t="b",ue.v=!1;else if(!isNaN(K=xi(Se)))ue.t="n",_.cellText!==!1&&(ue.w=Se),ue.v=K;else if(!isNaN(Mo(Se).getDate())||oe&&Se.match(oe)){ue.z=_.dateNF||mt[14];var Pe=0;oe&&Se.match(oe)&&(Se=iS(Se,_.dateNF,Se.match(oe)||[]),Pe=1),_.cellDates?(ue.t="d",ue.v=ka(Se,Pe)):(ue.t="n",ue.v=fr(ka(Se,Pe))),_.cellText!==!1&&(ue.w=qn(ue.z,ue.v instanceof Date?fr(ue.v):ue.v)),_.cellNF||delete ue.z}else ue.t="s",ue.v=Se;if(ue.t=="z"||(_.dense?(N[F]||(N[F]=[]),N[F][z]=ue):N[bt({c:z,r:F})]=ue),M=ie+1,le=E.charCodeAt(M),k.e.c<z&&(k.e.c=z),k.e.r<F&&(k.e.r=F),H==se)++z;else if(z=0,++F,_.sheetRows&&_.sheetRows<=F)return!0}e:for(;ie<E.length;++ie)switch(H=E.charCodeAt(ie)){case 34:le===34&&(ne=!ne);break;case se:case 10:case 13:if(!ne&&m())break e;break}return ie-M>0&&m(),N["!ref"]=wt(k),N}function f(E,A){return!(A&&A.PRN)||A.FS||E.slice(0,4)=="sep="||E.indexOf("	")>=0||E.indexOf(",")>=0||E.indexOf(";")>=0?c(E,A):Ho(a(E,A),A)}function p(E,A){var _="",w=A.type=="string"?[0,0,0,0]:kh(E,A);switch(A.type){case"base64":_=wn(E);break;case"binary":_=E;break;case"buffer":A.codepage==65001?_=E.toString("utf8"):A.codepage&&typeof Wc<"u"||(_=It&&Buffer.isBuffer(E)?E.toString("binary"):el(E));break;case"array":_=Pl(E);break;case"string":_=E;break;default:throw new Error("Unrecognized type "+A.type)}return w[0]==239&&w[1]==187&&w[2]==191?_=xa(_.slice(3)):A.type!="string"&&A.type!="buffer"&&A.codepage==65001?_=xa(_):A.type=="binary"&&typeof Wc<"u",_.slice(0,19)=="socialcalc:version:"?lv.to_sheet(A.type=="string"?_:xa(_),A):f(_,A)}function g(E,A){return tl(p(E,A),A)}function h(E){for(var A=[],_=Qt(E["!ref"]),w,N=Array.isArray(E),k=_.s.r;k<=_.e.r;++k){for(var F=[],z=_.s.c;z<=_.e.c;++z){var K=bt({r:k,c:z});if(w=N?(E[k]||[])[z]:E[K],!w||w.v==null){F.push("          ");continue}for(var M=(w.w||(is(w),w.w)||"").slice(0,10);M.length<10;)M+=" ";F.push(M+(z===0?" ":""))}A.push(F.join(""))}return A.join(`
`)}return{to_workbook:g,to_sheet:p,from_sheet:h}})();function vA(e,a){var t=a||{},i=!!t.WTF;t.WTF=!0;try{var s=iv.to_workbook(e,t);return t.WTF=i,s}catch(c){if(t.WTF=i,!c.message.match(/SYLK bad record ID/)&&i)throw c;return Lo.to_workbook(e,a)}}var Bl=(function(){function e(I,L,Q){if(I){kr(I,I.l||0);for(var te=Q.Enum||Ke;I.l<I.length;){var ge=I.read_shift(2),je=te[ge]||te[65535],ze=I.read_shift(2),Oe=I.l+ze,Ue=je.f&&je.f(I,ze,Q);if(I.l=Oe,L(Ue,je,ge))return}}}function a(I,L){switch(L.type){case"base64":return t(Cn(wn(I)),L);case"binary":return t(Cn(I),L);case"buffer":case"array":return t(I,L)}throw"Unsupported type "+L.type}function t(I,L){if(!I)return I;var Q=L||{},te=Q.dense?[]:{},ge="Sheet1",je="",ze=0,Oe={},Ue=[],St=[],Z={s:{r:0,c:0},e:{r:0,c:0}},Jt=Q.sheetRows||0;if(I[2]==0&&(I[3]==8||I[3]==9)&&I.length>=16&&I[14]==5&&I[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(I[2]==2)Q.Enum=Ke,e(I,function(at,Ta,Ia){switch(Ia){case 0:Q.vers=at,at>=4096&&(Q.qpro=!0);break;case 6:Z=at;break;case 204:at&&(je=at);break;case 222:je=at;break;case 15:case 51:Q.qpro||(at[1].v=at[1].v.slice(1));case 13:case 14:case 16:Ia==14&&(at[2]&112)==112&&(at[2]&15)>1&&(at[2]&15)<15&&(at[1].z=Q.dateNF||mt[14],Q.cellDates&&(at[1].t="d",at[1].v=ff(at[1].v))),Q.qpro&&at[3]>ze&&(te["!ref"]=wt(Z),Oe[ge]=te,Ue.push(ge),te=Q.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},ze=at[3],ge=je||"Sheet"+(ze+1),je="");var nr=Q.dense?(te[at[0].r]||[])[at[0].c]:te[bt(at[0])];if(nr){nr.t=at[1].t,nr.v=at[1].v,at[1].z!=null&&(nr.z=at[1].z),at[1].f!=null&&(nr.f=at[1].f);break}Q.dense?(te[at[0].r]||(te[at[0].r]=[]),te[at[0].r][at[0].c]=at[1]):te[bt(at[0])]=at[1];break}},Q);else if(I[2]==26||I[2]==14)Q.Enum=ee,I[2]==14&&(Q.qpro=!0,I.l=0),e(I,function(at,Ta,Ia){switch(Ia){case 204:ge=at;break;case 22:at[1].v=at[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(at[3]>ze&&(te["!ref"]=wt(Z),Oe[ge]=te,Ue.push(ge),te=Q.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},ze=at[3],ge="Sheet"+(ze+1)),Jt>0&&at[0].r>=Jt)break;Q.dense?(te[at[0].r]||(te[at[0].r]=[]),te[at[0].r][at[0].c]=at[1]):te[bt(at[0])]=at[1],Z.e.c<at[0].c&&(Z.e.c=at[0].c),Z.e.r<at[0].r&&(Z.e.r=at[0].r);break;case 27:at[14e3]&&(St[at[14e3][0]]=at[14e3][1]);break;case 1537:St[at[0]]=at[1],at[0]==ze&&(ge=at[1]);break}},Q);else throw new Error("Unrecognized LOTUS BOF "+I[2]);if(te["!ref"]=wt(Z),Oe[je||ge]=te,Ue.push(je||ge),!St.length)return{SheetNames:Ue,Sheets:Oe};for(var At={},Gt=[],Ct=0;Ct<St.length;++Ct)Oe[Ue[Ct]]?(Gt.push(St[Ct]||Ue[Ct]),At[St[Ct]]=Oe[St[Ct]]||Oe[Ue[Ct]]):(Gt.push(St[Ct]),At[St[Ct]]={"!ref":"A1"});return{SheetNames:Gt,Sheets:At}}function i(I,L){var Q=L||{};if(+Q.codepage>=0&&hi(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK1 to JS string");var te=fn(),ge=Qt(I["!ref"]),je=Array.isArray(I),ze=[];Qe(te,0,c(1030)),Qe(te,6,g(ge));for(var Oe=Math.min(ge.e.r,8191),Ue=ge.s.r;Ue<=Oe;++Ue)for(var St=Xa(Ue),Z=ge.s.c;Z<=ge.e.c;++Z){Ue===ge.s.r&&(ze[Z]=ja(Z));var Jt=ze[Z]+St,At=je?(I[Ue]||[])[Z]:I[Jt];if(!(!At||At.t=="z"))if(At.t=="n")(At.v|0)==At.v&&At.v>=-32768&&At.v<=32767?Qe(te,13,w(Ue,Z,At.v)):Qe(te,14,k(Ue,Z,At.v));else{var Gt=is(At);Qe(te,15,A(Ue,Z,Gt.slice(0,239)))}}return Qe(te,1),te.end()}function s(I,L){var Q=L||{};if(+Q.codepage>=0&&hi(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK3 to JS string");var te=fn();Qe(te,0,f(I));for(var ge=0,je=0;ge<I.SheetNames.length;++ge)(I.Sheets[I.SheetNames[ge]]||{})["!ref"]&&Qe(te,27,fe(I.SheetNames[ge],je++));var ze=0;for(ge=0;ge<I.SheetNames.length;++ge){var Oe=I.Sheets[I.SheetNames[ge]];if(!(!Oe||!Oe["!ref"])){for(var Ue=Qt(Oe["!ref"]),St=Array.isArray(Oe),Z=[],Jt=Math.min(Ue.e.r,8191),At=Ue.s.r;At<=Jt;++At)for(var Gt=Xa(At),Ct=Ue.s.c;Ct<=Ue.e.c;++Ct){At===Ue.s.r&&(Z[Ct]=ja(Ct));var at=Z[Ct]+Gt,Ta=St?(Oe[At]||[])[Ct]:Oe[at];if(!(!Ta||Ta.t=="z"))if(Ta.t=="n")Qe(te,23,m(At,Ct,ze,Ta.v));else{var Ia=is(Ta);Qe(te,22,H(At,Ct,ze,Ia.slice(0,239)))}}++ze}}return Qe(te,1),te.end()}function c(I){var L=Ne(2);return L.write_shift(2,I),L}function f(I){var L=Ne(26);L.write_shift(2,4096),L.write_shift(2,4),L.write_shift(4,0);for(var Q=0,te=0,ge=0,je=0;je<I.SheetNames.length;++je){var ze=I.SheetNames[je],Oe=I.Sheets[ze];if(!(!Oe||!Oe["!ref"])){++ge;var Ue=un(Oe["!ref"]);Q<Ue.e.r&&(Q=Ue.e.r),te<Ue.e.c&&(te=Ue.e.c)}}return Q>8191&&(Q=8191),L.write_shift(2,Q),L.write_shift(1,ge),L.write_shift(1,te),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,1),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(4,0),L}function p(I,L,Q){var te={s:{c:0,r:0},e:{c:0,r:0}};return L==8&&Q.qpro?(te.s.c=I.read_shift(1),I.l++,te.s.r=I.read_shift(2),te.e.c=I.read_shift(1),I.l++,te.e.r=I.read_shift(2),te):(te.s.c=I.read_shift(2),te.s.r=I.read_shift(2),L==12&&Q.qpro&&(I.l+=2),te.e.c=I.read_shift(2),te.e.r=I.read_shift(2),L==12&&Q.qpro&&(I.l+=2),te.s.c==65535&&(te.s.c=te.e.c=te.s.r=te.e.r=0),te)}function g(I){var L=Ne(8);return L.write_shift(2,I.s.c),L.write_shift(2,I.s.r),L.write_shift(2,I.e.c),L.write_shift(2,I.e.r),L}function h(I,L,Q){var te=[{c:0,r:0},{t:"n",v:0},0,0];return Q.qpro&&Q.vers!=20768?(te[0].c=I.read_shift(1),te[3]=I.read_shift(1),te[0].r=I.read_shift(2),I.l+=2):(te[2]=I.read_shift(1),te[0].c=I.read_shift(2),te[0].r=I.read_shift(2)),te}function E(I,L,Q){var te=I.l+L,ge=h(I,L,Q);if(ge[1].t="s",Q.vers==20768){I.l++;var je=I.read_shift(1);return ge[1].v=I.read_shift(je,"utf8"),ge}return Q.qpro&&I.l++,ge[1].v=I.read_shift(te-I.l,"cstr"),ge}function A(I,L,Q){var te=Ne(7+Q.length);te.write_shift(1,255),te.write_shift(2,L),te.write_shift(2,I),te.write_shift(1,39);for(var ge=0;ge<te.length;++ge){var je=Q.charCodeAt(ge);te.write_shift(1,je>=128?95:je)}return te.write_shift(1,0),te}function _(I,L,Q){var te=h(I,L,Q);return te[1].v=I.read_shift(2,"i"),te}function w(I,L,Q){var te=Ne(7);return te.write_shift(1,255),te.write_shift(2,L),te.write_shift(2,I),te.write_shift(2,Q,"i"),te}function N(I,L,Q){var te=h(I,L,Q);return te[1].v=I.read_shift(8,"f"),te}function k(I,L,Q){var te=Ne(13);return te.write_shift(1,255),te.write_shift(2,L),te.write_shift(2,I),te.write_shift(8,Q,"f"),te}function F(I,L,Q){var te=I.l+L,ge=h(I,L,Q);if(ge[1].v=I.read_shift(8,"f"),Q.qpro)I.l=te;else{var je=I.read_shift(2);ie(I.slice(I.l,I.l+je),ge),I.l+=je}return ge}function z(I,L,Q){var te=L&32768;return L&=-32769,L=(te?I:0)+(L>=8192?L-16384:L),(te?"":"$")+(Q?ja(L):Xa(L))}var K={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},M=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function ie(I,L){kr(I,0);for(var Q=[],te=0,ge="",je="",ze="",Oe="";I.l<I.length;){var Ue=I[I.l++];switch(Ue){case 0:Q.push(I.read_shift(8,"f"));break;case 1:je=z(L[0].c,I.read_shift(2),!0),ge=z(L[0].r,I.read_shift(2),!1),Q.push(je+ge);break;case 2:{var St=z(L[0].c,I.read_shift(2),!0),Z=z(L[0].r,I.read_shift(2),!1);je=z(L[0].c,I.read_shift(2),!0),ge=z(L[0].r,I.read_shift(2),!1),Q.push(St+Z+":"+je+ge)}break;case 3:if(I.l<I.length){console.error("WK1 premature formula end");return}break;case 4:Q.push("("+Q.pop()+")");break;case 5:Q.push(I.read_shift(2));break;case 6:{for(var Jt="";Ue=I[I.l++];)Jt+=String.fromCharCode(Ue);Q.push('"'+Jt.replace(/"/g,'""')+'"')}break;case 8:Q.push("-"+Q.pop());break;case 23:Q.push("+"+Q.pop());break;case 22:Q.push("NOT("+Q.pop()+")");break;case 20:case 21:Oe=Q.pop(),ze=Q.pop(),Q.push(["AND","OR"][Ue-20]+"("+ze+","+Oe+")");break;default:if(Ue<32&&M[Ue])Oe=Q.pop(),ze=Q.pop(),Q.push(ze+M[Ue]+Oe);else if(K[Ue]){if(te=K[Ue][1],te==69&&(te=I[I.l++]),te>Q.length){console.error("WK1 bad formula parse 0x"+Ue.toString(16)+":|"+Q.join("|")+"|");return}var At=Q.slice(-te);Q.length-=te,Q.push(K[Ue][0]+"("+At.join(",")+")")}else return Ue<=7?console.error("WK1 invalid opcode "+Ue.toString(16)):Ue<=24?console.error("WK1 unsupported op "+Ue.toString(16)):Ue<=30?console.error("WK1 invalid opcode "+Ue.toString(16)):Ue<=115?console.error("WK1 unsupported function opcode "+Ue.toString(16)):console.error("WK1 unrecognized opcode "+Ue.toString(16))}}Q.length==1?L[1].f=""+Q[0]:console.error("WK1 bad formula parse |"+Q.join("|")+"|")}function se(I){var L=[{c:0,r:0},{t:"n",v:0},0];return L[0].r=I.read_shift(2),L[3]=I[I.l++],L[0].c=I[I.l++],L}function ne(I,L){var Q=se(I);return Q[1].t="s",Q[1].v=I.read_shift(L-4,"cstr"),Q}function H(I,L,Q,te){var ge=Ne(6+te.length);ge.write_shift(2,I),ge.write_shift(1,Q),ge.write_shift(1,L),ge.write_shift(1,39);for(var je=0;je<te.length;++je){var ze=te.charCodeAt(je);ge.write_shift(1,ze>=128?95:ze)}return ge.write_shift(1,0),ge}function le(I,L){var Q=se(I);Q[1].v=I.read_shift(2);var te=Q[1].v>>1;if(Q[1].v&1)switch(te&7){case 0:te=(te>>3)*5e3;break;case 1:te=(te>>3)*500;break;case 2:te=(te>>3)/20;break;case 3:te=(te>>3)/200;break;case 4:te=(te>>3)/2e3;break;case 5:te=(te>>3)/2e4;break;case 6:te=(te>>3)/16;break;case 7:te=(te>>3)/64;break}return Q[1].v=te,Q}function oe(I,L){var Q=se(I),te=I.read_shift(4),ge=I.read_shift(4),je=I.read_shift(2);if(je==65535)return te===0&&ge===3221225472?(Q[1].t="e",Q[1].v=15):te===0&&ge===3489660928?(Q[1].t="e",Q[1].v=42):Q[1].v=0,Q;var ze=je&32768;return je=(je&32767)-16446,Q[1].v=(1-ze*2)*(ge*Math.pow(2,je+32)+te*Math.pow(2,je)),Q}function m(I,L,Q,te){var ge=Ne(14);if(ge.write_shift(2,I),ge.write_shift(1,Q),ge.write_shift(1,L),te==0)return ge.write_shift(4,0),ge.write_shift(4,0),ge.write_shift(2,65535),ge;var je=0,ze=0,Oe=0,Ue=0;return te<0&&(je=1,te=-te),ze=Math.log2(te)|0,te/=Math.pow(2,ze-31),Ue=te>>>0,(Ue&2147483648)==0&&(te/=2,++ze,Ue=te>>>0),te-=Ue,Ue|=2147483648,Ue>>>=0,te*=Math.pow(2,32),Oe=te>>>0,ge.write_shift(4,Oe),ge.write_shift(4,Ue),ze+=16383+(je?32768:0),ge.write_shift(2,ze),ge}function Se(I,L){var Q=oe(I);return I.l+=L-14,Q}function ue(I,L){var Q=se(I),te=I.read_shift(4);return Q[1].v=te>>6,Q}function Pe(I,L){var Q=se(I),te=I.read_shift(8,"f");return Q[1].v=te,Q}function et(I,L){var Q=Pe(I);return I.l+=L-10,Q}function ke(I,L){return I[I.l+L-1]==0?I.read_shift(L,"cstr"):""}function de(I,L){var Q=I[I.l++];Q>L-1&&(Q=L-1);for(var te="";te.length<Q;)te+=String.fromCharCode(I[I.l++]);return te}function Ce(I,L,Q){if(!(!Q.qpro||L<21)){var te=I.read_shift(1);I.l+=17,I.l+=1,I.l+=2;var ge=I.read_shift(L-21,"cstr");return[te,ge]}}function Je(I,L){for(var Q={},te=I.l+L;I.l<te;){var ge=I.read_shift(2);if(ge==14e3){for(Q[ge]=[0,""],Q[ge][0]=I.read_shift(2);I[I.l];)Q[ge][1]+=String.fromCharCode(I[I.l]),I.l++;I.l++}}return Q}function fe(I,L){var Q=Ne(5+I.length);Q.write_shift(2,14e3),Q.write_shift(2,L);for(var te=0;te<I.length;++te){var ge=I.charCodeAt(te);Q[Q.l++]=ge>127?95:ge}return Q[Q.l++]=0,Q}var Ke={0:{n:"BOF",f:rr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:p},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:N},15:{n:"LABEL",f:E},16:{n:"FORMULA",f:F},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:E},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ke},222:{n:"SHEETNAMELP",f:de},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:ne},23:{n:"NUMBER17",f:oe},24:{n:"NUMBER18",f:le},25:{n:"FORMULA19",f:Se},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Je},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ue},38:{n:"??"},39:{n:"NUMBER27",f:Pe},40:{n:"FORMULA28",f:et},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ke},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ce},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:s,to_workbook:a}})();function bA(e){var a={},t=e.match($r),i=0,s=!1;if(t)for(;i!=t.length;++i){var c=Et(t[i]);switch(c[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!c.val)break;case"<shadow>":case"<shadow/>":a.shadow=1;break;case"</shadow>":break;case"<charset":if(c.val=="1")break;a.cp=Yp[parseInt(c.val,10)];break;case"<outline":if(!c.val)break;case"<outline>":case"<outline/>":a.outline=1;break;case"</outline>":break;case"<rFont":a.name=c.val;break;case"<sz":a.sz=c.val;break;case"<strike":if(!c.val)break;case"<strike>":case"<strike/>":a.strike=1;break;case"</strike>":break;case"<u":if(!c.val)break;switch(c.val){case"double":a.uval="double";break;case"singleAccounting":a.uval="single-accounting";break;case"doubleAccounting":a.uval="double-accounting";break}case"<u>":case"<u/>":a.u=1;break;case"</u>":break;case"<b":if(c.val=="0")break;case"<b>":case"<b/>":a.b=1;break;case"</b>":break;case"<i":if(c.val=="0")break;case"<i>":case"<i/>":a.i=1;break;case"</i>":break;case"<color":c.rgb&&(a.color=c.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":a.family=c.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":a.valign=c.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(c[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+c[0])}}return a}var SA=(function(){var e=qc("t"),a=qc("rPr");function t(c){var f=c.match(e);if(!f)return{t:"s",v:""};var p={t:"s",v:Kt(f[1])},g=c.match(a);return g&&(p.s=bA(g[1])),p}var i=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(f){return f.replace(i,"").split(s).map(t).filter(function(p){return p.v})}})(),EA=(function(){var a=/(\r\n|\n)/g;function t(s,c,f){var p=[];s.u&&p.push("text-decoration: underline;"),s.uval&&p.push("text-underline-style:"+s.uval+";"),s.sz&&p.push("font-size:"+s.sz+"pt;"),s.outline&&p.push("text-effect: outline;"),s.shadow&&p.push("text-shadow: auto;"),c.push('<span style="'+p.join("")+'">'),s.b&&(c.push("<b>"),f.push("</b>")),s.i&&(c.push("<i>"),f.push("</i>")),s.strike&&(c.push("<s>"),f.push("</s>"));var g=s.valign||"";return g=="superscript"||g=="super"?g="sup":g=="subscript"&&(g="sub"),g!=""&&(c.push("<"+g+">"),f.push("</"+g+">")),f.push("</span>"),s}function i(s){var c=[[],s.v,[]];return s.v?(s.s&&t(s.s,c[0],c[2]),c[0].join("")+c[1].replace(a,"<br/>")+c[2].join("")):""}return function(c){return c.map(i).join("")}})(),TA=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,AA=/<(?:\w+:)?r>/,_A=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function hh(e,a){var t=a?a.cellHTML:!0,i={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(i.t=Kt(xa(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),i.r=xa(e),t&&(i.h=eh(i.t))):e.match(AA)&&(i.r=xa(e),i.t=Kt(xa((e.replace(_A,"").match(TA)||[]).join("").replace($r,""))),t&&(i.h=EA(SA(i.r)))),i):{t:""}}var CA=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,kA=/<(?:\w+:)?(?:si|sstItem)>/g,wA=/<\/(?:\w+:)?(?:si|sstItem)>/;function RA(e,a){var t=[],i="";if(!e)return t;var s=e.match(CA);if(s){i=s[2].replace(kA,"").split(wA);for(var c=0;c!=i.length;++c){var f=hh(i[c].trim(),a);f!=null&&(t[t.length]=f)}s=Et(s[1]),t.Count=s.count,t.Unique=s.uniqueCount}return t}var NA=/^\s|\s$|[\t\n\r]/;function ov(e,a){if(!a.bookSST)return"";var t=[qa];t[t.length]=qe("sst",null,{xmlns:Yl[0],count:e.Count,uniqueCount:e.Unique});for(var i=0;i!=e.length;++i)if(e[i]!=null){var s=e[i],c="<si>";s.r?c+=s.r:(c+="<t",s.t||(s.t=""),s.t.match(NA)&&(c+=' xml:space="preserve"'),c+=">"+fa(s.t)+"</t>"),c+="</si>",t[t.length]=c}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function FA(e){return[e.read_shift(4),e.read_shift(4)]}function DA(e,a){var t=[],i=!1;return ls(e,function(c,f,p){switch(p){case 159:t.Count=c[0],t.Unique=c[1];break;case 19:t.push(c);break;case 160:return!0;case 35:i=!0;break;case 36:i=!1;break;default:if(f.T,!i||a.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}),t}function jA(e,a){return a||(a=Ne(8)),a.write_shift(4,e.Count),a.write_shift(4,e.Unique),a}var OA=YS;function IA(e){var a=fn();$e(a,159,jA(e));for(var t=0;t<e.length;++t)$e(a,19,OA(e[t]));return $e(a,160),a.end()}function cv(e){for(var a=[],t=e.split(""),i=0;i<t.length;++i)a[i]=t[i].charCodeAt(0);return a}function ns(e,a){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),a>=4&&(e.l+=a-4),t}function BA(e){var a={};return a.id=e.read_shift(0,"lpp4"),a.R=ns(e,4),a.U=ns(e,4),a.W=ns(e,4),a}function MA(e){for(var a=e.read_shift(4),t=e.l+a-4,i={},s=e.read_shift(4),c=[];s-- >0;)c.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(i.name=e.read_shift(0,"lpp4"),i.comps=c,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return i}function LA(e){var a=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)a.push(MA(e));return a}function PA(e){var a=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)a.push(e.read_shift(0,"lpp4"));return a}function zA(e){var a={};return e.read_shift(4),e.l+=4,a.id=e.read_shift(0,"lpp4"),a.name=e.read_shift(0,"lpp4"),a.R=ns(e,4),a.U=ns(e,4),a.W=ns(e,4),a}function UA(e){var a=zA(e);if(a.ename=e.read_shift(0,"8lpp4"),a.blksz=e.read_shift(4),a.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return a}function dv(e,a){var t=e.l+a,i={};i.Flags=e.read_shift(4)&63,e.l+=4,i.AlgID=e.read_shift(4);var s=!1;switch(i.AlgID){case 26126:case 26127:case 26128:s=i.Flags==36;break;case 26625:s=i.Flags==4;break;case 0:s=i.Flags==16||i.Flags==4||i.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+i.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return i.AlgIDHash=e.read_shift(4),i.KeySize=e.read_shift(4),i.ProviderType=e.read_shift(4),e.l+=8,i.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,i}function fv(e,a){var t={},i=e.l+a;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,i),e.l=i,t}function HA(e){var a=ns(e);switch(a.Minor){case 2:return[a.Minor,$A(e)];case 3:return[a.Minor,YA()];case 4:return[a.Minor,GA(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+a.Minor)}function $A(e){var a=e.read_shift(4);if((a&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),i=dv(e,t),s=fv(e,e.length-e.l);return{t:"Std",h:i,v:s}}function YA(){throw new Error("File is password-protected: ECMA-376 Extensible")}function GA(e){var a=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),i={};return t.replace($r,function(c){var f=Et(c);switch(Fi(f[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":a.forEach(function(p){i[p]=f[p]});break;case"<dataIntegrity":i.encryptedHmacKey=f.encryptedHmacKey,i.encryptedHmacValue=f.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":i.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":i.uri=f.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":i.encs.push(f);break;default:throw f[0]}}),i}function WA(e,a){var t={},i=t.EncryptionVersionInfo=ns(e,4);if(a-=4,i.Minor!=2)throw new Error("unrecognized minor version code: "+i.Minor);if(i.Major>4||i.Major<2)throw new Error("unrecognized major version code: "+i.Major);t.Flags=e.read_shift(4),a-=4;var s=e.read_shift(4);return a-=4,t.EncryptionHeader=dv(e,s),a-=s,t.EncryptionVerifier=fv(e,a),t}function VA(e){var a={},t=a.EncryptionVersionInfo=ns(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return a.Salt=e.read_shift(16),a.EncryptedVerifier=e.read_shift(16),a.EncryptedVerifierHash=e.read_shift(16),a}function gh(e){var a=0,t,i=cv(e),s=i.length+1,c,f,p,g,h;for(t=Ks(s),t[0]=i.length,c=1;c!=s;++c)t[c]=i[c-1];for(c=s-1;c>=0;--c)f=t[c],p=(a&16384)===0?0:1,g=a<<1&32767,h=p|g,a=h^f;return a^52811}var uv=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],a=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],i=function(f){return(f/2|f*128)&255},s=function(f,p){return i(f^p)},c=function(f){for(var p=a[f.length-1],g=104,h=f.length-1;h>=0;--h)for(var E=f[h],A=0;A!=7;++A)E&64&&(p^=t[g]),E*=2,--g;return p};return function(f){for(var p=cv(f),g=c(p),h=p.length,E=Ks(16),A=0;A!=16;++A)E[A]=0;var _,w,N;for((h&1)===1&&(_=g>>8,E[h]=s(e[0],_),--h,_=g&255,w=p[p.length-1],E[h]=s(w,_));h>0;)--h,_=g>>8,E[h]=s(p[h],_),--h,_=g&255,E[h]=s(p[h],_);for(h=15,N=15-p.length;N>0;)_=g>>8,E[h]=s(e[N],_),--h,--N,_=g&255,E[h]=s(p[h],_),--h,--N;return E}})(),XA=function(e,a,t,i,s){s||(s=a),i||(i=uv(e));var c,f;for(c=0;c!=a.length;++c)f=a[c],f^=i[t],f=(f>>5|f<<3)&255,s[c]=f,++t;return[s,t,i]},qA=function(e){var a=0,t=uv(e);return function(i){var s=XA("",i,a,t);return a=s[1],s[0]}};function KA(e,a,t,i){var s={key:rr(e),verificationBytes:rr(e)};return t.password&&(s.verifier=gh(t.password)),i.valid=s.verificationBytes===s.verifier,i.valid&&(i.insitu=qA(t.password)),s}function QA(e,a,t){var i=t||{};return i.Info=e.read_shift(2),e.l-=2,i.Info===1?i.Data=VA(e):i.Data=WA(e,a),i}function JA(e,a,t){var i={Type:t.biff>=8?e.read_shift(2):0};return i.Type?QA(e,a-2,i):KA(e,t.biff>=8?a:a-2,t,i),i}var pv=(function(){function e(s,c){switch(c.type){case"base64":return a(wn(s),c);case"binary":return a(s,c);case"buffer":return a(It&&Buffer.isBuffer(s)?s.toString("binary"):el(s),c);case"array":return a(Pl(s),c)}throw new Error("Unrecognized type "+c.type)}function a(s,c){var f=c||{},p=f.dense?[]:{},g=s.match(/\\trowd.*?\\row\b/g);if(!g.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:g.length-1}};return g.forEach(function(E,A){Array.isArray(p)&&(p[A]=[]);for(var _=/\\\w+\b/g,w=0,N,k=-1;N=_.exec(E);){switch(N[0]){case"\\cell":var F=E.slice(w,_.lastIndex-N[0].length);if(F[0]==" "&&(F=F.slice(1)),++k,F.length){var z={v:F,t:"s"};Array.isArray(p)?p[A][k]=z:p[bt({r:A,c:k})]=z}break}w=_.lastIndex}k>h.e.c&&(h.e.c=k)}),p["!ref"]=wt(h),p}function t(s,c){return tl(e(s,c),c)}function i(s){for(var c=["{\\rtf1\\ansi"],f=Qt(s["!ref"]),p,g=Array.isArray(s),h=f.s.r;h<=f.e.r;++h){c.push("\\trowd\\trautofit1");for(var E=f.s.c;E<=f.e.c;++E)c.push("\\cellx"+(E+1));for(c.push("\\pard\\intbl"),E=f.s.c;E<=f.e.c;++E){var A=bt({r:h,c:E});p=g?(s[h]||[])[E]:s[A],!(!p||p.v==null&&(!p.f||p.F))&&(c.push(" "+(p.w||(is(p),p.w))),c.push("\\cell"))}c.push("\\pard\\intbl\\row")}return c.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:i}})();function ZA(e){var a=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(a.slice(0,2),16),parseInt(a.slice(2,4),16),parseInt(a.slice(4,6),16)]}function Zc(e){for(var a=0,t=1;a!=3;++a)t=t*256+(e[a]>255?255:e[a]<0?0:e[a]);return t.toString(16).toUpperCase().slice(1)}function e_(e){var a=e[0]/255,t=e[1]/255,i=e[2]/255,s=Math.max(a,t,i),c=Math.min(a,t,i),f=s-c;if(f===0)return[0,0,a];var p=0,g=0,h=s+c;switch(g=f/(h>1?2-h:h),s){case a:p=((t-i)/f+6)%6;break;case t:p=(i-a)/f+2;break;case i:p=(a-t)/f+4;break}return[p/6,g,h/2]}function t_(e){var a=e[0],t=e[1],i=e[2],s=t*2*(i<.5?i:1-i),c=i-s/2,f=[c,c,c],p=6*a,g;if(t!==0)switch(p|0){case 0:case 6:g=s*p,f[0]+=s,f[1]+=g;break;case 1:g=s*(2-p),f[0]+=g,f[1]+=s;break;case 2:g=s*(p-2),f[1]+=s,f[2]+=g;break;case 3:g=s*(4-p),f[1]+=g,f[2]+=s;break;case 4:g=s*(p-4),f[2]+=s,f[0]+=g;break;case 5:g=s*(6-p),f[2]+=g,f[0]+=s;break}for(var h=0;h!=3;++h)f[h]=Math.round(f[h]*255);return f}function af(e,a){if(a===0)return e;var t=e_(ZA(e));return a<0?t[2]=t[2]*(1+a):t[2]=1-(1-t[2])*(1-a),Zc(t_(t))}var hv=6,a_=15,r_=1,Pr=hv;function e0(e){return Math.floor((e+Math.round(128/Pr)/256)*Pr)}function t0(e){return Math.floor((e-5)/Pr*100+.5)/100}function rf(e){return Math.round((e*Pr+5)/Pr*256)/256}function Ep(e){return rf(t0(e0(e)))}function xh(e){var a=Math.abs(e-Ep(e)),t=Pr;if(a>.005)for(Pr=r_;Pr<a_;++Pr)Math.abs(e-Ep(e))<=a&&(a=Math.abs(e-Ep(e)),t=Pr);Pr=t}function Qs(e){e.width?(e.wpx=e0(e.width),e.wch=t0(e.wpx),e.MDW=Pr):e.wpx?(e.wch=t0(e.wpx),e.width=rf(e.wch),e.MDW=Pr):typeof e.wch=="number"&&(e.width=rf(e.wch),e.wpx=e0(e.width),e.MDW=Pr),e.customWidth&&delete e.customWidth}var n_=96,gv=n_;function a0(e){return e*96/gv}function Po(e){return e*gv/96}var i_={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function s_(e,a,t,i){a.Borders=[];var s={},c=!1;(e[0].match($r)||[]).forEach(function(f){var p=Et(f);switch(Fi(p[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},p.diagonalUp&&(s.diagonalUp=Ca(p.diagonalUp)),p.diagonalDown&&(s.diagonalDown=Ca(p.diagonalDown)),a.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(i&&i.WTF&&!c)throw new Error("unrecognized "+p[0]+" in borders")}})}function l_(e,a,t,i){a.Fills=[];var s={},c=!1;(e[0].match($r)||[]).forEach(function(f){var p=Et(f);switch(Fi(p[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},a.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":a.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":p.patternType&&(s.patternType=p.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),p.indexed&&(s.bgColor.indexed=parseInt(p.indexed,10)),p.theme&&(s.bgColor.theme=parseInt(p.theme,10)),p.tint&&(s.bgColor.tint=parseFloat(p.tint)),p.rgb&&(s.bgColor.rgb=p.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),p.theme&&(s.fgColor.theme=parseInt(p.theme,10)),p.tint&&(s.fgColor.tint=parseFloat(p.tint)),p.rgb!=null&&(s.fgColor.rgb=p.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(i&&i.WTF&&!c)throw new Error("unrecognized "+p[0]+" in fills")}})}function o_(e,a,t,i){a.Fonts=[];var s={},c=!1;(e[0].match($r)||[]).forEach(function(f){var p=Et(f);switch(Fi(p[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":a.Fonts.push(s),s={};break;case"<name":p.val&&(s.name=xa(p.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=p.val?Ca(p.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=p.val?Ca(p.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(p.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=p.val?Ca(p.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=p.val?Ca(p.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=p.val?Ca(p.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=p.val?Ca(p.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=p.val?Ca(p.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":p.val&&(s.sz=+p.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":p.val&&(s.vertAlign=p.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":p.val&&(s.family=parseInt(p.val,10));break;case"<family/>":case"</family>":break;case"<scheme":p.val&&(s.scheme=p.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(p.val=="1")break;p.codepage=Yp[parseInt(p.val,10)];break;case"<color":if(s.color||(s.color={}),p.auto&&(s.color.auto=Ca(p.auto)),p.rgb)s.color.rgb=p.rgb.slice(-6);else if(p.indexed){s.color.index=parseInt(p.indexed,10);var g=Ol[s.color.index];s.color.index==81&&(g=Ol[1]),g||(g=Ol[1]),s.color.rgb=g[0].toString(16)+g[1].toString(16)+g[2].toString(16)}else p.theme&&(s.color.theme=parseInt(p.theme,10),p.tint&&(s.color.tint=parseFloat(p.tint)),p.theme&&t.themeElements&&t.themeElements.clrScheme&&(s.color.rgb=af(t.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":c=!0;break;case"</AlternateContent>":c=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":c=!0;break;case"</ext>":c=!1;break;default:if(i&&i.WTF&&!c)throw new Error("unrecognized "+p[0]+" in fonts")}})}function c_(e,a,t){a.NumberFmt=[];for(var i=Ua(mt),s=0;s<i.length;++s)a.NumberFmt[i[s]]=mt[i[s]];var c=e[0].match($r);if(c)for(s=0;s<c.length;++s){var f=Et(c[s]);switch(Fi(f[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var p=Kt(xa(f.formatCode)),g=parseInt(f.numFmtId,10);if(a.NumberFmt[g]=p,g>0){if(g>392){for(g=392;g>60&&a.NumberFmt[g]!=null;--g);a.NumberFmt[g]=p}rs(p,g)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+f[0]+" in numFmts")}}}function d_(e){var a=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var i=t[0];i<=t[1];++i)e[i]!=null&&(a[a.length]=qe("numFmt",null,{numFmtId:i,formatCode:fa(e[i])}))}),a.length===1?"":(a[a.length]="</numFmts>",a[0]=qe("numFmts",null,{count:a.length-2}).replace("/>",">"),a.join(""))}var Hd=["numFmtId","fillId","fontId","borderId","xfId"],$d=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function f_(e,a,t){a.CellXf=[];var i,s=!1;(e[0].match($r)||[]).forEach(function(c){var f=Et(c),p=0;switch(Fi(f[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(i=f,delete i[0],p=0;p<Hd.length;++p)i[Hd[p]]&&(i[Hd[p]]=parseInt(i[Hd[p]],10));for(p=0;p<$d.length;++p)i[$d[p]]&&(i[$d[p]]=Ca(i[$d[p]]));if(a.NumberFmt&&i.numFmtId>392){for(p=392;p>60;--p)if(a.NumberFmt[i.numFmtId]==a.NumberFmt[p]){i.numFmtId=p;break}}a.CellXf.push(i);break;case"</xf>":break;case"<alignment":case"<alignment/>":var g={};f.vertical&&(g.vertical=f.vertical),f.horizontal&&(g.horizontal=f.horizontal),f.textRotation!=null&&(g.textRotation=f.textRotation),f.indent&&(g.indent=f.indent),f.wrapText&&(g.wrapText=Ca(f.wrapText)),i.alignment=g;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(t&&t.WTF&&!s)throw new Error("unrecognized "+f[0]+" in cellXfs")}})}function u_(e){var a=[];return a[a.length]=qe("cellXfs",null),e.forEach(function(t){a[a.length]=qe("xf",null,t)}),a[a.length]="</cellXfs>",a.length===2?"":(a[0]=qe("cellXfs",null,{count:a.length-2}).replace("/>",">"),a.join(""))}var p_=(function(){var a=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,i=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,c=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(p,g,h){var E={};if(!p)return E;p=p.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var A;return(A=p.match(a))&&c_(A,E,h),(A=p.match(s))&&o_(A,E,g,h),(A=p.match(i))&&l_(A,E,g,h),(A=p.match(c))&&s_(A,E,g,h),(A=p.match(t))&&f_(A,E,h),E}})();function xv(e,a){var t=[qa,qe("styleSheet",null,{xmlns:Yl[0],"xmlns:vt":dr.vt})],i;return e.SSF&&(i=d_(e.SSF))!=null&&(t[t.length]=i),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=u_(a.cellXfs))&&(t[t.length]=i),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function h_(e,a){var t=e.read_shift(2),i=Ur(e);return[t,i]}function g_(e,a,t){t||(t=Ne(6+4*a.length)),t.write_shift(2,e),vr(a,t);var i=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),i}function x_(e,a,t){var i={};i.sz=e.read_shift(2)/20;var s=QS(e);s.fItalic&&(i.italic=1),s.fCondense&&(i.condense=1),s.fExtend&&(i.extend=1),s.fShadow&&(i.shadow=1),s.fOutline&&(i.outline=1),s.fStrikeout&&(i.strike=1);var c=e.read_shift(2);switch(c===700&&(i.bold=1),e.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var f=e.read_shift(1);f!=0&&(i.underline=f);var p=e.read_shift(1);p>0&&(i.family=p);var g=e.read_shift(1);switch(g>0&&(i.charset=g),e.l++,i.color=KS(e),e.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=Ur(e),i}function m_(e,a){a||(a=Ne(153)),a.write_shift(2,e.sz*20),JS(e,a),a.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),a.write_shift(2,t),a.write_shift(1,e.underline||0),a.write_shift(1,e.family||0),a.write_shift(1,e.charset||0),a.write_shift(1,0),Zd(e.color,a);var i=0;return i=2,a.write_shift(1,i),vr(e.name,a),a.length>a.l?a.slice(0,a.l):a}var y_=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Tp,v_=Hr;function Cm(e,a){a||(a=Ne(84)),Tp||(Tp=cf(y_));var t=Tp[e.patternType];t==null&&(t=40),a.write_shift(4,t);var i=0;if(t!=40)for(Zd({auto:1},a),Zd({auto:1},a);i<12;++i)a.write_shift(4,0);else{for(;i<4;++i)a.write_shift(4,0);for(;i<12;++i)a.write_shift(4,0)}return a.length>a.l?a.slice(0,a.l):a}function b_(e,a){var t=e.l+a,i=e.read_shift(2),s=e.read_shift(2);return e.l=t,{ixfe:i,numFmtId:s}}function mv(e,a,t){t||(t=Ne(16)),t.write_shift(2,a||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var i=0;return t.write_shift(1,i),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Oc(e,a){return a||(a=Ne(10)),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(4,0),a.write_shift(4,0),a}var S_=Hr;function E_(e,a){return a||(a=Ne(51)),a.write_shift(1,0),Oc(null,a),Oc(null,a),Oc(null,a),Oc(null,a),Oc(null,a),a.length>a.l?a.slice(0,a.l):a}function T_(e,a){return a||(a=Ne(52)),a.write_shift(4,e.xfId),a.write_shift(2,1),a.write_shift(1,0),a.write_shift(1,0),Jd(e.name||"",a),a.length>a.l?a.slice(0,a.l):a}function A_(e,a,t){var i=Ne(2052);return i.write_shift(4,e),Jd(a,i),Jd(t,i),i.length>i.l?i.slice(0,i.l):i}function __(e,a,t){var i={};i.NumberFmt=[];for(var s in mt)i.NumberFmt[s]=mt[s];i.CellXf=[],i.Fonts=[];var c=[],f=!1;return ls(e,function(g,h,E){switch(E){case 44:i.NumberFmt[g[0]]=g[1],rs(g[1],g[0]);break;case 43:i.Fonts.push(g),g.color.theme!=null&&a&&a.themeElements&&a.themeElements.clrScheme&&(g.color.rgb=af(a.themeElements.clrScheme[g.color.theme].rgb,g.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:c[c.length-1]==617&&i.CellXf.push(g);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:f=!0;break;case 36:f=!1;break;case 37:c.push(E),f=!0;break;case 38:c.pop(),f=!1;break;default:if(h.T>0)c.push(E);else if(h.T<0)c.pop();else if(!f||t.WTF&&c[c.length-1]!=37)throw new Error("Unexpected record 0x"+E.toString(16))}}),i}function C_(e,a){if(a){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)a[s]!=null&&++t}),t!=0&&($e(e,615,mi(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)a[s]!=null&&$e(e,44,g_(s,a[s]))}),$e(e,616))}}function k_(e){var a=1;$e(e,611,mi(a)),$e(e,43,m_({sz:12,color:{theme:1},name:"Calibri",family:2})),$e(e,612)}function w_(e){var a=2;$e(e,603,mi(a)),$e(e,45,Cm({patternType:"none"})),$e(e,45,Cm({patternType:"gray125"})),$e(e,604)}function R_(e){var a=1;$e(e,613,mi(a)),$e(e,46,E_()),$e(e,614)}function N_(e){var a=1;$e(e,626,mi(a)),$e(e,47,mv({numFmtId:0},65535)),$e(e,627)}function F_(e,a){$e(e,617,mi(a.length)),a.forEach(function(t){$e(e,47,mv(t,0))}),$e(e,618)}function D_(e){var a=1;$e(e,619,mi(a)),$e(e,48,T_({xfId:0,name:"Normal"})),$e(e,620)}function j_(e){var a=0;$e(e,505,mi(a)),$e(e,506)}function O_(e){var a=0;$e(e,508,A_(a,"TableStyleMedium9","PivotStyleMedium4")),$e(e,509)}function I_(e,a){var t=fn();return $e(t,278),C_(t,e.SSF),k_(t),w_(t),R_(t),N_(t),F_(t,a.cellXfs),D_(t),j_(t),O_(t),$e(t,279),t.end()}var B_=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function M_(e,a,t){a.themeElements.clrScheme=[];var i={};(e[0].match($r)||[]).forEach(function(s){var c=Et(s);switch(c[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":i.rgb=c.val;break;case"<a:sysClr":i.rgb=c.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":c[0].charAt(1)==="/"?(a.themeElements.clrScheme[B_.indexOf(c[0])]=i,i={}):i.name=c[0].slice(3,c[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+c[0]+" in clrScheme")}})}function L_(){}function P_(){}var z_=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,U_=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,H_=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function $_(e,a,t){a.themeElements={};var i;[["clrScheme",z_,M_],["fontScheme",U_,L_],["fmtScheme",H_,P_]].forEach(function(s){if(!(i=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](i,a,t)})}var Y_=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function yv(e,a){(!e||e.length===0)&&(e=mh());var t,i={};if(!(t=e.match(Y_)))throw new Error("themeElements not found in theme");return $_(t[0],i,a),i.raw=e,i}function mh(e,a){if(a&&a.themeXLSX)return a.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[qa];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function G_(e,a,t){var i=e.l+a,s=e.read_shift(4);if(s!==124226){if(!t.cellStyles){e.l=i;return}var c=e.slice(e.l);e.l=i;var f;try{f=dy(c,{type:"array"})}catch{return}var p=kn(f,"theme/theme/theme1.xml",!0);if(p)return yv(p,t)}}function W_(e){return e.read_shift(4)}function V_(e){var a={};switch(a.xclrType=e.read_shift(2),a.nTintShade=e.read_shift(2),a.xclrType){case 0:e.l+=4;break;case 1:a.xclrValue=X_(e,4);break;case 2:a.xclrValue=Qy(e);break;case 3:a.xclrValue=W_(e);break;case 4:e.l+=4;break}return e.l+=8,a}function X_(e,a){return Hr(e,a)}function q_(e,a){return Hr(e,a)}function K_(e){var a=e.read_shift(2),t=e.read_shift(2)-4,i=[a];switch(a){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:i[1]=V_(e);break;case 6:i[1]=q_(e,t);break;case 14:case 15:i[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+a+" "+t)}return i}function Q_(e,a){var t=e.l+a;e.l+=2;var i=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),c=[];s-- >0;)c.push(K_(e,t-e.l));return{ixfe:i,ext:c}}function J_(e,a){a.forEach(function(t){t[0]})}function Z_(e,a){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ur(e)}}function e4(e){var a=Ne(12+2*e.name.length);return a.write_shift(4,e.flags),a.write_shift(4,e.version),vr(e.name,a),a.slice(0,a.l)}function t4(e){for(var a=[],t=e.read_shift(4);t-- >0;)a.push([e.read_shift(4),e.read_shift(4)]);return a}function a4(e){var a=Ne(4+8*e.length);a.write_shift(4,e.length);for(var t=0;t<e.length;++t)a.write_shift(4,e[t][0]),a.write_shift(4,e[t][1]);return a}function r4(e,a){var t=Ne(8+2*a.length);return t.write_shift(4,e),vr(a,t),t.slice(0,t.l)}function n4(e){return e.l+=4,e.read_shift(4)!=0}function i4(e,a){var t=Ne(8);return t.write_shift(4,e),t.write_shift(4,1),t}function s4(e,a,t){var i={Types:[],Cell:[],Value:[]},s=t||{},c=[],f=!1,p=2;return ls(e,function(g,h,E){switch(E){case 335:i.Types.push({name:g.name});break;case 51:g.forEach(function(A){p==1?i.Cell.push({type:i.Types[A[0]-1].name,index:A[1]}):p==0&&i.Value.push({type:i.Types[A[0]-1].name,index:A[1]})});break;case 337:p=g?1:0;break;case 338:p=2;break;case 35:c.push(E),f=!0;break;case 36:c.pop(),f=!1;break;default:if(!h.T){if(!f||s.WTF&&c[c.length-1]!=35)throw new Error("Unexpected record 0x"+E.toString(16))}}}),i}function l4(){var e=fn();return $e(e,332),$e(e,334,mi(1)),$e(e,335,e4({name:"XLDAPR",version:12e4,flags:3496657072})),$e(e,336),$e(e,339,r4(1,"XLDAPR")),$e(e,52),$e(e,35,mi(514)),$e(e,4096,mi(0)),$e(e,4097,Vn(1)),$e(e,36),$e(e,53),$e(e,340),$e(e,337,i4(1)),$e(e,51,a4([[1,0]])),$e(e,338),$e(e,333),e.end()}function o4(e,a,t){var i={Types:[],Cell:[],Value:[]};if(!e)return i;var s=!1,c=2,f;return e.replace($r,function(p){var g=Et(p);switch(Fi(g[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":i.Types.push({name:g.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<i.Types.length;++h)i.Types[h].name==g.name&&(f=i.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":c==1?i.Cell.push({type:i.Types[g.t-1].name,index:+g.v}):c==0&&i.Value.push({type:i.Types[g.t-1].name,index:+g.v});break;case"</rc>":break;case"<cellMetadata":c=1;break;case"</cellMetadata>":c=2;break;case"<valueMetadata":c=0;break;case"</valueMetadata>":c=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!f)break;f.offsets||(f.offsets=[]),f.offsets.push(+g.i);break;default:if(!s&&t.WTF)throw new Error("unrecognized "+g[0]+" in metadata")}return p}),i}function vv(){var e=[qa];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function c4(e){var a=[];if(!e)return a;var t=1;return(e.match($r)||[]).forEach(function(i){var s=Et(i);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?t=s.i:s.i=t,a.push(s);break}}),a}function d4(e){var a={};a.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),a.r=bt(t);var i=e.read_shift(1);return i&2&&(a.l="1"),i&8&&(a.a="1"),a}function f4(e,a,t){var i=[];return ls(e,function(c,f,p){switch(p){case 63:i.push(c);break;default:if(!f.T)throw new Error("Unexpected record 0x"+p.toString(16))}}),i}function u4(e,a,t,i){if(!e)return e;var s=i||{},c=!1;ls(e,function(p,g,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:c=!0;break;case 36:c=!1;break;default:if(!g.T){if(!c||s.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},s)}function p4(e,a){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return a["!id"][t].Target}var Do=1024;function bv(e,a){for(var t=[21600,21600],i=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),s=[qe("xml",null,{"xmlns:v":An.v,"xmlns:o":An.o,"xmlns:x":An.x,"xmlns:mv":An.mv}).replace(/\/>/,">"),qe("o:shapelayout",qe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),qe("v:shapetype",[qe("v:stroke",null,{joinstyle:"miter"}),qe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:i})];Do<e*1e3;)Do+=1e3;return a.forEach(function(c){var f=Oa(c[0]),p={color2:"#BEFF82",type:"gradient"};p.type=="gradient"&&(p.angle="-180");var g=p.type=="gradient"?qe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=qe("v:fill",g,p),E={on:"t",obscured:"t"};++Do,s=s.concat(["<v:shape"+Kc({id:"_x0000_s"+Do,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(c[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,qe("v:shadow",null,E),qe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",wr("x:Anchor",[f.c+1,0,f.r+1,0,f.c+3,20,f.r+5,20].join(",")),wr("x:AutoFill","False"),wr("x:Row",String(f.r)),wr("x:Column",String(f.c)),c[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function km(e,a,t,i){var s=Array.isArray(e),c;a.forEach(function(f){var p=Oa(f.ref);if(s?(e[p.r]||(e[p.r]=[]),c=e[p.r][p.c]):c=e[f.ref],!c){c={t:"z"},s?e[p.r][p.c]=c:e[f.ref]=c;var g=Qt(e["!ref"]||"BDWGO1000001:A1");g.s.r>p.r&&(g.s.r=p.r),g.e.r<p.r&&(g.e.r=p.r),g.s.c>p.c&&(g.s.c=p.c),g.e.c<p.c&&(g.e.c=p.c);var h=wt(g);h!==e["!ref"]&&(e["!ref"]=h)}c.c||(c.c=[]);var E={a:f.author,t:f.t,r:f.r,T:t};f.h&&(E.h=f.h);for(var A=c.c.length-1;A>=0;--A){if(!t&&c.c[A].T)return;t&&!c.c[A].T&&c.c.splice(A,1)}if(t&&i){for(A=0;A<i.length;++A)if(E.a==i[A].id){E.a=i[A].name||E.a;break}}c.c.push(E)})}function h4(e,a){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],i=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(f){if(!(f===""||f.trim()==="")){var p=f.match(/<(?:\w+:)?author[^>]*>(.*)/);p&&t.push(p[1])}});var c=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return c&&c[1]&&c[1].split(/<\/\w*:?comment>/).forEach(function(f){if(!(f===""||f.trim()==="")){var p=f.match(/<(?:\w+:)?comment[^>]*>/);if(p){var g=Et(p[0]),h={author:g.authorId&&t[g.authorId]||"sheetjsghost",ref:g.ref,guid:g.guid},E=Oa(g.ref);if(!(a.sheetRows&&a.sheetRows<=E.r)){var A=f.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!A&&!!A[1]&&hh(A[1])||{r:"",t:"",h:""};h.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),h.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),a.cellHTML&&(h.h=_.h),i.push(h)}}}}),i}function Sv(e){var a=[qa,qe("comments",null,{xmlns:Yl[0]})],t=[];return a.push("<authors>"),e.forEach(function(i){i[1].forEach(function(s){var c=fa(s.a);t.indexOf(c)==-1&&(t.push(c),a.push("<author>"+c+"</author>")),s.T&&s.ID&&t.indexOf("tc="+s.ID)==-1&&(t.push("tc="+s.ID),a.push("<author>tc="+s.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),a.push("<author>SheetJ5</author>")),a.push("</authors>"),a.push("<commentList>"),e.forEach(function(i){var s=0,c=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?s=t.indexOf("tc="+i[1][0].ID):i[1].forEach(function(g){g.a&&(s=t.indexOf(fa(g.a))),c.push(g.t||"")}),a.push('<comment ref="'+i[0]+'" authorId="'+s+'"><text>'),c.length<=1)a.push(wr("t",fa(c[0]||"")));else{for(var f=`Comment:
    `+c[0]+`
`,p=1;p<c.length;++p)f+=`Reply:
    `+c[p]+`
`;a.push(wr("t",fa(f)))}a.push("</text></comment>")}),a.push("</commentList>"),a.length>2&&(a[a.length]="</comments>",a[1]=a[1].replace("/>",">")),a.join("")}function g4(e,a){var t=[],i=!1,s={},c=0;return e.replace($r,function(p,g){var h=Et(p);switch(Fi(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":s.t!=null&&t.push(s);break;case"<text>":case"<text":c=g+p.length;break;case"</text>":s.t=e.slice(c,g).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":i=!0;break;case"</mentions>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&a.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return p}),t}function x4(e,a,t){var i=[qa,qe("ThreadedComments",null,{xmlns:dr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var c="";(s[1]||[]).forEach(function(f,p){if(!f.T){delete f.ID;return}f.a&&a.indexOf(f.a)==-1&&a.push(f.a);var g={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};p==0?c=g.id:g.parentId=c,f.ID=g.id,f.a&&(g.personId="{54EE7950-7262-4200-6969-"+("000000000000"+a.indexOf(f.a)).slice(-12)+"}"),i.push(qe("threadedComment",wr("text",f.t||""),g))})}),i.push("</ThreadedComments>"),i.join("")}function m4(e,a){var t=[],i=!1;return e.replace($r,function(c){var f=Et(c);switch(Fi(f[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:f.displayname,id:f.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(!i&&a.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return c}),t}function y4(e){var a=[qa,qe("personList",null,{xmlns:dr.TCMNT,"xmlns:x":Yl[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,i){a.push(qe("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:t,providerId:"None"}))}),a.push("</personList>"),a.join("")}function v4(e){var a={};a.iauthor=e.read_shift(4);var t=Xl(e);return a.rfx=t.s,a.ref=bt(t.s),e.l+=16,a}function b4(e,a){return a==null&&(a=Ne(36)),a.write_shift(4,e[1].iauthor),$o(e[0],a),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a}var S4=Ur;function E4(e){return vr(e.slice(0,54))}function T4(e,a){var t=[],i=[],s={},c=!1;return ls(e,function(p,g,h){switch(h){case 632:i.push(p);break;case 635:s=p;break;case 637:s.t=p.t,s.h=p.h,s.r=p.r;break;case 636:if(s.author=i[s.iauthor],delete s.iauthor,a.sheetRows&&s.rfx&&a.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,t.push(s);break;case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!g.T){if(!c||a.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),t}function A4(e){var a=fn(),t=[];return $e(a,628),$e(a,630),e.forEach(function(i){i[1].forEach(function(s){t.indexOf(s.a)>-1||(t.push(s.a.slice(0,54)),$e(a,632,E4(s.a)))})}),$e(a,631),$e(a,633),e.forEach(function(i){i[1].forEach(function(s){s.iauthor=t.indexOf(s.a);var c={s:Oa(i[0]),e:Oa(i[0])};$e(a,635,b4([c,s])),s.t&&s.t.length>0&&$e(a,637,WS(s)),$e(a,636),delete s.iauthor})}),$e(a,634),$e(a,629),a.end()}var _4="application/vnd.ms-office.vbaProject";function C4(e){var a=ht.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,i){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var s=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ht.utils.cfb_add(a,s,e.FileIndex[i].content)}}),ht.write(a)}function k4(e,a){a.FullPaths.forEach(function(t,i){if(i!=0){var s=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&ht.utils.cfb_add(e,s,a.FileIndex[i].content)}})}var Ev=["xlsb","xlsm","xlam","biff8","xla"];function w4(){return{"!type":"dialog"}}function R4(){return{"!type":"dialog"}}function N4(){return{"!type":"macro"}}function F4(){return{"!type":"macro"}}var Io=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,a={r:0,c:0};function t(i,s,c,f){var p=!1,g=!1;c.length==0?g=!0:c.charAt(0)=="["&&(g=!0,c=c.slice(1,-1)),f.length==0?p=!0:f.charAt(0)=="["&&(p=!0,f=f.slice(1,-1));var h=c.length>0?parseInt(c,10)|0:0,E=f.length>0?parseInt(f,10)|0:0;return p?E+=a.c:--E,g?h+=a.r:--h,s+(p?"":"$")+ja(E)+(g?"":"$")+Xa(h)}return function(s,c){return a=c,s.replace(e,t)}})(),yh=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,vh=(function(){return function(a,t){return a.replace(yh,function(i,s,c,f,p,g){var h=ih(f)-(c?0:t.c),E=nh(g)-(p?0:t.r),A=E==0?"":p?E+1:"["+E+"]",_=h==0?"":c?h+1:"["+h+"]";return s+"R"+A+"C"+_})}})();function Tv(e,a){return e.replace(yh,function(t,i,s,c,f,p){return i+(s=="$"?s+c:ja(ih(c)+a.c))+(f=="$"?f+p:Xa(nh(p)+a.r))})}function D4(e,a,t){var i=un(a),s=i.s,c=Oa(t),f={r:c.r-s.r,c:c.c-s.c};return Tv(e,f)}function j4(e){return e.length!=1}function wm(e){return e.replace(/_xlfn\./g,"")}function tr(e){e.l+=1}function Js(e,a){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function Av(e,a,t){var i=2;if(t){if(t.biff>=2&&t.biff<=5)return _v(e);t.biff==12&&(i=4)}var s=e.read_shift(i),c=e.read_shift(i),f=Js(e),p=Js(e);return{s:{r:s,c:f[0],cRel:f[1],rRel:f[2]},e:{r:c,c:p[0],cRel:p[1],rRel:p[2]}}}function _v(e){var a=Js(e),t=Js(e),i=e.read_shift(1),s=e.read_shift(1);return{s:{r:a[0],c:i,cRel:a[1],rRel:a[2]},e:{r:t[0],c:s,cRel:t[1],rRel:t[2]}}}function O4(e,a,t){if(t.biff<8)return _v(e);var i=e.read_shift(t.biff==12?4:2),s=e.read_shift(t.biff==12?4:2),c=Js(e),f=Js(e);return{s:{r:i,c:c[0],cRel:c[1],rRel:c[2]},e:{r:s,c:f[0],cRel:f[1],rRel:f[2]}}}function Cv(e,a,t){if(t&&t.biff>=2&&t.biff<=5)return I4(e);var i=e.read_shift(t&&t.biff==12?4:2),s=Js(e);return{r:i,c:s[0],cRel:s[1],rRel:s[2]}}function I4(e){var a=Js(e),t=e.read_shift(1);return{r:a[0],c:t,cRel:a[1],rRel:a[2]}}function B4(e){var a=e.read_shift(2),t=e.read_shift(2);return{r:a,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function M4(e,a,t){var i=t&&t.biff?t.biff:8;if(i>=2&&i<=5)return L4(e);var s=e.read_shift(i>=12?4:2),c=e.read_shift(2),f=(c&16384)>>14,p=(c&32768)>>15;if(c&=16383,p==1)for(;s>524287;)s-=1048576;if(f==1)for(;c>8191;)c=c-16384;return{r:s,c,cRel:f,rRel:p}}function L4(e){var a=e.read_shift(2),t=e.read_shift(1),i=(a&32768)>>15,s=(a&16384)>>14;return a&=16383,i==1&&a>=8192&&(a=a-16384),s==1&&t>=128&&(t=t-256),{r:a,c:t,cRel:s,rRel:i}}function P4(e,a,t){var i=(e[e.l++]&96)>>5,s=Av(e,t.biff>=2&&t.biff<=5?6:8,t);return[i,s]}function z4(e,a,t){var i=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),c=8;if(t)switch(t.biff){case 5:e.l+=12,c=6;break;case 12:c=12;break}var f=Av(e,c,t);return[i,s,f]}function U4(e,a,t){var i=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[i]}function H4(e,a,t){var i=(e[e.l++]&96)>>5,s=e.read_shift(2),c=8;if(t)switch(t.biff){case 5:e.l+=12,c=6;break;case 12:c=12;break}return e.l+=c,[i,s]}function $4(e,a,t){var i=(e[e.l++]&96)>>5,s=O4(e,a-1,t);return[i,s]}function Y4(e,a,t){var i=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[i]}function Rm(e){var a=e[e.l+1]&1,t=1;return e.l+=4,[a,t]}function G4(e,a,t){e.l+=2;for(var i=e.read_shift(t&&t.biff==2?1:2),s=[],c=0;c<=i;++c)s.push(e.read_shift(t&&t.biff==2?1:2));return s}function W4(e,a,t){var i=e[e.l+1]&255?1:0;return e.l+=2,[i,e.read_shift(t&&t.biff==2?1:2)]}function V4(e,a,t){var i=e[e.l+1]&255?1:0;return e.l+=2,[i,e.read_shift(t&&t.biff==2?1:2)]}function X4(e){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(2)]}function q4(e,a,t){var i=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[i]}function kv(e){var a=e.read_shift(1),t=e.read_shift(1);return[a,t]}function K4(e){return e.read_shift(2),kv(e)}function Q4(e){return e.read_shift(2),kv(e)}function J4(e,a,t){var i=(e[e.l]&96)>>5;e.l+=1;var s=Cv(e,0,t);return[i,s]}function Z4(e,a,t){var i=(e[e.l]&96)>>5;e.l+=1;var s=M4(e,0,t);return[i,s]}function e3(e,a,t){var i=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var c=Cv(e,0,t);return[i,s,c]}function t3(e,a,t){var i=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(t&&t.biff<=3?1:2);return[nC[s],Nv[s],i]}function a3(e,a,t){var i=e[e.l++],s=e.read_shift(1),c=t&&t.biff<=3?[i==88?-1:0,e.read_shift(1)]:r3(e);return[s,(c[0]===0?Nv:rC)[c[1]]]}function r3(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function n3(e,a,t){e.l+=t&&t.biff==2?3:4}function i3(e,a,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var i=e.read_shift(2),s=e.read_shift(t&&t.biff==2?1:2);return[i,s]}function s3(e){return e.l++,os[e.read_shift(1)]}function l3(e){return e.l++,e.read_shift(2)}function o3(e){return e.l++,e.read_shift(1)!==0}function c3(e){return e.l++,zr(e)}function d3(e,a,t){return e.l++,o0(e,a-1,t)}function f3(e,a){var t=[e.read_shift(1)];if(a==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Va(e,1)?"TRUE":"FALSE",a!=12&&(e.l+=7);break;case 37:case 16:t[1]=os[e[e.l]],e.l+=a==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=zr(e);break;case 2:t[1]=ql(e,0,{biff:a>0&&a<8?2:a});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function u3(e,a,t){for(var i=e.read_shift(t.biff==12?4:2),s=[],c=0;c!=i;++c)s.push((t.biff==12?Xl:uf)(e));return s}function p3(e,a,t){var i=0,s=0;t.biff==12?(i=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),i=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--i,--s==0&&(s=256));for(var c=0,f=[];c!=i&&(f[c]=[]);++c)for(var p=0;p!=s;++p)f[c][p]=f3(e,t.biff);return f}function h3(e,a,t){var i=e.read_shift(1)>>>5&3,s=!t||t.biff>=8?4:2,c=e.read_shift(s);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[i,0,c]}function g3(e,a,t){if(t.biff==5)return x3(e);var i=e.read_shift(1)>>>5&3,s=e.read_shift(2),c=e.read_shift(4);return[i,s,c]}function x3(e){var a=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var i=e.read_shift(2);return e.l+=12,[a,t,i]}function m3(e,a,t){var i=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var s=e.read_shift(t&&t.biff==2?1:2);return[i,s]}function y3(e,a,t){var i=e.read_shift(1)>>>5&3,s=e.read_shift(t&&t.biff==2?1:2);return[i,s]}function v3(e,a,t){var i=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[i]}function b3(e,a,t){var i=(e[e.l++]&96)>>5,s=e.read_shift(2),c=4;if(t)switch(t.biff){case 5:c=15;break;case 12:c=6;break}return e.l+=c,[i,s]}var S3=Hr,E3=Hr,T3=Hr;function d0(e,a,t){return e.l+=2,[B4(e)]}function bh(e){return e.l+=6,[]}var A3=d0,_3=bh,C3=bh,k3=d0;function wv(e){return e.l+=2,[rr(e),e.read_shift(2)&1]}var w3=d0,R3=wv,N3=bh,F3=d0,D3=d0,j3=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function O3(e){e.l+=2;var a=e.read_shift(2),t=e.read_shift(2),i=e.read_shift(4),s=e.read_shift(2),c=e.read_shift(2),f=j3[t>>2&31];return{ixti:a,coltype:t&3,rt:f,idx:i,c:s,C:c}}function I3(e){return e.l+=2,[e.read_shift(4)]}function B3(e,a,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function M3(e,a,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function L3(e){var a=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[a,t]}function P3(e){var a=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[a,t]}function z3(e){return e.l+=4,[0,0]}var Nm={1:{n:"PtgExp",f:i3},2:{n:"PtgTbl",f:T3},3:{n:"PtgAdd",f:tr},4:{n:"PtgSub",f:tr},5:{n:"PtgMul",f:tr},6:{n:"PtgDiv",f:tr},7:{n:"PtgPower",f:tr},8:{n:"PtgConcat",f:tr},9:{n:"PtgLt",f:tr},10:{n:"PtgLe",f:tr},11:{n:"PtgEq",f:tr},12:{n:"PtgGe",f:tr},13:{n:"PtgGt",f:tr},14:{n:"PtgNe",f:tr},15:{n:"PtgIsect",f:tr},16:{n:"PtgUnion",f:tr},17:{n:"PtgRange",f:tr},18:{n:"PtgUplus",f:tr},19:{n:"PtgUminus",f:tr},20:{n:"PtgPercent",f:tr},21:{n:"PtgParen",f:tr},22:{n:"PtgMissArg",f:tr},23:{n:"PtgStr",f:d3},26:{n:"PtgSheet",f:B3},27:{n:"PtgEndSheet",f:M3},28:{n:"PtgErr",f:s3},29:{n:"PtgBool",f:o3},30:{n:"PtgInt",f:l3},31:{n:"PtgNum",f:c3},32:{n:"PtgArray",f:Y4},33:{n:"PtgFunc",f:t3},34:{n:"PtgFuncVar",f:a3},35:{n:"PtgName",f:h3},36:{n:"PtgRef",f:J4},37:{n:"PtgArea",f:P4},38:{n:"PtgMemArea",f:m3},39:{n:"PtgMemErr",f:S3},40:{n:"PtgMemNoMem",f:E3},41:{n:"PtgMemFunc",f:y3},42:{n:"PtgRefErr",f:v3},43:{n:"PtgAreaErr",f:U4},44:{n:"PtgRefN",f:Z4},45:{n:"PtgAreaN",f:$4},46:{n:"PtgMemAreaN",f:L3},47:{n:"PtgMemNoMemN",f:P3},57:{n:"PtgNameX",f:g3},58:{n:"PtgRef3d",f:e3},59:{n:"PtgArea3d",f:z4},60:{n:"PtgRefErr3d",f:b3},61:{n:"PtgAreaErr3d",f:H4},255:{}},U3={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},H3={1:{n:"PtgElfLel",f:wv},2:{n:"PtgElfRw",f:F3},3:{n:"PtgElfCol",f:A3},6:{n:"PtgElfRwV",f:D3},7:{n:"PtgElfColV",f:k3},10:{n:"PtgElfRadical",f:w3},11:{n:"PtgElfRadicalS",f:N3},13:{n:"PtgElfColS",f:_3},15:{n:"PtgElfColSV",f:C3},16:{n:"PtgElfRadicalLel",f:R3},25:{n:"PtgList",f:O3},29:{n:"PtgSxName",f:I3},255:{}},$3={0:{n:"PtgAttrNoop",f:z3},1:{n:"PtgAttrSemi",f:q4},2:{n:"PtgAttrIf",f:V4},4:{n:"PtgAttrChoose",f:G4},8:{n:"PtgAttrGoto",f:W4},16:{n:"PtgAttrSum",f:n3},32:{n:"PtgAttrBaxcel",f:Rm},33:{n:"PtgAttrBaxcel",f:Rm},64:{n:"PtgAttrSpace",f:K4},65:{n:"PtgAttrSpaceSemi",f:Q4},128:{n:"PtgAttrIfError",f:X4},255:{}};function f0(e,a,t,i){if(i.biff<8)return Hr(e,a);for(var s=e.l+a,c=[],f=0;f!==t.length;++f)switch(t[f][0]){case"PtgArray":t[f][1]=p3(e,0,i),c.push(t[f][1]);break;case"PtgMemArea":t[f][2]=u3(e,t[f][1],i),c.push(t[f][2]);break;case"PtgExp":i&&i.biff==12&&(t[f][1][1]=e.read_shift(4),c.push(t[f][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[f][0]}return a=s-e.l,a!==0&&c.push(Hr(e,a)),c}function u0(e,a,t){for(var i=e.l+a,s,c,f=[];i!=e.l;)a=i-e.l,c=e[e.l],s=Nm[c]||Nm[U3[c]],(c===24||c===25)&&(s=(c===24?H3:$3)[e[e.l+1]]),!s||!s.f?Hr(e,a):f.push([s.n,s.f(e,a,t)]);return f}function Y3(e){for(var a=[],t=0;t<e.length;++t){for(var i=e[t],s=[],c=0;c<i.length;++c){var f=i[c];f?f[0]===2?s.push('"'+f[1].replace(/"/g,'""')+'"'):s.push(f[1]):s.push("")}a.push(s.join(","))}return a.join(";")}var G3={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function W3(e,a){if(!e&&!(a&&a.biff<=5&&a.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Rv(e,a,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[a]))return e.SheetNames[a];if(!e.XTI)return"SH33TJSERR6";var i=e.XTI[a];if(t.biff<8)return a>1e4&&(a-=65536),a<0&&(a=-a),a==0?"":e.XTI[a-1];if(!i)return"SH33TJSERR1";var s="";if(t.biff>8)switch(e[i[0]][0]){case 357:return s=i[1]==-1?"#REF":e.SheetNames[i[1]],i[1]==i[2]?s:s+":"+e.SheetNames[i[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[i[0]][0];default:return"SH33TJSSRC"+e[i[0]][0]}switch(e[i[0]][0][0]){case 1025:return s=i[1]==-1?"#REF":e.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?s:s+":"+e.SheetNames[i[2]];case 14849:return e[i[0]].slice(1).map(function(c){return c.Name}).join(";;");default:return e[i[0]][0][3]?(s=i[1]==-1?"#REF":e[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?s:s+":"+e[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function Fm(e,a,t){var i=Rv(e,a,t);return i=="#REF"?i:W3(i,t)}function Lr(e,a,t,i,s){var c=s&&s.biff||8,f={s:{c:0,r:0}},p=[],g,h,E,A=0,_=0,w,N="";if(!e[0]||!e[0][0])return"";for(var k=-1,F="",z=0,K=e[0].length;z<K;++z){var M=e[0][z];switch(M[0]){case"PtgUminus":p.push("-"+p.pop());break;case"PtgUplus":p.push("+"+p.pop());break;case"PtgPercent":p.push(p.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(g=p.pop(),h=p.pop(),k>=0){switch(e[0][k][1][0]){case 0:F=Pa(" ",e[0][k][1][1]);break;case 1:F=Pa("\r",e[0][k][1][1]);break;default:if(F="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][k][1][0])}h=h+F,k=-1}p.push(h+G3[M[0]]+g);break;case"PtgIsect":g=p.pop(),h=p.pop(),p.push(h+" "+g);break;case"PtgUnion":g=p.pop(),h=p.pop(),p.push(h+","+g);break;case"PtgRange":g=p.pop(),h=p.pop(),p.push(h+":"+g);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":E=Pc(M[1][1],f,s),p.push(zc(E,c));break;case"PtgRefN":E=t?Pc(M[1][1],t,s):M[1][1],p.push(zc(E,c));break;case"PtgRef3d":A=M[1][1],E=Pc(M[1][2],f,s),N=Fm(i,A,s),p.push(N+"!"+zc(E,c));break;case"PtgFunc":case"PtgFuncVar":var ie=M[1][0],se=M[1][1];ie||(ie=0),ie&=127;var ne=ie==0?[]:p.slice(-ie);p.length-=ie,se==="User"&&(se=ne.shift()),p.push(se+"("+ne.join(",")+")");break;case"PtgBool":p.push(M[1]?"TRUE":"FALSE");break;case"PtgInt":p.push(M[1]);break;case"PtgNum":p.push(String(M[1]));break;case"PtgStr":p.push('"'+M[1].replace(/"/g,'""')+'"');break;case"PtgErr":p.push(M[1]);break;case"PtgAreaN":w=sm(M[1][1],t?{s:t}:f,s),p.push(vp(w,s));break;case"PtgArea":w=sm(M[1][1],f,s),p.push(vp(w,s));break;case"PtgArea3d":A=M[1][1],w=M[1][2],N=Fm(i,A,s),p.push(N+"!"+vp(w,s));break;case"PtgAttrSum":p.push("SUM("+p.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=M[1][2];var H=(i.names||[])[_-1]||(i[0]||[])[_],le=H?H.Name:"SH33TJSNAME"+String(_);le&&le.slice(0,6)=="_xlfn."&&!s.xlfn&&(le=le.slice(6)),p.push(le);break;case"PtgNameX":var oe=M[1][1];_=M[1][2];var m;if(s.biff<=5)oe<0&&(oe=-oe),i[oe]&&(m=i[oe][_]);else{var Se="";if(((i[oe]||[])[0]||[])[0]==14849||(((i[oe]||[])[0]||[])[0]==1025?i[oe][_]&&i[oe][_].itab>0&&(Se=i.SheetNames[i[oe][_].itab-1]+"!"):Se=i.SheetNames[_-1]+"!"),i[oe]&&i[oe][_])Se+=i[oe][_].Name;else if(i[0]&&i[0][_])Se+=i[0][_].Name;else{var ue=(Rv(i,oe,s)||"").split(";;");ue[_-1]?Se=ue[_-1]:Se+="SH33TJSERRX"}p.push(Se);break}m||(m={Name:"SH33TJSERRY"}),p.push(m.Name);break;case"PtgParen":var Pe="(",et=")";if(k>=0){switch(F="",e[0][k][1][0]){case 2:Pe=Pa(" ",e[0][k][1][1])+Pe;break;case 3:Pe=Pa("\r",e[0][k][1][1])+Pe;break;case 4:et=Pa(" ",e[0][k][1][1])+et;break;case 5:et=Pa("\r",e[0][k][1][1])+et;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][k][1][0])}k=-1}p.push(Pe+p.pop()+et);break;case"PtgRefErr":p.push("#REF!");break;case"PtgRefErr3d":p.push("#REF!");break;case"PtgExp":E={c:M[1][1],r:M[1][0]};var ke={c:t.c,r:t.r};if(i.sharedf[bt(E)]){var de=i.sharedf[bt(E)];p.push(Lr(de,f,ke,i,s))}else{var Ce=!1;for(g=0;g!=i.arrayf.length;++g)if(h=i.arrayf[g],!(E.c<h[0].s.c||E.c>h[0].e.c)&&!(E.r<h[0].s.r||E.r>h[0].e.r)){p.push(Lr(h[1],f,ke,i,s)),Ce=!0;break}Ce||p.push(M[1])}break;case"PtgArray":p.push("{"+Y3(M[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":k=z;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":p.push("");break;case"PtgAreaErr":p.push("#REF!");break;case"PtgAreaErr3d":p.push("#REF!");break;case"PtgList":p.push("Table"+M[1].idx+"[#"+M[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(M));default:throw new Error("Unrecognized Formula Token: "+String(M))}var Je=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&k>=0&&Je.indexOf(e[0][z][0])==-1){M=e[0][k];var fe=!0;switch(M[1][0]){case 4:fe=!1;case 0:F=Pa(" ",M[1][1]);break;case 5:fe=!1;case 1:F=Pa("\r",M[1][1]);break;default:if(F="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+M[1][0])}p.push((fe?F:"")+p.pop()+(fe?"":F)),k=-1}}if(p.length>1&&s.WTF)throw new Error("bad formula stack");return p[0]}function V3(e,a,t){var i=e.l+a,s=t.biff==2?1:2,c,f=e.read_shift(s);if(f==65535)return[[],Hr(e,a-2)];var p=u0(e,f,t);return a!==f+s&&(c=f0(e,a-f-s,p,t)),e.l=i,[p,c]}function X3(e,a,t){var i=e.l+a,s=t.biff==2?1:2,c,f=e.read_shift(s);if(f==65535)return[[],Hr(e,a-2)];var p=u0(e,f,t);return a!==f+s&&(c=f0(e,a-f-s,p,t)),e.l=i,[p,c]}function q3(e,a,t,i){var s=e.l+a,c=u0(e,i,t),f;return s!==e.l&&(f=f0(e,s-e.l,c,t)),[c,f]}function K3(e,a,t){var i=e.l+a,s,c=e.read_shift(2),f=u0(e,c,t);return c==65535?[[],Hr(e,a-2)]:(a!==c+2&&(s=f0(e,i-c-2,f,t)),[f,s])}function Q3(e){var a;if(ts(e,e.l+6)!==65535)return[zr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return a=e[e.l+2]===1,e.l+=8,[a,"b"];case 2:return a=e[e.l+2],e.l+=8,[a,"e"];case 3:return e.l+=8,["","s"]}return[]}function J3(e){if(e==null){var a=Ne(8);return a.write_shift(1,3),a.write_shift(1,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,65535),a}else if(typeof e=="number")return zl(e);return zl(0)}function Ap(e,a,t){var i=e.l+a,s=Di(e);t.biff==2&&++e.l;var c=Q3(e),f=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var p=X3(e,i-e.l,t);return{cell:s,val:c[0],formula:p,shared:f>>3&1,tt:c[1]}}function Z3(e,a,t,i,s){var c=Hl(a,t,s),f=J3(e.v),p=Ne(6),g=33;p.write_shift(2,g),p.write_shift(4,0);for(var h=Ne(e.bf.length),E=0;E<e.bf.length;++E)h[E]=e.bf[E];var A=yr([c,f,p,h]);return A}function pf(e,a,t){var i=e.read_shift(4),s=u0(e,i,t),c=e.read_shift(4),f=c>0?f0(e,c,s,t):null;return[s,f]}var eC=pf,hf=pf,tC=pf,aC=pf,rC={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Nv={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},nC={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Dm(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(a,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function iC(e){var a="of:="+e.replace(yh,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return a.replace(/;/g,"|").replace(/,/g,";")}function _p(e){var a=e.split(":"),t=a[0].split(".")[0];return[t,a[0].split(".")[1]+(a.length>1?":"+(a[1].split(".")[1]||a[1].split(".")[0]):"")]}function sC(e){return e.replace(/\./,"!")}var Hc={},Bo={},$c=typeof Map<"u";function Sh(e,a,t){var i=0,s=e.length;if(t){if($c?t.has(a):Object.prototype.hasOwnProperty.call(t,a)){for(var c=$c?t.get(a):t[a];i<c.length;++i)if(e[c[i]].t===a)return e.Count++,c[i]}}else for(;i<s;++i)if(e[i].t===a)return e.Count++,i;return e[s]={t:a},e.Count++,e.Unique++,t&&($c?(t.has(a)||t.set(a,[]),t.get(a).push(s)):(Object.prototype.hasOwnProperty.call(t,a)||(t[a]=[]),t[a].push(s))),s}function gf(e,a){var t={min:e+1,max:e+1},i=-1;return a.MDW&&(Pr=a.MDW),a.width!=null?t.customWidth=1:a.wpx!=null?i=t0(a.wpx):a.wch!=null&&(i=a.wch),i>-1?(t.width=rf(i),t.customWidth=1):a.width!=null&&(t.width=a.width),a.hidden&&(t.hidden=!0),a.level!=null&&(t.outlineLevel=t.level=a.level),t}function Ml(e,a){if(e){var t=[.7,.7,.75,.75,.3,.3];a=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function al(e,a,t){var i=t.revssf[a.z!=null?a.z:"General"],s=60,c=e.length;if(i==null&&t.ssf){for(;s<392;++s)if(t.ssf[s]==null){rs(a.z,s),t.ssf[s]=a.z,t.revssf[a.z]=i=s;break}}for(s=0;s!=c;++s)if(e[s].numFmtId===i)return s;return e[c]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},c}function Fv(e,a,t,i,s,c){try{i.cellNF&&(e.z=mt[a])}catch(p){if(i.WTF)throw p}if(!(e.t==="z"&&!i.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ka(e.v)),(!i||i.cellText!==!1)&&e.t!=="z")try{if(mt[a]==null&&rs(rS[a]||"General",a),e.t==="e")e.w=e.w||os[e.v];else if(a===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Xc(e.v);else if(e.t==="d"){var f=fr(e.v);(f|0)===f?e.w=f.toString(10):e.w=Xc(f)}else{if(e.v===void 0)return"";e.w=Ll(e.v,Bo)}else e.t==="d"?e.w=qn(a,fr(e.v),Bo):e.w=qn(a,e.v,Bo)}catch(p){if(i.WTF)throw p}if(i.cellStyles&&t!=null)try{e.s=c.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=af(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),i.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=af(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),i.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(p){if(i.WTF&&c.Fills)throw p}}}function lC(e,a,t){if(e&&e["!ref"]){var i=Qt(e["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function oC(e,a){var t=Qt(a);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=wt(t))}var cC=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,dC=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,fC=/<(?:\w:)?hyperlink [^>]*>/mg,uC=/"(\w*:\w*)"/,pC=/<(?:\w:)?col\b[^>]*[\/]?>/g,hC=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,gC=/<(?:\w:)?pageMargins[^>]*\/>/g,Dv=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,xC=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,mC=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function yC(e,a,t,i,s,c,f){if(!e)return e;i||(i={"!id":{}});var p=a.dense?[]:{},g={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",E="",A=e.match(dC);A?(h=e.slice(0,A.index),E=e.slice(A.index+A[0].length)):h=E=e;var _=h.match(Dv);_?Eh(_[0],p,s,t):(_=h.match(xC))&&bC(_[0],_[1]||"",p,s,t);var w=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(w>0){var N=h.slice(w,w+50).match(uC);N&&oC(p,N[1])}var k=h.match(mC);k&&k[1]&&jC(k[1],s);var F=[];if(a.cellStyles){var z=h.match(pC);z&&wC(F,z)}A&&BC(A[1],p,a,g,c,f);var K=E.match(hC);K&&(p["!autofilter"]=NC(K[0]));var M=[],ie=E.match(cC);if(ie)for(w=0;w!=ie.length;++w)M[w]=Qt(ie[w].slice(ie[w].indexOf('"')+1));var se=E.match(fC);se&&_C(p,se,i);var ne=E.match(gC);if(ne&&(p["!margins"]=CC(Et(ne[0]))),!p["!ref"]&&g.e.c>=g.s.c&&g.e.r>=g.s.r&&(p["!ref"]=wt(g)),a.sheetRows>0&&p["!ref"]){var H=Qt(p["!ref"]);a.sheetRows<=+H.e.r&&(H.e.r=a.sheetRows-1,H.e.r>g.e.r&&(H.e.r=g.e.r),H.e.r<H.s.r&&(H.s.r=H.e.r),H.e.c>g.e.c&&(H.e.c=g.e.c),H.e.c<H.s.c&&(H.s.c=H.e.c),p["!fullref"]=p["!ref"],p["!ref"]=wt(H))}return F.length>0&&(p["!cols"]=F),M.length>0&&(p["!merges"]=M),p}function vC(e){if(e.length===0)return"";for(var a='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)a+='<mergeCell ref="'+wt(e[t])+'"/>';return a+"</mergeCells>"}function Eh(e,a,t,i){var s=Et(e);t.Sheets[i]||(t.Sheets[i]={}),s.codeName&&(t.Sheets[i].CodeName=Kt(xa(s.codeName)))}function bC(e,a,t,i,s){Eh(e.slice(0,e.indexOf(">")),t,i,s)}function SC(e,a,t,i,s){var c=!1,f={},p=null;if(i.bookType!=="xlsx"&&a.vbaraw){var g=a.SheetNames[t];try{a.Workbook&&(g=a.Workbook.Sheets[t].CodeName||g)}catch{}c=!0,f.codeName=Ni(fa(g))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),p=(p||"")+qe("outlinePr",null,h)}!c&&!p||(s[s.length]=qe("sheetPr",p,f))}var EC=["objects","scenarios","selectLockedCells","selectUnlockedCells"],TC=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function AC(e){var a={sheet:1};return EC.forEach(function(t){e[t]!=null&&e[t]&&(a[t]="1")}),TC.forEach(function(t){e[t]!=null&&!e[t]&&(a[t]="0")}),e.password&&(a.password=gh(e.password).toString(16).toUpperCase()),qe("sheetProtection",null,a)}function _C(e,a,t){for(var i=Array.isArray(e),s=0;s!=a.length;++s){var c=Et(xa(a[s]),!0);if(!c.ref)return;var f=((t||{})["!id"]||[])[c.id];f?(c.Target=f.Target,c.location&&(c.Target+="#"+Kt(c.location))):(c.Target="#"+Kt(c.location),f={Target:c.Target,TargetMode:"Internal"}),c.Rel=f,c.tooltip&&(c.Tooltip=c.tooltip,delete c.tooltip);for(var p=Qt(c.ref),g=p.s.r;g<=p.e.r;++g)for(var h=p.s.c;h<=p.e.c;++h){var E=bt({c:h,r:g});i?(e[g]||(e[g]=[]),e[g][h]||(e[g][h]={t:"z",v:void 0}),e[g][h].l=c):(e[E]||(e[E]={t:"z",v:void 0}),e[E].l=c)}}}function CC(e){var a={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(a[t]=parseFloat(e[t]))}),a}function kC(e){return Ml(e),qe("pageMargins",null,e)}function wC(e,a){for(var t=!1,i=0;i!=a.length;++i){var s=Et(a[i],!0);s.hidden&&(s.hidden=Ca(s.hidden));var c=parseInt(s.min,10)-1,f=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!t&&s.width&&(t=!0,xh(s.width)),Qs(s);c<=f;)e[c++]=wa(s)}}function RC(e,a){for(var t=["<cols>"],i,s=0;s!=a.length;++s)(i=a[s])&&(t[t.length]=qe("col",null,gf(s,i)));return t[t.length]="</cols>",t.join("")}function NC(e){var a={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return a}function FC(e,a,t,i){var s=typeof e.ref=="string"?e.ref:wt(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var c=t.Workbook.Names,f=un(s);f.s.r==f.e.r&&(f.e.r=un(a["!ref"]).e.r,s=wt(f));for(var p=0;p<c.length;++p){var g=c[p];if(g.Name=="_xlnm._FilterDatabase"&&g.Sheet==i){g.Ref="'"+t.SheetNames[i]+"'!"+s;break}}return p==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+s}),qe("autoFilter",null,{ref:s})}var DC=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function jC(e,a){a.Views||(a.Views=[{}]),(e.match(DC)||[]).forEach(function(t,i){var s=Et(t);a.Views[i]||(a.Views[i]={}),+s.zoomScale&&(a.Views[i].zoom=+s.zoomScale),Ca(s.rightToLeft)&&(a.Views[i].RTL=!0)})}function OC(e,a,t,i){var s={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),qe("sheetViews",qe("sheetView",null,s),{})}function IC(e,a,t,i){if(e.c&&t["!comments"].push([a,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",c=e.t,f=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=os[e.v];break;case"d":i&&i.cellDates?s=ka(e.v,-1).toISOString():(e=wa(e),e.t="n",s=""+(e.v=fr(ka(e.v)))),typeof e.z>"u"&&(e.z=mt[14]);break;default:s=e.v;break}var p=wr("v",fa(s)),g={r:a},h=al(i.cellXfs,e,i);switch(h!==0&&(g.s=h),e.t){case"n":break;case"d":g.t="d";break;case"b":g.t="b";break;case"e":g.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){p=wr("v",""+Sh(i.Strings,e.v,i.revStrings)),g.t="s";break}g.t="str";break}if(e.t!=c&&(e.t=c,e.v=f),typeof e.f=="string"&&e.f){var E=e.F&&e.F.slice(0,a.length)==a?{t:"array",ref:e.F}:null;p=qe("f",fa(e.f),E)+(e.v!=null?p:"")}return e.l&&t["!links"].push([a,e.l]),e.D&&(g.cm=1),qe("c",p,g)}var BC=(function(){var e=/<(?:\w+:)?c[ \/>]/,a=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,i=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,c=qc("v"),f=qc("f");return function(g,h,E,A,_,w){for(var N=0,k="",F=[],z=[],K=0,M=0,ie=0,se="",ne,H,le=0,oe=0,m,Se,ue=0,Pe=0,et=Array.isArray(w.CellXf),ke,de=[],Ce=[],Je=Array.isArray(h),fe=[],Ke={},ee=!1,I=!!E.sheetStubs,L=g.split(a),Q=0,te=L.length;Q!=te;++Q){k=L[Q].trim();var ge=k.length;if(ge!==0){var je=0;e:for(N=0;N<ge;++N)switch(k[N]){case">":if(k[N-1]!="/"){++N;break e}if(E&&E.cellStyles){if(H=Et(k.slice(je,N),!0),le=H.r!=null?parseInt(H.r,10):le+1,oe=-1,E.sheetRows&&E.sheetRows<le)continue;Ke={},ee=!1,H.ht&&(ee=!0,Ke.hpt=parseFloat(H.ht),Ke.hpx=Po(Ke.hpt)),H.hidden=="1"&&(ee=!0,Ke.hidden=!0),H.outlineLevel!=null&&(ee=!0,Ke.level=+H.outlineLevel),ee&&(fe[le-1]=Ke)}break;case"<":je=N;break}if(je>=N)break;if(H=Et(k.slice(je,N),!0),le=H.r!=null?parseInt(H.r,10):le+1,oe=-1,!(E.sheetRows&&E.sheetRows<le)){A.s.r>le-1&&(A.s.r=le-1),A.e.r<le-1&&(A.e.r=le-1),E&&E.cellStyles&&(Ke={},ee=!1,H.ht&&(ee=!0,Ke.hpt=parseFloat(H.ht),Ke.hpx=Po(Ke.hpt)),H.hidden=="1"&&(ee=!0,Ke.hidden=!0),H.outlineLevel!=null&&(ee=!0,Ke.level=+H.outlineLevel),ee&&(fe[le-1]=Ke)),F=k.slice(N).split(e);for(var ze=0;ze!=F.length&&F[ze].trim().charAt(0)=="<";++ze);for(F=F.slice(ze),N=0;N!=F.length;++N)if(k=F[N].trim(),k.length!==0){if(z=k.match(t),K=N,M=0,ie=0,k="<c "+(k.slice(0,1)=="<"?">":"")+k,z!=null&&z.length===2){for(K=0,se=z[1],M=0;M!=se.length&&!((ie=se.charCodeAt(M)-64)<1||ie>26);++M)K=26*K+ie;--K,oe=K}else++oe;for(M=0;M!=k.length&&k.charCodeAt(M)!==62;++M);if(++M,H=Et(k.slice(0,M),!0),H.r||(H.r=bt({r:le-1,c:oe})),se=k.slice(M),ne={t:""},(z=se.match(c))!=null&&z[1]!==""&&(ne.v=Kt(z[1])),E.cellFormula){if((z=se.match(f))!=null&&z[1]!==""){if(ne.f=Kt(xa(z[1])).replace(/\r\n/g,`
`),E.xlfn||(ne.f=wm(ne.f)),z[0].indexOf('t="array"')>-1)ne.F=(se.match(s)||[])[1],ne.F.indexOf(":")>-1&&de.push([Qt(ne.F),ne.F]);else if(z[0].indexOf('t="shared"')>-1){Se=Et(z[0]);var Oe=Kt(xa(z[1]));E.xlfn||(Oe=wm(Oe)),Ce[parseInt(Se.si,10)]=[Se,Oe,H.r]}}else(z=se.match(/<f[^>]*\/>/))&&(Se=Et(z[0]),Ce[Se.si]&&(ne.f=D4(Ce[Se.si][1],Ce[Se.si][2],H.r)));var Ue=Oa(H.r);for(M=0;M<de.length;++M)Ue.r>=de[M][0].s.r&&Ue.r<=de[M][0].e.r&&Ue.c>=de[M][0].s.c&&Ue.c<=de[M][0].e.c&&(ne.F=de[M][1])}if(H.t==null&&ne.v===void 0)if(ne.f||ne.F)ne.v=0,ne.t="n";else if(I)ne.t="z";else continue;else ne.t=H.t||"n";switch(A.s.c>oe&&(A.s.c=oe),A.e.c<oe&&(A.e.c=oe),ne.t){case"n":if(ne.v==""||ne.v==null){if(!I)continue;ne.t="z"}else ne.v=parseFloat(ne.v);break;case"s":if(typeof ne.v>"u"){if(!I)continue;ne.t="z"}else m=Hc[parseInt(ne.v,10)],ne.v=m.t,ne.r=m.r,E.cellHTML&&(ne.h=m.h);break;case"str":ne.t="s",ne.v=ne.v!=null?xa(ne.v):"",E.cellHTML&&(ne.h=eh(ne.v));break;case"inlineStr":z=se.match(i),ne.t="s",z!=null&&(m=hh(z[1]))?(ne.v=m.t,E.cellHTML&&(ne.h=m.h)):ne.v="";break;case"b":ne.v=Ca(ne.v);break;case"d":E.cellDates?ne.v=ka(ne.v,1):(ne.v=fr(ka(ne.v,1)),ne.t="n");break;case"e":(!E||E.cellText!==!1)&&(ne.w=ne.v),ne.v=Oy[ne.v];break}if(ue=Pe=0,ke=null,et&&H.s!==void 0&&(ke=w.CellXf[H.s],ke!=null&&(ke.numFmtId!=null&&(ue=ke.numFmtId),E.cellStyles&&ke.fillId!=null&&(Pe=ke.fillId))),Fv(ne,ue,Pe,E,_,w),E.cellDates&&et&&ne.t=="n"&&zo(mt[ue])&&(ne.t="d",ne.v=ff(ne.v)),H.cm&&E.xlmeta){var St=(E.xlmeta.Cell||[])[+H.cm-1];St&&St.type=="XLDAPR"&&(ne.D=!0)}if(Je){var Z=Oa(H.r);h[Z.r]||(h[Z.r]=[]),h[Z.r][Z.c]=ne}else h[H.r]=ne}}}}fe.length>0&&(h["!rows"]=fe)}})();function MC(e,a,t,i){var s=[],c=[],f=Qt(e["!ref"]),p="",g,h="",E=[],A=0,_=0,w=e["!rows"],N=Array.isArray(e),k={r:h},F,z=-1;for(_=f.s.c;_<=f.e.c;++_)E[_]=ja(_);for(A=f.s.r;A<=f.e.r;++A){for(c=[],h=Xa(A),_=f.s.c;_<=f.e.c;++_){g=E[_]+h;var K=N?(e[A]||[])[_]:e[g];K!==void 0&&(p=IC(K,g,e,a))!=null&&c.push(p)}(c.length>0||w&&w[A])&&(k={r:h},w&&w[A]&&(F=w[A],F.hidden&&(k.hidden=1),z=-1,F.hpx?z=a0(F.hpx):F.hpt&&(z=F.hpt),z>-1&&(k.ht=z,k.customHeight=1),F.level&&(k.outlineLevel=F.level)),s[s.length]=qe("row",c.join(""),k))}if(w)for(;A<w.length;++A)w&&w[A]&&(k={r:A+1},F=w[A],F.hidden&&(k.hidden=1),z=-1,F.hpx?z=a0(F.hpx):F.hpt&&(z=F.hpt),z>-1&&(k.ht=z,k.customHeight=1),F.level&&(k.outlineLevel=F.level),s[s.length]=qe("row","",k));return s.join("")}function jv(e,a,t,i){var s=[qa,qe("worksheet",null,{xmlns:Yl[0],"xmlns:r":dr.r})],c=t.SheetNames[e],f=0,p="",g=t.Sheets[c];g==null&&(g={});var h=g["!ref"]||"A1",E=Qt(h);if(E.e.c>16383||E.e.r>1048575){if(a.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");E.e.c=Math.min(E.e.c,16383),E.e.r=Math.min(E.e.c,1048575),h=wt(E)}i||(i={}),g["!comments"]=[];var A=[];SC(g,t,e,a,s),s[s.length]=qe("dimension",null,{ref:h}),s[s.length]=OC(g,a,e,t),a.sheetFormat&&(s[s.length]=qe("sheetFormatPr",null,{defaultRowHeight:a.sheetFormat.defaultRowHeight||"16",baseColWidth:a.sheetFormat.baseColWidth||"10",outlineLevelRow:a.sheetFormat.outlineLevelRow||"7"})),g["!cols"]!=null&&g["!cols"].length>0&&(s[s.length]=RC(g,g["!cols"])),s[f=s.length]="<sheetData/>",g["!links"]=[],g["!ref"]!=null&&(p=MC(g,a),p.length>0&&(s[s.length]=p)),s.length>f+1&&(s[s.length]="</sheetData>",s[f]=s[f].replace("/>",">")),g["!protect"]&&(s[s.length]=AC(g["!protect"])),g["!autofilter"]!=null&&(s[s.length]=FC(g["!autofilter"],g,t,e)),g["!merges"]!=null&&g["!merges"].length>0&&(s[s.length]=vC(g["!merges"]));var _=-1,w,N=-1;return g["!links"].length>0&&(s[s.length]="<hyperlinks>",g["!links"].forEach(function(k){k[1].Target&&(w={ref:k[0]},k[1].Target.charAt(0)!="#"&&(N=da(i,-1,fa(k[1].Target).replace(/#.*$/,""),Bt.HLINK),w["r:id"]="rId"+N),(_=k[1].Target.indexOf("#"))>-1&&(w.location=fa(k[1].Target.slice(_+1))),k[1].Tooltip&&(w.tooltip=fa(k[1].Tooltip)),s[s.length]=qe("hyperlink",null,w))}),s[s.length]="</hyperlinks>"),delete g["!links"],g["!margins"]!=null&&(s[s.length]=kC(g["!margins"])),(!a||a.ignoreEC||a.ignoreEC==null)&&(s[s.length]=wr("ignoredErrors",qe("ignoredError",null,{numberStoredAsText:1,sqref:h}))),A.length>0&&(N=da(i,-1,"../drawings/drawing"+(e+1)+".xml",Bt.DRAW),s[s.length]=qe("drawing",null,{"r:id":"rId"+N}),g["!drawing"]=A),g["!comments"].length>0&&(N=da(i,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Bt.VML),s[s.length]=qe("legacyDrawing",null,{"r:id":"rId"+N}),g["!legacy"]=N),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function LC(e,a){var t={},i=e.l+a;t.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var c=e.read_shift(1);return e.l=i,c&7&&(t.level=c&7),c&16&&(t.hidden=!0),c&32&&(t.hpt=s/20),t}function PC(e,a,t){var i=Ne(145),s=(t["!rows"]||[])[e]||{};i.write_shift(4,e),i.write_shift(4,0);var c=320;s.hpx?c=a0(s.hpx)*20:s.hpt&&(c=s.hpt*20),i.write_shift(2,c),i.write_shift(1,0);var f=0;s.level&&(f|=s.level),s.hidden&&(f|=16),(s.hpx||s.hpt)&&(f|=32),i.write_shift(1,f),i.write_shift(1,0);var p=0,g=i.l;i.l+=4;for(var h={r:e,c:0},E=0;E<16;++E)if(!(a.s.c>E+1<<10||a.e.c<E<<10)){for(var A=-1,_=-1,w=E<<10;w<E+1<<10;++w){h.c=w;var N=Array.isArray(t)?(t[h.r]||[])[h.c]:t[bt(h)];N&&(A<0&&(A=w),_=w)}A<0||(++p,i.write_shift(4,A),i.write_shift(4,_))}var k=i.l;return i.l=g,i.write_shift(4,p),i.l=k,i.length>i.l?i.slice(0,i.l):i}function zC(e,a,t,i){var s=PC(i,t,a);(s.length>17||(a["!rows"]||[])[i])&&$e(e,0,s)}var UC=Xl,HC=$o;function $C(){}function YC(e,a){var t={},i=e[e.l];return++e.l,t.above=!(i&64),t.left=!(i&128),e.l+=18,t.name=VS(e),t}function GC(e,a,t){t==null&&(t=Ne(84+4*e.length));var i=192;a&&(a.above&&(i&=-65),a.left&&(i&=-129)),t.write_shift(1,i);for(var s=1;s<3;++s)t.write_shift(1,0);return Zd({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),Ry(e,t),t.slice(0,t.l)}function WC(e){var a=Kn(e);return[a]}function VC(e,a,t){return t==null&&(t=Ne(8)),Gl(a,t)}function XC(e){var a=Wl(e);return[a]}function qC(e,a,t){return t==null&&(t=Ne(4)),Vl(a,t)}function KC(e){var a=Kn(e),t=e.read_shift(1);return[a,t,"b"]}function QC(e,a,t){return t==null&&(t=Ne(9)),Gl(a,t),t.write_shift(1,e.v?1:0),t}function JC(e){var a=Wl(e),t=e.read_shift(1);return[a,t,"b"]}function ZC(e,a,t){return t==null&&(t=Ne(5)),Vl(a,t),t.write_shift(1,e.v?1:0),t}function ek(e){var a=Kn(e),t=e.read_shift(1);return[a,t,"e"]}function tk(e,a,t){return t==null&&(t=Ne(9)),Gl(a,t),t.write_shift(1,e.v),t}function ak(e){var a=Wl(e),t=e.read_shift(1);return[a,t,"e"]}function rk(e,a,t){return t==null&&(t=Ne(8)),Vl(a,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function nk(e){var a=Kn(e),t=e.read_shift(4);return[a,t,"s"]}function ik(e,a,t){return t==null&&(t=Ne(12)),Gl(a,t),t.write_shift(4,a.v),t}function sk(e){var a=Wl(e),t=e.read_shift(4);return[a,t,"s"]}function lk(e,a,t){return t==null&&(t=Ne(8)),Vl(a,t),t.write_shift(4,a.v),t}function ok(e){var a=Kn(e),t=zr(e);return[a,t,"n"]}function ck(e,a,t){return t==null&&(t=Ne(16)),Gl(a,t),zl(e.v,t),t}function Ov(e){var a=Wl(e),t=zr(e);return[a,t,"n"]}function dk(e,a,t){return t==null&&(t=Ne(12)),Vl(a,t),zl(e.v,t),t}function fk(e){var a=Kn(e),t=ch(e);return[a,t,"n"]}function uk(e,a,t){return t==null&&(t=Ne(12)),Gl(a,t),Ny(e.v,t),t}function pk(e){var a=Wl(e),t=ch(e);return[a,t,"n"]}function hk(e,a,t){return t==null&&(t=Ne(8)),Vl(a,t),Ny(e.v,t),t}function gk(e){var a=Kn(e),t=sh(e);return[a,t,"is"]}function xk(e){var a=Kn(e),t=Ur(e);return[a,t,"str"]}function mk(e,a,t){return t==null&&(t=Ne(12+4*e.v.length)),Gl(a,t),vr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function yk(e){var a=Wl(e),t=Ur(e);return[a,t,"str"]}function vk(e,a,t){return t==null&&(t=Ne(8+4*e.v.length)),Vl(a,t),vr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function bk(e,a,t){var i=e.l+a,s=Kn(e);s.r=t["!row"];var c=e.read_shift(1),f=[s,c,"b"];if(t.cellFormula){e.l+=2;var p=hf(e,i-e.l,t);f[3]=Lr(p,null,s,t.supbooks,t)}else e.l=i;return f}function Sk(e,a,t){var i=e.l+a,s=Kn(e);s.r=t["!row"];var c=e.read_shift(1),f=[s,c,"e"];if(t.cellFormula){e.l+=2;var p=hf(e,i-e.l,t);f[3]=Lr(p,null,s,t.supbooks,t)}else e.l=i;return f}function Ek(e,a,t){var i=e.l+a,s=Kn(e);s.r=t["!row"];var c=zr(e),f=[s,c,"n"];if(t.cellFormula){e.l+=2;var p=hf(e,i-e.l,t);f[3]=Lr(p,null,s,t.supbooks,t)}else e.l=i;return f}function Tk(e,a,t){var i=e.l+a,s=Kn(e);s.r=t["!row"];var c=Ur(e),f=[s,c,"str"];if(t.cellFormula){e.l+=2;var p=hf(e,i-e.l,t);f[3]=Lr(p,null,s,t.supbooks,t)}else e.l=i;return f}var Ak=Xl,_k=$o;function Ck(e,a){return a==null&&(a=Ne(4)),a.write_shift(4,e),a}function kk(e,a){var t=e.l+a,i=Xl(e),s=lh(e),c=Ur(e),f=Ur(e),p=Ur(e);e.l=t;var g={rfx:i,relId:s,loc:c,display:p};return f&&(g.Tooltip=f),g}function wk(e,a){var t=Ne(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));$o({s:Oa(e[0]),e:Oa(e[0])},t),oh("rId"+a,t);var i=e[1].Target.indexOf("#"),s=i==-1?"":e[1].Target.slice(i+1);return vr(s||"",t),vr(e[1].Tooltip||"",t),vr("",t),t.slice(0,t.l)}function Rk(){}function Nk(e,a,t){var i=e.l+a,s=Fy(e),c=e.read_shift(1),f=[s];if(f[2]=c,t.cellFormula){var p=eC(e,i-e.l,t);f[1]=p}else e.l=i;return f}function Fk(e,a,t){var i=e.l+a,s=Xl(e),c=[s];if(t.cellFormula){var f=aC(e,i-e.l,t);c[1]=f,e.l=i}else e.l=i;return c}function Dk(e,a,t){t==null&&(t=Ne(18));var i=gf(e,a);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(i.width||10)*256),t.write_shift(4,0);var s=0;return a.hidden&&(s|=1),typeof i.width=="number"&&(s|=2),a.level&&(s|=a.level<<8),t.write_shift(2,s),t}var Iv=["left","right","top","bottom","header","footer"];function jk(e){var a={};return Iv.forEach(function(t){a[t]=zr(e)}),a}function Ok(e,a){return a==null&&(a=Ne(48)),Ml(e),Iv.forEach(function(t){zl(e[t],a)}),a}function Ik(e){var a=e.read_shift(2);return e.l+=28,{RTL:a&32}}function Bk(e,a,t){t==null&&(t=Ne(30));var i=924;return(((a||{}).Views||[])[0]||{}).RTL&&(i|=32),t.write_shift(2,i),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function Mk(e){var a=Ne(24);return a.write_shift(4,4),a.write_shift(4,1),$o(e,a),a}function Lk(e,a){return a==null&&(a=Ne(66)),a.write_shift(2,e.password?gh(e.password):0),a.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?a.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):a.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),a}function Pk(){}function zk(){}function Uk(e,a,t,i,s,c,f){if(!e)return e;var p=a||{};i||(i={"!id":{}});var g=p.dense?[]:{},h,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},A=!1,_=!1,w,N,k,F,z,K,M,ie,se,ne=[];p.biff=12,p["!row"]=0;var H=0,le=!1,oe=[],m={},Se=p.supbooks||s.supbooks||[[]];if(Se.sharedf=m,Se.arrayf=oe,Se.SheetNames=s.SheetNames||s.Sheets.map(function(Je){return Je.name}),!p.supbooks&&(p.supbooks=Se,s.Names))for(var ue=0;ue<s.Names.length;++ue)Se[0][ue+1]=s.Names[ue];var Pe=[],et=[],ke=!1;r0[16]={n:"BrtShortReal",f:Ov};var de;if(ls(e,function(fe,Ke,ee){if(!_)switch(ee){case 148:h=fe;break;case 0:w=fe,p.sheetRows&&p.sheetRows<=w.r&&(_=!0),ie=Xa(F=w.r),p["!row"]=w.r,(fe.hidden||fe.hpt||fe.level!=null)&&(fe.hpt&&(fe.hpx=Po(fe.hpt)),et[fe.r]=fe);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(N={t:fe[2]},fe[2]){case"n":N.v=fe[1];break;case"s":M=Hc[fe[1]],N.v=M.t,N.r=M.r;break;case"b":N.v=!!fe[1];break;case"e":N.v=fe[1],p.cellText!==!1&&(N.w=os[N.v]);break;case"str":N.t="s",N.v=fe[1];break;case"is":N.t="s",N.v=fe[1].t;break}if((k=f.CellXf[fe[0].iStyleRef])&&Fv(N,k.numFmtId,null,p,c,f),z=fe[0].c==-1?z+1:fe[0].c,p.dense?(g[F]||(g[F]=[]),g[F][z]=N):g[ja(z)+ie]=N,p.cellFormula){for(le=!1,H=0;H<oe.length;++H){var I=oe[H];w.r>=I[0].s.r&&w.r<=I[0].e.r&&z>=I[0].s.c&&z<=I[0].e.c&&(N.F=wt(I[0]),le=!0)}!le&&fe.length>3&&(N.f=fe[3])}if(E.s.r>w.r&&(E.s.r=w.r),E.s.c>z&&(E.s.c=z),E.e.r<w.r&&(E.e.r=w.r),E.e.c<z&&(E.e.c=z),p.cellDates&&k&&N.t=="n"&&zo(mt[k.numFmtId])){var L=jl(N.v);L&&(N.t="d",N.v=new Date(L.y,L.m-1,L.d,L.H,L.M,L.S,L.u))}de&&(de.type=="XLDAPR"&&(N.D=!0),de=void 0);break;case 1:case 12:if(!p.sheetStubs||A)break;N={t:"z",v:void 0},z=fe[0].c==-1?z+1:fe[0].c,p.dense?(g[F]||(g[F]=[]),g[F][z]=N):g[ja(z)+ie]=N,E.s.r>w.r&&(E.s.r=w.r),E.s.c>z&&(E.s.c=z),E.e.r<w.r&&(E.e.r=w.r),E.e.c<z&&(E.e.c=z),de&&(de.type=="XLDAPR"&&(N.D=!0),de=void 0);break;case 176:ne.push(fe);break;case 49:de=((p.xlmeta||{}).Cell||[])[fe-1];break;case 494:var Q=i["!id"][fe.relId];for(Q?(fe.Target=Q.Target,fe.loc&&(fe.Target+="#"+fe.loc),fe.Rel=Q):fe.relId==""&&(fe.Target="#"+fe.loc),F=fe.rfx.s.r;F<=fe.rfx.e.r;++F)for(z=fe.rfx.s.c;z<=fe.rfx.e.c;++z)p.dense?(g[F]||(g[F]=[]),g[F][z]||(g[F][z]={t:"z",v:void 0}),g[F][z].l=fe):(K=bt({c:z,r:F}),g[K]||(g[K]={t:"z",v:void 0}),g[K].l=fe);break;case 426:if(!p.cellFormula)break;oe.push(fe),se=p.dense?g[F][z]:g[ja(z)+ie],se.f=Lr(fe[1],E,{r:w.r,c:z},Se,p),se.F=wt(fe[0]);break;case 427:if(!p.cellFormula)break;m[bt(fe[0].s)]=fe[1],se=p.dense?g[F][z]:g[ja(z)+ie],se.f=Lr(fe[1],E,{r:w.r,c:z},Se,p);break;case 60:if(!p.cellStyles)break;for(;fe.e>=fe.s;)Pe[fe.e--]={width:fe.w/256,hidden:!!(fe.flags&1),level:fe.level},ke||(ke=!0,xh(fe.w/256)),Qs(Pe[fe.e+1]);break;case 161:g["!autofilter"]={ref:wt(fe)};break;case 476:g["!margins"]=fe;break;case 147:s.Sheets[t]||(s.Sheets[t]={}),fe.name&&(s.Sheets[t].CodeName=fe.name),(fe.above||fe.left)&&(g["!outline"]={above:fe.above,left:fe.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),fe.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:A=!0;break;case 36:A=!1;break;case 37:A=!0;break;case 38:A=!1;break;default:if(!Ke.T){if(!A||p.WTF)throw new Error("Unexpected record 0x"+ee.toString(16))}}},p),delete p.supbooks,delete p["!row"],!g["!ref"]&&(E.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(g["!ref"]=wt(h||E)),p.sheetRows&&g["!ref"]){var Ce=Qt(g["!ref"]);p.sheetRows<=+Ce.e.r&&(Ce.e.r=p.sheetRows-1,Ce.e.r>E.e.r&&(Ce.e.r=E.e.r),Ce.e.r<Ce.s.r&&(Ce.s.r=Ce.e.r),Ce.e.c>E.e.c&&(Ce.e.c=E.e.c),Ce.e.c<Ce.s.c&&(Ce.s.c=Ce.e.c),g["!fullref"]=g["!ref"],g["!ref"]=wt(Ce))}return ne.length>0&&(g["!merges"]=ne),Pe.length>0&&(g["!cols"]=Pe),et.length>0&&(g["!rows"]=et),g}function Hk(e,a,t,i,s,c,f){if(a.v===void 0)return!1;var p="";switch(a.t){case"b":p=a.v?"1":"0";break;case"d":a=wa(a),a.z=a.z||mt[14],a.v=fr(ka(a.v)),a.t="n";break;case"n":case"e":p=""+a.v;break;default:p=a.v;break}var g={r:t,c:i};switch(g.s=al(s.cellXfs,a,s),a.l&&c["!links"].push([bt(g),a.l]),a.c&&c["!comments"].push([bt(g),a.c]),a.t){case"s":case"str":return s.bookSST?(p=Sh(s.Strings,a.v,s.revStrings),g.t="s",g.v=p,f?$e(e,18,lk(a,g)):$e(e,7,ik(a,g))):(g.t="str",f?$e(e,17,vk(a,g)):$e(e,6,mk(a,g))),!0;case"n":return a.v==(a.v|0)&&a.v>-1e3&&a.v<1e3?f?$e(e,13,hk(a,g)):$e(e,2,uk(a,g)):f?$e(e,16,dk(a,g)):$e(e,5,ck(a,g)),!0;case"b":return g.t="b",f?$e(e,15,ZC(a,g)):$e(e,4,QC(a,g)),!0;case"e":return g.t="e",f?$e(e,14,rk(a,g)):$e(e,3,tk(a,g)),!0}return f?$e(e,12,qC(a,g)):$e(e,1,VC(a,g)),!0}function $k(e,a,t,i){var s=Qt(a["!ref"]||"A1"),c,f="",p=[];$e(e,145);var g=Array.isArray(a),h=s.e.r;a["!rows"]&&(h=Math.max(s.e.r,a["!rows"].length-1));for(var E=s.s.r;E<=h;++E){f=Xa(E),zC(e,a,s,E);var A=!1;if(E<=s.e.r)for(var _=s.s.c;_<=s.e.c;++_){E===s.s.r&&(p[_]=ja(_)),c=p[_]+f;var w=g?(a[E]||[])[_]:a[c];if(!w){A=!1;continue}A=Hk(e,w,E,_,i,a,A)}}$e(e,146)}function Yk(e,a){!a||!a["!merges"]||($e(e,177,Ck(a["!merges"].length)),a["!merges"].forEach(function(t){$e(e,176,_k(t))}),$e(e,178))}function Gk(e,a){!a||!a["!cols"]||($e(e,390),a["!cols"].forEach(function(t,i){t&&$e(e,60,Dk(i,t))}),$e(e,391))}function Wk(e,a){!a||!a["!ref"]||($e(e,648),$e(e,649,Mk(Qt(a["!ref"]))),$e(e,650))}function Vk(e,a,t){a["!links"].forEach(function(i){if(i[1].Target){var s=da(t,-1,i[1].Target.replace(/#.*$/,""),Bt.HLINK);$e(e,494,wk(i,s))}}),delete a["!links"]}function Xk(e,a,t,i){if(a["!comments"].length>0){var s=da(i,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Bt.VML);$e(e,551,oh("rId"+s)),a["!legacy"]=s}}function qk(e,a,t,i){if(a["!autofilter"]){var s=a["!autofilter"],c=typeof s.ref=="string"?s.ref:wt(s.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var f=t.Workbook.Names,p=un(c);p.s.r==p.e.r&&(p.e.r=un(a["!ref"]).e.r,c=wt(p));for(var g=0;g<f.length;++g){var h=f[g];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==i){h.Ref="'"+t.SheetNames[i]+"'!"+c;break}}g==f.length&&f.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+t.SheetNames[i]+"'!"+c}),$e(e,161,$o(Qt(c))),$e(e,162)}}function Kk(e,a,t){$e(e,133),$e(e,137,Bk(a,t)),$e(e,138),$e(e,134)}function Qk(e,a){a["!protect"]&&$e(e,535,Lk(a["!protect"]))}function Jk(e,a,t,i){var s=fn(),c=t.SheetNames[e],f=t.Sheets[c]||{},p=c;try{t&&t.Workbook&&(p=t.Workbook.Sheets[e].CodeName||p)}catch{}var g=Qt(f["!ref"]||"A1");if(g.e.c>16383||g.e.r>1048575){if(a.WTF)throw new Error("Range "+(f["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575)}return f["!links"]=[],f["!comments"]=[],$e(s,129),(t.vbaraw||f["!outline"])&&$e(s,147,GC(p,f["!outline"])),$e(s,148,HC(g)),Kk(s,f,t.Workbook),Gk(s,f),$k(s,f,e,a),Qk(s,f),qk(s,f,t,e),Yk(s,f),Vk(s,f,i),f["!margins"]&&$e(s,476,Ok(f["!margins"])),(!a||a.ignoreEC||a.ignoreEC==null)&&Wk(s,f),Xk(s,f,e,i),$e(s,130),s.end()}function Zk(e){var a=[],t=e.match(/^<c:numCache>/),i;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(c){var f=c.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);f&&(a[+f[1]]=t?+f[2]:f[2])});var s=Kt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(c){i=c.replace(/<.*?>/g,"")}),[a,s,i]}function ew(e,a,t,i,s,c){var f=c||{"!type":"chart"};if(!e)return c;var p=0,g=0,h="A",E={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(A){var _=Zk(A);E.s.r=E.s.c=0,E.e.c=p,h=ja(p),_[0].forEach(function(w,N){f[h+Xa(N)]={t:"n",v:w,z:_[1]},g=N}),E.e.r<g&&(E.e.r=g),++p}),p>0&&(f["!ref"]=wt(E)),f}function tw(e,a,t,i,s){if(!e)return e;i||(i={"!id":{}});var c={"!type":"chart","!drawel":null,"!rel":""},f,p=e.match(Dv);return p&&Eh(p[0],c,s,t),(f=e.match(/drawing r:id="(.*?)"/))&&(c["!rel"]=f[1]),i["!id"][c["!rel"]]&&(c["!drawel"]=i["!id"][c["!rel"]]),c}function aw(e,a){e.l+=10;var t=Ur(e);return{name:t}}function rw(e,a,t,i,s){if(!e)return e;i||(i={"!id":{}});var c={"!type":"chart","!drawel":null,"!rel":""},f=!1;return ls(e,function(g,h,E){switch(E){case 550:c["!rel"]=g;break;case 651:s.Sheets[t]||(s.Sheets[t]={}),g.name&&(s.Sheets[t].CodeName=g.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:f=!0;break;case 36:f=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!f||a.WTF)throw new Error("Unexpected record 0x"+E.toString(16))}}}},a),i["!id"][c["!rel"]]&&(c["!drawel"]=i["!id"][c["!rel"]]),c}var Th=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],nw=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],iw=[],sw=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function jm(e,a){for(var t=0;t!=e.length;++t)for(var i=e[t],s=0;s!=a.length;++s){var c=a[s];if(i[c[0]]==null)i[c[0]]=c[1];else switch(c[2]){case"bool":typeof i[c[0]]=="string"&&(i[c[0]]=Ca(i[c[0]]));break;case"int":typeof i[c[0]]=="string"&&(i[c[0]]=parseInt(i[c[0]],10));break}}}function Om(e,a){for(var t=0;t!=a.length;++t){var i=a[t];if(e[i[0]]==null)e[i[0]]=i[1];else switch(i[2]){case"bool":typeof e[i[0]]=="string"&&(e[i[0]]=Ca(e[i[0]]));break;case"int":typeof e[i[0]]=="string"&&(e[i[0]]=parseInt(e[i[0]],10));break}}}function Bv(e){Om(e.WBProps,Th),Om(e.CalcPr,sw),jm(e.WBView,nw),jm(e.Sheets,iw),Bo.date1904=Ca(e.WBProps.date1904)}function lw(e){return!e.Workbook||!e.Workbook.WBProps?"false":Ca(e.Workbook.WBProps.date1904)?"true":"false"}var ow="][*?/\\".split("");function Mv(e,a){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return ow.forEach(function(i){if(e.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function cw(e,a,t){e.forEach(function(i,s){Mv(i);for(var c=0;c<s;++c)if(i==e[c])throw new Error("Duplicate Sheet Name: "+i);if(t){var f=a&&a[s]&&a[s].CodeName||i;if(f.charCodeAt(0)==95&&f.length>22)throw new Error("Bad Code Name: Worksheet"+f)}})}function dw(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var a=e.Workbook&&e.Workbook.Sheets||[];cw(e.SheetNames,a,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)lC(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}var fw=/<\w+:workbook/;function uw(e,a){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},i=!1,s="xmlns",c={},f=0;if(e.replace($r,function(g,h){var E=Et(g);switch(Fi(E[0])){case"<?xml":break;case"<workbook":g.match(fw)&&(s="xmlns"+g.match(/<(\w+):/)[1]),t.xmlns=E[s];break;case"</workbook>":break;case"<fileVersion":delete E[0],t.AppVersion=E;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Th.forEach(function(A){if(E[A[0]]!=null)switch(A[2]){case"bool":t.WBProps[A[0]]=Ca(E[A[0]]);break;case"int":t.WBProps[A[0]]=parseInt(E[A[0]],10);break;default:t.WBProps[A[0]]=E[A[0]]}}),E.codeName&&(t.WBProps.CodeName=xa(E.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete E[0],t.WBView.push(E);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(E.state){case"hidden":E.Hidden=1;break;case"veryHidden":E.Hidden=2;break;default:E.Hidden=0}delete E.state,E.name=Kt(xa(E.name)),delete E[0],t.Sheets.push(E);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":i=!0;break;case"</definedNames>":i=!1;break;case"<definedName":c={},c.Name=xa(E.name),E.comment&&(c.Comment=E.comment),E.localSheetId&&(c.Sheet=+E.localSheetId),Ca(E.hidden||"0")&&(c.Hidden=!0),f=h+g.length;break;case"</definedName>":c.Ref=Kt(xa(e.slice(f,h))),t.Names.push(c);break;case"<definedName/>":break;case"<calcPr":delete E[0],t.CalcPr=E;break;case"<calcPr/>":delete E[0],t.CalcPr=E;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":i=!0;break;case"</AlternateContent>":i=!1;break;case"<revisionPtr":break;default:if(!i&&a.WTF)throw new Error("unrecognized "+E[0]+" in workbook")}return g}),Yl.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return Bv(t),t}function Lv(e){var a=[qa];a[a.length]=qe("workbook",null,{xmlns:Yl[0],"xmlns:r":dr.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Th.forEach(function(p){e.Workbook.WBProps[p[0]]!=null&&e.Workbook.WBProps[p[0]]!=p[1]&&(i[p[0]]=e.Workbook.WBProps[p[0]])}),e.Workbook.WBProps.CodeName&&(i.codeName=e.Workbook.WBProps.CodeName,delete i.CodeName)),a[a.length]=qe("workbookPr",null,i);var s=e.Workbook&&e.Workbook.Sheets||[],c=0;if(s&&s[0]&&s[0].Hidden){for(a[a.length]="<bookViews>",c=0;c!=e.SheetNames.length&&!(!s[c]||!s[c].Hidden);++c);c==e.SheetNames.length&&(c=0),a[a.length]='<workbookView firstSheet="'+c+'" activeTab="'+c+'"/>',a[a.length]="</bookViews>"}for(a[a.length]="<sheets>",c=0;c!=e.SheetNames.length;++c){var f={name:fa(e.SheetNames[c].slice(0,31))};if(f.sheetId=""+(c+1),f["r:id"]="rId"+(c+1),s[c])switch(s[c].Hidden){case 1:f.state="hidden";break;case 2:f.state="veryHidden";break}a[a.length]=qe("sheet",null,f)}return a[a.length]="</sheets>",t&&(a[a.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(p){var g={name:p.Name};p.Comment&&(g.comment=p.Comment),p.Sheet!=null&&(g.localSheetId=""+p.Sheet),p.Hidden&&(g.hidden="1"),p.Ref&&(a[a.length]=qe("definedName",fa(p.Ref),g))}),a[a.length]="</definedNames>"),a.length>2&&(a[a.length]="</workbook>",a[1]=a[1].replace("/>",">")),a.join("")}function pw(e,a){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=jp(e),t.name=Ur(e),t}function hw(e,a){return a||(a=Ne(127)),a.write_shift(4,e.Hidden),a.write_shift(4,e.iTabID),oh(e.strRelID,a),vr(e.name.slice(0,31),a),a.length>a.l?a.slice(0,a.l):a}function gw(e,a){var t={},i=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var s=a>8?Ur(e):"";return s.length>0&&(t.CodeName=s),t.autoCompressPictures=!!(i&65536),t.backupFile=!!(i&64),t.checkCompatibility=!!(i&4096),t.date1904=!!(i&1),t.filterPrivacy=!!(i&8),t.hidePivotFieldList=!!(i&1024),t.promptedSolutions=!!(i&16),t.publishItems=!!(i&2048),t.refreshAllConnections=!!(i&262144),t.saveExternalLinkValues=!!(i&128),t.showBorderUnselectedTables=!!(i&4),t.showInkAnnotation=!!(i&32),t.showObjects=["all","placeholders","none"][i>>13&3],t.showPivotChartFilter=!!(i&32768),t.updateLinks=["userSet","never","always"][i>>8&3],t}function xw(e,a){a||(a=Ne(72));var t=0;return e&&e.filterPrivacy&&(t|=8),a.write_shift(4,t),a.write_shift(4,0),Ry(e&&e.CodeName||"ThisWorkbook",a),a.slice(0,a.l)}function mw(e,a){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=a-8,t}function yw(e,a,t){var i=e.l+a;e.l+=4,e.l+=1;var s=e.read_shift(4),c=XS(e),f=tC(e,0,t),p=lh(e);e.l=i;var g={Name:c,Ptg:f};return s<268435455&&(g.Sheet=s),p&&(g.Comment=p),g}function vw(e,a){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},i=[],s=!1;a||(a={}),a.biff=12;var c=[],f=[[]];return f.SheetNames=[],f.XTI=[],r0[16]={n:"BrtFRTArchID$",f:mw},ls(e,function(g,h,E){switch(E){case 156:f.SheetNames.push(g.name),t.Sheets.push(g);break;case 153:t.WBProps=g;break;case 39:g.Sheet!=null&&(a.SID=g.Sheet),g.Ref=Lr(g.Ptg,null,null,f,a),delete a.SID,delete g.Ptg,c.push(g);break;case 1036:break;case 357:case 358:case 355:case 667:f[0].length?f.push([E,g]):f[0]=[E,g],f[f.length-1].XTI=[];break;case 362:f.length===0&&(f[0]=[],f[0].XTI=[]),f[f.length-1].XTI=f[f.length-1].XTI.concat(g),f.XTI=f.XTI.concat(g);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:i.push(E),s=!0;break;case 36:i.pop(),s=!1;break;case 37:i.push(E),s=!0;break;case 38:i.pop(),s=!1;break;case 16:break;default:if(!h.T){if(!s||a.WTF&&i[i.length-1]!=37&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+E.toString(16))}}},a),Bv(t),t.Names=c,t.supbooks=f,t}function bw(e,a){$e(e,143);for(var t=0;t!=a.SheetNames.length;++t){var i=a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[t]&&a.Workbook.Sheets[t].Hidden||0,s={Hidden:i,iTabID:t+1,strRelID:"rId"+(t+1),name:a.SheetNames[t]};$e(e,156,hw(s))}$e(e,144)}function Sw(e,a){a||(a=Ne(127));for(var t=0;t!=4;++t)a.write_shift(4,0);return vr("SheetJS",a),vr(Wd.version,a),vr(Wd.version,a),vr("7262",a),a.length>a.l?a.slice(0,a.l):a}function Ew(e,a){a||(a=Ne(29)),a.write_shift(-4,0),a.write_shift(-4,460),a.write_shift(4,28800),a.write_shift(4,17600),a.write_shift(4,500),a.write_shift(4,e),a.write_shift(4,e);var t=120;return a.write_shift(1,t),a.length>a.l?a.slice(0,a.l):a}function Tw(e,a){if(!(!a.Workbook||!a.Workbook.Sheets)){for(var t=a.Workbook.Sheets,i=0,s=-1,c=-1;i<t.length;++i)!t[i]||!t[i].Hidden&&s==-1?s=i:t[i].Hidden==1&&c==-1&&(c=i);c>s||($e(e,135),$e(e,158,Ew(s)),$e(e,136))}}function Aw(e,a){var t=fn();return $e(t,131),$e(t,128,Sw()),$e(t,153,xw(e.Workbook&&e.Workbook.WBProps||null)),Tw(t,e),bw(t,e),$e(t,132),t.end()}function _w(e,a,t){return a.slice(-4)===".bin"?vw(e,t):uw(e,t)}function Cw(e,a,t,i,s,c,f,p){return a.slice(-4)===".bin"?Uk(e,i,t,s,c,f,p):yC(e,i,t,s,c,f,p)}function kw(e,a,t,i,s,c,f,p){return a.slice(-4)===".bin"?rw(e,i,t,s,c):tw(e,i,t,s,c)}function ww(e,a,t,i,s,c,f,p){return a.slice(-4)===".bin"?N4():F4()}function Rw(e,a,t,i,s,c,f,p){return a.slice(-4)===".bin"?w4():R4()}function Nw(e,a,t,i){return a.slice(-4)===".bin"?__(e,t,i):p_(e,t,i)}function Fw(e,a,t){return yv(e,t)}function Dw(e,a,t){return a.slice(-4)===".bin"?DA(e,t):RA(e,t)}function jw(e,a,t){return a.slice(-4)===".bin"?T4(e,t):h4(e,t)}function Ow(e,a,t){return a.slice(-4)===".bin"?f4(e):c4(e)}function Iw(e,a,t,i){return t.slice(-4)===".bin"?u4(e,a,t,i):void 0}function Bw(e,a,t){return a.slice(-4)===".bin"?s4(e,a,t):o4(e,a,t)}function Mw(e,a,t){return(a.slice(-4)===".bin"?Aw:Lv)(e)}function Lw(e,a,t,i,s){return(a.slice(-4)===".bin"?Jk:jv)(e,t,i,s)}function Pw(e,a,t){return(a.slice(-4)===".bin"?I_:xv)(e,t)}function zw(e,a,t){return(a.slice(-4)===".bin"?IA:ov)(e,t)}function Uw(e,a,t){return(a.slice(-4)===".bin"?A4:Sv)(e)}function Hw(e){return(e.slice(-4)===".bin"?l4:vv)()}var Pv=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,zv=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ui(e,a){var t=e.split(/\s+/),i=[];if(i[0]=t[0],t.length===1)return i;var s=e.match(Pv),c,f,p,g;if(s)for(g=0;g!=s.length;++g)c=s[g].match(zv),(f=c[1].indexOf(":"))===-1?i[c[1]]=c[2].slice(1,c[2].length-1):(c[1].slice(0,6)==="xmlns:"?p="xmlns"+c[1].slice(6):p=c[1].slice(f+1),i[p]=c[2].slice(1,c[2].length-1));return i}function $w(e){var a=e.split(/\s+/),t={};if(a.length===1)return t;var i=e.match(Pv),s,c,f,p;if(i)for(p=0;p!=i.length;++p)s=i[p].match(zv),(c=s[1].indexOf(":"))===-1?t[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?f="xmlns"+s[1].slice(6):f=s[1].slice(c+1),t[f]=s[2].slice(1,s[2].length-1));return t}var Yc;function Yw(e,a){var t=Yc[e]||Kt(e);return t==="General"?Ll(a):qn(t,a)}function Gw(e,a,t,i){var s=i;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Ca(i);break;case"i2":case"int":s=parseInt(i,10);break;case"r4":case"float":s=parseFloat(i);break;case"date":case"dateTime.tz":s=ka(i);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[Kt(a)]=s}function Ww(e,a,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||os[e.v]:a==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Xc(e.v):e.w=Ll(e.v):e.w=Yw(a||"General",e.v)}catch(c){if(t.WTF)throw c}try{var i=Yc[a]||a||"General";if(t.cellNF&&(e.z=i),t.cellDates&&e.t=="n"&&zo(i)){var s=jl(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(c){if(t.WTF)throw c}}}function Vw(e,a,t){if(t.cellStyles&&a.Interior){var i=a.Interior;i.Pattern&&(i.patternType=i_[i.Pattern]||i.Pattern)}e[a.ID]=a}function Xw(e,a,t,i,s,c,f,p,g,h){var E="General",A=i.StyleID,_={};h=h||{};var w=[],N=0;for(A===void 0&&p&&(A=p.StyleID),A===void 0&&f&&(A=f.StyleID);c[A]!==void 0&&(c[A].nf&&(E=c[A].nf),c[A].Interior&&w.push(c[A].Interior),!!c[A].Parent);)A=c[A].Parent;switch(t.Type){case"Boolean":i.t="b",i.v=Ca(e);break;case"String":i.t="s",i.r=Qx(Kt(e)),i.v=e.indexOf("<")>-1?Kt(a||e).replace(/<.*?>/g,""):i.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),i.v=(ka(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),i.v!==i.v?i.v=Kt(e):i.v<60&&(i.v=i.v-1),(!E||E=="General")&&(E="yyyy-mm-dd");case"Number":i.v===void 0&&(i.v=+e),i.t||(i.t="n");break;case"Error":i.t="e",i.v=Oy[e],h.cellText!==!1&&(i.w=e);break;default:e==""&&a==""?i.t="z":(i.t="s",i.v=Qx(a||e));break}if(Ww(i,E,h),h.cellFormula!==!1)if(i.Formula){var k=Kt(i.Formula);k.charCodeAt(0)==61&&(k=k.slice(1)),i.f=Io(k,s),delete i.Formula,i.ArrayRange=="RC"?i.F=Io("RC:RC",s):i.ArrayRange&&(i.F=Io(i.ArrayRange,s),g.push([Qt(i.F),i.F]))}else for(N=0;N<g.length;++N)s.r>=g[N][0].s.r&&s.r<=g[N][0].e.r&&s.c>=g[N][0].s.c&&s.c<=g[N][0].e.c&&(i.F=g[N][1]);h.cellStyles&&(w.forEach(function(F){!_.patternType&&F.patternType&&(_.patternType=F.patternType)}),i.s=_),i.StyleID!==void 0&&(i.ixfe=i.StyleID)}function qw(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Cp(e,a){var t=a||{};Uo();var i=Ic(th(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(i=xa(i));var s=i.slice(0,1024).toLowerCase(),c=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var f=wa(t);return f.type="string",Lo.to_workbook(i,f)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ta){s.indexOf("<"+Ta)>=0&&(c=!0)}),c)return O6(i,t);Yc={"General Number":"General","General Date":mt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":mt[15],"Short Date":mt[14],"Long Time":mt[19],"Medium Time":mt[18],"Short Time":mt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:mt[2],Standard:mt[4],Percent:mt[10],Scientific:mt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var p,g=[],h,E={},A=[],_=t.dense?[]:{},w="",N={},k={},F=ui('<Data ss:Type="String">'),z=0,K=0,M=0,ie={s:{r:2e6,c:2e6},e:{r:0,c:0}},se={},ne={},H="",le=0,oe=[],m={},Se={},ue=0,Pe=[],et=[],ke={},de=[],Ce,Je=!1,fe=[],Ke=[],ee={},I=0,L=0,Q={Sheets:[],WBProps:{date1904:!1}},te={};Qc.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"");for(var ge="";p=Qc.exec(i);)switch(p[3]=(ge=p[3]).toLowerCase()){case"data":if(ge=="data"){if(p[1]==="/"){if((h=g.pop())[0]!==p[3])throw new Error("Bad state: "+h.join("|"))}else p[0].charAt(p[0].length-2)!=="/"&&g.push([p[3],!0]);break}if(g[g.length-1][1])break;p[1]==="/"?Xw(i.slice(z,p.index),H,F,g[g.length-1][0]=="comment"?ke:N,{c:K,r:M},se,de[K],k,fe,t):(H="",F=ui(p[0]),z=p.index+p[0].length);break;case"cell":if(p[1]==="/")if(et.length>0&&(N.c=et),(!t.sheetRows||t.sheetRows>M)&&N.v!==void 0&&(t.dense?(_[M]||(_[M]=[]),_[M][K]=N):_[ja(K)+Xa(M)]=N),N.HRef&&(N.l={Target:Kt(N.HRef)},N.HRefScreenTip&&(N.l.Tooltip=N.HRefScreenTip),delete N.HRef,delete N.HRefScreenTip),(N.MergeAcross||N.MergeDown)&&(I=K+(parseInt(N.MergeAcross,10)|0),L=M+(parseInt(N.MergeDown,10)|0),oe.push({s:{c:K,r:M},e:{c:I,r:L}})),!t.sheetStubs)N.MergeAcross?K=I+1:++K;else if(N.MergeAcross||N.MergeDown){for(var je=K;je<=I;++je)for(var ze=M;ze<=L;++ze)(je>K||ze>M)&&(t.dense?(_[ze]||(_[ze]=[]),_[ze][je]={t:"z"}):_[ja(je)+Xa(ze)]={t:"z"});K=I+1}else++K;else N=$w(p[0]),N.Index&&(K=+N.Index-1),K<ie.s.c&&(ie.s.c=K),K>ie.e.c&&(ie.e.c=K),p[0].slice(-2)==="/>"&&++K,et=[];break;case"row":p[1]==="/"||p[0].slice(-2)==="/>"?(M<ie.s.r&&(ie.s.r=M),M>ie.e.r&&(ie.e.r=M),p[0].slice(-2)==="/>"&&(k=ui(p[0]),k.Index&&(M=+k.Index-1)),K=0,++M):(k=ui(p[0]),k.Index&&(M=+k.Index-1),ee={},(k.AutoFitHeight=="0"||k.Height)&&(ee.hpx=parseInt(k.Height,10),ee.hpt=a0(ee.hpx),Ke[M]=ee),k.Hidden=="1"&&(ee.hidden=!0,Ke[M]=ee));break;case"worksheet":if(p[1]==="/"){if((h=g.pop())[0]!==p[3])throw new Error("Bad state: "+h.join("|"));A.push(w),ie.s.r<=ie.e.r&&ie.s.c<=ie.e.c&&(_["!ref"]=wt(ie),t.sheetRows&&t.sheetRows<=ie.e.r&&(_["!fullref"]=_["!ref"],ie.e.r=t.sheetRows-1,_["!ref"]=wt(ie))),oe.length&&(_["!merges"]=oe),de.length>0&&(_["!cols"]=de),Ke.length>0&&(_["!rows"]=Ke),E[w]=_}else ie={s:{r:2e6,c:2e6},e:{r:0,c:0}},M=K=0,g.push([p[3],!1]),h=ui(p[0]),w=Kt(h.Name),_=t.dense?[]:{},oe=[],fe=[],Ke=[],te={name:w,Hidden:0},Q.Sheets.push(te);break;case"table":if(p[1]==="/"){if((h=g.pop())[0]!==p[3])throw new Error("Bad state: "+h.join("|"))}else{if(p[0].slice(-2)=="/>")break;g.push([p[3],!1]),de=[],Je=!1}break;case"style":p[1]==="/"?Vw(se,ne,t):ne=ui(p[0]);break;case"numberformat":ne.nf=Kt(ui(p[0]).Format||"General"),Yc[ne.nf]&&(ne.nf=Yc[ne.nf]);for(var Oe=0;Oe!=392&&mt[Oe]!=ne.nf;++Oe);if(Oe==392){for(Oe=57;Oe!=392;++Oe)if(mt[Oe]==null){rs(ne.nf,Oe);break}}break;case"column":if(g[g.length-1][0]!=="table")break;if(Ce=ui(p[0]),Ce.Hidden&&(Ce.hidden=!0,delete Ce.Hidden),Ce.Width&&(Ce.wpx=parseInt(Ce.Width,10)),!Je&&Ce.wpx>10){Je=!0,Pr=hv;for(var Ue=0;Ue<de.length;++Ue)de[Ue]&&Qs(de[Ue])}Je&&Qs(Ce),de[Ce.Index-1||de.length]=Ce;for(var St=0;St<+Ce.Span;++St)de[de.length]=wa(Ce);break;case"namedrange":if(p[1]==="/")break;Q.Names||(Q.Names=[]);var Z=Et(p[0]),Jt={Name:Z.Name,Ref:Io(Z.RefersTo.slice(1),{r:0,c:0})};Q.Sheets.length>0&&(Jt.Sheet=Q.Sheets.length-1),Q.Names.push(Jt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(p[0].slice(-2)==="/>")break;p[1]==="/"?H+=i.slice(le,p.index):le=p.index+p[0].length;break;case"interior":if(!t.cellStyles)break;ne.Interior=ui(p[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(p[0].slice(-2)==="/>")break;p[1]==="/"?vE(m,ge,i.slice(ue,p.index)):ue=p.index+p[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(p[1]==="/"){if((h=g.pop())[0]!==p[3])throw new Error("Bad state: "+h.join("|"))}else g.push([p[3],!1]);break;case"comment":if(p[1]==="/"){if((h=g.pop())[0]!==p[3])throw new Error("Bad state: "+h.join("|"));qw(ke),et.push(ke)}else g.push([p[3],!1]),h=ui(p[0]),ke={a:h.Author};break;case"autofilter":if(p[1]==="/"){if((h=g.pop())[0]!==p[3])throw new Error("Bad state: "+h.join("|"))}else if(p[0].charAt(p[0].length-2)!=="/"){var At=ui(p[0]);_["!autofilter"]={ref:Io(At.Range).replace(/\$/g,"")},g.push([p[3],!0])}break;case"name":break;case"datavalidation":if(p[1]==="/"){if((h=g.pop())[0]!==p[3])throw new Error("Bad state: "+h.join("|"))}else p[0].charAt(p[0].length-2)!=="/"&&g.push([p[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(p[1]==="/"){if((h=g.pop())[0]!==p[3])throw new Error("Bad state: "+h.join("|"))}else p[0].charAt(p[0].length-2)!=="/"&&g.push([p[3],!0]);break;case"null":break;default:if(g.length==0&&p[3]=="document"||g.length==0&&p[3]=="uof")return Pm(i,t);var Gt=!0;switch(g[g.length-1][0]){case"officedocumentsettings":switch(p[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Gt=!1}break;case"componentoptions":switch(p[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Gt=!1}break;case"excelworkbook":switch(p[3]){case"date1904":Q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Gt=!1}break;case"workbookoptions":switch(p[3]){case"owcversion":break;case"height":break;case"width":break;default:Gt=!1}break;case"worksheetoptions":switch(p[3]){case"visible":if(p[0].slice(-2)!=="/>")if(p[1]==="/")switch(i.slice(ue,p.index)){case"SheetHidden":te.Hidden=1;break;case"SheetVeryHidden":te.Hidden=2;break}else ue=p.index+p[0].length;break;case"header":_["!margins"]||Ml(_["!margins"]={},"xlml"),isNaN(+Et(p[0]).Margin)||(_["!margins"].header=+Et(p[0]).Margin);break;case"footer":_["!margins"]||Ml(_["!margins"]={},"xlml"),isNaN(+Et(p[0]).Margin)||(_["!margins"].footer=+Et(p[0]).Margin);break;case"pagemargins":var Ct=Et(p[0]);_["!margins"]||Ml(_["!margins"]={},"xlml"),isNaN(+Ct.Top)||(_["!margins"].top=+Ct.Top),isNaN(+Ct.Left)||(_["!margins"].left=+Ct.Left),isNaN(+Ct.Right)||(_["!margins"].right=+Ct.Right),isNaN(+Ct.Bottom)||(_["!margins"].bottom=+Ct.Bottom);break;case"displayrighttoleft":Q.Views||(Q.Views=[]),Q.Views[0]||(Q.Views[0]={}),Q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Gt=!1}break;case"pivottable":case"pivotcache":switch(p[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Gt=!1}break;case"pagebreaks":switch(p[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Gt=!1}break;case"autofilter":switch(p[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Gt=!1}break;case"querytable":switch(p[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Gt=!1}break;case"datavalidation":switch(p[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Gt=!1}break;case"sorting":case"conditionalformatting":switch(p[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Gt=!1}break;case"mapinfo":case"schema":case"data":switch(p[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Gt=!1}break;case"smarttags":break;default:Gt=!1;break}if(Gt||p[3].match(/!\[CDATA/))break;if(!g[g.length-1][1])throw"Unrecognized tag: "+p[3]+"|"+g.join("|");if(g[g.length-1][0]==="customdocumentproperties"){if(p[0].slice(-2)==="/>")break;p[1]==="/"?Gw(Se,ge,Pe,i.slice(ue,p.index)):(Pe=p,ue=p.index+p[0].length);break}if(t.WTF)throw"Unrecognized tag: "+p[3]+"|"+g.join("|")}var at={};return!t.bookSheets&&!t.bookProps&&(at.Sheets=E),at.SheetNames=A,at.Workbook=Q,at.SSF=wa(mt),at.Props=m,at.Custprops=Se,at}function zp(e,a){switch(_h(a=a||{}),a.type||"base64"){case"base64":return Cp(wn(e),a);case"binary":case"buffer":case"file":return Cp(e,a);case"array":return Cp(el(e),a)}}function Kw(e,a){var t=[];return e.Props&&t.push(bE(e.Props,a)),e.Custprops&&t.push(SE(e.Props,e.Custprops)),t.join("")}function Qw(){return""}function Jw(e,a){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return a.cellXfs.forEach(function(i,s){var c=[];c.push(qe("NumberFormat",null,{"ss:Format":fa(mt[i.numFmtId])}));var f={"ss:ID":"s"+(21+s)};t.push(qe("Style",c.join(""),f))}),qe("Styles",t.join(""))}function Uv(e){return qe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+vh(e.Ref,{r:0,c:0})})}function Zw(e){if(!((e||{}).Workbook||{}).Names)return"";for(var a=e.Workbook.Names,t=[],i=0;i<a.length;++i){var s=a[i];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||t.push(Uv(s)))}return qe("Names",t.join(""))}function e6(e,a,t,i){if(!e||!((i||{}).Workbook||{}).Names)return"";for(var s=i.Workbook.Names,c=[],f=0;f<s.length;++f){var p=s[f];p.Sheet==t&&(p.Name.match(/^_xlfn\./)||c.push(Uv(p)))}return c.join("")}function t6(e,a,t,i){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(qe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(qe("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(qe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[t])if(i.Workbook.Sheets[t].Hidden)s.push(qe("Visible",i.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var c=0;c<t&&!(i.Workbook.Sheets[c]&&!i.Workbook.Sheets[c].Hidden);++c);c==t&&s.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(wr("ProtectContents","True")),e["!protect"].objects&&s.push(wr("ProtectObjects","True")),e["!protect"].scenarios&&s.push(wr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(wr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(wr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(f){e["!protect"][f[0]]&&s.push("<"+f[1]+"/>")})),s.length==0?"":qe("WorksheetOptions",s.join(""),{xmlns:An.x})}function a6(e){return e.map(function(a){var t=TS(a.t||""),i=qe("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return qe("Comment",i,{"ss:Author":a.a})}).join("")}function r6(e,a,t,i,s,c,f){if(!e||e.v==null&&e.f==null)return"";var p={};if(e.f&&(p["ss:Formula"]="="+fa(vh(e.f,f))),e.F&&e.F.slice(0,a.length)==a){var g=Oa(e.F.slice(a.length+1));p["ss:ArrayRange"]="RC:R"+(g.r==f.r?"":"["+(g.r-f.r)+"]")+"C"+(g.c==f.c?"":"["+(g.c-f.c)+"]")}if(e.l&&e.l.Target&&(p["ss:HRef"]=fa(e.l.Target),e.l.Tooltip&&(p["x:HRefScreenTip"]=fa(e.l.Tooltip))),t["!merges"])for(var h=t["!merges"],E=0;E!=h.length;++E)h[E].s.c!=f.c||h[E].s.r!=f.r||(h[E].e.c>h[E].s.c&&(p["ss:MergeAcross"]=h[E].e.c-h[E].s.c),h[E].e.r>h[E].s.r&&(p["ss:MergeDown"]=h[E].e.r-h[E].s.r));var A="",_="";switch(e.t){case"z":if(!i.sheetStubs)return"";break;case"n":A="Number",_=String(e.v);break;case"b":A="Boolean",_=e.v?"1":"0";break;case"e":A="Error",_=os[e.v];break;case"d":A="DateTime",_=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||mt[14]);break;case"s":A="String",_=ES(e.v||"");break}var w=al(i.cellXfs,e,i);p["ss:StyleID"]="s"+(21+w),p["ss:Index"]=f.c+1;var N=e.v!=null?_:"",k=e.t=="z"?"":'<Data ss:Type="'+A+'">'+N+"</Data>";return(e.c||[]).length>0&&(k+=a6(e.c)),qe("Cell",k,p)}function n6(e,a){var t='<Row ss:Index="'+(e+1)+'"';return a&&(a.hpt&&!a.hpx&&(a.hpx=Po(a.hpt)),a.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+a.hpx+'"'),a.hidden&&(t+=' ss:Hidden="1"')),t+">"}function i6(e,a,t,i){if(!e["!ref"])return"";var s=Qt(e["!ref"]),c=e["!merges"]||[],f=0,p=[];e["!cols"]&&e["!cols"].forEach(function(F,z){Qs(F);var K=!!F.width,M=gf(z,F),ie={"ss:Index":z+1};K&&(ie["ss:Width"]=e0(M.width)),F.hidden&&(ie["ss:Hidden"]="1"),p.push(qe("Column",null,ie))});for(var g=Array.isArray(e),h=s.s.r;h<=s.e.r;++h){for(var E=[n6(h,(e["!rows"]||[])[h])],A=s.s.c;A<=s.e.c;++A){var _=!1;for(f=0;f!=c.length;++f)if(!(c[f].s.c>A)&&!(c[f].s.r>h)&&!(c[f].e.c<A)&&!(c[f].e.r<h)){(c[f].s.c!=A||c[f].s.r!=h)&&(_=!0);break}if(!_){var w={r:h,c:A},N=bt(w),k=g?(e[h]||[])[A]:e[N];E.push(r6(k,N,e,a,t,i,w))}}E.push("</Row>"),E.length>2&&p.push(E.join(""))}return p.join("")}function s6(e,a,t){var i=[],s=t.SheetNames[e],c=t.Sheets[s],f=c?e6(c,a,e,t):"";return f.length>0&&i.push("<Names>"+f+"</Names>"),f=c?i6(c,a,e,t):"",f.length>0&&i.push("<Table>"+f+"</Table>"),i.push(t6(c,a,e,t)),i.join("")}function l6(e,a){a||(a={}),e.SSF||(e.SSF=wa(mt)),e.SSF&&(Uo(),of(e.SSF),a.revssf=df(e.SSF),a.revssf[e.SSF[65535]]=0,a.ssf=e.SSF,a.cellXfs=[],al(a.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(Kw(e,a)),t.push(Qw()),t.push(""),t.push("");for(var i=0;i<e.SheetNames.length;++i)t.push(qe("Worksheet",s6(i,a,e),{"ss:Name":fa(e.SheetNames[i])}));return t[2]=Jw(e,a),t[3]=Zw(e),qa+qe("Workbook",t.join(""),{xmlns:An.ss,"xmlns:o":An.o,"xmlns:x":An.x,"xmlns:ss":An.ss,"xmlns:dt":An.dt,"xmlns:html":An.html})}function o6(e){var a={},t=e.content;if(t.l=28,a.AnsiUserType=t.read_shift(0,"lpstr-ansi"),a.AnsiClipboardFormat=ZS(t),t.length-t.l<=4)return a;var i=t.read_shift(4);if(i==0||i>40||(t.l-=4,a.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(i=t.read_shift(4),i!==1907505652)||(a.UnicodeClipboardFormat=eE(t),i=t.read_shift(4),i==0||i>40))return a;t.l-=4,a.Reserved2=t.read_shift(0,"lpwstr")}var c6=[60,1084,2066,2165,2175];function d6(e,a,t,i,s){var c=i,f=[],p=t.slice(t.l,t.l+c);if(s&&s.enc&&s.enc.insitu&&p.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(p)}f.push(p),t.l+=c;for(var g=ts(t,t.l),h=Up[g],E=0;h!=null&&c6.indexOf(g)>-1;)c=ts(t,t.l+2),E=t.l+4,g==2066?E+=4:(g==2165||g==2175)&&(E+=12),p=t.slice(E,t.l+4+c),f.push(p),t.l+=4+c,h=Up[g=ts(t,t.l)];var A=yr(f);kr(A,0);var _=0;A.lens=[];for(var w=0;w<f.length;++w)A.lens.push(_),_+=f[w].length;if(A.length<i)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+A.length+" < "+i;return a.f(A,A.length,s)}function ki(e,a,t){if(e.t!=="z"&&e.XF){var i=0;try{i=e.z||e.XF.numFmtId||0,a.cellNF&&(e.z=mt[i])}catch(c){if(a.WTF)throw c}if(!a||a.cellText!==!1)try{e.t==="e"?e.w=e.w||os[e.v]:i===0||i=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Xc(e.v):e.w=Ll(e.v):e.w=qn(i,e.v,{date1904:!!t,dateNF:a&&a.dateNF})}catch(c){if(a.WTF)throw c}if(a.cellDates&&i&&e.t=="n"&&zo(mt[i]||String(i))){var s=jl(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Yd(e,a,t){return{v:e,ixfe:a,t}}function f6(e,a){var t={opts:{}},i={},s=a.dense?[]:{},c={},f={},p=null,g=[],h="",E={},A,_="",w,N,k,F,z={},K=[],M,ie,se=[],ne=[],H={Sheets:[],WBProps:{date1904:!1},Views:[{}]},le={},oe=function(yt){return yt<8?Ol[yt]:yt<64&&ne[yt-8]||Ol[yt]},m=function(yt,ma,Nr){var ia=ma.XF.data;if(!(!ia||!ia.patternType||!Nr||!Nr.cellStyles)){ma.s={},ma.s.patternType=ia.patternType;var Ot;(Ot=Zc(oe(ia.icvFore)))&&(ma.s.fgColor={rgb:Ot}),(Ot=Zc(oe(ia.icvBack)))&&(ma.s.bgColor={rgb:Ot})}},Se=function(yt,ma,Nr){if(!(ee>1)&&!(Nr.sheetRows&&yt.r>=Nr.sheetRows)){if(Nr.cellStyles&&ma.XF&&ma.XF.data&&m(yt,ma,Nr),delete ma.ixfe,delete ma.XF,A=yt,_=bt(yt),(!f||!f.s||!f.e)&&(f={s:{r:0,c:0},e:{r:0,c:0}}),yt.r<f.s.r&&(f.s.r=yt.r),yt.c<f.s.c&&(f.s.c=yt.c),yt.r+1>f.e.r&&(f.e.r=yt.r+1),yt.c+1>f.e.c&&(f.e.c=yt.c+1),Nr.cellFormula&&ma.f){for(var ia=0;ia<K.length;++ia)if(!(K[ia][0].s.c>yt.c||K[ia][0].s.r>yt.r)&&!(K[ia][0].e.c<yt.c||K[ia][0].e.r<yt.r)){ma.F=wt(K[ia][0]),(K[ia][0].s.c!=yt.c||K[ia][0].s.r!=yt.r)&&delete ma.f,ma.f&&(ma.f=""+Lr(K[ia][1],f,yt,fe,ue));break}}Nr.dense?(s[yt.r]||(s[yt.r]=[]),s[yt.r][yt.c]=ma):s[_]=ma}},ue={enc:!1,sbcch:0,snames:[],sharedf:z,arrayf:K,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!a&&!!a.cellStyles,WTF:!!a&&!!a.wtf};a.password&&(ue.password=a.password);var Pe,et=[],ke=[],de=[],Ce=[],Je=!1,fe=[];fe.SheetNames=ue.snames,fe.sharedf=ue.sharedf,fe.arrayf=ue.arrayf,fe.names=[],fe.XTI=[];var Ke=0,ee=0,I=0,L=[],Q=[],te;ue.codepage=1200,hi(1200);for(var ge=!1;e.l<e.length-1;){var je=e.l,ze=e.read_shift(2);if(ze===0&&Ke===10)break;var Oe=e.l===e.length?0:e.read_shift(2),Ue=Up[ze];if(Ue&&Ue.f){if(a.bookSheets&&Ke===133&&ze!==133)break;if(Ke=ze,Ue.r===2||Ue.r==12){var St=e.read_shift(2);if(Oe-=2,!ue.enc&&St!==ze&&((St&255)<<8|St>>8)!==ze)throw new Error("rt mismatch: "+St+"!="+ze);Ue.r==12&&(e.l+=10,Oe-=10)}var Z={};if(ze===10?Z=Ue.f(e,Oe,ue):Z=d6(ze,Ue,e,Oe,ue),ee==0&&[9,521,1033,2057].indexOf(Ke)===-1)continue;switch(ze){case 34:t.opts.Date1904=H.WBProps.date1904=Z;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(ue.enc||(e.l=0),ue.enc=Z,!a.password)throw new Error("File is password-protected");if(Z.valid==null)throw new Error("Encryption scheme unsupported");if(!Z.valid)throw new Error("Password is incorrect");break;case 92:ue.lastuser=Z;break;case 66:var Jt=Number(Z);switch(Jt){case 21010:Jt=1200;break;case 32768:Jt=1e4;break;case 32769:Jt=1252;break}hi(ue.codepage=Jt),ge=!0;break;case 317:ue.rrtabid=Z;break;case 25:ue.winlocked=Z;break;case 439:t.opts.RefreshAll=Z;break;case 12:t.opts.CalcCount=Z;break;case 16:t.opts.CalcDelta=Z;break;case 17:t.opts.CalcIter=Z;break;case 13:t.opts.CalcMode=Z;break;case 14:t.opts.CalcPrecision=Z;break;case 95:t.opts.CalcSaveRecalc=Z;break;case 15:ue.CalcRefMode=Z;break;case 2211:t.opts.FullCalc=Z;break;case 129:Z.fDialog&&(s["!type"]="dialog"),Z.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),Z.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:se.push(Z);break;case 430:fe.push([Z]),fe[fe.length-1].XTI=[];break;case 35:case 547:fe[fe.length-1].push(Z);break;case 24:case 536:te={Name:Z.Name,Ref:Lr(Z.rgce,f,null,fe,ue)},Z.itab>0&&(te.Sheet=Z.itab-1),fe.names.push(te),fe[0]||(fe[0]=[],fe[0].XTI=[]),fe[fe.length-1].push(Z),Z.Name=="_xlnm._FilterDatabase"&&Z.itab>0&&Z.rgce&&Z.rgce[0]&&Z.rgce[0][0]&&Z.rgce[0][0][0]=="PtgArea3d"&&(Q[Z.itab-1]={ref:wt(Z.rgce[0][0][1][2])});break;case 22:ue.ExternCount=Z;break;case 23:fe.length==0&&(fe[0]=[],fe[0].XTI=[]),fe[fe.length-1].XTI=fe[fe.length-1].XTI.concat(Z),fe.XTI=fe.XTI.concat(Z);break;case 2196:if(ue.biff<8)break;te!=null&&(te.Comment=Z[1]);break;case 18:s["!protect"]=Z;break;case 19:Z!==0&&ue.WTF&&console.error("Password verifier: "+Z);break;case 133:c[Z.pos]=Z,ue.snames.push(Z.name);break;case 10:{if(--ee)break;if(f.e){if(f.e.r>0&&f.e.c>0){if(f.e.r--,f.e.c--,s["!ref"]=wt(f),a.sheetRows&&a.sheetRows<=f.e.r){var At=f.e.r;f.e.r=a.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=wt(f),f.e.r=At}f.e.r++,f.e.c++}et.length>0&&(s["!merges"]=et),ke.length>0&&(s["!objects"]=ke),de.length>0&&(s["!cols"]=de),Ce.length>0&&(s["!rows"]=Ce),H.Sheets.push(le)}h===""?E=s:i[h]=s,s=a.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(ue.biff===8&&(ue.biff={9:2,521:3,1033:4}[ze]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Z.BIFFVer]||8),ue.biffguess=Z.BIFFVer==0,Z.BIFFVer==0&&Z.dt==4096&&(ue.biff=5,ge=!0,hi(ue.codepage=28591)),ue.biff==8&&Z.BIFFVer==0&&Z.dt==16&&(ue.biff=2),ee++)break;if(s=a.dense?[]:{},ue.biff<8&&!ge&&(ge=!0,hi(ue.codepage=a.codepage||1252)),ue.biff<5||Z.BIFFVer==0&&Z.dt==4096){h===""&&(h="Sheet1"),f={s:{r:0,c:0},e:{r:0,c:0}};var Gt={pos:e.l-Oe,name:h};c[Gt.pos]=Gt,ue.snames.push(h)}else h=(c[je]||{name:""}).name;Z.dt==32&&(s["!type"]="chart"),Z.dt==64&&(s["!type"]="macro"),et=[],ke=[],ue.arrayf=K=[],de=[],Ce=[],Je=!1,le={Hidden:(c[je]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(a.dense?(s[Z.r]||[])[Z.c]:s[bt({c:Z.c,r:Z.r})])&&++Z.c,M={ixfe:Z.ixfe,XF:se[Z.ixfe]||{},v:Z.val,t:"n"},I>0&&(M.z=L[M.ixfe>>8&63]),ki(M,a,t.opts.Date1904),Se({c:Z.c,r:Z.r},M,a);break;case 5:case 517:M={ixfe:Z.ixfe,XF:se[Z.ixfe],v:Z.val,t:Z.t},I>0&&(M.z=L[M.ixfe>>8&63]),ki(M,a,t.opts.Date1904),Se({c:Z.c,r:Z.r},M,a);break;case 638:M={ixfe:Z.ixfe,XF:se[Z.ixfe],v:Z.rknum,t:"n"},I>0&&(M.z=L[M.ixfe>>8&63]),ki(M,a,t.opts.Date1904),Se({c:Z.c,r:Z.r},M,a);break;case 189:for(var Ct=Z.c;Ct<=Z.C;++Ct){var at=Z.rkrec[Ct-Z.c][0];M={ixfe:at,XF:se[at],v:Z.rkrec[Ct-Z.c][1],t:"n"},I>0&&(M.z=L[M.ixfe>>8&63]),ki(M,a,t.opts.Date1904),Se({c:Ct,r:Z.r},M,a)}break;case 6:case 518:case 1030:{if(Z.val=="String"){p=Z;break}if(M=Yd(Z.val,Z.cell.ixfe,Z.tt),M.XF=se[M.ixfe],a.cellFormula){var Ta=Z.formula;if(Ta&&Ta[0]&&Ta[0][0]&&Ta[0][0][0]=="PtgExp"){var Ia=Ta[0][0][1][0],nr=Ta[0][0][1][1],Yr=bt({r:Ia,c:nr});z[Yr]?M.f=""+Lr(Z.formula,f,Z.cell,fe,ue):M.F=((a.dense?(s[Ia]||[])[nr]:s[Yr])||{}).F}else M.f=""+Lr(Z.formula,f,Z.cell,fe,ue)}I>0&&(M.z=L[M.ixfe>>8&63]),ki(M,a,t.opts.Date1904),Se(Z.cell,M,a),p=Z}break;case 7:case 519:if(p)p.val=Z,M=Yd(Z,p.cell.ixfe,"s"),M.XF=se[M.ixfe],a.cellFormula&&(M.f=""+Lr(p.formula,f,p.cell,fe,ue)),I>0&&(M.z=L[M.ixfe>>8&63]),ki(M,a,t.opts.Date1904),Se(p.cell,M,a),p=null;else throw new Error("String record expects Formula");break;case 33:case 545:{K.push(Z);var Rn=bt(Z[0].s);if(w=a.dense?(s[Z[0].s.r]||[])[Z[0].s.c]:s[Rn],a.cellFormula&&w){if(!p||!Rn||!w)break;w.f=""+Lr(Z[1],f,Z[0],fe,ue),w.F=wt(Z[0])}}break;case 1212:{if(!a.cellFormula)break;if(_){if(!p)break;z[bt(p.cell)]=Z[0],w=a.dense?(s[p.cell.r]||[])[p.cell.c]:s[bt(p.cell)],(w||{}).f=""+Lr(Z[0],f,A,fe,ue)}}break;case 253:M=Yd(g[Z.isst].t,Z.ixfe,"s"),g[Z.isst].h&&(M.h=g[Z.isst].h),M.XF=se[M.ixfe],I>0&&(M.z=L[M.ixfe>>8&63]),ki(M,a,t.opts.Date1904),Se({c:Z.c,r:Z.r},M,a);break;case 513:a.sheetStubs&&(M={ixfe:Z.ixfe,XF:se[Z.ixfe],t:"z"},I>0&&(M.z=L[M.ixfe>>8&63]),ki(M,a,t.opts.Date1904),Se({c:Z.c,r:Z.r},M,a));break;case 190:if(a.sheetStubs)for(var Rr=Z.c;Rr<=Z.C;++Rr){var Wt=Z.ixfe[Rr-Z.c];M={ixfe:Wt,XF:se[Wt],t:"z"},I>0&&(M.z=L[M.ixfe>>8&63]),ki(M,a,t.opts.Date1904),Se({c:Rr,r:Z.r},M,a)}break;case 214:case 516:case 4:M=Yd(Z.val,Z.ixfe,"s"),M.XF=se[M.ixfe],I>0&&(M.z=L[M.ixfe>>8&63]),ki(M,a,t.opts.Date1904),Se({c:Z.c,r:Z.r},M,a);break;case 0:case 512:ee===1&&(f=Z);break;case 252:g=Z;break;case 1054:if(ue.biff==4){L[I++]=Z[1];for(var br=0;br<I+163&&mt[br]!=Z[1];++br);br>=163&&rs(Z[1],I+163)}else rs(Z[1],Z[0]);break;case 30:{L[I++]=Z;for(var Sr=0;Sr<I+163&&mt[Sr]!=Z;++Sr);Sr>=163&&rs(Z,I+163)}break;case 229:et=et.concat(Z);break;case 93:ke[Z.cmo[0]]=ue.lastobj=Z;break;case 438:ue.lastobj.TxO=Z;break;case 127:ue.lastobj.ImData=Z;break;case 440:for(F=Z[0].s.r;F<=Z[0].e.r;++F)for(k=Z[0].s.c;k<=Z[0].e.c;++k)w=a.dense?(s[F]||[])[k]:s[bt({c:k,r:F})],w&&(w.l=Z[1]);break;case 2048:for(F=Z[0].s.r;F<=Z[0].e.r;++F)for(k=Z[0].s.c;k<=Z[0].e.c;++k)w=a.dense?(s[F]||[])[k]:s[bt({c:k,r:F})],w&&w.l&&(w.l.Tooltip=Z[1]);break;case 28:{if(ue.biff<=5&&ue.biff>=2)break;w=a.dense?(s[Z[0].r]||[])[Z[0].c]:s[bt(Z[0])];var Qr=ke[Z[2]];w||(a.dense?(s[Z[0].r]||(s[Z[0].r]=[]),w=s[Z[0].r][Z[0].c]={t:"z"}):w=s[bt(Z[0])]={t:"z"},f.e.r=Math.max(f.e.r,Z[0].r),f.s.r=Math.min(f.s.r,Z[0].r),f.e.c=Math.max(f.e.c,Z[0].c),f.s.c=Math.min(f.s.c,Z[0].c)),w.c||(w.c=[]),N={a:Z[1],t:Qr.TxO.t},w.c.push(N)}break;case 2173:J_(se[Z.ixfe],Z.ext);break;case 125:{if(!ue.cellStyles)break;for(;Z.e>=Z.s;)de[Z.e--]={width:Z.w/256,level:Z.level||0,hidden:!!(Z.flags&1)},Je||(Je=!0,xh(Z.w/256)),Qs(de[Z.e+1])}break;case 520:{var Ea={};Z.level!=null&&(Ce[Z.r]=Ea,Ea.level=Z.level),Z.hidden&&(Ce[Z.r]=Ea,Ea.hidden=!0),Z.hpt&&(Ce[Z.r]=Ea,Ea.hpt=Z.hpt,Ea.hpx=Po(Z.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Ml(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ze]]=Z;break;case 161:s["!margins"]||Ml(s["!margins"]={}),s["!margins"].header=Z.header,s["!margins"].footer=Z.footer;break;case 574:Z.RTL&&(H.Views[0].RTL=!0);break;case 146:ne=Z;break;case 2198:Pe=Z;break;case 140:ie=Z;break;case 442:h?le.CodeName=Z||le.name:H.WBProps.CodeName=Z||"ThisWorkbook";break}}else Ue||console.error("Missing Info for XLS Record 0x"+ze.toString(16)),e.l+=Oe}return t.SheetNames=Ua(c).sort(function(Dt,yt){return Number(Dt)-Number(yt)}).map(function(Dt){return c[Dt].name}),a.bookSheets||(t.Sheets=i),!t.SheetNames.length&&E["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=E)):t.Preamble=E,t.Sheets&&Q.forEach(function(Dt,yt){t.Sheets[t.SheetNames[yt]]["!autofilter"]=Dt}),t.Strings=g,t.SSF=wa(mt),ue.enc&&(t.Encryption=ue.enc),Pe&&(t.Themes=Pe),t.Metadata={},ie!==void 0&&(t.Metadata.Country=ie),fe.names.length>0&&(H.Names=fe.names),t.Workbook=H,t}var Gc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function u6(e,a,t){var i=ht.find(e,"/!DocumentSummaryInformation");if(i&&i.size>0)try{var s=gm(i,Op,Gc.DSI);for(var c in s)a[c]=s[c]}catch(h){if(t.WTF)throw h}var f=ht.find(e,"/!SummaryInformation");if(f&&f.size>0)try{var p=gm(f,Ip,Gc.SI);for(var g in p)a[g]==null&&(a[g]=p[g])}catch(h){if(t.WTF)throw h}a.HeadingPairs&&a.TitlesOfParts&&(zy(a.HeadingPairs,a.TitlesOfParts,a,t),delete a.HeadingPairs,delete a.TitlesOfParts)}function p6(e,a){var t=[],i=[],s=[],c=0,f,p=Gx(Op,"n"),g=Gx(Ip,"n");if(e.Props)for(f=Ua(e.Props),c=0;c<f.length;++c)(Object.prototype.hasOwnProperty.call(p,f[c])?t:Object.prototype.hasOwnProperty.call(g,f[c])?i:s).push([f[c],e.Props[f[c]]]);if(e.Custprops)for(f=Ua(e.Custprops),c=0;c<f.length;++c)Object.prototype.hasOwnProperty.call(e.Props||{},f[c])||(Object.prototype.hasOwnProperty.call(p,f[c])?t:Object.prototype.hasOwnProperty.call(g,f[c])?i:s).push([f[c],e.Custprops[f[c]]]);var h=[];for(c=0;c<s.length;++c)Vy.indexOf(s[c][0])>-1||Py.indexOf(s[c][0])>-1||s[c][1]!=null&&h.push(s[c]);i.length&&ht.utils.cfb_add(a,"/SummaryInformation",xm(i,Gc.SI,g,Ip)),(t.length||h.length)&&ht.utils.cfb_add(a,"/DocumentSummaryInformation",xm(t,Gc.DSI,p,Op,h.length?h:null,Gc.UDI))}function Hv(e,a){a||(a={}),_h(a),Wp(),a.codepage&&Gp(a.codepage);var t,i;if(e.FullPaths){if(ht.find(e,"/encryption"))throw new Error("File is password-protected");t=ht.find(e,"!CompObj"),i=ht.find(e,"/Workbook")||ht.find(e,"/Book")}else{switch(a.type){case"base64":e=Cn(wn(e));break;case"binary":e=Cn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}kr(e,0),i={content:e}}var s,c;if(t&&o6(t),a.bookProps&&!a.bookSheets)s={};else{var f=It?"buffer":"array";if(i&&i.content)s=f6(i.content,a);else if((c=ht.find(e,"PerfectOffice_MAIN"))&&c.content)s=Bl.to_workbook(c.content,(a.type=f,a));else if((c=ht.find(e,"NativeContent_MAIN"))&&c.content)s=Bl.to_workbook(c.content,(a.type=f,a));else throw(c=ht.find(e,"MN0"))&&c.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");a.bookVBA&&e.FullPaths&&ht.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=C4(e))}var p={};return e.FullPaths&&u6(e,p,a),s.Props=s.Custprops=p,a.bookFiles&&(s.cfb=e),s}function h6(e,a){var t=a||{},i=ht.utils.cfb_new({root:"R"}),s="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":s="/Workbook",t.biff=8;break;case"biff5":s="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return ht.utils.cfb_add(i,s,$v(e,t)),t.biff==8&&(e.Props||e.Custprops)&&p6(e,i),t.biff==8&&e.vbaraw&&k4(i,ht.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),i}var r0={0:{f:LC},1:{f:WC},2:{f:fk},3:{f:ek},4:{f:KC},5:{f:ok},6:{f:xk},7:{f:nk},8:{f:Tk},9:{f:Ek},10:{f:bk},11:{f:Sk},12:{f:XC},13:{f:pk},14:{f:ak},15:{f:JC},16:{f:Ov},17:{f:yk},18:{f:sk},19:{f:sh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:yw},40:{},42:{},43:{f:x_},44:{f:h_},45:{f:v_},46:{f:S_},47:{f:b_},48:{},49:{f:US},50:{},51:{f:t4},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:nv},62:{f:gk},63:{f:d4},64:{f:Pk},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Hr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Ik},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:YC},148:{f:UC,p:16},151:{f:Rk},152:{},153:{f:gw},154:{},155:{},156:{f:pw},157:{},158:{},159:{T:1,f:FA},160:{T:-1},161:{T:1,f:Xl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Ak},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Z_},336:{T:-1},337:{f:n4,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:jp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:rv},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Nk},427:{f:Fk},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:jk},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:$C},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:kk},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:jp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:S4},633:{T:1},634:{T:-1},635:{T:1,f:v4},636:{T:-1},637:{f:GS},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:aw},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:zk},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Up={6:{f:Ap},10:{f:Vs},12:{f:rr},13:{f:rr},14:{f:Va},15:{f:Va},16:{f:zr},17:{f:Va},18:{f:Va},19:{f:rr},20:{f:Em},21:{f:Em},23:{f:rv},24:{f:Am},25:{f:Va},26:{},27:{},28:{f:zT},29:{},34:{f:Va},35:{f:Tm},38:{f:zr},39:{f:zr},40:{f:zr},41:{f:zr},42:{f:Va},43:{f:Va},47:{f:JA},49:{f:pT},51:{f:rr},60:{},61:{f:oT},64:{f:Va},65:{f:uT},66:{f:rr},77:{},80:{},81:{},82:{},85:{f:rr},89:{},90:{},91:{},92:{f:QE},93:{f:$T},94:{},95:{f:Va},96:{},97:{},99:{f:Va},125:{f:nv},128:{f:wT},129:{f:ZE},130:{f:rr},131:{f:Va},132:{f:Va},133:{f:eT},134:{},140:{f:QT},141:{f:rr},144:{},146:{f:eA},151:{},152:{},153:{},154:{},155:{},156:{f:rr},157:{},158:{},160:{f:lA},161:{f:rA},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:AT},190:{f:_T},193:{f:Vs},197:{},198:{},199:{},200:{},201:{},202:{f:Va},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:rr},220:{},221:{f:Va},222:{},224:{f:kT},225:{f:KE},226:{f:Vs},227:{},229:{f:UT},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:aT},253:{f:gT},255:{f:nT},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Xy},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Va},353:{f:Vs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:jT},431:{f:Va},432:{},433:{},434:{},437:{},438:{f:WT},439:{f:Va},440:{f:VT},441:{},442:{f:c0},443:{},444:{f:rr},445:{},446:{},448:{f:Vs},449:{f:lT,r:2},450:{f:Vs},512:{f:vm},513:{f:sA},515:{f:FT},516:{f:mT},517:{f:Sm},519:{f:oA},520:{f:iT},523:{},545:{f:_m},549:{f:ym},566:{},574:{f:dT},638:{f:TT},659:{},1048:{},1054:{f:vT},1084:{},1212:{f:MT},2048:{f:qT},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ud},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Vs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:tA,r:12},2173:{f:Q_,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Va,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:BT,r:12},2197:{},2198:{f:G_,r:12},2199:{},2200:{},2201:{},2202:{f:LT,r:12},2203:{f:Vs},2204:{},2205:{},2206:{},2207:{},2211:{f:sT},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:rr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:nA},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:ZT},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:vm},1:{},2:{f:pA},3:{f:fA},4:{f:dA},5:{f:Sm},7:{f:gA},8:{},9:{f:Ud},11:{},22:{f:rr},30:{f:ST},31:{},32:{},33:{f:_m},36:{},37:{f:ym},50:{f:xA},62:{},52:{},67:{},68:{f:rr},69:{},86:{},126:{},127:{f:cA},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:mA},223:{},234:{},354:{},421:{},518:{f:Ap},521:{f:Ud},536:{f:Am},547:{f:Tm},561:{},579:{},1030:{f:Ap},1033:{f:Ud},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Qe(e,a,t,i){var s=a;if(!isNaN(s)){var c=i||(t||[]).length||0,f=e.next(4);f.write_shift(2,s),f.write_shift(2,c),c>0&&rh(t)&&e.push(t)}}function g6(e,a,t,i){var s=(t||[]).length||0;if(s<=8224)return Qe(e,a,t,s);var c=a;if(!isNaN(c)){for(var f=t.parts||[],p=0,g=0,h=0;h+(f[p]||8224)<=8224;)h+=f[p]||8224,p++;var E=e.next(4);for(E.write_shift(2,c),E.write_shift(2,h),e.push(t.slice(g,g+h)),g+=h;g<s;){for(E=e.next(4),E.write_shift(2,60),h=0;h+(f[p]||8224)<=8224;)h+=f[p]||8224,p++;E.write_shift(2,h),e.push(t.slice(g,g+h)),g+=h}}}function p0(e,a,t){return e||(e=Ne(7)),e.write_shift(2,a),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function x6(e,a,t,i){var s=Ne(9);return p0(s,e,a),qy(t,i||"b",s),s}function m6(e,a,t){var i=Ne(8+2*t.length);return p0(i,e,a),i.write_shift(1,t.length),i.write_shift(t.length,t,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function y6(e,a,t,i){if(a.v!=null)switch(a.t){case"d":case"n":var s=a.t=="d"?fr(ka(a.v)):a.v;s==(s|0)&&s>=0&&s<65536?Qe(e,2,hA(t,i,s)):Qe(e,3,uA(t,i,s));return;case"b":case"e":Qe(e,5,x6(t,i,a.v,a.t));return;case"s":case"str":Qe(e,4,m6(t,i,(a.v||"").slice(0,255)));return}Qe(e,1,p0(null,t,i))}function v6(e,a,t,i){var s=Array.isArray(a),c=Qt(a["!ref"]||"A1"),f,p="",g=[];if(c.e.c>255||c.e.r>16383){if(i.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");c.e.c=Math.min(c.e.c,255),c.e.r=Math.min(c.e.c,16383),f=wt(c)}for(var h=c.s.r;h<=c.e.r;++h){p=Xa(h);for(var E=c.s.c;E<=c.e.c;++E){h===c.s.r&&(g[E]=ja(E)),f=g[E]+p;var A=s?(a[h]||[])[E]:a[f];A&&y6(e,A,h,E)}}}function b6(e,a){for(var t=a||{},i=fn(),s=0,c=0;c<e.SheetNames.length;++c)e.SheetNames[c]==t.sheet&&(s=c);if(s==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Qe(i,t.biff==4?1033:t.biff==3?521:9,ph(e,16,t)),v6(i,e.Sheets[e.SheetNames[s]],s,t),Qe(i,10),i.end()}function S6(e,a,t){Qe(e,49,hT({sz:12,name:"Arial"},t))}function E6(e,a,t){a&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)a[s]!=null&&Qe(e,1054,bT(s,a[s],t))})}function T6(e,a){var t=Ne(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Qe(e,2151,t),t=Ne(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),ev(Qt(a["!ref"]||"A1"),t),t.write_shift(4,4),Qe(e,2152,t)}function A6(e,a){for(var t=0;t<16;++t)Qe(e,224,bm({numFmtId:0,style:!0},0,a));a.cellXfs.forEach(function(i){Qe(e,224,bm(i,0,a))})}function _6(e,a){for(var t=0;t<a["!links"].length;++t){var i=a["!links"][t];Qe(e,440,XT(i)),i[1].Tooltip&&Qe(e,2048,KT(i))}delete a["!links"]}function C6(e,a){if(a){var t=0;a.forEach(function(i,s){++t<=256&&i&&Qe(e,125,aA(gf(s,i),s))})}}function k6(e,a,t,i,s){var c=16+al(s.cellXfs,a,s);if(a.v==null&&!a.bf){Qe(e,513,Hl(t,i,c));return}if(a.bf)Qe(e,6,Z3(a,t,i,s,c));else switch(a.t){case"d":case"n":var f=a.t=="d"?fr(ka(a.v)):a.v;Qe(e,515,DT(t,i,f,c));break;case"b":case"e":Qe(e,517,NT(t,i,a.v,c,s,a.t));break;case"s":case"str":if(s.bookSST){var p=Sh(s.Strings,a.v,s.revStrings);Qe(e,253,xT(t,i,p,c))}else Qe(e,516,yT(t,i,(a.v||"").slice(0,255),c,s));break;default:Qe(e,513,Hl(t,i,c))}}function w6(e,a,t){var i=fn(),s=t.SheetNames[e],c=t.Sheets[s]||{},f=(t||{}).Workbook||{},p=(f.Sheets||[])[e]||{},g=Array.isArray(c),h=a.biff==8,E,A="",_=[],w=Qt(c["!ref"]||"A1"),N=h?65536:16384;if(w.e.c>255||w.e.r>=N){if(a.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:IV16384");w.e.c=Math.min(w.e.c,255),w.e.r=Math.min(w.e.c,N-1)}Qe(i,2057,ph(t,16,a)),Qe(i,13,Vn(1)),Qe(i,12,Vn(100)),Qe(i,15,qr(!0)),Qe(i,17,qr(!1)),Qe(i,16,zl(.001)),Qe(i,95,qr(!0)),Qe(i,42,qr(!1)),Qe(i,43,qr(!1)),Qe(i,130,Vn(1)),Qe(i,128,RT()),Qe(i,131,qr(!1)),Qe(i,132,qr(!1)),h&&C6(i,c["!cols"]),Qe(i,512,ET(w,a)),h&&(c["!links"]=[]);for(var k=w.s.r;k<=w.e.r;++k){A=Xa(k);for(var F=w.s.c;F<=w.e.c;++F){k===w.s.r&&(_[F]=ja(F)),E=_[F]+A;var z=g?(c[k]||[])[F]:c[E];z&&(k6(i,z,k,F,a),h&&z.l&&c["!links"].push([E,z.l]))}}var K=p.CodeName||p.name||s;return h&&Qe(i,574,fT((f.Views||[])[0])),h&&(c["!merges"]||[]).length&&Qe(i,229,HT(c["!merges"])),h&&_6(i,c),Qe(i,442,Ky(K)),h&&T6(i,c),Qe(i,10),i.end()}function R6(e,a,t){var i=fn(),s=(e||{}).Workbook||{},c=s.Sheets||[],f=s.WBProps||{},p=t.biff==8,g=t.biff==5;if(Qe(i,2057,ph(e,5,t)),t.bookType=="xla"&&Qe(i,135),Qe(i,225,p?Vn(1200):null),Qe(i,193,NE(2)),g&&Qe(i,191),g&&Qe(i,192),Qe(i,226),Qe(i,92,JE("SheetJS",t)),Qe(i,66,Vn(p?1200:1252)),p&&Qe(i,353,Vn(0)),p&&Qe(i,448),Qe(i,317,iA(e.SheetNames.length)),p&&e.vbaraw&&Qe(i,211),p&&e.vbaraw){var h=f.CodeName||"ThisWorkbook";Qe(i,442,Ky(h))}Qe(i,156,Vn(17)),Qe(i,25,qr(!1)),Qe(i,18,qr(!1)),Qe(i,19,Vn(0)),p&&Qe(i,431,qr(!1)),p&&Qe(i,444,Vn(0)),Qe(i,61,cT()),Qe(i,64,qr(!1)),Qe(i,141,Vn(0)),Qe(i,34,qr(lw(e)=="true")),Qe(i,14,qr(!0)),p&&Qe(i,439,qr(!1)),Qe(i,218,Vn(0)),S6(i,e,t),E6(i,e.SSF,t),A6(i,t),p&&Qe(i,352,qr(!1));var E=i.end(),A=fn();p&&Qe(A,140,JT()),p&&t.Strings&&g6(A,252,rT(t.Strings)),Qe(A,10);var _=A.end(),w=fn(),N=0,k=0;for(k=0;k<e.SheetNames.length;++k)N+=(p?12:11)+(p?2:1)*e.SheetNames[k].length;var F=E.length+N+_.length;for(k=0;k<e.SheetNames.length;++k){var z=c[k]||{};Qe(w,133,tT({pos:F,hs:z.Hidden||0,dt:0,name:e.SheetNames[k]},t)),F+=a[k].length}var K=w.end();if(N!=K.length)throw new Error("BS8 "+N+" != "+K.length);var M=[];return E.length&&M.push(E),K.length&&M.push(K),_.length&&M.push(_),yr(M)}function N6(e,a){var t=a||{},i=[];e&&!e.SSF&&(e.SSF=wa(mt)),e&&e.SSF&&(Uo(),of(e.SSF),t.revssf=df(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ch(t),t.cellXfs=[],al(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)i[i.length]=w6(s,t,e);return i.unshift(R6(e,i,t)),yr(i)}function $v(e,a){for(var t=0;t<=e.SheetNames.length;++t){var i=e.Sheets[e.SheetNames[t]];if(!(!i||!i["!ref"])){var s=un(i["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var c=a||{};switch(c.biff||2){case 8:case 5:return N6(e,a);case 4:case 3:case 2:return b6(e,a)}throw new Error("invalid type "+c.bookType+" for BIFF")}function Im(e,a){var t=a||{},i=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var c=e.match(/<\/table/i),f=s.index,p=c&&c.index||e.length,g=hS(e.slice(f,p),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,E=0,A=0,_=0,w={s:{r:1e7,c:1e7},e:{r:0,c:0}},N=[];for(f=0;f<g.length;++f){var k=g[f].trim(),F=k.slice(0,3).toLowerCase();if(F=="<tr"){if(++h,t.sheetRows&&t.sheetRows<=h){--h;break}E=0;continue}if(!(F!="<td"&&F!="<th")){var z=k.split(/<\/t[dh]>/i);for(p=0;p<z.length;++p){var K=z[p].trim();if(K.match(/<t[dh]/i)){for(var M=K,ie=0;M.charAt(0)=="<"&&(ie=M.indexOf(">"))>-1;)M=M.slice(ie+1);for(var se=0;se<N.length;++se){var ne=N[se];ne.s.c==E&&ne.s.r<h&&h<=ne.e.r&&(E=ne.e.c+1,se=-1)}var H=Et(K.slice(0,K.indexOf(">")));_=H.colspan?+H.colspan:1,((A=+H.rowspan)>1||_>1)&&N.push({s:{r:h,c:E},e:{r:h+(A||1)-1,c:E+_-1}});var le=H.t||H["data-t"]||"";if(!M.length){E+=_;continue}if(M=py(M),w.s.r>h&&(w.s.r=h),w.e.r<h&&(w.e.r=h),w.s.c>E&&(w.s.c=E),w.e.c<E&&(w.e.c=E),!M.length){E+=_;continue}var oe={t:"s",v:M};t.raw||!M.trim().length||le=="s"||(M==="TRUE"?oe={t:"b",v:!0}:M==="FALSE"?oe={t:"b",v:!1}:isNaN(xi(M))?isNaN(Mo(M).getDate())||(oe={t:"d",v:ka(M)},t.cellDates||(oe={t:"n",v:fr(oe.v)}),oe.z=t.dateNF||mt[14]):oe={t:"n",v:xi(M)}),t.dense?(i[h]||(i[h]=[]),i[h][E]=oe):i[bt({r:h,c:E})]=oe,E+=_}}}}return i["!ref"]=wt(w),N.length&&(i["!merges"]=N),i}function F6(e,a,t,i){for(var s=e["!merges"]||[],c=[],f=a.s.c;f<=a.e.c;++f){for(var p=0,g=0,h=0;h<s.length;++h)if(!(s[h].s.r>t||s[h].s.c>f)&&!(s[h].e.r<t||s[h].e.c<f)){if(s[h].s.r<t||s[h].s.c<f){p=-1;break}p=s[h].e.r-s[h].s.r+1,g=s[h].e.c-s[h].s.c+1;break}if(!(p<0)){var E=bt({r:t,c:f}),A=i.dense?(e[t]||[])[f]:e[E],_=A&&A.v!=null&&(A.h||eh(A.w||(is(A),A.w)||""))||"",w={};p>1&&(w.rowspan=p),g>1&&(w.colspan=g),i.editable?_='<span contenteditable="true">'+_+"</span>":A&&(w["data-t"]=A&&A.t||"z",A.v!=null&&(w["data-v"]=A.v),A.z!=null&&(w["data-z"]=A.z),A.l&&(A.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+A.l.Target+'">'+_+"</a>")),w.id=(i.id||"sjs")+"-"+E,c.push(qe("td",_,w))}}var N="<tr>";return N+c.join("")+"</tr>"}var D6='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',j6="</body></html>";function O6(e,a){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return tl(Im(t[0],a),a);var i=Rh();return t.forEach(function(s,c){Nh(i,Im(s,a),"Sheet"+(c+1))}),i}function I6(e,a,t){var i=[];return i.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function Yv(e,a){var t=a||{},i=t.header!=null?t.header:D6,s=t.footer!=null?t.footer:j6,c=[i],f=un(e["!ref"]);t.dense=Array.isArray(e),c.push(I6(e,f,t));for(var p=f.s.r;p<=f.e.r;++p)c.push(F6(e,f,p,t));return c.push("</table>"+s),c.join("")}function Gv(e,a,t){var i=t||{},s=0,c=0;if(i.origin!=null)if(typeof i.origin=="number")s=i.origin;else{var f=typeof i.origin=="string"?Oa(i.origin):i.origin;s=f.r,c=f.c}var p=a.getElementsByTagName("tr"),g=Math.min(i.sheetRows||1e7,p.length),h={s:{r:0,c:0},e:{r:s,c}};if(e["!ref"]){var E=un(e["!ref"]);h.s.r=Math.min(h.s.r,E.s.r),h.s.c=Math.min(h.s.c,E.s.c),h.e.r=Math.max(h.e.r,E.e.r),h.e.c=Math.max(h.e.c,E.e.c),s==-1&&(h.e.r=s=E.e.r+1)}var A=[],_=0,w=e["!rows"]||(e["!rows"]=[]),N=0,k=0,F=0,z=0,K=0,M=0;for(e["!cols"]||(e["!cols"]=[]);N<p.length&&k<g;++N){var ie=p[N];if(Bm(ie)){if(i.display)continue;w[k]={hidden:!0}}var se=ie.children;for(F=z=0;F<se.length;++F){var ne=se[F];if(!(i.display&&Bm(ne))){var H=ne.hasAttribute("data-v")?ne.getAttribute("data-v"):ne.hasAttribute("v")?ne.getAttribute("v"):py(ne.innerHTML),le=ne.getAttribute("data-z")||ne.getAttribute("z");for(_=0;_<A.length;++_){var oe=A[_];oe.s.c==z+c&&oe.s.r<k+s&&k+s<=oe.e.r&&(z=oe.e.c+1-c,_=-1)}M=+ne.getAttribute("colspan")||1,((K=+ne.getAttribute("rowspan")||1)>1||M>1)&&A.push({s:{r:k+s,c:z+c},e:{r:k+s+(K||1)-1,c:z+c+(M||1)-1}});var m={t:"s",v:H},Se=ne.getAttribute("data-t")||ne.getAttribute("t")||"";H!=null&&(H.length==0?m.t=Se||"z":i.raw||H.trim().length==0||Se=="s"||(H==="TRUE"?m={t:"b",v:!0}:H==="FALSE"?m={t:"b",v:!1}:isNaN(xi(H))?isNaN(Mo(H).getDate())||(m={t:"d",v:ka(H)},i.cellDates||(m={t:"n",v:fr(m.v)}),m.z=i.dateNF||mt[14]):m={t:"n",v:xi(H)})),m.z===void 0&&le!=null&&(m.z=le);var ue="",Pe=ne.getElementsByTagName("A");if(Pe&&Pe.length)for(var et=0;et<Pe.length&&!(Pe[et].hasAttribute("href")&&(ue=Pe[et].getAttribute("href"),ue.charAt(0)!="#"));++et);ue&&ue.charAt(0)!="#"&&(m.l={Target:ue}),i.dense?(e[k+s]||(e[k+s]=[]),e[k+s][z+c]=m):e[bt({c:z+c,r:k+s})]=m,h.e.c<z+c&&(h.e.c=z+c),z+=M}}++k}return A.length&&(e["!merges"]=(e["!merges"]||[]).concat(A)),h.e.r=Math.max(h.e.r,k-1+s),e["!ref"]=wt(h),k>=g&&(e["!fullref"]=wt((h.e.r=p.length-N+k-1+s,h))),e}function Wv(e,a){var t=a||{},i=t.dense?[]:{};return Gv(i,e,a)}function B6(e,a){return tl(Wv(e,a),a)}function Bm(e){var a="",t=M6(e);return t&&(a=t(e).getPropertyValue("display")),a||(a=e.style&&e.style.display),a==="none"}function M6(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function L6(e){var a=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(i,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Kt(a.replace(/<[^>]*>/g,""));return[t]}var Mm={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Vv(e,a){var t=a||{},i=th(e),s=[],c,f,p={name:""},g="",h=0,E,A,_={},w=[],N=t.dense?[]:{},k,F,z={value:""},K="",M=0,ie=[],se=-1,ne=-1,H={s:{r:1e6,c:1e7},e:{r:0,c:0}},le=0,oe={},m=[],Se={},ue=0,Pe=0,et=[],ke=1,de=1,Ce=[],Je={Names:[]},fe={},Ke=["",""],ee=[],I={},L="",Q=0,te=!1,ge=!1,je=0;for(Qc.lastIndex=0,i=i.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");k=Qc.exec(i);)switch(k[3]=k[3].replace(/_.*$/,"")){case"table":case"":k[1]==="/"?(H.e.c>=H.s.c&&H.e.r>=H.s.r?N["!ref"]=wt(H):N["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=H.e.r&&(N["!fullref"]=N["!ref"],H.e.r=t.sheetRows-1,N["!ref"]=wt(H)),m.length&&(N["!merges"]=m),et.length&&(N["!rows"]=et),E.name=E.||E.name,typeof JSON<"u"&&JSON.stringify(E),w.push(E.name),_[E.name]=N,ge=!1):k[0].charAt(k[0].length-2)!=="/"&&(E=Et(k[0],!1),se=ne=-1,H.s.r=H.s.c=1e7,H.e.r=H.e.c=0,N=t.dense?[]:{},m=[],et=[],ge=!0);break;case"table-row-group":k[1]==="/"?--le:++le;break;case"table-row":case"":if(k[1]==="/"){se+=ke,ke=1;break}if(A=Et(k[0],!1),A.?se=A.-1:se==-1&&(se=0),ke=+A["number-rows-repeated"]||1,ke<10)for(je=0;je<ke;++je)le>0&&(et[se+je]={level:le});ne=-1;break;case"covered-table-cell":k[1]!=="/"&&++ne,t.sheetStubs&&(t.dense?(N[se]||(N[se]=[]),N[se][ne]={t:"z"}):N[bt({r:se,c:ne})]={t:"z"}),K="",ie=[];break;case"table-cell":case"":if(k[0].charAt(k[0].length-2)==="/")++ne,z=Et(k[0],!1),de=parseInt(z["number-columns-repeated"]||"1",10),F={t:"z",v:null},z.formula&&t.cellFormula!=!1&&(F.f=Dm(Kt(z.formula))),(z.||z["value-type"])=="string"&&(F.t="s",F.v=Kt(z["string-value"]||""),t.dense?(N[se]||(N[se]=[]),N[se][ne]=F):N[bt({r:se,c:ne})]=F),ne+=de-1;else if(k[1]!=="/"){++ne,K="",M=0,ie=[],de=1;var ze=ke?se+ke-1:se;if(ne>H.e.c&&(H.e.c=ne),ne<H.s.c&&(H.s.c=ne),se<H.s.r&&(H.s.r=se),ze>H.e.r&&(H.e.r=ze),z=Et(k[0],!1),ee=[],I={},F={t:z.||z["value-type"],v:null},t.cellFormula)if(z.formula&&(z.formula=Kt(z.formula)),z["number-matrix-columns-spanned"]&&z["number-matrix-rows-spanned"]&&(ue=parseInt(z["number-matrix-rows-spanned"],10)||0,Pe=parseInt(z["number-matrix-columns-spanned"],10)||0,Se={s:{r:se,c:ne},e:{r:se+ue-1,c:ne+Pe-1}},F.F=wt(Se),Ce.push([Se,F.F])),z.formula)F.f=Dm(z.formula);else for(je=0;je<Ce.length;++je)se>=Ce[je][0].s.r&&se<=Ce[je][0].e.r&&ne>=Ce[je][0].s.c&&ne<=Ce[je][0].e.c&&(F.F=Ce[je][1]);switch((z["number-columns-spanned"]||z["number-rows-spanned"])&&(ue=parseInt(z["number-rows-spanned"],10)||0,Pe=parseInt(z["number-columns-spanned"],10)||0,Se={s:{r:se,c:ne},e:{r:se+ue-1,c:ne+Pe-1}},m.push(Se)),z["number-columns-repeated"]&&(de=parseInt(z["number-columns-repeated"],10)),F.t){case"boolean":F.t="b",F.v=Ca(z["boolean-value"]);break;case"float":F.t="n",F.v=parseFloat(z.value);break;case"percentage":F.t="n",F.v=parseFloat(z.value);break;case"currency":F.t="n",F.v=parseFloat(z.value);break;case"date":F.t="d",F.v=ka(z["date-value"]),t.cellDates||(F.t="n",F.v=fr(F.v)),F.z="m/d/yy";break;case"time":F.t="n",F.v=fS(z["time-value"])/86400,t.cellDates&&(F.t="d",F.v=ff(F.v)),F.z="HH:MM:SS";break;case"number":F.t="n",F.v=parseFloat(z.);break;default:if(F.t==="string"||F.t==="text"||!F.t)F.t="s",z["string-value"]!=null&&(K=Kt(z["string-value"]),ie=[]);else throw new Error("Unsupported value type "+F.t)}}else{if(te=!1,F.t==="s"&&(F.v=K||"",ie.length&&(F.R=ie),te=M==0),fe.Target&&(F.l=fe),ee.length>0&&(F.c=ee,ee=[]),K&&t.cellText!==!1&&(F.w=K),te&&(F.t="z",delete F.v),(!te||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=se))for(var Oe=0;Oe<ke;++Oe){if(de=parseInt(z["number-columns-repeated"]||"1",10),t.dense)for(N[se+Oe]||(N[se+Oe]=[]),N[se+Oe][ne]=Oe==0?F:wa(F);--de>0;)N[se+Oe][ne+de]=wa(F);else for(N[bt({r:se+Oe,c:ne})]=F;--de>0;)N[bt({r:se+Oe,c:ne+de})]=wa(F);H.e.c<=ne&&(H.e.c=ne)}de=parseInt(z["number-columns-repeated"]||"1",10),ne+=de-1,de=0,F={},K="",ie=[]}fe={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(k[1]==="/"){if((c=s.pop())[0]!==k[3])throw"Bad state: "+c}else k[0].charAt(k[0].length-2)!=="/"&&s.push([k[3],!0]);break;case"annotation":if(k[1]==="/"){if((c=s.pop())[0]!==k[3])throw"Bad state: "+c;I.t=K,ie.length&&(I.R=ie),I.a=L,ee.push(I)}else k[0].charAt(k[0].length-2)!=="/"&&s.push([k[3],!1]);L="",Q=0,K="",M=0,ie=[];break;case"creator":k[1]==="/"?L=i.slice(Q,k.index):Q=k.index+k[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(k[1]==="/"){if((c=s.pop())[0]!==k[3])throw"Bad state: "+c}else k[0].charAt(k[0].length-2)!=="/"&&s.push([k[3],!1]);K="",M=0,ie=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(k[1]==="/"){if(oe[p.name]=g,(c=s.pop())[0]!==k[3])throw"Bad state: "+c}else k[0].charAt(k[0].length-2)!=="/"&&(g="",p=Et(k[0],!1),s.push([k[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":f=Et(k[0],!1),g+=Mm[k[3]][f.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":f=Et(k[0],!1),g+=Mm[k[3]][f.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(k[0].slice(-2)==="/>")break;if(k[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":g+=i.slice(h,k.index);break}else h=k.index+k[0].length;break;case"named-range":f=Et(k[0],!1),Ke=_p(f["cell-range-address"]);var Ue={Name:f.name,Ref:Ke[0]+"!"+Ke[1]};ge&&(Ue.Sheet=w.length),Je.Names.push(Ue);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(k[1]==="/"&&(!z||!z["string-value"])){var St=L6(i.slice(M,k.index));K=(K.length>0?K+`
`:"")+St[0]}else Et(k[0],!1),M=k.index+k[0].length;break;case"s":break;case"database-range":if(k[1]==="/")break;try{Ke=_p(Et(k[0])["target-range-address"]),_[Ke[0]]["!autofilter"]={ref:Ke[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(k[1]!=="/"){if(fe=Et(k[0],!1),!fe.href)break;fe.Target=Kt(fe.href),delete fe.href,fe.Target.charAt(0)=="#"&&fe.Target.indexOf(".")>-1?(Ke=_p(fe.Target.slice(1)),fe.Target="#"+Ke[0]+"!"+Ke[1]):fe.Target.match(/^\.\.[\\\/]/)&&(fe.Target=fe.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(k[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(k)}}var Z={Sheets:_,SheetNames:w,Workbook:Je};return t.bookSheets&&delete Z.Sheets,Z}function Lm(e,a){a=a||{},Wn(e,"META-INF/manifest.xml")&&fE(ar(e,"META-INF/manifest.xml"),a);var t=kn(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var i=Vv(xa(t),a);return Wn(e,"meta.xml")&&(i.Props=My(ar(e,"meta.xml"))),i}function Pm(e,a){return Vv(e,a)}var P6=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),a="<office:document-styles "+Kc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return qa+a}})(),zm=(function(){var e=function(c){return fa(c).replace(/  +/g,function(f){return'<text:s text:c="'+f.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},a=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,i=function(c,f,p){var g=[];g.push('      <table:table table:name="'+fa(f.SheetNames[p])+`" table:style-name="ta1">
`);var h=0,E=0,A=un(c["!ref"]||"A1"),_=c["!merges"]||[],w=0,N=Array.isArray(c);if(c["!cols"])for(E=0;E<=A.e.c;++E)g.push("        <table:table-column"+(c["!cols"][E]?' table:style-name="co'+c["!cols"][E].ods+'"':"")+`></table:table-column>
`);var k="",F=c["!rows"]||[];for(h=0;h<A.s.r;++h)k=F[h]?' table:style-name="ro'+F[h].ods+'"':"",g.push("        <table:table-row"+k+`></table:table-row>
`);for(;h<=A.e.r;++h){for(k=F[h]?' table:style-name="ro'+F[h].ods+'"':"",g.push("        <table:table-row"+k+`>
`),E=0;E<A.s.c;++E)g.push(a);for(;E<=A.e.c;++E){var z=!1,K={},M="";for(w=0;w!=_.length;++w)if(!(_[w].s.c>E)&&!(_[w].s.r>h)&&!(_[w].e.c<E)&&!(_[w].e.r<h)){(_[w].s.c!=E||_[w].s.r!=h)&&(z=!0),K["table:number-columns-spanned"]=_[w].e.c-_[w].s.c+1,K["table:number-rows-spanned"]=_[w].e.r-_[w].s.r+1;break}if(z){g.push(t);continue}var ie=bt({r:h,c:E}),se=N?(c[h]||[])[E]:c[ie];if(se&&se.f&&(K["table:formula"]=fa(iC(se.f)),se.F&&se.F.slice(0,ie.length)==ie)){var ne=un(se.F);K["table:number-matrix-columns-spanned"]=ne.e.c-ne.s.c+1,K["table:number-matrix-rows-spanned"]=ne.e.r-ne.s.r+1}if(!se){g.push(a);continue}switch(se.t){case"b":M=se.v?"TRUE":"FALSE",K["office:value-type"]="boolean",K["office:boolean-value"]=se.v?"true":"false";break;case"n":M=se.w||String(se.v||0),K["office:value-type"]="float",K["office:value"]=se.v||0;break;case"s":case"str":M=se.v==null?"":se.v,K["office:value-type"]="string";break;case"d":M=se.w||ka(se.v).toISOString(),K["office:value-type"]="date",K["office:date-value"]=ka(se.v).toISOString(),K["table:style-name"]="ce1";break;default:g.push(a);continue}var H=e(M);if(se.l&&se.l.Target){var le=se.l.Target;le=le.charAt(0)=="#"?"#"+sC(le.slice(1)):le,le.charAt(0)!="#"&&!le.match(/^\w+:/)&&(le="../"+le),H=qe("text:a",H,{"xlink:href":le.replace(/&/g,"&amp;")})}g.push("          "+qe("table:table-cell",qe("text:p",H,{}),K)+`
`)}g.push(`        </table:table-row>
`)}return g.push(`      </table:table>
`),g.join("")},s=function(c,f){c.push(` <office:automatic-styles>
`),c.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),c.push(`   <number:month number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:day number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:year/>
`),c.push(`  </number:date-style>
`);var p=0;f.SheetNames.map(function(h){return f.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var E=0;E<h["!cols"].length;++E)if(h["!cols"][E]){var A=h["!cols"][E];if(A.width==null&&A.wpx==null&&A.wch==null)continue;Qs(A),A.ods=p;var _=h["!cols"][E].wpx+"px";c.push('  <style:style style:name="co'+p+`" style:family="table-column">
`),c.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_+`"/>
`),c.push(`  </style:style>
`),++p}}});var g=0;f.SheetNames.map(function(h){return f.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var E=0;E<h["!rows"].length;++E)if(h["!rows"][E]){h["!rows"][E].ods=g;var A=h["!rows"][E].hpx+"px";c.push('  <style:style style:name="ro'+g+`" style:family="table-row">
`),c.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+A+`"/>
`),c.push(`  </style:style>
`),++g}}}),c.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),c.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),c.push(`  </style:style>
`),c.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),c.push(` </office:automatic-styles>
`)};return function(f,p){var g=[qa],h=Kc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),E=Kc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});p.bookType=="fods"?(g.push("<office:document"+h+E+`>
`),g.push(By().replace(/office:document-meta/g,"office:meta"))):g.push("<office:document-content"+h+`>
`),s(g,f),g.push(`  <office:body>
`),g.push(`    <office:spreadsheet>
`);for(var A=0;A!=f.SheetNames.length;++A)g.push(i(f.Sheets[f.SheetNames[A]],f,A));return g.push(`    </office:spreadsheet>
`),g.push(`  </office:body>
`),p.bookType=="fods"?g.push("</office:document>"):g.push("</office:document-content>"),g.join("")}})();function Xv(e,a){if(a.bookType=="fods")return zm(e,a);var t=Qp(),i="",s=[],c=[];return i="mimetype",Ft(t,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",Ft(t,i,zm(e,a)),s.push([i,"text/xml"]),c.push([i,"ContentFile"]),i="styles.xml",Ft(t,i,P6(e,a)),s.push([i,"text/xml"]),c.push([i,"StylesFile"]),i="meta.xml",Ft(t,i,qa+By()),s.push([i,"text/xml"]),c.push([i,"MetadataFile"]),i="manifest.rdf",Ft(t,i,hE(c)),s.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",Ft(t,i,uE(s)),t}function $l(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Hp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):xa(el(e))}function z6(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Cn(Ni(e))}function U6(e,a){e:for(var t=0;t<=e.length-a.length;++t){for(var i=0;i<a.length;++i)if(e[t+i]!=a[i])continue e;return!0}return!1}function Zs(e){var a=e.reduce(function(s,c){return s+c.length},0),t=new Uint8Array(a),i=0;return e.forEach(function(s){t.set(s,i),i+=s.length}),t}function Um(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function H6(e,a){for(var t=(e[a+15]&127)<<7|e[a+14]>>1,i=e[a+14]&1,s=a+13;s>=a;--s)i=i*256+e[s];return(e[a+15]&128?-i:i)*Math.pow(10,t-6176)}function $6(e,a,t){var i=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,s=t/Math.pow(10,i-6176);e[a+15]|=i>>7,e[a+14]|=(i&127)<<1;for(var c=0;s>=1;++c,s/=256)e[a+c]=s&255;e[a+15]|=t>=0?0:128}function n0(e,a){var t=a?a[0]:0,i=e[t]&127;e:if(e[t++]>=128&&(i|=(e[t]&127)<<7,e[t++]<128||(i|=(e[t]&127)<<14,e[t++]<128)||(i|=(e[t]&127)<<21,e[t++]<128)||(i+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(i+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(i+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return a&&(a[0]=t),i}function ca(e){var a=new Uint8Array(7);a[0]=e&127;var t=1;e:if(e>127){if(a[t-1]|=128,a[t]=e>>7&127,++t,e<=16383||(a[t-1]|=128,a[t]=e>>14&127,++t,e<=2097151)||(a[t-1]|=128,a[t]=e>>21&127,++t,e<=268435455)||(a[t-1]|=128,a[t]=e/256>>>21&127,++t,e<=34359738367)||(a[t-1]|=128,a[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;a[t-1]|=128,a[t]=e/16777216>>>21&127,++t}return a.slice(0,t)}function za(e){var a=0,t=e[a]&127;e:if(e[a++]>=128){if(t|=(e[a]&127)<<7,e[a++]<128||(t|=(e[a]&127)<<14,e[a++]<128)||(t|=(e[a]&127)<<21,e[a++]<128))break e;t|=(e[a]&127)<<28}return t}function ra(e){for(var a=[],t=[0];t[0]<e.length;){var i=t[0],s=n0(e,t),c=s&7;s=Math.floor(s/8);var f=0,p;if(s==0)break;switch(c){case 0:{for(var g=t[0];e[t[0]++]>=128;);p=e.slice(g,t[0])}break;case 5:f=4,p=e.slice(t[0],t[0]+f),t[0]+=f;break;case 1:f=8,p=e.slice(t[0],t[0]+f),t[0]+=f;break;case 2:f=n0(e,t),p=e.slice(t[0],t[0]+f),t[0]+=f;break;default:throw new Error("PB Type ".concat(c," for Field ").concat(s," at offset ").concat(i))}var h={data:p,type:c};a[s]==null?a[s]=[h]:a[s].push(h)}return a}function Cr(e){var a=[];return e.forEach(function(t,i){t.forEach(function(s){s.data&&(a.push(ca(i*8+s.type)),s.type==2&&a.push(ca(s.data.length)),a.push(s.data))})}),Zs(a)}function Ah(e,a){return e?.map(function(t){return a(t.data)})||[]}function Yn(e){for(var a,t=[],i=[0];i[0]<e.length;){var s=n0(e,i),c=ra(e.slice(i[0],i[0]+s));i[0]+=s;var f={id:za(c[1][0].data),messages:[]};c[2].forEach(function(p){var g=ra(p.data),h=za(g[3][0].data);f.messages.push({meta:g,data:e.slice(i[0],i[0]+h)}),i[0]+=h}),(a=c[3])!=null&&a[0]&&(f.merge=za(c[3][0].data)>>>0>0),t.push(f)}return t}function Ro(e){var a=[];return e.forEach(function(t){var i=[];i[1]=[{data:ca(t.id),type:0}],i[2]=[],t.merge!=null&&(i[3]=[{data:ca(+!!t.merge),type:0}]);var s=[];t.messages.forEach(function(f){s.push(f.data),f.meta[3]=[{type:0,data:ca(f.data.length)}],i[2].push({data:Cr(f.meta),type:2})});var c=Cr(i);a.push(ca(c.length)),a.push(c),s.forEach(function(f){return a.push(f)})}),Zs(a)}function Y6(e,a){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],i=n0(a,t),s=[];t[0]<a.length;){var c=a[t[0]]&3;if(c==0){var f=a[t[0]++]>>2;if(f<60)++f;else{var p=f-59;f=a[t[0]],p>1&&(f|=a[t[0]+1]<<8),p>2&&(f|=a[t[0]+2]<<16),p>3&&(f|=a[t[0]+3]<<24),f>>>=0,f++,t[0]+=p}s.push(a.slice(t[0],t[0]+f)),t[0]+=f;continue}else{var g=0,h=0;if(c==1?(h=(a[t[0]]>>2&7)+4,g=(a[t[0]++]&224)<<3,g|=a[t[0]++]):(h=(a[t[0]++]>>2)+1,c==2?(g=a[t[0]]|a[t[0]+1]<<8,t[0]+=2):(g=(a[t[0]]|a[t[0]+1]<<8|a[t[0]+2]<<16|a[t[0]+3]<<24)>>>0,t[0]+=4)),s=[Zs(s)],g==0)throw new Error("Invalid offset 0");if(g>s[0].length)throw new Error("Invalid offset beyond length");if(h>=g)for(s.push(s[0].slice(-g)),h-=g;h>=s[s.length-1].length;)s.push(s[s.length-1]),h-=s[s.length-1].length;s.push(s[0].slice(-g,-g+h))}}var E=Zs(s);if(E.length!=i)throw new Error("Unexpected length: ".concat(E.length," != ").concat(i));return E}function Gn(e){for(var a=[],t=0;t<e.length;){var i=e[t++],s=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,a.push(Y6(i,e.slice(t,t+s))),t+=s}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Zs(a)}function No(e){for(var a=[],t=0;t<e.length;){var i=Math.min(e.length-t,268435455),s=new Uint8Array(4);a.push(s);var c=ca(i),f=c.length;a.push(c),i<=60?(f++,a.push(new Uint8Array([i-1<<2]))):i<=256?(f+=2,a.push(new Uint8Array([240,i-1&255]))):i<=65536?(f+=3,a.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(f+=4,a.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(f+=5,a.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),a.push(e.slice(t,t+i)),f+=i,s[0]=0,s[1]=f&255,s[2]=f>>8&255,s[3]=f>>16&255,t+=i}return Zs(a)}function G6(e,a,t,i){var s=$l(e),c=s.getUint32(4,!0),f=(i>1?12:8)+Um(c&(i>1?3470:398))*4,p=-1,g=-1,h=NaN,E=new Date(2001,0,1);c&512&&(p=s.getUint32(f,!0),f+=4),f+=Um(c&(i>1?12288:4096))*4,c&16&&(g=s.getUint32(f,!0),f+=4),c&32&&(h=s.getFloat64(f,!0),f+=8),c&64&&(E.setTime(E.getTime()+s.getFloat64(f,!0)*1e3),f+=8);var A;switch(e[2]){case 0:break;case 2:A={t:"n",v:h};break;case 3:A={t:"s",v:a[g]};break;case 5:A={t:"d",v:E};break;case 6:A={t:"b",v:h>0};break;case 7:A={t:"n",v:h/86400};break;case 8:A={t:"e",v:0};break;case 9:if(p>-1)A={t:"s",v:t[p]};else if(g>-1)A={t:"s",v:a[g]};else if(!isNaN(h))A={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return A}function W6(e,a,t){var i=$l(e),s=i.getUint32(8,!0),c=12,f=-1,p=-1,g=NaN,h=NaN,E=new Date(2001,0,1);s&1&&(g=H6(e,c),c+=16),s&2&&(h=i.getFloat64(c,!0),c+=8),s&4&&(E.setTime(E.getTime()+i.getFloat64(c,!0)*1e3),c+=8),s&8&&(p=i.getUint32(c,!0),c+=4),s&16&&(f=i.getUint32(c,!0),c+=4);var A;switch(e[1]){case 0:break;case 2:A={t:"n",v:g};break;case 3:A={t:"s",v:a[p]};break;case 5:A={t:"d",v:E};break;case 6:A={t:"b",v:h>0};break;case 7:A={t:"n",v:h/86400};break;case 8:A={t:"e",v:0};break;case 9:if(f>-1)A={t:"s",v:t[f]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:A={t:"n",v:g};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return A}function kp(e,a){var t=new Uint8Array(32),i=$l(t),s=12,c=0;switch(t[0]=5,e.t){case"n":t[1]=2,$6(t,s,e.v),c|=1,s+=16;break;case"b":t[1]=6,i.setFloat64(s,e.v?1:0,!0),c|=2,s+=8;break;case"s":if(a.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,i.setUint32(s,a.indexOf(e.v),!0),c|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return i.setUint32(8,c,!0),t.slice(0,s)}function wp(e,a){var t=new Uint8Array(32),i=$l(t),s=12,c=0;switch(t[0]=3,e.t){case"n":t[2]=2,i.setFloat64(s,e.v,!0),c|=32,s+=8;break;case"b":t[2]=6,i.setFloat64(s,e.v?1:0,!0),c|=32,s+=8;break;case"s":if(a.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,i.setUint32(s,a.indexOf(e.v),!0),c|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return i.setUint32(4,c,!0),t.slice(0,s)}function V6(e,a,t){switch(e[0]){case 0:case 1:case 2:case 3:return G6(e,a,t,e[0]);case 5:return W6(e,a,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Mr(e){var a=ra(e);return n0(a[1][0].data)}function Hm(e,a){var t=ra(a.data),i=za(t[1][0].data),s=t[3],c=[];return(s||[]).forEach(function(f){var p=ra(f.data),g=za(p[1][0].data)>>>0;switch(i){case 1:c[g]=Hp(p[3][0].data);break;case 8:{var h=e[Mr(p[9][0].data)][0],E=ra(h.data),A=e[Mr(E[1][0].data)][0],_=za(A.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var w=ra(A.data);c[g]=w[3].map(function(N){return Hp(N.data)}).join("")}break}}),c}function X6(e,a){var t,i,s,c,f,p,g,h,E,A,_,w,N,k,F=ra(e),z=za(F[1][0].data)>>>0,K=za(F[2][0].data)>>>0,M=((i=(t=F[8])==null?void 0:t[0])==null?void 0:i.data)&&za(F[8][0].data)>0||!1,ie,se;if((c=(s=F[7])==null?void 0:s[0])!=null&&c.data&&a!=0)ie=(p=(f=F[7])==null?void 0:f[0])==null?void 0:p.data,se=(h=(g=F[6])==null?void 0:g[0])==null?void 0:h.data;else if((A=(E=F[4])==null?void 0:E[0])!=null&&A.data&&a!=1)ie=(w=(_=F[4])==null?void 0:_[0])==null?void 0:w.data,se=(k=(N=F[3])==null?void 0:N[0])==null?void 0:k.data;else throw"NUMBERS Tile missing ".concat(a," cell storage");for(var ne=M?4:1,H=$l(ie),le=[],oe=0;oe<ie.length/2;++oe){var m=H.getUint16(oe*2,!0);m<65535&&le.push([oe,m])}if(le.length!=K)throw"Expected ".concat(K," cells, found ").concat(le.length);var Se=[];for(oe=0;oe<le.length-1;++oe)Se[le[oe][0]]=se.subarray(le[oe][1]*ne,le[oe+1][1]*ne);return le.length>=1&&(Se[le[le.length-1][0]]=se.subarray(le[le.length-1][1]*ne)),{R:z,cells:Se}}function q6(e,a){var t,i=ra(a.data),s=(t=i?.[7])!=null&&t[0]?za(i[7][0].data)>>>0>0?1:0:-1,c=Ah(i[5],function(f){return X6(f,s)});return{nrows:za(i[4][0].data)>>>0,data:c.reduce(function(f,p){return f[p.R]||(f[p.R]=[]),p.cells.forEach(function(g,h){if(f[p.R][h])throw new Error("Duplicate cell r=".concat(p.R," c=").concat(h));f[p.R][h]=g}),f},[])}}function K6(e,a,t){var i,s=ra(a.data),c={s:{r:0,c:0},e:{r:0,c:0}};if(c.e.r=(za(s[6][0].data)>>>0)-1,c.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(c.e.c=(za(s[7][0].data)>>>0)-1,c.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));t["!ref"]=wt(c);var f=ra(s[4][0].data),p=Hm(e,e[Mr(f[4][0].data)][0]),g=(i=f[17])!=null&&i[0]?Hm(e,e[Mr(f[17][0].data)][0]):[],h=ra(f[3][0].data),E=0;h[1].forEach(function(A){var _=ra(A.data),w=e[Mr(_[2][0].data)][0],N=za(w.meta[1][0].data);if(N!=6002)throw new Error("6001 unexpected reference to ".concat(N));var k=q6(e,w);k.data.forEach(function(F,z){F.forEach(function(K,M){var ie=bt({r:E+z,c:M}),se=V6(K,p,g);se&&(t[ie]=se)})}),E+=k.nrows})}function Q6(e,a){var t=ra(a.data),i={"!ref":"A1"},s=e[Mr(t[2][0].data)],c=za(s[0].meta[1][0].data);if(c!=6001)throw new Error("6000 unexpected reference to ".concat(c));return K6(e,s[0],i),i}function J6(e,a){var t,i=ra(a.data),s={name:(t=i[1])!=null&&t[0]?Hp(i[1][0].data):"",sheets:[]},c=Ah(i[2],Mr);return c.forEach(function(f){e[f].forEach(function(p){var g=za(p.meta[1][0].data);g==6e3&&s.sheets.push(Q6(e,p))})}),s}function Z6(e,a){var t=Rh(),i=ra(a.data),s=Ah(i[1],Mr);if(s.forEach(function(c){e[c].forEach(function(f){var p=za(f.meta[1][0].data);if(p==2){var g=J6(e,f);g.sheets.forEach(function(h,E){Nh(t,h,E==0?g.name:g.name+"_"+E,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Rp(e){var a,t,i,s,c={},f=[];if(e.FullPaths.forEach(function(g){if(g.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(g){if(g.name.match(/\.iwa$/)){var h;try{h=Gn(g.content)}catch(A){return console.log("?? "+g.content.length+" "+(A.message||A))}var E;try{E=Yn(h)}catch(A){return console.log("## "+(A.message||A))}E.forEach(function(A){c[A.id]=A.messages,f.push(A.id)})}}),!f.length)throw new Error("File has no messages");var p=((s=(i=(t=(a=c?.[1])==null?void 0:a[0])==null?void 0:t.meta)==null?void 0:i[1])==null?void 0:s[0].data)&&za(c[1][0].meta[1][0].data)==1&&c[1][0];if(p||f.forEach(function(g){c[g].forEach(function(h){var E=za(h.meta[1][0].data)>>>0;if(E==1)if(!p)p=h;else throw new Error("Document has multiple roots")})}),!p)throw new Error("Cannot find Document root");return Z6(c,p)}function e8(e,a,t){var i,s,c,f;if(!((i=e[6])!=null&&i[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var p=((f=(c=e[8])==null?void 0:c[0])==null?void 0:f.data)&&za(e[8][0].data)>0||!1;if(p)throw"Math only works with normal offsets";for(var g=0,h=$l(e[7][0].data),E=0,A=[],_=$l(e[4][0].data),w=0,N=[],k=0;k<a.length;++k){if(a[k]==null){h.setUint16(k*2,65535,!0),_.setUint16(k*2,65535);continue}h.setUint16(k*2,E,!0),_.setUint16(k*2,w,!0);var F,z;switch(typeof a[k]){case"string":F=kp({t:"s",v:a[k]},t),z=wp({t:"s",v:a[k]},t);break;case"number":F=kp({t:"n",v:a[k]},t),z=wp({t:"n",v:a[k]},t);break;case"boolean":F=kp({t:"b",v:a[k]},t),z=wp({t:"b",v:a[k]},t);break;default:throw new Error("Unsupported value "+a[k])}A.push(F),E+=F.length,N.push(z),w+=z.length,++g}for(e[2][0].data=ca(g);k<e[7][0].data.length/2;++k)h.setUint16(k*2,65535,!0),_.setUint16(k*2,65535,!0);return e[6][0].data=Zs(A),e[3][0].data=Zs(N),g}function t8(e,a){if(!a||!a.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=un(t["!ref"]);i.s.r=i.s.c=0;var s=!1;i.e.c>9&&(s=!0,i.e.c=9),i.e.r>49&&(s=!0,i.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(wt(i)));var c=sf(t,{range:i,header:1}),f=["~Sh33tJ5~"];c.forEach(function(L){return L.forEach(function(Q){typeof Q=="string"&&f.push(Q)})});var p={},g=[],h=ht.read(a.numbers,{type:"base64"});h.FileIndex.map(function(L,Q){return[L,h.FullPaths[Q]]}).forEach(function(L){var Q=L[0],te=L[1];if(Q.type==2&&Q.name.match(/\.iwa/)){var ge=Q.content,je=Gn(ge),ze=Yn(je);ze.forEach(function(Oe){g.push(Oe.id),p[Oe.id]={deps:[],location:te,type:za(Oe.messages[0].meta[1][0].data)}})}}),g.sort(function(L,Q){return L-Q});var E=g.filter(function(L){return L>1}).map(function(L){return[L,ca(L)]});h.FileIndex.map(function(L,Q){return[L,h.FullPaths[Q]]}).forEach(function(L){var Q=L[0];if(L[1],!!Q.name.match(/\.iwa/)){var te=Yn(Gn(Q.content));te.forEach(function(ge){ge.messages.forEach(function(je){E.forEach(function(ze){ge.messages.some(function(Oe){return za(Oe.meta[1][0].data)!=11006&&U6(Oe.data,ze[1])})&&p[ze[0]].deps.push(ge.id)})})})}});for(var A=ht.find(h,p[1].location),_=Yn(Gn(A.content)),w,N=0;N<_.length;++N){var k=_[N];k.id==1&&(w=k)}var F=Mr(ra(w.messages[0].data)[1][0].data);for(A=ht.find(h,p[F].location),_=Yn(Gn(A.content)),N=0;N<_.length;++N)k=_[N],k.id==F&&(w=k);for(F=Mr(ra(w.messages[0].data)[2][0].data),A=ht.find(h,p[F].location),_=Yn(Gn(A.content)),N=0;N<_.length;++N)k=_[N],k.id==F&&(w=k);for(F=Mr(ra(w.messages[0].data)[2][0].data),A=ht.find(h,p[F].location),_=Yn(Gn(A.content)),N=0;N<_.length;++N)k=_[N],k.id==F&&(w=k);var z=ra(w.messages[0].data);{z[6][0].data=ca(i.e.r+1),z[7][0].data=ca(i.e.c+1);var K=Mr(z[46][0].data),M=ht.find(h,p[K].location),ie=Yn(Gn(M.content));{for(var se=0;se<ie.length&&ie[se].id!=K;++se);if(ie[se].id!=K)throw"Bad ColumnRowUIDMapArchive";var ne=ra(ie[se].messages[0].data);ne[1]=[],ne[2]=[],ne[3]=[];for(var H=0;H<=i.e.c;++H){var le=[];le[1]=le[2]=[{type:0,data:ca(H+420690)}],ne[1].push({type:2,data:Cr(le)}),ne[2].push({type:0,data:ca(H)}),ne[3].push({type:0,data:ca(H)})}ne[4]=[],ne[5]=[],ne[6]=[];for(var oe=0;oe<=i.e.r;++oe)le=[],le[1]=le[2]=[{type:0,data:ca(oe+726270)}],ne[4].push({type:2,data:Cr(le)}),ne[5].push({type:0,data:ca(oe)}),ne[6].push({type:0,data:ca(oe)});ie[se].messages[0].data=Cr(ne)}M.content=No(Ro(ie)),M.size=M.content.length,delete z[46];var m=ra(z[4][0].data);{m[7][0].data=ca(i.e.r+1);var Se=ra(m[1][0].data),ue=Mr(Se[2][0].data);M=ht.find(h,p[ue].location),ie=Yn(Gn(M.content));{if(ie[0].id!=ue)throw"Bad HeaderStorageBucket";var Pe=ra(ie[0].messages[0].data);for(oe=0;oe<c.length;++oe){var et=ra(Pe[2][0].data);et[1][0].data=ca(oe),et[4][0].data=ca(c[oe].length),Pe[2][oe]={type:Pe[2][0].type,data:Cr(et)}}ie[0].messages[0].data=Cr(Pe)}M.content=No(Ro(ie)),M.size=M.content.length;var ke=Mr(m[2][0].data);M=ht.find(h,p[ke].location),ie=Yn(Gn(M.content));{if(ie[0].id!=ke)throw"Bad HeaderStorageBucket";for(Pe=ra(ie[0].messages[0].data),H=0;H<=i.e.c;++H)et=ra(Pe[2][0].data),et[1][0].data=ca(H),et[4][0].data=ca(i.e.r+1),Pe[2][H]={type:Pe[2][0].type,data:Cr(et)};ie[0].messages[0].data=Cr(Pe)}M.content=No(Ro(ie)),M.size=M.content.length;var de=Mr(m[4][0].data);(function(){for(var L=ht.find(h,p[de].location),Q=Yn(Gn(L.content)),te,ge=0;ge<Q.length;++ge){var je=Q[ge];je.id==de&&(te=je)}var ze=ra(te.messages[0].data);{ze[3]=[];var Oe=[];f.forEach(function(Z,Jt){Oe[1]=[{type:0,data:ca(Jt)}],Oe[2]=[{type:0,data:ca(1)}],Oe[3]=[{type:2,data:z6(Z)}],ze[3].push({type:2,data:Cr(Oe)})})}te.messages[0].data=Cr(ze);var Ue=Ro(Q),St=No(Ue);L.content=St,L.size=L.content.length})();var Ce=ra(m[3][0].data);{var Je=Ce[1][0];delete Ce[2];var fe=ra(Je.data);{var Ke=Mr(fe[2][0].data);(function(){for(var L=ht.find(h,p[Ke].location),Q=Yn(Gn(L.content)),te,ge=0;ge<Q.length;++ge){var je=Q[ge];je.id==Ke&&(te=je)}var ze=ra(te.messages[0].data);{delete ze[6],delete Ce[7];var Oe=new Uint8Array(ze[5][0].data);ze[5]=[];for(var Ue=0,St=0;St<=i.e.r;++St){var Z=ra(Oe);Ue+=e8(Z,c[St],f),Z[1][0].data=ca(St),ze[5].push({data:Cr(Z),type:2})}ze[1]=[{type:0,data:ca(i.e.c+1)}],ze[2]=[{type:0,data:ca(i.e.r+1)}],ze[3]=[{type:0,data:ca(Ue)}],ze[4]=[{type:0,data:ca(i.e.r+1)}]}te.messages[0].data=Cr(ze);var Jt=Ro(Q),At=No(Jt);L.content=At,L.size=L.content.length})()}Je.data=Cr(fe)}m[3][0].data=Cr(Ce)}z[4][0].data=Cr(m)}w.messages[0].data=Cr(z);var ee=Ro(_),I=No(ee);return A.content=I,A.size=A.content.length,h}function qv(e){return function(t){for(var i=0;i!=e.length;++i){var s=e[i];t[s[0]]===void 0&&(t[s[0]]=s[1]),s[2]==="n"&&(t[s[0]]=Number(t[s[0]]))}}}function _h(e){qv([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Ch(e){qv([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function a8(e){return Bt.WS.indexOf(e)>-1?"sheet":e==Bt.CS?"chart":e==Bt.DS?"dialog":e==Bt.MS?"macro":e&&e.length?e:"sheet"}function r8(e,a){if(!e)return 0;try{e=a.map(function(i){return i.id||(i.id=i.strRelID),[i.name,e["!id"][i.id].Target,a8(e["!id"][i.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function n8(e,a,t,i,s,c,f,p,g,h,E,A){try{c[i]=Uc(kn(e,t,!0),a);var _=ar(e,a),w;switch(p){case"sheet":w=Cw(_,a,s,g,c[i],h,E,A);break;case"chart":if(w=kw(_,a,s,g,c[i],h,E,A),!w||!w["!drawel"])break;var N=Mc(w["!drawel"].Target,a),k=Jc(N),F=p4(kn(e,N,!0),Uc(kn(e,k,!0),N)),z=Mc(F,N),K=Jc(z);w=ew(kn(e,z,!0),z,g,Uc(kn(e,K,!0),z),h,w);break;case"macro":w=ww(_,a,s,g,c[i],h,E,A);break;case"dialog":w=Rw(_,a,s,g,c[i],h,E,A);break;default:throw new Error("Unrecognized sheet type "+p)}f[i]=w;var M=[];c&&c[i]&&Ua(c[i]).forEach(function(ie){var se="";if(c[i][ie].Type==Bt.CMNT){se=Mc(c[i][ie].Target,a);var ne=jw(ar(e,se,!0),se,g);if(!ne||!ne.length)return;km(w,ne,!1)}c[i][ie].Type==Bt.TCMNT&&(se=Mc(c[i][ie].Target,a),M=M.concat(g4(ar(e,se,!0),g)))}),M&&M.length&&km(w,M,!0,g.people||[])}catch(ie){if(g.WTF)throw ie}}function Hn(e){return e.charAt(0)=="/"?e.slice(1):e}function i8(e,a){if(Uo(),a=a||{},_h(a),Wn(e,"META-INF/manifest.xml")||Wn(e,"objectdata.xml"))return Lm(e,a);if(Wn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Rp<"u"){if(e.FileIndex)return Rp(e);var t=ht.utils.cfb_new();return Xx(e).forEach(function(et){Ft(t,et,xS(e,et))}),Rp(t)}throw new Error("Unsupported NUMBERS file")}if(!Wn(e,"[Content_Types].xml"))throw Wn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Wn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var i=Xx(e),s=cE(kn(e,"[Content_Types].xml")),c=!1,f,p;if(s.workbooks.length===0&&(p="xl/workbook.xml",ar(e,p,!0)&&s.workbooks.push(p)),s.workbooks.length===0){if(p="xl/workbook.bin",!ar(e,p,!0))throw new Error("Could not find workbook");s.workbooks.push(p),c=!0}s.workbooks[0].slice(-3)=="bin"&&(c=!0);var g={},h={};if(!a.bookSheets&&!a.bookProps){if(Hc=[],s.sst)try{Hc=Dw(ar(e,Hn(s.sst)),s.sst,a)}catch(et){if(a.WTF)throw et}a.cellStyles&&s.themes.length&&(g=Fw(kn(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],a)),s.style&&(h=Nw(ar(e,Hn(s.style)),s.style,g,a))}s.links.map(function(et){try{var ke=Uc(kn(e,Jc(Hn(et))),et);return Iw(ar(e,Hn(et)),ke,et,a)}catch{}});var E=_w(ar(e,Hn(s.workbooks[0])),s.workbooks[0],a),A={},_="";s.coreprops.length&&(_=ar(e,Hn(s.coreprops[0]),!0),_&&(A=My(_)),s.extprops.length!==0&&(_=ar(e,Hn(s.extprops[0]),!0),_&&xE(_,A,a)));var w={};(!a.bookSheets||a.bookProps)&&s.custprops.length!==0&&(_=kn(e,Hn(s.custprops[0]),!0),_&&(w=yE(_,a)));var N={};if((a.bookSheets||a.bookProps)&&(E.Sheets?f=E.Sheets.map(function(ke){return ke.name}):A.Worksheets&&A.SheetNames.length>0&&(f=A.SheetNames),a.bookProps&&(N.Props=A,N.Custprops=w),a.bookSheets&&typeof f<"u"&&(N.SheetNames=f),a.bookSheets?N.SheetNames:a.bookProps))return N;f={};var k={};a.bookDeps&&s.calcchain&&(k=Ow(ar(e,Hn(s.calcchain)),s.calcchain));var F=0,z={},K,M;{var ie=E.Sheets;A.Worksheets=ie.length,A.SheetNames=[];for(var se=0;se!=ie.length;++se)A.SheetNames[se]=ie[se].name}var ne=c?"bin":"xml",H=s.workbooks[0].lastIndexOf("/"),le=(s.workbooks[0].slice(0,H+1)+"_rels/"+s.workbooks[0].slice(H+1)+".rels").replace(/^\//,"");Wn(e,le)||(le="xl/_rels/workbook."+ne+".rels");var oe=Uc(kn(e,le,!0),le.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(a.xlmeta=Bw(ar(e,Hn(s.metadata[0])),s.metadata[0],a)),(s.people||[]).length>=1&&(a.people=m4(ar(e,Hn(s.people[0])),a)),oe&&(oe=r8(oe,E.Sheets));var m=ar(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(F=0;F!=A.Worksheets;++F){var Se="sheet";if(oe&&oe[F]?(K="xl/"+oe[F][1].replace(/[\/]?xl\//,""),Wn(e,K)||(K=oe[F][1]),Wn(e,K)||(K=le.replace(/_rels\/.*$/,"")+oe[F][1]),Se=oe[F][2]):(K="xl/worksheets/sheet"+(F+1-m)+"."+ne,K=K.replace(/sheet0\./,"sheet.")),M=K.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),a&&a.sheets!=null)switch(typeof a.sheets){case"number":if(F!=a.sheets)continue e;break;case"string":if(A.SheetNames[F].toLowerCase()!=a.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(a.sheets)){for(var ue=!1,Pe=0;Pe!=a.sheets.length;++Pe)typeof a.sheets[Pe]=="number"&&a.sheets[Pe]==F&&(ue=1),typeof a.sheets[Pe]=="string"&&a.sheets[Pe].toLowerCase()==A.SheetNames[F].toLowerCase()&&(ue=1);if(!ue)continue e}}n8(e,K,M,A.SheetNames[F],F,z,f,Se,a,E,g,h)}return N={Directory:s,Workbook:E,Props:A,Custprops:w,Deps:k,Sheets:f,SheetNames:A.SheetNames,Strings:Hc,Styles:h,Themes:g,SSF:wa(mt)},a&&a.bookFiles&&(e.files?(N.keys=i,N.files=e.files):(N.keys=[],N.files={},e.FullPaths.forEach(function(et,ke){et=et.replace(/^Root Entry[\/]/,""),N.keys.push(et),N.files[et]=e.FileIndex[ke]}))),a&&a.bookVBA&&(s.vba.length>0?N.vbaraw=ar(e,Hn(s.vba[0]),!0):s.defaults&&s.defaults.bin===_4&&(N.vbaraw=ar(e,"xl/vbaProject.bin",!0))),N}function s8(e,a){var t=a||{},i="Workbook",s=ht.find(e,i);try{if(i="/!DataSpaces/Version",s=ht.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(BA(s.content),i="/!DataSpaces/DataSpaceMap",s=ht.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);var c=LA(s.content);if(c.length!==1||c[0].comps.length!==1||c[0].comps[0].t!==0||c[0].name!=="StrongEncryptionDataSpace"||c[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=ht.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);var f=PA(s.content);if(f.length!=1||f[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=ht.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);UA(s.content)}catch{}if(i="/EncryptionInfo",s=ht.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);var p=HA(s.content);if(i="/EncryptedPackage",s=ht.find(e,i),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(p[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(p[1],s.content,t.password||"",t);if(p[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(p[1],s.content,t.password||"",t);throw new Error("File is password-protected")}function l8(e,a){return a.bookType=="ods"?Xv(e,a):a.bookType=="numbers"?t8(e,a):a.bookType=="xlsb"?o8(e,a):c8(e,a)}function o8(e,a){Do=1024,e&&!e.SSF&&(e.SSF=wa(mt)),e&&e.SSF&&(Uo(),of(e.SSF),a.revssf=df(e.SSF),a.revssf[e.SSF[65535]]=0,a.ssf=e.SSF),a.rels={},a.wbrels={},a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,$c?a.revStrings=new Map:(a.revStrings={},a.revStrings.foo=[],delete a.revStrings.foo);var t=a.bookType=="xlsb"?"bin":"xml",i=Ev.indexOf(a.bookType)>-1,s=fh();Ch(a=a||{});var c=Qp(),f="",p=0;if(a.cellXfs=[],al(a.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),f="docProps/core.xml",Ft(c,f,Ly(e.Props,a)),s.coreprops.push(f),da(a.rels,2,f,Bt.CORE_PROPS),f="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var g=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&g.push(e.SheetNames[h]);e.Props.SheetNames=g}for(e.Props.Worksheets=e.Props.SheetNames.length,Ft(c,f,Uy(e.Props)),s.extprops.push(f),da(a.rels,3,f,Bt.EXT_PROPS),e.Custprops!==e.Props&&Ua(e.Custprops||{}).length>0&&(f="docProps/custom.xml",Ft(c,f,Hy(e.Custprops)),s.custprops.push(f),da(a.rels,4,f,Bt.CUST_PROPS)),p=1;p<=e.SheetNames.length;++p){var E={"!id":{}},A=e.Sheets[e.SheetNames[p-1]],_=(A||{})["!type"]||"sheet";if(f="xl/worksheets/sheet"+p+"."+t,Ft(c,f,Lw(p-1,f,a,e,E)),s.sheets.push(f),da(a.wbrels,-1,"worksheets/sheet"+p+"."+t,Bt.WS[0]),A){var w=A["!comments"],N=!1,k="";w&&w.length>0&&(k="xl/comments"+p+"."+t,Ft(c,k,Uw(w,k)),s.comments.push(k),da(E,-1,"../comments"+p+"."+t,Bt.CMNT),N=!0),A["!legacy"]&&N&&Ft(c,"xl/drawings/vmlDrawing"+p+".vml",bv(p,A["!comments"])),delete A["!comments"],delete A["!legacy"]}E["!id"].rId1&&Ft(c,Jc(f),Oo(E))}return a.Strings!=null&&a.Strings.length>0&&(f="xl/sharedStrings."+t,Ft(c,f,zw(a.Strings,f,a)),s.strs.push(f),da(a.wbrels,-1,"sharedStrings."+t,Bt.SST)),f="xl/workbook."+t,Ft(c,f,Mw(e,f)),s.workbooks.push(f),da(a.rels,1,f,Bt.WB),f="xl/theme/theme1.xml",Ft(c,f,mh(e.Themes,a)),s.themes.push(f),da(a.wbrels,-1,"theme/theme1.xml",Bt.THEME),f="xl/styles."+t,Ft(c,f,Pw(e,f,a)),s.styles.push(f),da(a.wbrels,-1,"styles."+t,Bt.STY),e.vbaraw&&i&&(f="xl/vbaProject.bin",Ft(c,f,e.vbaraw),s.vba.push(f),da(a.wbrels,-1,"vbaProject.bin",Bt.VBA)),f="xl/metadata."+t,Ft(c,f,Hw(f)),s.metadata.push(f),da(a.wbrels,-1,"metadata."+t,Bt.XLMETA),Ft(c,"[Content_Types].xml",Iy(s,a)),Ft(c,"_rels/.rels",Oo(a.rels)),Ft(c,"xl/_rels/workbook."+t+".rels",Oo(a.wbrels)),delete a.revssf,delete a.ssf,c}function c8(e,a){Do=1024,e&&!e.SSF&&(e.SSF=wa(mt)),e&&e.SSF&&(Uo(),of(e.SSF),a.revssf=df(e.SSF),a.revssf[e.SSF[65535]]=0,a.ssf=e.SSF),a.rels={},a.wbrels={},a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,$c?a.revStrings=new Map:(a.revStrings={},a.revStrings.foo=[],delete a.revStrings.foo);var t="xml",i=Ev.indexOf(a.bookType)>-1,s=fh();Ch(a=a||{});var c=Qp(),f="",p=0;if(a.cellXfs=[],al(a.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),f="docProps/core.xml",Ft(c,f,Ly(e.Props,a)),s.coreprops.push(f),da(a.rels,2,f,Bt.CORE_PROPS),f="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var g=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&g.push(e.SheetNames[h]);e.Props.SheetNames=g}e.Props.Worksheets=e.Props.SheetNames.length,Ft(c,f,Uy(e.Props)),s.extprops.push(f),da(a.rels,3,f,Bt.EXT_PROPS),e.Custprops!==e.Props&&Ua(e.Custprops||{}).length>0&&(f="docProps/custom.xml",Ft(c,f,Hy(e.Custprops)),s.custprops.push(f),da(a.rels,4,f,Bt.CUST_PROPS));var E=["SheetJ5"];for(a.tcid=0,p=1;p<=e.SheetNames.length;++p){var A={"!id":{}},_=e.Sheets[e.SheetNames[p-1]],w=(_||{})["!type"]||"sheet";if(f="xl/worksheets/sheet"+p+"."+t,Ft(c,f,jv(p-1,a,e,A)),s.sheets.push(f),da(a.wbrels,-1,"worksheets/sheet"+p+"."+t,Bt.WS[0]),_){var N=_["!comments"],k=!1,F="";if(N&&N.length>0){var z=!1;N.forEach(function(K){K[1].forEach(function(M){M.T==!0&&(z=!0)})}),z&&(F="xl/threadedComments/threadedComment"+p+"."+t,Ft(c,F,x4(N,E,a)),s.threadedcomments.push(F),da(A,-1,"../threadedComments/threadedComment"+p+"."+t,Bt.TCMNT)),F="xl/comments"+p+"."+t,Ft(c,F,Sv(N)),s.comments.push(F),da(A,-1,"../comments"+p+"."+t,Bt.CMNT),k=!0}_["!legacy"]&&k&&Ft(c,"xl/drawings/vmlDrawing"+p+".vml",bv(p,_["!comments"])),delete _["!comments"],delete _["!legacy"]}A["!id"].rId1&&Ft(c,Jc(f),Oo(A))}return a.Strings!=null&&a.Strings.length>0&&(f="xl/sharedStrings."+t,Ft(c,f,ov(a.Strings,a)),s.strs.push(f),da(a.wbrels,-1,"sharedStrings."+t,Bt.SST)),f="xl/workbook."+t,Ft(c,f,Lv(e)),s.workbooks.push(f),da(a.rels,1,f,Bt.WB),f="xl/theme/theme1.xml",Ft(c,f,mh(e.Themes,a)),s.themes.push(f),da(a.wbrels,-1,"theme/theme1.xml",Bt.THEME),f="xl/styles."+t,Ft(c,f,xv(e,a)),s.styles.push(f),da(a.wbrels,-1,"styles."+t,Bt.STY),e.vbaraw&&i&&(f="xl/vbaProject.bin",Ft(c,f,e.vbaraw),s.vba.push(f),da(a.wbrels,-1,"vbaProject.bin",Bt.VBA)),f="xl/metadata."+t,Ft(c,f,vv()),s.metadata.push(f),da(a.wbrels,-1,"metadata."+t,Bt.XLMETA),E.length>1&&(f="xl/persons/person.xml",Ft(c,f,y4(E)),s.people.push(f),da(a.wbrels,-1,"persons/person.xml",Bt.PEOPLE)),Ft(c,"[Content_Types].xml",Iy(s,a)),Ft(c,"_rels/.rels",Oo(a.rels)),Ft(c,"xl/_rels/workbook."+t+".rels",Oo(a.wbrels)),delete a.revssf,delete a.ssf,c}function kh(e,a){var t="";switch((a||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=wn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(a&&a.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function d8(e,a){return ht.find(e,"EncryptedPackage")?s8(e,a):Hv(e,a)}function f8(e,a){var t,i=e,s=a||{};return s.type||(s.type=It&&Buffer.isBuffer(e)?"buffer":"base64"),t=dy(i,s),i8(t,s)}function Kv(e,a){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return zp(e.slice(t),a);default:break e}return Lo.to_workbook(e,a)}function u8(e,a){var t="",i=kh(e,a);switch(a.type){case"base64":t=wn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=Pl(e);break;default:throw new Error("Unrecognized type "+a.type)}return i[0]==239&&i[1]==187&&i[2]==191&&(t=xa(t)),a.type="binary",Kv(t,a)}function p8(e,a){var t=e;return a.type=="base64"&&(t=wn(t)),t=Wc.utils.decode(1200,t.slice(2),"str"),a.type="binary",Kv(t,a)}function h8(e){return e.match(/[^\x00-\x7F]/)?Ni(e):e}function Np(e,a,t,i){return i?(t.type="string",Lo.to_workbook(e,t)):Lo.to_workbook(a,t)}function nf(e,a){Wp();var t=a||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return nf(new Uint8Array(e),(t=wa(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var i=e,s=[0,0,0,0],c=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Bo={},t.dateNF&&(Bo.dateNF=t.dateNF),t.type||(t.type=It&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=It?"buffer":"binary",i=oS(e),typeof Uint8Array<"u"&&!It&&(t.type="array")),t.type=="string"&&(c=!0,t.type="binary",t.codepage=65001,i=h8(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var f=new ArrayBuffer(3),p=new Uint8Array(f);if(p.foo="bar",!p.foo)return t=wa(t),t.type="array",nf(Vp(i),t)}switch((s=kh(i,t))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return d8(ht.read(i,t),t);break;case 9:if(s[1]<=8)return Hv(i,t);break;case 60:return zp(i,t);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return vA(i,t);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return sv.to_workbook(i,t);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?f8(i,t):Np(e,i,t,c);case 239:return s[3]===60?zp(i,t):Np(e,i,t,c);case 255:if(s[1]===254)return p8(i,t);if(s[1]===0&&s[2]===2&&s[3]===0)return Bl.to_workbook(i,t);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Bl.to_workbook(i,t);break;case 3:case 131:case 139:case 140:return Pp.to_workbook(i,t);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return pv.to_workbook(i,t);break;case 10:case 13:case 32:return u8(i,t);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return yA.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Pp.to_workbook(i,t):Np(e,i,t,c)}function Qv(e,a){switch(a.type){case"base64":case"binary":break;case"buffer":case"array":a.type="";break;case"file":return s0(a.file,ht.write(e,{type:It?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+a.bookType+"' files");default:throw new Error("Unrecognized type "+a.type)}return ht.write(e,a)}function g8(e,a){var t=wa(a||{}),i=l8(e,t);return x8(i,t)}function x8(e,a){var t={},i=It?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(a.compression&&(t.compression="DEFLATE"),a.password)t.type=i;else switch(a.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+a.bookType+"' files");case"buffer":case"file":t.type=i;break;default:throw new Error("Unrecognized type "+a.type)}var s=e.FullPaths?ht.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!a.compression}):e.generate(t);if(typeof Deno<"u"&&typeof s=="string"){if(a.type=="binary"||a.type=="base64")return s;s=new Uint8Array(lf(s))}return a.password&&typeof encrypt_agile<"u"?Qv(encrypt_agile(s,a.password),a):a.type==="file"?s0(a.file,s):a.type=="string"?xa(s):s}function m8(e,a){var t=a||{},i=h6(e,t);return Qv(i,t)}function Ri(e,a,t){t||(t="");var i=t+e;switch(a.type){case"base64":return Vc(Ni(i));case"binary":return Ni(i);case"string":return e;case"file":return s0(a.file,i,"utf8");case"buffer":return It?ss(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):Ri(i,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+a.type)}function y8(e,a){switch(a.type){case"base64":return Vc(e);case"binary":return e;case"string":return e;case"file":return s0(a.file,e,"binary");case"buffer":return It?ss(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+a.type)}function Gd(e,a){switch(a.type){case"string":case"base64":case"binary":for(var t="",i=0;i<e.length;++i)t+=String.fromCharCode(e[i]);return a.type=="base64"?Vc(t):a.type=="string"?xa(t):t;case"file":return s0(a.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+a.type)}}function Jv(e,a){Wp(),dw(e);var t=wa(a||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var i=Jv(e,t);return t.type="array",lf(i)}var s=0;if(t.sheet&&(typeof t.sheet=="number"?s=t.sheet:s=e.SheetNames.indexOf(t.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Ri(l6(e,t),t);case"slk":case"sylk":return Ri(iv.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"htm":case"html":return Ri(Yv(e.Sheets[e.SheetNames[s]],t),t);case"txt":return y8(Zv(e.Sheets[e.SheetNames[s]],t),t);case"csv":return Ri(wh(e.Sheets[e.SheetNames[s]],t),t,"\uFEFF");case"dif":return Ri(sv.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"dbf":return Gd(Pp.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"prn":return Ri(Lo.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"rtf":return Ri(pv.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"eth":return Ri(lv.from_sheet(e.Sheets[e.SheetNames[s]],t),t);case"fods":return Ri(Xv(e,t),t);case"wk1":return Gd(Bl.sheet_to_wk1(e.Sheets[e.SheetNames[s]],t),t);case"wk3":return Gd(Bl.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Gd($v(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),m8(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return g8(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function v8(e,a,t,i,s,c,f,p){var g=Xa(t),h=p.defval,E=p.raw||!Object.prototype.hasOwnProperty.call(p,"raw"),A=!0,_=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:t,enumerable:!1})}catch{_.__rowNum__=t}else _.__rowNum__=t;if(!f||e[t])for(var w=a.s.c;w<=a.e.c;++w){var N=f?e[t][w]:e[i[w]+g];if(N===void 0||N.t===void 0){if(h===void 0)continue;c[w]!=null&&(_[c[w]]=h);continue}var k=N.v;switch(N.t){case"z":if(k==null)break;continue;case"e":k=k==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+N.t)}if(c[w]!=null){if(k==null)if(N.t=="e"&&k===null)_[c[w]]=null;else if(h!==void 0)_[c[w]]=h;else if(E&&k===null)_[c[w]]=null;else continue;else _[c[w]]=E&&(N.t!=="n"||N.t==="n"&&p.rawNumbers!==!1)?k:is(N,k,p);k!=null&&(A=!1)}}return{row:_,isempty:A}}function sf(e,a){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},i=0,s=1,c=[],f=0,p="",g={s:{r:0,c:0},e:{r:0,c:0}},h=a||{},E=h.range!=null?h.range:e["!ref"];switch(h.header===1?i=1:h.header==="A"?i=2:Array.isArray(h.header)?i=3:h.header==null&&(i=0),typeof E){case"string":g=Qt(E);break;case"number":g=Qt(e["!ref"]),g.s.r=E;break;default:g=E}i>0&&(s=0);var A=Xa(g.s.r),_=[],w=[],N=0,k=0,F=Array.isArray(e),z=g.s.r,K=0,M={};F&&!e[z]&&(e[z]=[]);var ie=h.skipHidden&&e["!cols"]||[],se=h.skipHidden&&e["!rows"]||[];for(K=g.s.c;K<=g.e.c;++K)if(!(ie[K]||{}).hidden)switch(_[K]=ja(K),t=F?e[z][K]:e[_[K]+A],i){case 1:c[K]=K-g.s.c;break;case 2:c[K]=_[K];break;case 3:c[K]=h.header[K-g.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),p=f=is(t,null,h),k=M[f]||0,!k)M[f]=1;else{do p=f+"_"+k++;while(M[p]);M[f]=k,M[p]=1}c[K]=p}for(z=g.s.r+s;z<=g.e.r;++z)if(!(se[z]||{}).hidden){var ne=v8(e,g,z,_,i,c,F,h);(ne.isempty===!1||(i===1?h.blankrows!==!1:h.blankrows))&&(w[N++]=ne.row)}return w.length=N,w}var $m=/"/g;function b8(e,a,t,i,s,c,f,p){for(var g=!0,h=[],E="",A=Xa(t),_=a.s.c;_<=a.e.c;++_)if(i[_]){var w=p.dense?(e[t]||[])[_]:e[i[_]+A];if(w==null)E="";else if(w.v!=null){g=!1,E=""+(p.rawNumbers&&w.t=="n"?w.v:is(w,null,p));for(var N=0,k=0;N!==E.length;++N)if((k=E.charCodeAt(N))===s||k===c||k===34||p.forceQuotes){E='"'+E.replace($m,'""')+'"';break}E=="ID"&&(E='"ID"')}else w.f!=null&&!w.F?(g=!1,E="="+w.f,E.indexOf(",")>=0&&(E='"'+E.replace($m,'""')+'"')):E="";h.push(E)}return p.blankrows===!1&&g?null:h.join(f)}function wh(e,a){var t=[],i=a??{};if(e==null||e["!ref"]==null)return"";var s=Qt(e["!ref"]),c=i.FS!==void 0?i.FS:",",f=c.charCodeAt(0),p=i.RS!==void 0?i.RS:`
`,g=p.charCodeAt(0),h=new RegExp((c=="|"?"\\|":c)+"+$"),E="",A=[];i.dense=Array.isArray(e);for(var _=i.skipHidden&&e["!cols"]||[],w=i.skipHidden&&e["!rows"]||[],N=s.s.c;N<=s.e.c;++N)(_[N]||{}).hidden||(A[N]=ja(N));for(var k=0,F=s.s.r;F<=s.e.r;++F)(w[F]||{}).hidden||(E=b8(e,s,F,A,f,g,c,i),E!=null&&(i.strip&&(E=E.replace(h,"")),(E||i.blankrows!==!1)&&t.push((k++?p:"")+E)));return delete i.dense,t.join("")}function Zv(e,a){a||(a={}),a.FS="	",a.RS=`
`;var t=wh(e,a);return t}function S8(e){var a="",t,i="";if(e==null||e["!ref"]==null)return[];var s=Qt(e["!ref"]),c="",f=[],p,g=[],h=Array.isArray(e);for(p=s.s.c;p<=s.e.c;++p)f[p]=ja(p);for(var E=s.s.r;E<=s.e.r;++E)for(c=Xa(E),p=s.s.c;p<=s.e.c;++p)if(a=f[p]+c,t=h?(e[E]||[])[p]:e[a],i="",t!==void 0){if(t.F!=null){if(a=t.F,!t.f)continue;i=t.f,a.indexOf(":")==-1&&(a=a+":"+a)}if(t.f!=null)i=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)i=""+t.v;else if(t.t=="b")i=t.v?"TRUE":"FALSE";else if(t.w!==void 0)i="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?i="'"+t.v:i=""+t.v}}g[g.length]=a+"="+i}return g}function eb(e,a,t){var i=t||{},s=+!i.skipHeader,c=e||{},f=0,p=0;if(c&&i.origin!=null)if(typeof i.origin=="number")f=i.origin;else{var g=typeof i.origin=="string"?Oa(i.origin):i.origin;f=g.r,p=g.c}var h,E={s:{c:0,r:0},e:{c:p,r:f+a.length-1+s}};if(c["!ref"]){var A=Qt(c["!ref"]);E.e.c=Math.max(E.e.c,A.e.c),E.e.r=Math.max(E.e.r,A.e.r),f==-1&&(f=A.e.r+1,E.e.r=f+a.length-1+s)}else f==-1&&(f=0,E.e.r=a.length-1+s);var _=i.header||[],w=0;a.forEach(function(k,F){Ua(k).forEach(function(z){(w=_.indexOf(z))==-1&&(_[w=_.length]=z);var K=k[z],M="z",ie="",se=bt({c:p+w,r:f+F+s});h=i0(c,se),K&&typeof K=="object"&&!(K instanceof Date)?c[se]=K:(typeof K=="number"?M="n":typeof K=="boolean"?M="b":typeof K=="string"?M="s":K instanceof Date?(M="d",i.cellDates||(M="n",K=fr(K)),ie=i.dateNF||mt[14]):K===null&&i.nullError&&(M="e",K=0),h?(h.t=M,h.v=K,delete h.w,delete h.R,ie&&(h.z=ie)):c[se]=h={t:M,v:K},ie&&(h.z=ie))})}),E.e.c=Math.max(E.e.c,p+_.length-1);var N=Xa(f);if(s)for(w=0;w<_.length;++w)c[ja(w+p)+N]={t:"s",v:_[w]};return c["!ref"]=wt(E),c}function E8(e,a){return eb(null,e,a)}function i0(e,a,t){if(typeof a=="string"){if(Array.isArray(e)){var i=Oa(a);return e[i.r]||(e[i.r]=[]),e[i.r][i.c]||(e[i.r][i.c]={t:"z"})}return e[a]||(e[a]={t:"z"})}return typeof a!="number"?i0(e,bt(a)):i0(e,bt({r:a,c:t||0}))}function T8(e,a){if(typeof a=="number"){if(a>=0&&e.SheetNames.length>a)return a;throw new Error("Cannot find sheet # "+a)}else if(typeof a=="string"){var t=e.SheetNames.indexOf(a);if(t>-1)return t;throw new Error("Cannot find sheet name |"+a+"|")}else throw new Error("Cannot find sheet |"+a+"|")}function Rh(){return{SheetNames:[],Sheets:{}}}function Nh(e,a,t,i){var s=1;if(!t)for(;s<=65535&&e.SheetNames.indexOf(t="Sheet"+s)!=-1;++s,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&e.SheetNames.indexOf(t)>=0){var c=t.match(/(^.*?)(\d+)$/);s=c&&+c[2]||0;var f=c&&c[1]||t;for(++s;s<=65535&&e.SheetNames.indexOf(t=f+s)!=-1;++s);}if(Mv(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=a,t}function A8(e,a,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var i=T8(e,a);switch(e.Workbook.Sheets[i]||(e.Workbook.Sheets[i]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[i].Hidden=t}function _8(e,a){return e.z=a,e}function tb(e,a,t){return a?(e.l={Target:a},t&&(e.l.Tooltip=t)):delete e.l,e}function C8(e,a,t){return tb(e,"#"+a,t)}function k8(e,a,t){e.c||(e.c=[]),e.c.push({t:a,a:t||"SheetJS"})}function w8(e,a,t,i){for(var s=typeof a!="string"?a:Qt(a),c=typeof a=="string"?a:wt(a),f=s.s.r;f<=s.e.r;++f)for(var p=s.s.c;p<=s.e.c;++p){var g=i0(e,f,p);g.t="n",g.F=c,delete g.v,f==s.s.r&&p==s.s.c&&(g.f=t,i&&(g.D=!0))}return e}var Sa={encode_col:ja,encode_row:Xa,encode_cell:bt,encode_range:wt,decode_col:ih,decode_row:nh,split_cell:zS,decode_cell:Oa,decode_range:un,format_cell:is,sheet_add_aoa:wy,sheet_add_json:eb,sheet_add_dom:Gv,aoa_to_sheet:Ho,json_to_sheet:E8,table_to_sheet:Wv,table_to_book:B6,sheet_to_csv:wh,sheet_to_txt:Zv,sheet_to_json:sf,sheet_to_html:Yv,sheet_to_formulae:S8,sheet_to_row_object_array:sf,sheet_get_cell:i0,book_new:Rh,book_append_sheet:Nh,book_set_sheet_visibility:A8,cell_set_number_format:_8,cell_set_hyperlink:tb,cell_set_internal_link:C8,cell_add_comment:k8,sheet_set_array_formula:w8,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Ym={SDN_BHD:{name:"Sdn Bhd (Private Limited)",standard:"MPERS",fullStandard:"Malaysian Private Entities Reporting Standard",taxInfo:"17% (RM500k) / 24% (>RM500k)",calcTax:e=>e<=0?0:e<=5e5?Math.round(e*.17):Math.round(5e5*.17+(e-5e5)*.24)},ENTERPRISE:{name:"Enterprise (Sole Prop/Partnership)",standard:"MPERS-Micro",fullStandard:"MPERS for Micro Entities",taxInfo:"Personal Tax Rates (0-28%)",calcTax:e=>{if(e<=0)return 0;let a=0,t=e;const i=[[5e3,0],[15e3,.01],[15e3,.03],[15e3,.06],[2e4,.11],[3e4,.19],[15e4,.25],[15e4,.26],[1/0,.28]];for(const[s,c]of i){if(t<=0)break;const f=Math.min(t,s);a+=f*c,t-=s}return Math.round(a)}},BERHAD:{name:"Berhad (Public Listed)",standard:"MFRS",fullStandard:"Malaysian Financial Reporting Standards (IFRS)",taxInfo:"24% Flat Rate",calcTax:e=>e<=0?0:Math.round(e*.24)}},Gm={1e3:{name:"Property, Plant & Equipment",type:"nca",fsId:"PPE"},1010:{name:"Land & Buildings",type:"nca",fsId:"PPE",subAccount:!0},1020:{name:"Plant & Machinery",type:"nca",fsId:"PPE",subAccount:!0},1030:{name:"Motor Vehicles",type:"nca",fsId:"PPE",subAccount:!0},1040:{name:"Office Equipment",type:"nca",fsId:"PPE",subAccount:!0},1050:{name:"Computer Equipment",type:"nca",fsId:"PPE",subAccount:!0},1060:{name:"Furniture & Fittings",type:"nca",fsId:"PPE",subAccount:!0},1070:{name:"Renovation",type:"nca",fsId:"PPE",subAccount:!0},1100:{name:"Accumulated Depreciation",type:"nca_contra",fsId:"ACC_DEP"},1110:{name:"Acc Dep - Land & Buildings",type:"nca_contra",fsId:"ACC_DEP",subAccount:!0},1120:{name:"Acc Dep - Plant & Machinery",type:"nca_contra",fsId:"ACC_DEP",subAccount:!0},1130:{name:"Acc Dep - Motor Vehicles",type:"nca_contra",fsId:"ACC_DEP",subAccount:!0},1140:{name:"Acc Dep - Office Equipment",type:"nca_contra",fsId:"ACC_DEP",subAccount:!0},1150:{name:"Acc Dep - Computer Equipment",type:"nca_contra",fsId:"ACC_DEP",subAccount:!0},1160:{name:"Acc Dep - Furniture & Fittings",type:"nca_contra",fsId:"ACC_DEP",subAccount:!0},1170:{name:"Acc Dep - Renovation",type:"nca_contra",fsId:"ACC_DEP",subAccount:!0},1200:{name:"Intangible Assets",type:"nca",fsId:"INTANGIBLES"},1300:{name:"Investments",type:"nca",fsId:"INVESTMENTS"},1500:{name:"Inventory",type:"ca",fsId:"INVENTORY"},1510:{name:"Raw Materials",type:"ca",fsId:"INVENTORY",subAccount:!0},1520:{name:"Work in Progress",type:"ca",fsId:"INVENTORY",subAccount:!0},1530:{name:"Finished Goods",type:"ca",fsId:"INVENTORY",subAccount:!0},1600:{name:"Trade Receivables",type:"ca",fsId:"TRADE_RECEIVABLES"},1610:{name:"Trade Debtors Control",type:"ca",fsId:"TRADE_RECEIVABLES",subAccount:!0},1620:{name:"Allowance for Doubtful Debts",type:"ca_contra",fsId:"TRADE_RECEIVABLES",subAccount:!0},1700:{name:"Other Receivables",type:"ca",fsId:"OTHER_RECEIVABLES"},1710:{name:"Deposits",type:"ca",fsId:"OTHER_RECEIVABLES",subAccount:!0},1720:{name:"Prepayments",type:"ca",fsId:"OTHER_RECEIVABLES",subAccount:!0},1730:{name:"GST Input Tax",type:"ca",fsId:"OTHER_RECEIVABLES",subAccount:!0},1740:{name:"Staff Advances",type:"ca",fsId:"OTHER_RECEIVABLES",subAccount:!0},1800:{name:"Tax Prepaid",type:"ca",fsId:"TAX_PREPAID"},1900:{name:"Cash & Bank",type:"ca",fsId:"CASH_BANK"},1910:{name:"Cash in Hand",type:"ca",fsId:"CASH_BANK",subAccount:!0},1920:{name:"Bank - Current Account",type:"ca",fsId:"CASH_BANK",subAccount:!0},1930:{name:"Bank - Savings Account",type:"ca",fsId:"CASH_BANK",subAccount:!0},1940:{name:"Fixed Deposits",type:"ca",fsId:"CASH_BANK",subAccount:!0},2e3:{name:"Long Term Borrowings",type:"ncl",fsId:"LONG_TERM_LOAN"},2010:{name:"Term Loan",type:"ncl",fsId:"LONG_TERM_LOAN",subAccount:!0},2020:{name:"Hire Purchase",type:"ncl",fsId:"LONG_TERM_LOAN",subAccount:!0},2100:{name:"Deferred Tax Liability",type:"ncl",fsId:"DEFERRED_TAX"},2500:{name:"Short Term Borrowings",type:"cl",fsId:"SHORT_TERM_LOAN"},2510:{name:"Bank Overdraft",type:"cl",fsId:"SHORT_TERM_LOAN",subAccount:!0},2520:{name:"Short Term Loan",type:"cl",fsId:"SHORT_TERM_LOAN",subAccount:!0},2600:{name:"Trade Payables",type:"cl",fsId:"TRADE_PAYABLES"},2610:{name:"Trade Creditors Control",type:"cl",fsId:"TRADE_PAYABLES",subAccount:!0},2700:{name:"Other Payables",type:"cl",fsId:"OTHER_PAYABLES"},2710:{name:"Accrued Expenses",type:"cl",fsId:"OTHER_PAYABLES",subAccount:!0},2720:{name:"GST Output Tax",type:"cl",fsId:"OTHER_PAYABLES",subAccount:!0},2730:{name:"Deposits Received",type:"cl",fsId:"OTHER_PAYABLES",subAccount:!0},2800:{name:"Tax Payable",type:"cl",fsId:"TAX_PAYABLE"},2810:{name:"Income Tax Payable",type:"cl",fsId:"TAX_PAYABLE",subAccount:!0},2820:{name:"GST/SST Payable",type:"cl",fsId:"GST_SST_PAYABLE",subAccount:!0},2900:{name:"Directors Account",type:"cl",fsId:"OTHER_PAYABLES"},3e3:{name:"Share Capital",type:"equity",fsId:"SHARE_CAPITAL"},3010:{name:"Ordinary Shares",type:"equity",fsId:"SHARE_CAPITAL",subAccount:!0},3020:{name:"Preference Shares",type:"equity",fsId:"SHARE_CAPITAL",subAccount:!0},3100:{name:"Retained Profits",type:"equity",fsId:"RETAINED_PROFITS"},3200:{name:"Reserves",type:"equity",fsId:"RESERVES"},3900:{name:"Drawings",type:"equity_contra",fsId:"DRAWINGS"},4e3:{name:"Sales Revenue",type:"revenue",fsId:"SALES"},4010:{name:"Sales - Products",type:"revenue",fsId:"SALES",subAccount:!0},4020:{name:"Sales - Services",type:"revenue",fsId:"SERVICE_REVENUE",subAccount:!0},4100:{name:"Other Income",type:"other_income",fsId:"OTHER_INCOME"},4110:{name:"Interest Income",type:"other_income",fsId:"INTEREST_INC",subAccount:!0},4120:{name:"Dividend Income",type:"other_income",fsId:"DIVIDEND_INC",subAccount:!0},4130:{name:"Rental Income",type:"other_income",fsId:"RENTAL_INC",subAccount:!0},4140:{name:"Gain on Disposal",type:"other_income",fsId:"OTHER_INCOME",subAccount:!0},4150:{name:"Forex Gain",type:"other_income",fsId:"OTHER_INCOME",subAccount:!0},5e3:{name:"Cost of Sales",type:"cogs",fsId:"PURCHASE"},5010:{name:"Purchases",type:"cogs",fsId:"PURCHASE",subAccount:!0},5020:{name:"Direct Labour",type:"cogs",fsId:"DIRECT_COSTS",subAccount:!0},5030:{name:"Freight In",type:"cogs",fsId:"FREIGHT_IN",subAccount:!0},5040:{name:"Import Duties",type:"cogs",fsId:"DIRECT_COSTS",subAccount:!0},5050:{name:"Subcontractor Costs",type:"cogs",fsId:"DIRECT_COSTS",subAccount:!0},6e3:{name:"Staff Costs",type:"expense",fsId:"SALARY",group:"Staff"},6010:{name:"Salaries & Wages",type:"expense",fsId:"SALARY",subAccount:!0,group:"Staff"},6020:{name:"EPF - Employer",type:"expense",fsId:"EPF",subAccount:!0,group:"Staff"},6030:{name:"SOCSO - Employer",type:"expense",fsId:"SOCSO",subAccount:!0,group:"Staff"},6040:{name:"EIS - Employer",type:"expense",fsId:"SOCSO",subAccount:!0,group:"Staff"},6050:{name:"HRDF Levy",type:"expense",fsId:"HRDF",subAccount:!0,group:"Staff"},6060:{name:"Staff Benefits",type:"expense",fsId:"SALARY",subAccount:!0,group:"Staff"},6100:{name:"Rental Expenses",type:"expense",fsId:"RENT",group:"Premises"},6110:{name:"Office Rental",type:"expense",fsId:"RENT",subAccount:!0,group:"Premises"},6120:{name:"Warehouse Rental",type:"expense",fsId:"RENT",subAccount:!0,group:"Premises"},6200:{name:"Utilities",type:"expense",fsId:"UTILITIES",group:"Premises"},6210:{name:"Electricity",type:"expense",fsId:"UTILITIES",subAccount:!0,group:"Premises"},6220:{name:"Water",type:"expense",fsId:"UTILITIES",subAccount:!0,group:"Premises"},6230:{name:"Gas",type:"expense",fsId:"UTILITIES",subAccount:!0,group:"Premises"},6300:{name:"Telephone & Internet",type:"expense",fsId:"TELEPHONE",group:"Premises"},6400:{name:"Marketing & Advertising",type:"expense",fsId:"ADVERTISING",group:"Marketing"},6410:{name:"Advertising",type:"expense",fsId:"ADVERTISING",subAccount:!0,group:"Marketing"},6420:{name:"Digital Marketing",type:"expense",fsId:"ADVERTISING",subAccount:!0,group:"Marketing"},6500:{name:"Entertainment",type:"expense",fsId:"ENTERTAINMENT",group:"Marketing"},6600:{name:"Travelling",type:"expense",fsId:"TRAVEL",group:"Marketing"},6610:{name:"Local Travel",type:"expense",fsId:"TRAVEL",subAccount:!0,group:"Marketing"},6620:{name:"Overseas Travel",type:"expense",fsId:"TRAVEL",subAccount:!0,group:"Marketing"},6700:{name:"Professional Fees",type:"expense",fsId:"PROFESSIONAL_FEE",group:"Professional"},6710:{name:"Audit Fee",type:"expense",fsId:"PROFESSIONAL_FEE",subAccount:!0,group:"Professional"},6720:{name:"Accounting Fee",type:"expense",fsId:"PROFESSIONAL_FEE",subAccount:!0,group:"Professional"},6730:{name:"Legal Fee",type:"expense",fsId:"PROFESSIONAL_FEE",subAccount:!0,group:"Professional"},6740:{name:"Secretarial Fee",type:"expense",fsId:"PROFESSIONAL_FEE",subAccount:!0,group:"Professional"},6750:{name:"Tax Agent Fee",type:"expense",fsId:"PROFESSIONAL_FEE",subAccount:!0,group:"Professional"},6800:{name:"License & Subscriptions",type:"expense",fsId:"LICENSE_FEE",group:"Professional"},6900:{name:"Insurance",type:"expense",fsId:"INSURANCE",group:"Professional"},7e3:{name:"Office Supplies",type:"expense",fsId:"OFFICE_SUPPLIES",group:"Office"},7100:{name:"Repairs & Maintenance",type:"expense",fsId:"REPAIR_MAINTENANCE",group:"Office"},7200:{name:"Cleaning & Upkeep",type:"expense",fsId:"CLEANING",group:"Office"},7300:{name:"Depreciation",type:"expense",fsId:"DEPRECIATION",group:"Other"},7310:{name:"Depreciation - Buildings",type:"expense",fsId:"DEPRECIATION",subAccount:!0,group:"Other"},7320:{name:"Depreciation - Plant & Machinery",type:"expense",fsId:"DEPRECIATION",subAccount:!0,group:"Other"},7330:{name:"Depreciation - Motor Vehicles",type:"expense",fsId:"DEPRECIATION",subAccount:!0,group:"Other"},7340:{name:"Depreciation - Office Equipment",type:"expense",fsId:"DEPRECIATION",subAccount:!0,group:"Other"},7350:{name:"Depreciation - Computer Equipment",type:"expense",fsId:"DEPRECIATION",subAccount:!0,group:"Other"},7400:{name:"Bad Debts",type:"expense",fsId:"BAD_DEBT",group:"Other"},7500:{name:"Other Expenses",type:"other_expense",fsId:"OTHER_EXPENSE"},7510:{name:"Forex Loss",type:"other_expense",fsId:"FOREX_LOSS",subAccount:!0},7520:{name:"Loss on Disposal",type:"other_expense",fsId:"OTHER_EXPENSE",subAccount:!0},8e3:{name:"Bank Charges",type:"finance",fsId:"BANK_CHARGES"},8100:{name:"Interest Expense",type:"finance",fsId:"INTEREST_EXP"},8110:{name:"Interest on Term Loan",type:"finance",fsId:"INTEREST_EXP",subAccount:!0},8120:{name:"Interest on Hire Purchase",type:"finance",fsId:"INTEREST_EXP",subAccount:!0},8130:{name:"Interest on Overdraft",type:"finance",fsId:"INTEREST_EXP",subAccount:!0},9e3:{name:"Income Tax Expense",type:"tax",fsId:"TAX_EXPENSE"},9100:{name:"Deferred Tax Expense",type:"tax",fsId:"TAX_EXPENSE",subAccount:!0}},Yt={income:{revenue:[{id:"SALES",label:"Sales Revenue",glCode:"4000",kw:["sales","revenue","service fee","collection","payment received","customer payment","inward","receipt","proceed"]}],cost_of_sales:[{id:"PURCHASE",label:"Purchases",glCode:"5010",kw:["purchase","inventory","stock","goods","supplier","vendor","buy","cost of sales","raw material"]},{id:"FREIGHT_IN",label:"Freight & Delivery",glCode:"5030",kw:["freight in","shipping cost","delivery charge","import","carriage inward"]}],other_income:[{id:"INTEREST_INC",label:"Interest Income",glCode:"4110",kw:["interest income","interest received","interest credit","interest earn","hibah"]},{id:"DIVIDEND_INC",label:"Dividend Income",glCode:"4120",kw:["dividend","dividend income","dividend received"]},{id:"RENTAL_INC",label:"Rental Income",glCode:"4130",kw:["rental income","rent received","tenant","sewa diterima"]},{id:"OTHER_INCOME",label:"Other Income",glCode:"4100",kw:["other income","miscellaneous income","gain on disposal","forex gain","commission income","rebate","refund received"]}],operating_expenses:[{id:"SALARY",label:"Staff Costs",glCode:"6000",kw:["salary","wages","payroll","bonus","staff","employee","gaji","allowance","commission paid"],group:"Staff"},{id:"EPF",label:"EPF Contribution",glCode:"6020",kw:["epf","kwsp","employees provident"],group:"Staff"},{id:"SOCSO",label:"SOCSO/EIS",glCode:"6030",kw:["socso","perkeso","eis","employment insurance"],group:"Staff"},{id:"HRDF",label:"HRDF Levy",glCode:"6050",kw:["hrdf","training levy"],group:"Staff"},{id:"RENT",label:"Rental",glCode:"6100",kw:["rent","lease","tenancy","rental","premises","sewa","office space"],group:"Premises"},{id:"UTILITIES",label:"Utilities",glCode:"6200",kw:["electric","water","gas","utility","utilities","tnb","syabas","indah water","tenaga","sewerage"],group:"Premises"},{id:"TELEPHONE",label:"Telephone & Internet",glCode:"6300",kw:["telephone","phone","mobile","internet","telco","unifi","maxis","celcom","digi","time","broadband","wifi"],group:"Premises"},{id:"ADVERTISING",label:"Advertising & Marketing",glCode:"6400",kw:["advertising","advertisement","ads","marketing","promotion","branding","social media","google ads","facebook","instagram","digital marketing"],group:"Marketing"},{id:"ENTERTAINMENT",label:"Entertainment",glCode:"6500",kw:["entertainment","client meal","business meal","corporate gift","hamper","gift","makan","lunch meeting","dinner"],group:"Marketing"},{id:"TRAVEL",label:"Travelling",glCode:"6600",kw:["travel","travelling","accommodation","hotel","flight","airfare","petrol","toll","parking","grab","uber","transport","mileage"],group:"Marketing"},{id:"PROFESSIONAL_FEE",label:"Professional Fees",glCode:"6700",kw:["professional fee","audit fee","accounting fee","legal fee","consultation","consultant","secretary fee","tax agent","company secretary"],group:"Professional"},{id:"LICENSE_FEE",label:"License & Subscriptions",glCode:"6800",kw:["license","licence","permit","renewal","ssm","registration","subscription","software license"],group:"Professional"},{id:"INSURANCE",label:"Insurance",glCode:"6900",kw:["insurance","takaful","premium","coverage","policy"],group:"Professional"},{id:"OFFICE_SUPPLIES",label:"Office Supplies",glCode:"7000",kw:["office supplies","stationery","printing","toner","cartridge","paper","pen","pantry"],group:"Office"},{id:"REPAIR_MAINTENANCE",label:"Repairs & Maintenance",glCode:"7100",kw:["repair","maintenance","service","fix","servicing","upkeep","baiki"],group:"Office"},{id:"CLEANING",label:"Cleaning",glCode:"7200",kw:["cleaning","cleaner","housekeeping","pest control","waste disposal"],group:"Office"},{id:"DEPRECIATION",label:"Depreciation",glCode:"7300",kw:["depreciation","amortisation","amortization"],group:"Other"},{id:"BAD_DEBT",label:"Bad Debts",glCode:"7400",kw:["bad debt","doubtful debt","write off","impairment","provision"],group:"Other"}],other_expenses:[{id:"FOREX_LOSS",label:"Forex Loss",glCode:"7510",kw:["forex loss","exchange loss","currency loss"]},{id:"OTHER_EXPENSE",label:"Other Expenses",glCode:"7500",kw:["other expense","miscellaneous expense","sundry expense","general expense"]}],finance_costs:[{id:"BANK_CHARGES",label:"Bank Charges",glCode:"8000",kw:["bank charge","bank fee","service charge","annual fee","monthly fee","atm fee","card fee","transaction fee"]},{id:"INTEREST_EXP",label:"Interest Expense",glCode:"8100",kw:["interest expense","interest paid","loan interest","finance charge","overdraft interest"]}],tax:[{id:"TAX_EXPENSE",label:"Tax Expense",glCode:"9000",kw:[]}]},balance:{non_current_assets:[{id:"PPE",label:"Property, Plant & Equipment",glCode:"1000",kw:["equipment","machinery","vehicle","furniture","computer","laptop","printer","asset purchase","renovation","air cond","aircon"],classCode:"FIXED_ASSET"},{id:"INTANGIBLES",label:"Intangible Assets",glCode:"1200",kw:["intangible","software","trademark","patent"]},{id:"INVESTMENTS",label:"Investments",glCode:"1300",kw:["investment","shares","unit trust"]}],current_assets:[{id:"INVENTORY",label:"Inventory",glCode:"1500",kw:[]},{id:"TRADE_RECEIVABLES",label:"Trade Receivables",glCode:"1600",kw:[]},{id:"OTHER_RECEIVABLES",label:"Other Receivables",glCode:"1700",kw:["deposit","prepaid","prepayment","advance"]},{id:"TAX_PREPAID",label:"Tax Prepaid",glCode:"1800",kw:[]},{id:"CASH_BANK",label:"Cash & Bank",glCode:"1900",kw:[]}],non_current_liabilities:[{id:"LONG_TERM_LOAN",label:"Long Term Borrowings",glCode:"2000",kw:["term loan","long term loan","hp","hire purchase"]},{id:"DEFERRED_TAX",label:"Deferred Tax",glCode:"2100",kw:[]}],current_liabilities:[{id:"SHORT_TERM_LOAN",label:"Short Term Borrowings",glCode:"2500",kw:["loan disbursement","loan drawdown","borrowing","financing","instalment","installment","loan repayment"],classCode:"LOAN"},{id:"TRADE_PAYABLES",label:"Trade Payables",glCode:"2600",kw:[]},{id:"OTHER_PAYABLES",label:"Other Payables",glCode:"2700",kw:["accrual","accrued"]},{id:"TAX_PAYABLE",label:"Tax Payable",glCode:"2800",kw:[],classCode:"TAX_PAYMENT"},{id:"GST_SST_PAYABLE",label:"GST/SST Payable",glCode:"2820",kw:["gst payment","sst payment","gst","sst","service tax","sales tax"],classCode:"GST_SST"}],equity:[{id:"SHARE_CAPITAL",label:"Share Capital",glCode:"3000",kw:["capital injection","share capital","director loan","shareholder fund","capital contribution"],classCode:"CAPITAL"},{id:"RETAINED_PROFITS",label:"Retained Profits",glCode:"3100",kw:[]},{id:"CURRENT_YEAR_PROFIT",label:"Current Year Profit/(Loss)",glCode:"3100",kw:[]}]},other:[{id:"DRAWINGS",label:"Drawings",glCode:"3900",kw:["drawings","personal withdrawal","director withdrawal","owner withdrawal"],type:"drawings"},{id:"TRANSFER",label:"Transfer (Internal)",glCode:null,kw:["ibg transfer","interbank giro","internal transfer","own account transfer","transfer to own","transfer from own","self transfer"],type:"transfer"},{id:"CASH_TRANSFER",label:"Cash Transfer (BankCash)",glCode:null,kw:["petty cash","cash withdrawal","cash deposit","atm withdrawal","atm deposit","cash top up","cash topup"],type:"cash_transfer"},{id:"TAX_PAYMENT",label:"Tax Payment",glCode:"2800",kw:["tax payment","lhdn","income tax","cp204","cp500","pcb","mtd"],type:"tax_payment"},{id:"PAY_SUPPLIER",label:"Payment to Supplier",glCode:"2600",kw:["payment to supplier","supplier payment","vendor payment","creditor payment"],type:"pay_supplier"},{id:"PAY_CREDITOR",label:"Payment to Creditor",glCode:"2700",kw:["payment to creditor","creditor","accrual payment"],type:"pay_creditor"},{id:"LOAN_REPAY_ST",label:"Loan Repayment (ST)",glCode:"2500",kw:["loan repayment","loan payment","instalment","installment","monthly repayment","loan instalment"],type:"loan_repay_st"},{id:"LOAN_REPAY_LT",label:"Loan Repayment (LT)",glCode:"2000",kw:["term loan repayment","hp repayment","hire purchase repayment","mortgage payment"],type:"loan_repay_lt"},{id:"LOAN_DRAWDOWN",label:"Loan Drawdown",glCode:"2500",kw:["loan disbursement","loan drawdown","loan proceeds","facility drawdown","od utilization","overdraft"],type:"loan_drawdown"},{id:"RECEIPT_DEBTOR",label:"Receipt from Debtor",glCode:"1600",kw:["receipt from debtor","debtor receipt","customer receipt","collection","received from customer"],type:"receipt_debtor"},{id:"DEPOSIT_RECEIVED",label:"Deposit Received",glCode:"2700",kw:["deposit received","advance received","customer deposit"],type:"deposit_received"},{id:"DUITNOW_OUT",label:"DuitNow (Payment)",glCode:"2600",kw:["duitnow"],type:"duitnow_payment"},{id:"SUSPENSE",label:"Suspense",glCode:"9999",kw:[],type:"suspense"}]},ab={PURCHASES:"PURCHASE",COST_OF_SALES:"PURCHASE",COGS:"PURCHASE",MISC_EXPENSE:"MISCELLANEOUS",OFFICE:"OFFICE_SUPPLIES"},cn={rules:(()=>{const e={};return Yt.income.revenue.forEach(a=>{e[a.id]={kw:a.kw,type:"revenue",label:a.label}}),Yt.income.cost_of_sales.forEach(a=>{e[a.id]={kw:a.kw,type:"cogs",label:a.label}}),Yt.income.other_income.forEach(a=>{e[a.id]={kw:a.kw,type:"other_income",label:a.label}}),Yt.income.operating_expenses.forEach(a=>{e[a.id]={kw:a.kw,type:"expense",label:a.label,group:a.group}}),Yt.income.other_expenses.forEach(a=>{e[a.id]={kw:a.kw,type:"other_expense",label:a.label}}),Yt.income.finance_costs.forEach(a=>{e[a.id]={kw:a.kw,type:"finance",label:a.label}}),Yt.balance.non_current_assets.forEach(a=>{a.kw.length>0&&(e[a.classCode||a.id]={kw:a.kw,type:"asset",label:a.label})}),Yt.balance.current_liabilities.forEach(a=>{a.kw.length>0&&a.classCode&&(e[a.classCode]={kw:a.kw,type:"liability",label:a.label})}),Yt.balance.equity.forEach(a=>{a.kw.length>0&&a.classCode&&(e[a.classCode]={kw:a.kw,type:"equity",label:a.label})}),Yt.other.forEach(a=>{e[a.id]={kw:a.kw,type:a.type,label:a.label}}),e})(),classify(e){if(!e)return{code:"SUSPENSE",type:"suspense"};const a=e.toLowerCase();for(const[t,i]of Object.entries(this.rules))if(i.kw.some(s=>a.includes(s)))return{code:t,type:i.type};return{code:"SUSPENSE",type:"suspense"}},createJE(e,a){const t=[],i=Math.abs(e.amount||0),s=(e.amount||0)>0,c="cash_on_hand",f=e.source==="Cash"||e.source==="CashVoucher"||e.cashLedger==="PETTY_CASH",p=e.bankAccount?`bank_${e.bankAccount.toLowerCase().replace(/\s+/g,"_")}`:"bank",g=f?c:p;return a.type==="cash_transfer"||e.transferDirection?(e.transferDirection==="bank_to_cash"?t.push({acc:c,dr:i,cr:0},{acc:p,dr:0,cr:i}):e.transferDirection==="cash_to_bank"?t.push({acc:p,dr:i,cr:0},{acc:c,dr:0,cr:i}):t.push({acc:g,dr:s?i:0,cr:s?0:i},{acc:"transfer_suspense",dr:s?0:i,cr:s?i:0}),{date:e.date||"",desc:e.description||"",ref:e.reference||"",entries:t,cls:a.code,source:e.source||"Manual",bank:e.bankAccount||"Default",documentType:f?"CV":"BT"}):(a.type==="revenue"||a.type==="other_income"?t.push({acc:g,dr:i,cr:0},{acc:a.code.toLowerCase(),dr:0,cr:i}):a.type==="cogs"||a.type==="expense"||a.type==="finance"||a.type==="other_expense"?t.push({acc:a.code.toLowerCase(),dr:i,cr:0},{acc:g,dr:0,cr:i}):a.type==="asset"?t.push({acc:s?g:a.code.toLowerCase(),dr:i,cr:0},{acc:s?a.code.toLowerCase():g,dr:0,cr:i}):a.type==="liability"?t.push({acc:g,dr:s?i:0,cr:s?0:i},{acc:a.code.toLowerCase(),dr:s?0:i,cr:s?i:0}):a.type==="transfer"?t.push({acc:g,dr:s?i:0,cr:s?0:i},{acc:"transfer_suspense",dr:s?0:i,cr:s?i:0}):a.type==="equity"?t.push({acc:g,dr:s?i:0,cr:s?0:i},{acc:a.code.toLowerCase(),dr:s?0:i,cr:s?i:0}):a.type==="drawings"?t.push({acc:a.code.toLowerCase(),dr:i,cr:0},{acc:g,dr:0,cr:i}):a.type==="tax_payment"?t.push({acc:"tax_payable",dr:i,cr:0},{acc:g,dr:0,cr:i}):a.type==="pay_supplier"?t.push({acc:"trade_payables",dr:i,cr:0},{acc:g,dr:0,cr:i}):a.type==="pay_creditor"?t.push({acc:"other_payables",dr:i,cr:0},{acc:g,dr:0,cr:i}):a.type==="loan_repay_st"?t.push({acc:"short_term_loan",dr:i,cr:0},{acc:g,dr:0,cr:i}):a.type==="loan_repay_lt"?t.push({acc:"long_term_loan",dr:i,cr:0},{acc:g,dr:0,cr:i}):a.type==="loan_drawdown"?t.push({acc:g,dr:i,cr:0},{acc:"short_term_loan",dr:0,cr:i}):a.type==="receipt_debtor"?t.push({acc:g,dr:i,cr:0},{acc:"trade_receivables",dr:0,cr:i}):a.type==="deposit_received"?t.push({acc:g,dr:i,cr:0},{acc:"other_payables",dr:0,cr:i}):a.type==="duitnow_payment"?s?t.push({acc:g,dr:i,cr:0},{acc:"trade_receivables",dr:0,cr:i}):t.push({acc:"trade_payables",dr:i,cr:0},{acc:g,dr:0,cr:i}):t.push({acc:"suspense",dr:s?i:0,cr:s?0:i},{acc:g,dr:s?0:i,cr:s?i:0}),{date:e.date||"",desc:e.description||"",ref:e.reference||"",entries:t,cls:a.code,source:e.source||"Manual",bank:e.bankAccount||"Default",documentType:f?"CV":"BT"})},createSubledgerJEs(e){const a=[],t=new Date().toISOString().split("T")[0];return e.depreciation>0&&a.push({date:t,desc:"Depreciation for the year (from PPE Register)",ref:"SL-DEP",entries:[{acc:"depreciation",dr:e.depreciation,cr:0},{acc:"accumulated_depreciation",dr:0,cr:e.depreciation}],cls:"DEPRECIATION",source:"Subledger",bank:"N/A"}),a},buildTB(e,a={}){const t={};for(const[i,s]of Object.entries(a))t[i]={op:s,dr:0,cr:0};for(const i of e)for(const s of i.entries)t[s.acc]||(t[s.acc]={op:0,dr:0,cr:0}),t[s.acc].dr+=s.dr,t[s.acc].cr+=s.cr;return Object.entries(t).map(([i,s])=>({acc:i,op:s.op,dr:s.dr,cr:s.cr,cl:s.op+s.dr-s.cr}))},genFS(e,a=null,t=null,i=null,s=null,c=[],f=[],p={}){const g={rev:0,cos:0,gp:0,adm:0,dep:0,op:0,oi:0,oe:0,fin:0,pbt:0,tax:0,np:0,details:{}},h={ppe_cost:0,ppe_accDep:0,ppe:0,intangibles:0,investments:0,inv:0,tr:0,or:0,cash:0,totNCA:0,totCA:0,totA:0,ltBorr:0,defTax:0,borr:0,tp:0,op:0,taxPay:0,gstSst:0,totNCL:0,totCL:0,totL:0,cap:0,ret:0,cyp:0,totE:0,details:{}};Object.keys(cn.rules).forEach(_=>{g.details[_]=0});for(const _ of e){const w=_.acc.toUpperCase(),N=cn.rules[w];if(N){let F=0;N.type==="revenue"||N.type==="other_income"?(F=_.cr-_.dr,F<0&&(F=0)):N.type==="cogs"||N.type==="expense"||N.type==="finance"||N.type==="other_expense"?(F=_.dr-_.cr,F<0&&(F=0)):F=Math.abs(_.cl),g.details[w]=F,N.type==="revenue"?g.rev+=F:N.type==="cogs"?g.cos+=F:N.type==="expense"?(g.adm+=F,w==="DEPRECIATION"&&(g.dep+=F)):N.type==="other_income"?g.oi+=F:N.type==="other_expense"?g.oe+=F:N.type==="finance"&&(g.fin+=F)}const k=_.acc.toLowerCase();k==="bank"||k.startsWith("bank_")||k==="cash_on_hand"?(h.cash+=_.cl,k==="cash_on_hand"&&(h.cashInHand=(h.cashInHand||0)+_.cl)):k==="fixed_asset"||k==="ppe"?h.ppe_cost+=_.cl:k==="accumulated_depreciation"?h.ppe_accDep+=Math.abs(_.cl):k==="intangibles"||k==="intangible_assets"?h.intangibles=(h.intangibles||0)+_.cl:k==="investments"?h.investments=(h.investments||0)+_.cl:k==="inventory"?h.inv+=_.cl:k==="trade_receivables"?h.tr+=_.cl:k==="other_receivables"?h.or+=_.cl:k==="long_term_loan"||k==="lt_loan"?h.ltBorr+=Math.abs(_.cl):k==="deferred_tax"?h.defTax=(h.defTax||0)+Math.abs(_.cl):k==="loan"||k==="short_term_loan"?h.borr+=Math.abs(_.cl):k==="trade_payables"?h.tp+=Math.abs(_.cl):k==="other_payables"?h.op+=Math.abs(_.cl):k==="tax_payable"?_.cl<0?h.taxPay+=Math.abs(_.cl):_.cl>0&&(h.taxPrepaid=(h.taxPrepaid||0)+_.cl):k==="gst_sst"?_.cl<0?h.gstSst=(h.gstSst||0)+Math.abs(_.cl):h.gstSst=(h.gstSst||0)-_.cl:k==="capital"||k==="share_capital"?h.cap+=Math.abs(_.cl):(k==="retained_profits"||k==="retained_earnings")&&(h.ret+=Math.abs(_.cl))}if(s){if(s.ppe&&s.ppe.cost>0&&(h.ppe_cost=s.ppe.cost,h.ppe_accDep=s.ppe.accDepCF,s.ppe.currentDep>0)){const _=g.details.DEPRECIATION||0;_===0?(g.dep=s.ppe.currentDep,g.details.DEPRECIATION=s.ppe.currentDep,g.adm+=s.ppe.currentDep):g.dep=_}s.inventory>0&&h.inv===0&&(h.inv=s.inventory),s.receivables>0&&h.tr===0&&(h.tr=s.receivables),s.payables>0&&h.tp===0&&(h.tp=s.payables),s.otherDebtors>0&&(h.or=s.otherDebtors),s.otherCreditors>0&&(h.op=s.otherCreditors),s.hasSTBorrowings&&(h.stBorr=s.shortTermBorrowings||0,h.borr=s.shortTermBorrowings||0),s.hasLTBorrowings&&(h.ltBorr=s.longTermBorrowings||0),s.borrowingsDrawdowns!==void 0&&(h.loanDrawdowns=s.borrowingsDrawdowns),s.borrowingsRepayments!==void 0&&(h.loanRepayments=s.borrowingsRepayments),s.stBorrOpening!==void 0&&(h.py_stBorr=s.stBorrOpening),s.ltBorrOpening!==void 0&&(h.py_ltBorr=s.ltBorrOpening)}if(h.ppe=h.ppe_cost-h.ppe_accDep,g.gp=g.rev-g.cos,g.op=g.gp-g.adm,g.pbt=g.op+g.oi-g.oe-g.fin,g.tax=i?i(g.pbt):0,g.np=g.pbt-g.tax,h.taxPrepaid&&h.taxPrepaid>0){const _=g.tax-h.taxPrepaid;_>0?(h.taxPay+=_,h.taxPrepaid=0):h.taxPrepaid=-_}else h.taxPay+=g.tax;h.totNCA=h.ppe+h.intangibles+h.investments,h.totCA=h.cash+h.tr+h.or+h.inv+(h.taxPrepaid||0),h.totA=h.totNCA+h.totCA;const E=h.stBorr||h.borr||0;h.stBorr=E,h.totNCL=h.ltBorr+h.defTax,h.totCL=E+h.tp+h.op+h.taxPay,h.totL=h.totNCL+h.totCL,h.borr=E,h.cyp=g.np,h.totE=h.cap+h.ret+h.cyp,a&&(g.py_rev=parseFloat(a.revenue)||0,g.py_cos=parseFloat(a.cost_of_sales)||0,g.py_gp=g.py_rev-g.py_cos,g.py_dep=parseFloat(a.depreciation)||0,g.py_adm=parseFloat(a.admin_expenses)||0,g.py_totalAdm=g.py_dep+g.py_adm,g.py_op=g.py_gp-g.py_totalAdm,g.py_oi=parseFloat(a.other_income)||0,g.py_oe=parseFloat(a.other_expenses)||0,g.py_fin=parseFloat(a.finance_costs)||0,g.py_pbt=g.py_op+g.py_oi-g.py_oe-g.py_fin,g.py_tax=parseFloat(a.tax)||0,g.py_np=g.py_pbt-g.py_tax),t&&(h.py_ppe=parseFloat(t.ppe)||0,h.py_intangibles=parseFloat(t.intangibles)||0,h.py_investments=parseFloat(t.investments)||0,h.py_inv=parseFloat(t.inventory)||0,h.py_tr=parseFloat(t.trade_receivables)||0,h.py_or=parseFloat(t.other_receivables)||0,h.py_cash=parseFloat(t.bank)||0,h.py_totNCA=h.py_ppe+h.py_intangibles+h.py_investments,h.py_totCA=h.py_cash+h.py_tr+h.py_or+h.py_inv,h.py_totA=h.py_totNCA+h.py_totCA,h.py_ltLoan=parseFloat(t.long_term_loan)||0,h.py_defTax=parseFloat(t.deferred_tax)||0,h.py_loan=parseFloat(t.loan)||0,h.py_tp=parseFloat(t.trade_payables)||0,h.py_op=parseFloat(t.other_payables)||0,h.py_taxPay=parseFloat(t.tax_payable)||0,h.py_borr=h.py_ltLoan+h.py_loan,h.py_totNCL=h.py_ltLoan+h.py_defTax,h.py_totCL=h.py_loan+h.py_tp+h.py_op+h.py_taxPay,h.py_totL=h.py_totNCL+h.py_totCL,h.py_cap=parseFloat(t.share_capital)||0,h.py_ret=parseFloat(t.retained_profits)||0,h.py_reserves=parseFloat(t.reserves)||0,h.py_totE=h.py_cap+h.py_ret+h.py_reserves,h.py_diff=h.py_totA-(h.py_totL+h.py_totE));const A={pbt:g.pbt,adjustments:{depreciation:g.dep||0,interestExpense:g.fin||0,interestIncome:-(g.details.INTEREST_INC||0)},workingCapitalChanges:{inventory:(h.py_inv||0)-h.inv,tradeReceivables:(h.py_tr||0)-h.tr,otherReceivables:(h.py_or||0)-h.or,tradePayables:h.tp-(h.py_tp||0),otherPayables:h.op-(h.py_op||0)},taxPaid:0,interestPaid:0,ppePurchases:-Math.max(0,h.ppe-(h.py_ppe||0)+(g.dep||0)),ppeDisposals:0,investmentPurchases:-Math.max(0,(h.investments||0)-(h.py_investments||0)),investmentDisposals:Math.max(0,(h.py_investments||0)-(h.investments||0)),interestReceived:g.details.INTEREST_INC||0,loanProceeds:h.loanDrawdowns!==void 0?h.loanDrawdowns:Math.max(0,h.stBorr+(h.ltBorr||0)-((h.py_stBorr||h.py_loan||0)+(h.py_ltBorr||h.py_ltLoan||0))),loanRepayments:h.loanRepayments!==void 0?-h.loanRepayments:-Math.max(0,(h.py_stBorr||h.py_loan||0)+(h.py_ltBorr||h.py_ltLoan||0)-(h.stBorr+(h.ltBorr||0))),capitalInjection:Math.max(0,h.cap-(h.py_cap||0)),dividendsPaid:0,drawingsWithdrawals:0};return A.totalAdjustments=A.adjustments.depreciation+A.adjustments.interestExpense+A.adjustments.interestIncome,A.totalWCChanges=A.workingCapitalChanges.inventory+A.workingCapitalChanges.tradeReceivables+A.workingCapitalChanges.otherReceivables+A.workingCapitalChanges.tradePayables+A.workingCapitalChanges.otherPayables,A.cashFromOperations=A.pbt+A.totalAdjustments+A.totalWCChanges,A.netOperating=A.cashFromOperations-A.taxPaid-A.interestPaid,A.netInvesting=A.ppePurchases+A.ppeDisposals+A.investmentPurchases+A.investmentDisposals+A.interestReceived,A.netFinancing=A.loanProceeds+A.loanRepayments+A.capitalInjection+A.dividendsPaid+A.drawingsWithdrawals,A.netChangeInCash=A.netOperating+A.netInvesting+A.netFinancing,h.py_cash&&h.py_cash>0?A.openingCash=h.py_cash:A.openingCash=Object.entries(p).reduce((_,[w,N])=>w==="bank"||w.startsWith("bank_")?_+(parseFloat(N)||0):_,0),A.closingCash=A.openingCash+A.netChangeInCash,A.cashPerBS=h.cash,A.difference=A.closingCash-A.cashPerBS,{is:g,bs:h,cf:A}},process(e,a={},t=null,i=null,s=null,c=null,f=[],p=[]){const g=[],h=[];for(const _ of e){const w=_.classification,N=w?ab[w]||w:null,k=N?{code:N,type:this.rules[N]?.type||"suspense"}:this.classify(_.description),F={..._,classification:k.code};g.push(this.createJE(F,k)),k.code==="SUSPENSE"&&h.push(_)}if(c){const _=this.createSubledgerJEs(c);g.push(..._)}const E=this.buildTB(g,a),A=this.genFS(E,t,i,s,c,f,p,a);return{jes:g,tb:E,is:A.is,bs:A.bs,cf:A.cf,susp:h}}},Fp=(e,a,t,i,s=null)=>{const c=e.split(`
`).filter(A=>A.trim()),f=[],p={jan:"01",feb:"02",mar:"03",apr:"04",may:"05",jun:"06",jul:"07",aug:"08",sep:"09",oct:"10",nov:"11",dec:"12"},g=[/balance\s*(c\/f|b\/f|from|brought|carried)/i,/^date[\s,]+transaction/i,/^tarikh/i,/closing\s*balance/i,/opening\s*balance/i,/baki\s*(harian|penutup)/i],h=s||new Date().getFullYear(),E=A=>{const _=[];let w="",N=!1;for(let k=0;k<A.length;k++){const F=A[k];F==='"'?N=!N:F===","&&!N?(_.push(w.trim()),w=""):w+=F}return _.push(w.trim()),_};for(let A=0;A<c.length;A++){const _=c[A].trim();if(!_||_.length<5||g.some(se=>se.test(_)))continue;let w;_.includes(",")?w=E(_):w=_.split(/\t/).map(se=>se.trim());let N=null;const k=(w[0]||"").trim(),F=k.match(/^(\d{1,2})[\/\-](\d{1,2})$/);if(F){const se=F[1].padStart(2,"0"),ne=F[2].padStart(2,"0");N=`${h}-${ne}-${se}`}if(!N){const se=k.match(/^(\d{1,2})[\/\-\.]?([A-Za-z]{3})/i);if(se){const ne=se[1].padStart(2,"0"),H=se[2].toLowerCase(),le=p[H];le&&(N=`${h}-${le}-${ne}`)}}if(!N){const se=k.match(/^(\d{1,2})[\/\-\.](\d{1,2})[\/\-\.](\d{2,4})/);if(se){const ne=se[1].padStart(2,"0"),H=se[2].padStart(2,"0");let le=se[3];le.length===2&&(le=parseInt(le)>50?"19"+le:"20"+le),N=`${le}-${H}-${ne}`}}if(!N){const se=k.match(/^(\d{4})[\/\-\.](\d{1,2})[\/\-\.](\d{1,2})/);se&&(N=`${se[1]}-${se[2].padStart(2,"0")}-${se[3].padStart(2,"0")}`)}if(!N)continue;let z="";if(w.length>=2&&(z=(w[1]||"").trim()),/balance\s*(c\/f|b\/f|from|brought|carried)/i.test(z))continue;let K=0,M=0;if(w.length>=4){const se=(w[2]||"").replace(/"/g,"").trim(),ne=(w[3]||"").replace(/"/g,"").trim();if(se){const H=se.replace(/,/g,""),le=parseFloat(H);!isNaN(le)&&le>0&&(K=le)}if(ne){const H=ne.replace(/,/g,""),le=parseFloat(H);!isNaN(le)&&le>0&&(M=le)}}else{const se=[],ne=_.match(/([\d,]+\.\d{2})/g)||[];for(const H of ne){const le=parseFloat(H.replace(/,/g,""));!isNaN(le)&&le>0&&se.push(le)}se.length>=1&&(/\b(dr|debit|withdrawal|payment|paid|transfer\s*dr|trsf\s*dr)\b/i.test(_)?K=se[0]:M=se[0])}if(K===0&&M===0)continue;const ie=M>0?M:-K;z=z.replace(/([\d,]+\.\d{2})/g,"").trim(),z=z.replace(/\s+/g," ").trim(),z.length<2&&(z="Bank Transaction"),f.push({date:N,description:z.substring(0,100),reference:`${(t||"BNK").substring(0,3).toUpperCase()}-${i}-${f.length+1}`,amount:ie,source:a,bankAccount:t||"Unknown",month:i})}return f},ae=e=>new Intl.NumberFormat("en-MY",{style:"currency",currency:"MYR"}).format(e||0),pi=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Wm=[{id:"maybank",name:"Maybank",accNo:"5123456789"},{id:"cimb",name:"CIMB",accNo:"8001234567"}],R8=[{date:"2024-01-05",description:"Sales collection - ABC Sdn Bhd",reference:"MAY-Jan-1",amount:5e4,source:"Sample",bankAccount:"Maybank",month:"Jan"},{date:"2024-01-08",description:"Purchase inventory - Supplier XYZ",reference:"MAY-Jan-2",amount:-2e4,source:"Sample",bankAccount:"Maybank",month:"Jan"},{date:"2024-02-15",description:"Salary February 2024",reference:"MAY-Feb-1",amount:-12e3,source:"Sample",bankAccount:"Maybank",month:"Feb"},{date:"2024-02-18",description:"Office rent payment",reference:"CIM-Feb-1",amount:-3500,source:"Sample",bankAccount:"CIMB",month:"Feb"},{date:"2024-03-22",description:"Sales collection - DEF Enterprise",reference:"MAY-Mar-1",amount:28e3,source:"Sample",bankAccount:"Maybank",month:"Mar"},{date:"2024-03-25",description:"TNB Electric bill",reference:"CIM-Mar-1",amount:-850,source:"Sample",bankAccount:"CIMB",month:"Mar"}];function N8(){const[e,a]=dt.useState("setup"),[t,i]=dt.useState(""),[s,c]=dt.useState(""),[f,p]=dt.useState(""),[g,h]=dt.useState("12"),[E,A]=dt.useState(""),[_,w]=dt.useState([]),[N,k]=dt.useState([]),[F,z]=dt.useState("ALL"),[K,M]=dt.useState(""),[ie,se]=dt.useState(new Set),[ne,H]=dt.useState(""),[le,oe]=dt.useState({}),[m,Se]=dt.useState(null),[ue,Pe]=dt.useState(!1),[et,ke]=dt.useState([]),[de,Ce]=dt.useState({acc:"",amt:""}),Je=dt.useRef(null);dt.useRef(null);const[fe,Ke]=dt.useState(new Date().getFullYear()-1),[ee,I]=dt.useState(!1),[L,Q]=dt.useState(new Date().getFullYear()),[te,ge]=dt.useState(!1),[je,ze]=dt.useState(null),[Oe,Ue]=dt.useState(null),St=dt.useRef(!1),Z=()=>{const u="ashcore_ppe_seq",y=Number(localStorage.getItem(u)||"0")+1;return localStorage.setItem(u,String(y)),`PPE-${new Date().getFullYear()}-${String(y).padStart(6,"0")}`},[Jt,At]=dt.useState(null),[Gt,Ct]=dt.useState(new Date().getFullYear()),[at,Ta]=dt.useState(!1),[Ia,nr]=dt.useState([]),[Yr,Rn]=dt.useState(!1),[Rr,Wt]=dt.useState({periodType:"Monthly",periodLabel:"",note:"",createdBy:"Accountant"}),[br,Sr]=dt.useState([]),[Qr,Ea]=dt.useState({periodLabel:"",type:"Correction",amount:"",description:""}),[Dt,yt]=dt.useState({date:new Date().toISOString().split("T")[0],description:"",reference:"CV-001",amount:"",type:"out",classification:""}),ma={MFRS:{name:"MFRS",fullName:"Malaysian Financial Reporting Standards",desc:"Full IFRS-equivalent standards for public companies"},MPERS:{name:"MPERS",fullName:"Malaysian Private Entities Reporting Standard",desc:"Simplified standards for private entities"},"MPERS-Micro":{name:"MPERS for Micro Entities",fullName:"MPERS for Micro Entities",desc:"Simplified standards for micro entities"}},Nr=u=>u==="BERHAD"?"MFRS":u==="ENTERPRISE"?"MPERS-Micro":"MPERS",ia=Ym[t],Ot=ia?{...ia,standard:E||ia.standard,fullStandard:E?ma[E]?.fullName:ia.fullStandard}:null,Zt=g?`${["","January","February","March","April","May","June","July","August","September","October","November","December"][parseInt(g)]} ${L}`:"",[Mt,Fr]=dt.useState({sdnBhd:{tier1Limit:5e5,tier1Rate:17,tier2Rate:24},enterprise:{brackets:[{limit:5e3,rate:0},{limit:15e3,rate:1},{limit:15e3,rate:3},{limit:15e3,rate:6},{limit:2e4,rate:11},{limit:3e4,rate:19},{limit:15e4,rate:25},{limit:15e4,rate:26},{limit:1/0,rate:28}]},berhad:{rate:24},corporateDeductions:{capitalAllowance:"",reinvestmentAllowance:"",pioneerStatus:"",investmentTaxAllowance:"",exportIncentive:"",rdDeduction:"",lossCarryForward:""},personalDeductions:{selfRelief:"9000",spouseRelief:"",childRelief:"",parentsMedical:"",epfContribution:"",lifeInsurance:"",educationFees:"",medicalExpenses:"",lifestyleRelief:"",socsoContribution:"",privateRetirement:"",sspnDeposit:"",domesticTravel:"",evCharging:""},addBackExpenses:{depreciation:"",generalProvisionBadDebt:"",entertainmentClients:"",entertainmentPotential:"",privateExpenses:"",finesAndPenalties:"",donationsUnapproved:"",capitalExpenditure:"",leavePasages:"",excessiveCarLease:"",excessiveEpfContribution:"",withholdingTaxNotPaid:"",foreignExchangeLossUnrealised:"",provisionForExpenses:"",lossOnDisposalAssets:"",clubEntranceFees:"",taxPenalties:"",preCommencementExpenses:"",otherNonDeductible:""},taxRebates:{zakat:"",taxRebateIndividual:"",spouseRebate:"",departureLevyRebate:""}}),Kl=[{category:"Depreciation & Provisions",items:[{key:"depreciation",label:"Accounting Depreciation",tooltip:"Depreciation is not tax deductible. Claim Capital Allowance instead under Schedule 3 ITA 1967."},{key:"generalProvisionBadDebt",label:"General Bad Debt Provision",tooltip:"Only specific bad debts written off are deductible. General provisions must be added back."},{key:"provisionForExpenses",label:"General Provisions",tooltip:"Provisions for future expenses are not incurred and must be added back."},{key:"foreignExchangeLossUnrealised",label:"Unrealised Forex Loss",tooltip:"Only realised foreign exchange losses are deductible."}]},{category:"Entertainment Expenses",items:[{key:"entertainmentClients",label:"Entertainment (Clients) - 50%",tooltip:"Entertainment for existing clients/suppliers: only 50% is deductible. Add back the other 50%."},{key:"entertainmentPotential",label:"Entertainment (Potential Clients)",tooltip:"Entertainment for potential customers is 100% non-deductible per Section 39(1)(l) ITA."}]},{category:"Private & Capital Expenses",items:[{key:"privateExpenses",label:"Private/Domestic Expenses",tooltip:"Personal expenses like personal travel, home utilities, personal phone bills are not deductible."},{key:"capitalExpenditure",label:"Capital Expenditure in P&L",tooltip:"Capital items wrongly expensed (e.g., renovation, equipment) must be added back. Claim CA instead."},{key:"lossOnDisposalAssets",label:"Loss on Disposal of Assets",tooltip:"Loss on sale of capital assets is not deductible for tax purposes."},{key:"preCommencementExpenses",label:"Pre-Commencement Expenses",tooltip:"Expenses incurred before business commencement are capital in nature (except Schedule 4B items)."}]},{category:"Staff & Benefits",items:[{key:"leavePasages",label:"Leave Passages",tooltip:"Leave passages are not deductible except for yearly company events in Malaysia for employees."},{key:"excessiveEpfContribution",label:"Excess EPF (>19%)",tooltip:"Employer EPF contributions exceeding 19% of employee remuneration must be added back."},{key:"excessiveCarLease",label:"Excess Car Lease Rental",tooltip:"Car lease exceeding RM50,000 (or RM100,000 for cars RM150,000) per car per year is disallowed."}]},{category:"Fines, Donations & Others",items:[{key:"finesAndPenalties",label:"Fines & Penalties",tooltip:"All fines, penalties, compounds, and summons are not tax deductible."},{key:"taxPenalties",label:"Tax Penalties & Appeal Costs",tooltip:"Income tax penalties and costs of tax appeals are expressly disallowed."},{key:"donationsUnapproved",label:"Unapproved Donations",tooltip:"Only donations to LHDN-approved institutions are deductible. Unapproved donations must be added back."},{key:"clubEntranceFees",label:"Club Entrance/Membership",tooltip:"Club entrance fees and subscriptions are capital in nature and not deductible."}]},{category:"Payments to Non-Residents",items:[{key:"withholdingTaxNotPaid",label:"WHT Not Deducted",tooltip:"Payments to non-residents (royalties, fees, interest, rent) without deducting withholding tax are disallowed until WHT is paid."}]},{category:"Other Non-Deductible",items:[{key:"otherNonDeductible",label:"Other Non-Deductible",tooltip:"Any other expenses not wholly and exclusively incurred for business purposes."}]}],Qn=u=>{const y={grossTax:0,zakat:0,netTax:0,taxableIncome:0,adjustedProfit:0,totalDeductions:0,capitalAllowance:0,brackets:[]};let v=0;if(Mt.addBackExpenses&&Object.values(Mt.addBackExpenses).forEach(T=>{v+=parseFloat(T)||0}),y.adjustedProfit=u+v,y.adjustedProfit<=0)return y;const S=parseFloat(Mt.corporateDeductions?.capitalAllowanceManual)||0;if(y.capitalAllowance=S>0?S:xs(),y.totalDeductions=y.capitalAllowance,t==="ENTERPRISE"?Object.values(Mt.personalDeductions).forEach(T=>{y.totalDeductions+=parseFloat(T)||0}):Object.entries(Mt.corporateDeductions).forEach(([T,W])=>{T!=="capitalAllowance"&&T!=="capitalAllowanceManual"&&(y.totalDeductions+=parseFloat(W)||0)}),y.taxableIncome=Math.max(0,y.adjustedProfit-y.totalDeductions),y.taxableIncome<=0)return y;if(t==="SDN_BHD"){const{tier1Limit:T,tier1Rate:W,tier2Rate:D}=Mt.sdnBhd;if(y.taxableIncome<=T)y.grossTax=Math.round(y.taxableIncome*(W/100)),y.brackets=[{range:`First RM${T.toLocaleString()}`,amount:y.taxableIncome,rate:W,tax:y.grossTax}];else{const C=Math.round(T*(W/100)),O=Math.round((y.taxableIncome-T)*(D/100));y.grossTax=C+O,y.brackets=[{range:`First RM${T.toLocaleString()}`,amount:T,rate:W,tax:C},{range:`Balance RM${(y.taxableIncome-T).toLocaleString()}`,amount:y.taxableIncome-T,rate:D,tax:O}]}}if(t==="ENTERPRISE"){let T=0,W=y.taxableIncome,D=0;const C=[{min:0,max:5e3,rate:0},{min:5001,max:2e4,rate:1},{min:20001,max:35e3,rate:3},{min:35001,max:5e4,rate:6},{min:50001,max:7e4,rate:11},{min:70001,max:1e5,rate:19},{min:100001,max:25e4,rate:25},{min:250001,max:4e5,rate:26},{min:400001,max:1/0,rate:28}];for(const O of Mt.enterprise.brackets){if(W<=0)break;const G=Math.min(W,O.limit),xe=Math.round(G*(O.rate/100));T+=xe,G>0&&(C.find(Re=>D>=Re.min-1&&D<Re.max)||C[C.length-1],y.brackets.push({range:`RM${(D+1).toLocaleString()} - RM${(D+G).toLocaleString()}`,amount:G,rate:O.rate,tax:xe})),D+=O.limit,W-=O.limit}y.grossTax=Math.round(T)}return t==="BERHAD"&&(y.grossTax=Math.round(y.taxableIncome*(Mt.berhad.rate/100)),y.brackets=[{range:"All chargeable income",amount:y.taxableIncome,rate:Mt.berhad.rate,tax:y.grossTax}]),Mt.taxRebates&&(y.zakat=Math.min(parseFloat(Mt.taxRebates.zakat)||0,y.grossTax)),y.netTax=Math.max(0,y.grossTax-y.zakat),y},Jn=u=>Qn(u).netTax,yi=()=>Mt.addBackExpenses?Object.values(Mt.addBackExpenses).reduce((u,y)=>u+(parseFloat(y)||0),0):0,Jr=()=>{if(!m)return null;const u=m.is.rev||0,y=m.is.cos||0,v=m.is.gp||0,S=m.is.oi||0,T=m.is.adm||0,W=m.is.fin||0,D=v+S-T,C=m.is.pbt||0,O=m.is.tax||0,G=m.is.np||0,xe=m.bs.totA||0,Re=m.bs.totL||0,ye=m.bs.totE||0,X=m.bs.totCA||0,V=m.bs.totCL||(m.bs.tp||0)+(m.bs.borr||0)+(m.bs.op||0)+(m.bs.taxPayable||0),Me=m.bs.totNCA||0,Be=m.bs.totNCL||m.bs.ltl||0,pe=Aa.reduce((ci,Er)=>ci+(parseFloat(Er.amount)||0)-(parseFloat(Er.paid)||0),0),We=sa.reduce((ci,Er)=>ci+(parseFloat(Er.amount)||0)-(parseFloat(Er.paid)||0),0),Ve=pr.reduce((ci,Er)=>ci+(parseFloat(Er.qty)||0)*(parseFloat(Er.unitCost)||0),0),it=en.reduce((ci,Er)=>ci+(parseFloat(Er.closingBalance)||0),0),Vt=m.is.py_rev||0,lt=m.is.py_np||0,Fa=m.is.py_gp||0,Ka=m.bs.py_totA||0,Wr=m.bs.py_totE||0,st=u>0?v/u*100:0,zt=u>0?G/u*100:0,Ut=u>0?D/u*100:0,vt=ye>0?G/ye*100:0,an=xe>0?G/xe*100:0,qt=V>0?X/V:X>0?999:0,ii=V>0?(X-Ve)/V:0,Ln=V>0?it/V:0,ws=u>0?pe/u*365:0,tc=y>0?We/y*365:0,si=y>0?Ve/y*365:0,Hi=ws+si-tc,Ti=ye>0?Re/ye:0,El=xe>0?Re/xe:0,$i=Vt>0?(u-Vt)/Vt*100:0,yn=lt!==0?(G-lt)/Math.abs(lt)*100:G>0?100:0,li=Ka>0?(xe-Ka)/Ka*100:0,Ai=Wr>0?(ye-Wr)/Wr*100:0,oi=X-V,Ba=[];return G>0?Ba.push({type:"success",icon:"",category:"Profitability",title:"Profitable Operation",text:`The company generated a net profit of RM ${ae(G)} for FY${L}.`,detail:`Net profit margin is ${zt.toFixed(1)}%, meaning RM ${(zt/100).toFixed(2)} is retained from every RM 1 of revenue.`}):G<0&&Ba.push({type:"danger",icon:"",category:"Profitability",title:"Loss-Making Operation",text:`The company incurred a net loss of RM ${ae(Math.abs(G))} for FY${L}.`,detail:"Urgent review of cost structure and revenue streams recommended. Consider cost-cutting measures or pricing strategy revision."}),st<20&&u>0?Ba.push({type:"warning",icon:"",category:"Profitability",title:"Low Gross Margin",text:`Gross margin is ${st.toFixed(1)}% which is below industry standard (20-30%).`,detail:"This may indicate: (1) High cost of goods, (2) Pricing pressure, (3) Inefficient production. Review supplier contracts and pricing strategy."}):st>40&&u>0&&Ba.push({type:"success",icon:"",category:"Profitability",title:"Strong Gross Margin",text:`Excellent gross margin at ${st.toFixed(1)}%.`,detail:"The company maintains strong pricing power and/or efficient cost management. This provides buffer for operating expenses."}),$i>15?Ba.push({type:"success",icon:"",category:"Growth",title:"Strong Revenue Growth",text:`Revenue grew ${$i.toFixed(1)}% from RM ${ae(Vt)} to RM ${ae(u)}.`,detail:"This growth rate exceeds typical market growth. Assess if growth is sustainable and whether infrastructure can support continued expansion."}):$i<-10&&Vt>0&&Ba.push({type:"danger",icon:"",category:"Growth",title:"Revenue Decline",text:`Revenue declined ${Math.abs($i).toFixed(1)}% from RM ${ae(Vt)} to RM ${ae(u)}.`,detail:"Investigate causes: market conditions, lost customers, competitive pressure, or product lifecycle issues."}),yn>20&&lt>0?Ba.push({type:"success",icon:"",category:"Growth",title:"Profit Growth Momentum",text:`Net profit increased ${yn.toFixed(1)}% year-on-year.`,detail:"Profit growth outpacing revenue growth indicates improving operational efficiency and cost management."}):yn<-20&&lt>0&&Ba.push({type:"danger",icon:"",category:"Growth",title:"Profit Erosion",text:`Net profit declined ${Math.abs(yn).toFixed(1)}% year-on-year.`,detail:"Profit declining faster than revenue suggests cost pressures or margin compression. Review expense categories."}),qt<1?Ba.push({type:"danger",icon:"",category:"Liquidity",title:"Liquidity Risk",text:`Current ratio is ${qt.toFixed(2)}x (below 1.0).`,detail:`The company may struggle to meet short-term obligations. Current liabilities (RM ${ae(V)}) exceed current assets (RM ${ae(X)}). Consider: (1) Accelerating receivables collection, (2) Extending payables terms, (3) Short-term financing.`}):qt>=1.5&&qt<999?Ba.push({type:"success",icon:"",category:"Liquidity",title:"Healthy Liquidity",text:`Current ratio of ${qt.toFixed(2)}x indicates strong short-term financial health.`,detail:"Sufficient current assets to cover current liabilities. Working capital position is sound."}):qt>3&&Ba.push({type:"warning",icon:"",category:"Liquidity",title:"Excess Liquidity",text:`Current ratio of ${qt.toFixed(2)}x may indicate excess idle assets.`,detail:"Consider deploying excess cash into productive investments or returning to shareholders."}),ws>60&&u>0&&Ba.push({type:"warning",icon:"",category:"Efficiency",title:"Slow Receivables Collection",text:`Days Sales Outstanding is ${ws.toFixed(0)} days.`,detail:"Cash is tied up in receivables. Review credit terms and collection procedures. Consider: (1) Tighter credit policy, (2) Early payment discounts, (3) Factoring."}),si>90&&y>0&&Ba.push({type:"warning",icon:"",category:"Efficiency",title:"High Inventory Days",text:`Days Inventory Outstanding is ${si.toFixed(0)} days.`,detail:"Inventory turnover is slow. Risk of obsolescence and storage costs. Review: (1) Demand forecasting, (2) SKU rationalization, (3) Supplier lead times."}),Ti>2?Ba.push({type:"warning",icon:"",category:"Leverage",title:"High Financial Leverage",text:`Debt-to-equity ratio is ${Ti.toFixed(2)}x.`,detail:"Heavy reliance on debt financing increases financial risk and interest burden. Consider equity injection or debt reduction."}):Ti<.5&&Ti>0&&Ba.push({type:"success",icon:"",category:"Leverage",title:"Conservative Capital Structure",text:`Low debt-to-equity ratio of ${Ti.toFixed(2)}x.`,detail:"Conservative financing provides financial flexibility. May consider strategic debt to optimize capital structure if growth opportunities exist."}),vt>15?Ba.push({type:"success",icon:"",category:"Returns",title:"Strong Return on Equity",text:`ROE of ${vt.toFixed(1)}% exceeds cost of equity benchmark.`,detail:"Shareholders are earning attractive returns. The business is creating value above the opportunity cost of capital."}):vt<8&&vt>0&&Ba.push({type:"warning",icon:"",category:"Returns",title:"Below-Average ROE",text:`ROE of ${vt.toFixed(1)}% is below typical market returns.`,detail:"Returns may not justify the risk of equity investment. Review business model efficiency and capital allocation."}),{kpis:{revenue:u,cogs:y,grossProfit:v,operatingProfit:D,pbt:C,tax:O,pat:G,otherIncome:S,adminExpenses:T,financeExpenses:W,totalAssets:xe,totalLiabilities:Re,totalEquity:ye,currentAssets:X,currentLiabilities:V,nonCurrentAssets:Me,nonCurrentLiabilities:Be,arTotal:pe,apTotal:We,inventoryTotal:Ve,cashTotal:it,workingCapital:oi},ratios:{grossMargin:st,netMargin:zt,operatingMargin:Ut,roe:vt,roa:an,currentRatio:qt,quickRatio:ii,cashRatio:Ln,dso:ws,dpo:tc,dio:si,ccc:Hi,debtToEquity:Ti,debtToAssets:El,revenueGrowth:$i,profitGrowth:yn,assetGrowth:li,equityGrowth:Ai},comparatives:{pyRevenue:Vt,pyPat:lt,pyGp:Fa,pyTotalAssets:Ka,pyTotalEquity:Wr},insights:Ba}},[ya,Fn]=dt.useState([]),[Zn,cs]=dt.useState({name:"",accNo:""}),[Xt,vi]=dt.useState(""),[ur,rl]=dt.useState("Jan"),[Dn,Zr]=dt.useState({}),[jn,ds]=dt.useState(""),[j,q]=dt.useState("manual"),[P,U]=dt.useState(null),[Y,J]=dt.useState([]),[Ee,De]=dt.useState({}),[me,Te]=dt.useState(""),Ae=()=>{const u=[];return Yt.income.revenue.forEach(y=>{u.push({id:y.id,label:y.label,value:"",type:"revenue",section:"revenue"})}),Yt.income.cost_of_sales.forEach(y=>{u.push({id:y.id,label:y.label,value:"",type:"cogs",section:"cost_of_sales"})}),Yt.income.operating_expenses.forEach(y=>{u.push({id:y.id,label:y.label,value:"",type:"expense",section:"operating_expenses",group:y.group})}),Yt.income.other_income.forEach(y=>{u.push({id:y.id,label:y.label,value:"",type:"other_income",section:"other_income"})}),Yt.income.other_expenses.forEach(y=>{u.push({id:y.id,label:y.label,value:"",type:"other_expense",section:"other_expenses"})}),Yt.income.finance_costs.forEach(y=>{u.push({id:y.id,label:y.label,value:"",type:"finance",section:"finance_costs"})}),u.push({id:"TAX_EXPENSE",label:"Tax Expense",value:"",type:"tax",section:"tax"}),u},Ge=()=>{const u=[];return Yt.balance.non_current_assets.forEach(y=>{u.push({id:y.id,label:y.label,value:"",type:"nca",section:"non_current_assets"})}),Yt.balance.current_assets.forEach(y=>{u.push({id:y.id,label:y.label,value:"",type:"ca",section:"current_assets"})}),Yt.balance.non_current_liabilities.forEach(y=>{u.push({id:y.id,label:y.label,value:"",type:"ncl",section:"non_current_liabilities"})}),Yt.balance.current_liabilities.forEach(y=>{u.push({id:y.id,label:y.label,value:"",type:"cl",section:"current_liabilities"})}),Yt.balance.equity.filter(y=>y.id!=="CURRENT_YEAR_PROFIT").forEach(y=>{u.push({id:y.id,label:y.label,value:"",type:"equity",section:"equity"})}),u},[Ye,Ze]=dt.useState(Ae),[He,Xe]=dt.useState(Ge),[ct,va]=dt.useState(""),xt={LAND:{label:"Land",years:0,rate:0},BUILDING:{label:"Buildings",years:50,rate:2},RENOVATION:{label:"Renovation & Improvements",years:10,rate:10},PLANT_MACHINERY:{label:"Plant & Machinery",years:10,rate:10},FACTORY_EQUIPMENT:{label:"Factory Equipment",years:10,rate:10},OFFICE_EQUIPMENT:{label:"Office Equipment",years:10,rate:10},FURNITURE_FITTINGS:{label:"Furniture & Fittings",years:10,rate:10},MOTOR_VEHICLES:{label:"Motor Vehicles",years:5,rate:20},COMPUTER_EQUIPMENT:{label:"Computer & IT Equipment",years:3,rate:33.33},ELECTRICAL_FITTINGS:{label:"Electrical Fittings",years:10,rate:10},AIR_CONDITIONING:{label:"Air Conditioning",years:10,rate:10},SIGNBOARD:{label:"Signboard",years:10,rate:10},TOOLS_EQUIPMENT:{label:"Tools & Small Equipment",years:5,rate:20}},[ft,Ha]=dt.useState([]),[pr,Gr]=dt.useState([]),[Aa,On]=dt.useState([]),[sa,ei]=dt.useState([]),[hr,ir]=dt.useState([]),[ti,fs]=dt.useState([]),[en,ji]=dt.useState([]),[Dr,nl]=dt.useState([]),[Ra,Oi]=dt.useState([]);up.useEffect(()=>{if(St.current||ft.length===0)return;ft.some(y=>!y.assetId)&&(console.log("[V9] Migrating PPE assets to add persistent assetIds..."),Ha(y=>y.map(v=>v.assetId?v:{...v,assetId:Z(),disposed:v.disposed??!1,disposalDate:v.disposalDate??"",disposalProceeds:v.disposalProceeds??0,includeForCA:v.includeForCA??!0,taxCategory:v.taxCategory??v.category,qualifyingCost:v.qualifyingCost??v.cost})),St.current=!0)},[ft]);const h0=()=>{const u=`ppe_${Date.now()}`,y=Z();Ha(v=>[...v,{id:u,assetId:y,description:"",category:"OFFICE_EQUIPMENT",acquisitionDate:"",cost:0,residualValue:0,accDepBF:0,disposed:!1,disposalDate:"",disposalProceeds:0,includeForCA:!0,taxCategory:"OFFICE_EQUIPMENT",qualifyingCost:0}])},In=(u,y,v)=>{Ha(S=>S.map(T=>{if(T.id!==u)return T;const W={...T,[y]:v};return y==="cost"&&!T._manualQualifyingCost&&(W.qualifyingCost=v),y==="category"&&!T._manualTaxCategory&&(W.taxCategory=v),W}))},us=u=>{const y=new Date().toISOString().split("T")[0];Ha(v=>v.map(S=>S.id===u?{...S,disposed:!0,disposalDate:y}:S))},g0=u=>Ha(y=>y.filter(v=>v.id!==u)),x0=u=>{const y=[];if(!u.acquisitionDate)y.push("Missing acquisition date");else{const v=new Date(u.acquisitionDate);isNaN(v.getTime())&&y.push("Invalid acquisition date")}if((parseFloat(u.cost)||0)<=0&&y.push("Cost must be greater than 0"),u.disposed&&u.disposalDate){const v=new Date(u.acquisitionDate),S=new Date(u.disposalDate);!isNaN(v.getTime())&&!isNaN(S.getTime())&&S<v&&y.push("Disposal date cannot be before acquisition date")}return y},Ii=(u,y,v)=>{const S=parseFloat(u.cost)||0,T=parseFloat(u.residualValue)||0,W=parseFloat(u.accDepBF)||0,C=(xt[u.category]||xt.OFFICE_EQUIPMENT).years;if(C===0)return{monthsUsed:0,proratedDep:0,warning:null};const O=Math.max(0,S-T),G=O/C;let xe=null,Re=null,ye=null;if(u.acquisitionDate){const pe=new Date(u.acquisitionDate);isNaN(pe.getTime())?ye="Invalid acquisition date - assuming full year":(xe=pe.getFullYear(),Re=pe.getMonth()+1)}else ye="Missing acquisition date - assuming full year";let X=12;if(xe!==null){if(xe>v)return{monthsUsed:0,proratedDep:0,warning:"Asset not yet acquired"};xe===v&&(X=12-Re+1)}if(u.disposed&&u.disposalDate){const pe=new Date(u.disposalDate);if(!isNaN(pe.getTime())){const We=pe.getFullYear(),Ve=pe.getMonth()+1;if(We<v)return{monthsUsed:0,proratedDep:0,warning:"Asset disposed in prior year"};We===v&&(X=Math.min(X,Ve))}}const V=G*(X/12),Me=Math.max(0,O-W),Be=Math.min(V,Me);return{monthsUsed:X,proratedDep:Be,warning:ye}},Ql=u=>{const y=parseFloat(u.cost)||0,v=parseFloat(u.residualValue)||0,S=parseFloat(u.accDepBF)||0,W=(xt[u.category]||xt.OFFICE_EQUIPMENT).years;if(W===0)return{depreciableAmount:0,annualDep:0,currentDep:0,accDepCF:0,nbv:y};const D=y-v,C=D/W,G=Math.max(0,D-S),xe=Math.min(C,G),Re=S+xe,ye=y-Re;return{depreciableAmount:D,annualDep:C,currentDep:xe,accDepCF:Re,nbv:ye}},Bi={LAND:{ia:0,aa:0,label:"Land (No CA)"},BUILDING:{ia:10,aa:3,label:"Industrial Building"},RENOVATION:{ia:0,aa:0,label:"Renovation (S.Deduction)"},PLANT_MACHINERY:{ia:20,aa:14,label:"Plant & Machinery"},FACTORY_EQUIPMENT:{ia:20,aa:14,label:"Factory Equipment"},OFFICE_EQUIPMENT:{ia:20,aa:10,label:"Office Equipment"},FURNITURE_FITTINGS:{ia:20,aa:10,label:"Furniture & Fittings"},MOTOR_VEHICLES:{ia:20,aa:20,label:"Motor Vehicles"},COMPUTER_EQUIPMENT:{ia:20,aa:40,label:"Computer/ICT Equipment"},ELECTRICAL_FITTINGS:{ia:20,aa:10,label:"Electrical Fittings"},AIR_CONDITIONING:{ia:20,aa:10,label:"Air Conditioning"},SIGNBOARD:{ia:20,aa:10,label:"Signboard"},TOOLS_EQUIPMENT:{ia:20,aa:20,label:"Tools & Equipment"},HEAVY_MACHINERY:{ia:20,aa:10,label:"Heavy Machinery"},ENVIRONMENTAL:{ia:40,aa:20,label:"Environmental Equipment"},SMALL_VALUE:{ia:0,aa:100,label:"Small Value Asset (<RM2000)"}},m0=u=>`ashcore_ca_rates_${u}`,Yo=u=>{const y=m0(u);try{const v=localStorage.getItem(y);if(v){const S=JSON.parse(v),T={...Bi};return Object.keys(S).forEach(W=>{T[W]?T[W]={...T[W],...S[W]}:T[W]=S[W]}),{rates:T,isDefault:!1}}}catch(v){console.warn("[V9] Error loading CA rates from localStorage:",v)}return{rates:Bi,isDefault:!0}};up.useEffect(()=>{const{rates:u,isDefault:y}=Yo(Gt);At(y?null:u)},[Gt]);const y0=()=>Jt||Bi,xf=()=>Jt===null,il=()=>ft.filter(u=>u.includeForCA&&!u.disposed).map(u=>({id:`derived_${u.id}`,assetId:u.assetId,sourceType:"PPE",acquisitionDate:u.acquisitionDate,description:u.description,category:u.taxCategory||u.category,cost:parseFloat(u.qualifyingCost)||parseFloat(u.cost)||0})),pn=()=>{const u=il(),y=ps,v=new Map;y.forEach(W=>{W.assetId&&v.set(W.assetId,W)});const S=u.map(W=>{const D=v.get(W.assetId);return D?{...D,isOverride:!0,sourceAssetId:W.assetId}:{...W,isOverride:!1}}),T=y.filter(W=>!W.assetId);return[...S,...T]},[ps,hs]=dt.useState([]),gs=()=>{const u=`ca_${Date.now()}`;hs(y=>[...y,{id:u,assetId:null,acquisitionDate:"",description:"",category:"OFFICE_EQUIPMENT",cost:0}])},ai=(u,y,v)=>{hs(S=>S.map(T=>T.id===u?{...T,[y]:v}:T))},v0=u=>{hs(y=>y.filter(v=>v.id!==u))},Mi=u=>{const y=parseFloat(u.cost)||0,v=y0(),S=v[u.category]||v.OFFICE_EQUIPMENT||Bi.OFFICE_EQUIPMENT,T=parseInt(L)||new Date().getFullYear();let W=T,D=null;if(u.acquisitionDate){const ye=new Date(u.acquisitionDate);isNaN(ye.getTime())||(W=ye.getFullYear(),W>T&&(D="Asset acquisition date is in the future"))}const C=W===T;if(W>T)return{ia:0,aa:0,totalCA:0,isCurrentYear:!1,isFutureYear:!0,rates:S,warning:D};const G=C?y*(S.ia/100):0,xe=y*(S.aa/100),Re=G+xe;return{ia:G,aa:xe,totalCA:Re,isCurrentYear:C,isFutureYear:!1,rates:S,warning:D}},xs=()=>pn().reduce((y,v)=>{const S=Mi(v);return y+S.totalCA},0),Li=()=>pn().reduce((y,v)=>y+(parseFloat(v.cost)||0),0),hn=()=>ft.reduce((u,y)=>u+(parseFloat(y.cost)||0),0),ms=()=>Math.abs(Li()-hn())<.01,sl=()=>{const u=`inv_${Date.now()}`;Gr(y=>[...y,{id:u,itemCode:"",description:"",qty:0,unitCost:0,category:"Raw Materials"}])},gn=(u,y,v)=>{Gr(S=>S.map(T=>T.id===u?{...T,[y]:v}:T))},Go=u=>Gr(y=>y.filter(v=>v.id!==u)),Jl=()=>{const u=`ar_${Date.now()}`;On(y=>[...y,{id:u,customerName:"",invoiceNo:"",invoiceDate:"",dueDate:"",amount:0,paid:0}])},ll=(u,y,v)=>{On(S=>S.map(T=>T.id===u?{...T,[y]:v}:T))},Zl=u=>On(y=>y.filter(v=>v.id!==u)),eo=()=>{const u=`ap_${Date.now()}`;ei(y=>[...y,{id:u,supplierName:"",invoiceNo:"",invoiceDate:"",dueDate:"",amount:0,paid:0}])},ol=(u,y,v)=>{ei(S=>S.map(T=>T.id===u?{...T,[y]:v}:T))},jr=u=>ei(y=>y.filter(v=>v.id!==u)),Pi=()=>{const u=`od_${Date.now()}`;ir(y=>[...y,{id:u,description:"",type:"DEPOSIT",amount:0,remarks:""}])},ys=(u,y,v)=>{ir(S=>S.map(T=>T.id===u?{...T,[y]:v}:T))},cl=u=>ir(y=>y.filter(v=>v.id!==u)),mf=()=>{const u=`oc_${Date.now()}`;fs(y=>[...y,{id:u,description:"",type:"ACCRUAL",amount:0,remarks:""}])},dl=(u,y,v)=>{fs(S=>S.map(T=>T.id===u?{...T,[y]:v}:T))},Wo=u=>fs(y=>y.filter(v=>v.id!==u)),fl=()=>{const u=`cb_${Date.now()}`;ji(y=>[...y,{id:u,accountName:"",bankName:"",accountNo:"",openingBalance:0,closingBalance:0,reconciled:!1}])},vs=(u,y,v)=>{ji(S=>S.map(T=>T.id===u?{...T,[y]:v}:T))},b0=u=>ji(y=>y.filter(v=>v.id!==u)),yf=()=>{const u=`stb_${Date.now()}`;nl(y=>[...y,{id:u,lender:"",loanType:"SHORT_TERM_LOAN",loanNo:"",openingBalance:0,drawdown:0,repayment:0,interestRate:0,remarks:""}])},ul=(u,y,v)=>{nl(S=>S.map(T=>T.id===u?{...T,[y]:v}:T))},vf=u=>nl(y=>y.filter(v=>v.id!==u)),Vo=()=>{const u=`ltb_${Date.now()}`;Oi(y=>[...y,{id:u,lender:"",loanType:"TERM_LOAN",loanNo:"",openingBalance:0,drawdown:0,repayment:0,interestRate:0,tenureMonths:60,startDate:"",remarks:""}])},pl=(u,y,v)=>{Oi(S=>S.map(T=>T.id===u?{...T,[y]:v}:T))},bf=u=>Oi(y=>y.filter(v=>v.id!==u)),rt=up.useMemo(()=>{const u=ft.reduce((X,V)=>{const Me=parseFloat(V.cost)||0,Be=parseFloat(V.accDepBF)||0,pe=Ql(V);return{cost:X.cost+Me,accDepBF:X.accDepBF+Be,currentDep:X.currentDep+pe.currentDep,accDepCF:X.accDepCF+pe.accDepCF,nbv:X.nbv+pe.nbv}},{cost:0,accDepBF:0,currentDep:0,accDepCF:0,nbv:0}),y=pr.reduce((X,V)=>{const Me=parseFloat(V.qty)||0,Be=parseFloat(V.unitCost)||0;return X+Me*Be},0),v=Aa.reduce((X,V)=>{const Me=parseFloat(V.amount)||0,Be=parseFloat(V.paid)||0;return X+(Me-Be)},0),S=sa.reduce((X,V)=>{const Me=parseFloat(V.amount)||0,Be=parseFloat(V.paid)||0;return X+(Me-Be)},0),T=hr.reduce((X,V)=>X+(parseFloat(V.amount)||0),0),W=ti.reduce((X,V)=>X+(parseFloat(V.amount)||0),0),D=en.reduce((X,V)=>X+(parseFloat(V.closingBalance)||0),0),C=Dr.reduce((X,V)=>{const Me=parseFloat(V.openingBalance)||0,Be=parseFloat(V.drawdown)||0,pe=parseFloat(V.repayment)||0;return X+(Me+Be-pe)},0),O=Ra.reduce((X,V)=>{const Me=parseFloat(V.openingBalance)||0,Be=parseFloat(V.drawdown)||0,pe=parseFloat(V.repayment)||0;return X+(Me+Be-pe)},0),G=Dr.reduce((X,V)=>X+(parseFloat(V.drawdown)||0),0)+Ra.reduce((X,V)=>X+(parseFloat(V.drawdown)||0),0),xe=Dr.reduce((X,V)=>X+(parseFloat(V.repayment)||0),0)+Ra.reduce((X,V)=>X+(parseFloat(V.repayment)||0),0),Re=Dr.reduce((X,V)=>X+(parseFloat(V.openingBalance)||0),0),ye=Ra.reduce((X,V)=>X+(parseFloat(V.openingBalance)||0),0);return{ppe:u,inventory:y,receivables:v,payables:S,otherDebtors:T,otherCreditors:W,cashBank:D,shortTermBorrowings:C,longTermBorrowings:O,borrowingsDrawdowns:G,borrowingsRepayments:xe,stBorrOpening:Re,ltBorrOpening:ye,hasSTBorrowings:Dr.length>0,hasLTBorrowings:Ra.length>0}},[ft,pr,Aa,sa,hr,ti,en,Dr,Ra]),bs=(u="expense")=>{const y=`custom_is_${Date.now()}`;Ze(v=>[...v,{id:y,label:"New Item",value:"",type:u,mapped:"",custom:!0}])},hl=(u="ca")=>{const y=`custom_bs_${Date.now()}`;Xe(v=>[...v,{id:y,label:"New Item",value:"",type:u,mapped:"",custom:!0}])},zi=u=>Ze(y=>y.filter(v=>v.id!==u)),gl=u=>Xe(y=>y.filter(v=>v.id!==u)),Or=(u,y,v)=>{Ze(S=>S.map(T=>T.id===u?{...T,[y]:v}:T))},Bn=(u,y,v)=>{Xe(S=>S.map(T=>T.id===u?{...T,[y]:v}:T))},Sf=async u=>{const y=u.target.files[0];if(!y)return;U(y);const v=y.name.toLowerCase();try{if(v.endsWith(".xlsx")||v.endsWith(".xls")){const S=await y.arrayBuffer(),T=nf(S,{type:"array",cellDates:!0}),W=[];T.SheetNames.forEach((D,C)=>{const O=T.Sheets[D];Sa.sheet_to_json(O,{header:1,defval:""}).forEach((xe,Re)=>{if(!Array.isArray(xe)||xe.length<2)return;let ye="",X=null;xe.forEach(V=>{if(V==null||V==="")return;const Me=String(V).trim(),Be=Me.replace(/[,\s()RM$]/gi,""),pe=parseFloat(Be);!isNaN(pe)&&X===null&&Be!==""?X=Me.includes("(")?-Math.abs(pe):pe:Me&&!ye&&isNaN(parseFloat(Me.replace(/[,\s]/g,"")))&&(ye=Me)}),ye&&X!==null&&W.push({idx:W.length,label:ye,value:X,cells:xe.map(V=>String(V||"")),sheet:D,sheetIdx:C})})}),J(W),ke(D=>[...D,{t:"ok",m:` Excel: ${W.length} items from ${T.SheetNames.length} sheets (${T.SheetNames.join(", ")})`}])}else if(v.endsWith(".pdf"))ke(S=>[...S,{t:"warn",m:" PDF detected. Please open the PDF, copy (Ctrl+A, Ctrl+C) and paste the text below."}]),J([]),q("upload");else{const T=(await y.text()).split(`
`).filter(D=>D.trim()),W=[];T.forEach((D,C)=>{const O=D.split(/[,\t]/).map(G=>G.trim().replace(/^["']|["']$/g,""));if(O.length>=2){let G="",xe=null;O.forEach(Re=>{const ye=Re.replace(/[,\s()RM$]/gi,""),X=parseFloat(ye);!isNaN(X)&&xe===null&&ye!==""?xe=Re.includes("(")?-Math.abs(X):X:Re&&!G&&isNaN(parseFloat(Re.replace(/[,\s]/g,"")))&&(G=Re)}),G&&xe!==null&&W.push({idx:C,label:G,value:xe,cells:O})}}),J(W),ke(D=>[...D,{t:"ok",m:` Parsed ${W.length} line items from ${y.name}`}])}}catch(S){ke(T=>[...T,{t:"err",m:` Error reading file: ${S.message}`}])}},Xo=u=>{if(!u.trim())return;const y=u.split(`
`).filter(S=>S.trim()),v=[];y.forEach((S,T)=>{if(S.match(/^(note|rm|page|\d{4}|total|as at|for the)/i)&&S.length<50)return;const W=S.match(/^(.+?)\s+([\d,]+(?:\.\d{2})?)\s*(?:[\d,]+(?:\.\d{2})?)?\s*$/),D=S.match(/^(.+?)\s+\(([\d,]+(?:\.\d{2})?)\)\s*$/),C=S.match(/^([A-Za-z][A-Za-z\s&,\-]+?)\s{2,}([\d,]+(?:\.\d{2})?)/);let O="",G=null;D?(O=D[1].trim(),G=-parseFloat(D[2].replace(/,/g,""))):W?(O=W[1].trim(),G=parseFloat(W[2].replace(/,/g,""))):C&&(O=C[1].trim(),G=parseFloat(C[2].replace(/,/g,""))),O&&G!==null&&O.length>2&&!O.match(/^\d+$/)&&Math.abs(G)>0&&v.push({idx:v.length,label:O,value:G,source:"pdf"})}),J(v),ke(S=>[...S,{t:"ok",m:` Parsed ${v.length} items from pasted text`}])},Ef=()=>{const u={SALES:["revenue","sales","turnover","income from operations","jualan","pendapatan"],PURCHASE:["cost of sales","cost of goods","cogs","direct costs","kos jualan","purchase"],DIRECT_LABOUR:["direct labour","direct labor","buruh langsung"],DEPRECIATION:["depreciation","susutnilai","amortisation","amortization"],SALARY:["salary","wages","staff cost","employee","gaji"],RENT:["rental","rent","sewa"],UTILITIES:["utility","utilities","electric","water","tnb","air"],INTEREST_INC:["interest income","pendapatan faedah"],INTEREST_EXP:["interest expense","finance cost","borrowing cost","kos kewangan","faedah"],TAX_EXPENSE:["tax","taxation","income tax","cukai"],PPE:["property plant equipment","ppe","fixed asset","net book value","nbv","aset tetap"],INTANGIBLES:["intangible","goodwill","trademark"],INVESTMENTS:["investment","pelaburan"],INVENTORY:["inventory","stock","inventories","inventori"],TRADE_RECEIVABLES:["trade receivable","accounts receivable","debtors","penghutang dagangan"],OTHER_RECEIVABLES:["other receivable","prepaid","deposit","penghutang lain"],CASH_BANK:["cash","bank","cash and cash equivalent","tunai"],LONG_TERM_LOAN:["long term","term loan","long-term borrowing","pinjaman jangka panjang"],DEFERRED_TAX:["deferred tax","cukai tertunda"],SHORT_TERM_LOAN:["short term borrowing","bank overdraft","pinjaman jangka pendek","loan"],TRADE_PAYABLES:["trade payable","accounts payable","creditors","pemiutang dagangan"],OTHER_PAYABLES:["other payable","accrual","accrued","pemiutang lain"],TAX_PAYABLE:["tax payable","cukai kena bayar"],SHARE_CAPITAL:["share capital","issued capital","paid-up capital","modal saham"],RETAINED_PROFITS:["retained","accumulated profit","retained earning","keuntungan terkumpul"]};let y=0;const v=["SALES","SERVICE_REVENUE","PURCHASE","DIRECT_COSTS","SALARY","RENT","UTILITIES","DEPRECIATION","OFFICE_SUPPLIES","PROFESSIONAL_FEES","MARKETING","TRANSPORT","ENTERTAINMENT","INSURANCE","REPAIR_MAINTENANCE","TELEPHONE","BANK_CHARGES","MISC_EXPENSE","INTEREST_EXP","TAX_EXPENSE","PPE","INTANGIBLES","INVESTMENTS","INVENTORY","TRADE_RECEIVABLES","OTHER_RECEIVABLES","CASH_BANK","LONG_TERM_LOAN","DEFERRED_TAX","SHORT_TERM_LOAN","TRADE_PAYABLES","OTHER_PAYABLES","TAX_PAYABLE","SHARE_CAPITAL","RETAINED_PROFITS"];Ze(S=>S.map(T=>{const W=u[T.id]||[T.label.toLowerCase()],D=Y.find(C=>W.some(O=>C.label.toLowerCase().includes(O)));if(D){y++;const C=v.includes(T.id)?Math.abs(D.value):D.value;return{...T,value:String(C),mapped:D.label}}return T})),Xe(S=>S.map(T=>{const W=u[T.id]||[T.label.toLowerCase()],D=Y.find(C=>W.some(O=>C.label.toLowerCase().includes(O)));if(D){y++;const C=v.includes(T.id)?Math.abs(D.value):D.value;return{...T,value:String(C),mapped:D.label}}return T})),ke(S=>[...S,{t:"ok",m:` Auto-mapped ${y} items`}])},tt=(()=>{const u={revenue:0,cos:0,depreciation:0,admin:0,oi:0,oe:0,fin:0,tax:0};return Ye.forEach(y=>{const v=parseFloat(y.value)||0;y.section==="revenue"||y.type==="revenue"?u.revenue+=v:y.section==="cost_of_sales"||y.type==="cogs"?u.cos+=v:y.section==="operating_expenses"||y.type==="expense"?(y.id==="DEPRECIATION"&&(u.depreciation+=v),u.admin+=v):y.section==="other_income"||y.type==="other_income"?u.oi+=v:y.section==="other_expenses"||y.type==="other_expense"?u.oe+=v:y.section==="finance_costs"||y.type==="finance"?u.fin+=v:(y.section==="tax"||y.type==="tax")&&(u.tax+=v)}),u.gp=u.revenue-u.cos,u.totalAdminWithDep=u.admin,u.op=u.gp-u.admin,u.pbt=u.op+u.oi-u.oe-u.fin,u.np=u.pbt-u.tax,u.nca=0,u.ca=0,u.ncl=0,u.cl=0,u.equity=0,u.ppe=0,u.intangibles=0,u.investments=0,u.bank=0,u.tr=0,u.or=0,u.inv=0,u.ltLoan=0,u.defTax=0,u.loan=0,u.tp=0,u.op_pay=0,u.taxPay=0,u.gstSst=0,u.cap=0,u.ret=0,u.reserves=0,He.forEach(y=>{const v=parseFloat(y.value)||0;y.type==="nca"?u.nca+=v:y.type==="ca"?u.ca+=v:y.type==="ncl"?u.ncl+=v:y.type==="cl"?u.cl+=v:y.type==="equity"&&(u.equity+=v),y.id==="PPE"&&(u.ppe=v),y.id==="INTANGIBLES"&&(u.intangibles=v),y.id==="INVESTMENTS"&&(u.investments=v),y.id==="CASH_BANK"&&(u.bank=v),y.id==="TRADE_RECEIVABLES"&&(u.tr=v),y.id==="OTHER_RECEIVABLES"&&(u.or=v),y.id==="INVENTORY"&&(u.inv=v),y.id==="LONG_TERM_LOAN"&&(u.ltLoan=v),y.id==="DEFERRED_TAX"&&(u.defTax=v),y.id==="SHORT_TERM_LOAN"&&(u.loan=v),y.id==="TRADE_PAYABLES"&&(u.tp=v),y.id==="OTHER_PAYABLES"&&(u.op_pay=v),y.id==="TAX_PAYABLE"&&(u.taxPay=v),y.id==="GST_SST_PAYABLE"&&(u.gstSst=v),y.id==="SHARE_CAPITAL"&&(u.cap=v),y.id==="RETAINED_PROFITS"&&(u.ret=v)}),u.totA=u.nca+u.ca,u.totL=u.ncl+u.cl,u.totE=u.equity,u.totLE=u.totL+u.totE,u.diff=u.totA-u.totLE,u.balanced=Math.abs(u.diff)<1,u})(),Ss={revenue:String(tt.revenue),cost_of_sales:String(tt.cos),admin_expenses:String(tt.admin),other_income:String(tt.oi),finance_costs:String(tt.fin),tax:String(tt.tax)},Tt={ppe:String(tt.ppe),intangibles:String(tt.intangibles),investments:String(tt.investments),bank:String(tt.bank),trade_receivables:String(tt.tr),other_receivables:String(tt.or),inventory:String(tt.inv),long_term_loan:String(tt.ltLoan),deferred_tax:String(tt.defTax),loan:String(tt.loan),trade_payables:String(tt.tp),other_payables:String(tt.op_pay),tax_payable:String(tt.taxPay),share_capital:String(tt.cap),retained_profits:String(tt.ret),reserves:String(tt.reserves)},Tf=()=>{if(Zn.name){const u=Zn.name.toLowerCase().replace(/\s+/g,"_");Fn(v=>[...v,{id:u,name:Zn.name,accNo:Zn.accNo}]);const y={};pi.forEach(v=>{y[v]={uploaded:!1,txCount:0,file:null}}),Zr(v=>({...v,[u]:y})),cs({name:"",accNo:""}),ke(v=>[...v,{t:"ok",m:` Added bank: ${Zn.name}`}])}},S0=(u,y)=>{const S=ya.find(W=>W.id===u)?.name||u,T=_.filter(W=>W.bankAccount===S&&W.month===y);if(T.length===0){ke(W=>[...W,{t:"warn",m:` No transactions found for ${S} - ${y}`}]);return}w(W=>W.filter(D=>!(D.bankAccount===S&&D.month===y))),Zr(W=>({...W,[u]:{...W[u],[y]:{uploaded:!1,txCount:0,file:null}}})),ke(W=>[...W,{t:"ok",m:` Removed ${T.length} transactions (${S} - ${y})`}])},Af=async u=>{const y=Array.from(u.target.files||[]);if(!y.length||!Xt)return;Pe(!0);let v=[...et];for(const S of y){try{const T=S.type==="application/pdf"||S.name.toLowerCase().endsWith(".pdf"),W=S.name.toLowerCase().endsWith(".xlsx")||S.name.toLowerCase().endsWith(".xls");if(T)v.push({t:"info",m:` PDF detected: ${S.name}`}),v.push({t:"warn",m:" PDF parsing requires manual text extraction. Please copy text from PDF and paste below."}),ke([...v]),Zr(D=>({...D,[Xt]:{...D[Xt],[ur]:{uploaded:!0,txCount:0,file:S.name,needsManual:!0}}}));else if(W){const D=`Reading Excel: ${S.name}...`;v.push({t:"info",m:D}),ke([...v]);const C=await S.arrayBuffer(),O=nf(C,{type:"array",cellDates:!0}),G=O.SheetNames[0],xe=O.Sheets[G],ye=Sa.sheet_to_json(xe,{header:1,defval:""}).map(Me=>Me.join(",")).join(`
`),X=ya.find(Me=>Me.id===Xt),V=Fp(ye,S.name,X?.name||Xt,ur,L);v=v.filter(Me=>Me.m!==D),V.length>0?(w(Me=>[...Me,...V]),Zr(Me=>({...Me,[Xt]:{...Me[Xt],[ur]:{uploaded:!0,txCount:V.length,file:S.name}}})),v.push({t:"ok",m:` ${S.name}: ${V.length} transactions (${X?.name} - ${ur})`})):v.push({t:"warn",m:` ${S.name}: No transactions found`})}else{const D=`Reading: ${S.name}...`;v.push({t:"info",m:D}),ke([...v]);const C=await S.text(),O=ya.find(xe=>xe.id===Xt),G=Fp(C,S.name,O?.name||Xt,ur,L);v=v.filter(xe=>xe.m!==D),G.length>0?(w(xe=>[...xe,...G]),Zr(xe=>({...xe,[Xt]:{...xe[Xt],[ur]:{uploaded:!0,txCount:G.length,file:S.name}}})),v.push({t:"ok",m:` ${S.name}: ${G.length} transactions (${O?.name} - ${ur})`})):v.push({t:"warn",m:` ${S.name}: No transactions found`})}}catch(T){v=v.filter(W=>!W.m.includes("Reading:")),v.push({t:"err",m:` ${S.name}: ${T.message}`})}ke([...v])}Pe(!1),Je.current&&(Je.current.value="")},_f=()=>{if(!jn.trim()||!Xt)return;const u=ya.find(v=>v.id===Xt),y=Fp(jn,"PDF-Paste",u?.name||Xt,ur,L);y.length>0?(w(v=>[...v,...y]),Zr(v=>({...v,[Xt]:{...v[Xt],[ur]:{uploaded:!0,txCount:y.length,file:"Pasted PDF text"}}})),ke(v=>[...v,{t:"ok",m:` Parsed ${y.length} transactions from pasted text (${u?.name} - ${ur})`}]),ds("")):ke(v=>[...v,{t:"warn",m:" No transactions found in pasted text"}])},Cf=()=>{const u={};if(Tt.ppe){const y=parseFloat(Tt.ppe)||0;u.fixed_asset=y,u.accumulated_depreciation=0}Tt.trade_receivables&&(u.trade_receivables=parseFloat(Tt.trade_receivables)||0),Tt.inventory&&(u.inventory=parseFloat(Tt.inventory)||0),Tt.other_receivables&&(u.other_receivables=parseFloat(Tt.other_receivables)||0),Tt.bank&&(ya.length>0?u[`bank_${ya[0].name.toLowerCase().replace(/\s+/g,"_")}`]=parseFloat(Tt.bank)||0:u.bank=parseFloat(Tt.bank)||0),Tt.long_term_loan&&(u.long_term_loan=-(parseFloat(Tt.long_term_loan)||0)),Tt.loan&&(u.loan=-(parseFloat(Tt.loan)||0)),Tt.trade_payables&&(u.trade_payables=-(parseFloat(Tt.trade_payables)||0)),Tt.other_payables&&(u.other_payables=-(parseFloat(Tt.other_payables)||0)),Tt.tax_payable&&(u.tax_payable=-(parseFloat(Tt.tax_payable)||0)),Tt.share_capital&&(u.share_capital=-(parseFloat(Tt.share_capital)||0)),Tt.retained_profits&&(u.retained_profits=-(parseFloat(Tt.retained_profits)||0)),Tt.reserves&&(u.reserves=-(parseFloat(Tt.reserves)||0)),oe(u),ke(y=>[...y,{t:"ok",m:` Prior year (${fe}) balances applied`}]),ke(y=>[...y,{t:"warn",m:" PPE set as NBV. Update PPE register with actual cost/acc dep for accurate depreciation."}])},kf=()=>{i("SDN_BHD"),c("ABC Trading Sdn Bhd"),p("202401012345"),h("12"),A("MPERS"),Q(2024),Ke(2023),Fn(Wm);const u={};Wm.forEach(S=>{u[S.id]={},pi.forEach(T=>{u[S.id][T]={uploaded:!1,txCount:0,file:null}})}),u.maybank.Jan={uploaded:!0,txCount:2,file:"Sample"},u.maybank.Feb={uploaded:!0,txCount:1,file:"Sample"},u.maybank.Mar={uploaded:!0,txCount:1,file:"Sample"},u.cimb.Feb={uploaded:!0,txCount:1,file:"Sample"},u.cimb.Mar={uploaded:!0,txCount:1,file:"Sample"},Zr(u),w(R8);const y=Ae();y.forEach(S=>{S.id==="SALES"?S.value="500000":S.id==="PURCHASE"?S.value="280000":S.id==="FREIGHT_IN"?S.value="20000":S.id==="SALARY"?S.value="50000":S.id==="EPF"?S.value="6000":S.id==="SOCSO"?S.value="1000":S.id==="RENT"?S.value="12000":S.id==="UTILITIES"?S.value="5000":S.id==="DEPRECIATION"?S.value="8000":S.id==="INTEREST_INC"?S.value="2000":S.id==="BANK_CHARGES"?S.value="1500":S.id==="INTEREST_EXP"?S.value="3500":S.id==="TAX_EXPENSE"&&(S.value="28250")}),Ze(y);const v=Ge();v.forEach(S=>{S.id==="PPE"?S.value="92000":S.id==="INVENTORY"?S.value="35000":S.id==="TRADE_RECEIVABLES"?S.value="45000":S.id==="OTHER_RECEIVABLES"?S.value="12000":S.id==="CASH_BANK"?S.value="100000":S.id==="SHORT_TERM_LOAN"?S.value="50000":S.id==="TRADE_PAYABLES"?S.value="25000":S.id==="OTHER_PAYABLES"?S.value="9000":S.id==="TAX_PAYABLE"?S.value="10000":S.id==="SHARE_CAPITAL"?S.value="100000":S.id==="RETAINED_PROFITS"&&(S.value="90000")}),Xe(v),oe({fixed_asset:12e4,accumulated_depreciation:-28e3,inventory:35e3,trade_receivables:45e3,other_receivables:12e3,bank_maybank:7e4,bank_cimb:3e4,loan:-5e4,trade_payables:-25e3,other_payables:-9e3,tax_payable:-1e4,share_capital:-1e5,retained_profits:-9e4}),Ha([{id:"ppe_1",description:"Office Computer (Dell Desktop)",category:"OFFICE_EQUIPMENT",acquisitionDate:"2022-01-01",cost:5e3,residualValue:500,accDepBF:2250},{id:"ppe_2",description:"Office Furniture & Fittings",category:"FURNITURE_FITTINGS",acquisitionDate:"2021-01-01",cost:15e3,residualValue:1500,accDepBF:4050},{id:"ppe_3",description:"Company Vehicle (Proton X70)",category:"MOTOR_VEHICLES",acquisitionDate:"2022-07-01",cost:1e5,residualValue:2e4,accDepBF:21700}]),Gr([{id:"inv_1",itemCode:"SKU-001",description:"Product A - Widget Standard",qty:100,unitCost:120,category:"Finished Goods"},{id:"inv_2",itemCode:"SKU-002",description:"Product B - Widget Premium",qty:50,unitCost:200,category:"Finished Goods"},{id:"inv_3",itemCode:"RAW-001",description:"Raw Material - Steel Sheet",qty:100,unitCost:80,category:"Raw Materials"},{id:"inv_4",itemCode:"RAW-002",description:"Raw Material - Plastic Pellets",qty:300,unitCost:10,category:"Raw Materials"}]),On([{id:"ar_1",customerName:"XYZ Enterprise Sdn Bhd",invoiceNo:"INV-2023-088",invoiceDate:"2023-11-15",dueDate:"2023-12-14",amount:2e4,paid:0},{id:"ar_2",customerName:"ABC Trading Co",invoiceNo:"INV-2023-092",invoiceDate:"2023-12-01",dueDate:"2024-01-01",amount:15e3,paid:0},{id:"ar_3",customerName:"DEF Industries",invoiceNo:"INV-2023-095",invoiceDate:"2023-12-20",dueDate:"2024-01-19",amount:1e4,paid:0}]),ei([{id:"ap_1",supplierName:"Supplier One Sdn Bhd",invoiceNo:"SUP-2023-045",invoiceDate:"2023-11-20",dueDate:"2023-12-19",amount:12e3,paid:0},{id:"ap_2",supplierName:"Material Supplies Co",invoiceNo:"SUP-2023-052",invoiceDate:"2023-12-15",dueDate:"2024-01-14",amount:8e3,paid:0},{id:"ap_3",supplierName:"Equipment Parts Ltd",invoiceNo:"SUP-2023-058",invoiceDate:"2023-12-28",dueDate:"2024-01-27",amount:5e3,paid:0}]),ir([{id:"od_1",description:"Rental Deposit - Office",type:"DEPOSIT",amount:6e3,remarks:"3 months deposit for office rental"},{id:"od_2",description:"Utilities Deposit - TNB",type:"DEPOSIT",amount:2e3,remarks:"Electricity deposit"},{id:"od_3",description:"Prepaid Insurance",type:"PREPAID",amount:3e3,remarks:"Insurance premium paid in advance"},{id:"od_4",description:"Staff Advance - Ahmad",type:"ADVANCE",amount:1e3,remarks:"Salary advance to be deducted"}]),fs([{id:"oc_1",description:"Accrued Audit Fee",type:"ACCRUAL",amount:4e3,remarks:"Year-end audit fee"},{id:"oc_2",description:"Accrued Bonus",type:"ACCRUAL",amount:3e3,remarks:"Staff bonus payable"},{id:"oc_3",description:"Customer Deposit Received",type:"DEPOSIT_RECEIVED",amount:2e3,remarks:"Deposit from customer for future order"}]),ji([{id:"cb_1",accountName:"Maybank Current Account",bankName:"Maybank",accountNo:"5123-4567-8901",openingBalance:7e4,closingBalance:116e3,reconciled:!0},{id:"cb_2",accountName:"CIMB Current Account",bankName:"CIMB",accountNo:"1234-5678-9012",openingBalance:3e4,closingBalance:25650,reconciled:!0}]),ke([{t:"ok",m:" Comprehensive sample loaded: Sdn Bhd, 2 banks, 6 transactions, Prior FS, Opening Balances, PPE Register (3 assets), Inventory (4 items), AR (3 customers), AP (3 suppliers), Other Debtors (4 items), Other Creditors (3 items), Cash Ledger (2 accounts)"}]),a("priorfs")},wf=()=>{de.acc&&de.amt&&(oe(u=>({...u,[de.acc.toLowerCase().replace(/\s+/g,"_")]:parseFloat(de.amt)})),Ce({acc:"",amt:""}))},Rf=u=>w(y=>y.filter((v,S)=>S!==u)),xl=(u,y,v)=>w(S=>S.map((T,W)=>W===u?{...T,[y]:y==="amount"?parseFloat(v)||0:v}:T)),qo=()=>`${JSON.stringify({ob:le,banks:ya,txsLength:_.length,cashTxsLength:N.length,subledgerCounts:{ppe:ft.length,inv:pr.length,ar:Aa.length,ap:sa.length},currentYear:L,companyName:s}).length}-${_.length+N.length}`,ml=(u,y,v)=>{const S=[],T=u.snapshotRes,W=.01,D=(We,Ve)=>Math.abs((We||0)-(Ve||0))>W;[{key:"rev",label:"Total Revenue",type:"Reclass",category:"IS"},{key:"cos",label:"Total Cost of Sales",type:"Reclass",category:"IS"},{key:"gp",label:"Gross Profit",type:"Reclass",category:"IS"},{key:"adm",label:"Total Admin Expenses",type:"Reclass",category:"IS"},{key:"oi",label:"Total Other Income",type:"Reclass",category:"IS"},{key:"oe",label:"Total Other Expenses",type:"Reclass",category:"IS"},{key:"fin",label:"Total Finance Costs",type:"Reclass",category:"IS"},{key:"dep",label:"Depreciation",type:"Depreciation",category:"IS"},{key:"pbt",label:"Profit Before Tax",type:"Reclass",category:"IS"},{key:"tax",label:"Tax Expense",type:"TaxAdj",category:"IS"},{key:"np",label:"Net Profit",type:"Reclass",category:"IS"}].forEach(({key:We,label:Ve,type:it,category:Vt})=>{const lt=T.is?.[We]||0,Fa=y.is?.[We]||0;if(D(lt,Fa)){const Ka=Fa-lt;S.push({id:`ADJ-${Date.now()}-is-${We}`,date:new Date().toISOString().split("T")[0],periodLabel:v,type:it,category:Vt,field:Ve,oldValue:lt,newValue:Fa,amount:Ka,description:`${Ve}: ${ae(lt)}  ${ae(Fa)}`,isAuto:!0,createdAt:new Date().toISOString()})}});const O=T.is?.details||{},G=y.is?.details||{};new Set([...Object.keys(O),...Object.keys(G)]).forEach(We=>{const Ve=O[We]||0,it=G[We]||0;if(D(Ve,it)){const Vt=it-Ve,lt=cn.rules[We],Fa=lt?.label||We,Ka=lt?.type==="revenue"||lt?.type==="other_income"||lt?.type==="cogs"||lt?.type==="expense"?"Reclass":"Correction";S.push({id:`ADJ-${Date.now()}-det-${We}`,date:new Date().toISOString().split("T")[0],periodLabel:v,type:Ka,category:"IS-Detail",field:Fa,glCode:We,oldValue:Ve,newValue:it,amount:Vt,description:`${Fa} (${We}): ${ae(Ve)}  ${ae(it)}`,isAuto:!0,createdAt:new Date().toISOString()})}}),[{key:"ppe",label:"PPE (Net)",type:"Correction",category:"BS-NCA"},{key:"ppe_cost",label:"PPE Cost",type:"Correction",category:"BS-NCA"},{key:"ppe_accDep",label:"Accumulated Depreciation",type:"Depreciation",category:"BS-NCA"},{key:"inv",label:"Inventory",type:"Correction",category:"BS-CA"},{key:"tr",label:"Trade Receivables",type:"Correction",category:"BS-CA"},{key:"or",label:"Other Receivables",type:"Correction",category:"BS-CA"},{key:"cash",label:"Cash & Bank",type:"Correction",category:"BS-CA"},{key:"cashInHand",label:"Cash in Hand",type:"Correction",category:"BS-CA"},{key:"totCA",label:"Total Current Assets",type:"Correction",category:"BS-CA"},{key:"totNCA",label:"Total Non-Current Assets",type:"Correction",category:"BS-NCA"},{key:"totA",label:"Total Assets",type:"Correction",category:"BS"},{key:"tp",label:"Trade Payables",type:"Correction",category:"BS-CL"},{key:"op",label:"Other Payables",type:"Correction",category:"BS-CL"},{key:"borr",label:"ST Borrowings",type:"Correction",category:"BS-CL"},{key:"ltBorr",label:"LT Borrowings",type:"Correction",category:"BS-NCL"},{key:"taxPay",label:"Tax Payable",type:"TaxAdj",category:"BS-CL"},{key:"totCL",label:"Total Current Liabilities",type:"Correction",category:"BS-CL"},{key:"totNCL",label:"Total Non-Current Liabilities",type:"Correction",category:"BS-NCL"},{key:"totL",label:"Total Liabilities",type:"Correction",category:"BS"},{key:"cap",label:"Share Capital",type:"Correction",category:"BS-EQ"},{key:"ret",label:"Retained Earnings",type:"Correction",category:"BS-EQ"},{key:"cyp",label:"Current Year Profit",type:"Correction",category:"BS-EQ"},{key:"totE",label:"Total Equity",type:"Correction",category:"BS-EQ"}].forEach(({key:We,label:Ve,type:it,category:Vt})=>{const lt=T.bs?.[We]||0,Fa=y.bs?.[We]||0;if(D(lt,Fa)){const Ka=Fa-lt;S.push({id:`ADJ-${Date.now()}-bs-${We}`,date:new Date().toISOString().split("T")[0],periodLabel:v,type:it,category:Vt,field:Ve,oldValue:lt,newValue:Fa,amount:Ka,description:`${Ve}: ${ae(lt)}  ${ae(Fa)}`,isAuto:!0,createdAt:new Date().toISOString()})}});const ye=u.snapshotMeta?.counts?.bankTxs||0,X=u.snapshotMeta?.counts?.cashTxs||0,V=_.length,Me=N.length;ye!==V&&S.push({id:`ADJ-${Date.now()}-banktx`,date:new Date().toISOString().split("T")[0],periodLabel:v,type:"Other",category:"Count",field:"Bank Transactions",oldValue:ye,newValue:V,amount:V-ye,description:`Bank Transactions: ${ye}  ${V}`,isAuto:!0,createdAt:new Date().toISOString()}),X!==Me&&S.push({id:`ADJ-${Date.now()}-cashtx`,date:new Date().toISOString().split("T")[0],periodLabel:v,type:"Other",category:"Count",field:"Cash Vouchers",oldValue:X,newValue:Me,amount:Me-X,description:`Cash Vouchers: ${X}  ${Me}`,isAuto:!0,createdAt:new Date().toISOString()});const Be=u.snapshotMeta?.counts?.jes||0,pe=y.jes?.length||0;return Be!==pe&&S.push({id:`ADJ-${Date.now()}-jecount`,date:new Date().toISOString().split("T")[0],periodLabel:v,type:"Other",category:"Count",field:"Journal Entries",oldValue:Be,newValue:pe,amount:pe-Be,description:`Journal Entries: ${Be}  ${pe}`,isAuto:!0,createdAt:new Date().toISOString()}),S},Nf=()=>{if(!m){alert("Please generate FS first before saving a snapshot.");return}const{periodType:u,periodLabel:y,note:v,createdBy:S}=Rr;if(!y.trim()){alert('Please enter a period label (e.g., "2025-01" for monthly or "FY2025" for yearly)');return}const T=Ia.filter(G=>G.periodLabel===y&&G.periodType===u).sort((G,xe)=>xe.version-G.version),W=T.map(G=>G.version),D=W.length>0?Math.max(...W)+1:1;let C=[];if(T.length>0){const G=T[0];C=ml(G,m,y.trim())}const O={id:`SNAP-${Date.now()}`,periodType:u,periodLabel:y.trim(),version:D,createdAt:new Date().toISOString(),createdBy:S||"Accountant",note:v.trim(),inputsHash:qo(),snapshotRes:JSON.parse(JSON.stringify(m)),snapshotMeta:{companyName:s,companyRegNo:f,companyType:t,accountingStandard:E,currentYear:L,financialYearEnd:g,counts:{bankTxs:_.length,cashTxs:N.length,jes:m.jes?m.jes.length:0}},previousVersionId:T.length>0?T[0].id:null};C.length>0&&Sr(G=>[...C,...G]),nr(G=>[O,...G]),Rn(!1),Wt({periodType:"Monthly",periodLabel:"",note:"",createdBy:"Accountant"}),C.length>0?alert(`Snapshot saved: ${y} v${D}

${C.length} change(s) auto-detected and logged.`):alert(`Snapshot saved: ${y} v${D}`)},E0=u=>{confirm(`Load snapshot "${u.periodLabel} v${u.version}"?

This will show the snapshot's FS in the preview.`)&&(Se(u.snapshotRes),a("journal"))},T0=u=>{confirm("Delete this snapshot?")&&nr(y=>y.filter(v=>v.id!==u))},A0=()=>{const{periodLabel:u,type:y,amount:v,description:S}=Qr;if(!u.trim()||!S.trim()){alert("Please enter period label and description");return}const T={id:`ADJ-${Date.now()}`,date:new Date().toISOString().split("T")[0],periodLabel:u.trim(),type:y,amount:parseFloat(v)||0,description:S.trim(),isAuto:!1,createdAt:new Date().toISOString()};Sr(W=>[T,...W]),Ea({periodLabel:"",type:"Correction",amount:"",description:""})},_0=u=>{confirm("Delete this adjustment entry?")&&Sr(y=>y.filter(v=>v.id!==u))},C0=()=>{if(!Dt.amount)return null;const u=Math.abs(parseFloat(Dt.amount)||0);if(u===0)return null;const y=Dt.type==="in",v=Dt.type.includes("bank"),S=Dt.classification||(v?"CASH_TRANSFER":"SUSPENSE"),T=ab[S]||S,W=cn.rules[T],D="Cash on Hand",C="Bank";let O="",G="";if(Dt.type==="bank_to_cash")O=D,G=C;else if(Dt.type==="cash_to_bank")O=C,G=D;else if(W){const xe=W.type;xe==="revenue"||xe==="other_income"?(O=D,G=W.label||T):xe==="cogs"||xe==="expense"||xe==="finance"||xe==="other_expense"||xe==="drawings"?(O=W.label||T,G=D):(O=y?D:"Suspense",G=y?"Suspense":D)}else O=y?D:"Suspense",G=y?"Suspense":D;return{drAcc:O,crAcc:G,amt:u}},Es=()=>{if(!Dt.description||!Dt.amount){alert("Please enter description and amount");return}const u=parseFloat(Dt.amount);if(isNaN(u)||u===0){alert("Please enter a valid amount");return}let y=Math.abs(u);(Dt.type==="out"||Dt.type==="cash_to_bank")&&(y=-y);const v={date:Dt.date,description:Dt.description,reference:Dt.reference,amount:y,month:new Date(Dt.date).toLocaleString("en",{month:"short"}).toUpperCase(),classification:Dt.classification||(Dt.type.includes("bank")?"CASH_TRANSFER":""),source:"Cash",cashLedger:"PETTY_CASH",transferDirection:Dt.type.includes("bank")?Dt.type:null};k(S=>[...S,v]),yt({date:new Date().toISOString().split("T")[0],description:"",reference:`CV-${String(N.length+2).padStart(3,"0")}`,amount:"",type:"out",classification:""})},k0=()=>{Pe(!0),setTimeout(()=>{const u={revenue:parseFloat(Ss.revenue)||0,cost_of_sales:parseFloat(Ss.cost_of_sales)||0,admin_expenses:parseFloat(Ss.admin_expenses)||0,other_income:parseFloat(Ss.other_income)||0,other_expenses:tt.oe||0,finance_costs:parseFloat(Ss.finance_costs)||0,tax:parseFloat(Ss.tax)||0},y={ppe:parseFloat(Tt.ppe)||0,intangibles:parseFloat(Tt.intangibles)||0,investments:parseFloat(Tt.investments)||0,inventory:parseFloat(Tt.inventory)||0,trade_receivables:parseFloat(Tt.trade_receivables)||0,other_receivables:parseFloat(Tt.other_receivables)||0,bank:parseFloat(Tt.bank)||0,long_term_loan:parseFloat(Tt.long_term_loan)||0,deferred_tax:parseFloat(Tt.deferred_tax)||0,loan:parseFloat(Tt.loan)||0,trade_payables:parseFloat(Tt.trade_payables)||0,other_payables:parseFloat(Tt.other_payables)||0,tax_payable:parseFloat(Tt.tax_payable)||0,share_capital:parseFloat(Tt.share_capital)||0,retained_profits:parseFloat(Tt.retained_profits)||0,reserves:parseFloat(Tt.reserves)||0},v={ppe:rt.ppe,inventory:rt.inventory,receivables:rt.receivables,payables:rt.payables,otherDebtors:rt.otherDebtors,otherCreditors:rt.otherCreditors,cashBank:rt.cashBank,depreciation:rt.ppe.currentDep,shortTermBorrowings:rt.shortTermBorrowings,longTermBorrowings:rt.longTermBorrowings,hasSTBorrowings:rt.hasSTBorrowings,hasLTBorrowings:rt.hasLTBorrowings,borrowingsDrawdowns:rt.borrowingsDrawdowns,borrowingsRepayments:rt.borrowingsRepayments,stBorrOpening:rt.stBorrOpening,ltBorrOpening:rt.ltBorrOpening},S=[..._,...N],T=cn.process(S,le,u,y,Jn,v,Ye,He),W=Qn(T.is.pbt);T.taxComputation={pbt:T.is.pbt,totalAddBack:yi(),adjustedProfit:W.adjustedProfit,capitalAllowance:W.capitalAllowance,otherDeductions:W.totalDeductions-W.capitalAllowance,taxableIncome:W.taxableIncome,grossTax:W.grossTax,zakat:W.zakat,netTax:W.netTax,brackets:W.brackets},Se(T),Pe(!1),a("journal")},400)},Ff=(u="EN")=>{if(!m)return alert("Please generate financial statements first before exporting."),null;try{const y=s||"Company Name",v=f||"____________",S=Ot?.fullStandard||"Malaysian Private Entities Reporting Standard",T=Ot?.standard||"MPERS",W=Ot?.taxInfo||"24%",D=Ot?.name||"Private Limited Company",C=u==="EN",O={title:C?"FINANCIAL STATEMENTS":"PENYATA KEWANGAN",forYear:C?"FOR THE FINANCIAL YEAR ENDED":"BAGI TAHUN KEWANGAN BERAKHIR",asAt:C?"AS AT":"PADA",regNo:C?"Registration No.":"No. Pendaftaran",contents:C?"CONTENTS":"KANDUNGAN",sofp:C?"STATEMENT OF FINANCIAL POSITION":"PENYATA KEDUDUKAN KEWANGAN",sopl:C?"STATEMENT OF PROFIT OR LOSS AND OTHER COMPREHENSIVE INCOME":"PENYATA UNTUNG RUGI DAN PENDAPATAN KOMPREHENSIF LAIN",soce:C?"STATEMENT OF CHANGES IN EQUITY":"PENYATA PERUBAHAN EKUITI",socf:C?"STATEMENT OF CASH FLOWS":"PENYATA ALIRAN TUNAI",notes:C?"NOTES TO THE FINANCIAL STATEMENTS":"NOTA-NOTA KEPADA PENYATA KEWANGAN",statementByDirectors:C?"STATEMENT BY DIRECTORS":"PENYATA PENGARAH",statutoryDeclaration:C?"STATUTORY DECLARATION":"AKUAN BERKANUN",revenue:C?"Revenue":"Hasil",costOfSales:C?"Cost of sales":"Kos jualan",grossProfit:C?"Gross profit":"Untung kasar",otherIncome:C?"Other income":"Pendapatan lain",adminExp:C?"Administrative expenses":"Perbelanjaan pentadbiran",finCosts:C?"Finance costs":"Kos kewangan",pbt:C?"Profit before taxation":"Untung sebelum cukai",tax:C?"Taxation":"Cukai",profitYear:C?"Profit for the financial year":"Untung bagi tahun kewangan",oci:C?"Other comprehensive income":"Pendapatan komprehensif lain",totalCI:C?"Total comprehensive income for the year":"Jumlah pendapatan komprehensif bagi tahun",assets:C?"ASSETS":"ASET",nca:C?"Non-Current Assets":"Aset Bukan Semasa",ppe:C?"Property, plant and equipment":"Hartanah, loji dan peralatan",ca:C?"Current Assets":"Aset Semasa",inventories:C?"Inventories":"Inventori",tradeRec:C?"Trade and other receivables":"Penghutang perdagangan dan lain-lain",cashBank:C?"Cash and bank balances":"Tunai dan baki bank",totalAssets:C?"TOTAL ASSETS":"JUMLAH ASET",equityLiab:C?"EQUITY AND LIABILITIES":"EKUITI DAN LIABILITI",equity:C?"Equity":"Ekuiti",shareCap:C?"Share capital":"Modal saham",retained:C?"Retained earnings":"Pendapatan tertahan",totalEquity:C?"Total Equity":"Jumlah Ekuiti",liabilities:C?"Liabilities":"Liabiliti",cl:C?"Current Liabilities":"Liabiliti Semasa",tradePay:C?"Trade and other payables":"Pemiutang perdagangan dan lain-lain",borrowings:C?"Borrowings":"Pinjaman",totalLiab:C?"Total Liabilities":"Jumlah Liabiliti",totalEL:C?"TOTAL EQUITY AND LIABILITIES":"JUMLAH EKUITI DAN LIABILITI",note:C?"Note":"Nota",rm:"RM",balanceAt:C?"Balance at":"Baki pada",total:C?"Total":"Jumlah",notesIntegral:C?"The accompanying notes form an integral part of these financial statements.":"Nota-nota yang disertakan merupakan sebahagian daripada penyata kewangan ini.",incMalaysia:C?"Incorporated in Malaysia":"Diperbadankan di Malaysia",page:C?"Page":"Muka Surat"},G=X=>X==null?"-":Number(X).toLocaleString("en-MY",{minimumFractionDigits:0,maximumFractionDigits:0}),xe=X=>X==null?"-":X<0?"("+G(Math.abs(X))+")":G(X);let Re="";return ft&&ft.length>0&&ft.forEach(X=>{const V=Ql(X);Re+="<tr><td>"+(X.description||"-")+"</td>",Re+='<td class="right">'+G(X.cost)+"</td>",Re+='<td class="right">'+G(V.accDepCF)+"</td>",Re+='<td class="right">'+G(V.nbv)+"</td></tr>"}),'<!DOCTYPE html><html lang="'+(C?"en":"ms")+'"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>'+y+" - "+O.title+" "+L+'</title><style>@page { size: A4; margin: 2cm; }@media print { .page { page-break-after: always; } .page:last-child { page-break-after: avoid; } }* { box-sizing: border-box; }body { font-family: "Times New Roman", Times, serif; font-size: 11pt; line-height: 1.5; color: #000; max-width: 210mm; margin: 0 auto; padding: 20px; }.page { page-break-after: always; page-break-inside: avoid; padding-bottom: 20px; margin-bottom: 20px; }.page:last-child { page-break-after: avoid; }.header { text-align: center; margin-bottom: 25px; page-break-after: avoid; }.header h1 { font-size: 14pt; font-weight: bold; margin: 0 0 5px 0; text-transform: uppercase; }.header h2 { font-size: 12pt; font-weight: bold; margin: 0 0 5px 0; text-transform: uppercase; }.header p { font-size: 11pt; margin: 3px 0; }.section-title { font-size: 11pt; font-weight: bold; text-transform: uppercase; margin: 20px 0 10px 0; page-break-after: avoid; }.subsection { font-size: 11pt; font-weight: bold; margin: 15px 0 8px 0; page-break-after: avoid; }table { width: 100%; border-collapse: collapse; margin: 10px 0; page-break-inside: avoid; }table.fs th, table.fs td { padding: 4px 8px; text-align: left; vertical-align: top; font-size: 10pt; }.right { text-align: right; }.center { text-align: center; }.bold { font-weight: bold; }.indent { padding-left: 15px; }.indent2 { padding-left: 30px; }.total td { border-top: 1px solid #000; font-weight: bold; }.double td { border-top: 2px solid #000; font-weight: bold; }.subtotal td { border-top: 1px solid #000; }.underline { border-bottom: 1px solid #000; }.note-text { font-size: 10pt; margin: 8px 0; text-align: justify; line-height: 1.6; }.note-table th, .note-table td { border: 1px solid #000; padding: 4px 6px; font-size: 9pt; }.note-table th { background: #f5f5f5; font-weight: bold; }.toc-item { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px dotted #ccc; }.company-header { text-align: right; font-size: 9pt; margin-bottom: 10px; color: #666; }.keep-together { page-break-inside: avoid; }</style></head><body><div class="page" style="display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center;"><div style="margin-bottom: 80px;"><h1 style="font-size: 22pt; margin-bottom: 15px; letter-spacing: 1px;">'+y.toUpperCase()+'</h1><p style="font-size: 11pt;">('+O.regNo+": "+v+')</p><p style="font-size: 10pt; margin-top: 3px;">('+O.incMalaysia+')</p></div><div style="margin-bottom: 80px;"><h2 style="font-size: 18pt; font-weight: bold; letter-spacing: 2px;">'+O.title+'</h2><p style="font-size: 12pt; margin-top: 25px;">'+O.forYear+'</p><p style="font-size: 14pt; font-weight: bold; margin-top: 5px;">'+Zt.toUpperCase()+'</p></div><div style="margin-top: 60px;"><p style="font-size: 10pt; font-style: italic;">'+S+'</p></div></div><div class="page"><div class="header"><h1>'+y.toUpperCase()+'</h1></div><h2 style="text-align:center; margin-bottom:30px;">'+O.contents+'</h2><div style="max-width:400px; margin:0 auto;"><div class="toc-item"><span>'+O.sofp+'</span><span>3</span></div><div class="toc-item"><span>'+O.sopl+'</span><span>4</span></div><div class="toc-item"><span>'+O.soce+'</span><span>5</span></div><div class="toc-item"><span>'+O.socf+'</span><span>6</span></div><div class="toc-item"><span>'+O.notes+'</span><span>7 - 11</span></div></div></div><div class="page"><div class="company-header">'+y.toUpperCase()+" ("+v+')</div><div class="header"><h2>'+O.sofp+"</h2><p>"+O.asAt+" "+Zt.toUpperCase()+'</p></div><table class="fs"><thead><tr><th style="width:50%"></th><th class="center" style="width:8%">'+O.note+'</th><th class="right" style="width:21%">'+L+"<br>"+O.rm+'</th><th class="right" style="width:21%">'+fe+"<br>"+O.rm+'</th></tr></thead><tbody><tr><td class="bold">'+O.assets+'</td><td></td><td></td><td></td></tr><tr><td class="bold indent">'+O.nca+'</td><td></td><td></td><td></td></tr><tr><td class="indent2">'+O.ppe+'</td><td class="center">3</td><td class="right">'+G(m.bs.ppe)+'</td><td class="right">'+G(m.bs.py_ppe)+'</td></tr><tr class="subtotal"><td></td><td></td><td class="right">'+G(m.bs.totNCA)+'</td><td class="right">'+G(m.bs.py_totNCA)+'</td></tr><tr><td class="bold indent">'+O.ca+'</td><td></td><td></td><td></td></tr><tr><td class="indent2">'+O.inventories+'</td><td class="center">4</td><td class="right">'+G(m.bs.inv)+'</td><td class="right">'+G(m.bs.py_inv)+'</td></tr><tr><td class="indent2">'+O.tradeRec+'</td><td class="center">5</td><td class="right">'+G(m.bs.tr)+'</td><td class="right">'+G(m.bs.py_tr)+'</td></tr><tr><td class="indent2">'+O.cashBank+'</td><td class="center">6</td><td class="right">'+G(m.bs.cash)+'</td><td class="right">'+G(m.bs.py_cash)+'</td></tr><tr class="subtotal"><td></td><td></td><td class="right">'+G(m.bs.totCA)+'</td><td class="right">'+G(m.bs.py_totCA)+'</td></tr><tr class="double"><td class="bold">'+O.totalAssets+'</td><td></td><td class="right">'+G(m.bs.totA)+'</td><td class="right">'+G(m.bs.py_totA)+'</td></tr><tr><td colspan="4" style="height:15px"></td></tr><tr><td class="bold">'+O.equityLiab+'</td><td></td><td></td><td></td></tr><tr><td class="bold indent">'+O.equity+'</td><td></td><td></td><td></td></tr><tr><td class="indent2">'+O.shareCap+'</td><td class="center">7</td><td class="right">'+G(m.bs.cap)+'</td><td class="right">'+G(m.bs.py_cap)+'</td></tr><tr><td class="indent2">'+O.retained+'</td><td></td><td class="right">'+G(m.bs.ret+m.bs.cyp)+'</td><td class="right">'+G(m.bs.py_ret)+'</td></tr><tr class="subtotal"><td class="bold indent">'+O.totalEquity+'</td><td></td><td class="right">'+G(m.bs.totE)+'</td><td class="right">'+G(m.bs.py_totE)+'</td></tr><tr><td class="bold indent">'+O.cl+'</td><td></td><td></td><td></td></tr><tr><td class="indent2">'+O.tradePay+'</td><td class="center">8</td><td class="right">'+G(m.bs.tp)+'</td><td class="right">'+G(m.bs.py_tp)+'</td></tr><tr><td class="indent2">'+O.borrowings+'</td><td class="center">9</td><td class="right">'+G(m.bs.borr)+'</td><td class="right">'+G(m.bs.py_borr)+'</td></tr><tr class="subtotal"><td class="bold indent">'+O.totalLiab+'</td><td></td><td class="right">'+G(m.bs.totL)+'</td><td class="right">'+G(m.bs.py_totL)+'</td></tr><tr class="double"><td class="bold">'+O.totalEL+'</td><td></td><td class="right">'+G(m.bs.totE+m.bs.totL)+'</td><td class="right">'+G((m.bs.py_totE||0)+(m.bs.py_totL||0))+'</td></tr></tbody></table><p style="font-size:9pt; margin-top:20px; font-style:italic">'+O.notesIntegral+'</p></div><div class="page"><div class="company-header">'+y.toUpperCase()+" ("+v+')</div><div class="header"><h2>'+O.sopl+"</h2><p>"+O.forYear+" "+Zt.toUpperCase()+'</p></div><table class="fs"><thead><tr><th style="width:50%"></th><th class="center" style="width:8%">'+O.note+'</th><th class="right" style="width:21%">'+L+"<br>"+O.rm+'</th><th class="right" style="width:21%">'+fe+"<br>"+O.rm+"</th></tr></thead><tbody><tr><td>"+O.revenue+'</td><td class="center">10</td><td class="right">'+G(m.is.rev)+'</td><td class="right">'+G(m.is.py_rev)+"</td></tr><tr><td>"+O.costOfSales+'</td><td></td><td class="right">'+xe(-m.is.cos)+'</td><td class="right">'+xe(-(m.is.py_cos||0))+'</td></tr><tr class="subtotal"><td class="bold">'+O.grossProfit+'</td><td></td><td class="right">'+G(m.is.gp)+'</td><td class="right">'+G(m.is.py_gp)+"</td></tr><tr><td>"+O.otherIncome+'</td><td></td><td class="right">'+G(m.is.oi)+'</td><td class="right">'+G(m.is.py_oi)+"</td></tr><tr><td>"+O.adminExp+'</td><td class="center">11</td><td class="right">'+xe(-m.is.adm)+'</td><td class="right">'+xe(-(m.is.py_adm||0))+"</td></tr><tr><td>"+O.finCosts+'</td><td class="center">12</td><td class="right">'+xe(-m.is.fin)+'</td><td class="right">'+xe(-(m.is.py_fin||0))+'</td></tr><tr class="subtotal"><td class="bold">'+O.pbt+'</td><td></td><td class="right">'+G(m.is.pbt)+'</td><td class="right">'+G(m.is.py_pbt)+"</td></tr><tr><td>"+O.tax+'</td><td class="center">13</td><td class="right">'+xe(-m.is.tax)+'</td><td class="right">'+xe(-(m.is.py_tax||0))+'</td></tr><tr class="subtotal"><td class="bold">'+O.profitYear+'</td><td></td><td class="right">'+G(m.is.np)+'</td><td class="right">'+G(m.is.py_np)+"</td></tr><tr><td>"+O.oci+'</td><td></td><td class="right">-</td><td class="right">-</td></tr><tr class="double"><td class="bold">'+O.totalCI+'</td><td></td><td class="right">'+G(m.is.np)+'</td><td class="right">'+G(m.is.py_np)+'</td></tr></tbody></table><p style="font-size:9pt; margin-top:20px; font-style:italic">'+O.notesIntegral+'</p></div><div class="page"><div class="company-header">'+y.toUpperCase()+" ("+v+')</div><div class="header"><h2>'+O.soce+"</h2><p>"+O.forYear+" "+Zt.toUpperCase()+'</p></div><table class="fs"><thead><tr><th style="width:40%"></th><th class="right" style="width:20%">'+O.shareCap+"<br>"+O.rm+'</th><th class="right" style="width:20%">'+O.retained+"<br>"+O.rm+'</th><th class="right" style="width:20%">'+O.total+"<br>"+O.rm+"</th></tr></thead><tbody><tr><td>"+O.balanceAt+" 1.1."+fe+'</td><td class="right">'+G(m.bs.py_cap)+'</td><td class="right">'+G((m.bs.py_ret||0)-(m.is.py_np||0))+'</td><td class="right">'+G((m.bs.py_totE||0)-(m.is.py_np||0))+'</td></tr><tr><td class="indent">'+O.profitYear+'</td><td class="right">-</td><td class="right">'+G(m.is.py_np)+'</td><td class="right">'+G(m.is.py_np)+'</td></tr><tr><td class="indent">'+O.totalCI+'</td><td class="right">-</td><td class="right">'+G(m.is.py_np)+'</td><td class="right">'+G(m.is.py_np)+'</td></tr><tr class="subtotal"><td class="bold">'+O.balanceAt+" 31.12."+fe+'</td><td class="right">'+G(m.bs.py_cap)+'</td><td class="right">'+G(m.bs.py_ret)+'</td><td class="right">'+G(m.bs.py_totE)+'</td></tr><tr><td class="indent">'+O.profitYear+'</td><td class="right">-</td><td class="right">'+G(m.is.np)+'</td><td class="right">'+G(m.is.np)+'</td></tr><tr><td class="indent">'+O.totalCI+'</td><td class="right">-</td><td class="right">'+G(m.is.np)+'</td><td class="right">'+G(m.is.np)+'</td></tr><tr class="double"><td class="bold">'+O.balanceAt+" 31.12."+L+'</td><td class="right">'+G(m.bs.cap)+'</td><td class="right">'+G(m.bs.ret+m.bs.cyp)+'</td><td class="right">'+G(m.bs.totE)+'</td></tr></tbody></table><p style="font-size:9pt; margin-top:20px; font-style:italic">'+O.notesIntegral+'</p></div><div class="page"><div class="company-header">'+y.toUpperCase()+" ("+v+')</div><div class="header"><h2>'+O.socf+"</h2><p>"+O.forYear+" "+Zt.toUpperCase()+'</p></div><table class="fs"><thead><tr><th style="width:70%"></th><th class="right" style="width:15%">'+L+"<br>"+O.rm+'</th><th class="right" style="width:15%">'+fe+"<br>"+O.rm+'</th></tr></thead><tbody><tr><td class="bold">'+(C?"CASH FLOWS FROM OPERATING ACTIVITIES":"ALIRAN TUNAI DARIPADA AKTIVITI OPERASI")+'</td><td></td><td></td></tr><tr><td class="indent">'+(C?"Profit before taxation":"Untung sebelum cukai")+'</td><td class="right">'+G(m.cf.pbt)+'</td><td class="right">'+G(m.is.py_pbt||0)+'</td></tr><tr><td class="indent">'+(C?"Adjustments for:":"Pelarasan untuk:")+'</td><td></td><td></td></tr><tr><td class="indent2">'+(C?"Depreciation":"Susut nilai")+'</td><td class="right">'+G(m.cf.adjustments.depreciation)+'</td><td class="right">-</td></tr><tr><td class="indent2">'+(C?"Interest expense":"Perbelanjaan faedah")+'</td><td class="right">'+G(m.cf.adjustments.interestExpense)+'</td><td class="right">-</td></tr>'+(m.cf.adjustments.interestIncome!==0?'<tr><td class="indent2">'+(C?"Interest income":"Pendapatan faedah")+'</td><td class="right">'+xe(m.cf.adjustments.interestIncome)+'</td><td class="right">-</td></tr>':"")+'<tr class="subtotal"><td class="indent">'+(C?"Operating profit before working capital changes":"Keuntungan operasi sebelum perubahan modal kerja")+'</td><td class="right">'+G(m.cf.pbt+m.cf.totalAdjustments)+'</td><td class="right">-</td></tr><tr><td class="indent">'+(C?"Changes in working capital:":"Perubahan dalam modal kerja:")+"</td><td></td><td></td></tr>"+(m.cf.workingCapitalChanges.inventory!==0?'<tr><td class="indent2">'+(C?"(Increase)/Decrease in inventories":"(Pertambahan)/Pengurangan dalam inventori")+'</td><td class="right">'+xe(m.cf.workingCapitalChanges.inventory)+'</td><td class="right">-</td></tr>':"")+(m.cf.workingCapitalChanges.tradeReceivables!==0?'<tr><td class="indent2">'+(C?"(Increase)/Decrease in trade receivables":"(Pertambahan)/Pengurangan dalam penghutang perdagangan")+'</td><td class="right">'+xe(m.cf.workingCapitalChanges.tradeReceivables)+'</td><td class="right">-</td></tr>':"")+(m.cf.workingCapitalChanges.otherReceivables!==0?'<tr><td class="indent2">'+(C?"(Increase)/Decrease in other receivables":"(Pertambahan)/Pengurangan dalam penghutang lain")+'</td><td class="right">'+xe(m.cf.workingCapitalChanges.otherReceivables)+'</td><td class="right">-</td></tr>':"")+(m.cf.workingCapitalChanges.tradePayables!==0?'<tr><td class="indent2">'+(C?"Increase/(Decrease) in trade payables":"Pertambahan/(Pengurangan) dalam pemiutang perdagangan")+'</td><td class="right">'+xe(m.cf.workingCapitalChanges.tradePayables)+'</td><td class="right">-</td></tr>':"")+(m.cf.workingCapitalChanges.otherPayables!==0?'<tr><td class="indent2">'+(C?"Increase/(Decrease) in other payables":"Pertambahan/(Pengurangan) dalam pemiutang lain")+'</td><td class="right">'+xe(m.cf.workingCapitalChanges.otherPayables)+'</td><td class="right">-</td></tr>':"")+'<tr class="subtotal"><td class="indent bold">'+(C?"Cash generated from operations":"Tunai dijana daripada operasi")+'</td><td class="right">'+G(m.cf.cashFromOperations)+'</td><td class="right">-</td></tr>'+(m.cf.taxPaid!==0?'<tr><td class="indent2">'+(C?"Tax paid":"Cukai dibayar")+'</td><td class="right">'+xe(m.cf.taxPaid)+'</td><td class="right">-</td></tr>':"")+(m.cf.interestPaid!==0?'<tr><td class="indent2">'+(C?"Interest paid":"Faedah dibayar")+'</td><td class="right">'+xe(m.cf.interestPaid)+'</td><td class="right">-</td></tr>':"")+'<tr class="subtotal"><td class="bold">'+(C?"Net cash from operating activities":"Tunai bersih daripada aktiviti operasi")+'</td><td class="right bold">'+G(m.cf.netOperating)+'</td><td class="right">-</td></tr><tr><td colspan="3" style="height:10px"></td></tr><tr><td class="bold">'+(C?"CASH FLOWS FROM INVESTING ACTIVITIES":"ALIRAN TUNAI DARIPADA AKTIVITI PELABURAN")+"</td><td></td><td></td></tr>"+(m.cf.ppePurchases!==0?'<tr><td class="indent">'+(C?"Purchase of property, plant and equipment":"Pembelian hartanah, loji dan peralatan")+'</td><td class="right">'+xe(m.cf.ppePurchases)+'</td><td class="right">-</td></tr>':"")+(m.cf.ppeDisposals!==0?'<tr><td class="indent">'+(C?"Proceeds from disposal of PPE":"Hasil daripada pelupusan PPE")+'</td><td class="right">'+G(m.cf.ppeDisposals)+'</td><td class="right">-</td></tr>':"")+(m.cf.investmentPurchases!==0?'<tr><td class="indent">'+(C?"Purchase of investments":"Pembelian pelaburan")+'</td><td class="right">'+xe(m.cf.investmentPurchases)+'</td><td class="right">-</td></tr>':"")+(m.cf.investmentDisposals!==0?'<tr><td class="indent">'+(C?"Proceeds from disposal of investments":"Hasil daripada pelupusan pelaburan")+'</td><td class="right">'+G(m.cf.investmentDisposals)+'</td><td class="right">-</td></tr>':"")+(m.cf.interestReceived!==0?'<tr><td class="indent">'+(C?"Interest received":"Faedah diterima")+'</td><td class="right">'+G(m.cf.interestReceived)+'</td><td class="right">-</td></tr>':"")+(m.cf.netInvesting===0?'<tr><td class="indent" style="font-style:italic;color:#666">'+(C?"No investing activities":"Tiada aktiviti pelaburan")+'</td><td class="right">-</td><td class="right">-</td></tr>':"")+'<tr class="subtotal"><td class="bold">'+(C?"Net cash from investing activities":"Tunai bersih daripada aktiviti pelaburan")+'</td><td class="right bold">'+xe(m.cf.netInvesting)+'</td><td class="right">-</td></tr><tr><td colspan="3" style="height:10px"></td></tr><tr><td class="bold">'+(C?"CASH FLOWS FROM FINANCING ACTIVITIES":"ALIRAN TUNAI DARIPADA AKTIVITI PEMBIAYAAN")+"</td><td></td><td></td></tr>"+(m.cf.loanProceeds!==0?'<tr><td class="indent">'+(C?"Proceeds from borrowings":"Penerimaan daripada pinjaman")+'</td><td class="right">'+G(m.cf.loanProceeds)+'</td><td class="right">-</td></tr>':"")+(m.cf.loanRepayments!==0?'<tr><td class="indent">'+(C?"Repayment of borrowings":"Bayaran balik pinjaman")+'</td><td class="right">'+xe(m.cf.loanRepayments)+'</td><td class="right">-</td></tr>':"")+(m.cf.capitalInjection!==0?'<tr><td class="indent">'+(C?"Capital injection / Share issuance":"Suntikan modal / Terbitan saham")+'</td><td class="right">'+G(m.cf.capitalInjection)+'</td><td class="right">-</td></tr>':"")+(m.cf.dividendsPaid!==0?'<tr><td class="indent">'+(C?"Dividends paid":"Dividen dibayar")+'</td><td class="right">'+xe(m.cf.dividendsPaid)+'</td><td class="right">-</td></tr>':"")+(m.cf.drawingsWithdrawals!==0?'<tr><td class="indent">'+(C?"Drawings / Withdrawals":"Pengeluaran")+'</td><td class="right">'+xe(m.cf.drawingsWithdrawals)+'</td><td class="right">-</td></tr>':"")+(m.cf.netFinancing===0?'<tr><td class="indent" style="font-style:italic;color:#666">'+(C?"No financing activities":"Tiada aktiviti pembiayaan")+'</td><td class="right">-</td><td class="right">-</td></tr>':"")+'<tr class="subtotal"><td class="bold">'+(C?"Net cash from financing activities":"Tunai bersih daripada aktiviti pembiayaan")+'</td><td class="right bold">'+xe(m.cf.netFinancing)+'</td><td class="right">-</td></tr><tr><td colspan="3" style="height:15px"></td></tr><tr class="subtotal"><td class="bold">'+(C?"Net increase/(decrease) in cash and cash equivalents":"Pertambahan/(Pengurangan) bersih dalam tunai dan setara tunai")+'</td><td class="right bold">'+xe(m.cf.netChangeInCash)+'</td><td class="right">-</td></tr><tr><td>'+(C?"Cash and cash equivalents at beginning of year":"Tunai dan setara tunai pada awal tahun")+'</td><td class="right">'+G(m.cf.openingCash)+'</td><td class="right">'+G(m.bs.py_cash||0)+'</td></tr><tr class="double"><td class="bold">'+(C?"Cash and cash equivalents at end of year":"Tunai dan setara tunai pada akhir tahun")+'</td><td class="right bold">'+G(m.cf.closingCash)+'</td><td class="right">'+G(m.cf.openingCash)+'</td></tr></tbody></table><p style="font-size:9pt; margin-top:20px; font-style:italic">'+O.notesIntegral+'</p></div><div class="page"><div class="company-header">'+y.toUpperCase()+" ("+v+')</div><div class="header"><h2>'+O.notes+'</h2></div><div class="section-title">1. '+(C?"GENERAL INFORMATION":"MAKLUMAT AM")+'</div><p class="note-text">'+y+(C?" is a "+D.toLowerCase()+", incorporated and domiciled in Malaysia.":" adalah sebuah "+D.toLowerCase()+", diperbadankan dan bermastautin di Malaysia.")+'</p><p class="note-text">'+(C?"The registered office of the Company is located in Malaysia.":"Pejabat berdaftar Syarikat terletak di Malaysia.")+'</p><p class="note-text">'+(C?"The principal activities of the Company are ":"Aktiviti utama Syarikat adalah ")+(C?"general trading and provision of services.":"perdagangan am dan penyediaan perkhidmatan.")+'</p><p class="note-text">'+(C?"The financial statements were authorised for issue by the Board of Directors on ":"Penyata kewangan ini telah diluluskan untuk diterbitkan oleh Lembaga Pengarah pada ")+new Date().toLocaleDateString(C?"en-MY":"ms-MY",{day:"numeric",month:"long",year:"numeric"})+'.</p><div class="section-title">2. '+(C?"BASIS OF PREPARATION":"ASAS PENYEDIAAN")+'</div><p class="note-text"><strong>2.1 '+(C?"Statement of compliance":"Penyata pematuhan")+'</strong></p><p class="note-text">'+(C?"The financial statements of the Company have been prepared in accordance with "+S+' ("'+T+'") and the requirements of the Companies Act 2016 in Malaysia.':"Penyata kewangan Syarikat telah disediakan mengikut "+S+' ("'+T+'") dan keperluan Akta Syarikat 2016 di Malaysia.')+'</p><p class="note-text"><strong>2.2 '+(C?"Basis of measurement":"Asas pengukuran")+'</strong></p><p class="note-text">'+(C?"The financial statements have been prepared on the historical cost basis.":"Penyata kewangan telah disediakan berdasarkan kos sejarah.")+'</p><p class="note-text"><strong>2.3 '+(C?"Functional and presentation currency":"Mata wang fungsian dan pembentangan")+'</strong></p><p class="note-text">'+(C?`The financial statements are presented in Ringgit Malaysia ("RM"), which is the Company's functional currency.`:'Penyata kewangan ini dibentangkan dalam Ringgit Malaysia ("RM"), iaitu mata wang fungsian Syarikat.')+'</p></div><div class="page"><div class="company-header">'+y.toUpperCase()+" ("+v+')</div><div class="header"><h2>'+O.notes+" ("+(C?"continued":"sambungan")+')</h2></div><div class="section-title">3. '+(C?"SIGNIFICANT ACCOUNTING POLICIES":"DASAR PERAKAUNAN PENTING")+'</div><p class="note-text"><strong>3.1 '+(C?"Property, plant and equipment":"Hartanah, loji dan peralatan")+'</strong></p><p class="note-text">'+(C?"Property, plant and equipment are measured at cost less accumulated depreciation and any accumulated impairment losses.":"Hartanah, loji dan peralatan diukur pada kos ditolak susut nilai terkumpul dan kerugian rosot nilai terkumpul.")+'</p><p class="note-text">'+(C?"Depreciation is calculated using the straight-line method to allocate the cost of assets over their estimated useful lives. The annual depreciation rates used are as follows:":"Susut nilai dikira menggunakan kaedah garis lurus untuk memperuntukkan kos aset sepanjang anggaran hayat berguna. Kadar susut nilai tahunan yang digunakan adalah seperti berikut:")+'</p><table class="fs" style="margin:10px 0 10px 20px;width:90%"><tbody>'+(m.bs.ppe>0?ft&&ft.length>0?[...new Set(ft.map(X=>X.category))].map(X=>{const V=xt[X]||xt.OFFICE_EQUIPMENT;return'<tr><td style="width:60%">'+V.label+'</td><td class="right">'+(V.rate>0?V.rate+"%":C?"Not depreciated":"Tidak disusutnilaikan")+"</td></tr>"}).join(""):'<tr><td style="width:60%">'+(C?"Buildings":"Bangunan")+'</td><td class="right">2%</td></tr><tr><td>'+(C?"Renovation":"Pengubahsuaian")+'</td><td class="right">10%</td></tr><tr><td>'+(C?"Plant and machinery":"Loji dan jentera")+'</td><td class="right">10%</td></tr><tr><td>'+(C?"Motor vehicles":"Kenderaan bermotor")+'</td><td class="right">20%</td></tr><tr><td>'+(C?"Office equipment":"Peralatan pejabat")+'</td><td class="right">10%</td></tr><tr><td>'+(C?"Computer equipment":"Peralatan komputer")+'</td><td class="right">33.33%</td></tr><tr><td>'+(C?"Furniture and fittings":"Perabot dan kelengkapan")+'</td><td class="right">10%</td></tr>':"")+'</tbody></table><p class="note-text"><strong>3.2 '+(C?"Inventories":"Inventori")+'</strong></p><p class="note-text">'+(C?"Inventories are measured at the lower of cost and net realisable value. Cost is determined using the first-in, first-out (FIFO) method.":"Inventori diukur pada kos atau nilai boleh realis bersih yang lebih rendah. Kos ditentukan menggunakan kaedah masuk-dahulu-keluar-dahulu (FIFO).")+'</p><p class="note-text"><strong>3.3 '+(C?"Financial instruments":"Instrumen kewangan")+'</strong></p><p class="note-text">'+(C?"Financial assets and liabilities are recognised when the Company becomes a party to the contractual provisions. Trade receivables and payables are initially measured at the transaction price and subsequently at amortised cost.":"Aset dan liabiliti kewangan diiktiraf apabila Syarikat menjadi pihak kepada peruntukan kontrak. Penghutang dan pemiutang perdagangan diukur pada mulanya pada harga transaksi dan seterusnya pada kos terlunas.")+'</p><p class="note-text"><strong>3.4 '+(C?"Revenue recognition":"Pengiktirafan hasil")+'</strong></p><p class="note-text">'+(C?"Revenue is measured at the fair value of the consideration received or receivable. Revenue from sale of goods is recognised when the significant risks and rewards of ownership have been transferred to the buyer. Revenue from services is recognised when the services are rendered.":"Hasil diukur pada nilai saksama balasan yang diterima atau akan diterima. Hasil daripada jualan barangan diiktiraf apabila risiko dan ganjaran pemilikan yang ketara telah dipindahkan kepada pembeli. Hasil daripada perkhidmatan diiktiraf apabila perkhidmatan diberikan.")+'</p></div><div class="page"><div class="company-header">'+y.toUpperCase()+" ("+v+')</div><div class="header"><h2>'+O.notes+" ("+(C?"continued":"sambungan")+')</h2></div><div class="section-title">4. '+(C?"PROPERTY, PLANT AND EQUIPMENT":"HARTANAH, LOJI DAN PERALATAN")+"</div>"+(ft&&ft.length>0?'<table class="note-table"><thead><tr><th style="width:35%">'+(C?"Description":"Keterangan")+'</th><th class="right" style="width:15%">'+(C?"Cost":"Kos")+'<br>RM</th><th class="right" style="width:20%">'+(C?"Accumulated Depreciation":"Susut Nilai Terkumpul")+'<br>RM</th><th class="right" style="width:15%">'+(C?"Net Book Value":"Nilai Buku Bersih")+'<br>RM</th><th class="right" style="width:15%">'+(C?"Rate":"Kadar")+"<br>%</th></tr></thead><tbody>"+ft.map(X=>{const V=xt[X.category]||xt.OFFICE_EQUIPMENT,Me=parseFloat(X.cost)||0,Be=parseFloat(X.accDepBF)||0,pe=Math.min(Me*(V.rate/100),Me-Be),We=Be+pe,Ve=Me-We;return"<tr><td>"+(X.description||"-")+'</td><td class="right">'+G(Me)+'</td><td class="right">'+G(We)+'</td><td class="right">'+G(Ve)+'</td><td class="right">'+V.rate+"</td></tr>"}).join("")+'<tr style="font-weight:bold;border-top:2px solid #000"><td>'+(C?"Total":"Jumlah")+'</td><td class="right">'+G(rt.ppe.cost)+'</td><td class="right">'+G(rt.ppe.accDepCF)+'</td><td class="right">'+G(rt.ppe.nbv)+"</td><td></td></tr></tbody></table>":'<table class="fs"><tbody><tr><td style="width:60%">'+(C?"At cost":"Pada kos")+'</td><td class="right">'+G((m.bs.ppe||0)+(m.bs.accDep||0))+"</td></tr><tr><td>"+(C?"Less: Accumulated depreciation":"Tolak: Susut nilai terkumpul")+'</td><td class="right">('+G(m.bs.accDep||0)+')</td></tr><tr style="border-top:1px solid #000"><td class="bold">'+(C?"Net book value":"Nilai buku bersih")+'</td><td class="right bold">'+G(m.bs.ppe)+"</td></tr></tbody></table>")+'<p class="note-text" style="margin-top:10px">'+(C?"Depreciation charge for the year: RM "+G(rt.ppe.currentDep||m.is.details.DEPRECIATION||0):"Caj susut nilai bagi tahun: RM "+G(rt.ppe.currentDep||m.is.details.DEPRECIATION||0))+'</p><div class="section-title">5. '+(C?"INVENTORIES":"INVENTORI")+'</div><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Trading goods / Finished goods":"Barang dagangan / Barang siap")+'</td><td class="right">'+G(m.bs.inv)+"</td></tr></tbody></table>"+(m.bs.inv>0?'<p class="note-text">'+(C?"Inventories are stated at the lower of cost and net realisable value.":"Inventori dinyatakan pada kos atau nilai boleh realis bersih yang lebih rendah.")+"</p>":"")+'<div class="section-title">6. '+(C?"TRADE AND OTHER RECEIVABLES":"PENGHUTANG PERDAGANGAN DAN LAIN-LAIN")+'</div><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Trade receivables":"Penghutang perdagangan")+'</td><td class="right">'+G(m.bs.tr)+"</td></tr>"+(m.bs.or>0?"<tr><td>"+(C?"Other receivables":"Penghutang lain")+'</td><td class="right">'+G(m.bs.or)+"</td></tr>":"")+(m.bs.prepaid>0?"<tr><td>"+(C?"Prepayments":"Bayaran terdahulu")+'</td><td class="right">'+G(m.bs.prepaid)+"</td></tr>":"")+(m.bs.deposits>0?"<tr><td>"+(C?"Deposits":"Deposit")+'</td><td class="right">'+G(m.bs.deposits)+"</td></tr>":"")+'<tr style="border-top:1px solid #000"><td class="bold">'+(C?"Total":"Jumlah")+'</td><td class="right bold">'+G((m.bs.tr||0)+(m.bs.or||0)+(m.bs.prepaid||0)+(m.bs.deposits||0))+'</td></tr></tbody></table></div><div class="page"><div class="company-header">'+y.toUpperCase()+" ("+v+')</div><div class="header"><h2>'+O.notes+" ("+(C?"continued":"sambungan")+')</h2></div><div class="section-title">7. '+(C?"CASH AND BANK BALANCES":"TUNAI DAN BAKI BANK")+'</div><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Cash in hand":"Tunai dalam tangan")+'</td><td class="right">'+G(m.bs.cashInHand||0)+"</td></tr><tr><td>"+(C?"Cash at bank":"Tunai di bank")+'</td><td class="right">'+G(m.bs.cash-(m.bs.cashInHand||0))+'</td></tr><tr style="border-top:1px solid #000"><td class="bold">'+(C?"Total":"Jumlah")+'</td><td class="right bold">'+G(m.bs.cash)+'</td></tr></tbody></table><div class="section-title">8. '+(C?"SHARE CAPITAL":"MODAL SAHAM")+'</div><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Issued and fully paid:":"Diterbitkan dan berbayar penuh:")+'</td><td></td></tr><tr><td class="indent">'+(C?"Ordinary shares":"Saham biasa")+'</td><td class="right">'+G(m.bs.cap)+'</td></tr></tbody></table><div class="section-title">9. '+(C?"TRADE AND OTHER PAYABLES":"PEMIUTANG PERDAGANGAN DAN LAIN-LAIN")+'</div><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Trade payables":"Pemiutang perdagangan")+'</td><td class="right">'+G(m.bs.tp)+"</td></tr>"+(m.bs.op>0?"<tr><td>"+(C?"Other payables and accruals":"Pemiutang lain dan akruan")+'</td><td class="right">'+G(m.bs.op)+"</td></tr>":"")+'<tr style="border-top:1px solid #000"><td class="bold">'+(C?"Total":"Jumlah")+'</td><td class="right bold">'+G((m.bs.tp||0)+(m.bs.op||0))+"</td></tr></tbody></table>"+(m.bs.borr>0?'<div class="section-title">10. '+(C?"BORROWINGS":"PINJAMAN")+'</div><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Bank loan - secured":"Pinjaman bank - bercagar")+'</td><td class="right">'+G(m.bs.borr)+'</td></tr></tbody></table><p class="note-text">'+(C?"The bank loan is secured by a charge over the Company's assets.":"Pinjaman bank dijamin oleh gadaian ke atas aset Syarikat.")+"</p>":"")+'</div><div class="page"><div class="company-header">'+y.toUpperCase()+" ("+v+')</div><div class="header"><h2>'+O.notes+" ("+(C?"continued":"sambungan")+')</h2></div><div class="section-title">'+(m.bs.borr>0?"11":"10")+". "+(C?"REVENUE":"HASIL")+'</div><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Sale of goods":"Jualan barangan")+'</td><td class="right">'+G(m.is.details.SALES||m.is.rev)+"</td></tr>"+(m.is.details.SERVICE_REVENUE>0?"<tr><td>"+(C?"Rendering of services":"Pemberian perkhidmatan")+'</td><td class="right">'+G(m.is.details.SERVICE_REVENUE)+"</td></tr>":"")+'<tr style="border-top:1px solid #000"><td class="bold">'+(C?"Total revenue":"Jumlah hasil")+'</td><td class="right bold">'+G(m.is.rev)+'</td></tr></tbody></table><div class="section-title">'+(m.bs.borr>0?"12":"11")+". "+(C?"COST OF SALES":"KOS JUALAN")+'</div><table class="fs"><tbody>'+(m.is.details.OPENING_STOCK>0?'<tr><td style="width:60%">'+(C?"Opening inventory":"Inventori awal")+'</td><td class="right">'+G(m.is.details.OPENING_STOCK)+"</td></tr>":"")+'<tr><td style="width:60%">'+(C?"Purchases":"Belian")+'</td><td class="right">'+G(m.is.details.PURCHASE||m.is.cos)+"</td></tr>"+(m.is.details.DIRECT_COSTS>0?"<tr><td>"+(C?"Direct costs":"Kos langsung")+'</td><td class="right">'+G(m.is.details.DIRECT_COSTS)+"</td></tr>":"")+(m.is.details.CLOSING_STOCK>0?"<tr><td>"+(C?"Less: Closing inventory":"Tolak: Inventori akhir")+'</td><td class="right">('+G(m.is.details.CLOSING_STOCK)+")</td></tr>":"")+'<tr style="border-top:1px solid #000"><td class="bold">'+(C?"Total cost of sales":"Jumlah kos jualan")+'</td><td class="right bold">'+G(m.is.cos)+'</td></tr></tbody></table><div class="section-title">'+(m.bs.borr>0?"13":"12")+". "+(C?"ADMINISTRATIVE EXPENSES":"PERBELANJAAN PENTADBIRAN")+'</div><p class="note-text">'+(C?"Included in administrative expenses are:":"Termasuk dalam perbelanjaan pentadbiran adalah:")+'</p><table class="fs"><tbody>'+(m.is.details.SALARY>0?'<tr><td style="width:60%">'+(C?"Staff costs (salaries, wages, EPF, SOCSO)":"Kos kakitangan (gaji, upah, KWSP, PERKESO)")+'</td><td class="right">'+G(m.is.details.SALARY+(m.is.details.EPF||0)+(m.is.details.SOCSO||0))+"</td></tr>":"")+((rt.ppe.currentDep||m.is.details.DEPRECIATION||0)>0?"<tr><td>"+(C?"Depreciation of property, plant and equipment":"Susut nilai hartanah, loji dan peralatan")+'</td><td class="right">'+G(rt.ppe.currentDep||m.is.details.DEPRECIATION||0)+"</td></tr>":"")+(m.is.details.RENT>0?"<tr><td>"+(C?"Rental of premises":"Sewa premis")+'</td><td class="right">'+G(m.is.details.RENT)+"</td></tr>":"")+(m.is.details.UTILITIES>0?"<tr><td>"+(C?"Utilities":"Utiliti")+'</td><td class="right">'+G(m.is.details.UTILITIES)+"</td></tr>":"")+(m.is.details.PROFESSIONAL_FEES>0?"<tr><td>"+(C?"Professional fees":"Yuran profesional")+'</td><td class="right">'+G(m.is.details.PROFESSIONAL_FEES)+"</td></tr>":"")+(m.is.details.MARKETING>0?"<tr><td>"+(C?"Marketing and advertising":"Pemasaran dan pengiklanan")+'</td><td class="right">'+G(m.is.details.MARKETING)+"</td></tr>":"")+(m.is.details.TRANSPORT>0?"<tr><td>"+(C?"Transport and travelling":"Pengangkutan dan perjalanan")+'</td><td class="right">'+G(m.is.details.TRANSPORT)+"</td></tr>":"")+(m.is.details.REPAIR_MAINTENANCE>0?"<tr><td>"+(C?"Repairs and maintenance":"Pembaikan dan penyelenggaraan")+'</td><td class="right">'+G(m.is.details.REPAIR_MAINTENANCE)+"</td></tr>":"")+(m.is.details.INSURANCE>0?"<tr><td>"+(C?"Insurance":"Insurans")+'</td><td class="right">'+G(m.is.details.INSURANCE)+"</td></tr>":"")+(m.is.details.BANK_CHARGES>0?"<tr><td>"+(C?"Bank charges":"Caj bank")+'</td><td class="right">'+G(m.is.details.BANK_CHARGES)+"</td></tr>":"")+(m.is.details.ENTERTAINMENT>0?"<tr><td>"+(C?"Entertainment":"Keraian")+'</td><td class="right">'+G(m.is.details.ENTERTAINMENT)+"</td></tr>":"")+(()=>{const X=(m.is.details.SALARY||0)+(m.is.details.EPF||0)+(m.is.details.SOCSO||0)+(rt.ppe.currentDep||m.is.details.DEPRECIATION||0)+(m.is.details.RENT||0)+(m.is.details.UTILITIES||0)+(m.is.details.PROFESSIONAL_FEES||0)+(m.is.details.MARKETING||0)+(m.is.details.TRANSPORT||0)+(m.is.details.REPAIR_MAINTENANCE||0)+(m.is.details.INSURANCE||0)+(m.is.details.BANK_CHARGES||0)+(m.is.details.ENTERTAINMENT||0),V=(m.is.adm||0)-X;return V>100?"<tr><td>"+(C?"Other expenses":"Perbelanjaan lain")+'</td><td class="right">'+G(Math.round(V))+"</td></tr>":""})()+'<tr style="border-top:1px solid #000"><td class="bold">'+(C?"Total administrative expenses":"Jumlah perbelanjaan pentadbiran")+'</td><td class="right bold">'+G(m.is.adm)+'</td></tr></tbody></table></div><div class="page"><div class="company-header">'+y.toUpperCase()+" ("+v+')</div><div class="header"><h2>'+O.notes+" ("+(C?"continued":"sambungan")+")</h2></div>"+(m.is.fin>0?'<div class="section-title">'+(m.bs.borr>0?"14":"13")+". "+(C?"FINANCE COSTS":"KOS KEWANGAN")+'</div><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Interest expense on borrowings":"Perbelanjaan faedah atas pinjaman")+'</td><td class="right">'+G(m.is.fin)+"</td></tr></tbody></table>":"")+'<div class="section-title">'+(m.bs.borr>0?m.is.fin>0?"15":"14":m.is.fin>0?"14":"13")+". "+(C?"TAXATION":"CUKAI")+'</div><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Current tax":"Cukai semasa")+'</td><td class="right">'+G(m.is.tax)+'</td></tr></tbody></table><p class="note-text">'+(C?"Malaysian income tax is calculated at the statutory tax rate of "+W+" on the estimated chargeable income for the year.":"Cukai pendapatan Malaysia dikira pada kadar cukai berkanun sebanyak "+W+" ke atas anggaran pendapatan bercukai bagi tahun tersebut.")+'</p><p class="note-text"><strong>'+(C?"Tax Computation:":"Pengiraan Cukai:")+'</strong></p><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Profit/(Loss) before taxation":"Untung/(Rugi) sebelum cukai")+'</td><td class="right">'+G(m.is.pbt)+"</td></tr>"+(m.taxComputation?.totalAddBack>0?"<tr><td>"+(C?"Add: Non-deductible expenses":"Tambah: Perbelanjaan tidak dibenarkan")+'</td><td class="right">'+G(m.taxComputation.totalAddBack)+"</td></tr>":"")+"<tr><td><strong>"+(C?"Adjusted profit":"Keuntungan terlaras")+'</strong></td><td class="right"><strong>'+G(m.taxComputation?.adjustedProfit||m.is.pbt)+"</strong></td></tr>"+(m.taxComputation?.capitalAllowance>0?"<tr><td>"+(C?"Less: Capital allowance":"Tolak: Elaun modal")+'</td><td class="right">('+G(m.taxComputation.capitalAllowance)+")</td></tr>":"")+(m.taxComputation?.otherDeductions>0?"<tr><td>"+(C?"Less: Other deductions/reliefs":"Tolak: Potongan/pelepasan lain")+'</td><td class="right">('+G(m.taxComputation.otherDeductions)+")</td></tr>":"")+"<tr><td><strong>"+(C?"Chargeable income":"Pendapatan bercukai")+'</strong></td><td class="right"><strong>'+G(m.taxComputation?.taxableIncome||Math.max(0,m.is.pbt))+"</strong></td></tr><tr><td>"+(C?"Tax at statutory rate":"Cukai pada kadar berkanun")+'</td><td class="right">'+G(m.taxComputation?.grossTax||m.is.tax)+"</td></tr>"+(m.taxComputation?.zakat>0?"<tr><td>"+(C?"Less: Zakat rebate":"Tolak: Rebat zakat")+'</td><td class="right">('+G(m.taxComputation.zakat)+")</td></tr>":"")+'<tr style="border-top: 2px solid #000;"><td><strong>'+(C?"Tax payable":"Cukai kena bayar")+'</strong></td><td class="right"><strong>'+G(m.is.tax)+"</strong></td></tr></tbody></table>"+(C?'<p class="note-text">A reconciliation of income tax expense applicable to profit before taxation at the statutory income tax rate to income tax expense at the effective income tax rate of the Company is not presented as there are no material reconciling items.</p>':'<p class="note-text">Penyesuaian perbelanjaan cukai pendapatan yang berkenaan dengan keuntungan sebelum cukai pada kadar cukai berkanun kepada perbelanjaan cukai pendapatan pada kadar cukai efektif Syarikat tidak dibentangkan kerana tiada item penyesuaian yang material.</p>')+'<div class="section-title">'+(m.bs.borr>0?m.is.fin>0?"16":"15":m.is.fin>0?"15":"14")+". "+(C?"RELATED PARTY DISCLOSURES":"PENDEDAHAN PIHAK BERKAITAN")+'</div><p class="note-text"><strong>(a) '+(C?"Identities of related parties":"Identiti pihak berkaitan")+'</strong></p><p class="note-text">'+(C?"The Company has related party relationships with its directors and key management personnel.":"Syarikat mempunyai hubungan pihak berkaitan dengan pengarahnya dan kakitangan pengurusan utama.")+'</p><p class="note-text"><strong>(b) '+(C?"Key management personnel compensation":"Pampasan kakitangan pengurusan utama")+'</strong></p><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Directors' remuneration":"Imbuhan pengarah")+'</td><td class="right">'+G(m.is.details.DIRECTOR_FEE||Math.round((m.is.adm||0)*.15))+'</td></tr></tbody></table><p class="note-text">'+(C?"The remuneration of directors is determined by the shareholders having regard to the performance of individuals and market trends.":"Imbuhan pengarah ditentukan oleh pemegang saham dengan mengambil kira prestasi individu dan trend pasaran.")+'</p><div class="section-title">'+(m.bs.borr>0?m.is.fin>0?"17":"16":m.is.fin>0?"16":"15")+". "+(C?"AUDITORS' REMUNERATION":"IMBUHAN JURUAUDIT")+'</div><table class="fs"><tbody><tr><td style="width:60%">'+(C?"Statutory audit fees":"Yuran audit berkanun")+'</td><td class="right">'+G(m.is.details.AUDIT_FEE||Math.round((m.is.adm||0)*.02))+"</td></tr></tbody></table></div></body></html>"}catch(y){return console.error("Error generating FS:",y),alert("Error generating financial statements: "+y.message),null}},bi=u=>String(u||"").replace(/[&<>"]/g,y=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"})[y]),w0=`
@page { size: A4; margin: 2cm; }
body { font-family: "Times New Roman", Times, serif; font-size: 11pt; color: #000; line-height: 1.4; }
h1, h2, h3 { margin: 0; padding: 0; }
.p-center { text-align: center; }
.small { font-size: 10pt; }
.muted { color: #333; }
.sp-1 { margin-top: 6pt; }
.sp-2 { margin-top: 12pt; }
.sp-3 { margin-top: 18pt; }

/* Page blocks */
.page { page-break-after: always; }
.page:last-child { page-break-after: auto; }

/* Word page break hint */
.w-pb { mso-special-character: line-break; page-break-before: always; }

/* Financial Statement Tables */
table.fs { width: 100%; border-collapse: separate; border-spacing: 0; table-layout: fixed; margin: 10pt 0; }
table.fs th, table.fs td { padding: 3pt 5pt; vertical-align: top; border: none; }
table.fs thead th { font-weight: bold; text-align: center; }
.desc { text-align: left; }
.note { text-align: center; width: 8%; }
.amt { text-align: right; white-space: nowrap; }
.bold { font-weight: bold; }
.ind1 { padding-left: 15pt !important; }
.ind2 { padding-left: 30pt !important; }

/* Lines ONLY under amount columns - inner div prevents border bleed */
.amt-line-top > div { border-top: 1px solid #000; padding-top: 2pt; }
.amt-line-bottom > div { border-bottom: 1px solid #000; padding-bottom: 2pt; }
.amt-line-double > div { border-bottom: 3px double #000; padding-bottom: 2pt; }

/* Header row bottom border */
.hdr-border > div { border-bottom: 1px solid #000; padding-bottom: 3pt; font-weight: bold; }

/* Notes tables */
table.noteTbl { width: 100%; border-collapse: separate; border-spacing: 0; table-layout: fixed; margin: 8pt 0; }
table.noteTbl th, table.noteTbl td { padding: 2pt 4pt; border: none; vertical-align: top; }

/* Section headers */
.section-title { font-size: 12pt; font-weight: bold; text-align: center; margin: 15pt 0 10pt 0; text-transform: uppercase; }
.section-subtitle { font-size: 11pt; text-align: center; margin-bottom: 15pt; }

/* Integral notes text */
.integral-note { font-size: 9pt; font-style: italic; text-align: center; margin-top: 20pt; color: #333; }

/* Note section styling */
.note-title { font-size: 11pt; font-weight: bold; margin: 15pt 0 8pt 0; }
.note-text { margin: 5pt 0 10pt 0; text-align: justify; }
`,R0=({title:u,bodyHtml:y})=>`<!DOCTYPE html>
<html xmlns:o="urn:schemas-microsoft-com:office:office"
      xmlns:w="urn:schemas-microsoft-com:office:word"
      xmlns="http://www.w3.org/TR/REC-html40">
<head>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="ProgId" content="Word.Document"/>
<meta name="Generator" content="FS Automation V8"/>
<title>${bi(u)}</title>
<style>${w0}</style>
</head>
<body>
${y}
</body>
</html>`.trim(),Ts=(u="EN")=>{if(!m)return null;const y=s||"Company Name",v=f||"____________",S=u==="EN",T=Ot?.fullStandard||"Malaysian Private Entities Reporting Standard",W=new Date().toLocaleDateString("en-MY",{day:"numeric",month:"long",year:"numeric"}),D={title:S?"FINANCIAL STATEMENTS":"PENYATA KEWANGAN",forYear:S?"FOR THE FINANCIAL YEAR ENDED":"BAGI TAHUN KEWANGAN BERAKHIR",contents:S?"CONTENTS":"KANDUNGAN",sofp:S?"STATEMENT OF FINANCIAL POSITION":"PENYATA KEDUDUKAN KEWANGAN",sopl:S?"STATEMENT OF PROFIT OR LOSS AND OTHER COMPREHENSIVE INCOME":"PENYATA UNTUNG RUGI DAN PENDAPATAN KOMPREHENSIF LAIN",soce:S?"STATEMENT OF CHANGES IN EQUITY":"PENYATA PERUBAHAN EKUITI",socf:S?"STATEMENT OF CASH FLOWS":"PENYATA ALIRAN TUNAI",notes:S?"NOTES TO THE FINANCIAL STATEMENTS":"NOTA-NOTA KEPADA PENYATA KEWANGAN",asAt:S?"AS AT":"PADA",note:S?"Note":"Nota",rm:"RM",assets:S?"ASSETS":"ASET",nca:S?"Non-Current Assets":"Aset Bukan Semasa",ppe:S?"Property, plant and equipment":"Hartanah, loji dan peralatan",ca:S?"Current Assets":"Aset Semasa",inventories:S?"Inventories":"Inventori",tradeRec:S?"Trade and other receivables":"Penghutang perdagangan dan lain-lain",cashBank:S?"Cash and bank balances":"Tunai dan baki bank",totalAssets:S?"TOTAL ASSETS":"JUMLAH ASET",equityLiab:S?"EQUITY AND LIABILITIES":"EKUITI DAN LIABILITI",equity:S?"Equity":"Ekuiti",shareCap:S?"Share capital":"Modal saham",retained:S?"Retained earnings":"Pendapatan tertahan",totalEquity:S?"Total Equity":"Jumlah Ekuiti",cl:S?"Current Liabilities":"Liabiliti Semasa",tradePay:S?"Trade and other payables":"Pemiutang perdagangan dan lain-lain",borrowings:S?"Borrowings":"Pinjaman",taxPayable:S?"Tax payable":"Cukai kena bayar",totalLiab:S?"Total Liabilities":"Jumlah Liabiliti",totalEL:S?"TOTAL EQUITY AND LIABILITIES":"JUMLAH EKUITI DAN LIABILITI",revenue:S?"Revenue":"Hasil",costOfSales:S?"Cost of sales":"Kos jualan",grossProfit:S?"Gross profit":"Untung kasar",otherIncome:S?"Other income":"Pendapatan lain",adminExp:S?"Administrative expenses":"Perbelanjaan pentadbiran",finCosts:S?"Finance costs":"Kos kewangan",pbt:S?"Profit before taxation":"Untung sebelum cukai",tax:S?"Taxation":"Cukai",profitYear:S?"Profit for the financial year":"Untung bagi tahun kewangan",oci:S?"Other comprehensive income":"Pendapatan komprehensif lain",totalCI:S?"Total comprehensive income for the year":"Jumlah pendapatan komprehensif bagi tahun",integral:S?"The accompanying notes form an integral part of these financial statements.":"Nota-nota yang dilampirkan merupakan sebahagian yang tidak terpisahkan daripada penyata kewangan ini.",genOn:S?"Generated on":"Dijana pada",incMalaysia:S?"Incorporated in Malaysia":"Diperbadankan di Malaysia",regNo:S?"Registration No.":"No. Pendaftaran"},C=qt=>{if(qt==null||qt===0)return"-";const ii=Number(qt);return ii<0?`(${Math.abs(ii).toLocaleString("en-MY")})`:ii.toLocaleString("en-MY")},O=(qt,ii="",Ln=!1)=>`<td class="${["amt",ii,Ln?"bold":""].filter(Boolean).join(" ")}"><div>${qt}</div></td>`,G='<colgroup><col style="width:60%"/><col style="width:8%"/><col style="width:16%"/><col style="width:16%"/></colgroup>',xe='<colgroup><col style="width:40%"/><col style="width:20%"/><col style="width:20%"/><col style="width:20%"/></colgroup>',Re='<colgroup><col style="width:60%"/><col style="width:20%"/><col style="width:20%"/></colgroup>',ye=`
<div class="page">
  <table style="width:100%; height:22cm;">
    <tr>
      <td style="text-align:center; vertical-align:middle;">
        <div style="font-size:16pt; font-weight:bold;">${bi(y.toUpperCase())}</div>
        <div class="sp-1" style="font-size:11pt;">(${D.regNo} ${bi(v)})</div>
        <div style="font-size:11pt;">(${D.incMalaysia})</div>
        <div class="sp-3" style="font-size:14pt; font-weight:bold;">${D.title}</div>
        <div class="sp-2" style="font-size:12pt;">${D.forYear}</div>
        <div style="font-size:12pt; font-weight:bold;">31 DECEMBER ${L}</div>
        <div class="sp-3 small muted">${bi(T)}</div>
        <div class="sp-2 small muted">${D.genOn}: ${bi(W)}</div>
      </td>
    </tr>
  </table>
</div>`,X=`
<div class="page">
  <div class="section-title">${D.contents}</div>
  <table style="width:60%; margin:30pt auto;">
    <tr><td style="padding:5pt 0;">${D.sofp}</td><td style="text-align:right; width:50px;">1</td></tr>
    <tr><td style="padding:5pt 0;">${D.sopl}</td><td style="text-align:right;">2</td></tr>
    <tr><td style="padding:5pt 0;">${D.soce}</td><td style="text-align:right;">3</td></tr>
    <tr><td style="padding:5pt 0;">${D.socf}</td><td style="text-align:right;">4</td></tr>
    <tr><td style="padding:5pt 0;">${D.notes}</td><td style="text-align:right;">5 - 8</td></tr>
  </table>
</div>`;let V="";V+=`<tr>
      <td class="desc"></td>
      <td class="note hdr-border"><div>${D.note}</div></td>
      <td class="amt hdr-border"><div>${L}<br/>${D.rm}</div></td>
      <td class="amt hdr-border"><div>${L-1}<br/>${D.rm}</div></td>
    </tr>`,V+=`<tr><td class="desc bold">${D.assets}</td><td class="note"></td><td class="amt"><div></div></td><td class="amt"><div></div></td></tr>`,V+=`<tr><td class="desc bold">${D.nca}</td><td class="note"></td><td class="amt"><div></div></td><td class="amt"><div></div></td></tr>`,m.bs.ppe>0&&(V+=`<tr><td class="desc ind1">${D.ppe}</td><td class="note">3</td>${O(C(m.bs.ppe))}${O("-")}</tr>`),V+=`<tr><td class="desc"></td><td class="note"></td>${O(C(m.bs.ppe||0),"amt-line-bottom")}${O("-","amt-line-bottom")}</tr>`,V+=`<tr><td class="desc bold" style="padding-top:10pt;">${D.ca}</td><td class="note"></td><td class="amt"><div></div></td><td class="amt"><div></div></td></tr>`,m.bs.inv>0&&(V+=`<tr><td class="desc ind1">${D.inventories}</td><td class="note">4</td>${O(C(m.bs.inv))}${O("-")}</tr>`),m.bs.recv>0&&(V+=`<tr><td class="desc ind1">${D.tradeRec}</td><td class="note">5</td>${O(C(m.bs.recv))}${O("-")}</tr>`),V+=`<tr><td class="desc ind1">${D.cashBank}</td><td class="note">6</td>${O(C(m.bs.cash))}${O("-")}</tr>`,V+=`<tr><td class="desc"></td><td class="note"></td>${O(C(m.bs.totCA),"amt-line-bottom")}${O("-","amt-line-bottom")}</tr>`,V+=`<tr><td class="desc bold">${D.totalAssets}</td><td class="note"></td>${O(C(m.bs.totA),"amt-line-double",!0)}${O("-","amt-line-double",!0)}</tr>`,V+=`<tr><td class="desc bold" style="padding-top:15pt;">${D.equityLiab}</td><td class="note"></td><td class="amt"><div></div></td><td class="amt"><div></div></td></tr>`,V+=`<tr><td class="desc bold">${D.equity}</td><td class="note"></td><td class="amt"><div></div></td><td class="amt"><div></div></td></tr>`,V+=`<tr><td class="desc ind1">${D.shareCap}</td><td class="note">7</td>${O(C(m.bs.shareCap))}${O("-")}</tr>`,V+=`<tr><td class="desc ind1">${D.retained}</td><td class="note"></td>${O(C(m.bs.retainedEarnings))}${O("-")}</tr>`,V+=`<tr><td class="desc bold">${D.totalEquity}</td><td class="note"></td>${O(C(m.bs.totE),"amt-line-bottom",!0)}${O("-","amt-line-bottom",!0)}</tr>`,V+=`<tr><td class="desc bold" style="padding-top:10pt;">${D.cl}</td><td class="note"></td><td class="amt"><div></div></td><td class="amt"><div></div></td></tr>`,m.bs.payables>0&&(V+=`<tr><td class="desc ind1">${D.tradePay}</td><td class="note">8</td>${O(C(m.bs.payables))}${O("-")}</tr>`),m.bs.borrowings>0&&(V+=`<tr><td class="desc ind1">${D.borrowings}</td><td class="note">9</td>${O(C(m.bs.borrowings))}${O("-")}</tr>`),m.bs.taxPayable>0&&(V+=`<tr><td class="desc ind1">${D.taxPayable}</td><td class="note"></td>${O(C(m.bs.taxPayable))}${O("-")}</tr>`),V+=`<tr><td class="desc bold">${D.totalLiab}</td><td class="note"></td>${O(C(m.bs.totL),"amt-line-bottom",!0)}${O("-","amt-line-bottom",!0)}</tr>`,V+=`<tr><td class="desc bold" style="padding-top:8pt;">${D.totalEL}</td><td class="note"></td>${O(C(m.bs.totA),"amt-line-double",!0)}${O("-","amt-line-double",!0)}</tr>`;const Me=`
<div class="page">
  <div class="section-title">${D.sofp}</div>
  <div class="section-subtitle">${D.asAt} 31 DECEMBER ${L}</div>
  <table class="fs">${G}<tbody>${V}</tbody></table>
  <div class="integral-note">${D.integral}</div>
</div>`;let Be="";Be+=`<tr>
      <td class="desc"></td>
      <td class="note hdr-border"><div>${D.note}</div></td>
      <td class="amt hdr-border"><div>${L}<br/>${D.rm}</div></td>
      <td class="amt hdr-border"><div>${L-1}<br/>${D.rm}</div></td>
    </tr>`,Be+=`<tr><td class="desc">${D.revenue}</td><td class="note">10</td>${O(C(m.is.rev))}${O("-")}</tr>`,Be+=`<tr><td class="desc">${D.costOfSales}</td><td class="note"></td>${O("("+C(m.is.cos)+")")}${O("-")}</tr>`,Be+=`<tr><td class="desc bold">${D.grossProfit}</td><td class="note"></td>${O(C(m.is.gp),"amt-line-bottom",!0)}${O("-","amt-line-bottom",!0)}</tr>`,m.is.oi>0&&(Be+=`<tr><td class="desc">${D.otherIncome}</td><td class="note">11</td>${O(C(m.is.oi))}${O("-")}</tr>`),Be+=`<tr><td class="desc">${D.adminExp}</td><td class="note">12</td>${O("("+C(m.is.adm)+")")}${O("-")}</tr>`,m.is.fin>0&&(Be+=`<tr><td class="desc">${D.finCosts}</td><td class="note"></td>${O("("+C(m.is.fin)+")")}${O("-")}</tr>`),Be+=`<tr><td class="desc bold">${D.pbt}</td><td class="note"></td>${O(C(m.is.pbt),"amt-line-bottom",!0)}${O("-","amt-line-bottom",!0)}</tr>`,Be+=`<tr><td class="desc">${D.tax}</td><td class="note">13</td>${O(m.is.tax>0?"("+C(m.is.tax)+")":"-")}${O("-")}</tr>`,Be+=`<tr><td class="desc bold">${D.profitYear}</td><td class="note"></td>${O(C(m.is.np),"amt-line-double",!0)}${O("-","amt-line-double",!0)}</tr>`,Be+=`<tr><td class="desc" style="padding-top:12pt;"><em>${D.oci}</em></td><td class="note"></td>${O("-")}${O("-")}</tr>`,Be+=`<tr><td class="desc bold">${D.totalCI}</td><td class="note"></td>${O(C(m.is.np),"amt-line-double",!0)}${O("-","amt-line-double",!0)}</tr>`;const pe=`
<div class="page">
  <div class="section-title">${D.sopl}</div>
  <div class="section-subtitle">${D.forYear} 31 DECEMBER ${L}</div>
  <table class="fs">${G}<tbody>${Be}</tbody></table>
  <div class="integral-note">${D.integral}</div>
</div>`,We=(m.bs.retainedEarnings||0)-(m.is.np||0),Ve=(m.bs.shareCap||0)+We;let it="";it+=`<tr>
      <td class="desc"></td>
      <td class="amt hdr-border"><div>${D.shareCap}<br/>${D.rm}</div></td>
      <td class="amt hdr-border"><div>${D.retained}<br/>${D.rm}</div></td>
      <td class="amt hdr-border"><div>${S?"Total":"Jumlah"}<br/>${D.rm}</div></td>
    </tr>`,it+=`<tr><td class="desc">${S?"Balance at 1 January":"Baki pada 1 Januari"} ${L}</td>${O(C(m.bs.shareCap))}${O(C(We))}${O(C(Ve))}</tr>`,it+=`<tr><td class="desc">${D.profitYear}</td>${O("-")}${O(C(m.is.np))}${O(C(m.is.np))}</tr>`,it+=`<tr><td class="desc bold">${S?"Balance at 31 December":"Baki pada 31 Disember"} ${L}</td>${O(C(m.bs.shareCap),"amt-line-double",!0)}${O(C(m.bs.retainedEarnings),"amt-line-double",!0)}${O(C(m.bs.totE),"amt-line-double",!0)}</tr>`;const Vt=`
<div class="page">
  <div class="section-title">${D.soce}</div>
  <div class="section-subtitle">${D.forYear} 31 DECEMBER ${L}</div>
  <table class="fs">${xe}<tbody>${it}</tbody></table>
  <div class="integral-note">${D.integral}</div>
</div>`;let lt="";lt+=`<tr>
      <td class="desc"></td>
      <td class="amt hdr-border"><div>${L}<br/>${D.rm}</div></td>
      <td class="amt hdr-border"><div>${L-1}<br/>${D.rm}</div></td>
    </tr>`,lt+=`<tr><td class="desc bold">${S?"Cash flows from operating activities":"Aliran tunai daripada aktiviti operasi"}</td><td class="amt"><div></div></td><td class="amt"><div></div></td></tr>`,lt+=`<tr><td class="desc ind1">${D.profitYear}</td>${O(C(m.is.np))}${O("-")}</tr>`,lt+=`<tr><td class="desc ind1">${S?"Adjustments for:":"Pelarasan untuk:"}</td><td class="amt"><div></div></td><td class="amt"><div></div></td></tr>`,m.is.dep>0&&(lt+=`<tr><td class="desc ind2">${S?"Depreciation":"Susut nilai"}</td>${O(C(m.is.dep))}${O("-")}</tr>`),lt+=`<tr><td class="desc ind1">${S?"Operating profit before working capital changes":"Keuntungan operasi sebelum perubahan modal kerja"}</td>${O(C((m.is.np||0)+(m.is.dep||0)),"amt-line-bottom")}${O("-","amt-line-bottom")}</tr>`,m.bs.inv>0&&(lt+=`<tr><td class="desc ind1">${S?"Increase in inventories":"Kenaikan inventori"}</td>${O("("+C(m.bs.inv)+")")}${O("-")}</tr>`),m.bs.recv>0&&(lt+=`<tr><td class="desc ind1">${S?"Increase in receivables":"Kenaikan penghutang"}</td>${O("("+C(m.bs.recv)+")")}${O("-")}</tr>`),m.bs.payables>0&&(lt+=`<tr><td class="desc ind1">${S?"Increase in payables":"Kenaikan pemiutang"}</td>${O(C(m.bs.payables))}${O("-")}</tr>`);const Fa=(m.is.np||0)+(m.is.dep||0)-(m.bs.inv||0)-(m.bs.recv||0)+(m.bs.payables||0);lt+=`<tr><td class="desc bold">${S?"Cash generated from operations":"Tunai dijana daripada operasi"}</td>${O(C(Fa),"amt-line-bottom",!0)}${O("-","amt-line-bottom",!0)}</tr>`,lt+=`<tr><td class="desc bold" style="padding-top:12pt;">${S?"Cash flows from investing activities":"Aliran tunai daripada aktiviti pelaburan"}</td><td class="amt"><div></div></td><td class="amt"><div></div></td></tr>`,m.bs.ppe>0&&(lt+=`<tr><td class="desc ind1">${S?"Purchase of property, plant and equipment":"Pembelian hartanah, loji dan peralatan"}</td>${O("("+C(m.bs.ppe_cost||m.bs.ppe)+")")}${O("-")}</tr>`);const Ka=-(m.bs.ppe_cost||m.bs.ppe||0);lt+=`<tr><td class="desc bold">${S?"Net cash used in investing activities":"Tunai bersih digunakan dalam aktiviti pelaburan"}</td>${O(C(Ka),"amt-line-bottom",!0)}${O("-","amt-line-bottom",!0)}</tr>`,lt+=`<tr><td class="desc bold" style="padding-top:12pt;">${S?"Cash flows from financing activities":"Aliran tunai daripada aktiviti pembiayaan"}</td><td class="amt"><div></div></td><td class="amt"><div></div></td></tr>`,lt+=`<tr><td class="desc ind1">${S?"Proceeds from issuance of share capital":"Hasil daripada penerbitan modal saham"}</td>${O(C(m.bs.shareCap))}${O("-")}</tr>`,m.bs.borrowings>0&&(lt+=`<tr><td class="desc ind1">${S?"Proceeds from borrowings":"Hasil daripada pinjaman"}</td>${O(C(m.bs.borrowings))}${O("-")}</tr>`);const Wr=(m.bs.shareCap||0)+(m.bs.borrowings||0);lt+=`<tr><td class="desc bold">${S?"Net cash from financing activities":"Tunai bersih daripada aktiviti pembiayaan"}</td>${O(C(Wr),"amt-line-bottom",!0)}${O("-","amt-line-bottom",!0)}</tr>`,lt+=`<tr><td class="desc bold" style="padding-top:12pt;">${S?"Net increase in cash and cash equivalents":"Kenaikan bersih dalam tunai dan setara tunai"}</td>${O(C(m.bs.cash),"",!0)}${O("-")}</tr>`,lt+=`<tr><td class="desc">${S?"Cash and cash equivalents at beginning of year":"Tunai dan setara tunai pada awal tahun"}</td>${O("-")}${O("-")}</tr>`,lt+=`<tr><td class="desc bold">${S?"Cash and cash equivalents at end of year":"Tunai dan setara tunai pada akhir tahun"}</td>${O(C(m.bs.cash),"amt-line-double",!0)}${O("-","amt-line-double",!0)}</tr>`;const st=`
<div class="page">
  <div class="section-title">${D.socf}</div>
  <div class="section-subtitle">${D.forYear} 31 DECEMBER ${L}</div>
  <table class="fs">${Re}<tbody>${lt}</tbody></table>
  <div class="integral-note">${D.integral}</div>
</div>`,Ut=`<div class="page">${`
<div class="section-title">${D.notes}</div>
<div class="section-subtitle">${D.forYear} 31 DECEMBER ${L}</div>

<div class="note-title">1. ${S?"GENERAL INFORMATION":"MAKLUMAT AM"}</div>
<p class="note-text">${bi(y)} ${S?"is a private limited company, incorporated and domiciled in Malaysia. The registered office and principal place of business of the Company is located in Malaysia.":"adalah sebuah syarikat sendirian berhad yang diperbadankan dan bermastautin di Malaysia. Pejabat berdaftar dan tempat perniagaan utama Syarikat terletak di Malaysia."}</p>
<p class="note-text">${S?"The principal activity of the Company is":"Aktiviti utama Syarikat adalah"} ${bi(Ot?.activity||(S?"general trading and services.":"perdagangan dan perkhidmatan am."))}</p>

<div class="note-title">2. ${S?"BASIS OF PREPARATION":"ASAS PENYEDIAAN"}</div>
<p class="note-text">${S?"The financial statements of the Company have been prepared in accordance with":"Penyata kewangan Syarikat telah disediakan mengikut"} ${bi(T)} ${S?"and the requirements of the Companies Act 2016 in Malaysia.":"dan keperluan Akta Syarikat 2016 di Malaysia."}</p>

<div class="note-title">3. ${S?"PROPERTY, PLANT AND EQUIPMENT":"HARTANAH, LOJI DAN PERALATAN"}</div>
${m.bs.ppe>0?`
<table class="noteTbl">
  <colgroup><col style="width:50%"/><col style="width:16%"/><col style="width:17%"/><col style="width:17%"/></colgroup>
  <tr>
    <td></td>
    <td class="amt hdr-border"><div>${S?"Cost":"Kos"}<br/>${D.rm}</div></td>
    <td class="amt hdr-border"><div>${S?"Acc. Dep.":"Susut Nilai"}<br/>${D.rm}</div></td>
    <td class="amt hdr-border"><div>NBV<br/>${D.rm}</div></td>
  </tr>
  <tr>
    <td>${S?"Plant & equipment":"Loji & peralatan"}</td>
    ${O(C(m.bs.ppe_cost||m.bs.ppe))}
    ${O(C(m.bs.ppe_accDep||0))}
    ${O(C(m.bs.ppe),"amt-line-double")}
  </tr>
</table>
`:`<p class="note-text">${S?"The Company does not have any property, plant and equipment.":"Syarikat tidak mempunyai sebarang hartanah, loji dan peralatan."}</p>`}

<div class="note-title">4. ${S?"SHARE CAPITAL":"MODAL SAHAM"}</div>
<table class="noteTbl">
  <colgroup><col style="width:70%"/><col style="width:30%"/></colgroup>
  <tr>
    <td>${S?"Issued and fully paid ordinary shares":"Saham biasa diterbitkan dan dibayar penuh"}</td>
    ${O(C(m.bs.shareCap),"amt-line-double")}
  </tr>
</table>

<div class="note-title">5. ${S?"REVENUE":"HASIL"}</div>
<table class="noteTbl">
  <colgroup><col style="width:70%"/><col style="width:30%"/></colgroup>
  <tr>
    <td>${S?"Revenue from contracts with customers":"Hasil daripada kontrak dengan pelanggan"}</td>
    ${O(C(m.is.rev),"amt-line-double")}
  </tr>
</table>

<div class="note-title">6. ${S?"ADMINISTRATIVE EXPENSES":"PERBELANJAAN PENTADBIRAN"}</div>
<table class="noteTbl">
  <colgroup><col style="width:70%"/><col style="width:30%"/></colgroup>
  ${m.is.details?.SALARY>0?`<tr><td>${S?"Staff costs":"Kos kakitangan"}</td>${O(C(m.is.details.SALARY))}</tr>`:""}
  ${m.is.details?.RENT>0?`<tr><td>${S?"Rental":"Sewa"}</td>${O(C(m.is.details.RENT))}</tr>`:""}
  ${m.is.details?.UTILITIES>0?`<tr><td>${S?"Utilities":"Utiliti"}</td>${O(C(m.is.details.UTILITIES))}</tr>`:""}
  ${m.is.dep>0?`<tr><td>${S?"Depreciation":"Susut nilai"}</td>${O(C(m.is.dep))}</tr>`:""}
  ${m.is.details?.PROFESSIONAL_FEES>0?`<tr><td>${S?"Professional fees":"Yuran profesional"}</td>${O(C(m.is.details.PROFESSIONAL_FEES))}</tr>`:""}
  ${m.is.details?.MISCELLANEOUS>0?`<tr><td>${S?"Other expenses":"Perbelanjaan lain"}</td>${O(C(m.is.details.MISCELLANEOUS))}</tr>`:""}
  <tr><td class="bold">${S?"Total":"Jumlah"}</td>${O(C(m.is.adm),"amt-line-double",!0)}</tr>
</table>

<div class="note-title">7. ${S?"TAXATION":"CUKAI"}</div>
<table class="noteTbl">
  <colgroup><col style="width:70%"/><col style="width:30%"/></colgroup>
  <tr>
    <td>${S?"Current tax expense":"Perbelanjaan cukai semasa"}</td>
    ${O(C(m.is.tax),"amt-line-double")}
  </tr>
</table>
<p class="note-text small">${S?"The tax expense is calculated based on the estimated chargeable income at the prevailing tax rate.":"Perbelanjaan cukai dikira berdasarkan anggaran pendapatan boleh dicukai pada kadar cukai semasa."}</p>
`}</div>`,vt=[ye,X,Me,pe,Vt,st,Ut],an=vt[0]+vt.slice(1).map(qt=>`<br clear="all" class="w-pb"/>${qt}`).join("");return R0({title:`${y} - Financial Statements ${L}`,bodyHtml:an})},gr=(u,y)=>{const v=URL.createObjectURL(u),S=document.createElement("a");S.href=v,S.download=y,document.body.appendChild(S),S.click(),S.remove(),setTimeout(()=>URL.revokeObjectURL(v),1500)},N0=(u,y="Report")=>{try{const v=document.createElement("iframe");v.style.position="fixed",v.style.right="0",v.style.bottom="0",v.style.width="0",v.style.height="0",v.style.border="0",v.style.visibility="hidden",document.body.appendChild(v);const S=v.contentWindow.document;return S.open(),S.write(u),S.title=y,S.close(),v.onload=()=>{try{v.contentWindow.focus(),v.contentWindow.print()}catch(T){console.error("Print failed:",T)}setTimeout(()=>{try{document.body.removeChild(v)}catch{}},2e3)},setTimeout(()=>{try{v.contentWindow.focus(),v.contentWindow.print()}catch{const W=window.open("","_blank");W?(W.document.open(),W.document.write(u),W.document.title=y,W.document.close(),setTimeout(()=>{W.focus(),W.print()},500)):alert('Could not open print dialog. Please use "Download HTML" and print from your browser.')}},1e3),!0}catch(v){return console.error("printHtmlToPdf error:",v),!1}},As=(u,y)=>{try{const v=Jv(u,{bookType:"xlsx",type:"array"}),S=new Blob([v],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});return gr(S,y),!0}catch(v){return console.error("Excel export error:",v),!1}},yl="V8",ea={NONE:"none",TOP:"top",BOTTOM:"bottom",DOUBLE_TOP:"double-top",DOUBLE_BOTTOM:"double-bottom"},Ko=(u,y)=>!u||y===ea.NONE?"":{[ea.TOP]:"border-top: 1px solid #000;",[ea.BOTTOM]:"border-bottom: 1px solid #000;",[ea.DOUBLE_TOP]:"border-top: 2px solid #000;",[ea.DOUBLE_BOTTOM]:"border-bottom: 3px double #000;"}[y]||"",_s=(u,y=ea.NONE)=>"<tr>"+u.map(v=>{const S=v.isAmt===!0,T=Ko(S,y),W=S?"right":v.align==="center"?"center":"",D=v.bold?" bold":"",C=v.indent?` padding-left: ${v.indent*15}px;`:"",O=T||C?` style="${T}${C}"`:"";return`<td class="${W}${D}"${O}>${v.content||""}</td>`}).join("")+"</tr>",Rt=(u,y,v,S,T={})=>{const{bold:W=!1,indent:D=0,line:C=ea.NONE}=T;return _s([{content:u,isAmt:!1,bold:W,indent:D},{content:y,isAmt:!1,align:"center"},{content:v,isAmt:!0,bold:W},{content:S,isAmt:!0,bold:W}],C)},Na=(u,y,v,S={})=>{const{bold:T=!1,indent:W=0,line:D=ea.NONE}=S;return _s([{content:u,isAmt:!1,bold:T,indent:W},{content:y,isAmt:!0,bold:T},{content:v,isAmt:!0,bold:T}],D)},Cs=(u,y,v,S,T={})=>{const{bold:W=!1,line:D=ea.NONE}=T;return _s([{content:u,isAmt:!1,bold:W},{content:y,isAmt:!0,bold:W},{content:v,isAmt:!0,bold:W},{content:S,isAmt:!0,bold:W}],D)},F0=(u,y,v={})=>{const{bold:S=!1,line:T=ea.NONE}=v;return _s([{content:u,isAmt:!1,bold:S},{content:y,isAmt:!0,bold:S}],T)},D0={EN:{title:"FINANCIAL STATEMENTS",forYear:"FOR THE FINANCIAL YEAR ENDED",asAt:"AS AT",regNo:"Registration No.",incMalaysia:"Incorporated in Malaysia",contents:"CONTENTS",page:"Page",continued:"continued",sofp:"STATEMENT OF FINANCIAL POSITION",sopl:"STATEMENT OF PROFIT OR LOSS AND OTHER COMPREHENSIVE INCOME",soplSimple:"STATEMENT OF PROFIT OR LOSS",soce:"STATEMENT OF CHANGES IN EQUITY",socf:"STATEMENT OF CASH FLOWS",notes:"NOTES TO THE FINANCIAL STATEMENTS",statementByDirectors:"STATEMENT BY DIRECTORS",statutoryDeclaration:"STATUTORY DECLARATION",revenue:"Revenue",costOfSales:"Cost of sales",grossProfit:"Gross profit",otherIncome:"Other income",adminExp:"Administrative expenses",otherExp:"Other expenses",finCosts:"Finance costs",pbt:"Profit before taxation",tax:"Taxation",profitYear:"Profit for the financial year",lossYear:"Loss for the financial year",oci:"Other comprehensive income for the year",totalCI:"Total comprehensive income for the year",assets:"ASSETS",nca:"Non-Current Assets",ppe:"Property, plant and equipment",intangibles:"Intangible assets",investments:"Investments",ca:"Current Assets",inventories:"Inventories",tradeRec:"Trade receivables",otherRec:"Other receivables, deposits and prepayments",taxRecoverable:"Tax recoverable",cashBank:"Cash and bank balances",totalAssets:"TOTAL ASSETS",equityLiab:"EQUITY AND LIABILITIES",equity:"Equity",shareCap:"Share capital",retained:"Retained earnings/(accumulated losses)",totalEquity:"Total Equity",ownerCapital:"Owner's capital",drawings:"Less: Drawings",liabilities:"Liabilities",ncl:"Non-Current Liabilities",ltBorrowings:"Long-term borrowings",deferredTax:"Deferred tax liabilities",cl:"Current Liabilities",tradePay:"Trade payables",otherPay:"Other payables and accruals",stBorrowings:"Short-term borrowings",taxPayable:"Tax payable",totalLiab:"Total Liabilities",totalEL:"TOTAL EQUITY AND LIABILITIES",cfOperating:"Cash flows from operating activities",cfInvesting:"Cash flows from investing activities",cfFinancing:"Cash flows from financing activities",netCashOps:"Net cash from operating activities",netCashInv:"Net cash used in investing activities",netCashFin:"Net cash from/(used in) financing activities",netIncrease:"Net increase/(decrease) in cash and cash equivalents",cashBF:"Cash and cash equivalents at beginning of year",cashCF:"Cash and cash equivalents at end of year",balanceAt:"Balance at",profitForYear:"Profit/(loss) for the year",dividendsPaid:"Dividends paid",note:"Note",rm:"RM",total:"Total",notesIntegral:"The accompanying notes form an integral part of these financial statements.",basisOfPrep:"BASIS OF PREPARATION",basisText:"The financial statements of the Company have been prepared in accordance with",summaryPolicies:"SUMMARY OF SIGNIFICANT ACCOUNTING POLICIES",revenueRecog:"Revenue recognition",ppePolicy:"Property, plant and equipment",inventoryPolicy:"Inventories",financialInstr:"Financial instruments",taxPolicy:"Taxation",notePPE:"PROPERTY, PLANT AND EQUIPMENT",noteInventory:"INVENTORIES",noteTradeRec:"TRADE AND OTHER RECEIVABLES",noteCash:"CASH AND BANK BALANCES",noteShareCap:"SHARE CAPITAL",noteOwnerCap:"OWNER'S CAPITAL",noteTradePay:"TRADE AND OTHER PAYABLES",noteBorrowings:"BORROWINGS",noteRevenue:"REVENUE",noteExpenses:"ADMINISTRATIVE EXPENSES",noteCostOfSales:"COST OF SALES",noteFinCosts:"FINANCE COSTS",noteTax:"TAXATION",noteRelatedParty:"RELATED PARTY DISCLOSURES",noteContingent:"CONTINGENT LIABILITIES",noteCommitments:"COMMITMENTS",noteSubseqEvents:"SUBSEQUENT EVENTS",atCost:"At cost",lessAccDep:"Less: Accumulated depreciation",nbv:"Net book value",depCharge:"Depreciation charge for the year",tradingGoods:"Trading goods / Finished goods",cashInHand:"Cash in hand",cashAtBank:"Cash at bank",issuedPaid:"Issued and fully paid:",ordinaryShares:"Ordinary shares",saleOfGoods:"Sale of goods",renderingServices:"Rendering of services",noContingent:"There were no contingent liabilities as at the end of the financial year.",noCommitments:"There were no capital commitments as at the end of the financial year.",noSubseqEvents:"There were no significant events occurring after the balance sheet date that require adjustments or disclosure in the financial statements."},BM:{title:"PENYATA KEWANGAN",forYear:"BAGI TAHUN KEWANGAN BERAKHIR",asAt:"PADA",regNo:"No. Pendaftaran",incMalaysia:"Diperbadankan di Malaysia",contents:"KANDUNGAN",page:"Muka Surat",continued:"sambungan",sofp:"PENYATA KEDUDUKAN KEWANGAN",sopl:"PENYATA UNTUNG RUGI DAN PENDAPATAN KOMPREHENSIF LAIN",soplSimple:"PENYATA UNTUNG RUGI",soce:"PENYATA PERUBAHAN EKUITI",socf:"PENYATA ALIRAN TUNAI",notes:"NOTA-NOTA KEPADA PENYATA KEWANGAN",statementByDirectors:"PENYATA OLEH PENGARAH",statutoryDeclaration:"AKUAN BERKANUN",revenue:"Hasil",costOfSales:"Kos jualan",grossProfit:"Untung kasar",otherIncome:"Pendapatan lain",adminExp:"Perbelanjaan pentadbiran",otherExp:"Perbelanjaan lain",finCosts:"Kos kewangan",pbt:"Untung sebelum cukai",tax:"Cukai",profitYear:"Untung bagi tahun kewangan",lossYear:"Rugi bagi tahun kewangan",oci:"Pendapatan komprehensif lain bagi tahun",totalCI:"Jumlah pendapatan komprehensif bagi tahun",assets:"ASET",nca:"Aset Bukan Semasa",ppe:"Hartanah, loji dan peralatan",intangibles:"Aset tak ketara",investments:"Pelaburan",ca:"Aset Semasa",inventories:"Inventori",tradeRec:"Penghutang perdagangan",otherRec:"Penghutang lain, deposit dan bayaran terdahulu",taxRecoverable:"Cukai boleh pulih",cashBank:"Tunai dan baki bank",totalAssets:"JUMLAH ASET",equityLiab:"EKUITI DAN LIABILITI",equity:"Ekuiti",shareCap:"Modal saham",retained:"Pendapatan tertahan/(kerugian terkumpul)",totalEquity:"Jumlah Ekuiti",ownerCapital:"Modal pemilik",drawings:"Tolak: Ambilan",liabilities:"Liabiliti",ncl:"Liabiliti Bukan Semasa",ltBorrowings:"Pinjaman jangka panjang",deferredTax:"Liabiliti cukai tertunda",cl:"Liabiliti Semasa",tradePay:"Pemiutang perdagangan",otherPay:"Pemiutang lain dan akruan",stBorrowings:"Pinjaman jangka pendek",taxPayable:"Cukai kena bayar",totalLiab:"Jumlah Liabiliti",totalEL:"JUMLAH EKUITI DAN LIABILITI",cfOperating:"Aliran tunai daripada aktiviti operasi",cfInvesting:"Aliran tunai daripada aktiviti pelaburan",cfFinancing:"Aliran tunai daripada aktiviti pembiayaan",netCashOps:"Tunai bersih daripada aktiviti operasi",netCashInv:"Tunai bersih digunakan dalam aktiviti pelaburan",netCashFin:"Tunai bersih daripada/(digunakan dalam) aktiviti pembiayaan",netIncrease:"Kenaikan/(penurunan) bersih tunai dan kesetaraan tunai",cashBF:"Tunai dan kesetaraan tunai pada awal tahun",cashCF:"Tunai dan kesetaraan tunai pada akhir tahun",balanceAt:"Baki pada",profitForYear:"Untung/(rugi) bagi tahun",dividendsPaid:"Dividen dibayar",note:"Nota",rm:"RM",total:"Jumlah",notesIntegral:"Nota-nota yang dilampirkan merupakan sebahagian yang tidak terpisahkan daripada penyata kewangan ini.",basisOfPrep:"ASAS PENYEDIAAN",basisText:"Penyata kewangan Syarikat telah disediakan selaras dengan",summaryPolicies:"RINGKASAN POLISI PERAKAUNAN YANG SIGNIFIKAN",revenueRecog:"Pengiktirafan hasil",ppePolicy:"Hartanah, loji dan peralatan",inventoryPolicy:"Inventori",financialInstr:"Instrumen kewangan",taxPolicy:"Percukaian",notePPE:"HARTANAH, LOJI DAN PERALATAN",noteInventory:"INVENTORI",noteTradeRec:"PENGHUTANG PERDAGANGAN DAN LAIN-LAIN",noteCash:"TUNAI DAN BAKI BANK",noteShareCap:"MODAL SAHAM",noteOwnerCap:"MODAL PEMILIK",noteTradePay:"PEMIUTANG PERDAGANGAN DAN LAIN-LAIN",noteBorrowings:"PINJAMAN",noteRevenue:"HASIL",noteExpenses:"PERBELANJAAN PENTADBIRAN",noteCostOfSales:"KOS JUALAN",noteFinCosts:"KOS KEWANGAN",noteTax:"PERCUKAIAN",noteRelatedParty:"PENDEDAHAN PIHAK BERKAITAN",noteContingent:"LIABILITI LUAR JANGKA",noteCommitments:"KOMITMEN",noteSubseqEvents:"PERISTIWA SELEPAS TARIKH PENYATA KEDUDUKAN KEWANGAN",atCost:"Pada kos",lessAccDep:"Tolak: Susut nilai terkumpul",nbv:"Nilai buku bersih",depCharge:"Caj susut nilai bagi tahun",tradingGoods:"Barang dagangan / Barang siap",cashInHand:"Tunai dalam tangan",cashAtBank:"Tunai di bank",issuedPaid:"Diterbitkan dan berbayar penuh:",ordinaryShares:"Saham biasa",saleOfGoods:"Jualan barangan",renderingServices:"Pemberian perkhidmatan",noContingent:"Tiada liabiliti luar jangka pada akhir tahun kewangan.",noCommitments:"Tiada komitmen modal pada akhir tahun kewangan.",noSubseqEvents:"Tiada peristiwa penting yang berlaku selepas tarikh penyata kedudukan kewangan yang memerlukan pelarasan atau pendedahan dalam penyata kewangan ini."}},Df=(u,y,v={})=>{if(!u)return{};const S=.5,T=Math.abs;return{isEnterprise:y==="ENTERPRISE",isSdnBhd:y==="SDN_BHD",isPublic:y==="BERHAD"||y==="LLP",hasPPE:T(u.bs?.ppe||0)>S||T(u.bs?.ppe_cost||0)>S||ft&&ft.length>0,hasIntangibles:T(u.bs?.intangibles||0)>S,hasInvestments:T(u.bs?.investments||0)>S,hasInventory:T(u.bs?.inv||0)>S,hasTradeReceivables:T(u.bs?.tr||0)>S,hasOtherReceivables:T(u.bs?.or||0)>S||T(u.bs?.prepaid||0)>S||T(u.bs?.deposits||0)>S,hasCash:T(u.bs?.cash||0)>S,hasCashInHand:T(u.bs?.cashInHand||0)>S,hasShareCapital:y!=="ENTERPRISE"&&T(u.bs?.cap||0)>S,hasRetainedEarnings:T(u.bs?.ret||0)>S,hasTradePayables:T(u.bs?.tp||0)>S,hasOtherPayables:T(u.bs?.op||0)>S,hasSTBorrowings:T(u.bs?.borr||0)>S,hasLTBorrowings:T(u.bs?.ltBorr||0)>S,hasBorrowings:T(u.bs?.borr||0)>S||T(u.bs?.ltBorr||0)>S,hasTaxPayable:T(u.bs?.taxPay||0)>S,hasDeferredTax:T(u.bs?.defTax||0)>S,hasRevenue:T(u.is?.rev||0)>S,hasCostOfSales:T(u.is?.cos||0)>S,hasOtherIncome:T(u.is?.oi||0)>S,hasAdminExpenses:T(u.is?.adm||0)>S,hasOtherExpenses:T(u.is?.oe||0)>S,hasFinanceCosts:T(u.is?.fin||0)>S,hasDepreciation:T(u.is?.dep||0)>S,hasTaxExpense:T(u.is?.tax||0)>S,hasCashFlow:u.cf&&(T(u.cf?.operating||0)>S||T(u.cf?.investing||0)>S||T(u.cf?.financing||0)>S),hasPPERegister:ft&&ft.length>0,hasLoanRegister:loanRegister&&loanRegister.length>0,hasReceivablesRegister:receivablesRegister&&receivablesRegister.length>0,hasPayablesRegister:payablesRegister&&payablesRegister.length>0}},jf=({entityType:u,lang:y,company:v,fsRes:S,comparatives:T={},options:W={}})=>{if(!S)return null;const D=D0[y]||D0.EN,C=Df(S,u,{}),O=C.isEnterprise;C.isSdnBhd,C.isPublic;const G=Be=>Be==null?"-":Number(Be).toLocaleString("en-MY",{minimumFractionDigits:0,maximumFractionDigits:0}),xe=Be=>Be==null?"-":Be<0?"("+G(Math.abs(Be))+")":G(Be);let Re=1;const ye=()=>Re++,V=(()=>{const Be=[];if(Be.push({no:ye(),id:"basis",title:D.basisOfPrep,include:!0,content:{type:"text",text:D.basisText+" "+(Ot?.fullStandard||"Malaysian Private Entities Reporting Standard (MPERS)")+"."}}),O||Be.push({no:ye(),id:"policies",title:D.summaryPolicies,include:!0,content:{type:"policies"}}),C.hasPPE&&Be.push({no:ye(),id:"ppe",title:D.notePPE,include:!0,content:{type:"ppe",cost:S.bs.ppe_cost||0,accDep:S.bs.ppe_accDep||0,nbv:S.bs.ppe||0,currentDep:S.is.dep||0,register:ft||[]}}),C.hasInventory&&Be.push({no:ye(),id:"inventory",title:D.noteInventory,include:!0,content:{type:"simple",rows:[{label:D.tradingGoods,amount:S.bs.inv}]}}),C.hasTradeReceivables||C.hasOtherReceivables){const pe=[];C.hasTradeReceivables&&pe.push({label:D.tradeRec,amount:S.bs.tr}),S.bs.or>0&&pe.push({label:y==="BM"?"Penghutang lain":"Other receivables",amount:S.bs.or}),S.bs.prepaid>0&&pe.push({label:y==="BM"?"Bayaran terdahulu":"Prepayments",amount:S.bs.prepaid}),S.bs.deposits>0&&pe.push({label:y==="BM"?"Deposit":"Deposits",amount:S.bs.deposits}),Be.push({no:ye(),id:"receivables",title:D.noteTradeRec,include:!0,content:{type:"simple",rows:pe,showTotal:pe.length>1,total:(S.bs.tr||0)+(S.bs.or||0)+(S.bs.prepaid||0)+(S.bs.deposits||0)}})}if(C.hasCash&&Be.push({no:ye(),id:"cash",title:D.noteCash,include:!0,content:{type:"simple",rows:[{label:D.cashInHand,amount:S.bs.cashInHand||0},{label:D.cashAtBank,amount:S.bs.cash-(S.bs.cashInHand||0)}],showTotal:!0,total:S.bs.cash}}),!O&&C.hasShareCapital&&Be.push({no:ye(),id:"sharecapital",title:D.noteShareCap,include:!0,content:{type:"sharecapital",amount:S.bs.cap}}),O&&Be.push({no:ye(),id:"ownercapital",title:D.noteOwnerCap,include:!0,content:{type:"simple",rows:[{label:D.ownerCapital,amount:S.bs.cap||0},{label:D.drawings,amount:-(S.bs.drawings||0)}],showTotal:!0,total:(S.bs.cap||0)-(S.bs.drawings||0)}}),C.hasTradePayables||C.hasOtherPayables){const pe=[];C.hasTradePayables&&pe.push({label:D.tradePay,amount:S.bs.tp}),C.hasOtherPayables&&pe.push({label:D.otherPay,amount:S.bs.op}),Be.push({no:ye(),id:"payables",title:D.noteTradePay,include:!0,content:{type:"simple",rows:pe,showTotal:pe.length>1,total:(S.bs.tp||0)+(S.bs.op||0)}})}if(C.hasBorrowings){const pe=[];C.hasSTBorrowings&&pe.push({label:D.stBorrowings,amount:S.bs.borr}),C.hasLTBorrowings&&pe.push({label:D.ltBorrowings,amount:S.bs.ltBorr}),Be.push({no:ye(),id:"borrowings",title:D.noteBorrowings,include:!0,content:{type:"simple",rows:pe,showTotal:pe.length>1,total:(S.bs.borr||0)+(S.bs.ltBorr||0)}})}if(C.hasRevenue&&Be.push({no:ye(),id:"revenue",title:D.noteRevenue,include:!0,content:{type:"simple",rows:[{label:D.saleOfGoods,amount:S.is.rev}]}}),C.hasCostOfSales&&Be.push({no:ye(),id:"costOfSales",title:D.noteCostOfSales,include:!0,content:{type:"simple",rows:[{label:y==="BM"?"Belian":"Purchases",amount:S.is.details?.PURCHASE||S.is.cos}]}}),C.hasAdminExpenses){const pe=[];["SALARY","RENT","UTILITIES","DEPRECIATION","OFFICE_SUPPLIES","PROFESSIONAL_FEES","MARKETING","TRANSPORT","ENTERTAINMENT","INSURANCE","REPAIRS","COMMUNICATION"].forEach(Ve=>{if(S.is.details?.[Ve]>0){const it={SALARY:y==="BM"?"Gaji dan upah":"Salaries and wages",RENT:y==="BM"?"Sewa":"Rental",UTILITIES:y==="BM"?"Utiliti":"Utilities",DEPRECIATION:y==="BM"?"Susut nilai":"Depreciation",OFFICE_SUPPLIES:y==="BM"?"Bekalan pejabat":"Office supplies",PROFESSIONAL_FEES:y==="BM"?"Yuran profesional":"Professional fees",MARKETING:y==="BM"?"Pemasaran dan pengiklanan":"Marketing and advertising",TRANSPORT:y==="BM"?"Pengangkutan":"Transport",ENTERTAINMENT:y==="BM"?"Keraian":"Entertainment",INSURANCE:y==="BM"?"Insurans":"Insurance",REPAIRS:y==="BM"?"Pembaikan dan penyelenggaraan":"Repairs and maintenance",COMMUNICATION:y==="BM"?"Komunikasi":"Communication"};pe.push({label:it[Ve]||Ve,amount:S.is.details[Ve]})}}),pe.length===0&&pe.push({label:D.adminExp,amount:S.is.adm}),Be.push({no:ye(),id:"expenses",title:D.noteExpenses,include:!0,content:{type:"simple",rows:pe,showTotal:pe.length>1,total:S.is.adm}})}return C.hasFinanceCosts&&Be.push({no:ye(),id:"fincosts",title:D.noteFinCosts,include:!0,content:{type:"simple",rows:[{label:y==="BM"?"Faedah atas pinjaman":"Interest on borrowings",amount:S.is.fin}]}}),(C.hasTaxExpense||C.hasTaxPayable)&&Be.push({no:ye(),id:"tax",title:D.noteTax,include:!0,content:{type:"simple",rows:[{label:y==="BM"?"Cukai semasa":"Current tax",amount:S.is.tax}]}}),O||Be.push({no:ye(),id:"relatedparty",title:D.noteRelatedParty,include:!0,content:{type:"relatedparty",directorFees:S.is.details?.DIRECTOR_FEE||Math.round((S.is.adm||0)*.15)}}),O||Be.push({no:ye(),id:"contingent",title:D.noteContingent,include:!0,content:{type:"text",text:D.noContingent}}),O||Be.push({no:ye(),id:"commitments",title:D.noteCommitments,include:!0,content:{type:"text",text:D.noCommitments}}),O||Be.push({no:ye(),id:"subsequent",title:D.noteSubseqEvents,include:!0,content:{type:"text",text:D.noSubseqEvents}}),Be.filter(pe=>pe.include)})(),Me=7+Math.ceil(V.length/3);return{meta:{entityType:u,lang:y,companyName:v.name||s,companyRegNo:v.regNo||f,accountingStandard:Ot?.fullStandard||"Malaysian Private Entities Reporting Standard (MPERS)",currentYear:L,priorYear:L-1,fyeDate:g,fyeDisplay:(()=>{const[Be,pe]=(g||"12-31").split("-"),it=y==="BM"?["","Januari","Februari","Mac","April","Mei","Jun","Julai","Ogos","September","Oktober","November","Disember"]:["","January","February","March","April","May","June","July","August","September","October","November","December"];return pe+" "+it[parseInt(Be)]+" "+L})()},applicability:C,labels:D,helpers:{fmtNum:G,fmtBracket:xe},toc:[{title:D.sofp,page:3,include:!0},{title:O?D.soplSimple:D.sopl,page:4,include:!0},{title:D.soce,page:5,include:!O},{title:D.socf,page:6,include:C.hasCashFlow||!O},{title:D.notes,page:"7 - "+Me,include:!0}].filter(Be=>Be.include),sections:{cover:{include:!0},toc:{include:!0},sofp:{include:!0,title:D.sofp,data:S.bs},sopl:{include:!0,title:O?D.soplSimple:D.sopl,data:S.is,showOCI:!O},soce:{include:!O,title:D.soce,data:{openingRE:S.bs.ret-S.bs.cyp,profit:S.bs.cyp,closingRE:S.bs.ret,shareCap:S.bs.cap}},socf:{include:C.hasCashFlow||!O,title:D.socf,data:S.cf},notes:{include:!0,title:D.notes,items:V}},includedNotes:V.map(Be=>({no:Be.no,title:Be.title,id:Be.id}))}},to=u=>{if(!u)return"";const{meta:y,labels:v,helpers:S,sections:T,toc:W,applicability:D}=u,{fmtNum:C,fmtBracket:O}=S,G=D.isEnterprise,xe=y.lang||"EN";let ye=`<!DOCTYPE html><html lang="${xe==="BM"?"ms":"en"}"><head><meta charset="UTF-8"><title>${y.companyName} - ${v.title} ${y.currentYear}</title><style>
      @page { size: A4; margin: 2cm; }
      @media print { .page { page-break-after: always; } .page:last-child { page-break-after: avoid; } }
      * { box-sizing: border-box; }
      body { font-family: "Times New Roman", Times, serif; font-size: 11pt; line-height: 1.5; color: #000; max-width: 210mm; margin: 0 auto; padding: 20px; }
      .page { page-break-after: always; page-break-inside: avoid; padding-bottom: 20px; margin-bottom: 20px; min-height: 270mm; }
      .page:last-child { page-break-after: avoid; }
      .header { text-align: center; margin-bottom: 25px; }
      .header h1 { font-size: 14pt; font-weight: bold; margin: 0 0 5px 0; text-transform: uppercase; }
      .header h2 { font-size: 12pt; font-weight: bold; margin: 0 0 5px 0; text-transform: uppercase; }
      .section-title { font-size: 11pt; font-weight: bold; text-transform: uppercase; margin: 20px 0 10px 0; }
      .subsection { font-size: 11pt; font-weight: bold; margin: 15px 0 8px 0; }
      table { width: 100%; border-collapse: collapse; margin: 10px 0; }
      table.fs th, table.fs td { padding: 4px 8px; text-align: left; vertical-align: top; font-size: 10pt; }
      .right { text-align: right; }
      .center { text-align: center; }
      .bold { font-weight: bold; }
      .indent { padding-left: 15px; }
      .indent2 { padding-left: 30px; }
      .note-text { font-size: 10pt; margin: 8px 0; text-align: justify; line-height: 1.6; }
      .note-table th, .note-table td { border: 1px solid #000; padding: 4px 6px; font-size: 9pt; }
      .note-table th { background: #f5f5f5; font-weight: bold; }
      .toc-item { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px dotted #ccc; }
      .company-header { text-align: right; font-size: 9pt; margin-bottom: 10px; color: #666; }
      .integral-note { font-size: 9pt; font-style: italic; margin-top: 20px; text-align: center; }
      .version-footer { font-size: 8pt; color: #999; text-align: center; margin-top: 30px; }
    </style></head><body>`;if(ye+=`<div class="page" style="display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;">
      <div style="margin-bottom:80px;">
        <h1 style="font-size:22pt;margin-bottom:15px;letter-spacing:1px;">${y.companyName.toUpperCase()}</h1>
        <p style="font-size:11pt;">(${v.regNo}: ${y.companyRegNo})</p>
        <p style="font-size:10pt;margin-top:3px;">(${v.incMalaysia})</p>
      </div>
      <div style="margin-bottom:80px;">
        <h2 style="font-size:18pt;font-weight:bold;letter-spacing:2px;">${v.title}</h2>
        <p style="font-size:12pt;margin-top:25px;">${v.forYear}</p>
        <p style="font-size:14pt;font-weight:bold;margin-top:5px;">${y.fyeDisplay.toUpperCase()}</p>
      </div>
      <div style="margin-top:60px;">
        <p style="font-size:10pt;font-style:italic;">${y.accountingStandard}</p>
        <p class="version-footer">Generated by FS Automation ${yl}</p>
      </div>
    </div>`,ye+=`<div class="page">
      <div class="header"><h1>${y.companyName.toUpperCase()}</h1></div>
      <h2 style="text-align:center;margin-bottom:30px;">${v.contents}</h2>
      <div style="max-width:400px;margin:0 auto;">
        ${W.map(X=>`<div class="toc-item"><span>${X.title}</span><span>${X.page}</span></div>`).join("")}
      </div>
    </div>`,T.sofp.include){const X=T.sofp.data;ye+=`<div class="page">
        <div class="company-header">${y.companyName.toUpperCase()} (${y.companyRegNo})</div>
        <div class="header"><h2>${v.sofp}</h2><p>${v.asAt} ${y.fyeDisplay.toUpperCase()}</p></div>
        <table class="fs">
          <thead><tr><th style="width:55%"></th><th class="center" style="width:10%">${v.note}</th><th class="right" style="width:17%">${y.currentYear}<br>${v.rm}</th><th class="right" style="width:18%">${y.priorYear}<br>${v.rm}</th></tr></thead>
          <tbody>
            ${Rt(v.assets,"","","",{bold:!0})}
            ${Rt(v.nca,"","","",{bold:!0})}
            ${D.hasPPE?Rt(v.ppe,T.notes.items.find(V=>V.id==="ppe")?.no||"",C(X.ppe),C(X.py_ppe||0),{indent:1}):""}
            ${D.hasIntangibles?Rt(v.intangibles,"",C(X.intangibles),"-",{indent:1}):""}
            ${Rt("","",C(X.totNCA||X.ppe||0),C(X.py_totNCA||0),{bold:!0,line:ea.TOP})}
            ${Rt(v.ca,"","","",{bold:!0})}
            ${D.hasInventory?Rt(v.inventories,T.notes.items.find(V=>V.id==="inventory")?.no||"",C(X.inv),C(X.py_inv||0),{indent:1}):""}
            ${D.hasTradeReceivables||D.hasOtherReceivables?Rt(v.tradeRec,T.notes.items.find(V=>V.id==="receivables")?.no||"",C((X.tr||0)+(X.or||0)),C((X.py_tr||0)+(X.py_or||0)),{indent:1}):""}
            ${D.hasCash?Rt(v.cashBank,T.notes.items.find(V=>V.id==="cash")?.no||"",C(X.cash),C(X.py_cash||0),{indent:1}):""}
            ${Rt("","",C(X.totCA),C(X.py_totCA||0),{bold:!0,line:ea.TOP})}
            ${Rt(v.totalAssets,"",C(X.totA),C(X.py_totA||0),{bold:!0,line:ea.DOUBLE_TOP})}
            <tr><td colspan="4" style="height:15px;"></td></tr>
            ${Rt(v.equityLiab,"","","",{bold:!0})}
            ${Rt(v.equity,"","","",{bold:!0})}
            ${!G&&D.hasShareCapital?Rt(v.shareCap,T.notes.items.find(V=>V.id==="sharecapital")?.no||"",C(X.cap),C(X.py_cap||0),{indent:1}):""}
            ${G?Rt(v.ownerCapital,T.notes.items.find(V=>V.id==="ownercapital")?.no||"",C(X.cap),C(X.py_cap||0),{indent:1}):""}
            ${Rt(v.retained,"",C(X.ret),C(X.py_ret||0),{indent:1})}
            ${Rt("","",C(X.totE),C(X.py_totE||0),{bold:!0,line:ea.TOP})}
            ${Rt(v.liabilities,"","","",{bold:!0})}
            ${D.hasLTBorrowings||D.hasDeferredTax?Rt(v.ncl,"","","",{bold:!0}):""}
            ${D.hasLTBorrowings?Rt(v.ltBorrowings,"",C(X.ltBorr),C(X.py_ltBorr||0),{indent:1}):""}
            ${Rt(v.cl,"","","",{bold:!0})}
            ${D.hasTradePayables||D.hasOtherPayables?Rt(v.tradePay,T.notes.items.find(V=>V.id==="payables")?.no||"",C((X.tp||0)+(X.op||0)),C((X.py_tp||0)+(X.py_op||0)),{indent:1}):""}
            ${D.hasSTBorrowings?Rt(v.stBorrowings,T.notes.items.find(V=>V.id==="borrowings")?.no||"",C(X.borr),C(X.py_borr||0),{indent:1}):""}
            ${D.hasTaxPayable?Rt(v.taxPayable,"",C(X.taxPay),C(X.py_taxPay||0),{indent:1}):""}
            ${Rt("","",C(X.totL),C(X.py_totL||0),{bold:!0,line:ea.TOP})}
            ${Rt(v.totalEL,"",C(X.totE+X.totL),C((X.py_totE||0)+(X.py_totL||0)),{bold:!0,line:ea.DOUBLE_TOP})}
          </tbody>
        </table>
        <p class="integral-note">${v.notesIntegral}</p>
      </div>`}if(T.sopl.include){const X=T.sopl.data;ye+=`<div class="page">
        <div class="company-header">${y.companyName.toUpperCase()} (${y.companyRegNo})</div>
        <div class="header"><h2>${T.sopl.title}</h2><p>${v.forYear} ${y.fyeDisplay.toUpperCase()}</p></div>
        <table class="fs">
          <thead><tr><th style="width:55%"></th><th class="center" style="width:10%">${v.note}</th><th class="right" style="width:17%">${y.currentYear}<br>${v.rm}</th><th class="right" style="width:18%">${y.priorYear}<br>${v.rm}</th></tr></thead>
          <tbody>
            ${Rt(v.revenue,T.notes.items.find(V=>V.id==="revenue")?.no||"",C(X.rev),C(X.py_rev||0))}
            ${Rt(v.costOfSales,T.notes.items.find(V=>V.id==="costOfSales")?.no||"","("+C(X.cos)+")","("+C(X.py_cos||0)+")")}
            ${Rt(v.grossProfit,"",C(X.gp),C(X.py_gp||0),{bold:!0,line:ea.TOP})}
            ${D.hasOtherIncome?Rt(v.otherIncome,"",C(X.oi),C(X.py_oi||0)):""}
            ${Rt(v.adminExp,T.notes.items.find(V=>V.id==="expenses")?.no||"","("+C(X.adm)+")","("+C(X.py_adm||0)+")")}
            ${D.hasOtherExpenses?Rt(v.otherExp,"","("+C(X.oe)+")","("+C(X.py_oe||0)+")"):""}
            ${D.hasFinanceCosts?Rt(v.finCosts,T.notes.items.find(V=>V.id==="fincosts")?.no||"","("+C(X.fin)+")","("+C(X.py_fin||0)+")"):""}
            ${Rt(v.pbt,"",C(X.pbt),C(X.py_pbt||0),{bold:!0,line:ea.TOP})}
            ${Rt(v.tax,T.notes.items.find(V=>V.id==="tax")?.no||"",X.tax>0?"("+C(X.tax)+")":"-",(X.py_tax||0)>0?"("+C(X.py_tax)+")":"-")}
            ${Rt(X.np>=0?v.profitYear:v.lossYear,"",C(X.np),C(X.py_np||0),{bold:!0,line:ea.DOUBLE_TOP})}
            ${T.sopl.showOCI?`
            <tr><td colspan="4" style="height:10px;"></td></tr>
            ${Rt(v.oci,"","-","-")}
            ${Rt(v.totalCI,"",C(X.np),C(X.py_np||0),{bold:!0,line:ea.DOUBLE_TOP})}
            `:""}
          </tbody>
        </table>
        <p class="integral-note">${v.notesIntegral}</p>
      </div>`}if(T.soce.include){const X=T.soce.data;ye+=`<div class="page">
        <div class="company-header">${y.companyName.toUpperCase()} (${y.companyRegNo})</div>
        <div class="header"><h2>${v.soce}</h2><p>${v.forYear} ${y.fyeDisplay.toUpperCase()}</p></div>
        <table class="fs" style="margin-top:30px;">
          <thead><tr><th style="width:40%"></th><th class="right" style="width:20%">${v.shareCap}<br>${v.rm}</th><th class="right" style="width:20%">${v.retained}<br>${v.rm}</th><th class="right" style="width:20%">${v.total}<br>${v.rm}</th></tr></thead>
          <tbody>
            ${Cs(v.balanceAt+" 1.1."+y.priorYear,C(X.shareCap),C(X.openingRE-(X.py_profit||0)),C(X.shareCap+X.openingRE-(X.py_profit||0)))}
            ${Cs(v.profitForYear,"-",C(X.py_profit||0),C(X.py_profit||0))}
            ${Cs(v.balanceAt+" 31.12."+y.priorYear,C(X.shareCap),C(X.openingRE),C(X.shareCap+X.openingRE),{line:ea.TOP})}
            ${Cs(v.profitForYear,"-",C(X.profit),C(X.profit))}
            ${Cs(v.balanceAt+" 31.12."+y.currentYear,C(X.shareCap),C(X.closingRE),C(X.shareCap+X.closingRE),{bold:!0,line:ea.DOUBLE_TOP})}
          </tbody>
        </table>
        <p class="integral-note">${v.notesIntegral}</p>
      </div>`}if(T.socf.include&&T.socf.data){const X=T.socf.data;ye+=`<div class="page">
        <div class="company-header">${y.companyName.toUpperCase()} (${y.companyRegNo})</div>
        <div class="header"><h2>${v.socf}</h2><p>${v.forYear} ${y.fyeDisplay.toUpperCase()}</p></div>
        <table class="fs">
          <thead><tr><th style="width:70%"></th><th class="right" style="width:15%">${y.currentYear}<br>${v.rm}</th><th class="right" style="width:15%">${y.priorYear}<br>${v.rm}</th></tr></thead>
          <tbody>
            ${Na(v.cfOperating,"","",{bold:!0})}
            ${Na(v.pbt,C(X.pbt||m.is.pbt),C(X.py_pbt||0),{indent:1})}
            ${Na(xe==="BM"?"Pelarasan untuk:":"Adjustments for:","","",{indent:1})}
            ${Na(v.ppe.split(",")[0]+(xe==="BM"?" - susut nilai":" - depreciation"),C(X.depreciation||m.is.dep),C(X.py_dep||0),{indent:2})}
            ${D.hasFinanceCosts?Na(v.finCosts,C(X.interest||m.is.fin),C(X.py_fin||0),{indent:2}):""}
            ${Na(xe==="BM"?"Tunai operasi sebelum perubahan modal kerja":"Operating cash before working capital changes",C(X.opCashBefore||m.is.pbt+(m.is.dep||0)+(m.is.fin||0)),"-",{indent:1,line:ea.TOP})}
            ${Na(xe==="BM"?"Perubahan dalam inventori":"Change in inventories",O(X.invChange||0),"-",{indent:1})}
            ${Na(xe==="BM"?"Perubahan dalam penghutang":"Change in receivables",O(X.recChange||0),"-",{indent:1})}
            ${Na(xe==="BM"?"Perubahan dalam pemiutang":"Change in payables",O(X.payChange||0),"-",{indent:1})}
            ${Na(xe==="BM"?"Cukai dibayar":"Tax paid",O(X.taxPaid||0),"-",{indent:1})}
            ${Na(v.netCashOps,C(X.operating||0),C(X.py_operating||0),{bold:!0,line:ea.TOP})}
            <tr><td colspan="3" style="height:10px;"></td></tr>
            ${Na(v.cfInvesting,"","",{bold:!0})}
            ${Na(xe==="BM"?"Pembelian hartanah, loji dan peralatan":"Purchase of property, plant and equipment",O(X.ppeAcq||0),"-",{indent:1})}
            ${Na(v.netCashInv,O(X.investing||0),C(X.py_investing||0),{bold:!0,line:ea.TOP})}
            <tr><td colspan="3" style="height:10px;"></td></tr>
            ${Na(v.cfFinancing,"","",{bold:!0})}
            ${D.hasBorrowings?Na(xe==="BM"?"Bayaran balik pinjaman":"Repayment of borrowings",O(X.loanRepay||0),"-",{indent:1}):""}
            ${D.hasFinanceCosts?Na(xe==="BM"?"Faedah dibayar":"Interest paid",O(X.interestPaid||m.is.fin),"-",{indent:1}):""}
            ${Na(v.netCashFin,O(X.financing||0),C(X.py_financing||0),{bold:!0,line:ea.TOP})}
            <tr><td colspan="3" style="height:10px;"></td></tr>
            ${Na(v.netIncrease,C((X.operating||0)+(X.investing||0)+(X.financing||0)),"-",{bold:!0,line:ea.TOP})}
            ${Na(v.cashBF,C(X.cashBF||m.bs.py_cash||0),"-")}
            ${Na(v.cashCF,C(X.cashCF||m.bs.cash),C(X.py_cashCF||0),{bold:!0,line:ea.DOUBLE_TOP})}
          </tbody>
        </table>
        <p class="integral-note">${v.notesIntegral}</p>
      </div>`}if(T.notes.include){const X=T.notes.items;let V="",Me=0;for(;Me<X.length;){V+=`<div class="page">
          <div class="company-header">${y.companyName.toUpperCase()} (${y.companyRegNo})</div>
          <div class="header"><h2>${v.notes}${Me>0?" ("+v.continued+")":""}</h2></div>`;const Be=Math.min(3,X.length-Me);for(let pe=0;pe<Be&&Me<X.length;pe++,Me++){const We=X[Me];if(V+=`<div class="section-title">${We.no}. ${We.title}</div>`,We.content.type==="text")V+=`<p class="note-text">${We.content.text}</p>`;else if(We.content.type==="simple")V+='<table class="fs"><tbody>',We.content.rows.forEach(Ve=>{V+=F0(Ve.label,C(Ve.amount))}),We.content.showTotal&&(V+=F0(v.total,C(We.content.total),{bold:!0,line:ea.TOP})),V+="</tbody></table>";else if(We.content.type==="ppe"){const Ve=We.content;Ve.register&&Ve.register.length>0?(V+=`<table class="note-table"><thead><tr>
                <th style="width:35%">${xe==="BM"?"Keterangan":"Description"}</th>
                <th class="right" style="width:20%">${xe==="BM"?"Kos":"Cost"}<br>${v.rm}</th>
                <th class="right" style="width:20%">${xe==="BM"?"Susut Nilai Terkumpul":"Accum. Dep."}<br>${v.rm}</th>
                <th class="right" style="width:15%">NBV<br>${v.rm}</th>
              </tr></thead><tbody>`,Ve.register.forEach(it=>{const Vt=xt[it.category]||xt.OFFICE_EQUIPMENT,lt=parseFloat(it.cost)||0,Fa=parseFloat(it.accDepBF)||0,Ka=Math.min(lt*(Vt.rate/100),lt-Fa),Wr=Fa+Ka,st=lt-Wr;V+=`<tr><td>${it.description||"-"}</td><td class="right">${C(lt)}</td><td class="right">${C(Wr)}</td><td class="right">${C(st)}</td></tr>`}),V+=`<tr style="font-weight:bold;border-top:2px solid #000"><td>${v.total}</td><td class="right">${C(Ve.cost)}</td><td class="right">${C(Ve.accDep)}</td><td class="right">${C(Ve.nbv)}</td></tr>`,V+="</tbody></table>"):V+=`<table class="fs"><tbody>
                <tr><td style="width:60%">${v.atCost}</td><td class="right">${C(Ve.cost+Ve.accDep)}</td></tr>
                <tr><td>${v.lessAccDep}</td><td class="right">(${C(Ve.accDep)})</td></tr>
                <tr style="border-top:1px solid #000"><td class="bold">${v.nbv}</td><td class="right bold">${C(Ve.nbv)}</td></tr>
              </tbody></table>`,V+=`<p class="note-text">${v.depCharge}: ${v.rm} ${C(Ve.currentDep)}</p>`}else We.content.type==="sharecapital"?V+=`<table class="fs"><tbody>
              <tr><td style="width:60%">${v.issuedPaid}</td><td></td></tr>
              <tr><td class="indent">${v.ordinaryShares}</td><td class="right">${C(We.content.amount)}</td></tr>
            </tbody></table>`:We.content.type==="policies"?V+=`<p class="note-text"><strong>2.1 ${v.revenueRecog}</strong></p>
              <p class="note-text">${xe==="BM"?"Hasil diukur pada nilai saksama balasan yang diterima atau akan diterima. Hasil daripada jualan barangan diiktiraf apabila risiko dan ganjaran pemilikan yang ketara telah dipindahkan kepada pembeli.":"Revenue is measured at the fair value of consideration received or receivable. Revenue from sale of goods is recognised when significant risks and rewards of ownership have been transferred to the buyer."}</p>
              <p class="note-text"><strong>2.2 ${v.ppePolicy}</strong></p>
              <p class="note-text">${xe==="BM"?"Hartanah, loji dan peralatan dinyatakan pada kos tolak susut nilai terkumpul. Susut nilai dicaj ke penyata untung rugi secara garis lurus ke atas anggaran hayat berguna aset.":"Property, plant and equipment are stated at cost less accumulated depreciation. Depreciation is charged to profit or loss on a straight-line basis over the estimated useful lives of the assets."}</p>
              <p class="note-text"><strong>2.3 ${v.financialInstr}</strong></p>
              <p class="note-text">${xe==="BM"?"Aset dan liabiliti kewangan diiktiraf apabila Syarikat menjadi pihak kepada peruntukan kontrak instrumen tersebut.":"Financial assets and liabilities are recognised when the Company becomes a party to the contractual provisions of the instrument."}</p>`:We.content.type==="relatedparty"&&(V+=`<p class="note-text"><strong>(a) ${xe==="BM"?"Identiti pihak berkaitan":"Identities of related parties"}</strong></p>
              <p class="note-text">${xe==="BM"?"Syarikat mempunyai hubungan pihak berkaitan dengan pengarah dan kakitangan pengurusan utama.":"The Company has related party relationships with its directors and key management personnel."}</p>
              <p class="note-text"><strong>(b) ${xe==="BM"?"Pampasan kakitangan pengurusan utama":"Key management personnel compensation"}</strong></p>
              <table class="fs"><tbody>
                <tr><td style="width:60%">${xe==="BM"?"Imbuhan pengarah":"Directors' remuneration"}</td><td class="right">${C(We.content.directorFees)}</td></tr>
              </tbody></table>`)}V+="</div>"}ye+=V}return ye+="</body></html>",ye},tn=async(u,y)=>{if(!u){alert("Please generate financial statements first.");return}if(typeof jspdf>"u"&&typeof jsPDF>"u"){const v=to(u);N0(v,y.replace(".pdf",""));return}try{const{jsPDF:v}=window.jspdf||window,S=new v({orientation:"portrait",unit:"mm",format:"a4"}),{meta:T,labels:W,helpers:D,sections:C,applicability:O}=u,{fmtNum:G,fmtBracket:xe}=D,Re=210,ye=297,X=20,V=Re-X*2;let Me=X;const Be=pe=>{S.setFontSize(9),S.setTextColor(128),S.text(`${W.page} ${pe}`,Re-X,ye-10,{align:"right"}),S.setTextColor(0)};S.setFontSize(22),S.setFont("times","bold"),S.text(T.companyName.toUpperCase(),Re/2,80,{align:"center"}),S.setFontSize(11),S.setFont("times","normal"),S.text(`(${W.regNo}: ${T.companyRegNo})`,Re/2,90,{align:"center"}),S.setFontSize(10),S.text(`(${W.incMalaysia})`,Re/2,97,{align:"center"}),S.setFontSize(18),S.setFont("times","bold"),S.text(W.title,Re/2,130,{align:"center"}),S.setFontSize(12),S.setFont("times","normal"),S.text(W.forYear,Re/2,145,{align:"center"}),S.setFontSize(14),S.setFont("times","bold"),S.text(T.fyeDisplay.toUpperCase(),Re/2,155,{align:"center"}),S.setFontSize(10),S.setFont("times","italic"),S.text(T.accountingStandard,Re/2,200,{align:"center"}),Be(1),S.addPage(),Me=X,S.setFontSize(14),S.setFont("times","bold"),S.text(T.companyName.toUpperCase(),Re/2,Me,{align:"center"}),Me+=15,S.setFontSize(12),S.text(W.contents,Re/2,Me,{align:"center"}),Me+=20,S.setFontSize(11),S.setFont("times","normal"),u.toc.forEach(pe=>{S.text(pe.title,X+30,Me),S.text(String(pe.page),Re-X-30,Me,{align:"right"}),Me+=8}),Be(2),S.autoTable,S.save(y)}catch(v){console.error("PDF export error:",v);const S=to(u);N0(S,y.replace(".pdf",""))}},ao=(u,y)=>{if(console.log("exportFullFSDocx called:",y),!u){alert("Please generate financial statements first.");return}try{const S=`<!DOCTYPE html>
<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">
<head>
<meta charset="UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--[if gte mso 9]>
<xml>
<w:WordDocument>
<w:View>Print</w:View>
<w:Zoom>100</w:Zoom>
<w:DoNotOptimizeForBrowser/>
</w:WordDocument>
</xml>
<![endif]-->
<style>
@page { size: A4; margin: 2cm; }
body { font-family: "Times New Roman", Times, serif; font-size: 11pt; line-height: 1.5; }
.page { page-break-after: always; }
.page:last-child { page-break-after: avoid; }
table { width: 100%; border-collapse: collapse; page-break-inside: avoid; }
.right { text-align: right; }
.center { text-align: center; }
.bold { font-weight: bold; }
</style>
</head>
<body>
${to(u).replace(/<html[^>]*>/,"").replace(/<\/html>/,"").replace(/<head>[\s\S]*<\/head>/,"").replace(/<body>/,"").replace(/<\/body>/,"")}
</body>
</html>`,T=new Blob([S],{type:"application/msword;charset=utf-8"});gr(T,y),console.log("Word document downloaded:",y)}catch(v){console.error("exportFullFSDocx error:",v),alert("Error exporting Word document: "+v.message)}},j0=(u,y="EN")=>{if(console.log("downloadFullFS called:",u,y),!m){alert("Please generate financial statements first.");return}try{const v=jf({entityType:t,lang:y,company:{name:s,regNo:f},fsRes:m});if(!v){alert("Error building FS model.");return}const S=(s||"Company").replace(/[^a-zA-Z0-9]/g,"_"),T=y==="BM"?"_BM":"_EN";if(u==="html"){const W=to(v),D=new Blob([W],{type:"text/html;charset=utf-8"});gr(D,`${S}_FS_${L}${T}.html`),ke(C=>[...C,{t:"ok",m:` Full FS HTML downloaded (${y})`}])}}catch(v){console.error("downloadFullFS error:",v),alert("Error exporting: "+v.message)}},Ui=({lang:u="EN"})=>{if(!m)return null;const y=u!=="BM",v=ye=>ye==null?"-":Number(ye).toLocaleString("en-MY",{minimumFractionDigits:0,maximumFractionDigits:0}),S=ye=>ye==null||isNaN(ye)?"-":ye.toFixed(1)+"%",T=ye=>ye==null?"-":ye>=1e6?(ye/1e6).toFixed(1)+"M":ye>=1e3?(ye/1e3).toFixed(0)+"K":v(ye),D=Object.entries({SALARY:y?"Salaries":"Gaji",RENT:y?"Rent":"Sewa",UTILITIES:y?"Utilities":"Utiliti",DEPRECIATION:y?"Depreciation":"Susut Nilai",PROFESSIONAL_FEES:y?"Prof. Fees":"Yuran Prof.",MARKETING:y?"Marketing":"Pemasaran",TRANSPORT:y?"Transport":"Pengangkutan",INSURANCE:y?"Insurance":"Insurans",BANK_CHARGES:y?"Bank Charges":"Caj Bank",MISCELLANEOUS:y?"Others":"Lain-lain"}).filter(([ye])=>m.is.details?.[ye]>0).map(([ye,X])=>({label:X,amount:m.is.details[ye],pct:m.is.adm>0?m.is.details[ye]/m.is.adm*100:0})).sort((ye,X)=>X.amount-ye.amount).slice(0,8),C=ye=>{const X={current:0,d30:0,d60:0,d90:0,over90:0,total:0},V=new Date;return ye.forEach(Me=>{const Be=parseFloat(Me.amount)||0,pe=Math.max(0,Math.floor((V-new Date(Me.dueDate))/864e5));pe<=0?X.current+=Be:pe<=30?X.d30+=Be:pe<=60?X.d60+=Be:pe<=90?X.d90+=Be:X.over90+=Be,X.total+=Be}),X},O={gpMargin:m.is.rev>0?m.is.gp/m.is.rev*100:0,npMargin:m.is.rev>0?m.is.np/m.is.rev*100:0,currentRatio:m.bs.totCL>0?m.bs.totCA/m.bs.totCL:0,quickRatio:m.bs.totCL>0?(m.bs.totCA-(m.bs.inv||0))/m.bs.totCL:0,debtToEquity:m.bs.totE>0?m.bs.totL/m.bs.totE:0,roe:m.bs.totE>0?m.is.np/m.bs.totE*100:0,roa:m.bs.totA>0?m.is.np/m.bs.totA*100:0,workingCapital:m.bs.totCA-m.bs.totCL},G=ft.map(ye=>{const X=parseFloat(ye.cost)||0,V=parseFloat(ye.accDepBF)||0,Me=xt[ye.category]||xt.OFFICE_EQUIPMENT,Be=Math.min(X*(Me.rate/100),X-V);return{desc:ye.description,cost:X,nbv:X-V-Be}}),xe=[...Aa].sort((ye,X)=>(parseFloat(X.amount)||0)-(parseFloat(ye.amount)||0)).slice(0,5),Re=[...sa].sort((ye,X)=>(parseFloat(X.amount)||0)-(parseFloat(ye.amount)||0)).slice(0,5);return{meta:{companyName:s||"Company",companyRegNo:f||"",year:L,lang:u,generated:new Date().toLocaleString()},is:m.is,bs:m.bs,ratios:O,expenses:D,arAgeing:C(Aa),apAgeing:C(sa),ppeItems:G,topDebtors:xe,topCreditors:Re,helpers:{fmtNum:v,fmtPct:S,fmtK:T}}},vl=u=>{if(!u)return"";const{meta:y,is:v,bs:S,ratios:T,expenses:W,arAgeing:D,apAgeing:C,ppeItems:O,topDebtors:G,topCreditors:xe,helpers:{fmtNum:Re,fmtPct:ye,fmtK:X}}=u,V=y.lang!=="BM",Me=(it,Vt)=>`<div style="height:14px;background:#e5e7eb;border-radius:3px;overflow:hidden"><div style="height:100%;width:${Math.min(it,100)}%;background:${Vt};border-radius:3px"></div></div>`,Be="@page{size:A4;margin:8mm}@media print{.page{page-break-after:always}.page:last-child{page-break-after:avoid}}*{box-sizing:border-box;margin:0;padding:0}body{font-family:'Segoe UI',Arial,sans-serif;font-size:9pt;color:#1f2937;max-width:210mm;margin:0 auto;background:#fff}.page{padding:12px;min-height:285mm;position:relative}.hdr{background:linear-gradient(135deg,#1e3a8a,#3b82f6);color:#fff;padding:12px 16px;border-radius:6px;margin-bottom:10px;display:flex;justify-content:space-between;align-items:center}.hdr h1{font-size:14pt;margin:0}.hdr .sub{font-size:8pt;opacity:.9}.hdr .meta{text-align:right;font-size:7pt;opacity:.8}.sec{margin-bottom:8px}.sec-title{font-size:10pt;font-weight:700;color:#1e3a8a;border-bottom:2px solid #3b82f6;padding-bottom:3px;margin-bottom:6px}.g2{display:grid;grid-template-columns:1fr 1fr;gap:8px}.g3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:6px}.g4{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:6px}.card{background:#f8fafc;border:1px solid #e2e8f0;border-radius:5px;padding:8px}.card.blue{background:linear-gradient(135deg,#eff6ff,#dbeafe);border-color:#93c5fd}.card.green{background:linear-gradient(135deg,#f0fdf4,#dcfce7);border-color:#86efac}.card.red{background:linear-gradient(135deg,#fef2f2,#fee2e2);border-color:#fca5a5}.card.purple{background:linear-gradient(135deg,#faf5ff,#f3e8ff);border-color:#c4b5fd}.card.amber{background:linear-gradient(135deg,#fffbeb,#fef3c7);border-color:#fcd34d}.kpi{text-align:center}.kv{font-size:15pt;font-weight:700;color:#1e3a8a}.kv.grn{color:#059669}.kv.rd{color:#dc2626}.kl{font-size:7pt;color:#64748b;text-transform:uppercase;margin-top:1px}.ks{font-size:7pt;color:#6b7280}table{width:100%;border-collapse:collapse;font-size:8pt}th,td{padding:3px 5px;text-align:left;border-bottom:1px solid #e5e7eb}th{background:#f1f5f9;font-weight:600;color:#475569;font-size:7pt}.r{text-align:right}.b{font-weight:700}.tr{background:#f1f5f9;font-weight:700;border-top:2px solid #3b82f6}.ftr{position:absolute;bottom:6px;left:12px;right:12px;text-align:center;font-size:7pt;color:#9ca3af;border-top:1px solid #e5e7eb;padding-top:3px}.ct{font-weight:600;color:#1e3a8a;margin-bottom:5px;font-size:8pt}",pe=`<div class="hdr"><div><h1>${y.companyName}</h1><div class="sub">${V?"Management Report":"Laporan Pengurusan"}  FY ${y.year}</div></div><div class="meta">${y.companyRegNo?y.companyRegNo+"<br>":""}${V?"Generated":"Dijana"}: ${y.generated}<br>FS Automation ${yl}</div></div>`;let We=`<!DOCTYPE html><html><head><meta charset="UTF-8"><title>${y.companyName} - Management Report</title><style>${Be}</style></head><body>`;We+=`<div class="page">${pe}
      <div class="sec"><div class="sec-title"> ${V?"Key Performance Indicators":"Petunjuk Prestasi Utama"}</div>
        <div class="g4">
          <div class="card blue kpi"><div class="kv">RM ${X(v.rev)}</div><div class="kl">${V?"Revenue":"Hasil"}</div></div>
          <div class="card ${v.gp>=0?"green":"red"} kpi"><div class="kv ${v.gp>=0?"grn":"rd"}">RM ${X(v.gp)}</div><div class="kl">${V?"Gross Profit":"Untung Kasar"}</div><div class="ks">${ye(T.gpMargin)}</div></div>
          <div class="card ${v.np>=0?"green":"red"} kpi"><div class="kv ${v.np>=0?"grn":"rd"}">RM ${X(v.np)}</div><div class="kl">${V?"Net Profit":"Untung Bersih"}</div><div class="ks">${ye(T.npMargin)}</div></div>
          <div class="card blue kpi"><div class="kv">RM ${X(S.cash)}</div><div class="kl">${V?"Cash":"Tunai"}</div></div>
        </div>
      </div>
      <div class="sec"><div class="g2">
        <div class="card"><div class="ct"> ${V?"Profit & Loss Summary":"Ringkasan Untung Rugi"}</div>
          <table><tr><td>${V?"Revenue":"Hasil"}</td><td class="r b">${Re(v.rev)}</td><td class="r">100%</td></tr>
          <tr><td>${V?"Cost of Sales":"Kos Jualan"}</td><td class="r">(${Re(v.cos)})</td><td class="r" style="color:#dc2626">${ye(v.rev>0?v.cos/v.rev*100:0)}</td></tr>
          <tr class="tr"><td>${V?"Gross Profit":"Untung Kasar"}</td><td class="r">${Re(v.gp)}</td><td class="r" style="color:#059669">${ye(T.gpMargin)}</td></tr>
          ${v.oi>0?`<tr><td>${V?"Other Income":"Pendapatan Lain"}</td><td class="r">${Re(v.oi)}</td><td class="r">${ye(v.rev>0?v.oi/v.rev*100:0)}</td></tr>`:""}
          <tr><td>${V?"Operating Expenses":"Perbelanjaan"}</td><td class="r">(${Re(v.adm)})</td><td class="r">${ye(v.rev>0?v.adm/v.rev*100:0)}</td></tr>
          ${v.fin>0?`<tr><td>${V?"Finance Costs":"Kos Kewangan"}</td><td class="r">(${Re(v.fin)})</td><td class="r">${ye(v.rev>0?v.fin/v.rev*100:0)}</td></tr>`:""}
          <tr class="tr"><td>${V?"Profit Before Tax":"Untung Sebelum Cukai"}</td><td class="r">${Re(v.pbt)}</td><td></td></tr>
          <tr><td>${V?"Taxation":"Cukai"}</td><td class="r">${v.tax>0?"("+Re(v.tax)+")":"-"}</td><td></td></tr>
          <tr class="tr" style="background:#dcfce7"><td class="b">${V?"Net Profit":"Untung Bersih"}</td><td class="r b" style="color:${v.np>=0?"#059669":"#dc2626"}">${Re(v.np)}</td><td class="r b">${ye(T.npMargin)}</td></tr></table>
        </div>
        <div class="card"><div class="ct"> ${V?"Financial Ratios":"Nisbah Kewangan"}</div>
          <table><tr><td>${V?"Current Ratio":"Nisbah Semasa"}</td><td class="r b" style="color:${T.currentRatio>=1?"#059669":"#dc2626"}">${T.currentRatio.toFixed(2)}</td><td style="width:80px">${Me(T.currentRatio/2*100,T.currentRatio>=1?"#10b981":"#ef4444")}</td></tr>
          <tr><td>${V?"Quick Ratio":"Nisbah Cepat"}</td><td class="r b" style="color:${T.quickRatio>=1?"#059669":"#dc2626"}">${T.quickRatio.toFixed(2)}</td><td>${Me(T.quickRatio/2*100,T.quickRatio>=1?"#10b981":"#ef4444")}</td></tr>
          <tr><td>${V?"Debt to Equity":"Hutang/Ekuiti"}</td><td class="r b" style="color:${T.debtToEquity<=1?"#059669":"#f59e0b"}">${T.debtToEquity.toFixed(2)}</td><td>${Me(T.debtToEquity/2*100,T.debtToEquity<=1?"#10b981":"#f59e0b")}</td></tr>
          <tr><td>${V?"Return on Equity":"Pulangan Ekuiti"}</td><td class="r b">${ye(T.roe)}</td><td>${Me(Math.abs(T.roe)/30*100,T.roe>=0?"#3b82f6":"#ef4444")}</td></tr>
          <tr><td>${V?"Return on Assets":"Pulangan Aset"}</td><td class="r b">${ye(T.roa)}</td><td>${Me(Math.abs(T.roa)/20*100,T.roa>=0?"#3b82f6":"#ef4444")}</td></tr>
          <tr class="tr"><td>${V?"Working Capital":"Modal Kerja"}</td><td class="r b" style="color:${T.workingCapital>=0?"#059669":"#dc2626"}">RM ${Re(T.workingCapital)}</td><td></td></tr></table>
        </div>
      </div></div>
      <div class="sec"><div class="g2">
        <div class="card"><div class="ct"> ${V?"Balance Sheet":"Kedudukan Kewangan"}</div>
          <table><tr><th colspan="2">${V?"ASSETS":"ASET"}</th></tr>
          ${S.ppe>0?`<tr><td style="padding-left:8px">PPE</td><td class="r">${Re(S.ppe)}</td></tr>`:""}
          ${S.inv>0?`<tr><td style="padding-left:8px">${V?"Inventory":"Inventori"}</td><td class="r">${Re(S.inv)}</td></tr>`:""}
          <tr><td style="padding-left:8px">${V?"Receivables":"Penghutang"}</td><td class="r">${Re((S.tr||0)+(S.or||0))}</td></tr>
          <tr><td style="padding-left:8px">${V?"Cash":"Tunai"}</td><td class="r">${Re(S.cash)}</td></tr>
          <tr class="tr"><td>${V?"Total Assets":"Jumlah Aset"}</td><td class="r">${Re(S.totA)}</td></tr>
          <tr><th colspan="2">${V?"LIABILITIES":"LIABILITI"}</th></tr>
          <tr class="tr"><td>${V?"Total Liabilities":"Jumlah Liabiliti"}</td><td class="r">${Re(S.totL)}</td></tr>
          <tr><th colspan="2">${V?"EQUITY":"EKUITI"}</th></tr>
          <tr class="tr"><td>${V?"Total Equity":"Jumlah Ekuiti"}</td><td class="r">${Re(S.totE)}</td></tr></table>
        </div>
        <div class="card"><div class="ct"> ${V?"Expense Breakdown":"Pecahan Perbelanjaan"}</div>
          ${W.length>0?`<table>${W.map(it=>`<tr><td>${it.label}</td><td class="r">${Re(it.amount)}</td><td style="width:80px">${Me(it.pct,"#f59e0b")}</td><td class="r" style="width:35px">${ye(it.pct)}</td></tr>`).join("")}<tr class="tr"><td>${V?"Total":"Jumlah"}</td><td class="r">${Re(v.adm)}</td><td colspan="2"></td></tr></table>`:`<div style="color:#9ca3af;text-align:center;padding:15px">${V?"No expense details":"Tiada butiran"}</div>`}
        </div>
      </div></div>
      <div class="ftr">${V?"Page":"Muka Surat"} 1  ${y.companyName}</div>
    </div>`;const Ve=[];return T.gpMargin>=30?Ve.push({type:"good",text:V?"Strong gross margin above 30% indicates healthy pricing and cost control":"Margin kasar kukuh melebihi 30% menunjukkan penetapan harga dan kawalan kos yang sihat"}):T.gpMargin<20&&Ve.push({type:"warn",text:V?"Gross margin below 20% may indicate pricing pressure or high direct costs":"Margin kasar di bawah 20% mungkin menunjukkan tekanan harga atau kos langsung yang tinggi"}),T.currentRatio>=1.5?Ve.push({type:"good",text:V?"Current ratio above 1.5 shows healthy short-term liquidity":"Nisbah semasa melebihi 1.5 menunjukkan kecairan jangka pendek yang sihat"}):T.currentRatio<1&&Ve.push({type:"warn",text:V?"Current ratio below 1 indicates potential liquidity risk":"Nisbah semasa di bawah 1 menunjukkan risiko kecairan"}),D.over90>D.total*.2&&Ve.push({type:"warn",text:V?`${ye(D.over90/D.total*100)} of receivables overdue >90 days - review collection efforts`:`${ye(D.over90/D.total*100)} penghutang tertunggak >90 hari - semak usaha kutipan`}),T.debtToEquity>2?Ve.push({type:"warn",text:V?"High leverage with debt-to-equity above 2x":"Leveraj tinggi dengan hutang/ekuiti melebihi 2x"}):T.debtToEquity<=.5&&Ve.push({type:"good",text:V?"Conservative capital structure with low debt":"Struktur modal konservatif dengan hutang rendah"}),v.np>0&&T.roe>=15&&Ve.push({type:"good",text:V?`Strong ROE of ${ye(T.roe)} indicates efficient use of equity`:`ROE kukuh ${ye(T.roe)} menunjukkan penggunaan ekuiti yang cekap`}),T.workingCapital<0&&Ve.push({type:"warn",text:V?"Negative working capital - may need to improve cash cycle":"Modal kerja negatif - mungkin perlu memperbaiki kitaran tunai"}),Ve.length>0&&(We=We.replace(`</div>
      <div class="ftr">`+(V?"Page":"Muka Surat")+" 1",`
      <div class="sec"><div class="card amber"><div class="ct"> ${V?"Management Insights & Recommendations":"Pandangan & Cadangan Pengurusan"}</div>
        <ul style="margin:0;padding-left:15px;font-size:8pt">
          ${Ve.map(it=>`<li style="color:${it.type==="good"?"#059669":"#dc2626"};margin:3px 0">${it.type==="good"?"":""} ${it.text}</li>`).join("")}
        </ul>
      </div></div>
      </div>
      <div class="ftr">${V?"Page":"Muka Surat"} 1`)),We+=`<div class="page">${pe}
      <div class="sec"><div class="sec-title"> ${V?"Receivables & Payables Analysis":"Analisis Penghutang & Pemiutang"}</div>
        <div class="g2">
          <div class="card ${D.over90>D.total*.2?"red":""}"><div class="ct"> ${V?"Accounts Receivable Ageing":"Pengumuran Penghutang"}</div>
            <table><tr><th>${V?"Ageing":"Umur"}</th><th class="r">${V?"Amount":"Jumlah"}</th><th class="r">%</th><th style="width:70px"></th></tr>
            <tr><td>${V?"Current":"Semasa"}</td><td class="r">${Re(D.current)}</td><td class="r">${D.total>0?ye(D.current/D.total*100):"-"}</td><td>${Me(D.total>0?D.current/D.total*100:0,"#10b981")}</td></tr>
            <tr><td>1-30 ${V?"days":"hari"}</td><td class="r">${Re(D.d30)}</td><td class="r">${D.total>0?ye(D.d30/D.total*100):"-"}</td><td>${Me(D.total>0?D.d30/D.total*100:0,"#3b82f6")}</td></tr>
            <tr><td>31-60 ${V?"days":"hari"}</td><td class="r">${Re(D.d60)}</td><td class="r">${D.total>0?ye(D.d60/D.total*100):"-"}</td><td>${Me(D.total>0?D.d60/D.total*100:0,"#f59e0b")}</td></tr>
            <tr><td>61-90 ${V?"days":"hari"}</td><td class="r">${Re(D.d90)}</td><td class="r">${D.total>0?ye(D.d90/D.total*100):"-"}</td><td>${Me(D.total>0?D.d90/D.total*100:0,"#f97316")}</td></tr>
            <tr style="background:#fef2f2"><td class="b">> 90 ${V?"days":"hari"}</td><td class="r b" style="color:#dc2626">${Re(D.over90)}</td><td class="r b">${D.total>0?ye(D.over90/D.total*100):"-"}</td><td>${Me(D.total>0?D.over90/D.total*100:0,"#ef4444")}</td></tr>
            <tr class="tr"><td>${V?"Total":"Jumlah"}</td><td class="r">${Re(D.total)}</td><td class="r">100%</td><td></td></tr></table>
          </div>
          <div class="card"><div class="ct"> ${V?"Accounts Payable Ageing":"Pengumuran Pemiutang"}</div>
            <table><tr><th>${V?"Ageing":"Umur"}</th><th class="r">${V?"Amount":"Jumlah"}</th><th class="r">%</th><th style="width:70px"></th></tr>
            <tr><td>${V?"Current":"Semasa"}</td><td class="r">${Re(C.current)}</td><td class="r">${C.total>0?ye(C.current/C.total*100):"-"}</td><td>${Me(C.total>0?C.current/C.total*100:0,"#10b981")}</td></tr>
            <tr><td>1-30 ${V?"days":"hari"}</td><td class="r">${Re(C.d30)}</td><td class="r">${C.total>0?ye(C.d30/C.total*100):"-"}</td><td>${Me(C.total>0?C.d30/C.total*100:0,"#3b82f6")}</td></tr>
            <tr><td>31-60 ${V?"days":"hari"}</td><td class="r">${Re(C.d60)}</td><td class="r">${C.total>0?ye(C.d60/C.total*100):"-"}</td><td>${Me(C.total>0?C.d60/C.total*100:0,"#f59e0b")}</td></tr>
            <tr><td>61-90 ${V?"days":"hari"}</td><td class="r">${Re(C.d90)}</td><td class="r">${C.total>0?ye(C.d90/C.total*100):"-"}</td><td>${Me(C.total>0?C.d90/C.total*100:0,"#f97316")}</td></tr>
            <tr><td>> 90 ${V?"days":"hari"}</td><td class="r">${Re(C.over90)}</td><td class="r">${C.total>0?ye(C.over90/C.total*100):"-"}</td><td>${Me(C.total>0?C.over90/C.total*100:0,"#ef4444")}</td></tr>
            <tr class="tr"><td>${V?"Total":"Jumlah"}</td><td class="r">${Re(C.total)}</td><td class="r">100%</td><td></td></tr></table>
          </div>
        </div>
      </div>
      ${G.length>0||xe.length>0?`<div class="sec"><div class="g2">
        ${G.length>0?`<div class="card"><div class="ct"> ${V?"Top 5 Debtors":"Top 5 Penghutang"}</div>
          <table><tr><th>${V?"Customer":"Pelanggan"}</th><th class="r">${V?"Amount":"Jumlah"}</th></tr>
          ${G.map(it=>`<tr><td>${it.customer||it.description||"N/A"}</td><td class="r">${Re(parseFloat(it.amount)||0)}</td></tr>`).join("")}</table></div>`:"<div></div>"}
        ${xe.length>0?`<div class="card"><div class="ct"> ${V?"Top 5 Creditors":"Top 5 Pemiutang"}</div>
          <table><tr><th>${V?"Supplier":"Pembekal"}</th><th class="r">${V?"Amount":"Jumlah"}</th></tr>
          ${xe.map(it=>`<tr><td>${it.supplier||it.description||"N/A"}</td><td class="r">${Re(parseFloat(it.amount)||0)}</td></tr>`).join("")}</table></div>`:"<div></div>"}
      </div></div>`:""}
      ${O.length>0?`<div class="sec"><div class="sec-title"> ${V?"Property, Plant & Equipment":"Hartanah, Loji & Peralatan"}</div>
        <table><tr><th>${V?"Description":"Keterangan"}</th><th class="r">${V?"Cost":"Kos"}</th><th class="r">NBV</th></tr>
        ${O.map(it=>`<tr><td>${it.desc}</td><td class="r">${Re(it.cost)}</td><td class="r b">${Re(it.nbv)}</td></tr>`).join("")}
        <tr class="tr"><td>${V?"Total":"Jumlah"}</td><td></td><td class="r">${Re(S.ppe)}</td></tr></table>
      </div>`:""}
      <div class="sec"><div class="card" style="background:linear-gradient(135deg,#1e3a8a,#3b82f6);color:#fff;padding:15px">
        <div style="font-size:11pt;font-weight:700;margin-bottom:8px"> ${V?"Financial Health Score":"Skor Kesihatan Kewangan"}</div>
        <div class="g4">
          <div style="text-align:center"><div style="font-size:20pt;font-weight:700">${T.gpMargin>=30?"A":T.gpMargin>=20?"B":T.gpMargin>=10?"C":"D"}</div><div style="font-size:7pt;opacity:.9">${V?"Profitability":"Keuntungan"}</div></div>
          <div style="text-align:center"><div style="font-size:20pt;font-weight:700">${T.currentRatio>=2?"A":T.currentRatio>=1.5?"B":T.currentRatio>=1?"C":"D"}</div><div style="font-size:7pt;opacity:.9">${V?"Liquidity":"Kecairan"}</div></div>
          <div style="text-align:center"><div style="font-size:20pt;font-weight:700">${T.debtToEquity<=.5?"A":T.debtToEquity<=1?"B":T.debtToEquity<=2?"C":"D"}</div><div style="font-size:7pt;opacity:.9">${V?"Leverage":"Leveraj"}</div></div>
          <div style="text-align:center"><div style="font-size:20pt;font-weight:700">${D.over90<=D.total*.1?"A":D.over90<=D.total*.2?"B":D.over90<=D.total*.3?"C":"D"}</div><div style="font-size:7pt;opacity:.9">${V?"Collections":"Kutipan"}</div></div>
        </div>
      </div></div>
      <div class="ftr">${V?"Page":"Muka Surat"} 2  ${y.companyName}  ${V?"Generated by":"Dijana oleh"} FS Automation ${yl}</div>
    </div>`,We+"</body></html>"},Qo=u=>{if(!m){alert("Please generate financial statements first before exporting.");return}const y=s||"Company Name",v=Ot?.fullStandard||"Malaysian Private Entities Reporting Standard",S=u==="EN",T=Me=>Me==null||Me===0?"-":Number(Me),W=Sa.book_new(),D=(Me,Be)=>{const pe=Sa.aoa_to_sheet(Me);return pe["!cols"]=[{wch:45},{wch:15},{wch:15}],Sa.book_append_sheet(W,pe,Be),pe},C=[[y.toUpperCase()],[S?"STATEMENT OF FINANCIAL POSITION":"PENYATA KEDUDUKAN KEWANGAN"],[(S?"AS AT ":"PADA ")+Zt.toUpperCase()],[],["",L,fe],["","RM","RM"],[],[S?"ASSETS":"ASET"],[S?"Non-Current Assets":"Aset Bukan Semasa"],[S?"  Property, plant and equipment":"  Hartanah, loji dan peralatan",T(m.bs.ppe),T(m.bs.py_ppe)],["",T(m.bs.totNCA),T(m.bs.py_totNCA)],[],[S?"Current Assets":"Aset Semasa"],[S?"  Inventories":"  Inventori",T(m.bs.inv),T(m.bs.py_inv)],[S?"  Trade receivables":"  Penghutang perdagangan",T(m.bs.tr),T(m.bs.py_tr)],[S?"  Other receivables":"  Penghutang lain",T(m.bs.or),T(m.bs.py_or)],[S?"  Cash and bank balances":"  Tunai dan baki bank",T(m.bs.cash),T(m.bs.py_cash)],["",T(m.bs.totCA),T(m.bs.py_totCA)],[],[S?"TOTAL ASSETS":"JUMLAH ASET",T(m.bs.totA),T(m.bs.py_totA)],[],[],[S?"EQUITY AND LIABILITIES":"EKUITI DAN LIABILITI"],[S?"Equity":"Ekuiti"],[S?"  Share capital / Capital":"  Modal saham / Modal",T(m.bs.cap),T(m.bs.py_cap)],[S?"  Retained profits":"  Keuntungan tertahan",T(m.bs.ret),T(m.bs.py_ret)],[S?"  Current year profit/(loss)":"  Untung/(Rugi) tahun semasa",T(m.bs.cyp),T(m.bs.py_cyp)],[S?"Total Equity":"Jumlah Ekuiti",T(m.bs.totE),T(m.bs.py_totE)],[],[S?"Non-Current Liabilities":"Liabiliti Bukan Semasa"],[S?"  Borrowings":"  Pinjaman",T(m.bs.ltBorr),T(m.bs.py_ltBorr)],["",T(m.bs.totNCL),T(m.bs.py_totNCL)],[],[S?"Current Liabilities":"Liabiliti Semasa"],[S?"  Trade payables":"  Pemiutang perdagangan",T(m.bs.tp),T(m.bs.py_tp)],[S?"  Other payables":"  Pemiutang lain",T(m.bs.op),T(m.bs.py_op)],[S?"  Short-term borrowings":"  Pinjaman jangka pendek",T(m.bs.stBorr),T(m.bs.py_stBorr)],[S?"  Tax payable":"  Cukai kena bayar",T(m.bs.taxPay),T(m.bs.py_taxPay)],["",T(m.bs.totCL),T(m.bs.py_totCL)],[],[S?"Total Liabilities":"Jumlah Liabiliti",T(m.bs.totL),T(m.bs.py_totL)],[],[S?"TOTAL EQUITY AND LIABILITIES":"JUMLAH EKUITI DAN LIABILITI",T(m.bs.totE+m.bs.totL),T((m.bs.py_totE||0)+(m.bs.py_totL||0))],[],[S?"The accompanying notes form an integral part of these financial statements.":"Nota-nota yang disertakan merupakan sebahagian daripada penyata kewangan ini."]];D(C,S?"Balance Sheet":"Kunci Kira-kira");const O=[[y.toUpperCase()],[S?"STATEMENT OF PROFIT OR LOSS AND OTHER COMPREHENSIVE INCOME":"PENYATA UNTUNG RUGI DAN PENDAPATAN KOMPREHENSIF LAIN"],[(S?"FOR THE FINANCIAL YEAR ENDED ":"BAGI TAHUN KEWANGAN BERAKHIR ")+Zt.toUpperCase()],[],["",L,fe],["","RM","RM"],[],[S?"Revenue":"Hasil",T(m.is.rev),T(m.is.py_rev)],[S?"Cost of sales":"Kos jualan",T(-Math.abs(m.is.cos)),T(-Math.abs(m.is.py_cos))],[S?"Gross profit":"Untung kasar",T(m.is.gp),T(m.is.py_gp)],[],[S?"Other income":"Pendapatan lain",T(m.is.oi),T(m.is.py_oi)],[S?"Administrative expenses":"Perbelanjaan pentadbiran",T(-Math.abs(m.is.adm)),T(-Math.abs(m.is.py_adm))],[S?"Operating profit":"Untung operasi",T(m.is.op),T(m.is.py_op)],[],[S?"Finance costs":"Kos kewangan",T(-Math.abs(m.is.fin)),T(-Math.abs(m.is.py_fin||0))],[S?"Profit before taxation":"Untung sebelum cukai",T(m.is.pbt),T(m.is.py_pbt)],[],[S?"Taxation":"Cukai",T(-Math.abs(m.is.tax)),T(-Math.abs(m.is.py_tax||0))],[S?"Profit for the year":"Untung bagi tahun",T(m.is.np),T(m.is.py_np)],[],[S?"Other comprehensive income":"Pendapatan komprehensif lain","-","-"],[S?"Total comprehensive income for the year":"Jumlah pendapatan komprehensif bagi tahun",T(m.is.np),T(m.is.py_np)],[],[S?"The accompanying notes form an integral part of these financial statements.":"Nota-nota yang disertakan merupakan sebahagian daripada penyata kewangan ini."]];D(O,S?"Income Statement":"Penyata Pendapatan");const G=[[y.toUpperCase()],[S?"STATEMENT OF CHANGES IN EQUITY":"PENYATA PERUBAHAN EKUITI"],[(S?"FOR THE FINANCIAL YEAR ENDED ":"BAGI TAHUN KEWANGAN BERAKHIR ")+Zt.toUpperCase()],[],["",S?"Share Capital":"Modal Saham",S?"Retained Earnings":"Pendapatan Tertahan",S?"Total":"Jumlah"],["","RM","RM","RM"],[],[(S?"Balance at 1 January ":"Baki pada 1 Januari ")+fe,T(m.bs.py_cap),T((m.bs.py_ret||0)-(m.is.py_np||0)),T((m.bs.py_totE||0)-(m.is.py_np||0))],[S?"  Profit for the year":"  Untung bagi tahun","-",T(m.is.py_np),T(m.is.py_np)],[(S?"Balance at 31 December ":"Baki pada 31 Disember ")+fe,T(m.bs.py_cap),T(m.bs.py_ret),T(m.bs.py_totE)],[],[(S?"Balance at 1 January ":"Baki pada 1 Januari ")+L,T(m.bs.py_cap),T(m.bs.py_ret+(m.bs.py_cyp||0)),T(m.bs.py_totE)],[S?"  Profit for the year":"  Untung bagi tahun","-",T(m.is.np),T(m.is.np)],[(S?"Balance at 31 December ":"Baki pada 31 Disember ")+L,T(m.bs.cap),T(m.bs.ret+m.bs.cyp),T(m.bs.totE)],[],[S?"The accompanying notes form an integral part of these financial statements.":"Nota-nota yang disertakan merupakan sebahagian daripada penyata kewangan ini."]],xe=Sa.aoa_to_sheet(G);xe["!cols"]=[{wch:35},{wch:18},{wch:18},{wch:18}],Sa.book_append_sheet(W,xe,S?"Changes in Equity":"Perubahan Ekuiti");const Re=[[y.toUpperCase()],[S?"STATEMENT OF CASH FLOWS":"PENYATA ALIRAN TUNAI"],[(S?"FOR THE FINANCIAL YEAR ENDED ":"BAGI TAHUN KEWANGAN BERAKHIR ")+Zt.toUpperCase()],[],["",L,fe],["","RM","RM"],[],[S?"CASH FLOWS FROM OPERATING ACTIVITIES":"ALIRAN TUNAI DARIPADA AKTIVITI OPERASI"],[S?"  Profit before taxation":"  Untung sebelum cukai",T(m.cf.pbt),T(m.is.py_pbt||0)],[S?"  Adjustments for:":"  Pelarasan untuk:"],[S?"    Depreciation":"    Susut nilai",T(m.cf.adjustments.depreciation),"-"],[S?"    Interest expense":"    Perbelanjaan faedah",T(m.cf.adjustments.interestExpense),"-"],[S?"    Interest income":"    Pendapatan faedah",T(-m.cf.adjustments.interestIncome),"-"],[S?"  Operating profit before working capital changes":"  Untung operasi sebelum perubahan modal kerja",T(m.cf.pbt+m.cf.totalAdjustments),"-"],[S?"  Changes in inventories":"  Perubahan dalam inventori",T(-m.cf.workingCapitalChanges.inventory),"-"],[S?"  Changes in receivables":"  Perubahan dalam penghutang",T(-(m.cf.workingCapitalChanges.tradeReceivables+m.cf.workingCapitalChanges.otherReceivables)),"-"],[S?"  Changes in payables":"  Perubahan dalam pemiutang",T(m.cf.workingCapitalChanges.tradePayables+m.cf.workingCapitalChanges.otherPayables),"-"],[S?"  Cash generated from operations":"  Tunai dijana daripada operasi",T(m.cf.cashFromOperations),"-"],[S?"  Tax paid":"  Cukai dibayar",T(-Math.abs(m.cf.taxPaid)),"-"],[S?"  Interest paid":"  Faedah dibayar",T(-Math.abs(m.cf.interestPaid)),"-"],[S?"Net cash from operating activities":"Tunai bersih daripada aktiviti operasi",T(m.cf.netOperating),"-"],[],[S?"CASH FLOWS FROM INVESTING ACTIVITIES":"ALIRAN TUNAI DARIPADA AKTIVITI PELABURAN"],[S?"  Purchase of PPE":"  Pembelian PPE",T(-Math.abs(m.cf.ppePurchases)),"-"],[S?"  Interest received":"  Faedah diterima",T(m.cf.interestReceived),"-"],[S?"Net cash from investing activities":"Tunai bersih daripada aktiviti pelaburan",T(m.cf.netInvesting),"-"],[],[S?"CASH FLOWS FROM FINANCING ACTIVITIES":"ALIRAN TUNAI DARIPADA AKTIVITI PEMBIAYAAN"],[S?"  Loan proceeds":"  Penerimaan pinjaman",T(m.cf.loanProceeds),"-"],[S?"  Loan repayments":"  Bayaran balik pinjaman",T(-Math.abs(m.cf.loanRepayments)),"-"],[S?"  Capital injection":"  Suntikan modal",T(m.cf.capitalInjection),"-"],[S?"  Dividends/Drawings":"  Dividen/Pengeluaran",T(-Math.abs(m.cf.dividendsPaid+m.cf.drawingsWithdrawals)),"-"],[S?"Net cash from financing activities":"Tunai bersih daripada aktiviti pembiayaan",T(m.cf.netFinancing),"-"],[],[S?"NET CHANGE IN CASH":"PERUBAHAN BERSIH DALAM TUNAI",T(m.cf.netChangeInCash),"-"],[S?"Cash at beginning of year":"Tunai pada awal tahun",T(m.cf.openingCash),T(m.bs.py_cash||0)],[S?"CASH AT END OF YEAR":"TUNAI PADA AKHIR TAHUN",T(m.cf.closingCash),T(m.cf.openingCash)],[],[S?"The accompanying notes form an integral part of these financial statements.":"Nota-nota yang disertakan merupakan sebahagian daripada penyata kewangan ini."]];D(Re,S?"Cash Flow":"Aliran Tunai");const ye=[[y.toUpperCase()],[S?"NOTES TO THE FINANCIAL STATEMENTS":"NOTA-NOTA KEPADA PENYATA KEWANGAN"],[(S?"FOR THE FINANCIAL YEAR ENDED ":"BAGI TAHUN KEWANGAN BERAKHIR ")+Zt.toUpperCase()],[],[S?"1. GENERAL INFORMATION":"1. MAKLUMAT AM"],[S?"The Company is incorporated and domiciled in Malaysia.":"Syarikat diperbadankan dan bermastautin di Malaysia."],[S?"Principal activities: General trading and services.":"Aktiviti utama: Perdagangan am dan perkhidmatan."],[],[S?"2. BASIS OF PREPARATION":"2. ASAS PENYEDIAAN"],[S?"These financial statements have been prepared in accordance with "+v+".":"Penyata kewangan ini telah disediakan mengikut "+v+"."],[],[S?"3. SIGNIFICANT ACCOUNTING POLICIES":"3. DASAR PERAKAUNAN PENTING"],[S?"(a) Property, plant and equipment":"(a) Hartanah, loji dan peralatan"],[S?"    Depreciation rates:":"    Kadar susut nilai:"],[S?"    - Buildings: 2%":"    - Bangunan: 2%"],[S?"    - Motor vehicles: 20%":"    - Kenderaan bermotor: 20%"],[S?"    - Office equipment: 10%":"    - Peralatan pejabat: 10%"],[S?"    - Computer equipment: 33.33%":"    - Peralatan komputer: 33.33%"],[S?"    - Furniture & fittings: 10%":"    - Perabot & kelengkapan: 10%"],[],[S?"(b) Inventories":"(b) Inventori"],[S?"    Stated at lower of cost and net realisable value using FIFO method.":"    Dinyatakan pada kos atau nilai boleh realis bersih yang lebih rendah menggunakan kaedah FIFO."],[],[S?"4. PROPERTY, PLANT AND EQUIPMENT":"4. HARTANAH, LOJI DAN PERALATAN"],["",S?"Cost":"Kos",S?"Acc. Dep.":"Susut Nilai Terkumpul","NBV"],["","RM","RM","RM"],[S?"Total":"Jumlah",T(m.bs.ppe+(rt?.ppe?.accDepCF||0)),T(rt?.ppe?.accDepCF||0),T(m.bs.ppe)],[],[S?"5. TRADE AND OTHER RECEIVABLES":"5. PENGHUTANG PERDAGANGAN DAN LAIN-LAIN"],[S?"Trade receivables":"Penghutang perdagangan",T(m.bs.tr)],[S?"Other receivables":"Penghutang lain",T(m.bs.or)],["Total",T(m.bs.tr+m.bs.or)],[],[S?"6. CASH AND BANK BALANCES":"6. TUNAI DAN BAKI BANK"],[S?"Cash and bank balances":"Tunai dan baki bank",T(m.bs.cash)],[],[S?"7. SHARE CAPITAL / CAPITAL":"7. MODAL SAHAM / MODAL"],[S?"Issued and fully paid":"Diterbitkan dan berbayar penuh",T(m.bs.cap)],[],[S?"8. TRADE AND OTHER PAYABLES":"8. PEMIUTANG PERDAGANGAN DAN LAIN-LAIN"],[S?"Trade payables":"Pemiutang perdagangan",T(m.bs.tp)],[S?"Other payables":"Pemiutang lain",T(m.bs.op)],["Total",T(m.bs.tp+m.bs.op)],[],[S?"9. REVENUE":"9. HASIL"],[S?"Sale of goods and services":"Jualan barangan dan perkhidmatan",T(m.is.rev)],[],[S?"10. TAXATION":"10. CUKAI"],[S?"Current tax expense":"Perbelanjaan cukai semasa",T(m.is.tax)]],X=Sa.aoa_to_sheet(ye);X["!cols"]=[{wch:50},{wch:15},{wch:15},{wch:15}],Sa.book_append_sheet(W,X,S?"Notes":"Nota");const V=(s||"Financial_Statements").replace(/[^a-zA-Z0-9]/g,"_")+"_FS_"+L+"_"+u+".xlsx";As(W,V),ge(!1),ke(Me=>[...Me,{t:"ok",m:` Excel file ${V} downloaded`}])},ro=u=>{if(console.log("generatePDF called, lang:",u,"res:",m),!m){alert(`Please generate financial statements first!

Go to Review tab and click "Generate FS" button.`),ge(!1);return}const y=Ff(u);if(console.log("generateFullFS returned:",y?"HTML content ("+y.length+" chars)":"null"),!y){alert("Failed to generate financial statements. Please try again."),ge(!1);return}ze(y),Ue("pdf"),ge(!1),ke(v=>[...v,{t:"ok",m:' PDF preview ready. Click "Print to PDF" or use Ctrl+P.'}])},O0=u=>{j0("html",u),ge(!1),ke(y=>[...y,{t:"ok",m:` Full FS (HTML) downloaded - ${u}`}])},ks=()=>{ge(!0)},Jo=(u,y,v)=>{const S=[y.join(","),...u.map(W=>W.map(D=>{const C=String(D??"");return C.includes(",")||C.includes('"')||C.includes(`
`)?`"${C.replace(/"/g,'""')}"`:C}).join(","))].join(`
`),T=new Blob([S],{type:"text/csv;charset=utf-8;"});gr(T,`${v}.csv`),ke(W=>[...W,{t:"ok",m:` Exported ${v}.csv`}])},bl=(u,y,v,S="Sheet1")=>{const T=[y,...u],W=Sa.aoa_to_sheet(T),D=y.map((O,G)=>{const xe=Math.max(O.length,...u.map(Re=>String(Re[G]??"").length));return{wch:Math.min(xe+2,40)}});W["!cols"]=D;const C=Sa.book_new();Sa.book_append_sheet(C,W,S.substring(0,31)),As(C,`${v}.xlsx`)?ke(O=>[...O,{t:"ok",m:` Exported ${v}.xlsx`}]):ke(O=>[...O,{t:"error",m:` Failed to export ${v}.xlsx`}])},xn=(u,y,v,S,T="xlsx")=>{T==="csv"?Jo(u,y,v):bl(u,y,v,S)},no=(u="xlsx")=>{const y=["GL Code","Asset ID","Description","Category","Acquisition Date","Cost (RM)","Useful Life (Yrs)","Dep Rate (%)","Acc Dep B/F (RM)","Current Dep (RM)","Acc Dep C/F (RM)","NBV (RM)","Status","Disposal Date","Disposal Proceeds","Include CA","Tax Category","Qualifying Cost"],v=parseInt(L)||new Date().getFullYear(),S=ft.filter(O=>!O.disposed),T=ft.filter(O=>O.disposed),W=O=>{const G=xt[O.category]||xt.OFFICE_EQUIPMENT,xe=parseFloat(O.cost)||0,Re=parseFloat(O.accDepBF)||0,{proratedDep:ye}=Ii(O,null,v),X=O.disposed?0:ye,V=Re+X,Me=xe-V;return["1000",O.assetId||`PPE-LEGACY-${O.id}`,O.description,G.label,O.acquisitionDate,xe,G.years,G.rate,Re,X,V,Me,O.disposed?"DISPOSED":"ACTIVE",O.disposalDate||"",parseFloat(O.disposalProceeds)||0,O.includeForCA?"Yes":"No",O.taxCategory||O.category,parseFloat(O.qualifyingCost)||xe]},D=S.map(W),C=D.reduce((O,G)=>(O.cost+=parseFloat(G[5])||0,O.accDepBF+=parseFloat(G[8])||0,O.currentDep+=parseFloat(G[9])||0,O.accDepCF+=parseFloat(G[10])||0,O.nbv+=parseFloat(G[11])||0,O),{cost:0,accDepBF:0,currentDep:0,accDepCF:0,nbv:0});D.push(["","","TOTAL (ACTIVE)","","",C.cost,"","",C.accDepBF,C.currentDep,C.accDepCF,C.nbv,"","","","","",""]),T.length>0&&(D.push(["","","","","","","","","","","","","","","","","",""]),D.push(["","","--- DISPOSED ASSETS ---","","","","","","","","","","","","","","",""]),T.forEach(O=>D.push(W(O)))),xn(D,y,`PPE_Register_${s.replace(/\s+/g,"_")}_${L}`,"PPE Register",u)},ri=(u="xlsx")=>{const y=["GL Code","Item Code","Description","Category","Quantity","Unit Cost (RM)","Total Value (RM)","Location"],v=pr.map((T,W)=>["1500",T.code||`INV-${String(W+1).padStart(3,"0")}`,T.description,T.category||"General",parseFloat(T.qty)||0,parseFloat(T.unitCost)||0,parseFloat(T.totalValue)||0,T.location||"-"]),S=v.reduce((T,W)=>T+(parseFloat(W[6])||0),0);v.push(["","","TOTAL","","","",S,""]),xn(v,y,`Inventory_Ledger_${s.replace(/\s+/g,"_")}_${L}`,"Inventory",u)},Si=(u="xlsx")=>{const y=["GL Code","Invoice No","Customer Name","Invoice Date","Due Date","Amount (RM)","Status","Aging (Days)"],v=new Date,S=Aa.map((W,D)=>{const C=new Date(W.dueDate),O=Math.floor((v-C)/(1e3*60*60*24));return["1600",W.invoiceNo||`INV-${String(D+1).padStart(4,"0")}`,W.customerName,W.invoiceDate,W.dueDate,parseFloat(W.amount)||0,W.status||"Outstanding",O>0?O:0]}),T=S.reduce((W,D)=>W+(parseFloat(D[5])||0),0);S.push(["","","TOTAL","","",T,"",""]),xn(S,y,`Trade_Receivables_${s.replace(/\s+/g,"_")}_${L}`,"AR",u)},Sl=(u="xlsx")=>{const y=["GL Code","Invoice No","Supplier Name","Invoice Date","Due Date","Amount (RM)","Status","Aging (Days)"],v=new Date,S=sa.map((W,D)=>{const C=new Date(W.dueDate),O=Math.floor((v-C)/(1e3*60*60*24));return["2600",W.invoiceNo||`BILL-${String(D+1).padStart(4,"0")}`,W.supplierName,W.invoiceDate,W.dueDate,parseFloat(W.amount)||0,W.status||"Outstanding",O>0?O:0]}),T=S.reduce((W,D)=>W+(parseFloat(D[5])||0),0);S.push(["","","TOTAL","","",T,"",""]),xn(S,y,`Trade_Payables_${s.replace(/\s+/g,"_")}_${L}`,"AP",u)},io=(u="xlsx")=>{const y=["GL Code","Reference","Description","Type","Amount (RM)"],v=hr.map((T,W)=>["1700",T.ref||`OD-${String(W+1).padStart(3,"0")}`,T.description,T.type||"Deposit",parseFloat(T.amount)||0]),S=v.reduce((T,W)=>T+(parseFloat(W[4])||0),0);v.push(["","","TOTAL","",S]),xn(v,y,`Other_Debtors_${s.replace(/\s+/g,"_")}_${L}`,"Other Debtors",u)},ni=(u="xlsx")=>{const y=["GL Code","Reference","Description","Type","Amount (RM)"],v=ti.map((T,W)=>["2700",T.ref||`OC-${String(W+1).padStart(3,"0")}`,T.description,T.type||"Accrual",parseFloat(T.amount)||0]),S=v.reduce((T,W)=>T+(parseFloat(W[4])||0),0);v.push(["","","TOTAL","",S]),xn(v,y,`Other_Creditors_${s.replace(/\s+/g,"_")}_${L}`,"Other Creditors",u)},so=(u="xlsx")=>{const y=["GL Code","Bank Name","Account Number","Opening Balance (RM)","Closing Balance (RM)"],v=en.map((W,D)=>["1900",W.bankName,W.accountNo||"-",parseFloat(W.openingBalance)||0,parseFloat(W.closingBalance)||0]),S=v.reduce((W,D)=>W+(parseFloat(D[3])||0),0),T=v.reduce((W,D)=>W+(parseFloat(D[4])||0),0);v.push(["","TOTAL","",S,T]),xn(v,y,`Cash_Bank_Ledger_${s.replace(/\s+/g,"_")}_${L}`,"Cash & Bank",u)},I0=()=>{const u=Sa.book_new(),y=parseInt(L)||new Date().getFullYear(),v=["GL Code","Asset ID","Description","Category","Acquisition Date","Cost (RM)","Useful Life","Dep Rate (%)","Acc Dep B/F","Current Dep","Acc Dep C/F","NBV","Status","Include CA"],T=ft.filter(st=>!st.disposed).map(st=>{const zt=xt[st.category]||xt.OFFICE_EQUIPMENT,Ut=parseFloat(st.cost)||0,vt=parseFloat(st.accDepBF)||0,{proratedDep:an}=Ii(st,null,y),qt=an;return["1000",st.assetId||`PPE-LEGACY-${st.id}`,st.description,zt.label,st.acquisitionDate,Ut,zt.years,zt.rate,vt,qt,vt+qt,Ut-vt-qt,"ACTIVE",st.includeForCA?"Yes":"No"]}),W=Sa.aoa_to_sheet([v,...T]);Sa.book_append_sheet(u,W,"PPE Register");const D=["GL Code","Item Code","Description","Category","Quantity","Unit Cost","Total Value","Location"],C=pr.map((st,zt)=>["1500",st.code||`INV-${String(zt+1).padStart(3,"0")}`,st.description,st.category||"General",parseFloat(st.qty)||0,parseFloat(st.unitCost)||0,parseFloat(st.totalValue)||0,st.location||"-"]),O=Sa.aoa_to_sheet([D,...C]);Sa.book_append_sheet(u,O,"Inventory");const G=["GL Code","Invoice No","Customer","Invoice Date","Due Date","Amount","Status","Aging"],xe=new Date,Re=Aa.map((st,zt)=>{const Ut=Math.max(0,Math.floor((xe-new Date(st.dueDate))/864e5));return["1600",st.invoiceNo||`INV-${String(zt+1).padStart(4,"0")}`,st.customerName,st.invoiceDate,st.dueDate,parseFloat(st.amount)||0,st.status||"Outstanding",Ut]}),ye=Sa.aoa_to_sheet([G,...Re]);Sa.book_append_sheet(u,ye,"Trade Receivables");const X=["GL Code","Invoice No","Supplier","Invoice Date","Due Date","Amount","Status","Aging"],V=sa.map((st,zt)=>{const Ut=Math.max(0,Math.floor((xe-new Date(st.dueDate))/864e5));return["2600",st.invoiceNo||`BILL-${String(zt+1).padStart(4,"0")}`,st.supplierName,st.invoiceDate,st.dueDate,parseFloat(st.amount)||0,st.status||"Outstanding",Ut]}),Me=Sa.aoa_to_sheet([X,...V]);Sa.book_append_sheet(u,Me,"Trade Payables");const Be=["GL Code","Reference","Description","Type","Amount"],pe=hr.map((st,zt)=>["1700",st.ref||`OD-${String(zt+1).padStart(3,"0")}`,st.description,st.type||"Deposit",parseFloat(st.amount)||0]),We=Sa.aoa_to_sheet([Be,...pe]);Sa.book_append_sheet(u,We,"Other Debtors");const Ve=["GL Code","Reference","Description","Type","Amount"],it=ti.map((st,zt)=>["2700",st.ref||`OC-${String(zt+1).padStart(3,"0")}`,st.description,st.type||"Accrual",parseFloat(st.amount)||0]),Vt=Sa.aoa_to_sheet([Ve,...it]);Sa.book_append_sheet(u,Vt,"Other Creditors");const lt=["GL Code","Bank Name","Account Number","Opening Balance","Closing Balance"],Fa=en.map(st=>["1900",st.bankName,st.accountNo||"-",parseFloat(st.openingBalance)||0,parseFloat(st.closingBalance)||0]),Ka=Sa.aoa_to_sheet([lt,...Fa]);Sa.book_append_sheet(u,Ka,"Cash & Bank");const Wr=`Subledgers_${(s||"Company").replace(/[^a-zA-Z0-9]/g,"_")}_${L}.xlsx`;As(u,Wr)?ke(st=>[...st,{t:"ok",m:" All subledgers exported to Excel (7 sheets)"}]):ke(st=>[...st,{t:"error",m:" Failed to export subledgers to Excel"}])},B0=()=>{no("csv"),ri("csv"),Si("csv"),Sl("csv"),io("csv"),ni("csv"),so("csv")},M0=(u="xlsx")=>{if(!m){ke(W=>[...W,{t:"error",m:" Generate FS first before exporting Trial Balance"}]);return}const y=["GL Code","Account Name","Debit (RM)","Credit (RM)"],v=m.tb.map(W=>{let D="9999";const C=W.acc.toUpperCase();for(const G of Object.values(Yt.income)){const xe=G.find(Re=>Re.id===C);if(xe?.glCode){D=xe.glCode;break}}for(const G of Object.values(Yt.balance)){const xe=G.find(Re=>Re.id===C);if(xe?.glCode){D=xe.glCode;break}}const O=Yt.other.find(G=>G.id===C);return O?.glCode&&(D=O.glCode),(W.acc.startsWith("bank_")||W.acc==="bank")&&(D="1900"),[D,Gm[D]?.name||W.acc,W.dr>0?W.dr:"",W.cr>0?W.cr:""]}),S=m.tb.reduce((W,D)=>W+(D.dr||0),0),T=m.tb.reduce((W,D)=>W+(D.cr||0),0);v.push(["","TOTAL",S,T]),xn(v,y,`Trial_Balance_${s.replace(/\s+/g,"_")}_${L}`,"Trial Balance",u)},Of=(u="xlsx")=>{const y=["GL Code","Account Name","Type","FS Line Item","Group"],v=Object.entries(Gm).filter(([S,T])=>!T.subAccount).sort((S,T)=>S[0].localeCompare(T[0])).map(([S,T])=>[S,T.name,T.type,T.fsId||"-",T.group||"-"]);xn(v,y,`Chart_of_Accounts_${s.replace(/\s+/g,"_")}`,"COA",u)},If=()=>{const u={version:"1.3",savedAt:new Date().toISOString(),companyName:s,companyRegNo:f,companyType:t,accountingStandard:E,financialYearEnd:g,currentYear:L,priorFSYear:fe,priorISItems:Ye,priorBSItems:He,banks:ya,bankStatements:Dn,txs:_,cashTxs:N,ob:le,ppeRegister:ft,inventoryLedger:pr,tradeReceivables:Aa,tradePayables:sa,otherDebtors:hr,otherCreditors:ti,cashBankLedger:en,shortTermBorrowings:Dr,longTermBorrowings:Ra,caScheduleItems:ps,effectiveTaxYear:Gt,taxSettings:Mt,fsSnapshots:Ia,adjustmentLog:br,res:m},y=JSON.stringify(u,null,2);try{const v=new Blob([y],{type:"application/json"}),S=(s||"fs-session").replace(/[^a-zA-Z0-9]/g,"_")+"_FY"+L+"_session.json";gr(v,S),ke(T=>[...T,{t:"ok",m:"Session saved: "+S}])}catch{ze(y),Ue("json")}},Zo=dt.useRef(null),L0=u=>{const y=u.target.files[0];if(!y)return;const v=new FileReader;v.onload=S=>{try{const T=JSON.parse(S.target.result);T.companyName&&c(T.companyName),T.companyRegNo&&p(T.companyRegNo),T.companyType&&i(T.companyType),T.accountingStandard&&A(T.accountingStandard),T.financialYearEnd&&h(T.financialYearEnd),T.currentYear&&Q(T.currentYear),T.priorFSYear&&Ke(T.priorFSYear),T.priorISItems&&Ze(T.priorISItems),T.priorBSItems&&Xe(T.priorBSItems),T.banks&&Fn(T.banks),T.bankStatements&&Zr(T.bankStatements),T.txs&&w(T.txs),T.cashTxs&&k(T.cashTxs),T.ob&&oe(T.ob),T.ppeRegister&&Ha(T.ppeRegister),T.inventoryLedger&&Gr(T.inventoryLedger),T.tradeReceivables&&On(T.tradeReceivables),T.tradePayables&&ei(T.tradePayables),T.otherDebtors&&ir(T.otherDebtors),T.otherCreditors&&fs(T.otherCreditors),T.cashBankLedger&&ji(T.cashBankLedger),T.shortTermBorrowings&&nl(T.shortTermBorrowings),T.longTermBorrowings&&Oi(T.longTermBorrowings),T.caScheduleItems&&hs(T.caScheduleItems),T.effectiveTaxYear&&Ct(T.effectiveTaxYear),T.fsSnapshots&&nr(T.fsSnapshots),T.adjustmentLog&&Sr(T.adjustmentLog),T.taxSettings&&Fr(W=>({...W,...T.taxSettings,addBackExpenses:{...W.addBackExpenses,...T.taxSettings.addBackExpenses||{}},taxRebates:{...W.taxRebates,...T.taxSettings.taxRebates||{}}})),T.res&&Se(T.res),ke(W=>[...W,{t:"ok",m:`Session loaded: ${y.name} (saved ${T.savedAt?new Date(T.savedAt).toLocaleString():"unknown"})`}]),T.res?a("journal"):T.txs&&T.txs.length>0?a("review"):T.companyType&&a("priorfs")}catch(T){ke(W=>[...W,{t:"error",m:`Error loading session: ${T.message}`}]),alert("Error loading session file. Please check the file format.")}},v.readAsText(y),u.target.value=""},ec=()=>{w([]),k([]),Fn([]),Zr({}),ke([]),Se(null),oe({}),I(!1),Ze(Ae()),Xe(Ge()),i(""),c(""),p(""),A(""),Ha([]),Gr([]),On([]),ei([]),ir([]),fs([]),ji([]),nl([]),Oi([]),nr([]),Sr([]),a("setup")},Ei=(()=>{let u=0,y=0;return ya.forEach(v=>{pi.forEach(S=>{u++,Dn[v.id]?.[S]?.uploaded&&y++})}),{total:u,uploaded:y,percent:u>0?Math.round(y/u*100):0}})(),nt={padding:"8px 10px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:13,width:"100%"},jt={...nt,textAlign:"right",fontFamily:"monospace"},$a=u=>({padding:"12px 10px",background:e===u?"rgba(99,102,241,0.15)":"transparent",borderBottom:e===u?"2px solid #818cf8":"2px solid transparent",color:e===u?"#a5b4fc":"#6b7280",fontSize:11,fontWeight:600,cursor:"pointer",border:"none",whiteSpace:"nowrap"}),ua={fontSize:11,fontWeight:700,color:"#9ca3af",marginBottom:8,textTransform:"uppercase",letterSpacing:1},Ya={padding:"8px 16px",background:"rgba(75,85,99,0.3)",border:"1px solid rgba(75,85,99,0.4)",borderRadius:6,color:"#9ca3af",fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:6},sr={padding:"8px 16px",background:"linear-gradient(135deg, #6366f1, #4f46e5)",border:"none",borderRadius:6,color:"#fff",fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:6},mn=["setup","priorfs","banks","upload","review","classify","cashvoucher","subledger","balances","journal","trial","income","balance","cashflow","tax","snapshots","dashboard"],lr=()=>{const u=mn.indexOf(e);u>0&&a(mn[u-1])},or=()=>{const u=mn.indexOf(e);u<mn.length-1&&a(mn[u+1])};return o.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(145deg, #111827 0%, #1f2937 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',color:"#e5e7eb"},children:[o.jsx("input",{type:"file",ref:Zo,onChange:L0,accept:".json",style:{display:"none"}}),te&&o.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:100},children:o.jsxs("div",{style:{background:"linear-gradient(145deg, #1f2937, #111827)",borderRadius:16,border:"1px solid rgba(75,85,99,0.3)",padding:24,maxWidth:520,width:"90%",maxHeight:"90vh",overflowY:"auto"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:700},children:" Export Financial Statements"}),o.jsx("button",{onClick:()=>ge(!1),style:{background:"none",border:"none",color:"#9ca3af",fontSize:20,cursor:"pointer"},children:""})]}),o.jsxs("p",{style:{fontSize:11,color:"#9ca3af",marginBottom:14},children:["Generate ",Ot?.standard||"MPERS","-compliant financial statements. Choose format and language:"]}),o.jsxs("div",{style:{marginBottom:14},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#f87171",marginBottom:8},children:" PDF Document (.pdf) - Recommended"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[o.jsxs("button",{type:"button",onClick:()=>ro("EN"),style:{padding:12,background:"rgba(239,68,68,0.15)",border:"2px solid rgba(239,68,68,0.4)",borderRadius:10,cursor:"pointer"},children:[o.jsx("div",{style:{fontSize:18,marginBottom:2},children:""}),o.jsx("div",{style:{fontWeight:700,color:"#fca5a5",fontSize:11},children:"English (.pdf)"})]}),o.jsxs("button",{type:"button",onClick:()=>ro("BM"),style:{padding:12,background:"rgba(239,68,68,0.15)",border:"2px solid rgba(239,68,68,0.4)",borderRadius:10,cursor:"pointer"},children:[o.jsx("div",{style:{fontSize:18,marginBottom:2},children:""}),o.jsx("div",{style:{fontWeight:700,color:"#fca5a5",fontSize:11},children:"Bahasa Malaysia (.pdf)"})]})]})]}),o.jsxs("div",{style:{marginBottom:14},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#a5b4fc",marginBottom:8},children:" Word Document (.doc) - Professional Format"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[o.jsxs("button",{type:"button",onClick:()=>{if(console.log("Word EN clicked"),!m){console.error("No financial statements generated"),ke(u=>[...u,{t:"err",m:" Please generate financial statements first"}]);return}try{console.log("Starting Word generation..."),ke(v=>[...v,{t:"info",m:"Generating Word document..."}]);const u=Ts("EN");if(!u){console.error("HTML is null"),ke(v=>[...v,{t:"err",m:" Failed to generate document"}]);return}const y=new Blob([u],{type:"application/msword"});gr(y,`${(s||"Company").replace(/[^a-zA-Z0-9]/g,"_")}_FS_${L}_EN.doc`),ke(v=>[...v,{t:"ok",m:" Word document downloaded (EN)"}])}catch(u){console.error("Word export error:",u),ke(y=>[...y,{t:"err",m:` Word error: ${u.message}`}])}ge(!1)},style:{padding:12,background:"rgba(59,130,246,0.15)",border:"2px solid rgba(59,130,246,0.4)",borderRadius:10,cursor:"pointer"},children:[o.jsx("div",{style:{fontSize:18,marginBottom:2},children:""}),o.jsx("div",{style:{fontWeight:600,color:"#93c5fd",fontSize:10},children:"English (.doc)"})]}),o.jsxs("button",{type:"button",onClick:()=>{if(console.log("Word BM clicked"),!m){console.error("No financial statements generated"),ke(u=>[...u,{t:"err",m:" Please generate financial statements first"}]);return}try{console.log("Starting Word generation..."),ke(v=>[...v,{t:"info",m:"Generating Word document..."}]);const u=Ts("BM");if(!u){console.error("HTML is null"),ke(v=>[...v,{t:"err",m:" Failed to generate document"}]);return}const y=new Blob([u],{type:"application/msword"});gr(y,`${(s||"Company").replace(/[^a-zA-Z0-9]/g,"_")}_FS_${L}_BM.doc`),ke(v=>[...v,{t:"ok",m:" Word document downloaded (BM)"}])}catch(u){console.error("Word export error:",u),ke(y=>[...y,{t:"err",m:` Word error: ${u.message}`}])}ge(!1)},style:{padding:12,background:"rgba(59,130,246,0.15)",border:"2px solid rgba(59,130,246,0.4)",borderRadius:10,cursor:"pointer"},children:[o.jsx("div",{style:{fontSize:18,marginBottom:2},children:""}),o.jsx("div",{style:{fontWeight:600,color:"#93c5fd",fontSize:10},children:"Bahasa Malaysia (.doc)"})]})]}),o.jsx("div",{style:{fontSize:8,color:"#9ca3af",marginTop:4,textAlign:"center"},children:" Professional layout   Borders on amount columns only   Page breaks between sections"})]}),o.jsxs("div",{style:{marginBottom:14},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#4ade80",marginBottom:8},children:" Excel Spreadsheet (.xlsx) - RECOMMENDED"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[o.jsxs("button",{onClick:()=>Qo("EN"),style:{padding:12,background:"rgba(74,222,128,0.15)",border:"2px solid rgba(74,222,128,0.5)",borderRadius:10,cursor:"pointer"},children:[o.jsx("div",{style:{fontSize:18,marginBottom:2},children:""}),o.jsx("div",{style:{fontWeight:700,color:"#4ade80",fontSize:11},children:"English (.xlsx)"})]}),o.jsxs("button",{onClick:()=>Qo("BM"),style:{padding:12,background:"rgba(74,222,128,0.15)",border:"2px solid rgba(74,222,128,0.5)",borderRadius:10,cursor:"pointer"},children:[o.jsx("div",{style:{fontSize:18,marginBottom:2},children:""}),o.jsx("div",{style:{fontWeight:700,color:"#4ade80",fontSize:11},children:"Bahasa Malaysia (.xlsx)"})]})]}),o.jsx("div",{style:{fontSize:9,color:"#86efac",marginTop:6,textAlign:"center"},children:" Best for editing   Proper formatting   Works in Excel/Google Sheets"})]}),o.jsxs("div",{style:{marginBottom:14},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#34d399",marginBottom:8},children:" HTML (Browser View)"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[o.jsx("button",{onClick:()=>O0("EN"),style:{padding:10,background:"rgba(52,211,153,0.1)",border:"1px solid rgba(52,211,153,0.3)",borderRadius:10,cursor:"pointer"},children:o.jsx("div",{style:{fontWeight:600,color:"#34d399",fontSize:10},children:" English (.html)"})}),o.jsx("button",{onClick:()=>O0("BM"),style:{padding:10,background:"rgba(52,211,153,0.1)",border:"1px solid rgba(52,211,153,0.3)",borderRadius:10,cursor:"pointer"},children:o.jsx("div",{style:{fontWeight:600,color:"#34d399",fontSize:10},children:" Bahasa Malaysia (.html)"})})]})]}),o.jsxs("div",{style:{marginBottom:14,background:"rgba(139,92,246,0.1)",borderRadius:10,padding:12,border:"1px solid rgba(139,92,246,0.3)"},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#c084fc",marginBottom:8},children:" Management Pack (V8 New!)"}),o.jsx("div",{style:{fontSize:9,color:"#a5b4fc",marginBottom:8},children:"Dashboard  KPIs  P&L  Ratios  AR/AP Ageing  Insights & Recommendations"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10,marginBottom:8},children:[o.jsx("button",{type:"button",onClick:()=>{if(console.log("MgmtPack PDF EN clicked"),!m){alert("Please generate financial statements first.");return}try{const u=Ui({lang:"EN"});if(!u){alert("Error building Management Pack.");return}const y=vl(u);ze(y),Ue("pdf"),ge(!1),ke(v=>[...v,{t:"ok",m:' Management Pack PDF ready (EN). Click "Print to PDF".'}])}catch(u){console.error(u),alert("Error: "+u.message)}},style:{padding:10,background:"rgba(139,92,246,0.2)",border:"2px solid rgba(139,92,246,0.5)",borderRadius:8,cursor:"pointer"},children:o.jsx("div",{style:{fontWeight:700,color:"#c084fc",fontSize:10},children:" PDF English"})}),o.jsx("button",{type:"button",onClick:()=>{if(console.log("MgmtPack PDF BM clicked"),!m){alert("Please generate financial statements first.");return}try{const u=Ui({lang:"BM"});if(!u){alert("Error building Management Pack.");return}const y=vl(u);ze(y),Ue("pdf"),ge(!1),ke(v=>[...v,{t:"ok",m:' Management Pack PDF ready (BM). Click "Print to PDF".'}])}catch(u){console.error(u),alert("Error: "+u.message)}},style:{padding:10,background:"rgba(139,92,246,0.2)",border:"2px solid rgba(139,92,246,0.5)",borderRadius:8,cursor:"pointer"},children:o.jsx("div",{style:{fontWeight:700,color:"#c084fc",fontSize:10},children:" PDF Bahasa Malaysia"})})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10,marginBottom:8},children:[o.jsx("button",{type:"button",onClick:()=>{if(console.log("MgmtPack PPT EN clicked"),!m){alert("Please generate financial statements first.");return}try{const u=Ui({lang:"EN"});if(!u){alert("Error building Management Pack.");return}const{meta:y,is:v,bs:S,ratios:T,arAgeing:W,apAgeing:D}=u,{fmtNum:C,fmtPct:O,fmtK:G}=u.helpers,xe=`<!DOCTYPE html>
<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:p="urn:schemas-microsoft-com:office:powerpoint">
<head>
<meta charset="UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<xml>
  <o:DocumentProperties>
    <o:Author>FS Automation V8</o:Author>
    <o:Title>${y.companyName} - Management Report</o:Title>
  </o:DocumentProperties>
</xml>
<style>
  body { font-family: Arial, sans-serif; margin: 40px; }
  .slide { page-break-after: always; min-height: 500px; padding: 30px; border: 1px solid #ccc; margin-bottom: 20px; }
  .slide:last-child { page-break-after: avoid; }
  h1 { color: #1e3a8a; font-size: 28pt; text-align: center; margin-top: 150px; }
  h2 { color: #3b82f6; font-size: 20pt; text-align: center; }
  h3 { color: #1e3a8a; font-size: 18pt; border-bottom: 2px solid #3b82f6; padding-bottom: 5px; }
  .subtitle { color: #64748b; font-size: 14pt; text-align: center; }
  table { border-collapse: collapse; width: 80%; margin: 20px auto; }
  th, td { border: 1px solid #e5e7eb; padding: 10px 15px; text-align: left; }
  th { background: #f1f5f9; color: #1e3a8a; }
  .right { text-align: right; }
  .highlight { background: #dbeafe; }
</style>
</head>
<body>
<!-- Slide 1: Title -->
<div class="slide">
  <h1>${y.companyName}</h1>
  <h2>Management Report</h2>
  <p class="subtitle">Financial Year ${y.year}</p>
  <p class="subtitle">Generated: ${y.generated}</p>
</div>

<!-- Slide 2: KPIs -->
<div class="slide">
  <h3>Key Performance Indicators</h3>
  <table>
    <tr><th>Metric</th><th class="right">Value</th></tr>
    <tr><td>Revenue</td><td class="right">RM ${G(v.rev)}</td></tr>
    <tr class="highlight"><td>Gross Profit</td><td class="right">RM ${G(v.gp)} (${O(T.gpMargin)})</td></tr>
    <tr><td>Net Profit</td><td class="right">RM ${G(v.np)} (${O(T.npMargin)})</td></tr>
    <tr class="highlight"><td>Cash Balance</td><td class="right">RM ${G(S.cash)}</td></tr>
    <tr><td>Current Ratio</td><td class="right">${T.currentRatio.toFixed(2)}</td></tr>
    <tr class="highlight"><td>Debt to Equity</td><td class="right">${T.debtToEquity.toFixed(2)}</td></tr>
  </table>
</div>

<!-- Slide 3: P&L -->
<div class="slide">
  <h3>Profit & Loss Summary</h3>
  <table>
    <tr><th>Item</th><th class="right">Amount (RM)</th><th class="right">%</th></tr>
    <tr><td>Revenue</td><td class="right">${C(v.rev)}</td><td class="right">100%</td></tr>
    <tr><td>Cost of Sales</td><td class="right">(${C(v.cos)})</td><td class="right">${O(v.rev>0?v.cos/v.rev*100:0)}</td></tr>
    <tr class="highlight"><td><strong>Gross Profit</strong></td><td class="right"><strong>${C(v.gp)}</strong></td><td class="right"><strong>${O(T.gpMargin)}</strong></td></tr>
    <tr><td>Operating Expenses</td><td class="right">(${C(v.adm)})</td><td class="right">${O(v.rev>0?v.adm/v.rev*100:0)}</td></tr>
    <tr class="highlight"><td><strong>Net Profit</strong></td><td class="right"><strong>${C(v.np)}</strong></td><td class="right"><strong>${O(T.npMargin)}</strong></td></tr>
  </table>
</div>

<!-- Slide 4: Financial Ratios -->
<div class="slide">
  <h3>Financial Ratios</h3>
  <table>
    <tr><th>Ratio</th><th class="right">Value</th><th>Status</th></tr>
    <tr><td>Current Ratio</td><td class="right">${T.currentRatio.toFixed(2)}</td><td>${T.currentRatio>=1?" Good":" Low"}</td></tr>
    <tr><td>Quick Ratio</td><td class="right">${T.quickRatio.toFixed(2)}</td><td>${T.quickRatio>=1?" Good":" Low"}</td></tr>
    <tr><td>Debt to Equity</td><td class="right">${T.debtToEquity.toFixed(2)}</td><td>${T.debtToEquity<=1?" Good":" High"}</td></tr>
    <tr><td>Return on Equity</td><td class="right">${O(T.roe)}</td><td>${T.roe>=10?" Good":" Low"}</td></tr>
    <tr><td>Working Capital</td><td class="right">RM ${C(T.workingCapital)}</td><td>${T.workingCapital>=0?" Positive":" Negative"}</td></tr>
  </table>
</div>

<!-- Slide 5: AR/AP Ageing -->
<div class="slide">
  <h3>Receivables & Payables Ageing</h3>
  <table>
    <tr><th>Ageing</th><th class="right">Receivables (RM)</th><th class="right">Payables (RM)</th></tr>
    <tr><td>Current</td><td class="right">${C(W.current)}</td><td class="right">${C(D.current)}</td></tr>
    <tr><td>1-30 days</td><td class="right">${C(W.d30)}</td><td class="right">${C(D.d30)}</td></tr>
    <tr><td>31-60 days</td><td class="right">${C(W.d60)}</td><td class="right">${C(D.d60)}</td></tr>
    <tr><td>61-90 days</td><td class="right">${C(W.d90)}</td><td class="right">${C(D.d90)}</td></tr>
    <tr class="highlight"><td><strong>> 90 days</strong></td><td class="right"><strong>${C(W.over90)}</strong></td><td class="right"><strong>${C(D.over90)}</strong></td></tr>
    <tr><td><strong>Total</strong></td><td class="right"><strong>${C(W.total)}</strong></td><td class="right"><strong>${C(D.total)}</strong></td></tr>
  </table>
</div>
</body>
</html>`,Re=new Blob([xe],{type:"application/vnd.ms-powerpoint;charset=utf-8"});gr(Re,`${(y.companyName||"Company").replace(/[^a-zA-Z0-9]/g,"_")}_MgmtPack_${y.year}_EN.ppt`),ke(ye=>[...ye,{t:"ok",m:" Management Pack PPT downloaded (EN)"}]),ge(!1)}catch(u){console.error("PPT error:",u),alert("Error generating PowerPoint: "+u.message)}},style:{padding:10,background:"rgba(249,115,22,0.15)",border:"2px solid rgba(249,115,22,0.4)",borderRadius:8,cursor:"pointer"},children:o.jsx("div",{style:{fontWeight:700,color:"#fb923c",fontSize:10},children:" PowerPoint EN"})}),o.jsx("button",{type:"button",onClick:()=>{if(console.log("MgmtPack PPT BM clicked"),!m){alert("Please generate financial statements first.");return}try{const u=Ui({lang:"BM"});if(!u){alert("Error building Management Pack.");return}const{meta:y,is:v,bs:S,ratios:T,arAgeing:W,apAgeing:D}=u,{fmtNum:C,fmtPct:O,fmtK:G}=u.helpers,xe=`<!DOCTYPE html>
<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:p="urn:schemas-microsoft-com:office:powerpoint">
<head>
<meta charset="UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<xml>
  <o:DocumentProperties>
    <o:Author>FS Automation V8</o:Author>
    <o:Title>${y.companyName} - Laporan Pengurusan</o:Title>
  </o:DocumentProperties>
</xml>
<style>
  body { font-family: Arial, sans-serif; margin: 40px; }
  .slide { page-break-after: always; min-height: 500px; padding: 30px; border: 1px solid #ccc; margin-bottom: 20px; }
  .slide:last-child { page-break-after: avoid; }
  h1 { color: #1e3a8a; font-size: 28pt; text-align: center; margin-top: 150px; }
  h2 { color: #3b82f6; font-size: 20pt; text-align: center; }
  h3 { color: #1e3a8a; font-size: 18pt; border-bottom: 2px solid #3b82f6; padding-bottom: 5px; }
  .subtitle { color: #64748b; font-size: 14pt; text-align: center; }
  table { border-collapse: collapse; width: 80%; margin: 20px auto; }
  th, td { border: 1px solid #e5e7eb; padding: 10px 15px; text-align: left; }
  th { background: #f1f5f9; color: #1e3a8a; }
  .right { text-align: right; }
  .highlight { background: #dbeafe; }
</style>
</head>
<body>
<!-- Slide 1: Title -->
<div class="slide">
  <h1>${y.companyName}</h1>
  <h2>Laporan Pengurusan</h2>
  <p class="subtitle">Tahun Kewangan ${y.year}</p>
  <p class="subtitle">Dijana: ${y.generated}</p>
</div>

<!-- Slide 2: KPIs -->
<div class="slide">
  <h3>Petunjuk Prestasi Utama</h3>
  <table>
    <tr><th>Metrik</th><th class="right">Nilai</th></tr>
    <tr><td>Hasil</td><td class="right">RM ${G(v.rev)}</td></tr>
    <tr class="highlight"><td>Untung Kasar</td><td class="right">RM ${G(v.gp)} (${O(T.gpMargin)})</td></tr>
    <tr><td>Untung Bersih</td><td class="right">RM ${G(v.np)} (${O(T.npMargin)})</td></tr>
    <tr class="highlight"><td>Baki Tunai</td><td class="right">RM ${G(S.cash)}</td></tr>
    <tr><td>Nisbah Semasa</td><td class="right">${T.currentRatio.toFixed(2)}</td></tr>
    <tr class="highlight"><td>Hutang kepada Ekuiti</td><td class="right">${T.debtToEquity.toFixed(2)}</td></tr>
  </table>
</div>

<!-- Slide 3: P&L -->
<div class="slide">
  <h3>Ringkasan Untung Rugi</h3>
  <table>
    <tr><th>Perkara</th><th class="right">Jumlah (RM)</th><th class="right">%</th></tr>
    <tr><td>Hasil</td><td class="right">${C(v.rev)}</td><td class="right">100%</td></tr>
    <tr><td>Kos Jualan</td><td class="right">(${C(v.cos)})</td><td class="right">${O(v.rev>0?v.cos/v.rev*100:0)}</td></tr>
    <tr class="highlight"><td><strong>Untung Kasar</strong></td><td class="right"><strong>${C(v.gp)}</strong></td><td class="right"><strong>${O(T.gpMargin)}</strong></td></tr>
    <tr><td>Perbelanjaan Operasi</td><td class="right">(${C(v.adm)})</td><td class="right">${O(v.rev>0?v.adm/v.rev*100:0)}</td></tr>
    <tr class="highlight"><td><strong>Untung Bersih</strong></td><td class="right"><strong>${C(v.np)}</strong></td><td class="right"><strong>${O(T.npMargin)}</strong></td></tr>
  </table>
</div>

<!-- Slide 4: Financial Ratios -->
<div class="slide">
  <h3>Nisbah Kewangan</h3>
  <table>
    <tr><th>Nisbah</th><th class="right">Nilai</th><th>Status</th></tr>
    <tr><td>Nisbah Semasa</td><td class="right">${T.currentRatio.toFixed(2)}</td><td>${T.currentRatio>=1?" Baik":" Rendah"}</td></tr>
    <tr><td>Nisbah Cepat</td><td class="right">${T.quickRatio.toFixed(2)}</td><td>${T.quickRatio>=1?" Baik":" Rendah"}</td></tr>
    <tr><td>Hutang kepada Ekuiti</td><td class="right">${T.debtToEquity.toFixed(2)}</td><td>${T.debtToEquity<=1?" Baik":" Tinggi"}</td></tr>
    <tr><td>Pulangan atas Ekuiti</td><td class="right">${O(T.roe)}</td><td>${T.roe>=10?" Baik":" Rendah"}</td></tr>
    <tr><td>Modal Kerja</td><td class="right">RM ${C(T.workingCapital)}</td><td>${T.workingCapital>=0?" Positif":" Negatif"}</td></tr>
  </table>
</div>

<!-- Slide 5: AR/AP Ageing -->
<div class="slide">
  <h3>Pengumuran Penghutang & Pemiutang</h3>
  <table>
    <tr><th>Umur</th><th class="right">Penghutang (RM)</th><th class="right">Pemiutang (RM)</th></tr>
    <tr><td>Semasa</td><td class="right">${C(W.current)}</td><td class="right">${C(D.current)}</td></tr>
    <tr><td>1-30 hari</td><td class="right">${C(W.d30)}</td><td class="right">${C(D.d30)}</td></tr>
    <tr><td>31-60 hari</td><td class="right">${C(W.d60)}</td><td class="right">${C(D.d60)}</td></tr>
    <tr><td>61-90 hari</td><td class="right">${C(W.d90)}</td><td class="right">${C(D.d90)}</td></tr>
    <tr class="highlight"><td><strong>> 90 hari</strong></td><td class="right"><strong>${C(W.over90)}</strong></td><td class="right"><strong>${C(D.over90)}</strong></td></tr>
    <tr><td><strong>Jumlah</strong></td><td class="right"><strong>${C(W.total)}</strong></td><td class="right"><strong>${C(D.total)}</strong></td></tr>
  </table>
</div>
</body>
</html>`,Re=new Blob([xe],{type:"application/vnd.ms-powerpoint;charset=utf-8"});gr(Re,`${(y.companyName||"Company").replace(/[^a-zA-Z0-9]/g,"_")}_MgmtPack_${y.year}_BM.ppt`),ke(ye=>[...ye,{t:"ok",m:" Management Pack PPT downloaded (BM)"}]),ge(!1)}catch(u){console.error("PPT error:",u),alert("Error generating PowerPoint: "+u.message)}},style:{padding:10,background:"rgba(249,115,22,0.15)",border:"2px solid rgba(249,115,22,0.4)",borderRadius:8,cursor:"pointer"},children:o.jsx("div",{style:{fontWeight:700,color:"#fb923c",fontSize:10},children:" PowerPoint BM"})})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[o.jsx("button",{type:"button",onClick:()=>{if(console.log("MgmtPack HTML EN clicked"),!m){alert("Please generate financial statements first.");return}try{const u=Ui({lang:"EN"});if(!u){alert("Error building Management Pack.");return}const y=vl(u),v=new Blob([y],{type:"text/html;charset=utf-8"});gr(v,`${(s||"Company").replace(/[^a-zA-Z0-9]/g,"_")}_MgmtPack_${L}_EN.html`),ke(S=>[...S,{t:"ok",m:" Management Pack downloaded (EN)"}])}catch(u){console.error(u),alert("Error: "+u.message)}ge(!1)},style:{padding:6,background:"rgba(139,92,246,0.08)",border:"1px solid rgba(139,92,246,0.2)",borderRadius:6,cursor:"pointer"},children:o.jsx("div",{style:{fontWeight:500,color:"#a78bfa",fontSize:8},children:"HTML English"})}),o.jsx("button",{type:"button",onClick:()=>{if(console.log("MgmtPack HTML BM clicked"),!m){alert("Please generate financial statements first.");return}try{const u=Ui({lang:"BM"});if(!u){alert("Error building Management Pack.");return}const y=vl(u),v=new Blob([y],{type:"text/html;charset=utf-8"});gr(v,`${(s||"Company").replace(/[^a-zA-Z0-9]/g,"_")}_MgmtPack_${L}_BM.html`),ke(S=>[...S,{t:"ok",m:" Management Pack downloaded (BM)"}])}catch(u){console.error(u),alert("Error: "+u.message)}ge(!1)},style:{padding:6,background:"rgba(139,92,246,0.08)",border:"1px solid rgba(139,92,246,0.2)",borderRadius:6,cursor:"pointer"},children:o.jsx("div",{style:{fontWeight:500,color:"#a78bfa",fontSize:8},children:"HTML Bahasa Malaysia"})})]})]}),o.jsxs("div",{style:{padding:8,background:"rgba(99,102,241,0.1)",borderRadius:8},children:[o.jsxs("div",{style:{fontSize:9,color:"#a5b4fc"},children:[o.jsx("strong",{children:" Full FS Includes:"})," Cover Page  Balance Sheet  Income Statement  Notes"]}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280",marginTop:4},children:["FS Automation ",yl,"  Lines only on amount columns"]})]})]})}),je&&o.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.95)",display:"flex",flexDirection:"column",zIndex:100},children:[o.jsxs("div",{style:{padding:16,background:"#1f2937",borderBottom:"1px solid rgba(75,85,99,0.3)",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:10},children:[o.jsxs("div",{children:[o.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:700},children:Oe==="pdf"?" Financial Statements":Oe==="html"?" HTML Preview":" Session Data"}),o.jsx("p",{style:{margin:"4px 0 0 0",fontSize:11,color:"#9ca3af"},children:Oe==="pdf"?'Click "Print to PDF" or press Ctrl+P, then select "Save as PDF" as printer.':Oe==="html"?"Preview of generated content.":"Copy and save as .json file to restore later."})]}),o.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[(Oe==="pdf"||Oe==="html")&&o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>{alert(`To save as PDF:

1. Press Ctrl+P (Windows) or Cmd+P (Mac) NOW
2. In the print dialog, select "Save as PDF" as printer
3. Click Save

Alternatively, use "Download HTML" button, open the file in your browser, then print.`)},style:{padding:"8px 16px",background:"linear-gradient(135deg, #ef4444, #dc2626)",border:"none",borderRadius:6,color:"#fff",fontSize:12,fontWeight:600,cursor:"pointer"},children:" Print to PDF (Ctrl+P)"}),o.jsx("button",{onClick:()=>{const u=`${(s||"FS").replace(/[^a-zA-Z0-9]/g,"_")}_${L}.html`,y=new Blob([je],{type:"text/html;charset=utf-8"});gr(y,u),ke(v=>[...v,{t:"ok",m:` Downloaded ${u}`}])},style:{padding:"8px 16px",background:"linear-gradient(135deg, #059669, #10b981)",border:"none",borderRadius:6,color:"#fff",fontSize:12,fontWeight:600,cursor:"pointer"},children:" Download HTML"})]}),o.jsx("button",{onClick:()=>{try{navigator.clipboard.writeText(je),alert(`Copied to clipboard!

To save as PDF:
1. Paste into text editor
2. Save as .html file
3. Open in browser
4. Ctrl+P  Save as PDF`)}catch{alert("Copy failed. Please select all text manually.")}},style:{padding:"8px 16px",background:"linear-gradient(135deg, #6366f1, #4f46e5)",border:"none",borderRadius:6,color:"#fff",fontSize:12,fontWeight:600,cursor:"pointer"},children:" Copy HTML"}),o.jsx("button",{onClick:()=>{ze(null),Ue(null)},style:{padding:"8px 16px",background:"rgba(239,68,68,0.2)",border:"1px solid rgba(239,68,68,0.3)",borderRadius:6,color:"#fca5a5",fontSize:12,fontWeight:600,cursor:"pointer"},children:" Close"})]})]}),Oe==="html"||Oe==="pdf"?o.jsx("div",{style:{flex:1,overflow:"hidden",background:"#fff"},children:o.jsx("iframe",{id:"fs-preview-iframe",srcDoc:je,style:{width:"100%",height:"100%",border:"none"},title:"Financial Statements Preview"})}):o.jsx("div",{style:{flex:1,overflow:"auto",padding:16},children:o.jsx("pre",{style:{background:"rgba(17,24,39,0.8)",padding:16,borderRadius:8,fontSize:10,color:"#a5b4fc",whiteSpace:"pre-wrap",wordBreak:"break-all",maxHeight:"100%",overflow:"auto"},children:je})})]}),o.jsx("header",{style:{background:"rgba(17,24,39,0.95)",borderBottom:"1px solid rgba(75,85,99,0.3)",padding:"12px 20px",position:"sticky",top:0,zIndex:50},children:o.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:10},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[o.jsx("div",{style:{width:36,height:36,background:"linear-gradient(135deg, #6366f1, #8b5cf6)",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center",fontSize:16,fontWeight:800,color:"#fff"},children:"FS"}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:15,fontWeight:700},children:s||"Financial Statements Automation"}),o.jsxs("div",{style:{fontSize:10,color:"#9ca3af"},children:[s&&Zt?`FYE ${Zt}  `:"",Ot?`${Ot.name}  ${Ot.standard}`:"Select company type to begin"]})]})]}),o.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[t&&s&&o.jsxs("span",{style:{fontSize:10,background:"rgba(52,211,153,0.15)",color:"#34d399",padding:"4px 10px",borderRadius:4},children:["FY",L]}),o.jsx("button",{onClick:()=>Zo.current?.click(),style:{padding:"6px 12px",background:"rgba(139,92,246,0.15)",border:"1px solid rgba(139,92,246,0.3)",borderRadius:6,color:"#c4b5fd",fontSize:11,fontWeight:600,cursor:"pointer"},title:"Load a previously saved session",children:" Load"}),(s||_.length>0)&&o.jsx("button",{onClick:If,style:{padding:"6px 12px",background:"rgba(59,130,246,0.15)",border:"1px solid rgba(59,130,246,0.3)",borderRadius:6,color:"#93c5fd",fontSize:11,fontWeight:600,cursor:"pointer"},title:"Save current session to file",children:" Save"}),o.jsx("button",{onClick:kf,style:{padding:"6px 12px",background:"rgba(99,102,241,0.15)",border:"1px solid rgba(99,102,241,0.3)",borderRadius:6,color:"#a5b4fc",fontSize:11,fontWeight:600,cursor:"pointer"},children:"Sample"}),_.length>0&&o.jsx("button",{onClick:ec,style:{padding:"6px 12px",background:"rgba(239,68,68,0.15)",border:"1px solid rgba(239,68,68,0.3)",borderRadius:6,color:"#fca5a5",fontSize:11,fontWeight:600,cursor:"pointer"},children:"Clear"}),m&&o.jsx("button",{onClick:ks,style:{padding:"6px 12px",background:"linear-gradient(135deg, #10b981, #059669)",border:"none",borderRadius:6,color:"#fff",fontSize:11,fontWeight:600,cursor:"pointer"},children:"Export"})]})]})}),o.jsx("nav",{style:{background:"rgba(31,41,55,0.5)",borderBottom:"1px solid rgba(75,85,99,0.2)",padding:"0 20px",overflowX:"auto"},children:o.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",display:"flex"},children:[o.jsx("button",{style:$a("setup"),onClick:()=>a("setup"),children:" Setup"}),o.jsx("button",{style:{...$a("priorfs"),opacity:t?1:.4},onClick:()=>t&&a("priorfs"),children:" Prior FS"}),o.jsx("button",{style:{...$a("banks"),opacity:t?1:.4},onClick:()=>t&&a("banks"),children:" Banks"}),o.jsx("button",{style:{...$a("upload"),opacity:t?1:.4},onClick:()=>t&&a("upload"),children:" Upload"}),o.jsxs("button",{style:{...$a("review"),opacity:t?1:.4},onClick:()=>t&&a("review"),children:[" Review (",_.length,")"]}),o.jsx("button",{style:{...$a("classify"),opacity:_.length>0?1:.4},onClick:()=>_.length>0&&a("classify"),children:" Classify"}),o.jsxs("button",{style:{...$a("cashvoucher"),opacity:t?1:.4},onClick:()=>t&&a("cashvoucher"),children:[" Cash (",N.length,")"]}),o.jsx("button",{style:{...$a("subledger"),opacity:t?1:.4},onClick:()=>t&&a("subledger"),children:" Subledger"}),o.jsx("button",{style:{...$a("balances"),opacity:t?1:.4},onClick:()=>t&&a("balances"),children:" Opening"}),o.jsx("button",{style:{...$a("journal"),opacity:m?1:.4},onClick:()=>m&&a("journal"),children:" JE"}),o.jsx("button",{style:{...$a("trial"),opacity:m?1:.4},onClick:()=>m&&a("trial"),children:" TB"}),o.jsx("button",{style:{...$a("income"),opacity:m?1:.4},onClick:()=>m&&a("income"),children:" P&L"}),o.jsx("button",{style:{...$a("balance"),opacity:m?1:.4},onClick:()=>m&&a("balance"),children:" BS"}),o.jsx("button",{style:{...$a("cashflow"),opacity:m?1:.4},onClick:()=>m&&a("cashflow"),children:" CF"}),o.jsx("button",{style:{...$a("tax"),opacity:m?1:.4},onClick:()=>m&&a("tax"),children:" Tax"}),o.jsxs("button",{style:{...$a("snapshots"),opacity:t?1:.4},onClick:()=>t&&a("snapshots"),children:[" Snaps (",Ia.length,")"]}),o.jsx("button",{style:{...$a("dashboard"),opacity:m?1:.4},onClick:()=>m&&a("dashboard"),children:" Dashboard"})]})}),o.jsxs("main",{style:{maxWidth:1200,margin:"0 auto",padding:"20px"},children:[e==="setup"&&o.jsx("div",{style:{maxWidth:700,margin:"0 auto"},children:o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:12,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(99,102,241,0.1), rgba(139,92,246,0.1))"},children:[o.jsx("div",{style:{fontWeight:700,fontSize:16},children:" Company Setup"}),o.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginTop:4},children:"Enter your company details and select the applicable accounting standard"})]}),o.jsxs("div",{style:{padding:20},children:[o.jsxs("div",{style:{marginBottom:24},children:[o.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:12,color:"#a5b4fc"},children:"Company Details:"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Company Name *"}),o.jsx("input",{value:s,onChange:u=>c(u.target.value),placeholder:"e.g. ABC Trading Sdn Bhd",style:{...nt,width:"100%",padding:"10px 12px"}})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Registration No."}),o.jsx("input",{value:f,onChange:u=>p(u.target.value),placeholder:"e.g. 202301012345 (12345-X)",style:{...nt,width:"100%",padding:"10px 12px"}})]})]})]}),o.jsxs("div",{style:{marginBottom:24},children:[o.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:12,color:"#a5b4fc"},children:"Financial Year:"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12},children:[o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Year End Month"}),o.jsxs("select",{value:g,onChange:u=>h(u.target.value),style:{...nt,width:"100%",padding:"10px 12px",cursor:"pointer"},children:[o.jsx("option",{value:"1",children:"January"}),o.jsx("option",{value:"2",children:"February"}),o.jsx("option",{value:"3",children:"March"}),o.jsx("option",{value:"4",children:"April"}),o.jsx("option",{value:"5",children:"May"}),o.jsx("option",{value:"6",children:"June"}),o.jsx("option",{value:"7",children:"July"}),o.jsx("option",{value:"8",children:"August"}),o.jsx("option",{value:"9",children:"September"}),o.jsx("option",{value:"10",children:"October"}),o.jsx("option",{value:"11",children:"November"}),o.jsx("option",{value:"12",children:"December"})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Current FY Year"}),o.jsx("input",{type:"number",value:L,onChange:u=>{Q(parseInt(u.target.value)||new Date().getFullYear()),Ke((parseInt(u.target.value)||new Date().getFullYear())-1)},style:{...nt,width:"100%",padding:"10px 12px"}})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Prior FY Year"}),o.jsx("input",{type:"number",value:fe,onChange:u=>Ke(parseInt(u.target.value)||new Date().getFullYear()-1),style:{...nt,width:"100%",padding:"10px 12px"}})]})]}),s&&g&&o.jsxs("div",{style:{marginTop:12,padding:10,background:"rgba(52,211,153,0.1)",borderRadius:6,fontSize:11,color:"#34d399"},children:[" Financial Year End: ",o.jsx("strong",{children:Zt})," (FY",L,")"]})]}),o.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:16,color:"#a5b4fc"},children:"Select Company Type:"}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:Object.entries(Ym).map(([u,y])=>o.jsx("div",{onClick:()=>{i(u),A(Nr(u))},style:{padding:16,background:t===u?"rgba(99,102,241,0.2)":"rgba(17,24,39,0.4)",border:t===u?"2px solid #6366f1":"1px solid rgba(75,85,99,0.3)",borderRadius:10,cursor:"pointer",transition:"all 0.2s"},children:o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:700,fontSize:14,marginBottom:4,color:t===u?"#a5b4fc":"#e5e7eb"},children:y.name}),o.jsxs("div",{style:{fontSize:11,color:"#9ca3af",marginBottom:6},children:["Default: ",y.fullStandard]}),o.jsxs("div",{style:{display:"flex",gap:12},children:[o.jsx("span",{style:{fontSize:10,background:"rgba(52,211,153,0.2)",color:"#34d399",padding:"2px 8px",borderRadius:4},children:y.standard}),o.jsx("span",{style:{fontSize:10,background:"rgba(251,191,36,0.2)",color:"#fbbf24",padding:"2px 8px",borderRadius:4},children:y.taxInfo})]})]}),t===u&&o.jsx("div",{style:{width:24,height:24,background:"#6366f1",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:14},children:""})]})},u))}),t&&o.jsxs("div",{style:{marginTop:24},children:[o.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:12,color:"#a5b4fc"},children:"Select Accounting Standard:"}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:10},children:Object.entries(ma).map(([u,y])=>o.jsxs("div",{onClick:()=>A(u),style:{padding:12,background:E===u?"rgba(52,211,153,0.2)":"rgba(17,24,39,0.4)",border:E===u?"2px solid #34d399":"1px solid rgba(75,85,99,0.3)",borderRadius:8,cursor:"pointer",transition:"all 0.2s",textAlign:"center"},children:[o.jsx("div",{style:{fontWeight:700,fontSize:12,color:E===u?"#34d399":"#e5e7eb"},children:y.name}),o.jsx("div",{style:{fontSize:9,color:"#6b7280",marginTop:4},children:y.desc})]},u))}),o.jsxs("div",{style:{marginTop:12,padding:10,background:"rgba(99,102,241,0.1)",borderRadius:6},children:[o.jsxs("div",{style:{fontSize:10,color:"#a5b4fc"},children:[o.jsx("strong",{children:"Selected:"})," ",ma[E]?.fullName||"None"]}),o.jsxs("div",{style:{fontSize:9,color:"#6b7280",marginTop:4},children:[E==="MFRS"&&"Full IFRS-equivalent. Required for public listed companies.",E==="MPERS"&&"Simplified IFRS for SMEs. Suitable for most Sdn Bhd companies.",E==="MPERS-Micro"&&"Most simplified. For micro entities with revenue < RM3m."]})]})]}),t&&s&&o.jsx("button",{onClick:()=>a("priorfs"),style:{...sr,width:"100%",marginTop:20,padding:"14px",fontSize:14,justifyContent:"center"},children:"Continue to Prior Year FS "}),t&&!s&&o.jsx("div",{style:{marginTop:16,padding:10,background:"rgba(251,191,36,0.1)",borderRadius:6,fontSize:11,color:"#fbbf24",textAlign:"center"},children:" Please enter your company name to continue"})]})]})}),e==="banks"&&o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("button",{onClick:lr,style:Ya,children:" Prior FS"}),o.jsx("span",{style:{fontWeight:700,fontSize:14},children:" Bank Accounts"})]}),o.jsx("button",{onClick:or,style:sr,children:"Next: Upload "})]}),o.jsxs("div",{style:{padding:16},children:[o.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[o.jsx("input",{placeholder:"Bank Name (e.g. Maybank)",value:Zn.name,onChange:u=>cs(y=>({...y,name:u.target.value})),style:{...nt,flex:1}}),o.jsx("input",{placeholder:"Account No",value:Zn.accNo,onChange:u=>cs(y=>({...y,accNo:u.target.value})),style:{...nt,width:120}}),o.jsx("button",{onClick:Tf,style:{padding:"8px 16px",background:"linear-gradient(135deg, #6366f1, #4f46e5)",border:"none",borderRadius:6,color:"#fff",fontWeight:700,cursor:"pointer"},children:"+"})]}),ya.length===0?o.jsxs("div",{style:{padding:24,textAlign:"center",color:"#6b7280"},children:[o.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),o.jsx("div",{style:{fontSize:13},children:"Add your bank accounts first"}),o.jsx("div",{style:{fontSize:11,marginTop:4},children:"Each bank will have 12 months of statements"})]}):o.jsx("div",{children:ya.map((u,y)=>{const v=Dn[u.id]||{},S=pi.filter(T=>v[T]?.uploaded).length;return o.jsxs("div",{style:{padding:12,background:y%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:6,marginBottom:8},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:600},children:u.name}),o.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:u.accNo})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsxs("span",{style:{fontSize:11,color:S===12?"#34d399":"#fbbf24"},children:[S,"/12 months"]}),o.jsx("div",{style:{width:60,height:6,background:"rgba(75,85,99,0.3)",borderRadius:3},children:o.jsx("div",{style:{width:`${S/12*100}%`,height:"100%",background:S===12?"#34d399":"#6366f1",borderRadius:3}})})]})]}),o.jsx("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:pi.map(T=>o.jsx("div",{style:{padding:"2px 6px",borderRadius:4,fontSize:9,fontWeight:600,background:v[T]?.uploaded?"rgba(52,211,153,0.2)":"rgba(75,85,99,0.2)",color:v[T]?.uploaded?"#34d399":"#6b7280"},children:T},T))})]},u.id)})})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",fontWeight:700,fontSize:14},children:" Upload Progress"}),o.jsx("div",{style:{padding:16},children:ya.length===0?o.jsx("div",{style:{padding:24,textAlign:"center",color:"#6b7280",fontSize:13},children:"Add bank accounts to start"}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{textAlign:"center",marginBottom:20},children:[o.jsxs("div",{style:{fontSize:48,fontWeight:700,color:Ei.percent===100?"#34d399":"#a5b4fc"},children:[Ei.percent,"%"]}),o.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[Ei.uploaded," of ",Ei.total," statements uploaded"]})]}),o.jsx("div",{style:{marginBottom:16},children:o.jsx("div",{style:{height:8,background:"rgba(75,85,99,0.3)",borderRadius:4},children:o.jsx("div",{style:{width:`${Ei.percent}%`,height:"100%",background:"linear-gradient(90deg, #6366f1, #8b5cf6)",borderRadius:4,transition:"width 0.3s"}})})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[o.jsxs("div",{style:{padding:12,background:"rgba(17,24,39,0.4)",borderRadius:6,textAlign:"center"},children:[o.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#a5b4fc"},children:ya.length}),o.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"Bank Accounts"})]}),o.jsxs("div",{style:{padding:12,background:"rgba(17,24,39,0.4)",borderRadius:6,textAlign:"center"},children:[o.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#34d399"},children:_.length}),o.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"Transactions"})]})]}),ya.length>0&&o.jsx("button",{onClick:()=>a("upload"),style:{width:"100%",marginTop:16,padding:"12px",background:"linear-gradient(135deg, #8b5cf6, #7c3aed)",border:"none",borderRadius:8,color:"#fff",fontSize:13,fontWeight:600,cursor:"pointer"},children:"Upload Bank Statements "})]})})]})]}),e==="upload"&&o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("button",{onClick:lr,style:Ya,children:" Back"}),o.jsx("span",{style:{fontWeight:700,fontSize:14},children:" Upload Bank Statement"})]}),o.jsx("button",{onClick:or,style:sr,children:"Next "})]}),o.jsx("div",{style:{padding:16},children:ya.length===0?o.jsxs("div",{style:{padding:24,textAlign:"center",color:"#6b7280"},children:[o.jsx("div",{style:{fontSize:13},children:"Please add bank accounts first"}),o.jsx("button",{onClick:()=>a("banks"),style:{marginTop:12,padding:"8px 16px",background:"rgba(99,102,241,0.15)",border:"1px solid rgba(99,102,241,0.3)",borderRadius:6,color:"#a5b4fc",fontSize:12,cursor:"pointer"},children:"Go to Banks Tab"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginBottom:16},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginBottom:4},children:"Select Bank"}),o.jsxs("select",{value:Xt,onChange:u=>vi(u.target.value),style:{...nt,cursor:"pointer"},children:[o.jsx("option",{value:"",children:"-- Select Bank --"}),ya.map(u=>o.jsx("option",{value:u.id,children:u.name},u.id))]})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginBottom:4},children:"Select Month"}),o.jsx("select",{value:ur,onChange:u=>rl(u.target.value),style:{...nt,cursor:"pointer"},children:pi.map(u=>o.jsxs("option",{value:u,children:[u," ",L]},u))})]})]}),Xt&&(()=>{const u=Dn[Xt]?.[ur],y=ya.find(v=>v.id===Xt);return u?.uploaded?o.jsx("div",{style:{background:"rgba(52,211,153,0.1)",border:"1px solid rgba(52,211,153,0.3)",borderRadius:8,padding:12,marginBottom:12},children:o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#34d399"},children:[" ",y?.name," - ",ur]}),o.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginTop:2},children:[u.file,"  ",u.txCount," transactions"]})]}),o.jsx("button",{onClick:()=>S0(Xt,ur),style:{padding:"6px 12px",background:"rgba(239,68,68,0.2)",border:"1px solid rgba(239,68,68,0.3)",borderRadius:6,color:"#f87171",fontSize:11,fontWeight:600,cursor:"pointer"},children:" Remove & Re-upload"})]})}):null})(),o.jsxs("div",{style:{border:"2px dashed rgba(99,102,241,0.4)",borderRadius:8,padding:20,textAlign:"center",cursor:Xt?"pointer":"not-allowed",marginBottom:12,opacity:Xt?1:.5},onClick:()=>Xt&&Je.current?.click(),children:[o.jsx("input",{ref:Je,type:"file",accept:".csv,.txt,.tsv,.pdf,.xlsx,.xls",multiple:!0,onChange:Af,style:{display:"none"}}),o.jsx("div",{style:{fontSize:28,marginBottom:8},children:""}),o.jsx("div",{style:{fontWeight:600,fontSize:12},children:ue?"Processing...":"Click to upload CSV, Excel, TXT or PDF"}),o.jsx("div",{style:{fontSize:10,color:"#6b7280",marginTop:4},children:"Supports .csv, .xlsx, .xls, .txt, .pdf"})]}),o.jsxs("div",{style:{marginBottom:12},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,marginBottom:6,color:"#fbbf24"},children:" For PDF files - paste extracted text:"}),o.jsx("textarea",{value:jn,onChange:u=>ds(u.target.value),placeholder:"If your bank only provides PDF statements, open the PDF, select all text (Ctrl+A), copy (Ctrl+C), and paste here...",style:{width:"100%",height:80,background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,padding:8,color:"#e5e7eb",fontSize:11,resize:"vertical"}}),o.jsx("button",{onClick:_f,disabled:!jn.trim()||!Xt,style:{marginTop:6,padding:"6px 14px",background:jn.trim()&&Xt?"linear-gradient(135deg, #f59e0b, #d97706)":"rgba(75,85,99,0.3)",border:"none",borderRadius:6,color:"#fff",fontSize:11,fontWeight:600,cursor:jn.trim()&&Xt?"pointer":"not-allowed"},children:"Parse PDF Text"})]}),et.length>0&&o.jsx("div",{style:{background:"rgba(17,24,39,0.5)",borderRadius:6,padding:10,maxHeight:120,overflowY:"auto"},children:et.slice(-10).map((u,y)=>o.jsx("div",{style:{fontSize:10,padding:"2px 0",color:u.t==="ok"?"#34d399":u.t==="err"?"#f87171":u.t==="warn"?"#fbbf24":"#9ca3af"},children:u.m},y))})]})})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",fontWeight:700,fontSize:14},children:" Upload Matrix"}),o.jsxs("div",{style:{padding:16,overflowX:"auto"},children:[ya.length===0?o.jsx("div",{style:{padding:24,textAlign:"center",color:"#6b7280",fontSize:13},children:"No banks configured"}):o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:10},children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:{padding:6,textAlign:"left",borderBottom:"1px solid rgba(75,85,99,0.3)"},children:"Bank"}),pi.map(u=>o.jsx("th",{style:{padding:4,textAlign:"center",borderBottom:"1px solid rgba(75,85,99,0.3)",fontSize:9},children:u},u))]})}),o.jsx("tbody",{children:ya.map(u=>o.jsxs("tr",{children:[o.jsx("td",{style:{padding:6,fontWeight:600},children:u.name}),pi.map(y=>{const v=Dn[u.id]?.[y];return o.jsxs("td",{style:{padding:4,textAlign:"center"},children:[o.jsx("div",{style:{width:24,height:24,borderRadius:4,margin:"0 auto",background:v?.uploaded?"rgba(52,211,153,0.3)":"rgba(75,85,99,0.2)",display:"flex",alignItems:"center",justifyContent:"center",color:v?.uploaded?"#34d399":"#6b7280",fontSize:9,cursor:"pointer",position:"relative"},onClick:()=>{vi(u.id),rl(y)},title:v?.uploaded?`${v.file} (${v.txCount} txns) - Click to select`:"Click to select",children:v?.uploaded?v.txCount:""}),v?.uploaded&&o.jsx("button",{onClick:S=>{S.stopPropagation(),S0(u.id,y)},style:{fontSize:8,padding:"1px 4px",marginTop:2,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:3,color:"#f87171",cursor:"pointer"},title:"Remove transactions for this month",children:""})]},y)})]},u.id))})]}),_.length>0&&o.jsx("button",{onClick:()=>a("review"),style:{width:"100%",marginTop:16,padding:"10px",background:"linear-gradient(135deg, #8b5cf6, #7c3aed)",border:"none",borderRadius:8,color:"#fff",fontSize:12,fontWeight:600,cursor:"pointer"},children:"Next: Review Transactions "})]})]})]}),e==="priorfs"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("button",{onClick:lr,style:Ya,children:" Setup"}),o.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[o.jsx("span",{style:{fontSize:11,color:"#9ca3af"},children:"Prior Year:"}),o.jsx("input",{type:"number",value:fe,onChange:u=>Ke(parseInt(u.target.value)),style:{...nt,width:70,padding:"4px 8px",fontSize:12}}),o.jsx("button",{onClick:or,style:sr,children:"Next: Bank Setup "})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",marginBottom:16,padding:16},children:[o.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginBottom:12},children:[o.jsx("span",{style:{fontSize:12,fontWeight:600},children:"Input Mode:"}),o.jsx("button",{onClick:()=>q("manual"),style:{padding:"6px 16px",background:j==="manual"?"rgba(99,102,241,0.3)":"transparent",border:"1px solid rgba(99,102,241,0.3)",borderRadius:6,color:j==="manual"?"#a5b4fc":"#6b7280",fontSize:11,cursor:"pointer"},children:"Manual Entry"}),o.jsx("button",{onClick:()=>q("upload"),style:{padding:"6px 16px",background:j==="upload"?"rgba(99,102,241,0.3)":"transparent",border:"1px solid rgba(99,102,241,0.3)",borderRadius:6,color:j==="upload"?"#a5b4fc":"#6b7280",fontSize:11,cursor:"pointer"},children:"Upload Prior FS"})]}),j==="upload"&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginBottom:12},children:[o.jsx("input",{type:"file",accept:".csv,.txt,.xlsx,.xls,.pdf",onChange:Sf,style:{fontSize:11}}),Y.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs("span",{style:{fontSize:11,color:"#34d399"},children:[" ",Y.length," items found"]}),o.jsx("button",{onClick:Ef,style:{padding:"6px 12px",background:"linear-gradient(135deg, #8b5cf6, #7c3aed)",border:"none",borderRadius:6,color:"#fff",fontSize:11,cursor:"pointer"},children:"Auto-Map"})]})]}),o.jsxs("div",{style:{marginBottom:12,padding:12,background:"rgba(251,191,36,0.05)",border:"1px solid rgba(251,191,36,0.2)",borderRadius:8},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,marginBottom:8,color:"#fbbf24"},children:" For PDF files - paste extracted text here:"}),o.jsx("textarea",{value:me,onChange:u=>Te(u.target.value),placeholder:"Open the PDF in any viewer, select all text (Ctrl+A), copy (Ctrl+C), and paste here. The system will extract financial statement line items automatically.",style:{width:"100%",height:100,background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,padding:10,color:"#e5e7eb",fontSize:11,resize:"vertical",fontFamily:"monospace"}}),o.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[o.jsx("button",{onClick:()=>Xo(me),disabled:!me.trim(),style:{padding:"6px 14px",background:me.trim()?"linear-gradient(135deg, #f59e0b, #d97706)":"rgba(75,85,99,0.3)",border:"none",borderRadius:6,color:"#fff",fontSize:11,fontWeight:600,cursor:me.trim()?"pointer":"not-allowed"},children:"Parse PDF Text"}),me&&o.jsx("button",{onClick:()=>Te(""),style:{padding:"6px 14px",background:"rgba(239,68,68,0.2)",border:"1px solid rgba(239,68,68,0.3)",borderRadius:6,color:"#f87171",fontSize:11,cursor:"pointer"},children:"Clear"})]})]}),o.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:8},children:[" ",o.jsx("strong",{children:"Tips:"})," Excel files with multiple sheets will be read from all tabs. PDF files can be uploaded or paste text directly above."]})]}),j==="upload"&&Y.length>0&&o.jsxs("div",{style:{marginTop:12,maxHeight:200,overflowY:"auto",background:"rgba(17,24,39,0.4)",borderRadius:6,padding:10},children:[o.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:6},children:["Parsed Items (",Y.length," total)",Y[0]?.sheet&&o.jsxs("span",{style:{marginLeft:8,color:"#a5b4fc"},children:["from sheets: ",[...new Set(Y.map(u=>u.sheet))].join(", ")]}),":"]}),o.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:[Y.slice(0,30).map((u,y)=>o.jsxs("span",{style:{fontSize:9,background:u.sheet?"rgba(139,92,246,0.2)":"rgba(99,102,241,0.2)",color:"#a5b4fc",padding:"3px 8px",borderRadius:4,border:u.value<0?"1px solid rgba(239,68,68,0.3)":"1px solid transparent"},title:u.sheet?`Sheet: ${u.sheet}`:"",children:[u.label.substring(0,25),u.label.length>25?"...":"",":",o.jsx("span",{style:{color:u.value>=0?"#34d399":"#f87171",marginLeft:4},children:u.value<0?`(${ae(Math.abs(u.value))})`:ae(u.value)})]},y)),Y.length>30&&o.jsxs("span",{style:{fontSize:9,color:"#6b7280",padding:"3px 8px"},children:["+",Y.length-30," more items"]})]})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:o.jsx("span",{style:{fontWeight:700,fontSize:14},children:" Prior Year Income Statement"})}),o.jsxs("div",{style:{padding:16,maxHeight:400,overflowY:"auto"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[o.jsx("span",{style:ua,children:"Revenue"}),o.jsx("button",{onClick:()=>bs("revenue"),style:{padding:"2px 8px",background:"rgba(52,211,153,0.2)",border:"none",borderRadius:4,color:"#34d399",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),Ye.filter(u=>u.section==="revenue"||u.type==="revenue").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:y=>Or(u.id,"label",y.target.value),style:{...nt,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:y=>Or(u.id,"value",y.target.value),style:{...jt,width:100,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>zi(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""}),u.mapped&&o.jsx("span",{style:{fontSize:8,color:"#34d399"},children:""})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"6px 0",fontWeight:600,fontSize:11,borderTop:"1px solid rgba(75,85,99,0.2)",marginTop:4},children:[o.jsx("span",{children:"Total Revenue"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#34d399"},children:ae(tt.revenue)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:12,marginBottom:6},children:[o.jsx("span",{style:ua,children:"Cost of Sales"}),o.jsx("button",{onClick:()=>bs("cogs"),style:{padding:"2px 8px",background:"rgba(251,191,36,0.2)",border:"none",borderRadius:4,color:"#fbbf24",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),Ye.filter(u=>u.section==="cost_of_sales"||u.type==="cogs").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:y=>Or(u.id,"label",y.target.value),style:{...nt,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:y=>Or(u.id,"value",y.target.value),style:{...jt,width:100,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>zi(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"rgba(52,211,153,0.1)",borderRadius:6,fontWeight:700,fontSize:12,marginTop:4},children:[o.jsx("span",{children:"Gross Profit"}),o.jsx("span",{style:{fontFamily:"monospace",color:tt.gp>=0?"#34d399":"#f87171"},children:ae(tt.gp)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:12,marginBottom:6},children:[o.jsx("span",{style:ua,children:"Operating Expenses"}),o.jsx("button",{onClick:()=>bs("expense"),style:{padding:"2px 8px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),Ye.filter(u=>u.section==="operating_expenses"||u.type==="expense").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:y=>Or(u.id,"label",y.target.value),style:{...nt,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:y=>Or(u.id,"value",y.target.value),style:{...jt,width:100,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>zi(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:12,marginBottom:6},children:[o.jsx("span",{style:ua,children:"Other Income"}),o.jsx("button",{onClick:()=>bs("other_income"),style:{padding:"2px 8px",background:"rgba(52,211,153,0.2)",border:"none",borderRadius:4,color:"#34d399",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),Ye.filter(u=>u.section==="other_income"||u.type==="other_income").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:y=>Or(u.id,"label",y.target.value),style:{...nt,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:y=>Or(u.id,"value",y.target.value),style:{...jt,width:100,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>zi(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:12,marginBottom:6},children:[o.jsx("span",{style:ua,children:"Other Expenses"}),o.jsx("button",{onClick:()=>bs("other_expense"),style:{padding:"2px 8px",background:"rgba(251,191,36,0.2)",border:"none",borderRadius:4,color:"#fbbf24",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),Ye.filter(u=>u.section==="other_expenses"||u.type==="other_expense").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:y=>Or(u.id,"label",y.target.value),style:{...nt,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:y=>Or(u.id,"value",y.target.value),style:{...jt,width:100,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>zi(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:12,marginBottom:6},children:[o.jsx("span",{style:ua,children:"Finance Costs"}),o.jsx("button",{onClick:()=>bs("finance"),style:{padding:"2px 8px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),Ye.filter(u=>u.section==="finance_costs"||u.type==="finance").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:y=>Or(u.id,"label",y.target.value),style:{...nt,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:y=>Or(u.id,"value",y.target.value),style:{...jt,width:100,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>zi(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""})]},u.id)),o.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:12,marginBottom:6},children:o.jsx("span",{style:ua,children:"Taxation"})}),Ye.filter(u=>u.section==="tax"||u.type==="tax").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:y=>Or(u.id,"label",y.target.value),style:{...nt,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:y=>Or(u.id,"value",y.target.value),style:{...jt,width:100,fontSize:11,padding:"4px 8px"}})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px",background:"linear-gradient(135deg, rgba(52,211,153,0.2), rgba(99,102,241,0.2))",borderRadius:6,marginTop:12},children:[o.jsx("span",{style:{fontWeight:700},children:"Net Profit / (Loss)"}),o.jsx("span",{style:{fontFamily:"monospace",fontWeight:700,color:tt.np>=0?"#34d399":"#f87171"},children:ae(tt.np)})]})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontWeight:700,fontSize:14},children:" Prior Year Balance Sheet"}),o.jsx("div",{style:{padding:"4px 10px",borderRadius:6,fontSize:10,fontWeight:600,background:tt.balanced?"rgba(52,211,153,0.15)":"rgba(239,68,68,0.15)",color:tt.balanced?"#34d399":"#f87171"},children:tt.balanced?" Balanced":`Diff: ${ae(tt.diff)}`})]}),o.jsxs("div",{style:{padding:16,maxHeight:400,overflowY:"auto"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[o.jsx("span",{style:ua,children:"Non-Current Assets"}),o.jsx("button",{onClick:()=>hl("nca"),style:{padding:"2px 8px",background:"rgba(99,102,241,0.2)",border:"none",borderRadius:4,color:"#a5b4fc",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),He.filter(u=>u.type==="nca").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:y=>Bn(u.id,"label",y.target.value),style:{...nt,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:y=>Bn(u.id,"value",y.target.value),style:{...jt,width:90,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>gl(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",fontSize:10,color:"#9ca3af"},children:[o.jsx("span",{children:"Total NCA"}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(tt.nca)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:10,marginBottom:6},children:[o.jsx("span",{style:ua,children:"Current Assets"}),o.jsx("button",{onClick:()=>hl("ca"),style:{padding:"2px 8px",background:"rgba(52,211,153,0.2)",border:"none",borderRadius:4,color:"#34d399",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),He.filter(u=>u.type==="ca").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:y=>Bn(u.id,"label",y.target.value),style:{...nt,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:y=>Bn(u.id,"value",y.target.value),style:{...jt,width:90,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>gl(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",fontSize:10,color:"#9ca3af"},children:[o.jsx("span",{children:"Total CA"}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(tt.ca)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"rgba(99,102,241,0.1)",borderRadius:6,fontWeight:600,fontSize:11,marginTop:8},children:[o.jsx("span",{children:"TOTAL ASSETS"}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(tt.totA)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:12,marginBottom:6},children:[o.jsx("span",{style:ua,children:"Non-Current Liabilities"}),o.jsx("button",{onClick:()=>hl("ncl"),style:{padding:"2px 8px",background:"rgba(251,191,36,0.2)",border:"none",borderRadius:4,color:"#fbbf24",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),He.filter(u=>u.type==="ncl").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:y=>Bn(u.id,"label",y.target.value),style:{...nt,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:y=>Bn(u.id,"value",y.target.value),style:{...jt,width:90,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>gl(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:10,marginBottom:6},children:[o.jsx("span",{style:ua,children:"Current Liabilities"}),o.jsx("button",{onClick:()=>hl("cl"),style:{padding:"2px 8px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),He.filter(u=>u.type==="cl").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:y=>Bn(u.id,"label",y.target.value),style:{...nt,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:y=>Bn(u.id,"value",y.target.value),style:{...jt,width:90,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>gl(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",fontSize:10,color:"#9ca3af"},children:[o.jsx("span",{children:"Total Liabilities"}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(tt.totL)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:10,marginBottom:6},children:[o.jsx("span",{style:ua,children:"Equity"}),o.jsx("button",{onClick:()=>hl("equity"),style:{padding:"2px 8px",background:"rgba(139,92,246,0.2)",border:"none",borderRadius:4,color:"#a78bfa",fontSize:9,cursor:"pointer"},children:"+ Add"})]}),He.filter(u=>u.type==="equity").map(u=>o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("input",{value:u.label,onChange:y=>Bn(u.id,"label",y.target.value),style:{...nt,flex:1,fontSize:11,padding:"4px 8px"}}),o.jsx("input",{type:"number",placeholder:"0",value:u.value,onChange:y=>Bn(u.id,"value",y.target.value),style:{...jt,width:90,fontSize:11,padding:"4px 8px"}}),u.custom&&o.jsx("button",{onClick:()=>gl(u.id),style:{padding:"2px 6px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:""})]},u.id)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",fontSize:10,color:"#9ca3af"},children:[o.jsx("span",{children:"Total Equity"}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(tt.totE)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"rgba(239,68,68,0.1)",borderRadius:6,fontWeight:600,fontSize:11,marginTop:8},children:[o.jsx("span",{children:"TOTAL L + E"}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(tt.totLE)})]}),o.jsxs("div",{style:{padding:10,background:tt.balanced?"rgba(52,211,153,0.1)":"rgba(251,191,36,0.1)",borderRadius:6,marginTop:12,fontSize:11},children:[o.jsx("div",{style:{fontWeight:700,color:tt.balanced?"#34d399":"#fbbf24",marginBottom:4},children:tt.balanced?" Balance Sheet is Balanced":" Not Balanced - Check entries"}),o.jsxs("div",{children:["Difference: ",ae(Math.abs(tt.totA-tt.totLE))]})]})]})]})]})]}),o.jsx("div",{style:{marginTop:16,padding:"16px 0"},children:ee?o.jsxs("div",{style:{padding:"14px 20px",background:"rgba(52,211,153,0.15)",border:"2px solid rgba(52,211,153,0.4)",borderRadius:8,textAlign:"center"},children:[o.jsx("div",{style:{color:"#34d399",fontWeight:700,fontSize:14},children:" Prior Year Balances Applied Successfully"}),o.jsx("div",{style:{color:"#9ca3af",fontSize:12,marginTop:4},children:'Opening balances have been updated. Click "Banks " above to continue.'})]}):o.jsx("button",{onClick:()=>{Cf(),I(!0)},disabled:tt.totA===0&&tt.totLE===0,style:{width:"100%",padding:"14px 20px",background:tt.totA>0||tt.totLE>0?"linear-gradient(135deg, #10b981, #059669)":"rgba(75,85,99,0.3)",border:"none",borderRadius:8,color:"#fff",fontSize:14,fontWeight:700,cursor:tt.totA>0||tt.totLE>0?"pointer":"not-allowed",boxShadow:tt.totA>0||tt.totLE>0?"0 4px 12px rgba(16,185,129,0.3)":"none"},children:" Apply Prior Year Balances to Opening Balances"})})]}),e==="review"&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:12,marginBottom:16},children:[(()=>{const u={};return _.forEach(y=>{const v=y.bankAccount||"Unknown";u[v]||(u[v]={count:0,credits:0,debits:0,net:0}),u[v].count++,y.amount>=0?u[v].credits+=y.amount:u[v].debits+=Math.abs(y.amount),u[v].net+=y.amount}),Object.entries(u).map(([y,v])=>o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",padding:12},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[o.jsxs("span",{style:{fontWeight:700,fontSize:12},children:[" ",y]}),o.jsxs("span",{style:{background:"rgba(99,102,241,0.2)",color:"#a5b4fc",padding:"2px 8px",borderRadius:10,fontSize:10},children:[v.count," txns"]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,fontSize:10},children:[o.jsxs("div",{style:{background:"rgba(52,211,153,0.1)",padding:"6px 8px",borderRadius:6},children:[o.jsx("div",{style:{color:"#9ca3af",fontSize:9},children:"Total Credits"}),o.jsx("div",{style:{fontFamily:"monospace",fontWeight:600,color:"#34d399"},children:ae(v.credits)})]}),o.jsxs("div",{style:{background:"rgba(239,68,68,0.1)",padding:"6px 8px",borderRadius:6},children:[o.jsx("div",{style:{color:"#9ca3af",fontSize:9},children:"Total Debits"}),o.jsx("div",{style:{fontFamily:"monospace",fontWeight:600,color:"#f87171"},children:ae(v.debits)})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:8,padding:"6px 8px",background:"rgba(99,102,241,0.1)",borderRadius:6},children:[o.jsx("span",{style:{fontSize:10,fontWeight:600},children:"Net Movement"}),o.jsx("span",{style:{fontFamily:"monospace",fontWeight:700,fontSize:11,color:v.net>=0?"#34d399":"#f87171"},children:ae(v.net)})]})]},y))})(),_.length>0&&o.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(99,102,241,0.2), rgba(139,92,246,0.2))",borderRadius:10,border:"1px solid rgba(99,102,241,0.3)",padding:12},children:[o.jsx("div",{style:{fontWeight:700,fontSize:12,marginBottom:8},children:" All Banks Total"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,fontSize:10},children:[o.jsxs("div",{children:[o.jsx("div",{style:{color:"#9ca3af",fontSize:9},children:"Total Credits"}),o.jsx("div",{style:{fontFamily:"monospace",fontWeight:600,color:"#34d399"},children:ae(_.filter(u=>u.amount>=0).reduce((u,y)=>u+y.amount,0))})]}),o.jsxs("div",{children:[o.jsx("div",{style:{color:"#9ca3af",fontSize:9},children:"Total Debits"}),o.jsx("div",{style:{fontFamily:"monospace",fontWeight:600,color:"#f87171"},children:ae(Math.abs(_.filter(u=>u.amount<0).reduce((u,y)=>u+y.amount,0)))})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:8,padding:"8px",background:"rgba(17,24,39,0.4)",borderRadius:6},children:[o.jsx("span",{style:{fontWeight:700},children:"Net Movement"}),o.jsx("span",{style:{fontFamily:"monospace",fontWeight:700,fontSize:12,color:_.reduce((u,y)=>u+y.amount,0)>=0?"#34d399":"#f87171"},children:ae(_.reduce((u,y)=>u+y.amount,0))})]})]})]}),_.length>0&&o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",marginBottom:16,overflow:"hidden"},children:[o.jsx("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",fontWeight:700,fontSize:12},children:" Monthly Breakdown by Bank"}),o.jsx("div",{style:{padding:12,overflowX:"auto"},children:o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:10},children:[o.jsx("thead",{children:o.jsxs("tr",{style:{background:"rgba(99,102,241,0.1)"},children:[o.jsx("th",{style:{padding:6,textAlign:"left",fontWeight:600},children:"Bank"}),pi.filter(u=>_.some(y=>y.month===u)).map(u=>o.jsx("th",{style:{padding:6,textAlign:"right",fontWeight:600},children:u},u)),o.jsx("th",{style:{padding:6,textAlign:"right",fontWeight:700,background:"rgba(139,92,246,0.1)"},children:"Total"})]})}),o.jsxs("tbody",{children:[(()=>{const u=[...new Set(_.map(v=>v.bankAccount||"Unknown"))],y=pi.filter(v=>_.some(S=>S.month===v));return u.map((v,S)=>{const T=_.filter(D=>(D.bankAccount||"Unknown")===v),W=T.reduce((D,C)=>D+C.amount,0);return o.jsxs("tr",{style:{background:S%2?"transparent":"rgba(17,24,39,0.3)"},children:[o.jsx("td",{style:{padding:6,fontWeight:600},children:v}),y.map(D=>{const C=T.filter(xe=>xe.month===D),O=C.reduce((xe,Re)=>xe+Re.amount,0),G=C.length;return o.jsx("td",{style:{padding:6,textAlign:"right"},children:G>0?o.jsxs("div",{children:[o.jsx("div",{style:{fontFamily:"monospace",color:O>=0?"#34d399":"#f87171"},children:ae(O)}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280"},children:[G," txns"]})]}):"-"},D)}),o.jsx("td",{style:{padding:6,textAlign:"right",fontWeight:700,fontFamily:"monospace",background:"rgba(139,92,246,0.1)",color:W>=0?"#34d399":"#f87171"},children:ae(W)})]},v)})})(),o.jsxs("tr",{style:{background:"rgba(99,102,241,0.15)",fontWeight:700},children:[o.jsx("td",{style:{padding:6},children:"TOTAL"}),pi.filter(u=>_.some(y=>y.month===u)).map(u=>{const v=_.filter(S=>S.month===u).reduce((S,T)=>S+T.amount,0);return o.jsx("td",{style:{padding:6,textAlign:"right",fontFamily:"monospace",color:v>=0?"#34d399":"#f87171"},children:ae(v)},u)}),o.jsx("td",{style:{padding:6,textAlign:"right",fontFamily:"monospace",background:"rgba(139,92,246,0.2)",color:_.reduce((u,y)=>u+y.amount,0)>=0?"#34d399":"#f87171"},children:ae(_.reduce((u,y)=>u+y.amount,0))})]})]})]})})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("button",{onClick:lr,style:Ya,children:" Upload"}),o.jsxs("span",{style:{fontWeight:700,fontSize:14},children:["Review Transactions (",_.length,")"]})]}),o.jsx("button",{onClick:or,style:sr,children:"Next: Classify "})]}),o.jsxs("div",{style:{padding:12,maxHeight:350,overflowY:"auto"},children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"70px 60px 1fr 60px 80px 50px 50px 20px",gap:4,padding:"6px 8px",background:"rgba(99,102,241,0.1)",borderRadius:4,fontSize:9,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Date"}),o.jsx("span",{children:"Bank"}),o.jsx("span",{children:"Description"}),o.jsx("span",{children:"Ref"}),o.jsx("span",{style:{textAlign:"right"},children:"Amount"}),o.jsx("span",{children:"Month"}),o.jsx("span",{children:"Class"}),o.jsx("span",{})]}),_.map((u,y)=>{const v=cn.classify(u.description);return o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"70px 60px 1fr 60px 80px 50px 50px 20px",gap:4,padding:"4px 8px",background:y%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:10},children:[o.jsx("input",{type:"date",value:u.date,onChange:S=>xl(y,"date",S.target.value),style:{...nt,padding:"2px 4px",fontSize:9}}),o.jsx("span",{style:{fontSize:9,color:"#9ca3af"},children:u.bankAccount?.substring(0,6)}),o.jsx("input",{value:u.description,onChange:S=>xl(y,"description",S.target.value),style:{...nt,padding:"2px 4px",fontSize:9}}),o.jsx("span",{style:{fontSize:9,color:"#6b7280"},children:u.reference?.substring(0,8)}),o.jsx("input",{type:"number",value:u.amount,onChange:S=>xl(y,"amount",S.target.value),style:{...jt,padding:"2px 4px",fontSize:9,color:u.amount>=0?"#34d399":"#f87171"}}),o.jsx("span",{style:{fontSize:9,color:"#6b7280"},children:u.month}),o.jsx("span",{style:{background:v.code==="SUSPENSE"?"rgba(251,191,36,0.2)":"rgba(139,92,246,0.2)",color:v.code==="SUSPENSE"?"#fbbf24":"#c4b5fd",padding:"1px 3px",borderRadius:2,fontSize:7,textAlign:"center"},children:v.code.substring(0,5)}),o.jsx("button",{onClick:()=>Rf(y),style:{width:16,height:16,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:9},children:""})]},y)})]})]})]}),e==="classify"&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("button",{onClick:lr,style:Ya,children:" Review"}),o.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[o.jsx("span",{style:{fontSize:11,color:"#9ca3af"},children:"Review auto-classifications and correct if needed"}),o.jsx("button",{onClick:or,style:sr,children:"Next: Subledger "})]})]}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:12,marginBottom:16},children:(()=>{const u={};_.forEach(v=>{const S=v.classification||cn.classify(v.description).code;u[S]||(u[S]={count:0,total:0}),u[S].count++,u[S].total+=v.amount});const y={SALES:"#34d399",PURCHASE:"#f87171",SALARY:"#fbbf24",RENT:"#a78bfa",UTILITIES:"#60a5fa",BANK_CHARGES:"#f472b6",TRANSFER:"#94a3b8",SUSPENSE:"#fbbf24",LOAN:"#c084fc",FIXED_ASSET:"#2dd4bf",INTEREST_INC:"#4ade80",INTEREST_EXP:"#fb7185",PAY_SUPPLIER:"#f97316",PAY_CREDITOR:"#fb923c",LOAN_REPAY_ST:"#a855f7",LOAN_REPAY_LT:"#8b5cf6",TAX_PAYMENT:"#ef4444",GST_SST:"#f43f5e",RECEIPT_DEBTOR:"#22c55e",DEPOSIT_RECEIVED:"#14b8a6",LOAN_DRAWDOWN:"#06b6d4",DUITNOW_OUT:"#64748b",DRAWINGS:"#ec4899",CAPITAL:"#10b981"};return Object.entries(u).sort((v,S)=>S[1].count-v[1].count).map(([v,S])=>o.jsxs("div",{onClick:()=>z(F===v?"ALL":v),style:{background:F===v?"rgba(99,102,241,0.3)":"rgba(31,41,55,0.6)",borderRadius:8,border:F===v?"2px solid rgba(99,102,241,0.6)":"1px solid rgba(75,85,99,0.3)",padding:10,cursor:"pointer",transition:"all 0.2s"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[o.jsx("span",{style:{fontSize:10,fontWeight:700,color:y[v]||"#9ca3af"},children:v}),o.jsx("span",{style:{background:"rgba(99,102,241,0.2)",color:"#a5b4fc",padding:"1px 6px",borderRadius:8,fontSize:9},children:S.count})]}),o.jsx("div",{style:{fontFamily:"monospace",fontSize:11,fontWeight:600,color:S.total>=0?"#34d399":"#f87171"},children:ae(S.total)})]},v))})()}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:10},children:[o.jsx("span",{style:{fontWeight:700,fontSize:14},children:" Transaction Classifications"}),o.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[o.jsx("input",{type:"text",placeholder:" Search description...",value:K,onChange:u=>M(u.target.value),style:{padding:"5px 10px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.4)",borderRadius:6,color:"#e5e7eb",fontSize:10,width:150}}),o.jsxs("select",{value:F,onChange:u=>z(u.target.value),style:{padding:"5px 10px",background:"rgba(99,102,241,0.15)",border:"1px solid rgba(99,102,241,0.3)",borderRadius:6,color:"#a5b4fc",fontSize:10,cursor:"pointer"},children:[o.jsx("option",{value:"ALL",children:"All Classifications"}),o.jsx("option",{value:"SUSPENSE",children:" Unclassified Only"}),o.jsx("optgroup",{label:" Revenue",children:Yt.income.revenue.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsx("optgroup",{label:" Cost of Sales",children:Yt.income.cost_of_sales.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsx("optgroup",{label:" Operating Expenses",children:Yt.income.operating_expenses.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsx("optgroup",{label:" Other Income",children:Yt.income.other_income.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsx("optgroup",{label:" Other Expenses",children:Yt.income.other_expenses.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsx("optgroup",{label:" Finance Costs",children:Yt.income.finance_costs.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsxs("optgroup",{label:" Balance Sheet",children:[o.jsx("option",{value:"FIXED_ASSET",children:"Fixed Asset Purchase"}),o.jsx("option",{value:"LOAN",children:"Loan/Borrowing (Legacy)"}),o.jsx("option",{value:"CAPITAL",children:"Capital Injection"}),o.jsx("option",{value:"DRAWINGS",children:"Drawings"}),o.jsx("option",{value:"GST_SST",children:"GST/SST"})]}),o.jsxs("optgroup",{label:" Payments (Reduce Liabilities)",children:[o.jsx("option",{value:"PAY_SUPPLIER",children:"Payment to Supplier ( AP)"}),o.jsx("option",{value:"PAY_CREDITOR",children:"Payment to Creditor ( Other Pay)"}),o.jsx("option",{value:"LOAN_REPAY_ST",children:"Loan Repayment - ST ( ST Borr)"}),o.jsx("option",{value:"LOAN_REPAY_LT",children:"Loan Repayment - LT ( LT Borr)"}),o.jsx("option",{value:"TAX_PAYMENT",children:"Tax Payment ( Tax Pay)"})]}),o.jsxs("optgroup",{label:" Receipts (Reduce Assets/Increase Liab)",children:[o.jsx("option",{value:"RECEIPT_DEBTOR",children:"Receipt from Debtor ( AR)"}),o.jsx("option",{value:"DEPOSIT_RECEIVED",children:"Deposit Received ( Other Pay)"}),o.jsx("option",{value:"LOAN_DRAWDOWN",children:"Loan Drawdown ( Borrowings)"})]}),o.jsxs("optgroup",{label:" Other",children:[o.jsx("option",{value:"TRANSFER",children:"Transfer (Internal)"}),o.jsx("option",{value:"DUITNOW_OUT",children:"DuitNow"})]})]}),(F!=="ALL"||K)&&o.jsx("button",{onClick:()=>{z("ALL"),M("")},style:{padding:"5px 10px",background:"rgba(239,68,68,0.15)",border:"1px solid rgba(239,68,68,0.3)",borderRadius:6,color:"#fca5a5",fontSize:10,cursor:"pointer"},children:" Clear"}),o.jsxs("span",{style:{fontSize:10,color:"#fbbf24",background:"rgba(251,191,36,0.1)",padding:"4px 8px",borderRadius:4},children:[" ",_.filter(u=>(u.classification||cn.classify(u.description).code)==="SUSPENSE").length," unclassified"]})]})]}),o.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"rgba(99,102,241,0.05)",display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("input",{type:"checkbox",checked:(()=>{const u=_.map((y,v)=>({tx:y,i:v})).filter(({tx:y})=>{const v=y.classification||cn.classify(y.description).code,S=F==="ALL"||v===F,T=!K||y.description.toLowerCase().includes(K.toLowerCase());return S&&T}).map(({i:y})=>y);return u.length>0&&u.every(y=>ie.has(y))})(),onChange:u=>{const y=_.map((v,S)=>({tx:v,i:S})).filter(({tx:v})=>{const S=v.classification||cn.classify(v.description).code,T=F==="ALL"||S===F,W=!K||v.description.toLowerCase().includes(K.toLowerCase());return T&&W}).map(({i:v})=>v);if(u.target.checked)se(new Set([...ie,...y]));else{const v=new Set(ie);y.forEach(S=>v.delete(S)),se(v)}},style:{width:16,height:16,cursor:"pointer"}}),o.jsx("span",{style:{fontSize:11,color:"#a5b4fc",fontWeight:600},children:ie.size>0?`${ie.size} selected`:"Select All"})]}),ie.size>0&&o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{height:20,width:1,background:"rgba(75,85,99,0.5)"}}),o.jsx("span",{style:{fontSize:10,color:"#9ca3af"},children:"Bulk classify to:"}),o.jsxs("select",{value:ne,onChange:u=>H(u.target.value),style:{padding:"5px 10px",background:"rgba(52,211,153,0.15)",border:"1px solid rgba(52,211,153,0.3)",borderRadius:6,color:"#34d399",fontSize:10,cursor:"pointer",minWidth:150},children:[o.jsx("option",{value:"",children:"-- Select Classification --"}),o.jsx("optgroup",{label:" Revenue",children:Yt.income.revenue.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsx("optgroup",{label:" Cost of Sales",children:Yt.income.cost_of_sales.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsx("optgroup",{label:" Other Income",children:Yt.income.other_income.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsx("optgroup",{label:" Operating Expenses",children:Yt.income.operating_expenses.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsx("optgroup",{label:" Other Expenses",children:Yt.income.other_expenses.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsx("optgroup",{label:" Finance Costs",children:Yt.income.finance_costs.map(u=>o.jsx("option",{value:u.id,children:u.label},u.id))}),o.jsxs("optgroup",{label:" Balance Sheet",children:[o.jsx("option",{value:"FIXED_ASSET",children:"Fixed Asset Purchase"}),o.jsx("option",{value:"LOAN",children:"Loan/Borrowing (Legacy)"}),o.jsx("option",{value:"CAPITAL",children:"Capital Injection"}),o.jsx("option",{value:"DRAWINGS",children:"Drawings"})]}),o.jsxs("optgroup",{label:" Payments ( Liabilities)",children:[o.jsx("option",{value:"PAY_SUPPLIER",children:"Payment to Supplier ( AP)"}),o.jsx("option",{value:"PAY_CREDITOR",children:"Payment to Creditor ( Other Pay)"}),o.jsx("option",{value:"LOAN_REPAY_ST",children:"Loan Repayment - ST"}),o.jsx("option",{value:"LOAN_REPAY_LT",children:"Loan Repayment - LT"}),o.jsx("option",{value:"TAX_PAYMENT",children:"Tax Payment"}),o.jsx("option",{value:"GST_SST",children:"GST/SST Payment"})]}),o.jsxs("optgroup",{label:" Receipts",children:[o.jsx("option",{value:"RECEIPT_DEBTOR",children:"Receipt from Debtor ( AR)"}),o.jsx("option",{value:"DEPOSIT_RECEIVED",children:"Deposit Received"}),o.jsx("option",{value:"LOAN_DRAWDOWN",children:"Loan Drawdown"})]}),o.jsxs("optgroup",{label:" Others",children:[o.jsx("option",{value:"TRANSFER",children:"Transfer (Internal)"}),o.jsx("option",{value:"DUITNOW_OUT",children:"DuitNow"}),o.jsx("option",{value:"SUSPENSE",children:"Suspense"})]})]}),o.jsxs("button",{onClick:()=>{ne&&(w(u=>u.map((y,v)=>ie.has(v)?{...y,classification:ne}:y)),se(new Set),H(""))},disabled:!ne,style:{padding:"6px 14px",background:ne?"linear-gradient(135deg, #10b981, #059669)":"rgba(75,85,99,0.3)",border:"none",borderRadius:6,color:"#fff",fontSize:10,fontWeight:600,cursor:ne?"pointer":"not-allowed"},children:[" Apply to ",ie.size," items"]}),o.jsx("button",{onClick:()=>{w(u=>u.filter((y,v)=>!ie.has(v))),se(new Set)},style:{padding:"6px 14px",background:"rgba(239,68,68,0.2)",border:"1px solid rgba(239,68,68,0.3)",borderRadius:6,color:"#f87171",fontSize:10,fontWeight:600,cursor:"pointer"},children:" Delete Selected"}),o.jsx("button",{onClick:()=>se(new Set),style:{padding:"6px 10px",background:"transparent",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#9ca3af",fontSize:10,cursor:"pointer"},children:"Clear Selection"})]})]}),o.jsxs("div",{style:{padding:12,maxHeight:400,overflowY:"auto"},children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"30px 70px 1fr 100px 120px 30px",gap:4,padding:"6px 8px",background:"rgba(99,102,241,0.1)",borderRadius:4,fontSize:9,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{}),o.jsx("span",{children:"Date"}),o.jsx("span",{children:"Description"}),o.jsx("span",{style:{textAlign:"right"},children:"Amount"}),o.jsx("span",{children:"Classification"}),o.jsx("span",{})]}),(()=>{const u=_.map((y,v)=>({...y,originalIndex:v})).filter(y=>{const v=y.classification||cn.classify(y.description).code,S=F==="ALL"||v===F,T=!K||y.description.toLowerCase().includes(K.toLowerCase());return S&&T});return u.length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#9ca3af",fontSize:12},children:"No transactions match the current filter."}):u.map((y,v)=>{const S=y.originalIndex,T=cn.classify(y.description),W=y.classification||T.code,D=ie.has(S);return o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"30px 70px 1fr 100px 120px 30px",gap:4,padding:"6px 8px",background:D?"rgba(99,102,241,0.2)":v%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:10,borderLeft:W==="SUSPENSE"?"3px solid #fbbf24":D?"3px solid #6366f1":"3px solid transparent"},children:[o.jsx("input",{type:"checkbox",checked:D,onChange:C=>{const O=new Set(ie);C.target.checked?O.add(S):O.delete(S),se(O)},style:{width:14,height:14,cursor:"pointer"}}),o.jsx("span",{style:{color:"#9ca3af"},children:y.date}),o.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:y.description,children:y.description}),o.jsx("input",{type:"number",value:y.amount,onChange:C=>xl(S,"amount",C.target.value),style:{...jt,padding:"3px 6px",fontSize:10,textAlign:"right",color:y.amount>=0?"#34d399":"#f87171",background:"rgba(17,24,39,0.5)"}}),o.jsxs("select",{value:W,onChange:C=>xl(S,"classification",C.target.value),style:{background:W==="SUSPENSE"?"rgba(251,191,36,0.2)":"rgba(99,102,241,0.1)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:4,padding:"3px 6px",color:W==="SUSPENSE"?"#fbbf24":"#e5e7eb",fontSize:9,cursor:"pointer"},children:[o.jsxs("optgroup",{label:" Revenue & Income",children:[o.jsx("option",{value:"SALES",children:"SALES (Revenue)"}),o.jsx("option",{value:"INTEREST_INC",children:"INTEREST INCOME"}),o.jsx("option",{value:"DIVIDEND_INC",children:"DIVIDEND INCOME"}),o.jsx("option",{value:"RENTAL_INC",children:"RENTAL INCOME"}),o.jsx("option",{value:"OTHER_INCOME",children:"OTHER INCOME"})]}),o.jsxs("optgroup",{label:" Cost of Sales",children:[o.jsx("option",{value:"PURCHASE",children:"PURCHASE (COGS)"}),o.jsx("option",{value:"FREIGHT_IN",children:"FREIGHT IN"})]}),o.jsxs("optgroup",{label:" Staff Costs",children:[o.jsx("option",{value:"SALARY",children:"SALARY & WAGES"}),o.jsx("option",{value:"EPF",children:"EPF/KWSP"}),o.jsx("option",{value:"SOCSO",children:"SOCSO/EIS"}),o.jsx("option",{value:"HRDF",children:"HRDF"})]}),o.jsxs("optgroup",{label:" Premises",children:[o.jsx("option",{value:"RENT",children:"RENT & LEASE"}),o.jsx("option",{value:"UTILITIES",children:"UTILITIES (TNB/Water)"}),o.jsx("option",{value:"TELEPHONE",children:"TELEPHONE & INTERNET"})]}),o.jsxs("optgroup",{label:" Marketing & Sales",children:[o.jsx("option",{value:"ADVERTISING",children:"ADVERTISING & MARKETING"}),o.jsx("option",{value:"ENTERTAINMENT",children:"ENTERTAINMENT"}),o.jsx("option",{value:"TRAVEL",children:"TRAVEL & TRANSPORT"})]}),o.jsxs("optgroup",{label:" Professional",children:[o.jsx("option",{value:"PROFESSIONAL_FEE",children:"PROFESSIONAL FEES"}),o.jsx("option",{value:"LICENSE_FEE",children:"LICENSE & SUBSCRIPTION"}),o.jsx("option",{value:"INSURANCE",children:"INSURANCE"})]}),o.jsxs("optgroup",{label:" Office & General",children:[o.jsx("option",{value:"OFFICE_SUPPLIES",children:"OFFICE SUPPLIES"}),o.jsx("option",{value:"REPAIR_MAINTENANCE",children:"REPAIR & MAINTENANCE"}),o.jsx("option",{value:"CLEANING",children:"CLEANING"}),o.jsx("option",{value:"DEPRECIATION",children:"DEPRECIATION"}),o.jsx("option",{value:"BAD_DEBT",children:"BAD DEBT"}),o.jsx("option",{value:"OTHER_EXPENSE",children:"OTHER EXPENSE"})]}),o.jsxs("optgroup",{label:" Finance",children:[o.jsx("option",{value:"BANK_CHARGES",children:"BANK CHARGES"}),o.jsx("option",{value:"INTEREST_EXP",children:"INTEREST EXPENSE"})]}),o.jsxs("optgroup",{label:" Balance Sheet",children:[o.jsx("option",{value:"FIXED_ASSET",children:"FIXED ASSET"}),o.jsx("option",{value:"LOAN",children:"LOAN (Legacy)"}),o.jsx("option",{value:"CAPITAL",children:"CAPITAL/DIRECTOR LOAN"}),o.jsx("option",{value:"DRAWINGS",children:"DRAWINGS"})]}),o.jsxs("optgroup",{label:" Payments ( Liabilities)",children:[o.jsx("option",{value:"PAY_SUPPLIER",children:"PAY SUPPLIER ( AP)"}),o.jsx("option",{value:"PAY_CREDITOR",children:"PAY CREDITOR ( Other Pay)"}),o.jsx("option",{value:"LOAN_REPAY_ST",children:"LOAN REPAY - ST"}),o.jsx("option",{value:"LOAN_REPAY_LT",children:"LOAN REPAY - LT"}),o.jsx("option",{value:"TAX_PAYMENT",children:"TAX PAYMENT"}),o.jsx("option",{value:"GST_SST",children:"GST/SST PAYMENT"})]}),o.jsxs("optgroup",{label:" Receipts",children:[o.jsx("option",{value:"RECEIPT_DEBTOR",children:"RECEIPT FROM DEBTOR ( AR)"}),o.jsx("option",{value:"DEPOSIT_RECEIVED",children:"DEPOSIT RECEIVED"}),o.jsx("option",{value:"LOAN_DRAWDOWN",children:"LOAN DRAWDOWN"})]}),o.jsxs("optgroup",{label:" Others",children:[o.jsx("option",{value:"TRANSFER",children:"TRANSFER (Internal)"}),o.jsx("option",{value:"DUITNOW_OUT",children:"DUITNOW"}),o.jsx("option",{value:"SUSPENSE",children:" SUSPENSE (Unclassified)"})]})]}),o.jsx("button",{onClick:()=>w(C=>C.filter((O,G)=>G!==S)),style:{width:20,height:20,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:3,color:"#f87171",cursor:"pointer",fontSize:10},title:"Delete transaction",children:""})]},S)})})()]}),(F!=="ALL"||K)&&o.jsxs("div",{style:{padding:"8px 16px",borderTop:"1px solid rgba(75,85,99,0.2)",background:"rgba(99,102,241,0.1)",fontSize:10,color:"#a5b4fc"},children:["Showing ",_.filter(u=>{const y=u.classification||cn.classify(u.description).code,v=F==="ALL"||y===F,S=!K||u.description.toLowerCase().includes(K.toLowerCase());return v&&S}).length," of ",_.length," transactions",F!=="ALL"&&o.jsxs("span",{children:["  Filter: ",o.jsx("strong",{children:F})]}),K&&o.jsxs("span",{children:["  Search: ",o.jsxs("strong",{children:['"',K,'"']})]})]})]}),o.jsx("div",{style:{marginTop:16,padding:12,background:"rgba(99,102,241,0.1)",borderRadius:8,border:"1px solid rgba(99,102,241,0.2)"},children:o.jsxs("div",{style:{fontSize:11,color:"#a5b4fc"},children:[" ",o.jsx("strong",{children:"Tip:"})," Click on a category card above to filter by that classification. Use the search box to find specific transactions. Review transactions marked as SUSPENSE (yellow) and assign the correct classification. You can also ",o.jsx("strong",{children:"edit amounts"})," if the sign is wrong (positive = credit/inflow, negative = debit/outflow)."]})})]}),e==="cashvoucher"&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("button",{onClick:lr,style:Ya,children:" Classify"}),o.jsx("button",{onClick:or,style:sr,children:"Subledger "})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:12,marginBottom:16},children:[o.jsxs("div",{style:{background:"rgba(52,211,153,0.1)",border:"1px solid rgba(52,211,153,0.3)",borderRadius:8,padding:12,textAlign:"center"},children:[o.jsx("div",{style:{fontSize:10,color:"#34d399",marginBottom:4},children:"Cash In"}),o.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#34d399"},children:ae(N.filter(u=>u.amount>0).reduce((u,y)=>u+y.amount,0))})]}),o.jsxs("div",{style:{background:"rgba(239,68,68,0.1)",border:"1px solid rgba(239,68,68,0.3)",borderRadius:8,padding:12,textAlign:"center"},children:[o.jsx("div",{style:{fontSize:10,color:"#f87171",marginBottom:4},children:"Cash Out"}),o.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#f87171"},children:ae(Math.abs(N.filter(u=>u.amount<0).reduce((u,y)=>u+y.amount,0)))})]}),o.jsxs("div",{style:{background:"rgba(99,102,241,0.1)",border:"1px solid rgba(99,102,241,0.3)",borderRadius:8,padding:12,textAlign:"center"},children:[o.jsx("div",{style:{fontSize:10,color:"#a5b4fc",marginBottom:4},children:"Net Cash"}),o.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#a5b4fc"},children:ae(N.reduce((u,y)=>u+y.amount,0))})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:12,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(251,191,36,0.1), rgba(245,158,11,0.1))"},children:o.jsx("div",{style:{fontWeight:700,fontSize:14},children:" Add Cash Voucher"})}),o.jsxs("div",{style:{padding:16,display:"flex",flexDirection:"column",gap:10},children:[o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Date"}),o.jsx("input",{type:"date",value:Dt.date,onChange:u=>yt(y=>({...y,date:u.target.value})),style:{width:"100%",padding:"8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:12,boxSizing:"border-box"}})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Type"}),o.jsxs("select",{value:Dt.type,onChange:u=>yt(y=>({...y,type:u.target.value})),style:{width:"100%",padding:"8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:12},children:[o.jsx("option",{value:"in",children:" Cash Received"}),o.jsx("option",{value:"out",children:" Cash Paid"}),o.jsx("option",{value:"bank_to_cash",children:" Bank to Cash"}),o.jsx("option",{value:"cash_to_bank",children:" Cash to Bank"})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Description"}),o.jsx("input",{type:"text",value:Dt.description,onChange:u=>yt(y=>({...y,description:u.target.value})),placeholder:"e.g. Office supplies",style:{width:"100%",padding:"8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:12,boxSizing:"border-box"}})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Reference"}),o.jsx("input",{type:"text",value:Dt.reference,onChange:u=>yt(y=>({...y,reference:u.target.value})),style:{width:"100%",padding:"8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:12,boxSizing:"border-box"}})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Amount (RM)"}),o.jsx("input",{type:"number",value:Dt.amount,onChange:u=>yt(y=>({...y,amount:u.target.value})),placeholder:"0.00",step:"0.01",style:{width:"100%",padding:"8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:12,textAlign:"right",boxSizing:"border-box"}})]})]}),!Dt.type.includes("bank")&&o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Classification"}),o.jsxs("select",{value:Dt.classification,onChange:u=>yt(y=>({...y,classification:u.target.value})),style:{width:"100%",padding:"8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select --"}),o.jsx("option",{value:"SALES",children:"Sales Revenue"}),o.jsx("option",{value:"OTHER_INCOME",children:"Other Income"}),o.jsx("option",{value:"PURCHASE",children:"Purchases / COGS"}),o.jsx("option",{value:"OFFICE_SUPPLIES",children:"Office Supplies"}),o.jsx("option",{value:"TRAVEL",children:"Travel"}),o.jsx("option",{value:"ENTERTAINMENT",children:"Entertainment"}),o.jsx("option",{value:"UTILITIES",children:"Utilities"}),o.jsx("option",{value:"MISCELLANEOUS",children:"Misc Expense"}),o.jsx("option",{value:"DRAWINGS",children:"Drawings"}),o.jsx("option",{value:"SUSPENSE",children:"Suspense"})]})]}),(()=>{const u=C0();return u?o.jsxs("div",{style:{marginTop:8,padding:8,background:"rgba(99,102,241,0.1)",border:"1px solid rgba(99,102,241,0.2)",borderRadius:6},children:[o.jsx("div",{style:{fontSize:9,color:"#a5b4fc",fontWeight:600,marginBottom:6},children:" Suggested Double Entry:"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:4,fontSize:10},children:[o.jsxs("span",{children:["Dr: ",u.drAcc]}),o.jsx("span",{style:{fontFamily:"monospace",color:"#34d399"},children:ae(u.amt)}),o.jsxs("span",{style:{paddingLeft:12},children:["Cr: ",u.crAcc]}),o.jsx("span",{style:{fontFamily:"monospace",color:"#f87171"},children:ae(u.amt)})]})]}):null})(),o.jsx("button",{onClick:Es,style:{width:"100%",padding:"10px",background:"linear-gradient(135deg, #fbbf24, #f59e0b)",border:"none",borderRadius:6,color:"#1f2937",fontSize:12,fontWeight:700,cursor:"pointer",marginTop:8},children:"+ Add Cash Voucher"})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:12,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:o.jsxs("div",{children:[o.jsx("span",{style:{fontWeight:700,fontSize:14},children:" Cash Vouchers"}),o.jsx("span",{style:{marginLeft:8,background:"rgba(251,191,36,0.2)",color:"#fbbf24",padding:"2px 8px",borderRadius:8,fontSize:10},children:N.length})]})}),o.jsx("div",{style:{maxHeight:400,overflowY:"auto"},children:N.length>0?o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:11},children:[o.jsx("thead",{children:o.jsxs("tr",{style:{background:"rgba(99,102,241,0.1)"},children:[o.jsx("th",{style:{padding:8,textAlign:"left",borderBottom:"1px solid rgba(75,85,99,0.3)"},children:"Date"}),o.jsx("th",{style:{padding:8,textAlign:"left",borderBottom:"1px solid rgba(75,85,99,0.3)"},children:"Ref"}),o.jsx("th",{style:{padding:8,textAlign:"left",borderBottom:"1px solid rgba(75,85,99,0.3)"},children:"Description"}),o.jsx("th",{style:{padding:8,textAlign:"left",borderBottom:"1px solid rgba(75,85,99,0.3)"},children:"Class"}),o.jsx("th",{style:{padding:8,textAlign:"right",borderBottom:"1px solid rgba(75,85,99,0.3)"},children:"In"}),o.jsx("th",{style:{padding:8,textAlign:"right",borderBottom:"1px solid rgba(75,85,99,0.3)"},children:"Out"}),o.jsx("th",{style:{padding:8,borderBottom:"1px solid rgba(75,85,99,0.3)"}})]})}),o.jsx("tbody",{children:N.map((u,y)=>o.jsxs("tr",{style:{borderBottom:"1px solid rgba(75,85,99,0.2)"},children:[o.jsx("td",{style:{padding:8},children:u.date}),o.jsx("td",{style:{padding:8,color:"#a5b4fc"},children:u.reference}),o.jsx("td",{style:{padding:8},children:u.description}),o.jsx("td",{style:{padding:8},children:o.jsxs("select",{value:u.classification||"",onChange:v=>k(S=>S.map((T,W)=>W===y?{...T,classification:v.target.value}:T)),style:{padding:"4px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:4,color:"#e5e7eb",fontSize:10},children:[o.jsx("option",{value:"",children:"--"}),o.jsx("option",{value:"SALES",children:"Sales"}),o.jsx("option",{value:"OTHER_INCOME",children:"Other Income"}),o.jsx("option",{value:"PURCHASE",children:"Purchases"}),o.jsx("option",{value:"OFFICE_SUPPLIES",children:"Office Supplies"}),o.jsx("option",{value:"TRAVEL",children:"Travel"}),o.jsx("option",{value:"UTILITIES",children:"Utilities"}),o.jsx("option",{value:"MISCELLANEOUS",children:"Misc Expense"}),o.jsx("option",{value:"DRAWINGS",children:"Drawings"}),o.jsx("option",{value:"CASH_TRANSFER",children:"Transfer"}),o.jsx("option",{value:"SUSPENSE",children:"Suspense"})]})}),o.jsx("td",{style:{padding:8,textAlign:"right",color:"#34d399",fontFamily:"monospace"},children:u.amount>0?ae(u.amount):"-"}),o.jsx("td",{style:{padding:8,textAlign:"right",color:"#f87171",fontFamily:"monospace"},children:u.amount<0?ae(Math.abs(u.amount)):"-"}),o.jsx("td",{style:{padding:8},children:o.jsx("button",{onClick:()=>k(v=>v.filter((S,T)=>T!==y)),style:{padding:"2px 6px",background:"rgba(239,68,68,0.15)",border:"none",borderRadius:4,color:"#fca5a5",fontSize:10,cursor:"pointer"},children:""})})]},y))}),o.jsx("tfoot",{children:o.jsxs("tr",{style:{background:"rgba(99,102,241,0.1)",fontWeight:600},children:[o.jsx("td",{colSpan:4,style:{padding:8},children:"TOTAL"}),o.jsx("td",{style:{padding:8,textAlign:"right",color:"#34d399"},children:ae(N.filter(u=>u.amount>0).reduce((u,y)=>u+y.amount,0))}),o.jsx("td",{style:{padding:8,textAlign:"right",color:"#f87171"},children:ae(Math.abs(N.filter(u=>u.amount<0).reduce((u,y)=>u+y.amount,0)))}),o.jsx("td",{})]})})]}):o.jsxs("div",{style:{padding:40,textAlign:"center",color:"#6b7280"},children:[o.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),o.jsx("div",{style:{fontSize:12},children:"No cash vouchers yet"}),o.jsx("div",{style:{fontSize:10},children:"Add petty cash transactions"})]})})]})]}),o.jsxs("div",{style:{marginTop:16,padding:12,background:"rgba(251,191,36,0.1)",border:"1px solid rgba(251,191,36,0.3)",borderRadius:8,fontSize:11,color:"#fbbf24"},children:[o.jsx("strong",{children:" Cash Vouchers"})," are for petty cash transactions that don't go through the bank."]})]}),e==="subledger"&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("button",{onClick:lr,style:Ya,children:" Cash"}),o.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[o.jsx("button",{onClick:I0,style:{padding:"6px 12px",background:"linear-gradient(135deg, #059669, #10b981)",border:"none",borderRadius:6,color:"#fff",fontSize:11,cursor:"pointer",fontWeight:600},children:" Export All (Excel)"}),o.jsx("button",{onClick:B0,style:{padding:"6px 12px",background:"rgba(5,150,105,0.3)",border:"1px solid rgba(16,185,129,0.5)",borderRadius:6,color:"#34d399",fontSize:11,cursor:"pointer",fontWeight:600},children:" Export All (CSV)"}),o.jsx("button",{onClick:()=>Of("xlsx"),style:{padding:"6px 12px",background:"linear-gradient(135deg, #0891b2, #06b6d4)",border:"none",borderRadius:6,color:"#fff",fontSize:11,cursor:"pointer",fontWeight:600},children:" Export COA"}),o.jsx("button",{onClick:or,style:sr,children:"Next: Opening Balances "})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:10,marginBottom:16},children:[o.jsxs("div",{style:{background:"rgba(99,102,241,0.1)",borderRadius:10,border:"1px solid rgba(99,102,241,0.3)",padding:10,position:"relative"},children:[o.jsxs("div",{style:{position:"absolute",top:6,right:6,display:"flex",gap:2},children:[o.jsx("button",{onClick:()=>no("xlsx"),title:"Export Excel",style:{padding:"2px 4px",background:"rgba(99,102,241,0.4)",border:"none",borderRadius:3,color:"#a5b4fc",fontSize:8,cursor:"pointer"},children:"XLS"}),o.jsx("button",{onClick:()=>no("csv"),title:"Export CSV",style:{padding:"2px 4px",background:"rgba(99,102,241,0.2)",border:"none",borderRadius:3,color:"#a5b4fc",fontSize:8,cursor:"pointer"},children:"CSV"})]}),o.jsx("div",{style:{fontSize:9,color:"#9ca3af"},children:"PPE (NBV) - GL 1000"}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#a5b4fc",fontFamily:"monospace"},children:ae(rt.ppe.nbv).replace("MYR ","")}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280"},children:[ft.length," assets"]})]}),o.jsxs("div",{style:{background:"rgba(52,211,153,0.1)",borderRadius:10,border:"1px solid rgba(52,211,153,0.3)",padding:10,position:"relative"},children:[o.jsxs("div",{style:{position:"absolute",top:6,right:6,display:"flex",gap:2},children:[o.jsx("button",{onClick:()=>ri("xlsx"),title:"Export Excel",style:{padding:"2px 4px",background:"rgba(52,211,153,0.4)",border:"none",borderRadius:3,color:"#34d399",fontSize:8,cursor:"pointer"},children:"XLS"}),o.jsx("button",{onClick:()=>ri("csv"),title:"Export CSV",style:{padding:"2px 4px",background:"rgba(52,211,153,0.2)",border:"none",borderRadius:3,color:"#34d399",fontSize:8,cursor:"pointer"},children:"CSV"})]}),o.jsx("div",{style:{fontSize:9,color:"#9ca3af"},children:"Inventory - GL 1500"}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#34d399",fontFamily:"monospace"},children:ae(rt.inventory).replace("MYR ","")}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280"},children:[pr.length," items"]})]}),o.jsxs("div",{style:{background:"rgba(251,191,36,0.1)",borderRadius:10,border:"1px solid rgba(251,191,36,0.3)",padding:10,position:"relative"},children:[o.jsxs("div",{style:{position:"absolute",top:6,right:6,display:"flex",gap:2},children:[o.jsx("button",{onClick:()=>Si("xlsx"),title:"Export Excel",style:{padding:"2px 4px",background:"rgba(251,191,36,0.4)",border:"none",borderRadius:3,color:"#fbbf24",fontSize:8,cursor:"pointer"},children:"XLS"}),o.jsx("button",{onClick:()=>Si("csv"),title:"Export CSV",style:{padding:"2px 4px",background:"rgba(251,191,36,0.2)",border:"none",borderRadius:3,color:"#fbbf24",fontSize:8,cursor:"pointer"},children:"CSV"})]}),o.jsx("div",{style:{fontSize:9,color:"#9ca3af"},children:"Trade Receivables - GL 1600"}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#fbbf24",fontFamily:"monospace"},children:ae(rt.receivables).replace("MYR ","")}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280"},children:[Aa.length," customers"]})]}),o.jsxs("div",{style:{background:"rgba(139,92,246,0.1)",borderRadius:10,border:"1px solid rgba(139,92,246,0.3)",padding:10,position:"relative"},children:[o.jsxs("div",{style:{position:"absolute",top:6,right:6,display:"flex",gap:2},children:[o.jsx("button",{onClick:()=>io("xlsx"),title:"Export Excel",style:{padding:"2px 4px",background:"rgba(139,92,246,0.4)",border:"none",borderRadius:3,color:"#c084fc",fontSize:8,cursor:"pointer"},children:"XLS"}),o.jsx("button",{onClick:()=>io("csv"),title:"Export CSV",style:{padding:"2px 4px",background:"rgba(139,92,246,0.2)",border:"none",borderRadius:3,color:"#c084fc",fontSize:8,cursor:"pointer"},children:"CSV"})]}),o.jsx("div",{style:{fontSize:9,color:"#9ca3af"},children:"Other Debtors - GL 1700"}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#c084fc",fontFamily:"monospace"},children:ae(rt.otherDebtors).replace("MYR ","")}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280"},children:[hr.length," items"]})]}),o.jsxs("div",{style:{background:"rgba(239,68,68,0.1)",borderRadius:10,border:"1px solid rgba(239,68,68,0.3)",padding:10,position:"relative"},children:[o.jsxs("div",{style:{position:"absolute",top:6,right:6,display:"flex",gap:2},children:[o.jsx("button",{onClick:()=>Sl("xlsx"),title:"Export Excel",style:{padding:"2px 4px",background:"rgba(239,68,68,0.4)",border:"none",borderRadius:3,color:"#f87171",fontSize:8,cursor:"pointer"},children:"XLS"}),o.jsx("button",{onClick:()=>Sl("csv"),title:"Export CSV",style:{padding:"2px 4px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:3,color:"#f87171",fontSize:8,cursor:"pointer"},children:"CSV"})]}),o.jsx("div",{style:{fontSize:9,color:"#9ca3af"},children:"Trade Payables - GL 2600"}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#f87171",fontFamily:"monospace"},children:ae(rt.payables).replace("MYR ","")}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280"},children:[sa.length," suppliers"]})]}),o.jsxs("div",{style:{background:"rgba(244,114,182,0.1)",borderRadius:10,border:"1px solid rgba(244,114,182,0.3)",padding:10,position:"relative"},children:[o.jsxs("div",{style:{position:"absolute",top:6,right:6,display:"flex",gap:2},children:[o.jsx("button",{onClick:()=>ni("xlsx"),title:"Export Excel",style:{padding:"2px 4px",background:"rgba(244,114,182,0.4)",border:"none",borderRadius:3,color:"#f472b6",fontSize:8,cursor:"pointer"},children:"XLS"}),o.jsx("button",{onClick:()=>ni("csv"),title:"Export CSV",style:{padding:"2px 4px",background:"rgba(244,114,182,0.2)",border:"none",borderRadius:3,color:"#f472b6",fontSize:8,cursor:"pointer"},children:"CSV"})]}),o.jsx("div",{style:{fontSize:9,color:"#9ca3af"},children:"Other Creditors - GL 2700"}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#f472b6",fontFamily:"monospace"},children:ae(rt.otherCreditors).replace("MYR ","")}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280"},children:[ti.length," items"]})]}),o.jsxs("div",{style:{background:"rgba(59,130,246,0.1)",borderRadius:10,border:"1px solid rgba(59,130,246,0.3)",padding:10,position:"relative"},children:[o.jsxs("div",{style:{position:"absolute",top:6,right:6,display:"flex",gap:2},children:[o.jsx("button",{onClick:()=>so("xlsx"),title:"Export Excel",style:{padding:"2px 4px",background:"rgba(59,130,246,0.4)",border:"none",borderRadius:3,color:"#60a5fa",fontSize:8,cursor:"pointer"},children:"XLS"}),o.jsx("button",{onClick:()=>so("csv"),title:"Export CSV",style:{padding:"2px 4px",background:"rgba(59,130,246,0.2)",border:"none",borderRadius:3,color:"#60a5fa",fontSize:8,cursor:"pointer"},children:"CSV"})]}),o.jsx("div",{style:{fontSize:9,color:"#9ca3af"},children:"Cash & Bank - GL 1900"}),o.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#60a5fa",fontFamily:"monospace"},children:ae(rt.cashBank).replace("MYR ","")}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280"},children:[en.length," accounts"]})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden",gridColumn:"span 2"},children:[o.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("span",{style:{fontWeight:700,fontSize:13},children:" PPE Register (Fixed Assets)"}),o.jsx("span",{style:{fontSize:9,color:"#34d399",background:"rgba(52,211,153,0.1)",padding:"2px 8px",borderRadius:4},children:"V9: Asset ID | Acq Date | CA Toggle | Disposal"})]}),o.jsx("button",{onClick:h0,style:{padding:"4px 10px",background:"rgba(99,102,241,0.2)",border:"none",borderRadius:4,color:"#a5b4fc",fontSize:10,cursor:"pointer"},children:"+ Add Asset"})]}),o.jsx("div",{style:{padding:12,overflowX:"auto"},children:ft.filter(u=>!u.disposed).length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280",fontSize:11},children:'No active assets registered. Click "+ Add Asset" to add.'}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"75px 1fr 110px 80px 65px 35px 55px 55px 55px 55px 30px 22px",gap:4,padding:"6px 8px",background:"rgba(99,102,241,0.1)",borderRadius:4,fontSize:8,fontWeight:600,color:"#9ca3af",marginBottom:4,minWidth:800},children:[o.jsx("span",{children:"Asset ID"}),o.jsx("span",{children:"Description"}),o.jsx("span",{children:"Category"}),o.jsx("span",{children:"Acq Date"}),o.jsx("span",{style:{textAlign:"right"},children:"Cost"}),o.jsx("span",{style:{textAlign:"center"},children:"Life"}),o.jsx("span",{style:{textAlign:"right"},children:"Acc B/F"}),o.jsx("span",{style:{textAlign:"right"},children:"Cur Dep"}),o.jsx("span",{style:{textAlign:"right"},children:"Acc C/F"}),o.jsx("span",{style:{textAlign:"right"},children:"NBV"}),o.jsx("span",{style:{textAlign:"center"},children:"CA?"}),o.jsx("span",{})]}),ft.filter(u=>!u.disposed).map((u,y)=>{const v=Ql(u),S=xt[u.category]||xt.OFFICE_EQUIPMENT,T=x0(u),W=T.length>0;return o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"75px 1fr 110px 80px 65px 35px 55px 55px 55px 55px 30px 22px",gap:4,padding:"4px 8px",background:W?"rgba(251,191,36,0.1)":y%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:9,minWidth:800,border:W?"1px solid rgba(251,191,36,0.3)":"none"},children:[o.jsx("span",{style:{fontFamily:"monospace",fontSize:7,color:"#6b7280",overflow:"hidden",textOverflow:"ellipsis"},title:u.assetId||"Not assigned",children:u.assetId?u.assetId.slice(-12):"N/A"}),o.jsx("input",{value:u.description,onChange:D=>In(u.id,"description",D.target.value),placeholder:"Asset name",style:{...nt,padding:"3px 6px",fontSize:9}}),o.jsx("select",{value:u.category,onChange:D=>In(u.id,"category",D.target.value),style:{...nt,padding:"3px 4px",fontSize:8,cursor:"pointer"},children:Object.entries(xt).map(([D,C])=>o.jsx("option",{value:D,children:C.label},D))}),o.jsx("input",{type:"date",value:u.acquisitionDate||"",onChange:D=>In(u.id,"acquisitionDate",D.target.value),style:{...nt,padding:"2px 4px",fontSize:8},title:W?T.join(", "):"Acquisition date"}),o.jsx("input",{type:"number",value:u.cost,onChange:D=>In(u.id,"cost",D.target.value),style:{...jt,padding:"3px 4px",fontSize:9}}),o.jsx("span",{style:{textAlign:"center",fontSize:8,color:"#9ca3af"},children:S.years>0?`${S.years}y`:"-"}),o.jsx("input",{type:"number",value:u.accDepBF,onChange:D=>In(u.id,"accDepBF",D.target.value),placeholder:"0",style:{...jt,padding:"3px 4px",fontSize:9}}),o.jsx("span",{style:{fontFamily:"monospace",fontSize:9,color:"#fbbf24",textAlign:"right"},children:v.currentDep>0?ae(v.currentDep).replace("MYR ",""):"-"}),o.jsx("span",{style:{fontFamily:"monospace",fontSize:9,color:"#f87171",textAlign:"right"},children:ae(v.accDepCF).replace("MYR ","")}),o.jsx("span",{style:{fontFamily:"monospace",fontSize:9,color:"#34d399",textAlign:"right",fontWeight:600},children:ae(v.nbv).replace("MYR ","")}),o.jsx("div",{style:{textAlign:"center"},children:o.jsx("input",{type:"checkbox",checked:u.includeForCA!==!1,onChange:D=>In(u.id,"includeForCA",D.target.checked),style:{cursor:"pointer",width:14,height:14},title:"Include in Capital Allowance calculation"})}),o.jsx("button",{onClick:()=>us(u.id),style:{width:18,height:18,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:10},title:"Mark as disposed",children:""})]},u.id)}),ft.filter(u=>u.disposed).length>0&&o.jsxs("details",{style:{marginTop:12,background:"rgba(239,68,68,0.05)",borderRadius:6,border:"1px solid rgba(239,68,68,0.2)"},children:[o.jsxs("summary",{style:{cursor:"pointer",fontSize:10,color:"#f87171",padding:"8px 12px",fontWeight:600},children:[" Disposed Assets (",ft.filter(u=>u.disposed).length,") - Click to expand"]}),o.jsxs("div",{style:{padding:"8px 12px"},children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"80px 1fr 100px 80px 70px 80px 30px",gap:4,padding:"4px 8px",background:"rgba(239,68,68,0.1)",borderRadius:4,fontSize:8,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Asset ID"}),o.jsx("span",{children:"Description"}),o.jsx("span",{children:"Category"}),o.jsx("span",{children:"Disposal Date"}),o.jsx("span",{style:{textAlign:"right"},children:"Cost"}),o.jsx("span",{style:{textAlign:"right"},children:"Proceeds"}),o.jsx("span",{})]}),ft.filter(u=>u.disposed).map(u=>{const y=xt[u.category]||xt.OFFICE_EQUIPMENT;return o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"80px 1fr 100px 80px 70px 80px 30px",gap:4,padding:"4px 8px",background:"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:9,marginBottom:2,opacity:.8},children:[o.jsx("span",{style:{fontFamily:"monospace",fontSize:7,color:"#6b7280"},children:u.assetId?u.assetId.slice(-12):"N/A"}),o.jsx("span",{style:{textDecoration:"line-through",color:"#9ca3af"},children:u.description}),o.jsx("span",{style:{color:"#9ca3af",fontSize:8},children:y.label}),o.jsx("input",{type:"date",value:u.disposalDate||"",onChange:v=>In(u.id,"disposalDate",v.target.value),style:{...nt,padding:"2px 4px",fontSize:8,background:"rgba(239,68,68,0.1)"}}),o.jsx("span",{style:{fontFamily:"monospace",fontSize:9,textAlign:"right",color:"#9ca3af"},children:ae(parseFloat(u.cost)||0).replace("MYR ","")}),o.jsx("input",{type:"number",value:u.disposalProceeds||0,onChange:v=>In(u.id,"disposalProceeds",v.target.value),placeholder:"0",style:{...jt,padding:"2px 4px",fontSize:8,background:"rgba(52,211,153,0.1)"},title:"Disposal proceeds"}),o.jsx("button",{onClick:()=>g0(u.id),style:{width:18,height:18,background:"rgba(239,68,68,0.3)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:10},title:"Permanently delete",children:""})]},u.id)})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"75px 1fr 110px 80px 65px 35px 55px 55px 55px 55px 30px 22px",gap:4,padding:"8px",background:"rgba(99,102,241,0.15)",borderRadius:4,marginTop:8,fontSize:9,fontWeight:700,minWidth:800},children:[o.jsx("span",{}),o.jsxs("span",{children:["TOTAL (Active: ",ft.filter(u=>!u.disposed).length,")"]}),o.jsx("span",{}),o.jsx("span",{}),o.jsx("span",{style:{fontFamily:"monospace",textAlign:"right"},children:ae(rt.ppe.cost).replace("MYR ","")}),o.jsx("span",{}),o.jsx("span",{style:{fontFamily:"monospace",textAlign:"right"},children:ae(rt.ppe.accDepBF).replace("MYR ","")}),o.jsx("span",{style:{fontFamily:"monospace",color:"#fbbf24",textAlign:"right"},children:ae(rt.ppe.currentDep).replace("MYR ","")}),o.jsx("span",{style:{fontFamily:"monospace",color:"#f87171",textAlign:"right"},children:ae(rt.ppe.accDepCF).replace("MYR ","")}),o.jsx("span",{style:{fontFamily:"monospace",color:"#34d399",textAlign:"right"},children:ae(rt.ppe.nbv).replace("MYR ","")}),o.jsx("span",{style:{fontSize:8,textAlign:"center",color:"#a5b4fc"},title:"Assets included for CA",children:ft.filter(u=>!u.disposed&&u.includeForCA!==!1).length}),o.jsx("span",{})]}),o.jsxs("div",{style:{marginTop:12,padding:10,background:"rgba(17,24,39,0.4)",borderRadius:6},children:[o.jsx("div",{style:{fontSize:10,fontWeight:600,marginBottom:8,color:"#a5b4fc"},children:" Depreciation Summary by Category"}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:8},children:(()=>{const u={};return ft.filter(y=>!y.disposed).forEach(y=>{const v=y.category||"OFFICE_EQUIPMENT",S=Ql(y);u[v]||(u[v]={cost:0,currentDep:0,nbv:0,count:0}),u[v].cost+=parseFloat(y.cost)||0,u[v].currentDep+=S.currentDep,u[v].nbv+=S.nbv,u[v].count++}),Object.entries(u).map(([y,v])=>o.jsxs("div",{style:{background:"rgba(99,102,241,0.1)",padding:8,borderRadius:4},children:[o.jsx("div",{style:{fontSize:9,fontWeight:600,color:"#e5e7eb"},children:xt[y]?.label||y}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280"},children:[v.count," asset(s)  ",xt[y]?.years||0,"yr life"]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:4,fontSize:9},children:[o.jsx("span",{style:{color:"#9ca3af"},children:"Dep:"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#fbbf24"},children:ae(v.currentDep).replace("MYR ","")})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:9},children:[o.jsx("span",{style:{color:"#9ca3af"},children:"NBV:"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#34d399"},children:ae(v.nbv).replace("MYR ","")})]})]},y))})()})]})]})})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontWeight:700,fontSize:13},children:" Inventory Ledger"}),o.jsx("button",{onClick:sl,style:{padding:"4px 10px",background:"rgba(52,211,153,0.2)",border:"none",borderRadius:4,color:"#34d399",fontSize:10,cursor:"pointer"},children:"+ Add Item"})]}),o.jsx("div",{style:{padding:12,maxHeight:280,overflowY:"auto"},children:pr.length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280",fontSize:11},children:'No inventory items. Click "+ Add Item" to add.'}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px 1fr 50px 60px 70px 20px",gap:4,padding:"4px 6px",background:"rgba(52,211,153,0.1)",borderRadius:4,fontSize:8,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Code"}),o.jsx("span",{children:"Description"}),o.jsx("span",{children:"Qty"}),o.jsx("span",{children:"Unit Cost"}),o.jsx("span",{children:"Total"}),o.jsx("span",{})]}),pr.map((u,y)=>{const v=(parseFloat(u.qty)||0)*(parseFloat(u.unitCost)||0);return o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px 1fr 50px 60px 70px 20px",gap:4,padding:"4px 6px",background:y%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:9},children:[o.jsx("input",{value:u.itemCode,onChange:S=>gn(u.id,"itemCode",S.target.value),placeholder:"SKU",style:{...nt,padding:"3px 6px",fontSize:9}}),o.jsx("input",{value:u.description,onChange:S=>gn(u.id,"description",S.target.value),placeholder:"Item name",style:{...nt,padding:"3px 6px",fontSize:9}}),o.jsx("input",{type:"number",value:u.qty,onChange:S=>gn(u.id,"qty",S.target.value),style:{...jt,padding:"3px 4px",fontSize:9}}),o.jsx("input",{type:"number",value:u.unitCost,onChange:S=>gn(u.id,"unitCost",S.target.value),style:{...jt,padding:"3px 4px",fontSize:9}}),o.jsx("span",{style:{fontFamily:"monospace",fontSize:9,color:"#34d399"},children:ae(v).replace("MYR","")}),o.jsx("button",{onClick:()=>Go(u.id),style:{width:16,height:16,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:9},children:""})]},u.id)}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px 1fr 50px 60px 70px 20px",gap:4,padding:"6px",background:"rgba(52,211,153,0.15)",borderRadius:4,marginTop:6,fontSize:9,fontWeight:700},children:[o.jsx("span",{}),o.jsx("span",{children:"TOTAL"}),o.jsx("span",{}),o.jsx("span",{}),o.jsx("span",{style:{fontFamily:"monospace",color:"#34d399"},children:ae(rt.inventory).replace("MYR","")}),o.jsx("span",{})]})]})})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontWeight:700,fontSize:13},children:" Trade Receivables (Debtors)"}),o.jsx("button",{onClick:Jl,style:{padding:"4px 10px",background:"rgba(251,191,36,0.2)",border:"none",borderRadius:4,color:"#fbbf24",fontSize:10,cursor:"pointer"},children:"+ Add Customer"})]}),o.jsx("div",{style:{padding:12,maxHeight:280,overflowY:"auto"},children:Aa.length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280",fontSize:11},children:'No receivables. Click "+ Add Customer" to add.'}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 60px 70px 60px 60px 20px",gap:4,padding:"4px 6px",background:"rgba(251,191,36,0.1)",borderRadius:4,fontSize:8,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Customer"}),o.jsx("span",{children:"Invoice"}),o.jsx("span",{children:"Amount"}),o.jsx("span",{children:"Paid"}),o.jsx("span",{children:"Balance"}),o.jsx("span",{})]}),Aa.map((u,y)=>{const v=(parseFloat(u.amount)||0)-(parseFloat(u.paid)||0);return o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 60px 70px 60px 60px 20px",gap:4,padding:"4px 6px",background:y%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:9},children:[o.jsx("input",{value:u.customerName,onChange:S=>ll(u.id,"customerName",S.target.value),placeholder:"Customer",style:{...nt,padding:"3px 6px",fontSize:9}}),o.jsx("input",{value:u.invoiceNo,onChange:S=>ll(u.id,"invoiceNo",S.target.value),placeholder:"INV#",style:{...nt,padding:"3px 6px",fontSize:9}}),o.jsx("input",{type:"number",value:u.amount,onChange:S=>ll(u.id,"amount",S.target.value),style:{...jt,padding:"3px 4px",fontSize:9}}),o.jsx("input",{type:"number",value:u.paid,onChange:S=>ll(u.id,"paid",S.target.value),style:{...jt,padding:"3px 4px",fontSize:9}}),o.jsx("span",{style:{fontFamily:"monospace",fontSize:9,color:v>0?"#fbbf24":"#34d399"},children:ae(v).replace("MYR","")}),o.jsx("button",{onClick:()=>Zl(u.id),style:{width:16,height:16,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:9},children:""})]},u.id)}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 60px 70px 60px 60px 20px",gap:4,padding:"6px",background:"rgba(251,191,36,0.15)",borderRadius:4,marginTop:6,fontSize:9,fontWeight:700},children:[o.jsx("span",{children:"TOTAL"}),o.jsx("span",{}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(Aa.reduce((u,y)=>u+(parseFloat(y.amount)||0),0)).replace("MYR","")}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(Aa.reduce((u,y)=>u+(parseFloat(y.paid)||0),0)).replace("MYR","")}),o.jsx("span",{style:{fontFamily:"monospace",color:"#fbbf24"},children:ae(rt.receivables).replace("MYR","")}),o.jsx("span",{})]})]})})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontWeight:700,fontSize:13},children:" Trade Payables (Creditors)"}),o.jsx("button",{onClick:eo,style:{padding:"4px 10px",background:"rgba(239,68,68,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:10,cursor:"pointer"},children:"+ Add Supplier"})]}),o.jsx("div",{style:{padding:12,maxHeight:280,overflowY:"auto"},children:sa.length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280",fontSize:11},children:'No payables. Click "+ Add Supplier" to add.'}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 60px 70px 60px 60px 20px",gap:4,padding:"4px 6px",background:"rgba(239,68,68,0.1)",borderRadius:4,fontSize:8,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Supplier"}),o.jsx("span",{children:"Invoice"}),o.jsx("span",{children:"Amount"}),o.jsx("span",{children:"Paid"}),o.jsx("span",{children:"Balance"}),o.jsx("span",{})]}),sa.map((u,y)=>{const v=(parseFloat(u.amount)||0)-(parseFloat(u.paid)||0);return o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 60px 70px 60px 60px 20px",gap:4,padding:"4px 6px",background:y%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:9},children:[o.jsx("input",{value:u.supplierName,onChange:S=>ol(u.id,"supplierName",S.target.value),placeholder:"Supplier",style:{...nt,padding:"3px 6px",fontSize:9}}),o.jsx("input",{value:u.invoiceNo,onChange:S=>ol(u.id,"invoiceNo",S.target.value),placeholder:"INV#",style:{...nt,padding:"3px 6px",fontSize:9}}),o.jsx("input",{type:"number",value:u.amount,onChange:S=>ol(u.id,"amount",S.target.value),style:{...jt,padding:"3px 4px",fontSize:9}}),o.jsx("input",{type:"number",value:u.paid,onChange:S=>ol(u.id,"paid",S.target.value),style:{...jt,padding:"3px 4px",fontSize:9}}),o.jsx("span",{style:{fontFamily:"monospace",fontSize:9,color:v>0?"#f87171":"#34d399"},children:ae(v).replace("MYR","")}),o.jsx("button",{onClick:()=>jr(u.id),style:{width:16,height:16,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:9},children:""})]},u.id)}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 60px 70px 60px 60px 20px",gap:4,padding:"6px",background:"rgba(239,68,68,0.15)",borderRadius:4,marginTop:6,fontSize:9,fontWeight:700},children:[o.jsx("span",{children:"TOTAL"}),o.jsx("span",{}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(sa.reduce((u,y)=>u+(parseFloat(y.amount)||0),0)).replace("MYR","")}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(sa.reduce((u,y)=>u+(parseFloat(y.paid)||0),0)).replace("MYR","")}),o.jsx("span",{style:{fontFamily:"monospace",color:"#f87171"},children:ae(rt.payables).replace("MYR","")}),o.jsx("span",{})]})]})})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:16,marginTop:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontWeight:700,fontSize:13},children:" Other Debtors"}),o.jsx("button",{onClick:Pi,style:{padding:"4px 10px",background:"rgba(139,92,246,0.2)",border:"none",borderRadius:4,color:"#c084fc",fontSize:10,cursor:"pointer"},children:"+ Add"})]}),o.jsx("div",{style:{padding:12,maxHeight:250,overflowY:"auto"},children:hr.length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280",fontSize:11},children:'No items. Click "+ Add" to add deposits, prepayments, etc.'}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 70px 20px",gap:4,padding:"4px 6px",background:"rgba(139,92,246,0.1)",borderRadius:4,fontSize:8,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Description"}),o.jsx("span",{children:"Type"}),o.jsx("span",{style:{textAlign:"right"},children:"Amount"}),o.jsx("span",{})]}),hr.map((u,y)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 70px 20px",gap:4,padding:"4px 6px",background:y%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:9},children:[o.jsx("input",{value:u.description,onChange:v=>ys(u.id,"description",v.target.value),placeholder:"Description",style:{...nt,padding:"3px 6px",fontSize:9}}),o.jsxs("select",{value:u.type,onChange:v=>ys(u.id,"type",v.target.value),style:{...nt,padding:"3px 4px",fontSize:8,cursor:"pointer"},children:[o.jsx("option",{value:"DEPOSIT",children:"Deposit"}),o.jsx("option",{value:"PREPAID",children:"Prepaid"}),o.jsx("option",{value:"ADVANCE",children:"Advance"}),o.jsx("option",{value:"OTHER",children:"Other"})]}),o.jsx("input",{type:"number",value:u.amount,onChange:v=>ys(u.id,"amount",v.target.value),style:{...jt,padding:"3px 4px",fontSize:9}}),o.jsx("button",{onClick:()=>cl(u.id),style:{width:16,height:16,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:9},children:""})]},u.id)),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 70px 20px",gap:4,padding:"6px",background:"rgba(139,92,246,0.15)",borderRadius:4,marginTop:6,fontSize:9,fontWeight:700},children:[o.jsx("span",{children:"TOTAL"}),o.jsx("span",{}),o.jsx("span",{style:{fontFamily:"monospace",color:"#c084fc",textAlign:"right"},children:ae(rt.otherDebtors).replace("MYR","")}),o.jsx("span",{})]})]})})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontWeight:700,fontSize:13},children:" Other Creditors"}),o.jsx("button",{onClick:mf,style:{padding:"4px 10px",background:"rgba(244,114,182,0.2)",border:"none",borderRadius:4,color:"#f472b6",fontSize:10,cursor:"pointer"},children:"+ Add"})]}),o.jsx("div",{style:{padding:12,maxHeight:250,overflowY:"auto"},children:ti.length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280",fontSize:11},children:'No items. Click "+ Add" to add accruals, deposits received, etc.'}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 70px 20px",gap:4,padding:"4px 6px",background:"rgba(244,114,182,0.1)",borderRadius:4,fontSize:8,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Description"}),o.jsx("span",{children:"Type"}),o.jsx("span",{style:{textAlign:"right"},children:"Amount"}),o.jsx("span",{})]}),ti.map((u,y)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 70px 20px",gap:4,padding:"4px 6px",background:y%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:9},children:[o.jsx("input",{value:u.description,onChange:v=>dl(u.id,"description",v.target.value),placeholder:"Description",style:{...nt,padding:"3px 6px",fontSize:9}}),o.jsxs("select",{value:u.type,onChange:v=>dl(u.id,"type",v.target.value),style:{...nt,padding:"3px 4px",fontSize:8,cursor:"pointer"},children:[o.jsx("option",{value:"ACCRUAL",children:"Accrual"}),o.jsx("option",{value:"DEPOSIT_RECEIVED",children:"Deposit Received"}),o.jsx("option",{value:"ADVANCE_RECEIVED",children:"Advance Received"}),o.jsx("option",{value:"OTHER",children:"Other"})]}),o.jsx("input",{type:"number",value:u.amount,onChange:v=>dl(u.id,"amount",v.target.value),style:{...jt,padding:"3px 4px",fontSize:9}}),o.jsx("button",{onClick:()=>Wo(u.id),style:{width:16,height:16,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:9},children:""})]},u.id)),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 70px 20px",gap:4,padding:"6px",background:"rgba(244,114,182,0.15)",borderRadius:4,marginTop:6,fontSize:9,fontWeight:700},children:[o.jsx("span",{children:"TOTAL"}),o.jsx("span",{}),o.jsx("span",{style:{fontFamily:"monospace",color:"#f472b6",textAlign:"right"},children:ae(rt.otherCreditors).replace("MYR","")}),o.jsx("span",{})]})]})})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontWeight:700,fontSize:13},children:" Cash & Bank"}),o.jsx("button",{onClick:fl,style:{padding:"4px 10px",background:"rgba(59,130,246,0.2)",border:"none",borderRadius:4,color:"#60a5fa",fontSize:10,cursor:"pointer"},children:"+ Add Account"})]}),o.jsx("div",{style:{padding:12,maxHeight:250,overflowY:"auto"},children:en.length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280",fontSize:11},children:'No accounts. Click "+ Add Account" to add bank accounts.'}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 70px 70px 20px",gap:4,padding:"4px 6px",background:"rgba(59,130,246,0.1)",borderRadius:4,fontSize:8,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Account Name"}),o.jsx("span",{style:{textAlign:"right"},children:"Opening"}),o.jsx("span",{style:{textAlign:"right"},children:"Closing"}),o.jsx("span",{})]}),en.map((u,y)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 70px 70px 20px",gap:4,padding:"4px 6px",background:y%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:9},children:[o.jsx("input",{value:u.accountName,onChange:v=>vs(u.id,"accountName",v.target.value),placeholder:"Account name",style:{...nt,padding:"3px 6px",fontSize:9}}),o.jsx("input",{type:"number",value:u.openingBalance,onChange:v=>vs(u.id,"openingBalance",v.target.value),style:{...jt,padding:"3px 4px",fontSize:9}}),o.jsx("input",{type:"number",value:u.closingBalance,onChange:v=>vs(u.id,"closingBalance",v.target.value),style:{...jt,padding:"3px 4px",fontSize:9}}),o.jsx("button",{onClick:()=>b0(u.id),style:{width:16,height:16,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:9},children:""})]},u.id)),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 70px 70px 20px",gap:4,padding:"6px",background:"rgba(59,130,246,0.15)",borderRadius:4,marginTop:6,fontSize:9,fontWeight:700},children:[o.jsx("span",{children:"TOTAL"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#9ca3af",textAlign:"right"},children:ae(en.reduce((u,y)=>u+(parseFloat(y.openingBalance)||0),0)).replace("MYR","")}),o.jsx("span",{style:{fontFamily:"monospace",color:"#60a5fa",textAlign:"right"},children:ae(rt.cashBank).replace("MYR","")}),o.jsx("span",{})]})]})})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginTop:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontWeight:700,fontSize:13},children:" Short-Term Borrowings"}),o.jsx("button",{onClick:yf,style:{padding:"4px 10px",background:"rgba(251,146,60,0.2)",border:"none",borderRadius:4,color:"#fb923c",fontSize:10,cursor:"pointer"},children:"+ Add Loan"})]}),o.jsx("div",{style:{padding:12,maxHeight:280,overflowY:"auto"},children:Dr.length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280",fontSize:11},children:'No short-term borrowings. Click "+ Add Loan" to add overdraft, short-term loans, etc.'}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 65px 65px 65px 20px",gap:4,padding:"4px 6px",background:"rgba(251,146,60,0.1)",borderRadius:4,fontSize:8,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Lender"}),o.jsx("span",{children:"Type"}),o.jsx("span",{style:{textAlign:"right"},children:"Opening"}),o.jsx("span",{style:{textAlign:"right"},children:"Drawdown"}),o.jsx("span",{style:{textAlign:"right"},children:"Repaid"}),o.jsx("span",{})]}),Dr.map((u,y)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 65px 65px 65px 20px",gap:4,padding:"4px 6px",background:y%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:9},children:[o.jsx("input",{value:u.lender,onChange:v=>ul(u.id,"lender",v.target.value),placeholder:"Lender name",style:{...nt,padding:"3px 6px",fontSize:9}}),o.jsxs("select",{value:u.loanType,onChange:v=>ul(u.id,"loanType",v.target.value),style:{...nt,padding:"3px 4px",fontSize:8,cursor:"pointer"},children:[o.jsx("option",{value:"BANK_OVERDRAFT",children:"Overdraft"}),o.jsx("option",{value:"SHORT_TERM_LOAN",children:"ST Loan"}),o.jsx("option",{value:"HP_CURRENT",children:"HP (Current)"}),o.jsx("option",{value:"TRADE_FINANCING",children:"Trade Finance"}),o.jsx("option",{value:"OTHER",children:"Other"})]}),o.jsx("input",{type:"number",value:u.openingBalance,onChange:v=>ul(u.id,"openingBalance",v.target.value),placeholder:"0",style:{...jt,padding:"3px 4px",fontSize:9}}),o.jsx("input",{type:"number",value:u.drawdown,onChange:v=>ul(u.id,"drawdown",v.target.value),placeholder:"0",style:{...jt,padding:"3px 4px",fontSize:9,background:"rgba(74,222,128,0.1)"}}),o.jsx("input",{type:"number",value:u.repayment,onChange:v=>ul(u.id,"repayment",v.target.value),placeholder:"0",style:{...jt,padding:"3px 4px",fontSize:9,background:"rgba(248,113,113,0.1)"}}),o.jsx("button",{onClick:()=>vf(u.id),style:{width:16,height:16,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:9},children:""})]},u.id)),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 65px 65px 65px 20px",gap:4,padding:"6px",background:"rgba(251,146,60,0.15)",borderRadius:4,marginTop:6,fontSize:9,fontWeight:700},children:[o.jsx("span",{children:"TOTAL"}),o.jsx("span",{}),o.jsx("span",{style:{fontFamily:"monospace",color:"#9ca3af",textAlign:"right"},children:ae(rt.stBorrOpening||0).replace("MYR","")}),o.jsx("span",{style:{fontFamily:"monospace",color:"#4ade80",textAlign:"right"},children:ae(Dr.reduce((u,y)=>u+(parseFloat(y.drawdown)||0),0)).replace("MYR","")}),o.jsx("span",{style:{fontFamily:"monospace",color:"#f87171",textAlign:"right"},children:ae(Dr.reduce((u,y)=>u+(parseFloat(y.repayment)||0),0)).replace("MYR","")}),o.jsx("span",{})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 6px",background:"rgba(251,146,60,0.25)",borderRadius:4,marginTop:4,fontSize:10,fontWeight:700},children:[o.jsx("span",{children:"Closing Balance:"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#fb923c"},children:ae(rt.shortTermBorrowings||0)})]})]})})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontWeight:700,fontSize:13},children:" Long-Term Borrowings"}),o.jsx("button",{onClick:Vo,style:{padding:"4px 10px",background:"rgba(168,85,247,0.2)",border:"none",borderRadius:4,color:"#a855f7",fontSize:10,cursor:"pointer"},children:"+ Add Loan"})]}),o.jsx("div",{style:{padding:12,maxHeight:280,overflowY:"auto"},children:Ra.length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280",fontSize:11},children:'No long-term borrowings. Click "+ Add Loan" to add term loans, HP, mortgages, etc.'}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 65px 65px 65px 20px",gap:4,padding:"4px 6px",background:"rgba(168,85,247,0.1)",borderRadius:4,fontSize:8,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Lender"}),o.jsx("span",{children:"Type"}),o.jsx("span",{style:{textAlign:"right"},children:"Opening"}),o.jsx("span",{style:{textAlign:"right"},children:"Drawdown"}),o.jsx("span",{style:{textAlign:"right"},children:"Repaid"}),o.jsx("span",{})]}),Ra.map((u,y)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 65px 65px 65px 20px",gap:4,padding:"4px 6px",background:y%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,alignItems:"center",fontSize:9},children:[o.jsx("input",{value:u.lender,onChange:v=>pl(u.id,"lender",v.target.value),placeholder:"Lender name",style:{...nt,padding:"3px 6px",fontSize:9}}),o.jsxs("select",{value:u.loanType,onChange:v=>pl(u.id,"loanType",v.target.value),style:{...nt,padding:"3px 4px",fontSize:8,cursor:"pointer"},children:[o.jsx("option",{value:"TERM_LOAN",children:"Term Loan"}),o.jsx("option",{value:"HIRE_PURCHASE",children:"Hire Purchase"}),o.jsx("option",{value:"MORTGAGE",children:"Mortgage"}),o.jsx("option",{value:"DIRECTORS_LOAN",children:"Directors Loan"}),o.jsx("option",{value:"RELATED_PARTY_LOAN",children:"Related Party"}),o.jsx("option",{value:"OTHER",children:"Other"})]}),o.jsx("input",{type:"number",value:u.openingBalance,onChange:v=>pl(u.id,"openingBalance",v.target.value),placeholder:"0",style:{...jt,padding:"3px 4px",fontSize:9}}),o.jsx("input",{type:"number",value:u.drawdown,onChange:v=>pl(u.id,"drawdown",v.target.value),placeholder:"0",style:{...jt,padding:"3px 4px",fontSize:9,background:"rgba(74,222,128,0.1)"}}),o.jsx("input",{type:"number",value:u.repayment,onChange:v=>pl(u.id,"repayment",v.target.value),placeholder:"0",style:{...jt,padding:"3px 4px",fontSize:9,background:"rgba(248,113,113,0.1)"}}),o.jsx("button",{onClick:()=>bf(u.id),style:{width:16,height:16,background:"rgba(239,68,68,0.2)",border:"none",borderRadius:2,color:"#f87171",cursor:"pointer",fontSize:9},children:""})]},u.id)),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px 65px 65px 65px 20px",gap:4,padding:"6px",background:"rgba(168,85,247,0.15)",borderRadius:4,marginTop:6,fontSize:9,fontWeight:700},children:[o.jsx("span",{children:"TOTAL"}),o.jsx("span",{}),o.jsx("span",{style:{fontFamily:"monospace",color:"#9ca3af",textAlign:"right"},children:ae(rt.ltBorrOpening||0).replace("MYR","")}),o.jsx("span",{style:{fontFamily:"monospace",color:"#4ade80",textAlign:"right"},children:ae(Ra.reduce((u,y)=>u+(parseFloat(y.drawdown)||0),0)).replace("MYR","")}),o.jsx("span",{style:{fontFamily:"monospace",color:"#f87171",textAlign:"right"},children:ae(Ra.reduce((u,y)=>u+(parseFloat(y.repayment)||0),0)).replace("MYR","")}),o.jsx("span",{})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 6px",background:"rgba(168,85,247,0.25)",borderRadius:4,marginTop:4,fontSize:10,fontWeight:700},children:[o.jsx("span",{children:"Closing Balance:"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#a855f7"},children:ae(rt.longTermBorrowings||0)})]})]})})]})]}),o.jsxs("div",{style:{marginTop:16,padding:16,background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)"},children:[o.jsx("div",{style:{fontWeight:700,fontSize:13,marginBottom:12},children:" Subledger to GL Reconciliation"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:4},children:"PPE (NBV)"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"Subledger:"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#a5b4fc"},children:ae(rt.ppe.nbv)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"GL (Opening):"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#9ca3af"},children:ae((parseFloat(le.fixed_asset)||0)-Math.abs(parseFloat(le.accumulated_depreciation)||0))})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11,fontWeight:700,marginTop:4,paddingTop:4,borderTop:"1px solid rgba(75,85,99,0.3)"},children:[o.jsx("span",{children:"Diff:"}),(()=>{const u=(parseFloat(le.fixed_asset)||0)-Math.abs(parseFloat(le.accumulated_depreciation)||0),y=rt.ppe.nbv-u;return o.jsx("span",{style:{fontFamily:"monospace",color:Math.abs(y)<1?"#34d399":"#fbbf24"},children:ae(y)})})()]})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:4},children:"Inventory"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"Subledger:"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#34d399"},children:ae(rt.inventory)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"GL (Opening):"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#9ca3af"},children:ae(parseFloat(le.inventory)||0)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11,fontWeight:700,marginTop:4,paddingTop:4,borderTop:"1px solid rgba(75,85,99,0.3)"},children:[o.jsx("span",{children:"Diff:"}),o.jsx("span",{style:{fontFamily:"monospace",color:Math.abs(rt.inventory-(parseFloat(le.inventory)||0))<1?"#34d399":"#fbbf24"},children:ae(rt.inventory-(parseFloat(le.inventory)||0))})]})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:4},children:"Trade Receivables"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"Subledger:"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#fbbf24"},children:ae(rt.receivables)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"GL (Opening):"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#9ca3af"},children:ae(parseFloat(le.trade_receivables)||0)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11,fontWeight:700,marginTop:4,paddingTop:4,borderTop:"1px solid rgba(75,85,99,0.3)"},children:[o.jsx("span",{children:"Diff:"}),o.jsx("span",{style:{fontFamily:"monospace",color:Math.abs(rt.receivables-(parseFloat(le.trade_receivables)||0))<1?"#34d399":"#fbbf24"},children:ae(rt.receivables-(parseFloat(le.trade_receivables)||0))})]})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:4},children:"Trade Payables"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"Subledger:"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#f87171"},children:ae(rt.payables)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"GL (Opening):"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#9ca3af"},children:ae(Math.abs(parseFloat(le.trade_payables)||0))})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11,fontWeight:700,marginTop:4,paddingTop:4,borderTop:"1px solid rgba(75,85,99,0.3)"},children:[o.jsx("span",{children:"Diff:"}),o.jsx("span",{style:{fontFamily:"monospace",color:Math.abs(rt.payables-Math.abs(parseFloat(le.trade_payables)||0))<1?"#34d399":"#fbbf24"},children:ae(rt.payables-Math.abs(parseFloat(le.trade_payables)||0))})]})]})]})]}),o.jsxs("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:16},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:4},children:"Short-Term Borrowings"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"Subledger (Closing):"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#fb923c"},children:ae(rt.shortTermBorrowings||0)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"Opening Balance:"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#9ca3af"},children:ae(rt.stBorrOpening||0)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11,fontWeight:700,marginTop:4,paddingTop:4,borderTop:"1px solid rgba(75,85,99,0.3)"},children:[o.jsx("span",{children:"Net Movement:"}),(()=>{const u=(rt.shortTermBorrowings||0)-(rt.stBorrOpening||0);return o.jsx("span",{style:{fontFamily:"monospace",color:Math.abs(u)<1?"#34d399":"#fbbf24"},children:ae(u)})})()]})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:4},children:"Long-Term Borrowings"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"Subledger (Closing):"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#a855f7"},children:ae(rt.longTermBorrowings||0)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[o.jsx("span",{children:"Opening Balance:"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#9ca3af"},children:ae(rt.ltBorrOpening||0)})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11,fontWeight:700,marginTop:4,paddingTop:4,borderTop:"1px solid rgba(75,85,99,0.3)"},children:[o.jsx("span",{children:"Net Movement:"}),(()=>{const u=(rt.longTermBorrowings||0)-(rt.ltBorrOpening||0);return o.jsx("span",{style:{fontFamily:"monospace",color:Math.abs(u)<1?"#34d399":"#fbbf24"},children:ae(u)})})()]})]})]}),o.jsx("div",{style:{marginTop:16,padding:12,background:"rgba(99,102,241,0.1)",borderRadius:8,border:"1px solid rgba(99,102,241,0.2)"},children:o.jsxs("div",{style:{fontSize:11,color:"#a5b4fc"},children:[" ",o.jsx("strong",{children:"Subledger Reconciliation"}),": Compares subledger totals (CY closing) with GL opening balances (PY closing). The difference represents ",o.jsx("strong",{children:"movement during the year"}),". Green = no movement or matched, Yellow = movement exists (verify against transactions). For PPE, difference includes depreciation impact."]})})]}),e==="balances"&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("button",{onClick:lr,style:Ya,children:" Subledger"}),o.jsx("span",{style:{fontSize:12,color:"#9ca3af"},children:"Set opening balances, then generate FS"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",fontWeight:700,fontSize:14},children:"Opening Balances"}),o.jsxs("div",{style:{padding:16},children:[o.jsxs("div",{style:{display:"flex",gap:6,marginBottom:10},children:[o.jsx("input",{placeholder:"Account",value:de.acc,onChange:u=>Ce(y=>({...y,acc:u.target.value})),style:{...nt,flex:1}}),o.jsx("input",{type:"number",placeholder:"Amount",value:de.amt,onChange:u=>Ce(y=>({...y,amt:u.target.value})),style:{...nt,width:100}}),o.jsx("button",{onClick:wf,style:{padding:"6px 12px",background:"linear-gradient(135deg, #6366f1, #4f46e5)",border:"none",borderRadius:6,color:"#fff",fontWeight:700,cursor:"pointer"},children:"+"})]}),Object.keys(le).length===0?o.jsx("div",{style:{padding:16,textAlign:"center",color:"#6b7280",fontSize:12},children:'No balances. Use "Prior FS" tab.'}):o.jsx("div",{style:{maxHeight:200,overflowY:"auto"},children:Object.entries(le).map(([u,y],v)=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"6px 8px",background:v%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,fontSize:11},children:[o.jsx("span",{style:{textTransform:"capitalize"},children:u.replace(/_/g," ")}),o.jsx("span",{style:{fontFamily:"monospace",fontWeight:600,color:y>=0?"#34d399":"#f87171"},children:ae(y)})]},u))})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",fontWeight:700,fontSize:14},children:"Generate"}),o.jsxs("div",{style:{padding:16},children:[[["Banks",ya.length],["Transactions",_.length],["Opening Balances",Object.keys(le).length],["Suspense",_.filter(u=>cn.classify(u.description).code==="SUSPENSE").length]].map(([u,y],v)=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid rgba(75,85,99,0.15)",fontSize:12},children:[o.jsx("span",{children:u}),o.jsx("span",{style:{fontWeight:600},children:y})]},v)),o.jsx("button",{onClick:k0,disabled:!_.length||ue,style:{width:"100%",marginTop:16,padding:"12px",background:_.length?"linear-gradient(135deg, #8b5cf6, #7c3aed)":"rgba(75,85,99,0.3)",border:"none",borderRadius:8,color:"#fff",fontSize:14,fontWeight:700,cursor:_.length?"pointer":"not-allowed"},children:ue?" Processing...":" Generate FS"})]})]})]})]}),e==="journal"&&m&&o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("button",{onClick:lr,style:Ya,children:" Back"}),o.jsx("span",{style:{fontWeight:700,fontSize:14},children:"Journal Entries"}),o.jsx("span",{style:{background:"rgba(52,211,153,0.2)",color:"#34d399",padding:"2px 8px",borderRadius:8,fontSize:10,fontWeight:600},children:m.jes.length}),o.jsxs("span",{style:{fontSize:9,color:"#6b7280"},children:["(Bank: ",m.jes.filter(u=>u.source!=="Cash").length," | Cash: ",m.jes.filter(u=>u.source==="Cash").length,")"]})]}),o.jsx("button",{onClick:or,style:sr,children:"Trial Balance "})]}),o.jsx("div",{style:{padding:12,maxHeight:450,overflowY:"auto"},children:m.jes.map((u,y)=>o.jsxs("div",{style:{marginBottom:8,background:"rgba(17,24,39,0.4)",borderRadius:6,border:u.source==="Cash"?"1px solid rgba(251,191,36,0.3)":"1px solid rgba(75,85,99,0.2)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"6px 10px",borderBottom:"1px solid rgba(75,85,99,0.15)",display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:10},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[o.jsxs("span",{style:{background:"rgba(99,102,241,0.2)",color:"#a5b4fc",padding:"1px 5px",borderRadius:3,fontSize:8,fontFamily:"monospace"},children:["JE-",String(y+1).padStart(3,"0")]}),u.ref&&o.jsx("span",{style:{background:"rgba(251,191,36,0.2)",color:"#fbbf24",padding:"1px 5px",borderRadius:3,fontSize:8},children:u.ref}),o.jsx("span",{style:{color:"#9ca3af",fontSize:9},children:u.date}),o.jsx("span",{style:{background:u.source==="Cash"?"rgba(251,191,36,0.2)":"rgba(99,102,241,0.1)",color:u.source==="Cash"?"#fbbf24":"#6b7280",padding:"1px 4px",borderRadius:3,fontSize:8},children:u.source==="Cash"?" Cash":` ${u.bank}`}),o.jsx("span",{children:u.desc.substring(0,35)})]}),o.jsx("span",{style:{background:"rgba(139,92,246,0.2)",color:"#c4b5fd",padding:"1px 6px",borderRadius:3,fontSize:8,fontWeight:600},children:u.cls})]}),o.jsx("div",{style:{padding:"4px 10px"},children:u.entries.map((v,S)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"130px 1fr 1fr",padding:"2px 0",fontSize:10},children:[o.jsx("span",{style:{paddingLeft:v.dr>0?0:12,textTransform:"capitalize"},children:v.acc.replace(/_/g," ")}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:v.dr>0?"#e5e7eb":"#6b7280"},children:v.dr>0?ae(v.dr):"-"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:v.cr>0?"#e5e7eb":"#6b7280"},children:v.cr>0?ae(v.cr):"-"})]},S))})]},y))})]}),e==="trial"&&m&&o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("button",{onClick:lr,style:Ya,children:" Back"}),o.jsx("span",{style:{fontWeight:700,fontSize:14},children:"Trial Balance"})]}),o.jsxs("div",{style:{display:"flex",gap:8},children:[o.jsx("button",{onClick:()=>M0("xlsx"),style:{padding:"6px 12px",background:"linear-gradient(135deg, #7c3aed, #8b5cf6)",border:"none",borderRadius:6,color:"#fff",fontSize:11,cursor:"pointer",fontWeight:600},children:" Export TB (Excel)"}),o.jsx("button",{onClick:()=>M0("csv"),style:{padding:"6px 12px",background:"rgba(124,58,237,0.3)",border:"1px solid rgba(139,92,246,0.5)",borderRadius:6,color:"#c4b5fd",fontSize:11,cursor:"pointer",fontWeight:600},children:" Export TB (CSV)"}),o.jsx("button",{onClick:or,style:sr,children:"Income Statement "})]})]}),o.jsxs("div",{style:{padding:12},children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px repeat(5, 1fr)",padding:"6px 10px",background:"rgba(99,102,241,0.1)",borderRadius:4,fontSize:9,fontWeight:600,color:"#9ca3af",marginBottom:4},children:[o.jsx("span",{children:"Account"}),o.jsx("span",{style:{textAlign:"right"},children:"Opening"}),o.jsx("span",{style:{textAlign:"right"},children:"Debit"}),o.jsx("span",{style:{textAlign:"right"},children:"Credit"}),o.jsx("span",{style:{textAlign:"right"},children:"Closing"}),o.jsx("span",{style:{textAlign:"right"},children:"Dr/Cr"})]}),m.tb.map((u,y)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px repeat(5, 1fr)",padding:"5px 10px",background:y%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,fontSize:10},children:[o.jsx("span",{style:{textTransform:"capitalize"},children:u.acc.replace(/_/g," ")}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:ae(u.op)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(u.dr)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(u.cr)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",fontWeight:600,color:u.cl>=0?"#34d399":"#f87171"},children:ae(Math.abs(u.cl))}),o.jsx("span",{style:{textAlign:"right",fontSize:8,fontWeight:600,color:u.cl>=0?"#a5b4fc":"#f9a8d4"},children:u.cl>=0?"DR":"CR"})]},u.acc))]})]}),e==="income"&&m&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("button",{onClick:lr,style:Ya,children:" Trial Balance"}),o.jsx("button",{onClick:or,style:sr,children:"Balance Sheet "})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 320px",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(52,211,153,0.1), rgba(99,102,241,0.1))"},children:[o.jsx("div",{style:{fontWeight:700,fontSize:14},children:s||"Company Name"}),o.jsx("div",{style:{fontWeight:600,fontSize:12,color:"#a5b4fc",marginTop:2},children:"Statement of Profit or Loss"}),o.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginTop:4},children:["For the financial year ended ",Zt,"  ",Ot?.standard]})]}),o.jsxs("div",{style:{padding:16},children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 110px 110px",padding:"8px 12px",background:"rgba(99,102,241,0.1)",borderRadius:6,marginBottom:8},children:[o.jsx("span",{style:{fontSize:10,fontWeight:600}}),o.jsx("span",{style:{fontSize:10,fontWeight:600,textAlign:"right"},children:L}),o.jsx("span",{style:{fontSize:10,fontWeight:600,textAlign:"right",color:"#9ca3af"},children:fe})]}),(()=>{const u=[],y=m.is.details||{},v=(pe,We)=>pe!==0&&pe!==null||We!==0&&We!==null,S=Ye.filter(pe=>pe.section==="revenue"||pe.type==="revenue");let T=!1;S.forEach(pe=>{const We=parseFloat(pe.value)||0,Ve=y[pe.id]||0;v(Ve,We)&&(u.push({l:pe.label,cy:Ve,py:We}),T=!0)}),(T||v(m.is.rev,tt.revenue))&&(!T&&v(m.is.rev,tt.revenue)?u.push({l:"Revenue",cy:m.is.rev,py:tt.revenue}):T&&u.push({l:"Total Revenue",cy:m.is.rev,py:tt.revenue,b:!0}));const W=Ye.filter(pe=>pe.section==="cost_of_sales"||pe.type==="cogs");let D=!1;W.forEach(pe=>{const We=parseFloat(pe.value)||0,Ve=y[pe.id]||0;v(Ve,We)&&(u.push({l:pe.label,cy:-Ve,py:-We}),D=!0)}),(D||v(m.is.cos,tt.cos))&&(!D&&v(m.is.cos,tt.cos)?u.push({l:"Cost of Sales",cy:-m.is.cos,py:-tt.cos}):D&&u.push({l:"Total Cost of Sales",cy:-m.is.cos,py:-tt.cos,b:!0})),(v(m.is.rev,tt.revenue)||v(m.is.cos,tt.cos))&&u.push({l:"Gross Profit",cy:m.is.gp,py:tt.gp,b:!0,h:!0});const C=Ye.filter(pe=>pe.section==="operating_expenses"||pe.type==="expense");let O=!1,G=0;const xe=[];C.forEach(pe=>{const We=parseFloat(pe.value)||0;G+=We;const Ve=y[pe.id]||0;if(v(Ve,We)){const it=pe.id==="DEPRECIATION";xe.push({l:`  - ${pe.label}`,cy:it?-(m.is.dep||Ve):-Ve,py:-We,indent:!0,dep:it}),O=!0}}),(O||v(m.is.adm,G))&&(u.push({l:"Operating Expenses:",cy:null,py:null,sub:!0}),u.push(...xe),u.push({l:"Total Operating Expenses",cy:-m.is.adm,py:-G,b:!0})),v(m.is.op,tt.op)&&u.push({l:"Operating Profit",cy:m.is.op,py:tt.op||0,b:!0,h:!0});const Re=Ye.filter(pe=>pe.section==="other_income"||pe.type==="other_income");let ye=!1;Re.forEach(pe=>{const We=parseFloat(pe.value)||0,Ve=y[pe.id]||0;v(Ve,We)&&(u.push({l:pe.label,cy:Ve,py:We}),ye=!0)}),ye?u.push({l:"Total Other Income",cy:m.is.oi,py:tt.oi,b:!0}):v(m.is.oi,tt.oi)&&u.push({l:"Other Income",cy:m.is.oi,py:tt.oi});const X=Ye.filter(pe=>pe.section==="other_expenses"||pe.type==="other_expense");let V=!1;X.forEach(pe=>{const We=parseFloat(pe.value)||0,Ve=y[pe.id]||0;v(Ve,We)&&(u.push({l:pe.label,cy:-Ve,py:-We}),V=!0)}),V?u.push({l:"Total Other Expenses",cy:-m.is.oe,py:-tt.oe,b:!0}):v(m.is.oe,tt.oe)&&u.push({l:"Other Expenses",cy:-m.is.oe,py:-tt.oe});const Me=Ye.filter(pe=>pe.section==="finance_costs"||pe.type==="finance");let Be=!1;return Me.forEach(pe=>{const We=parseFloat(pe.value)||0,Ve=y[pe.id]||0;v(Ve,We)&&(u.push({l:pe.label,cy:-Ve,py:-We}),Be=!0)}),Be?u.push({l:"Total Finance Costs",cy:-m.is.fin,py:-tt.fin,b:!0}):v(m.is.fin,tt.fin)&&u.push({l:"Finance Costs",cy:-m.is.fin,py:-tt.fin}),u.push({l:"Profit Before Tax",cy:m.is.pbt,py:tt.pbt||0,b:!0,h:!0}),v(m.is.tax,tt.tax)&&u.push({l:`Tax (${Ot?.taxInfo||"24%"})`,cy:-m.is.tax,py:-tt.tax}),u.push({l:"Net Profit/(Loss)",cy:m.is.np,py:tt.np||0,b:!0,p:!0}),u.map((pe,We)=>pe.sub?o.jsx("div",{style:{padding:"6px 12px",fontSize:10,fontWeight:600,color:"#9ca3af"},children:pe.l},We):o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 110px 110px",padding:pe.h||pe.p?"8px 12px":"5px 12px",background:pe.p?"linear-gradient(135deg, rgba(52,211,153,0.2), rgba(99,102,241,0.2))":pe.h?"rgba(99,102,241,0.08)":"transparent",borderRadius:pe.h||pe.p?6:0,marginTop:pe.h||pe.p?4:0},children:[o.jsx("span",{style:{fontWeight:pe.b?700:500,fontSize:pe.p?12:11,color:pe.indent?"#9ca3af":pe.dep?"#fbbf24":"#e5e7eb"},children:pe.l}),o.jsx("span",{style:{fontWeight:pe.b?700:500,fontFamily:"monospace",fontSize:pe.p?12:pe.indent?10:11,textAlign:"right",color:pe.cy===null?"transparent":pe.cy>=0?pe.p?"#34d399":pe.dep?"#fbbf24":"#e5e7eb":"#f87171"},children:pe.cy===null?"-":pe.cy<0?`(${ae(Math.abs(pe.cy))})`:ae(pe.cy)}),o.jsx("span",{style:{fontFamily:"monospace",fontSize:10,textAlign:"right",color:pe.dep?"#fbbf24":"#9ca3af"},children:pe.py!==void 0&&pe.py!==null?pe.py<0?`(${ae(Math.abs(pe.py))})`:ae(pe.py):"-"})]},We))})(),(m.is.dep||0)>0&&o.jsxs("div",{style:{marginTop:12,padding:8,background:"rgba(251,191,36,0.1)",borderRadius:6,fontSize:9,color:"#fbbf24"},children:[" Current year depreciation of ",ae(m.is.dep)," sourced from PPE Register (Subledger)"]})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"rgba(251,191,36,0.1)"},children:o.jsx("div",{style:{fontWeight:700,fontSize:13,color:"#fbbf24"},children:" Issues & Suggestions"})}),o.jsx("div",{style:{padding:12,maxHeight:500,overflowY:"auto"},children:(()=>{const u=[],y=[];if(m.susp&&m.susp.length>0&&u.push({type:"error",title:`${m.susp.length} Unclassified Transaction(s)`,desc:"Some transactions are in Suspense and not included in the financial statements.",fix:"Go to the Classify tab and assign appropriate classifications to all suspense items."}),m.is.rev>0){const v=m.is.gp/m.is.rev*100;v<10?y.push({type:"warning",title:`Low Gross Profit Margin (${v.toFixed(1)}%)`,desc:"Gross profit margin is below 10%, which may indicate pricing or cost issues.",fix:"Review pricing strategy and supplier costs. Consider if all COGS items are correctly classified."}):v>80&&y.push({type:"info",title:`High Gross Profit Margin (${v.toFixed(1)}%)`,desc:"Very high margin - typical for services but unusual for trading.",fix:"Verify that all direct costs are captured in Cost of Sales. Service businesses typically show high margins."})}if(m.is.rev>0&&m.is.adm===0&&y.push({type:"warning",title:"No Operating Expenses Recorded",desc:"Revenue exists but no operating expenses. This is unusual for most businesses.",fix:"Check if expense transactions are correctly classified. Most businesses have staff costs, utilities, etc."}),m.is.pbt<0&&y.push({type:"info",title:`Loss Before Tax: ${ae(Math.abs(m.is.pbt))}`,desc:"The business is reporting a loss for this period.",fix:"This may be normal for startups or seasonal businesses. Review if all revenue is captured and expenses are reasonable."}),m.is.rev>0){const v=m.is.adm/m.is.rev*100;v>50&&y.push({type:"info",title:`High Operating Expenses (${v.toFixed(1)}% of Revenue)`,desc:"Operating expenses exceed 50% of revenue.",fix:"Review expense classifications. Some items classified as expenses might be COGS or capital expenditure."})}return u.length===0&&y.length===0?o.jsxs("div",{style:{padding:20,textAlign:"center"},children:[o.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),o.jsx("div",{style:{fontSize:12,color:"#34d399",fontWeight:600},children:"All Clear!"}),o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginTop:4},children:"No issues detected with income statement"})]}):[...u,...y].map((v,S)=>o.jsxs("div",{style:{padding:12,marginBottom:8,background:v.type==="error"?"rgba(239,68,68,0.1)":v.type==="warning"?"rgba(251,191,36,0.1)":"rgba(99,102,241,0.1)",border:`1px solid ${v.type==="error"?"rgba(239,68,68,0.3)":v.type==="warning"?"rgba(251,191,36,0.3)":"rgba(99,102,241,0.3)"}`,borderRadius:8},children:[o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:v.type==="error"?"#f87171":v.type==="warning"?"#fbbf24":"#a5b4fc",marginBottom:4},children:[v.type==="error"?"":v.type==="warning"?"":""," ",v.title]}),o.jsx("div",{style:{fontSize:10,color:"#d1d5db",marginBottom:6},children:v.desc}),o.jsxs("div",{style:{fontSize:9,color:"#9ca3af",padding:8,background:"rgba(0,0,0,0.2)",borderRadius:4},children:[" ",o.jsx("strong",{children:"Suggestion:"})," ",v.fix]})]},S))})()})]})]})]}),e==="balance"&&m&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("button",{onClick:lr,style:Ya,children:" Income Statement"}),o.jsx("button",{onClick:or,style:sr,children:"Cash Flow "})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",padding:"12px 16px",marginBottom:16,textAlign:"center"},children:[o.jsx("div",{style:{fontWeight:700,fontSize:14},children:s||"Company Name"}),o.jsx("div",{style:{fontWeight:600,fontSize:12,color:"#a5b4fc",marginTop:2},children:"Statement of Financial Position"}),o.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginTop:4},children:["As at ",Zt,"  ",Ot?.standard]}),(()=>{const u=m.bs.totA||0,y=(m.bs.totL||0)+(m.bs.totE||0),v=u-y,S=Math.abs(v)<1;return o.jsx("div",{style:{marginTop:8,padding:"6px 12px",borderRadius:6,display:"inline-block",background:S?"rgba(52,211,153,0.15)":"rgba(239,68,68,0.15)",border:S?"1px solid rgba(52,211,153,0.3)":"1px solid rgba(239,68,68,0.3)"},children:o.jsx("span",{style:{fontSize:10,fontWeight:600,color:S?"#34d399":"#f87171"},children:S?" Balanced":` Difference: ${ae(v)}`})})})()]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(99,102,241,0.1), rgba(139,92,246,0.1))",fontWeight:700,fontSize:14},children:"Assets"}),o.jsxs("div",{style:{padding:16},children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",marginBottom:8,fontSize:10,fontWeight:600,color:"#9ca3af"},children:[o.jsx("span",{}),o.jsx("span",{style:{textAlign:"right"},children:L}),o.jsx("span",{style:{textAlign:"right"},children:fe})]}),(()=>{const u=He.filter(v=>v.type==="nca");return!u.some(v=>{const S=parseFloat(v.value)||0;let T=0;return v.id==="PPE"?T=m.bs.ppe:v.id==="INTANGIBLES"?T=m.bs.intangibles||0:v.id==="INVESTMENTS"&&(T=m.bs.investments||0),T!==0||S!==0})&&m.bs.totNCA===0?null:o.jsxs(o.Fragment,{children:[o.jsx("div",{style:ua,children:"Non-Current Assets"}),u.map((v,S)=>{const T=parseFloat(v.value)||0;let W=0;if(v.id==="PPE"){if(rt.ppe.cost>0||rt.ppe.accDepCF>0)return o.jsxs("div",{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"5px 10px",fontSize:11},children:[o.jsx("span",{children:v.label}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"}}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:T>0?ae(T):"-"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"3px 10px 3px 20px",fontSize:10,color:"#9ca3af"},children:[o.jsx("span",{children:"Cost"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(rt.ppe.cost)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"}})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"3px 10px 3px 20px",fontSize:10,color:"#f87171"},children:[o.jsx("span",{children:"Less: Acc Depreciation"}),o.jsxs("span",{style:{textAlign:"right",fontFamily:"monospace"},children:["(",ae(rt.ppe.accDepCF),")"]}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"}})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"5px 10px",fontSize:11,fontWeight:600},children:[o.jsx("span",{children:"Net Book Value"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#a5b4fc"},children:ae(rt.ppe.nbv)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"}})]})]},v.id);W=m.bs.ppe}else v.id==="INTANGIBLES"?W=m.bs.intangibles||0:v.id==="INVESTMENTS"&&(W=m.bs.investments||0);return W===0&&T===0?null:o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"5px 10px",fontSize:11},children:[o.jsx("span",{children:v.label}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:W!==0?ae(W):"-"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:T!==0?ae(T):"-"})]},v.id)}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"4px 10px",fontSize:10,color:"#9ca3af",marginTop:4},children:[o.jsx("span",{children:"Total Non-Current Assets"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(m.bs.totNCA)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:m.bs.py_totNCA?ae(m.bs.py_totNCA):"-"})]})]})})(),o.jsx("div",{style:{...ua,marginTop:10},children:"Current Assets"}),He.filter(y=>y.type==="ca").map(y=>{const v=parseFloat(y.value)||0;let S=0;return y.id==="INVENTORY"?S=m.bs.inv:y.id==="TRADE_RECEIVABLES"?S=m.bs.tr:y.id==="OTHER_RECEIVABLES"?S=m.bs.or||0:y.id==="TAX_PREPAID"?S=m.bs.taxPrepaid||0:y.id==="CASH_BANK"&&(S=m.bs.cash),S===0&&v===0&&y.id!=="CASH_BANK"?null:o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"5px 10px",fontSize:11},children:[o.jsx("span",{children:y.label}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(S)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:v!==0?ae(v):"-"})]},y.id)}),(m.bs.taxPrepaid||0)>0&&o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"5px 10px",fontSize:11},children:[o.jsx("span",{children:"Tax Prepaid"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(m.bs.taxPrepaid)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:"-"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"4px 10px",fontSize:10,color:"#9ca3af",marginTop:4},children:[o.jsx("span",{children:"Total Current Assets"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(m.bs.totCA)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:m.bs.py_totCA?ae(m.bs.py_totCA):"-"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"10px",background:"linear-gradient(135deg, rgba(99,102,241,0.2), rgba(139,92,246,0.2))",borderRadius:6,marginTop:10,fontWeight:700,fontSize:12},children:[o.jsx("span",{children:"TOTAL ASSETS"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(m.bs.totA)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:m.bs.py_totA?ae(m.bs.py_totA):"-"})]})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(239,68,68,0.1), rgba(251,191,36,0.1))",fontWeight:700,fontSize:14},children:"Liabilities & Equity"}),o.jsxs("div",{style:{padding:16},children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",marginBottom:8,fontSize:10,fontWeight:600,color:"#9ca3af"},children:[o.jsx("span",{}),o.jsx("span",{style:{textAlign:"right"},children:L}),o.jsx("span",{style:{textAlign:"right"},children:fe})]}),(()=>{const u=He.filter(v=>v.type==="ncl");return u.some(v=>{const S=parseFloat(v.value)||0;let T=0;return v.id==="LONG_TERM_LOAN"?T=m.bs.ltBorr||0:v.id==="DEFERRED_TAX"&&(T=m.bs.defTax||0),T!==0||S!==0})?o.jsxs(o.Fragment,{children:[o.jsx("div",{style:ua,children:"Non-Current Liabilities"}),u.map(v=>{const S=parseFloat(v.value)||0;let T=0;return v.id==="LONG_TERM_LOAN"?T=m.bs.ltBorr||0:v.id==="DEFERRED_TAX"&&(T=m.bs.defTax||0),T===0&&S===0?null:o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"5px 10px",fontSize:11},children:[o.jsx("span",{children:v.label}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:T!==0?ae(T):"-"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:S!==0?ae(S):"-"})]},v.id)})]}):null})(),o.jsx("div",{style:ua,children:"Current Liabilities"}),He.filter(y=>y.type==="cl").map(y=>{const v=parseFloat(y.value)||0;let S=0;return y.id==="SHORT_TERM_LOAN"?S=m.bs.stBorr||m.bs.borr||0:y.id==="TRADE_PAYABLES"?S=m.bs.tp:y.id==="OTHER_PAYABLES"?S=m.bs.op||0:y.id==="TAX_PAYABLE"?S=m.bs.taxPay||0:y.id==="GST_SST_PAYABLE"&&(S=m.bs.gstSst||0),S===0&&v===0?null:o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"5px 10px",fontSize:11},children:[o.jsx("span",{children:y.label}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(S)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:v!==0?ae(v):"-"})]},y.id)}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"4px 10px",fontSize:10,color:"#9ca3af",marginTop:4},children:[o.jsx("span",{children:"Total Liabilities"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(m.bs.totL)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:m.bs.py_totL?ae(m.bs.py_totL):"-"})]}),o.jsx("div",{style:{...ua,marginTop:10},children:"Equity"}),He.filter(y=>y.type==="equity").map(y=>{const v=parseFloat(y.value)||0;let S=0;return y.id==="SHARE_CAPITAL"?S=m.bs.cap:y.id==="RETAINED_PROFITS"&&(S=m.bs.ret),S===0&&v===0&&y.id!=="SHARE_CAPITAL"?null:o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"5px 10px",fontSize:11},children:[o.jsx("span",{children:y.label}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(S)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:v!==0?ae(v):"-"})]},y.id)}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"5px 10px",fontSize:11},children:[o.jsx("span",{children:"Current Year Profit"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:m.bs.cyp>=0?"#34d399":"#f87171"},children:ae(m.bs.cyp)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:"-"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"4px 10px",fontSize:10,color:"#9ca3af",marginTop:4},children:[o.jsx("span",{children:"Total Equity"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(m.bs.totE)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:m.bs.py_totE?ae(m.bs.py_totE):"-"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"10px",background:"linear-gradient(135deg, rgba(239,68,68,0.2), rgba(251,191,36,0.2))",borderRadius:6,marginTop:10,fontWeight:700,fontSize:12},children:[o.jsx("span",{children:"TOTAL L + E"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(m.bs.totL+m.bs.totE)}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:m.bs.py_totL!==void 0&&m.bs.py_totE!==void 0?ae(m.bs.py_totL+m.bs.py_totE):"-"})]}),(()=>{const u=(m.bs.totA||0)-((m.bs.totL||0)+(m.bs.totE||0)),y=m.bs.py_totA?m.bs.py_totA-(m.bs.py_totL||0)-(m.bs.py_totE||0):0,v=Math.abs(u)>=1,S=m.bs.py_totA&&Math.abs(y)>=1;return!v&&!S?null:o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 90px 90px",padding:"8px 10px",marginTop:8,background:"rgba(239,68,68,0.1)",borderRadius:6,border:"1px solid rgba(239,68,68,0.3)"},children:[o.jsx("span",{style:{fontSize:10,color:"#f87171",fontWeight:600},children:"Difference (A - L&E)"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:v?"#f87171":"#34d399",fontWeight:700},children:v?ae(u):""}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:S?"#fbbf24":"#34d399",fontWeight:700},children:m.bs.py_totA?S?ae(y):"":"-"})]})})()]})]})]}),o.jsx("div",{style:{gridColumn:"1 / -1",marginTop:16},children:o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"rgba(251,191,36,0.1)"},children:o.jsx("div",{style:{fontWeight:700,fontSize:13,color:"#fbbf24"},children:" Balance Sheet Issues & Suggestions"})}),o.jsx("div",{style:{padding:12,display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:12},children:(()=>{const u=[],y=(m.bs.totA||0)-((m.bs.totL||0)+(m.bs.totE||0));if(Math.abs(y)>=1){const v=[];v.push(`Assets: NCA ${ae(m.bs.totNCA)} + CA ${ae(m.bs.totCA)} = ${ae(m.bs.totA)}`),v.push(`Liabilities: NCL ${ae(m.bs.totNCL||0)} + CL ${ae(m.bs.totCL)} = ${ae(m.bs.totL)}`),v.push(`Equity: Capital ${ae(m.bs.cap)} + Retained ${ae(m.bs.ret)} + CY Profit ${ae(m.bs.cyp)} = ${ae(m.bs.totE)}`),u.push({type:"error",title:"CY Balance Sheet Does Not Balance",desc:`Assets (${ae(m.bs.totA)})  L+E (${ae(m.bs.totL+m.bs.totE)}). Difference: ${ae(y)}`,fix:v.join(" | ")})}if(m.bs.py_totA&&m.bs.py_totA>0){const v=(m.bs.py_totA||0)-((m.bs.py_totL||0)+(m.bs.py_totE||0));if(Math.abs(v)>=1){const S=[];S.push(`PY Assets: NCA ${ae(m.bs.py_totNCA||0)} + CA ${ae(m.bs.py_totCA||0)} = ${ae(m.bs.py_totA)}`),S.push(`PY Liabilities: NCL ${ae(m.bs.py_totNCL||0)} + CL ${ae(m.bs.py_totCL||0)} = ${ae(m.bs.py_totL)}`),S.push(`PY Equity: Capital ${ae(m.bs.py_cap||0)} + Retained ${ae(m.bs.py_ret||0)} = ${ae(m.bs.py_totE)}`),u.push({type:"warning",title:"PY Balance Sheet Does Not Balance",desc:`PY Assets (${ae(m.bs.py_totA)})  PY L+E (${ae((m.bs.py_totL||0)+(m.bs.py_totE||0))}). Difference: ${ae(v)}`,fix:S.join(" | ")})}}if(m.bs.cash<0&&u.push({type:"warning",title:"Negative Cash Balance",desc:`Cash shows ${ae(m.bs.cash)}. Banks typically don't allow negative balances.`,fix:"This may indicate an overdraft (should be classified as liability) or missing deposits. Review bank reconciliation."}),m.bs.inv<0&&u.push({type:"error",title:"Negative Inventory",desc:`Inventory is ${ae(m.bs.inv)}. This is not possible in reality.`,fix:"Review inventory movements. You may have recorded more sales than available stock, or opening balance is wrong."}),m.bs.totA>0&&m.bs.totL>m.bs.totA&&u.push({type:"warning",title:"Negative Net Assets",desc:"Total liabilities exceed total assets, indicating negative equity.",fix:"This may indicate the business is insolvent. Verify if this is correct or if assets/liabilities are misclassified."}),(!m.bs.py_totA||m.bs.py_totA===0)&&u.push({type:"info",title:"No Prior Year Comparatives",desc:"Prior year Balance Sheet values are not entered.",fix:"Enter prior year figures in the Prior FS tab for meaningful year-on-year comparison."}),m.bs.totCL>0){const v=m.bs.totCA/m.bs.totCL;v<1&&u.push({type:"warning",title:`Low Current Ratio (${v.toFixed(2)})`,desc:"Current assets are less than current liabilities, indicating potential liquidity issues.",fix:"The business may have difficulty meeting short-term obligations. Review cash flow and consider restructuring debt."})}return u.length===0?o.jsxs("div",{style:{padding:20,textAlign:"center",gridColumn:"1 / -1"},children:[o.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),o.jsx("div",{style:{fontSize:12,color:"#34d399",fontWeight:600},children:"All Clear!"}),o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginTop:4},children:"Balance Sheet is balanced and no issues detected"})]}):u.map((v,S)=>o.jsxs("div",{style:{padding:12,background:v.type==="error"?"rgba(239,68,68,0.1)":v.type==="warning"?"rgba(251,191,36,0.1)":"rgba(99,102,241,0.1)",border:`1px solid ${v.type==="error"?"rgba(239,68,68,0.3)":v.type==="warning"?"rgba(251,191,36,0.3)":"rgba(99,102,241,0.3)"}`,borderRadius:8},children:[o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:v.type==="error"?"#f87171":v.type==="warning"?"#fbbf24":"#a5b4fc",marginBottom:4},children:[v.type==="error"?"":v.type==="warning"?"":""," ",v.title]}),o.jsx("div",{style:{fontSize:10,color:"#d1d5db",marginBottom:6},children:v.desc}),o.jsxs("div",{style:{fontSize:9,color:"#9ca3af",padding:8,background:"rgba(0,0,0,0.2)",borderRadius:4},children:[" ",o.jsx("strong",{children:"Suggestion:"})," ",v.fix]})]},S))})()})]})})]}),e==="cashflow"&&m&&m.cf&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("button",{onClick:lr,style:Ya,children:" Balance Sheet"}),o.jsx("button",{onClick:or,style:sr,children:"Tax Computation "})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 350px",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(52,211,153,0.1), rgba(34,197,94,0.1))"},children:[o.jsx("div",{style:{fontWeight:700,fontSize:14},children:s||"Company Name"}),o.jsx("div",{style:{fontWeight:600,fontSize:12,color:"#34d399",marginTop:2},children:"Statement of Cash Flows"}),o.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginTop:4},children:["For the financial year ended ",Zt,"  Indirect Method (IAS 7 / IFRS 18)"]}),o.jsx("div",{style:{fontSize:9,color:"#6b7280",marginTop:2,fontStyle:"italic"},children:" Derived from Balance Sheet movements. May require adjustment for disposals/non-cash items."})]}),o.jsxs("div",{style:{padding:16},children:[o.jsxs("div",{style:{marginBottom:16},children:[o.jsx("div",{style:{fontSize:12,fontWeight:700,color:"#34d399",marginBottom:8,padding:"6px 10px",background:"rgba(52,211,153,0.1)",borderRadius:6},children:" Cash Flows from Operating Activities"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"6px 10px",fontSize:11},children:[o.jsx("span",{children:"Profit before taxation"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",fontWeight:600},children:ae(m.cf.pbt)})]}),o.jsx("div",{style:{fontSize:10,color:"#9ca3af",padding:"4px 10px",marginTop:6},children:"Adjustments for:"}),[{label:"Depreciation",value:m.cf.adjustments.depreciation},{label:"Interest expense",value:m.cf.adjustments.interestExpense},{label:"Interest income",value:m.cf.adjustments.interestIncome}].filter(u=>u.value!==0).map((u,y)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"4px 10px 4px 20px",fontSize:10,color:"#d1d5db"},children:[o.jsx("span",{children:u.label}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:u.value>=0?ae(u.value):`(${ae(Math.abs(u.value))})`})]},y)),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"6px 10px",fontSize:11,background:"rgba(75,85,99,0.2)",borderRadius:4,marginTop:4},children:[o.jsx("span",{style:{fontWeight:600},children:"Operating profit before working capital changes"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",fontWeight:600},children:ae(m.cf.pbt+m.cf.totalAdjustments)})]}),o.jsx("div",{style:{fontSize:10,color:"#9ca3af",padding:"4px 10px",marginTop:8},children:"Changes in working capital:"}),[{label:"(Increase)/Decrease in inventories",value:m.cf.workingCapitalChanges.inventory},{label:"(Increase)/Decrease in trade receivables",value:m.cf.workingCapitalChanges.tradeReceivables},{label:"(Increase)/Decrease in other receivables",value:m.cf.workingCapitalChanges.otherReceivables},{label:"Increase/(Decrease) in trade payables",value:m.cf.workingCapitalChanges.tradePayables},{label:"Increase/(Decrease) in other payables",value:m.cf.workingCapitalChanges.otherPayables}].filter(u=>u.value!==0).map((u,y)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"4px 10px 4px 20px",fontSize:10,color:"#d1d5db"},children:[o.jsx("span",{children:u.label}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:u.value>=0?"#34d399":"#f87171"},children:u.value>=0?ae(u.value):`(${ae(Math.abs(u.value))})`})]},y)),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"6px 10px",fontSize:11,background:"rgba(52,211,153,0.15)",borderRadius:4,marginTop:4},children:[o.jsx("span",{style:{fontWeight:600},children:"Cash generated from operations"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",fontWeight:600},children:ae(m.cf.cashFromOperations)})]}),(m.cf.taxPaid!==0||m.cf.interestPaid!==0)&&o.jsxs(o.Fragment,{children:[m.cf.taxPaid!==0&&o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"4px 10px",fontSize:10,color:"#d1d5db"},children:[o.jsx("span",{children:"Tax paid"}),o.jsxs("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#f87171"},children:["(",ae(Math.abs(m.cf.taxPaid)),")"]})]}),m.cf.interestPaid!==0&&o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"4px 10px",fontSize:10,color:"#d1d5db"},children:[o.jsx("span",{children:"Interest paid"}),o.jsxs("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#f87171"},children:["(",ae(Math.abs(m.cf.interestPaid)),")"]})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"8px 10px",fontSize:12,background:"rgba(52,211,153,0.2)",borderRadius:6,marginTop:6,fontWeight:700},children:[o.jsx("span",{children:"Net cash from operating activities"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:m.cf.netOperating>=0?"#34d399":"#f87171"},children:m.cf.netOperating>=0?ae(m.cf.netOperating):`(${ae(Math.abs(m.cf.netOperating))})`})]})]}),o.jsxs("div",{style:{marginBottom:16},children:[o.jsx("div",{style:{fontSize:12,fontWeight:700,color:"#a5b4fc",marginBottom:8,padding:"6px 10px",background:"rgba(99,102,241,0.1)",borderRadius:6},children:" Cash Flows from Investing Activities"}),[{label:"Purchase of property, plant & equipment",value:m.cf.ppePurchases},{label:"Proceeds from disposal of PPE",value:m.cf.ppeDisposals},{label:"Purchase of investments",value:m.cf.investmentPurchases},{label:"Proceeds from disposal of investments",value:m.cf.investmentDisposals},{label:"Interest received",value:m.cf.interestReceived}].filter(u=>u.value!==0).map((u,y)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"4px 10px",fontSize:10,color:"#d1d5db"},children:[o.jsx("span",{children:u.label}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:u.value>=0?"#34d399":"#f87171"},children:u.value>=0?ae(u.value):`(${ae(Math.abs(u.value))})`})]},y)),m.cf.netInvesting===0&&o.jsx("div",{style:{padding:"4px 10px",fontSize:10,color:"#6b7280",fontStyle:"italic"},children:"No investing activities"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"8px 10px",fontSize:12,background:"rgba(99,102,241,0.2)",borderRadius:6,marginTop:6,fontWeight:700},children:[o.jsx("span",{children:"Net cash from investing activities"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:m.cf.netInvesting>=0?"#34d399":"#f87171"},children:m.cf.netInvesting>=0?ae(m.cf.netInvesting):`(${ae(Math.abs(m.cf.netInvesting))})`})]})]}),o.jsxs("div",{style:{marginBottom:16},children:[o.jsx("div",{style:{fontSize:12,fontWeight:700,color:"#fbbf24",marginBottom:8,padding:"6px 10px",background:"rgba(251,191,36,0.1)",borderRadius:6},children:" Cash Flows from Financing Activities"}),[{label:"Proceeds from borrowings",value:m.cf.loanProceeds},{label:"Repayment of borrowings",value:m.cf.loanRepayments},{label:"Capital injection / Share issuance",value:m.cf.capitalInjection},{label:"Dividends paid",value:m.cf.dividendsPaid},{label:"Drawings / Withdrawals",value:m.cf.drawingsWithdrawals}].filter(u=>u.value!==0).map((u,y)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"4px 10px",fontSize:10,color:"#d1d5db"},children:[o.jsx("span",{children:u.label}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:u.value>=0?"#34d399":"#f87171"},children:u.value>=0?ae(u.value):`(${ae(Math.abs(u.value))})`})]},y)),m.cf.netFinancing===0&&o.jsx("div",{style:{padding:"4px 10px",fontSize:10,color:"#6b7280",fontStyle:"italic"},children:"No financing activities"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"8px 10px",fontSize:12,background:"rgba(251,191,36,0.2)",borderRadius:6,marginTop:6,fontWeight:700},children:[o.jsx("span",{children:"Net cash from financing activities"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:m.cf.netFinancing>=0?"#34d399":"#f87171"},children:m.cf.netFinancing>=0?ae(m.cf.netFinancing):`(${ae(Math.abs(m.cf.netFinancing))})`})]})]}),o.jsxs("div",{style:{borderTop:"2px solid rgba(75,85,99,0.3)",paddingTop:12},children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"6px 10px",fontSize:11,fontWeight:600},children:[o.jsx("span",{children:"Net increase/(decrease) in cash"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:m.cf.netChangeInCash>=0?"#34d399":"#f87171"},children:m.cf.netChangeInCash>=0?ae(m.cf.netChangeInCash):`(${ae(Math.abs(m.cf.netChangeInCash))})`})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"6px 10px",fontSize:11},children:[o.jsx("span",{children:"Cash at beginning of year"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(m.cf.openingCash)})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"10px",fontSize:13,background:"linear-gradient(135deg, rgba(52,211,153,0.2), rgba(99,102,241,0.2))",borderRadius:6,marginTop:4,fontWeight:700},children:[o.jsx("span",{children:"Cash at end of year (per CF)"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#34d399"},children:ae(m.cf.closingCash)})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"6px 10px",fontSize:11,marginTop:4},children:[o.jsx("span",{style:{color:"#9ca3af"},children:"Cash per Balance Sheet"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#9ca3af"},children:ae(m.cf.cashPerBS)})]}),Math.abs(m.cf.difference)>=1&&o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 100px",padding:"6px 10px",fontSize:11,background:"rgba(239,68,68,0.1)",borderRadius:4,marginTop:4,border:"1px solid rgba(239,68,68,0.3)"},children:[o.jsx("span",{style:{color:"#f87171",fontWeight:600},children:" Difference"}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#f87171",fontWeight:600},children:ae(m.cf.difference)})]})]})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"rgba(251,191,36,0.1)"},children:o.jsx("div",{style:{fontWeight:700,fontSize:13,color:"#fbbf24"},children:" Issues & Suggestions"})}),o.jsx("div",{style:{padding:12,maxHeight:500,overflowY:"auto"},children:(()=>{const u=[],y=[];Math.abs(m.cf.difference)>=1&&u.push({type:"error",title:"Cash Flow vs Balance Sheet Difference",desc:`Calculated closing cash (${ae(m.cf.closingCash)}) differs from BS cash (${ae(m.cf.cashPerBS)}) by ${ae(Math.abs(m.cf.difference))}`,fix:"Common causes: (1) Subledger values override TB for AR/AP/Inventory but transactions flow to cash differently, (2) Missing transactions like tax payments, dividends, or drawings, (3) Timing differences. The indirect method derives cash from BS changes - ensure all BS items are consistent."}),m.cf.openingCash===0&&m.bs.py_cash===0&&y.push({type:"warning",title:"No Opening Cash Balance",desc:"Opening cash is zero. This is normal for a new company but check if prior year BS was entered.",fix:"Enter prior year Balance Sheet in the Prior FS tab to enable proper cash flow calculation."}),m.cf.netOperating<0&&m.is.np>0&&y.push({type:"info",title:"Negative Operating Cash Despite Profit",desc:`Operating cash flow is negative (${ae(m.cf.netOperating)}) despite net profit of ${ae(m.is.np)}`,fix:"This commonly occurs due to working capital increases (growing receivables/inventory). Review if collections are delayed or stock is building up."});const v=Math.abs(m.cf.totalWCChanges);return v>Math.abs(m.cf.pbt)*.5&&v>1e4&&y.push({type:"info",title:"Significant Working Capital Movement",desc:`Working capital changed by ${ae(v)}, which is significant relative to profit.`,fix:"Large swings may indicate seasonality, growth, or collection issues. Verify receivables aging and inventory levels."}),u.length===0&&y.length===0?o.jsxs("div",{style:{padding:20,textAlign:"center"},children:[o.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),o.jsx("div",{style:{fontSize:12,color:"#34d399",fontWeight:600},children:"All Clear!"}),o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginTop:4},children:"No issues detected with cash flow statement"})]}):[...u,...y].map((S,T)=>o.jsxs("div",{style:{padding:12,marginBottom:8,background:S.type==="error"?"rgba(239,68,68,0.1)":S.type==="warning"?"rgba(251,191,36,0.1)":"rgba(99,102,241,0.1)",border:`1px solid ${S.type==="error"?"rgba(239,68,68,0.3)":S.type==="warning"?"rgba(251,191,36,0.3)":"rgba(99,102,241,0.3)"}`,borderRadius:8},children:[o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:S.type==="error"?"#f87171":S.type==="warning"?"#fbbf24":"#a5b4fc",marginBottom:4},children:[S.type==="error"?"":S.type==="warning"?"":""," ",S.title]}),o.jsx("div",{style:{fontSize:10,color:"#d1d5db",marginBottom:6},children:S.desc}),o.jsxs("div",{style:{fontSize:9,color:"#9ca3af",padding:8,background:"rgba(0,0,0,0.2)",borderRadius:4},children:[" ",o.jsx("strong",{children:"Suggestion:"})," ",S.fix]})]},T))})()})]})]})]}),e==="tax"&&m&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("button",{onClick:lr,style:Ya,children:" Cash Flow"}),o.jsx("button",{onClick:or,style:sr,children:"Snapshots "})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(251,191,36,0.1), rgba(245,158,11,0.1))"},children:[o.jsx("div",{style:{fontWeight:700,fontSize:14},children:s||"Company Name"}),o.jsx("div",{style:{fontWeight:600,fontSize:12,color:"#fbbf24",marginTop:2},children:" Tax Computation"}),o.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginTop:2},children:["Year of Assessment ",L,"  ",Ot?.taxInfo]})]}),o.jsxs("div",{style:{padding:16,maxHeight:600,overflowY:"auto"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",fontSize:12,borderBottom:"1px solid rgba(75,85,99,0.2)"},children:[o.jsx("span",{children:"Profit Before Tax"}),o.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:ae(m.is.pbt)})]}),o.jsxs("div",{style:{...ua,marginTop:12,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{color:"#f87171"},children:" Add Back: Non-Deductible Expenses"}),o.jsx("span",{style:{fontSize:9,color:"#6b7280",fontWeight:400},children:"Section 39 ITA 1967"})]}),o.jsxs("div",{style:{background:"rgba(248,113,113,0.05)",borderRadius:8,border:"1px solid rgba(248,113,113,0.2)",padding:8,marginBottom:8},children:[o.jsxs("div",{style:{fontSize:9,color:"#9ca3af",marginBottom:8,display:"flex",alignItems:"center",gap:4},children:[o.jsx("span",{children:""})," Expenses not wholly & exclusively for business must be added back to profit"]}),Kl.map((u,y)=>o.jsxs("div",{style:{marginBottom:8},children:[o.jsx("div",{style:{fontSize:9,color:"#f87171",fontWeight:600,marginBottom:4,textTransform:"uppercase",letterSpacing:.5},children:u.category}),u.items.map(v=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"3px 8px",fontSize:10},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,flex:1},children:[o.jsx("span",{children:v.label}),o.jsx("div",{style:{position:"relative",display:"inline-block"},children:o.jsx("span",{style:{cursor:"help",fontSize:10,color:"#6b7280",background:"rgba(107,114,128,0.2)",borderRadius:"50%",width:14,height:14,display:"inline-flex",alignItems:"center",justifyContent:"center"},title:v.tooltip,children:"?"})})]}),o.jsx("input",{type:"number",placeholder:"0",value:Mt.addBackExpenses&&Mt.addBackExpenses[v.key]||"",onChange:S=>Fr(T=>({...T,addBackExpenses:{...T.addBackExpenses||{},[v.key]:S.target.value}})),style:{...nt,width:90,padding:"3px 6px",fontSize:10,fontFamily:"monospace",textAlign:"right"}})]},v.key))]},y)),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",fontSize:11,background:"rgba(248,113,113,0.1)",borderRadius:6,marginTop:8,fontWeight:600},children:[o.jsx("span",{children:"Total Add Back"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#f87171"},children:ae(yi())})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",fontSize:12,background:"rgba(99,102,241,0.1)",borderRadius:6,marginBottom:8},children:[o.jsx("span",{style:{fontWeight:600},children:"Adjusted Profit"}),o.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:ae(m.is.pbt+yi())})]}),o.jsx("div",{style:{...ua,marginTop:12},children:t==="ENTERPRISE"?" Business Deductions & Personal Reliefs":" Tax Deductions & Allowances"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",fontSize:11,background:"rgba(52,211,153,0.1)",borderRadius:6,marginBottom:8},children:[o.jsxs("div",{children:[o.jsx("span",{style:{fontWeight:600},children:"Capital Allowance"}),o.jsxs("div",{style:{fontSize:9,color:"#6b7280",marginTop:2},children:["From CA Schedule (",ps.length," assets)",!ms()&&o.jsx("span",{style:{color:"#f87171",marginLeft:8},children:" Not reconciled with PPE"})]})]}),o.jsxs("span",{style:{fontFamily:"monospace",color:"#34d399",fontWeight:600},children:["(",ae(xs()),")"]})]}),t==="ENTERPRISE"?o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:8,padding:"4px 8px",background:"rgba(99,102,241,0.1)",borderRadius:4},children:"Personal reliefs reduce chargeable income for sole proprietors/partners"}),[{key:"selfRelief",label:"Self Relief",max:9e3},{key:"spouseRelief",label:"Spouse Relief",max:4e3},{key:"childRelief",label:"Child Relief",max:null},{key:"parentsMedical",label:"Parents Medical",max:8e3},{key:"epfContribution",label:"EPF Contribution",max:4e3},{key:"lifeInsurance",label:"Life Insurance / Takaful",max:3e3},{key:"educationFees",label:"Education & Medical Insurance",max:3e3},{key:"medicalExpenses",label:"Medical Expenses",max:1e4},{key:"lifestyleRelief",label:"Lifestyle Relief",max:2500},{key:"socsoContribution",label:"SOCSO Contribution",max:350},{key:"privateRetirement",label:"Private Retirement Scheme",max:3e3},{key:"sspnDeposit",label:"SSPN Deposit",max:8e3}].map(u=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 12px",fontSize:11},children:[o.jsxs("span",{children:[u.label," ",u.max&&o.jsxs("span",{style:{color:"#6b7280"},children:["(max ",ae(u.max),")"]})]}),o.jsx("input",{type:"number",placeholder:"0",value:Mt.personalDeductions[u.key],onChange:y=>Fr(v=>({...v,personalDeductions:{...v.personalDeductions,[u.key]:y.target.value}})),style:{...nt,width:100,padding:"4px 8px",fontSize:11,fontFamily:"monospace",textAlign:"right"}})]},u.key))]}):o.jsx(o.Fragment,{children:[{key:"reinvestmentAllowance",label:"Reinvestment Allowance"},{key:"pioneerStatus",label:"Pioneer Status Exemption"},{key:"investmentTaxAllowance",label:"Investment Tax Allowance"},{key:"exportIncentive",label:"Export Incentive"},{key:"rdDeduction",label:"R&D Double Deduction"},{key:"lossCarryForward",label:"Loss Carry Forward"}].map(u=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 12px",fontSize:11},children:[o.jsx("span",{children:u.label}),o.jsx("input",{type:"number",placeholder:"0",value:Mt.corporateDeductions[u.key],onChange:y=>Fr(v=>({...v,corporateDeductions:{...v.corporateDeductions,[u.key]:y.target.value}})),style:{...nt,width:100,padding:"4px 8px",fontSize:11,fontFamily:"monospace",textAlign:"right"}})]},u.key))}),(()=>{const u=Qn(m.is.pbt);return o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",fontSize:12,borderTop:"1px solid rgba(75,85,99,0.2)",marginTop:8},children:[o.jsx("span",{children:"Total Deductions"}),o.jsxs("span",{style:{fontFamily:"monospace",color:"#34d399"},children:["(",ae(u.totalDeductions),")"]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"10px 12px",background:"rgba(251,191,36,0.1)",borderRadius:6,marginTop:8,fontSize:12,fontWeight:600},children:[o.jsx("span",{children:"Chargeable Income"}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(u.taxableIncome)})]}),u.taxableIncome>0?o.jsxs("div",{style:{marginTop:12,padding:8,background:"rgba(99,102,241,0.05)",borderRadius:6,border:"1px solid rgba(99,102,241,0.2)"},children:[o.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a5b4fc",marginBottom:8},children:" Tax Calculation Breakdown"}),u.brackets.length>0?u.brackets.map((y,v)=>o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 8px",fontSize:10,borderBottom:v<u.brackets.length-1?"1px solid rgba(75,85,99,0.2)":"none"},children:[o.jsx("span",{children:y.range}),o.jsxs("span",{style:{color:"#9ca3af"},children:[ae(y.amount),"  ",y.rate,"% = ",o.jsx("span",{style:{color:"#fbbf24",fontWeight:600},children:ae(y.tax)})]})]},v)):o.jsx("div",{style:{fontSize:10,color:"#9ca3af",padding:8},children:"No tax brackets calculated"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 8px 4px",fontSize:11,fontWeight:600,borderTop:"1px solid rgba(75,85,99,0.3)",marginTop:4},children:[o.jsx("span",{children:"Gross Tax"}),o.jsx("span",{style:{fontFamily:"monospace"},children:ae(u.grossTax)})]})]}):o.jsx("div",{style:{marginTop:12,padding:12,background:"rgba(52,211,153,0.1)",borderRadius:6,border:"1px solid rgba(52,211,153,0.2)",fontSize:11,color:"#34d399"},children:" No tax payable - Chargeable income is zero or negative after deductions"}),t==="ENTERPRISE"&&u.grossTax>0&&o.jsxs("div",{style:{marginTop:12},children:[o.jsx("div",{style:{...ua,color:"#34d399"},children:" Tax Rebates"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",fontSize:11,background:"rgba(52,211,153,0.05)",borderRadius:6},children:[o.jsxs("div",{children:[o.jsx("span",{style:{fontWeight:600},children:"Zakat Paid"}),o.jsx("div",{style:{fontSize:9,color:"#6b7280",marginTop:2},children:"Rebate limited to tax payable amount"})]}),o.jsx("input",{type:"number",placeholder:"0",value:Mt.taxRebates&&Mt.taxRebates.zakat||"",onChange:y=>Fr(v=>({...v,taxRebates:{...v.taxRebates||{},zakat:y.target.value}})),style:{...nt,width:100,padding:"4px 8px",fontSize:11,fontFamily:"monospace",textAlign:"right"}})]}),u.zakat>0&&o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 12px",fontSize:11,color:"#34d399"},children:[o.jsx("span",{children:"Less: Zakat Rebate"}),o.jsxs("span",{style:{fontFamily:"monospace"},children:["(",ae(u.zakat),")"]})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"12px",background:"linear-gradient(135deg, rgba(251,191,36,0.2), rgba(245,158,11,0.2))",borderRadius:6,marginTop:12,fontSize:14,fontWeight:700},children:[o.jsx("span",{children:"Tax Payable"}),o.jsx("span",{style:{fontFamily:"monospace",color:"#fbbf24"},children:ae(u.netTax)})]})]})})(),Jn(m.is.pbt)!==m.is.tax&&o.jsxs("div",{style:{marginTop:12,padding:12,background:"rgba(251,191,36,0.1)",borderRadius:8,border:"1px solid rgba(251,191,36,0.3)"},children:[o.jsxs("div",{style:{fontSize:11,color:"#fbbf24",marginBottom:8},children:[" Tax has changed from ",ae(m.is.tax)," to ",ae(Jn(m.is.pbt)),". Click below to update the financial statements."]}),o.jsx("button",{onClick:k0,style:{width:"100%",padding:"10px 16px",background:"linear-gradient(135deg, #fbbf24, #f59e0b)",border:"none",borderRadius:8,color:"#1f2937",fontWeight:700,fontSize:12,cursor:"pointer"},children:" Update Financial Statements"})]})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(99,102,241,0.1), rgba(139,92,246,0.1))"},children:[o.jsx("div",{style:{fontWeight:700,fontSize:14},children:" Tax Rate Settings"}),o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginTop:2},children:"Adjust rates if different from default"})]}),o.jsxs("div",{style:{padding:16},children:[t==="SDN_BHD"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{style:ua,children:"SME Tax Rates"}),o.jsxs("div",{style:{marginBottom:12},children:[o.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginBottom:4},children:"Tier 1 Limit (RM)"}),o.jsx("input",{type:"number",value:Mt.sdnBhd.tier1Limit,onChange:u=>Fr(y=>({...y,sdnBhd:{...y.sdnBhd,tier1Limit:parseInt(u.target.value)||0}})),style:{...nt,fontFamily:"monospace"}})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginBottom:4},children:"Tier 1 Rate (%)"}),o.jsx("input",{type:"number",value:Mt.sdnBhd.tier1Rate,onChange:u=>Fr(y=>({...y,sdnBhd:{...y.sdnBhd,tier1Rate:parseFloat(u.target.value)||0}})),style:{...nt,fontFamily:"monospace"}})]}),o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginBottom:4},children:"Tier 2 Rate (%)"}),o.jsx("input",{type:"number",value:Mt.sdnBhd.tier2Rate,onChange:u=>Fr(y=>({...y,sdnBhd:{...y.sdnBhd,tier2Rate:parseFloat(u.target.value)||0}})),style:{...nt,fontFamily:"monospace"}})]})]}),o.jsxs("div",{style:{padding:12,background:"rgba(99,102,241,0.1)",borderRadius:8,marginTop:12,fontSize:11},children:[o.jsx("div",{style:{fontWeight:600,marginBottom:4},children:"Current Tax Structure:"}),o.jsxs("div",{children:[" First RM",Mt.sdnBhd.tier1Limit.toLocaleString(),": ",Mt.sdnBhd.tier1Rate,"%"]}),o.jsxs("div",{children:[" Above RM",Mt.sdnBhd.tier1Limit.toLocaleString(),": ",Mt.sdnBhd.tier2Rate,"%"]})]})]}),t==="ENTERPRISE"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{style:ua,children:"Personal Tax Brackets (YA2024)"}),o.jsxs("div",{style:{maxHeight:300,overflowY:"auto"},children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px",gap:4,marginBottom:4,fontSize:9,color:"#6b7280"},children:[o.jsx("span",{children:"Bracket Amount (RM)"}),o.jsx("span",{children:"Rate"})]}),Mt.enterprise.brackets.map((u,y)=>o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 80px",gap:8,marginBottom:6},children:[o.jsx("input",{type:"number",value:u.limit===1/0?"":u.limit,placeholder:"",onChange:v=>{const S=[...Mt.enterprise.brackets];S[y]={...S[y],limit:v.target.value===""?1/0:parseInt(v.target.value)||0},Fr(T=>({...T,enterprise:{brackets:S}}))},style:{...nt,fontFamily:"monospace",fontSize:11,padding:"4px 8px"},disabled:y===Mt.enterprise.brackets.length-1}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[o.jsx("input",{type:"number",value:u.rate,onChange:v=>{const S=[...Mt.enterprise.brackets];S[y]={...S[y],rate:parseFloat(v.target.value)||0},Fr(T=>({...T,enterprise:{brackets:S}}))},style:{...nt,fontFamily:"monospace",fontSize:11,width:50,padding:"4px 8px"}}),o.jsx("span",{style:{fontSize:11,color:"#9ca3af"},children:"%"})]})]},y))]})]}),t==="BERHAD"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{style:ua,children:"Corporate Tax Rate"}),o.jsxs("div",{style:{marginBottom:12},children:[o.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginBottom:4},children:"Flat Tax Rate (%)"}),o.jsx("input",{type:"number",value:Mt.berhad.rate,onChange:u=>Fr(y=>({...y,berhad:{rate:parseFloat(u.target.value)||0}})),style:{...nt,fontFamily:"monospace"}})]}),o.jsx("div",{style:{padding:12,background:"rgba(99,102,241,0.1)",borderRadius:8,fontSize:11},children:o.jsxs("div",{style:{fontWeight:600},children:["All chargeable income taxed at ",Mt.berhad.rate,"%"]})})]}),o.jsxs("div",{style:{padding:12,background:"rgba(52,211,153,0.1)",borderRadius:8,marginTop:16},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,marginBottom:8},children:"Effective Tax Rate"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:20,fontWeight:700},children:[o.jsx("span",{style:{color:"#9ca3af"},children:"ETR:"}),o.jsxs("span",{style:{color:"#34d399"},children:[m.is.pbt>0?(Jn(m.is.pbt)/m.is.pbt*100).toFixed(2):0,"%"]})]})]})]})]})]}),o.jsxs("div",{style:{marginTop:16,background:"rgba(31,41,55,0.6)",borderRadius:10,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(52,211,153,0.1), rgba(16,185,129,0.1))",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:700,fontSize:14},children:" Capital Allowance Schedule"}),o.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginTop:2},children:["YA ",L,"  IA claimed on assets acquired in ",L,", AA on all qualifying assets"]}),t==="ENTERPRISE"&&o.jsx("div",{style:{fontSize:9,color:"#fbbf24",marginTop:2},children:" Sole proprietors & partnerships can also claim CA on business assets"}),o.jsx("div",{style:{fontSize:9,color:"#34d399",marginTop:4},children:" V9: Auto-derived from PPE Register (CA toggle ON) + Manual entries"})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[o.jsx("div",{style:{padding:"6px 12px",borderRadius:6,background:ms()?"rgba(52,211,153,0.2)":"rgba(248,113,113,0.2)",border:`1px solid ${ms()?"rgba(52,211,153,0.5)":"rgba(248,113,113,0.5)"}`,fontSize:9},children:ms()?o.jsxs("span",{style:{color:"#34d399"},children:[" Reconciled with PPE: RM ",ae(hn())]}):o.jsxs("span",{style:{color:"#f87171"},children:[" CA: ",ae(Li()),"  PPE: ",ae(hn())]})}),o.jsxs("div",{style:{textAlign:"right"},children:[o.jsxs("div",{style:{fontSize:10,color:"#9ca3af"},children:["Total CA (YA ",L,")"]}),o.jsxs("div",{style:{fontSize:18,fontWeight:700,color:"#34d399",fontFamily:"monospace"},children:["RM ",ae(xs())]})]})]})]}),o.jsxs("div",{style:{padding:12},children:[(()=>{const u=il(),y=pn(),v=y0();return o.jsxs(o.Fragment,{children:[xf()&&o.jsx("div",{style:{padding:"8px 12px",background:"rgba(251,191,36,0.1)",border:"1px solid rgba(251,191,36,0.3)",borderRadius:6,marginBottom:12,fontSize:10,color:"#fbbf24"},children:" Using default CA rates  you can customize rates in Settings if needed"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px 100px 180px 130px 90px 55px 55px 80px 30px",padding:"8px 10px",background:"rgba(99,102,241,0.1)",borderRadius:4,fontSize:9,fontWeight:600,color:"#9ca3af",marginBottom:4,gap:6},children:[o.jsx("span",{children:"Source"}),o.jsx("span",{children:"Acquisition Date"}),o.jsx("span",{children:"Asset Description"}),o.jsx("span",{children:"Category"}),o.jsx("span",{style:{textAlign:"right"},children:"Cost (RM)"}),o.jsx("span",{style:{textAlign:"center"},children:"IA %"}),o.jsx("span",{style:{textAlign:"center"},children:"AA %"}),o.jsx("span",{style:{textAlign:"right"},children:"CA Amount"}),o.jsx("span",{})]}),y.length===0?o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280",fontSize:11},children:'No CA items. Enable "CA?" toggle on PPE assets or add manual entries below.'}):y.map((S,T)=>{const W=Mi(S),D=v[S.category]||v.OFFICE_EQUIPMENT||Bi.OFFICE_EQUIPMENT,C=S.sourceType==="PPE",O=S.isOverride;return o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px 100px 180px 130px 90px 55px 55px 80px 30px",padding:"6px 10px",background:C?T%2?"rgba(52,211,153,0.05)":"rgba(52,211,153,0.1)":T%2?"transparent":"rgba(17,24,39,0.3)",borderRadius:4,fontSize:10,alignItems:"center",gap:6,border:O?"1px solid rgba(251,191,36,0.3)":"none"},children:[o.jsx("span",{style:{fontSize:8,padding:"2px 6px",borderRadius:3,background:C?"rgba(52,211,153,0.2)":"rgba(99,102,241,0.2)",color:C?"#34d399":"#a5b4fc"},children:C?" PPE":" Manual"}),C&&!O?o.jsx("span",{style:{fontSize:9,color:"#9ca3af"},children:S.acquisitionDate||"-"}):o.jsx("input",{type:"date",value:S.acquisitionDate||"",onChange:G=>ai(S.id,"acquisitionDate",G.target.value),style:{padding:"4px",background:"rgba(17,24,39,0.5)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:4,color:"#e5e7eb",fontSize:9}}),C&&!O?o.jsx("span",{style:{fontSize:10,color:"#e5e7eb"},title:S.assetId,children:S.description||"-"}):o.jsx("input",{type:"text",value:S.description||"",onChange:G=>ai(S.id,"description",G.target.value),placeholder:"Asset description...",style:{padding:"4px 8px",background:"rgba(17,24,39,0.5)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:4,color:"#e5e7eb",fontSize:10}}),C&&!O?o.jsx("span",{style:{fontSize:9,color:"#9ca3af"},children:D.label||S.category}):o.jsx("select",{value:S.category,onChange:G=>ai(S.id,"category",G.target.value),style:{padding:"4px",background:"rgba(17,24,39,0.5)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:4,color:"#e5e7eb",fontSize:9},children:Object.entries(Bi).map(([G,xe])=>o.jsx("option",{value:G,children:xe.label},G))}),C&&!O?o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#e5e7eb"},children:ae(S.cost)}):o.jsx("input",{type:"number",value:S.cost||"",onChange:G=>ai(S.id,"cost",parseFloat(G.target.value)||0),placeholder:"0",style:{padding:"4px 8px",background:"rgba(17,24,39,0.5)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:4,color:"#e5e7eb",fontSize:10,fontFamily:"monospace",textAlign:"right"}}),o.jsx("span",{style:{textAlign:"center",fontFamily:"monospace",color:W.isCurrentYear?"#34d399":"#6b7280",fontSize:9},children:W.isCurrentYear?D.ia:"-"}),o.jsx("span",{style:{textAlign:"center",fontFamily:"monospace",color:"#34d399",fontSize:9},children:D.aa}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#34d399",fontWeight:600},children:ae(W.totalCA)}),!C||O?o.jsx("button",{onClick:()=>v0(S.id),style:{padding:"2px 6px",background:"rgba(248,113,113,0.2)",border:"none",borderRadius:4,color:"#f87171",fontSize:12,cursor:"pointer"},title:O?"Remove override (will revert to PPE values)":"Delete manual entry",children:""}):o.jsx("span",{style:{fontSize:8,color:"#6b7280"},title:"Edit in PPE Register",children:""})]},S.id)}),o.jsxs("button",{onClick:gs,style:{width:"100%",padding:"8px",marginTop:8,background:"rgba(99,102,241,0.1)",border:"1px dashed rgba(99,102,241,0.5)",borderRadius:4,color:"#a5b4fc",fontSize:11,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[o.jsx("span",{style:{fontSize:14},children:"+"})," Add Manual CA Entry (not linked to PPE)"]}),y.length>0&&o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px 100px 180px 130px 90px 55px 55px 80px 30px",padding:"10px",background:"rgba(52,211,153,0.1)",borderRadius:4,fontSize:11,fontWeight:600,marginTop:8,borderTop:"2px solid rgba(75,85,99,0.3)",gap:6},children:[o.jsx("span",{}),o.jsxs("span",{style:{gridColumn:"span 2"},children:["TOTAL (",y.length," items: ",u.length," from PPE, ",ps.filter(S=>!S.assetId).length," manual)"]}),o.jsx("span",{}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace"},children:ae(Li())}),o.jsx("span",{}),o.jsx("span",{}),o.jsx("span",{style:{textAlign:"right",fontFamily:"monospace",color:"#34d399"},children:ae(xs())}),o.jsx("span",{})]}),y.length>0&&o.jsxs("div",{style:{marginTop:12,padding:12,background:"rgba(17,24,39,0.3)",borderRadius:8,fontSize:10},children:[o.jsxs("div",{style:{fontWeight:600,color:"#a5b4fc",marginBottom:8},children:[" CA Breakdown for YA ",L]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:12},children:[o.jsxs("div",{style:{padding:10,background:"rgba(52,211,153,0.1)",borderRadius:6,borderLeft:"3px solid #34d399"},children:[o.jsx("div",{style:{fontSize:9,color:"#9ca3af"},children:"Initial Allowance (New Assets)"}),o.jsxs("div",{style:{fontSize:14,fontWeight:700,color:"#34d399",fontFamily:"monospace"},children:["RM ",ae(y.reduce((S,T)=>S+Mi(T).ia,0))]}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280",marginTop:2},children:[y.filter(S=>Mi(S).isCurrentYear).length," assets acquired in ",L]})]}),o.jsxs("div",{style:{padding:10,background:"rgba(96,165,250,0.1)",borderRadius:6,borderLeft:"3px solid #60a5fa"},children:[o.jsx("div",{style:{fontSize:9,color:"#9ca3af"},children:"Annual Allowance (All Assets)"}),o.jsxs("div",{style:{fontSize:14,fontWeight:700,color:"#60a5fa",fontFamily:"monospace"},children:["RM ",ae(y.reduce((S,T)=>S+Mi(T).aa,0))]}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280",marginTop:2},children:[y.length," qualifying assets"]})]}),o.jsxs("div",{style:{padding:10,background:"rgba(167,139,250,0.1)",borderRadius:6,borderLeft:"3px solid #a78bfa"},children:[o.jsx("div",{style:{fontSize:9,color:"#9ca3af"},children:"Total CA Claimed"}),o.jsxs("div",{style:{fontSize:14,fontWeight:700,color:"#a78bfa",fontFamily:"monospace"},children:["RM ",ae(xs())]}),o.jsxs("div",{style:{fontSize:8,color:"#6b7280",marginTop:2},children:["IA + AA for YA ",L]})]})]})]})]})})(),o.jsxs("div",{style:{marginTop:12,padding:12,background:"rgba(99,102,241,0.1)",borderRadius:8,fontSize:10,color:"#9ca3af"},children:[o.jsx("div",{style:{fontWeight:600,color:"#a5b4fc",marginBottom:6},children:" Capital Allowance Rates (LHDN Schedule 3)"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:8,fontSize:9},children:[o.jsxs("div",{children:[o.jsx("span",{style:{color:"#6b7280"},children:"Plant & Machinery:"})," IA 20%, AA 14%"]}),o.jsxs("div",{children:[o.jsx("span",{style:{color:"#6b7280"},children:"Motor Vehicles:"})," IA 20%, AA 20%"]}),o.jsxs("div",{children:[o.jsx("span",{style:{color:"#6b7280"},children:"Computer/ICT:"})," IA 20%, AA 40%"]}),o.jsxs("div",{children:[o.jsx("span",{style:{color:"#6b7280"},children:"Office Equipment:"})," IA 20%, AA 10%"]}),o.jsxs("div",{children:[o.jsx("span",{style:{color:"#6b7280"},children:"Industrial Building:"})," IA 10%, AA 3%"]}),o.jsxs("div",{children:[o.jsx("span",{style:{color:"#6b7280"},children:"Environmental:"})," IA 40%, AA 20%"]}),o.jsxs("div",{children:[o.jsx("span",{style:{color:"#6b7280"},children:"Small Value (<RM2k):"})," AA 100%"]}),o.jsxs("div",{children:[o.jsx("span",{style:{color:"#6b7280"},children:"Heavy Machinery:"})," IA 20%, AA 10%"]})]}),o.jsxs("div",{style:{marginTop:8,fontSize:9,color:"#6b7280",borderTop:"1px solid rgba(75,85,99,0.2)",paddingTop:8},children:[o.jsx("strong",{children:"V9 Note:"}),' Assets with "CA?" toggle ON in PPE Register automatically appear here. Manual entries can be added for assets not in PPE (e.g., prior year assets). IA (Initial Allowance) is claimed in the year of acquisition only. AA (Annual Allowance) is claimed every year until the qualifying expenditure is fully absorbed.']})]})]})]})]}),e==="snapshots"&&o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsx("button",{onClick:lr,style:Ya,children:" Tax"}),o.jsx("button",{onClick:or,style:sr,children:"Dashboard "})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:12,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsx("div",{style:{padding:"16px 20px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(99,102,241,0.1), rgba(139,92,246,0.1))"},children:o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:700,fontSize:16},children:" FS Snapshots"}),o.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginTop:4},children:"Delivered financial statement packs"})]}),m&&o.jsx("button",{onClick:()=>{Wt({periodType:"Monthly",periodLabel:`${L}-${String(new Date().getMonth()+1).padStart(2,"0")}`,note:"",createdBy:"Accountant"}),Rn(!0)},style:{padding:"8px 16px",background:"linear-gradient(135deg, #10b981, #059669)",border:"none",borderRadius:6,color:"#fff",fontSize:11,fontWeight:600,cursor:"pointer"},children:" Save Snapshot"})]})}),o.jsx("div",{style:{padding:16,maxHeight:400,overflowY:"auto"},children:Ia.length>0?Ia.map(u=>o.jsxs("div",{style:{background:"rgba(17,24,39,0.4)",borderRadius:8,border:"1px solid rgba(75,85,99,0.3)",marginBottom:8,padding:12},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("span",{style:{background:u.periodType==="Yearly"?"rgba(251,191,36,0.2)":"rgba(99,102,241,0.2)",color:u.periodType==="Yearly"?"#fbbf24":"#a5b4fc",padding:"2px 6px",borderRadius:4,fontSize:9},children:u.periodType}),o.jsx("span",{style:{fontWeight:700,fontSize:13},children:u.periodLabel}),o.jsxs("span",{style:{background:"rgba(52,211,153,0.2)",color:"#34d399",padding:"2px 6px",borderRadius:4,fontSize:9},children:["v",u.version]})]}),o.jsx("span",{style:{fontSize:9,color:"#6b7280"},children:new Date(u.createdAt).toLocaleDateString()})]}),u.note&&o.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:8,fontStyle:"italic"},children:['"',u.note,'"']}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{style:{fontSize:9,color:"#6b7280"},children:["Txs: ",(u.snapshotMeta?.counts?.bankTxs||0)+(u.snapshotMeta?.counts?.cashTxs||0)," | JEs: ",u.snapshotMeta?.counts?.jes||0]}),o.jsxs("div",{style:{display:"flex",gap:6},children:[o.jsx("button",{onClick:()=>E0(u),style:{padding:"4px 8px",background:"rgba(99,102,241,0.2)",border:"none",borderRadius:4,color:"#a5b4fc",fontSize:9,cursor:"pointer"},children:"View"}),o.jsx("button",{onClick:()=>T0(u.id),style:{padding:"4px 8px",background:"rgba(239,68,68,0.15)",border:"none",borderRadius:4,color:"#fca5a5",fontSize:9,cursor:"pointer"},children:"Delete"})]})]})]},u.id)):o.jsxs("div",{style:{textAlign:"center",padding:30,color:"#6b7280"},children:[o.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),o.jsx("div",{style:{fontSize:12},children:"No snapshots yet"}),o.jsx("div",{style:{fontSize:10},children:"Generate FS and save a snapshot"})]})})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:12,border:"1px solid rgba(75,85,99,0.3)",overflow:"hidden"},children:[o.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid rgba(75,85,99,0.2)",background:"linear-gradient(135deg, rgba(251,191,36,0.1), rgba(245,158,11,0.1))",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:700,fontSize:16},children:" Adjustment Log"}),o.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginTop:4},children:"Track changes between versions"})]}),br.length>0&&o.jsxs("span",{style:{background:"rgba(251,191,36,0.2)",color:"#fbbf24",padding:"4px 10px",borderRadius:8,fontSize:11,fontWeight:600},children:[br.length," entries"]})]}),o.jsxs("div",{style:{padding:16},children:[o.jsxs("div",{style:{background:"rgba(17,24,39,0.4)",borderRadius:8,padding:12,marginBottom:12},children:[o.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:8},children:" Add Manual Adjustment"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginBottom:8},children:[o.jsx("input",{type:"text",value:Qr.periodLabel,onChange:u=>Ea(y=>({...y,periodLabel:u.target.value})),placeholder:"Period (e.g. 2025-01)",style:{padding:"6px 8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:4,color:"#e5e7eb",fontSize:11}}),o.jsxs("select",{value:Qr.type,onChange:u=>Ea(y=>({...y,type:u.target.value})),style:{padding:"6px 8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:4,color:"#e5e7eb",fontSize:11},children:[o.jsx("option",{value:"Correction",children:"Correction"}),o.jsx("option",{value:"Reclass",children:"Reclass"}),o.jsx("option",{value:"Accrual",children:"Accrual"}),o.jsx("option",{value:"TaxAdj",children:"Tax Adjustment"}),o.jsx("option",{value:"Depreciation",children:"Depreciation"}),o.jsx("option",{value:"Other",children:"Other"})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr auto",gap:8},children:[o.jsx("input",{type:"number",value:Qr.amount,onChange:u=>Ea(y=>({...y,amount:u.target.value})),placeholder:"Amount",style:{padding:"6px 8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:4,color:"#e5e7eb",fontSize:11,textAlign:"right"}}),o.jsx("input",{type:"text",value:Qr.description,onChange:u=>Ea(y=>({...y,description:u.target.value})),placeholder:"Description",style:{padding:"6px 8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:4,color:"#e5e7eb",fontSize:11}}),o.jsx("button",{onClick:A0,style:{padding:"6px 12px",background:"linear-gradient(135deg, #fbbf24, #f59e0b)",border:"none",borderRadius:4,color:"#1f2937",fontSize:11,fontWeight:600,cursor:"pointer"},children:"+"})]})]}),o.jsx("div",{style:{maxHeight:350,overflowY:"auto"},children:br.length>0?br.map(u=>o.jsxs("div",{style:{padding:"10px 12px",borderBottom:"1px solid rgba(75,85,99,0.2)",fontSize:10,background:u.isAuto?"rgba(99,102,241,0.05)":"transparent"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,flexWrap:"wrap",marginBottom:4},children:[o.jsx("span",{style:{color:"#a5b4fc",fontWeight:700,fontSize:11},children:u.periodLabel}),u.category&&o.jsx("span",{style:{background:u.category.startsWith("IS")?"rgba(52,211,153,0.15)":u.category.startsWith("BS")?"rgba(59,130,246,0.15)":"rgba(107,114,128,0.15)",color:u.category.startsWith("IS")?"#34d399":u.category.startsWith("BS")?"#60a5fa":"#9ca3af",padding:"1px 5px",borderRadius:3,fontSize:8,fontWeight:600},children:u.category}),o.jsx("span",{style:{background:u.type==="TaxAdj"?"rgba(251,191,36,0.2)":u.type==="Depreciation"?"rgba(139,92,246,0.2)":u.type==="Reclass"?"rgba(236,72,153,0.2)":u.type==="Other"?"rgba(107,114,128,0.2)":"rgba(99,102,241,0.2)",color:u.type==="TaxAdj"?"#fbbf24":u.type==="Depreciation"?"#c4b5fd":u.type==="Reclass"?"#f472b6":u.type==="Other"?"#9ca3af":"#a5b4fc",padding:"1px 5px",borderRadius:3,fontSize:8,fontWeight:600},children:u.type}),u.isAuto&&o.jsx("span",{style:{background:"rgba(52,211,153,0.2)",color:"#34d399",padding:"1px 5px",borderRadius:3,fontSize:8,fontWeight:600},children:"AUTO"}),o.jsx("span",{style:{marginLeft:"auto",color:"#6b7280",fontSize:8},children:u.date})]}),u.field&&o.jsxs("div",{style:{color:"#e5e7eb",fontWeight:600,fontSize:11,marginBottom:2},children:[u.field,u.glCode&&o.jsxs("span",{style:{color:"#6b7280",fontWeight:400,marginLeft:4},children:["(",u.glCode,")"]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("div",{style:{color:"#9ca3af",fontSize:10},children:u.oldValue!==void 0&&u.newValue!==void 0?o.jsxs("span",{children:[o.jsx("span",{style:{color:"#f87171"},children:ae(u.oldValue)}),o.jsx("span",{style:{margin:"0 4px"},children:""}),o.jsx("span",{style:{color:"#34d399"},children:ae(u.newValue)})]}):u.description}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[u.amount!==0&&o.jsxs("span",{style:{fontFamily:"monospace",fontSize:11,padding:"2px 6px",borderRadius:4,background:u.amount>0?"rgba(52,211,153,0.15)":"rgba(248,113,113,0.15)",color:u.amount>0?"#34d399":"#f87171",fontWeight:700},children:[u.amount>0?"+":"",ae(u.amount)]}),o.jsx("button",{onClick:()=>_0(u.id),style:{padding:"2px 5px",background:"rgba(239,68,68,0.15)",border:"none",borderRadius:3,color:"#fca5a5",fontSize:9,cursor:"pointer"},children:""})]})]})]},u.id)):o.jsx("div",{style:{textAlign:"center",padding:20,color:"#6b7280",fontSize:11},children:"No adjustments recorded"})})]})]})]})]}),Yr&&o.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:100},children:o.jsxs("div",{style:{background:"#1f2937",borderRadius:12,padding:20,maxWidth:400,width:"90%"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},children:[o.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:700},children:" Save Snapshot"}),o.jsx("button",{onClick:()=>Rn(!1),style:{background:"none",border:"none",color:"#9ca3af",fontSize:18,cursor:"pointer"},children:""})]}),o.jsxs("div",{style:{display:"grid",gap:12},children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Period Type"}),o.jsxs("select",{value:Rr.periodType,onChange:u=>Wt(y=>({...y,periodType:u.target.value})),style:{width:"100%",padding:"8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:12},children:[o.jsx("option",{value:"Monthly",children:"Monthly"}),o.jsx("option",{value:"Yearly",children:"Yearly"})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Period Label"}),o.jsx("input",{type:"text",value:Rr.periodLabel,onChange:u=>Wt(y=>({...y,periodLabel:u.target.value})),placeholder:"2025-01",style:{width:"100%",padding:"8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:12,boxSizing:"border-box"}})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Created By"}),o.jsx("input",{type:"text",value:Rr.createdBy,onChange:u=>Wt(y=>({...y,createdBy:u.target.value})),style:{width:"100%",padding:"8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:12,boxSizing:"border-box"}})]}),o.jsxs("div",{children:[o.jsx("label",{style:{fontSize:10,color:"#9ca3af",display:"block",marginBottom:4},children:"Note"}),o.jsx("textarea",{value:Rr.note,onChange:u=>Wt(y=>({...y,note:u.target.value})),rows:2,placeholder:"Optional note...",style:{width:"100%",padding:"8px",background:"rgba(17,24,39,0.6)",border:"1px solid rgba(75,85,99,0.3)",borderRadius:6,color:"#e5e7eb",fontSize:12,resize:"none",boxSizing:"border-box"}})]}),o.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[o.jsx("button",{onClick:()=>Rn(!1),style:{padding:"8px 16px",background:"rgba(75,85,99,0.3)",border:"none",borderRadius:6,color:"#9ca3af",fontSize:12,cursor:"pointer"},children:"Cancel"}),o.jsx("button",{onClick:Nf,style:{padding:"8px 16px",background:"linear-gradient(135deg, #10b981, #059669)",border:"none",borderRadius:6,color:"#fff",fontSize:12,fontWeight:600,cursor:"pointer"},children:"Save"})]})]})]})}),e==="dashboard"&&m&&(()=>{const u=Jr();if(!u)return o.jsx("div",{style:{padding:20,textAlign:"center",color:"#9ca3af"},children:"Generate financial statements first to view dashboard."});const{kpis:y,ratios:v,comparatives:S,insights:T}=u,W=({cy:xe,py:Re,total:ye,pyTotal:X,label:V,color:Me,size:Be=70})=>{const pe=ye>0?xe/ye*100:0,We=X>0?Re/X*100:0,Ve=2*Math.PI*28,it=Ve-pe/100*Ve,Vt=Ve-We/100*Ve,lt=Re>0?(xe-Re)/Re*100:xe>0?100:0;return o.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[o.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[o.jsxs("div",{style:{position:"relative"},children:[o.jsxs("svg",{width:Be,height:Be,viewBox:"0 0 64 64",children:[o.jsx("circle",{cx:"32",cy:"32",r:"28",fill:"none",stroke:"rgba(75,85,99,0.3)",strokeWidth:"6"}),o.jsx("circle",{cx:"32",cy:"32",r:"28",fill:"none",stroke:Me,strokeWidth:"6",strokeLinecap:"round",strokeDasharray:Ve,strokeDashoffset:it,transform:"rotate(-90 32 32)"}),o.jsxs("text",{x:"32",y:"32",textAnchor:"middle",dominantBaseline:"middle",fill:"#e5e7eb",fontSize:"10",fontWeight:"700",fontFamily:"monospace",children:[pe.toFixed(0),"%"]})]}),o.jsx("div",{style:{position:"absolute",bottom:-2,left:"50%",transform:"translateX(-50%)",fontSize:7,color:"#9ca3af",background:"rgba(17,24,39,0.8)",padding:"1px 4px",borderRadius:2},children:"CY"})]}),o.jsxs("div",{style:{position:"relative"},children:[o.jsxs("svg",{width:Be*.85,height:Be*.85,viewBox:"0 0 64 64",children:[o.jsx("circle",{cx:"32",cy:"32",r:"28",fill:"none",stroke:"rgba(75,85,99,0.2)",strokeWidth:"5"}),o.jsx("circle",{cx:"32",cy:"32",r:"28",fill:"none",stroke:`${Me}80`,strokeWidth:"5",strokeLinecap:"round",strokeDasharray:Ve,strokeDashoffset:Vt,transform:"rotate(-90 32 32)"}),o.jsxs("text",{x:"32",y:"32",textAnchor:"middle",dominantBaseline:"middle",fill:"#9ca3af",fontSize:"9",fontWeight:"600",fontFamily:"monospace",children:[We.toFixed(0),"%"]})]}),o.jsx("div",{style:{position:"absolute",bottom:-2,left:"50%",transform:"translateX(-50%)",fontSize:7,color:"#6b7280",background:"rgba(17,24,39,0.8)",padding:"1px 4px",borderRadius:2},children:"PY"})]})]}),o.jsx("div",{style:{fontSize:9,color:"#9ca3af",marginTop:8,textAlign:"center"},children:V}),o.jsxs("div",{style:{fontSize:8,padding:"2px 6px",borderRadius:3,marginTop:2,background:lt>=0?"rgba(52,211,153,0.2)":"rgba(248,113,113,0.2)",color:lt>=0?"#34d399":"#f87171"},children:[lt>=0?"":""," ",Math.abs(lt).toFixed(1),"%"]})]})},D=({cy:xe,py:Re,label:ye,color:X,maxVal:V})=>{const Me=Re>0?(xe-Re)/Re*100:xe>0?100:0,Be=V>0?Math.abs(xe)/V*100:0,pe=V>0?Math.abs(Re)/V*100:0;return o.jsxs("div",{style:{marginBottom:12},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[o.jsx("span",{style:{fontSize:10,color:"#e5e7eb",fontWeight:500},children:ye}),o.jsxs("div",{style:{fontSize:9,padding:"2px 6px",borderRadius:4,background:Me>=0?"rgba(52,211,153,0.2)":"rgba(248,113,113,0.2)",color:Me>=0?"#34d399":"#f87171"},children:[Me>=0?"":""," ",Math.abs(Me).toFixed(1),"%"]})]}),o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:3},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("div",{style:{width:24,fontSize:8,color:"#9ca3af"},children:"CY"}),o.jsx("div",{style:{flex:1,height:18,background:"rgba(17,24,39,0.5)",borderRadius:4,overflow:"hidden"},children:o.jsx("div",{style:{height:"100%",width:`${Be}%`,background:`linear-gradient(90deg, ${X}, ${X}aa)`,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:6},children:o.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"#fff",fontWeight:600,textShadow:"0 1px 2px rgba(0,0,0,0.5)"},children:ae(xe)})})})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("div",{style:{width:24,fontSize:8,color:"#6b7280"},children:"PY"}),o.jsx("div",{style:{flex:1,height:14,background:"rgba(17,24,39,0.5)",borderRadius:3,overflow:"hidden"},children:o.jsx("div",{style:{height:"100%",width:`${pe}%`,background:`${X}50`,borderRadius:3,border:`1px solid ${X}`,display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:6},children:o.jsx("span",{style:{fontSize:8,fontFamily:"monospace",color:"#9ca3af"},children:ae(Re)})})})]})]})]})},C=({title:xe,value:Re,min:ye,max:X,target:V,unit:Me=""})=>{const Be=Math.min(100,Math.max(0,(Re-ye)/(X-ye)*100)),pe=(V-ye)/(X-ye)*100,We=Re>=V;return o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:8,padding:10},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[o.jsx("span",{style:{fontSize:9,color:"#9ca3af",textTransform:"uppercase"},children:xe}),o.jsxs("span",{style:{fontSize:14,fontWeight:700,color:We?"#34d399":"#fbbf24",fontFamily:"monospace"},children:[typeof Re=="number"?Re.toFixed(Me==="%"?1:2):Re,Me]})]}),o.jsxs("div",{style:{height:5,background:"rgba(17,24,39,0.5)",borderRadius:3,overflow:"hidden",position:"relative"},children:[o.jsx("div",{style:{height:"100%",width:`${Be}%`,background:We?"#34d399":"#fbbf24",borderRadius:3}}),o.jsx("div",{style:{position:"absolute",left:`${pe}%`,top:-1,width:2,height:7,background:"#e5e7eb",borderRadius:1}})]}),o.jsxs("div",{style:{fontSize:7,color:"#6b7280",marginTop:3},children:["Target: ",V,Me]})]})},O=Math.max(y.revenue,S.pyRevenue,y.grossProfit,S.pyGp,Math.abs(y.pat),Math.abs(S.pyPat),1),G=Math.max(y.totalAssets,S.pyTotalAssets,y.totalEquity,S.pyTotalEquity,y.totalLiabilities,m.bs.py_totL||0,1);return o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsx("button",{onClick:lr,style:Ya,children:" Tax Computation"}),o.jsx("span",{style:{fontWeight:700,fontSize:16},children:" Financial Dashboard"})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,fontSize:10},children:[o.jsx("span",{style:{width:12,height:12,background:"#60a5fa",borderRadius:2}}),o.jsxs("span",{style:{color:"#9ca3af"},children:["CY ",L]})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,fontSize:10},children:[o.jsx("span",{style:{width:12,height:12,background:"rgba(96,165,250,0.3)",border:"1px solid #60a5fa",borderRadius:2}}),o.jsxs("span",{style:{color:"#6b7280"},children:["PY ",fe]})]})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:12,border:"1px solid rgba(75,85,99,0.3)",padding:16},children:[o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:"#60a5fa",marginBottom:16,textTransform:"uppercase",letterSpacing:.5,display:"flex",alignItems:"center",gap:8},children:[o.jsx("span",{children:""})," Income Statement"]}),o.jsx(D,{cy:y.revenue,py:S.pyRevenue,label:"Revenue",color:"#60a5fa",maxVal:O}),o.jsx(D,{cy:y.grossProfit,py:S.pyGp,label:"Gross Profit",color:"#34d399",maxVal:O}),o.jsx(D,{cy:y.pat,py:S.pyPat,label:"Net Profit",color:y.pat>=0?"#a78bfa":"#f87171",maxVal:O})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:12,border:"1px solid rgba(75,85,99,0.3)",padding:16},children:[o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:"#34d399",marginBottom:16,textTransform:"uppercase",letterSpacing:.5,display:"flex",alignItems:"center",gap:8},children:[o.jsx("span",{children:""})," Balance Sheet"]}),o.jsx(D,{cy:y.totalAssets,py:S.pyTotalAssets,label:"Total Assets",color:"#60a5fa",maxVal:G}),o.jsx(D,{cy:y.totalEquity,py:S.pyTotalEquity,label:"Total Equity",color:"#34d399",maxVal:G}),o.jsx(D,{cy:y.totalLiabilities,py:m.bs.py_totL||0,label:"Total Liabilities",color:"#f87171",maxVal:G})]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:16,marginBottom:16},children:[o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:12,border:"1px solid rgba(75,85,99,0.3)",padding:16},children:[o.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#9ca3af",marginBottom:12,textTransform:"uppercase",letterSpacing:.5},children:"Capital Structure (% of Assets)"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-around"},children:[o.jsx(W,{cy:y.totalEquity,py:S.pyTotalEquity,total:y.totalAssets,pyTotal:S.pyTotalAssets,label:"Equity",color:"#34d399"}),o.jsx(W,{cy:y.totalLiabilities,py:m.bs.py_totL||0,total:y.totalAssets,pyTotal:S.pyTotalAssets,label:"Liabilities",color:"#f87171"})]}),o.jsxs("div",{style:{marginTop:12,padding:8,background:"rgba(17,24,39,0.3)",borderRadius:6,fontSize:9,color:"#6b7280",textAlign:"center"},children:["Total Assets: CY ",o.jsx("span",{style:{color:"#e5e7eb",fontFamily:"monospace"},children:ae(y.totalAssets)})," vs PY ",o.jsx("span",{style:{color:"#9ca3af",fontFamily:"monospace"},children:ae(S.pyTotalAssets)})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:12,border:"1px solid rgba(75,85,99,0.3)",padding:16},children:[o.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#9ca3af",marginBottom:12,textTransform:"uppercase",letterSpacing:.5},children:"Key Financial Ratios"}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:10},children:[o.jsx(C,{title:"Gross Margin",value:v.grossMargin,min:0,max:60,target:30,unit:"%"}),o.jsx(C,{title:"Operating Margin",value:v.operatingMargin,min:0,max:40,target:15,unit:"%"}),o.jsx(C,{title:"Return on Equity",value:v.roe,min:0,max:40,target:15,unit:"%"}),o.jsx(C,{title:"Current Ratio",value:v.currentRatio,min:0,max:4,target:1.5}),o.jsx(C,{title:"Cash Ratio",value:v.cashRatio,min:0,max:2,target:.5}),o.jsx(C,{title:"Debt to Equity",value:v.debtToEquity,min:0,max:3,target:1})]})]})]}),o.jsxs("div",{style:{background:"rgba(31,41,55,0.6)",borderRadius:12,border:"1px solid rgba(75,85,99,0.3)",padding:16},children:[o.jsxs("div",{style:{fontSize:12,fontWeight:700,color:"#f472b6",marginBottom:12,display:"flex",alignItems:"center",gap:8},children:[o.jsx("span",{children:""})," Financial Analysis & Insights"]}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:12,maxHeight:300,overflowY:"auto"},children:T.length>0?T.map((xe,Re)=>o.jsxs("div",{style:{padding:12,background:xe.type==="success"?"rgba(52,211,153,0.1)":xe.type==="danger"?"rgba(248,113,113,0.1)":"rgba(251,191,36,0.1)",borderRadius:8,borderLeft:`3px solid ${xe.type==="success"?"#34d399":xe.type==="danger"?"#f87171":"#fbbf24"}`},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[o.jsx("span",{style:{fontSize:14},children:xe.icon}),o.jsx("span",{style:{fontSize:9,color:"#9ca3af",textTransform:"uppercase",letterSpacing:.5},children:xe.category})]}),o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#e5e7eb",marginBottom:4},children:xe.title}),o.jsx("div",{style:{fontSize:10,color:"#d1d5db",marginBottom:6},children:xe.text}),xe.detail&&o.jsxs("div",{style:{fontSize:9,color:"#9ca3af",padding:"8px",background:"rgba(17,24,39,0.3)",borderRadius:4},children:[" ",xe.detail]})]},Re)):o.jsx("div",{style:{gridColumn:"span 2",color:"#6b7280",fontSize:11,fontStyle:"italic",textAlign:"center",padding:20},children:"No significant insights to report. The company appears to be in stable financial condition."})})]})]})})()]}),o.jsx("footer",{style:{padding:"12px 20px",borderTop:"1px solid rgba(75,85,99,0.2)",textAlign:"center",color:"#6b7280",fontSize:10},children:"Financial Statements Automation  Multi-Bank  12-Month  MFRS / IFRS / MPERS"})]})}R2.createRoot(document.getElementById("root")).render(o.jsx(dt.StrictMode,{children:o.jsx(N8,{})}));
